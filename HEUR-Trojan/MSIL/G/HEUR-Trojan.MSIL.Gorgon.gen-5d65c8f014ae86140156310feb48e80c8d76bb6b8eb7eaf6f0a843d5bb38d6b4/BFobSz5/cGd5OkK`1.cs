// Decompiled with JetBrains decompiler
// Type: BFobSz5.cGd5OkK
// Assembly: rIHK739, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: DCC06416-0005-44FB-A994-2D27682899C4
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-5d65c8f014ae86140156310feb48e80c8d76bb6b8eb7eaf6f0a843d5bb38d6b4.exe

using eYi3MQM;
using KBBpOxm;
using Microsoft.Win32;
using QfmxIEf;
using RnEcdQv;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Reflection;
using System.Text.RegularExpressions;
using xDFiDaD;

namespace BFobSz5
{
  public abstract class cGd5OkK<T> : IDisposable where T : cGd5OkK<T>
  {
    private const string n3qyWyM = "FxVersion";
    private const string YqZrwVU = "OSName";
    private const string j7WNTnn = "OSVersion";
    private List<ProductInfoHeaderValue> iDYjAgj;
    private bool zhWmrbP;
    private bool \u0038QwythT;
    private string DEaZLD1;
    private string Y33yTKm;
    private string MCTgulo;
    private string \u0032XSgjuS;

    private string \u0031W5wJVU
    {
      get
      {
        if (string.IsNullOrEmpty(this._osName))
        {
          this._osName = this.ReadHKLMRegistry("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "ProductName");
          this._osName = this.CleanUserAgentInfoEntry(this._osName);
        }
        return this._osName;
      }
    }

    private string \u0035S0k7uF
    {
      get
      {
        if (string.IsNullOrEmpty(this._osVersion))
        {
          this._osVersion = string.Format("{0}.{1}", (object) this.ReadHKLMRegistry("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "CurrentVersion"), (object) this.ReadHKLMRegistry("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "CurrentBuild"));
          this._osVersion = this.CleanUserAgentInfoEntry(this._osVersion);
        }
        return this._osVersion;
      }
    }

    private string \u0036Hq70eW(string _param1, string c8b2euJ)
    {
      try
      {
        using (RegistryKey registryKey = Registry.LocalMachine.OpenSubKey(_param1))
          return registryKey == null ? "" : (string) registryKey.GetValue(c8b2euJ);
      }
      catch
      {
        return "";
      }
    }

    private List<ProductInfoHeaderValue> jSfvyaD
    {
      get
      {
        if (this._defaultUserAgentInfoList == null)
        {
          this._defaultUserAgentInfoList = new List<ProductInfoHeaderValue>();
          this._defaultUserAgentInfoList.Add(new ProductInfoHeaderValue("FxVersion", this.PFRNLZS));
          this._defaultUserAgentInfoList.Add(new ProductInfoHeaderValue("OSName", this.\u0031W5wJVU));
          this._defaultUserAgentInfoList.Add(new ProductInfoHeaderValue("OSVersion", this.\u0035S0k7uF));
        }
        return this._defaultUserAgentInfoList;
      }
    }

    private string HfHF6Lb
    {
      get
      {
        if (string.IsNullOrEmpty(this._clientVersion))
        {
          Assembly assembly = this.GetType().GetTypeInfo().Assembly;
          try
          {
            this._clientVersion = assembly.GetCustomAttribute(typeof (AssemblyVersionAttribute)) is AssemblyVersionAttribute customAttribute1 ? customAttribute1.Version : (string) null;
            if (string.IsNullOrEmpty(this._clientVersion))
              this._clientVersion = assembly.GetCustomAttribute(typeof (AssemblyFileVersionAttribute)) is AssemblyFileVersionAttribute customAttribute2 ? customAttribute2.Version : (string) null;
            if (string.IsNullOrEmpty(this._clientVersion))
              this._clientVersion = assembly.GetCustomAttribute(typeof (AssemblyInformationalVersionAttribute)) is AssemblyInformationalVersionAttribute customAttribute3 ? customAttribute3.InformationalVersion : (string) null;
          }
          catch (AmbiguousMatchException ex)
          {
          }
          if (string.IsNullOrEmpty(this._clientVersion))
            this._clientVersion = ((IEnumerable<string>) assembly.FullName.Split(',')).Select<string, string>((Func<string, string>) delegate); //unable to render the statement
        }
        return this._clientVersion;
      }
    }

    private string PFRNLZS
    {
      get
      {
        if (string.IsNullOrEmpty(this._fxVersion))
          this._fxVersion = typeof (object).GetTypeInfo().Assembly.GetCustomAttribute(typeof (AssemblyFileVersionAttribute)) is AssemblyFileVersionAttribute customAttribute ? customAttribute.Version : (string) null;
        return this._fxVersion;
      }
    }

    protected HttpMessageHandler QQ9bYfZ
    {
      get => this.\u003CFirstMessageHandler\u003Ek__BackingField;
      set => this.\u003CFirstMessageHandler\u003Ek__BackingField = value;
    }

    protected HttpClientHandler YIuFoTe
    {
      get => this.\u003CHttpClientHandler\u003Ek__BackingField;
      set => this.\u003CHttpClientHandler\u003Ek__BackingField = value;
    }

    protected cGd5OkK()
      : this(cGd5OkK<T>.CreateRootHandler())
    {
    }

    protected cGd5OkK(HttpClient httpClient, bool disposeHttpClient = true)
    {
      this._disposeHttpClient = disposeHttpClient;
      this.InitializeHttpClient(httpClient, (HttpClientHandler) null);
    }

    protected cGd5OkK(params DelegatingHandler[] handlers)
      : this(cGd5OkK<T>.CreateRootHandler(), handlers)
    {
    }

    protected cGd5OkK(HttpClientHandler rootHandler, params DelegatingHandler[] handlers) => this.InitializeHttpClient(rootHandler, handlers);

    protected static HttpClientHandler CreateRootHandler() => (HttpClientHandler) new WebRequestHandler();

    public HttpClient \u0038HGmbjf
    {
      get => this.\u003CHttpClient\u003Ek__BackingField;
      protected set => this.\u003CHttpClient\u003Ek__BackingField = value;
    }

    public virtual HttpHeaderValueCollection<ProductInfoHeaderValue> WmJhCtj => this.\u0038HGmbjf.DefaultRequestHeaders.UserAgent;

    public virtual IEnumerable<HttpMessageHandler> g6QllqW => (IEnumerable<HttpMessageHandler>) new cGd5OkK<T>.yq3hicu(-2)
    {
      \u003C\u003E4__this = this
    };

    public virtual void l4Vo4rI(\u0032Li1VfJ KK1zgTJ)
    {
      if (KK1zgTJ == null)
        KK1zgTJ = (\u0032Li1VfJ) new \u0035MwXYUt<xQ0J5ce>(0);
      \u0034TkW1ha obj = this.g6QllqW.OfType<\u0034TkW1ha>().FirstOrDefault<\u0034TkW1ha>();
      if (obj == null)
        throw new InvalidOperationException(zgpvHIp.wAst72Q);
      obj.dGDEMYU = KK1zgTJ;
    }

    public void \u0037JPX2we()
    {
      this.Dispose(true);
      GC.SuppressFinalize((object) this);
    }

    protected virtual void Dispose(bool disposing)
    {
      if (this._disposed)
        return;
      this._disposed = true;
      if (this._disposeHttpClient)
      {
        this.\u0038HGmbjf.Dispose();
        this.\u0038HGmbjf = (HttpClient) null;
      }
      this.QQ9bYfZ = (HttpMessageHandler) null;
      this.YIuFoTe = (HttpClientHandler) null;
    }

    protected void InitializeHttpClient(
      HttpClientHandler httpClientHandler,
      params DelegatingHandler[] handlers)
    {
      this.InitializeHttpClient((HttpClient) null, httpClientHandler, handlers);
    }

    protected void InitializeHttpClient(
      HttpClient httpClient,
      HttpClientHandler httpClientHandler,
      params DelegatingHandler[] handlers)
    {
      if (httpClient == null)
      {
        if (httpClientHandler == null)
          httpClientHandler = cGd5OkK<T>.CreateRootHandler();
        this.YIuFoTe = httpClientHandler;
        DelegatingHandler handler = (DelegatingHandler) new \u0034TkW1ha();
        handler.InnerHandler = (HttpMessageHandler) this.YIuFoTe;
        if (handlers != null)
        {
          for (int index = handlers.Length - 1; index >= 0; --index)
          {
            DelegatingHandler delegatingHandler = handlers[index];
            while (delegatingHandler.InnerHandler is DelegatingHandler)
              delegatingHandler = delegatingHandler.InnerHandler as DelegatingHandler;
            delegatingHandler.InnerHandler = (HttpMessageHandler) handler;
            handler = handlers[index];
          }
        }
        this.\u0038HGmbjf = new HttpClient((HttpMessageHandler) handler, false);
        this.QQ9bYfZ = (HttpMessageHandler) handler;
      }
      else
        this.\u0038HGmbjf = httpClient;
      this.SetUserAgent(this.GetType().FullName, this.HfHF6Lb);
    }

    public bool \u0033aRmrZY(string GOJXsig) => this.SetUserAgent(GOJXsig, this.HfHF6Lb);

    public bool Hsmp1D9(string iPB72Qq, string yLKkUHx)
    {
      if (this._disposed || this.\u0038HGmbjf == null)
        return false;
      this.MergeUserAgentInfo(this.jSfvyaD);
      this.\u0038HGmbjf.DefaultRequestHeaders.UserAgent.Add(new ProductInfoHeaderValue(this.CleanUserAgentInfoEntry(iPB72Qq), yLKkUHx));
      return true;
    }

    private string yNmyP2k(string ginwx7P)
    {
      ginwx7P = new Regex("[~`!@#$%^&*(), ]").Replace(ginwx7P, "");
      return ginwx7P;
    }

    private void UYJZ4he(List<ProductInfoHeaderValue> _param1)
    {
      foreach (ProductInfoHeaderValue productInfoHeaderValue in _param1)
      {
        // ISSUE: object of a compiler-generated type is created
        // ISSUE: variable of a compiler-generated type
        cGd5OkK<T>.CN59xaU cn59xaU = new cGd5OkK<T>.CN59xaU();
        // ISSUE: reference to a compiler-generated field
        cn59xaU.piHv = productInfoHeaderValue;
        // ISSUE: reference to a compiler-generated method
        this.\u0038HGmbjf.DefaultRequestHeaders.UserAgent.Any<ProductInfoHeaderValue>(new Func<ProductInfoHeaderValue, bool>(cn59xaU.\u003CMergeUserAgentInfo\u003Eb__0));
        // ISSUE: reference to a compiler-generated field
        this.\u0038HGmbjf.DefaultRequestHeaders.UserAgent.Add(cn59xaU.piHv);
      }
    }
  }
}
