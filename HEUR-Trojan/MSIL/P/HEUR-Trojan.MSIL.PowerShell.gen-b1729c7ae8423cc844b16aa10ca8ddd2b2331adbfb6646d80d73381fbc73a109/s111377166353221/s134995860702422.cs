// Decompiled with JetBrains decompiler
// Type: s111377166353221.s134995860702422
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s442701228766881;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

namespace s111377166353221
{
  internal static class s134995860702422
  {
    internal const ulong s170387581095630 = 18446744073709551615;
    internal const uint s831448001949099 = 256;
    internal const uint s345569026492667 = 268435456;
    internal const uint s985951344536761 = 256;
    internal const uint s767832043559809 = 4096;
    internal const uint s409305925791346 = 0;
    internal const uint s409758821110744 = 1;
    internal const uint s194557874390868 = 2;
    internal const uint s772537526025032 = 4;
    internal const uint s464818692495706 = 8;
    internal const uint s778320638584001 = 1024;
    internal const uint s846033132889280 = 134217728;
    internal const uint s526211120061472 = 0;
    internal const uint s890270301499409 = 1;
    internal const uint s127357273881525 = 2;
    internal const uint s060587203501308 = 3;
    internal const uint s264856219845947 = 131072;
    internal const uint s483137888610622 = 33554432;
    internal const ushort s180732211278489 = 4;
    internal const ushort s239632168189064 = 32;
    internal const ushort s328488203142323 = 64;
    internal const ushort s749643797813908 = 256;
    internal const ushort s552269546335659 = 1;
    internal const ushort s190283672577289 = 2;
    internal const ushort s552323189026791 = 3;
    internal const ushort s138659605389418 = 4;
    internal const ushort s180345336068537 = 5;
    internal const ushort s697679066230025 = 6;
    internal const ushort s511705856703029 = 7;
    internal const ushort s243092249366697 = 8;
    internal const ushort s648719090723472 = 9;
    internal const ushort s598594597534691 = 10;
    internal const ushort s125618964835968 = 11;
    internal const ushort s105798170111109 = 12;
    internal const ushort s098755121216849 = 13;
    internal const int s750577778534009 = 8;
    internal const int s765949491450554 = 8;
    internal const int s846413777693757 = 64;
    internal const int s230090481815161 = 0;
    internal const int s557441214812350 = -2147483648;
    internal const int s137714645929531 = -2147483647;
    internal const int s504192978568982 = -2147483646;
    internal const int s293253449712013 = -2147483644;
    internal const int s021078032016103 = -2147483640;
    internal const int s631837827346994 = -2147483632;
    internal const int s231652727314463 = -2147483616;
    internal const int s117375108508035 = -2147483392;
    internal const int s389632494078093 = -2147483136;
    internal const int s799213508311783 = -2147479552;
    internal const uint s122504399305237 = 1;
    internal const uint s712971462830152 = 2;
    internal const uint s845328873265623 = 1;
    internal const uint s613198486046738 = 2;
    internal const uint s127305878715554 = 4;
    internal const uint s349124322834586 = 8;
    internal const uint s319162325250671 = 16;
    internal const uint s565888093637259 = 32;
    internal const uint s448302457227121 = 64;
    internal const uint s317674725026369 = 128;
    internal const uint s337939306730426 = 256;
    internal const uint s641801438259565 = 512;
    internal const uint s794071899472574 = 0;
    internal const uint s536851037865764 = 1;
    internal const uint s930438962385512 = 2;
    internal static readonly uint s922565419768396 = 983040;
    internal static readonly uint s044717199031457 = 131072;
    internal static readonly uint s106751162680792 = 1;
    internal static readonly uint s485619626434859 = 2;
    internal static readonly uint s062067605862220 = 4;
    internal static readonly uint s040523981478460 = 8;
    internal static readonly uint s574165997238894 = 16;
    internal static readonly uint s811982584997386 = 32;
    internal static readonly uint s984395191693972 = 64;
    internal static readonly uint s961625961848384 = 256;
    internal static readonly uint s823350952017483 = s134995860702422.s044717199031457 | s134995860702422.s040523981478460;
    internal const uint s602981300513872 = 1;
    internal const uint s467371838896281 = 2;
    internal const uint s443754389673952 = 4;
    internal const uint s357319261499832 = 2147483648;
    internal const uint s437947105341413 = 11;
    internal const uint s716648697768797 = 20;
    internal const int s325025951720711 = 2;
    internal const int s509983538604236 = 256;
    internal const uint s454354448237816 = 4201;

    [DllImport("advapi32.dll", EntryPoint = "TraceSetInformation", CharSet = CharSet.Unicode, SetLastError = true)]
    internal static extern unsafe int s702249946667553(
      [In] ulong s213916433103501,
      [In] s134995860702422.s267532197552653 s238677168001430,
      [In] void* s342077011301735,
      [In] int s546466115186403);

    [DllImport("advapi32.dll", EntryPoint = "TraceQueryInformation", CharSet = CharSet.Unicode, SetLastError = true)]
    internal static extern unsafe int s252129162195936(
      [In] ulong s331692172460774,
      [In] s134995860702422.s267532197552653 s183013876655684,
      [Out] void* s891441298970801,
      [In] int s829689555334750,
      [In, Out] ref int s580962268671574);

    [DllImport("advapi32.dll", EntryPoint = "OpenTraceW", CharSet = CharSet.Unicode, SetLastError = true)]
    internal static extern ulong s983712201802122(
      [In, Out] ref s134995860702422.s850980203428386 s690465759192834);

    [DllImport("advapi32.dll", EntryPoint = "ProcessTrace", CharSet = CharSet.Unicode)]
    internal static extern int s214310995671055(
      [In] ulong[] s141048099402352,
      [In] uint s147868585026034,
      [In] IntPtr s242451144686739,
      [In] IntPtr s077656794919559);

    [DllImport("advapi32.dll", EntryPoint = "CloseTrace", CharSet = CharSet.Unicode)]
    internal static extern int s373861679794889([In] ulong s489754519192958);

    [DllImport("advapi32.dll", EntryPoint = "QueryAllTraces", CharSet = CharSet.Unicode)]
    internal static extern int s438654643371197(
      [In] IntPtr s525089799472244,
      [In] int s939255093545034,
      [In, Out] ref int s090828246456815);

    [DllImport("advapi32.dll", EntryPoint = "StartTraceW", CharSet = CharSet.Unicode)]
    internal static extern unsafe int s926354801416407(
      out ulong s516285822571352,
      [In] string s280256585740490,
      s134995860702422.s927874108563264* s673835487984798);

    [DllImport("advapi32.dll", EntryPoint = "EnableTrace", CharSet = CharSet.Unicode)]
    internal static extern int s737218818375802(
      [In] uint s977575653288386,
      [In] int s393242207886887,
      [In] int s931463236882681,
      [In] ref Guid s436899753189516,
      [In] ulong s377221944232065);

    [DllImport("advapi32.dll", EntryPoint = "EnableTraceEx", CharSet = CharSet.Unicode)]
    internal static extern unsafe int s583772494610037(
      [In] ref Guid s924032736744902,
      [In] Guid* s711748382094770,
      [In] ulong s445273056130694,
      [In] int s408783647026628,
      [In] byte s449486890014928,
      [In] ulong s781704041105320,
      [In] ulong s392525411360011,
      [In] uint s643728181875562,
      [In] s134995860702422.s978582079522627* s146628835912847);

    [DllImport("advapi32.dll", EntryPoint = "EnableTraceEx2", CharSet = CharSet.Unicode)]
    internal static extern int s916796164398737(
      [In] ulong s576367038049068,
      [In] ref Guid s521155862599938,
      [In] uint s957561436141092,
      [In] byte s238234412736709,
      [In] ulong s987054119413481,
      [In] ulong s316226301893039,
      [In] int s714969965044220,
      [In] ref s134995860702422.s506974201724280 s747280970009824);

    [DllImport("advapi32.dll", EntryPoint = "ControlTrace", CharSet = CharSet.Unicode)]
    internal static extern unsafe int s810705513161004(
      ulong s807304015674435,
      string s608670434897797,
      s134995860702422.s927874108563264* s410404561390610,
      uint s690634478302600);

    [DllImport("advapi32.dll", EntryPoint = "OpenProcessToken", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool s214165393450261(
      [In] IntPtr s931567783851984,
      [In] uint s376277687444307,
      out IntPtr s624375088121524);

    [DllImport("advapi32.dll", EntryPoint = "GetTokenInformation", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool s222369807835353(
      IntPtr s767285469919526,
      s134995860702422.s024871839978819 s624429151784363,
      IntPtr s996427412053782,
      int s208974045737156,
      out int s620739699744708);

    [DllImport("advapi32.dll", EntryPoint = "AdjustTokenPrivileges", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    internal static extern bool s338578429339941(
      [In] IntPtr s289576166957417,
      [MarshalAs(UnmanagedType.Bool), In] bool s043127173350425,
      [In] ref s134995860702422.s977231405203592 s185965953355254,
      [In] uint s988623076232236,
      [In] IntPtr s575586909355085,
      [In] IntPtr s344494958617793);

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle")]
    internal static extern int s358916137439005([In] IntPtr s049921935158693);

    internal static int s386271101430851()
    {
      int lastWin32Error = Marshal.GetLastWin32Error();
      return ((long) lastWin32Error & 2147483648L) == 2147483648L ? lastWin32Error : lastWin32Error & (int) ushort.MaxValue | -2147024896;
    }

    internal static void s006339029243813(uint s104257612766324)
    {
      Process currentProcess = Process.GetCurrentProcess();
      IntPtr s624375088121524 = IntPtr.Zero;
      if (!s134995860702422.s214165393450261(currentProcess.s220530964825230(), s134995860702422.s811982584997386, out s624375088121524))
        throw new Win32Exception();
      GC.KeepAlive((object) currentProcess);
      s134995860702422.s977231405203592 s185965953355254 = new s134995860702422.s977231405203592();
      // ISSUE: cast to a reference type
      // ISSUE: explicit reference operation
      (^(s134995860702422.s024871839978819&) ref s185965953355254).s773754109769696 = 1U;
      // ISSUE: cast to a reference type
      // ISSUE: explicit reference operation
      (^(s134995860702422.s977231405203592&) ref s185965953355254.s103257786292581).s251269570530799 = s104257612766324;
      s185965953355254.s212915887937859 = 2U;
      bool flag = s134995860702422.s338578429339941(s624375088121524, false, ref s185965953355254, 0U, IntPtr.Zero, IntPtr.Zero);
      s134995860702422.s358916137439005(s624375088121524);
      if (!flag)
        throw new Win32Exception();
    }

    internal static unsafe bool? s884477392058641()
    {
      Process currentProcess = Process.GetCurrentProcess();
      IntPtr s624375088121524 = IntPtr.Zero;
      if (!s134995860702422.s214165393450261(currentProcess.s220530964825230(), s134995860702422.s040523981478460, out s624375088121524))
        return new bool?();
      int num = 0;
      bool flag = s134995860702422.s222369807835353(s624375088121524, (s134995860702422.s024871839978819) 20, (IntPtr) (void*) &num, 4, out int _);
      s134995860702422.s358916137439005(s624375088121524);
      if (!flag)
        return new bool?();
      GC.KeepAlive((object) currentProcess);
      return new bool?(num != 0);
    }

    internal static int s378247297349470(int s697879424542264) => s697879424542264 == 0 ? 0 : -2147024896 | s697879424542264 & (int) ushort.MaxValue;

    [DllImport("tdh.dll", EntryPoint = "TdhEnumerateProviders")]
    internal static extern unsafe int s192074354841133(
      s134995860702422.s380092122726970* s860027619811931,
      ref int s952838924309277);

    [DllImport("advapi32.dll", EntryPoint = "EnumerateTraceGuidsEx")]
    internal static extern unsafe int s385611622648092(
      s134995860702422.s115323245773962 s491589491517248,
      void* s804192455995573,
      int s421256086387135,
      void* s600365558577234,
      int s393396961938704,
      ref int s605595431100712);

    [DllImport("tdh.dll", EntryPoint = "TdhEnumerateProviderFieldInformation")]
    internal static extern unsafe int s069013651080841(
      ref Guid s876342582620559,
      s134995860702422.s146527992529525 s403236973445898,
      s134995860702422.s677059167917028* s973728798131810,
      ref int s657163040766472);

    [DllImport("ntdll.dll", EntryPoint = "RtlDecompressBuffer")]
    internal static extern unsafe int s721979027305321(
      int s880409659265165,
      byte* s205030961474861,
      int s386758875027010,
      byte* s297004222614594,
      int s748803455441933,
      out int s568329610725316);

    [StructLayout(LayoutKind.Sequential, Size = 172, CharSet = CharSet.Unicode)]
    internal struct s684425418531571
    {
      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
      public string s011703722048314;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 8, ArraySubType = UnmanagedType.U2)]
      public ushort[] s931176254871466;
      public uint s576361881715456;
      [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
      public string s147957865289254;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 8, ArraySubType = UnmanagedType.U2)]
      public ushort[] s589206687472879;
      public uint s144313151984565;
      public uint s184782923360651;
    }

    internal delegate bool s125395808530277([In] IntPtr logfile);

    internal unsafe delegate void s587787545948605([In] s134995860702422.s648877553938236* rawData);

    internal struct s779020505576281
    {
      public uint s604444489416260;
      public ulong s226439252990974;
      public ulong s180926998344072;
      public Guid s888372227343298;
      public uint s272086062055498;
      public uint s092219256159407;
      public s134995860702422.s779020505576281 s868273599901471;
    }

    internal struct s927874108563264
    {
      public uint s113720883508238;
      public uint s645081911767236;
      public uint s190351463811142;
      public uint s165309352492141;
      public uint s770207582060979;
      public uint s642486313015108;
      public uint s561877238766649;
      public int s345502736513613;
      public uint s369308870131760;
      public uint s608774713554192;
      public uint s571206793998592;
      public uint s498080461776508;
      public uint s647459563159706;
      public uint s246080686566222;
      public IntPtr s489250297576083;
      public uint s634666398464007;
      public uint s411272018307633;
      [SpecialName]
      public int value__;
    }

    internal enum s369878147171815
    {
      Sequence = 1,
      Guid = 2,
      ComponentId = 4,
      Timestamp = 8,
      PerformanceTimestamp = 16, // 0x00000010
      SystemInfo = 32, // 0x00000020
      FlagMask = 65535, // 0x0000FFFF
    }

    internal struct s555154128632491
    {
      public ushort s834408183793458;
      public byte s933590576796686;
      public byte s207572685420876;
      public ushort s965933474340595;
      public int s920751472915360;
      public int s042376375858325;
      public long s816765622584717;
      public Guid s584075644725622;
      public int s996059550643477;
      public int s878329904771670;
      public s134995860702422.s555154128632491 s371186859926300;
    }

    internal struct s707627100864256
    {
      public uint s518468876120788;
      public uint s423560638518663;
      public Guid s253618201159628;
      public IntPtr s634827475661007;
      public int s255988909255887;
      public s134995860702422.s728170393225391 s123025735480027;
      public uint s390300984873936;
    }

    internal struct s946185085699064
    {
      public uint s786171113064152;
      public uint s359644292200288;
      public uint s001707118362430;
      public long s180987607384559;
      public uint s520534386432943;
      public uint s161792230788821;
      public uint s926409279683427;
      public uint s818381748980105;
      public uint s864742174244444;
      public uint s316055626492950;
      public uint s000612104905212;
      public uint s134375601643720;
      public IntPtr s560933548945779;
      public IntPtr s313285194440098;
      public s134995860702422.s684425418531571 s642460939873559;
      public long s887317389268446;
      public long s825931265472475;
      public long s564781123773866;
      public uint s075616904136346;
      public uint s166262315466188;
      [MarshalAs(UnmanagedType.LPWStr)]
      public string s131630845090160;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    internal struct s850980203428386
    {
      [MarshalAs(UnmanagedType.LPWStr)]
      public string s543571982771719;
      public long s392496368343184;
      public uint s534918413419460;
      public uint s630986022097681;
      public s134995860702422.s707627100864256 s831850513732863;
      public s134995860702422.s946185085699064 s880850005545107;
      public s134995860702422.s125395808530277 s790674858243490;
      public int s994540283959721;
      public int s992144760200807;
      public int s023448431211657;
      public s134995860702422.s587787545948605 s664556397216870;
      public int s078119167012261;
      public IntPtr s102413429300544;
      [SpecialName]
      public int value__;
    }

    internal enum s267532197552653
    {
      TraceGuidQueryList,
      TraceGuidQueryInfo,
      TraceGuidQueryProcess,
      TraceStackTracingInfo,
      TraceSystemTraceEnableFlagsInfo,
      TraceSampledProfileIntervalInfo,
      TraceProfileSourceConfigInfo,
      TraceProfileSourceListInfo,
      TracePmcEventListInfo,
      TracePmcCounterListInfo,
      MaxTraceSetInfoClass,
    }

    internal struct s782533197164731
    {
      public byte s837304220322178;
      public unsafe fixed byte s484556185510522[7];
      public int s175459558449861;
    }

    internal struct s609320491393639
    {
      public int s438948875068453;
      public int s622091904703627;
    }

    internal struct s151130862077355
    {
      public int s541794053135542;
      public int s491453258757279;
      public int s882440872649825;
      public ulong s754442233288869;
      public ushort s268754456213039;
    }

    internal struct s436029036576468
    {
      public ushort s726005636907936;
      public ushort s957198854550732;
      public ushort s080947173795608;
      public int s722228102271116;
      public int s001274643318731;
      public long s473266651679490;
      public Guid s865414040669856;
      public ushort s301818044239639;
      public byte s000023591405563;
      public byte s816513250301111;
      public byte s306420005180068;
      public byte s611740701286585;
      public ushort s257682586122654;
      public ulong s950345267192601;
      public int s480278647661808;
      public int s854368281614676;
      public Guid s635439134125331;
      public byte s595311907690614;
    }

    internal struct s728170393225391
    {
      public byte s515698815449612;
      public ushort s215258861770835;
      public s134995860702422.s436029036576468 s870227314561507;
    }

    internal struct s648877553938236
    {
      public s134995860702422.s728170393225391 s785824337853710;
      public ushort s934424027936993;
      public ushort s855605335439496;
      public unsafe s134995860702422.s042871462687652* s884679247404646;
      public IntPtr s066345635431405;
      public IntPtr s479016654261768;
      public ushort s734589091883798;
    }

    internal struct s042871462687652
    {
      public ushort s270740346342371;
      public ushort s353334766405151;
      public ushort s711754183083976;
      public ulong s566029008717659;
      public ulong s139700591235889;
    }

    internal struct s025896498123982
    {
      public unsafe fixed uint s295876969861776[1];
      public ulong s643913352313661;
    }

    internal struct s619021218427252
    {
      public unsafe fixed ulong s337163297528096[1];
      public unsafe byte* s463869369571601;
    }

    [StructLayout(LayoutKind.Explicit)]
    internal struct s978582079522627
    {
      [FieldOffset(8)]
      public int s704485487021127;
      [FieldOffset(12)]
      public int s684836206159172;
      public byte s963438547999557;
    }

    internal struct s354715168584383
    {
      public byte s041556335432025;
      public ushort s492201341033861;
      public unsafe fixed ushort s889353560957723[1];
      public uint s911801933145130;
    }

    internal struct s506974201724280
    {
      public uint s512056497173895;
      public uint s255607168517564;
      public Guid s852311850814712;
      public unsafe s134995860702422.s978582079522627* s410739269550137;
      public int s321976833129537;
      [SpecialName]
      public int value__;
    }

    internal enum s622293801659607
    {
      TokenElevationTypeDefault = 1,
      TokenElevationTypeFull = 2,
      TokenElevationTypeLimited = 3,
    }

    internal enum s024871839978819
    {
      TokenUser = 1,
      TokenGroups = 2,
      TokenPrivileges = 3,
      TokenOwner = 4,
      TokenPrimaryGroup = 5,
      TokenDefaultDacl = 6,
      TokenSource = 7,
      TokenType = 8,
      TokenImpersonationLevel = 9,
      TokenStatistics = 10, // 0x0000000A
      TokenRestrictedSids = 11, // 0x0000000B
      TokenSessionId = 12, // 0x0000000C
      TokenGroupsAndPrivileges = 13, // 0x0000000D
      TokenSessionReference = 14, // 0x0000000E
      TokenSandBoxInert = 15, // 0x0000000F
      TokenAuditPolicy = 16, // 0x00000010
      TokenOrigin = 17, // 0x00000011
      TokenElevationType = 18, // 0x00000012
      TokenLinkedToken = 19, // 0x00000013
      TokenElevation = 20, // 0x00000014
      TokenHasRestrictions = 21, // 0x00000015
      TokenAccessInformation = 22, // 0x00000016
      TokenVirtualizationAllowed = 23, // 0x00000017
      TokenVirtualizationEnabled = 24, // 0x00000018
      TokenIntegrityLevel = 25, // 0x00000019
      TokenUIAccess = 26, // 0x0000001A
      TokenMandatoryPolicy = 27, // 0x0000001B
      TokenLogonSid = 28, // 0x0000001C
      MaxTokenInfoClass = 29, // 0x0000001D
    }

    internal struct s977231405203592
    {
      public s134995860702422.s769721919807420 s103257786292581;
      public uint s212915887937859;
      public uint s251269570530799;
    }

    internal struct s769721919807420
    {
      public int s153230621831390;
      public Guid s003831940355958;
    }

    internal struct s831506793110629
    {
      public int s846099949385245;
      public int s061545196479761;
      public int s462809342415848;
    }

    internal struct s380092122726970
    {
      public int s459969091585599;
      [SpecialName]
      public int value__;
    }

    internal enum s115323245773962
    {
      TraceGuidQueryList,
      TraceGuidQueryInfo,
      TraceGuidQueryProcess,
      TraceStackTracingInfo,
      MaxTraceSetInfoClass,
    }

    internal struct s798601121368304
    {
      public int s551626229222360;
      public int s762712816067515;
    }

    internal struct s234765852428476
    {
      public int s803243845059312;
      public int s019465106331051;
      public int s685310075686168;
      public int s529390478797870;
    }

    internal struct s138699372264905
    {
      public byte s829847034118868;
      public byte s933407359122262;
      public ushort s670419094421919;
      public int s571722068533399;
      public int s414807004544153;
      public long s800299440054191;
      public long s701272911595391;
      [SpecialName]
      public int value__;
    }

    internal enum s146527992529525
    {
      EventKeywordInformation,
      EventLevelInformation,
      EventChannelInformation,
      EventTaskInformation,
      EventOpcodeInformation,
      EventInformationMax,
    }

    internal struct s677059167917028
    {
      public s134995860702422.s146527992529525 s706312407709021;
      public int s736084535626122;
    }

    internal struct s538871105697333
    {
      public int s320903732993496;
      public ulong s486321307168695;
      public unsafe Guid* s647453830311318;
    }
  }
}
