// Decompiled with JetBrains decompiler
// Type: gzTwUa6bnguQt.wE4Y3ekFPQJsA
// Assembly: Udby4Jt48oXkJ, Version=3.17.2.31, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 37899E89-D673-4F5B-A193-2E4DF6A54096
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-bf535869266eca7a958714acade2ede1bff0e73f0aaa2702f389ededee6a8d6a.exe

using \u0033s1eDqxyulHOR;
using \u0036L2LozIEXTU3P;
using \u0036mHL90hQ651VX;
using Fk2s1vtXcuFJF;
using HqLTLdqt37SZu;
using lqWc8fBl1n0fS;
using Q4XJ5K3dbXZ2g;
using System;
using System.ComponentModel;
using System.Threading;
using System.Windows.Forms;

namespace gzTwUa6bnguQt
{
  internal class wE4Y3ekFPQJsA : GVVSSvKR4Ru0m, IDisposable
  {
    private const int PoAqPXaymkKTz = 250;
    private const int iRBtSgv4v4wxa = 2000;
    private bool WtRMSBPHnzCQ0;
    private WindowsFormsSynchronizationContext \u0034qxfezcn5jn8i;
    private n1IcPKd2Lx0L1 \u0031z98twD5xTGrk;
    private Exception AhyK3Jp9Pn61j;
    private ManualResetEvent ce11GPD9NfsiS;
    private HiNYYdZ8DoAj4 wsoGS8FHh2QvT;

    public wE4Y3ekFPQJsA() => this.ce11GPD9NfsiS = new ManualResetEvent(false);

    ~wE4Y3ekFPQJsA() => this.Dispose(false);

    public void \u0035SC0pTbqfobTk()
    {
      this.Dispose(true);
      GC.SuppressFinalize((object) this);
    }

    private void \u00397JdrrCMmxwNt(Thread pMcVa1eQnR7Lq)
    {
      long millisecondsTimeout = 2000;
      long ticks = DateTime.Now.Ticks;
      if (!this.ce11GPD9NfsiS.WaitOne((int) millisecondsTimeout))
        return;
      long num1 = (DateTime.Now.Ticks - ticks) / 10000L;
      long num2 = millisecondsTimeout - num1;
      if (pMcVa1eQnR7Lq.Join(num2 > 0L ? (int) num2 : 0))
        return;
      Up2ciG6wVdM5T.xgsfAAH34Fgnl.\u0031CII3TGnWWaPA.wRuYhG7t3Jqcm((Up2ciG6wVdM5T) null, "Silent login thread did not complete on time.", "E:\\A\\_work\\115\\s\\src\\Microsoft.IdentityModel.Clients.ActiveDirectory\\Platforms\\net45\\wE4Y3ekFPQJsA.cs");
      this.\u0034qxfezcn5jn8i.Post((SendOrPostCallback) (SfxwDsATjcDZd => this.wsoGS8FHh2QvT.dKKrlSKtY9j2c()), (object) null);
    }

    private Thread cJ2j4N7p83CHv()
    {
      Thread thread = new Thread((ThreadStart) (() =>
      {
        try
        {
          this.\u0034qxfezcn5jn8i = new WindowsFormsSynchronizationContext();
          this.wsoGS8FHh2QvT = new HiNYYdZ8DoAj4(this.t9z9sFJHPnOw6)
          {
            dlAzoYIbaDV0K = 250
          };
          // ISSUE: method pointer
          this.wsoGS8FHh2QvT.\u0034GN6EEKvVH8ZN += (HiNYYdZ8DoAj4.mXulKMlchhj48) new y9WeDGzdnipVD.kGzPNOSVgQdW3((object) this, __methodptr(B3kmj5yI0DYy2));
          this.ce11GPD9NfsiS.Set();
          this.wsoGS8FHh2QvT.P4rKZ4TIm2uvR(this.KiM3orl65TCQL, this.q04lSBNwyY4tk);
          Application.Run();
          this.\u0031z98twD5xTGrk = this.wsoGS8FHh2QvT.pTbTuawjd8mjE;
        }
        catch (Exception ex)
        {
          this.AhyK3Jp9Pn61j = ex;
        }
      }));
      thread.SetApartmentState(ApartmentState.STA);
      thread.IsBackground = true;
      thread.Start();
      return thread;
    }

    protected override n1IcPKd2Lx0L1 OnAuthenticate()
    {
      if ((Uri) null == this.q04lSBNwyY4tk)
        throw new InvalidOperationException("CallbackUri cannot be null");
      this.\u00397JdrrCMmxwNt(this.cJ2j4N7p83CHv());
      this.\u0038MkwS6W4r40cQ();
      this.\u0037kN70ZVH44UFw();
      return this.\u0031z98twD5xTGrk != null ? this.\u0031z98twD5xTGrk : throw new LlM9VbgWu20VY("user_interaction_required");
    }

    protected virtual void Dispose(bool disposing)
    {
      if (this.WtRMSBPHnzCQ0)
        return;
      if (disposing)
      {
        if (this.ce11GPD9NfsiS != null)
        {
          this.ce11GPD9NfsiS.Dispose();
          this.ce11GPD9NfsiS = (ManualResetEvent) null;
        }
        if (this.\u0034qxfezcn5jn8i != null)
        {
          this.\u0034qxfezcn5jn8i.Dispose();
          this.\u0034qxfezcn5jn8i = (WindowsFormsSynchronizationContext) null;
        }
      }
      this.WtRMSBPHnzCQ0 = true;
    }

    private void \u0038MkwS6W4r40cQ()
    {
      this.ce11GPD9NfsiS.Dispose();
      this.ce11GPD9NfsiS = (ManualResetEvent) null;
    }

    private void \u0037kN70ZVH44UFw()
    {
      if (this.AhyK3Jp9Pn61j != null)
        throw this.AhyK3Jp9Pn61j;
    }

    private void B3kmj5yI0DYy2(object ap8ye7ordmn0h, \u0035rskoHrOVZ8wX dyPP9BfbLcASk)
    {
      if (this.AhyK3Jp9Pn61j == null)
        this.AhyK3Jp9Pn61j = dyPP9BfbLcASk.i0FmroC6meqRD;
      ((Component) ap8ye7ordmn0h).Dispose();
      Application.ExitThread();
    }
  }
}
