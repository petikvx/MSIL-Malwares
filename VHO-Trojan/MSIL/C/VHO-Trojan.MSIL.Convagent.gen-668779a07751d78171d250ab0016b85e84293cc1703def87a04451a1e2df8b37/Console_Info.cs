// Decompiled with JetBrains decompiler
// Type: ModuleNameSpace.Console_Info
// Assembly: installer, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BE36CCF7-21FD-4261-9C31-8B7F15D1A5A7
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\VHO-Trojan.MSIL.Convagent.gen-668779a07751d78171d250ab0016b85e84293cc1703def87a04451a1e2df8b37.exe

using System;
using System.Runtime.InteropServices;

namespace ModuleNameSpace
{
  public class Console_Info
  {
    [DllImport("Kernel32.dll")]
    private static extern UIntPtr GetStdHandle(Console_Info.STDHandle stdHandle);

    [DllImport("Kernel32.dll")]
    private static extern Console_Info.FileType GetFileType(UIntPtr hFile);

    public static bool IsInputRedirected()
    {
      switch (Console_Info.GetFileType(Console_Info.GetStdHandle(Console_Info.STDHandle.STD_INPUT_HANDLE)))
      {
        case Console_Info.FileType.FILE_TYPE_UNKNOWN:
        case Console_Info.FileType.FILE_TYPE_CHAR:
          return false;
        default:
          return true;
      }
    }

    public static bool IsOutputRedirected()
    {
      switch (Console_Info.GetFileType(Console_Info.GetStdHandle(Console_Info.STDHandle.STD_OUTPUT_HANDLE)))
      {
        case Console_Info.FileType.FILE_TYPE_UNKNOWN:
        case Console_Info.FileType.FILE_TYPE_CHAR:
          return false;
        default:
          return true;
      }
    }

    public static bool IsErrorRedirected()
    {
      switch (Console_Info.GetFileType(Console_Info.GetStdHandle(Console_Info.STDHandle.STD_ERROR_HANDLE)))
      {
        case Console_Info.FileType.FILE_TYPE_UNKNOWN:
        case Console_Info.FileType.FILE_TYPE_CHAR:
          return false;
        default:
          return true;
      }
    }

    private enum FileType : uint
    {
      FILE_TYPE_UNKNOWN = 0,
      FILE_TYPE_DISK = 1,
      FILE_TYPE_CHAR = 2,
      FILE_TYPE_PIPE = 3,
      FILE_TYPE_REMOTE = 32768, // 0x00008000
    }

    private enum STDHandle : uint
    {
      STD_ERROR_HANDLE = 4294967284, // 0xFFFFFFF4
      STD_OUTPUT_HANDLE = 4294967285, // 0xFFFFFFF5
      STD_INPUT_HANDLE = 4294967286, // 0xFFFFFFF6
    }
  }
}
