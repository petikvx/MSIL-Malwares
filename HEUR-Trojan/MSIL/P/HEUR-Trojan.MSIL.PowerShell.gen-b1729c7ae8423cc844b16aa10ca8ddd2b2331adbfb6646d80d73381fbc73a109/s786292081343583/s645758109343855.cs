// Decompiled with JetBrains decompiler
// Type: s786292081343583.s645758109343855
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s051718566454480;
using s077414222832753;
using s221898826379252;
using s354939329968896;
using s422780355303668;
using s928707304529159;
using s953876051832419;
using System;
using System.Reflection;

namespace s786292081343583
{
  public class s645758109343855
  {
    private static char[] s913813758475584 = new char[2]
    {
      '\\',
      '/'
    };
    private readonly s645758109343855.s650893925187870<string> s409533836917689;
    private readonly s837522568912988 s693385753351873;
    private readonly s645758109343855.s650893925187870<s645758109343855.s167065620095923> s409160999272807;
    private readonly s645758109343855.s650893925187870<s645758109343855.s655967451091644> s585607851533027;
    private readonly s275977756270514 s168213494293929;
    private readonly s457867646003930 s449200796587353;
    private readonly s837522568912988 s653528567608268;

    public s645758109343855(
      int estNumCallStacks = 5000,
      int estNumFrames = 1000,
      int estNumModules = 100,
      s275977756270514 frameStartIndex = s275977756270514.Start,
      s457867646003930 callStackStartIndex = s457867646003930.Start,
      s837522568912988 moduleStackStartIndex = s837522568912988.Start)
    {
      this.s409533836917689 = new s645758109343855.s650893925187870<string>(estNumModules);
      this.s409160999272807 = new s645758109343855.s650893925187870<s645758109343855.s167065620095923>(estNumFrames);
      this.s585607851533027 = new s645758109343855.s650893925187870<s645758109343855.s655967451091644>(estNumCallStacks);
      if (frameStartIndex < s275977756270514.Start)
        frameStartIndex = s275977756270514.Start;
      if (callStackStartIndex < s457867646003930.Start)
        callStackStartIndex = s457867646003930.Start;
      if (moduleStackStartIndex < s837522568912988.Start)
        moduleStackStartIndex = s837522568912988.Start;
      this.s168213494293929 = frameStartIndex;
      this.s449200796587353 = callStackStartIndex;
      this.s653528567608268 = moduleStackStartIndex;
      this.s693385753351873 = this.s419281735299726("");
    }

    public void s784335591463612()
    {
      this.s409533836917689.DoneInterning();
      this.s409160999272807.DoneInterning();
      this.s585607851533027.DoneInterning();
    }

    public s457867646003930 s605232597024656 => this.s449200796587353;

    public s275977756270514 s518224413015985 => this.s168213494293929;

    public s457867646003930 s430028063152814(s457867646003930 s810308360030386) => this.s585607851533027.get_Item(s810308360030386 - this.s449200796587353).s678009443410445;

    public s275977756270514 s323927537074275(s457867646003930 s547337960401437) => this.s585607851533027.get_Item(s547337960401437 - this.s449200796587353).s573421213927618;

    public string s225064114498404(s275977756270514 s487897211828150, bool s755165509288237)
    {
      int index = s487897211828150 - this.s168213494293929;
      string s377788784981894 = this.s409160999272807.get_Item(index).s377788784981894;
      // ISSUE: reference to a compiler-generated field
      s275977756270514 s090375060409642 = this.s409160999272807.get_Item(index).s090375060409642;
      if (s090375060409642 != s275977756270514.Invalid)
        return (this.s696400992757193 == null ? "Frame " + ((int) s090375060409642).ToString() : this.s696400992757193(s090375060409642, s755165509288237)) + " " + s377788784981894;
      string str = this.s409533836917689.get_Item(this.s409160999272807.get_Item(index).s414372656946989 - this.s653528567608268);
      if (str.Length == 0)
        return s377788784981894;
      if (!s755165509288237)
      {
        int num = str.LastIndexOfAny(s645758109343855.s913813758475584);
        if (0 <= num)
          str = str.Substring(num + 1);
      }
      int length = str.LastIndexOf('.');
      if (length == str.Length - 4 && (str.EndsWith(".dll", StringComparison.OrdinalIgnoreCase) || str.EndsWith(".exe", StringComparison.OrdinalIgnoreCase)))
        str = str.Substring(0, length);
      return str + "!" + s377788784981894;
    }

    public s837522568912988 s486240339109251(s275977756270514 s242892449722122) => this.s409160999272807.get_Item(s242892449722122 - this.s168213494293929).s414372656946989;

    public Func<s275977756270514, bool, string> s696400992757193 { get; set; }

    public s837522568912988 s419281735299726(string s427663326934676) => this.s409533836917689.Intern(s427663326934676) + this.s653528567608268;

    public s275977756270514 s092839873163377(
      string s332553731891874,
      s837522568912988 s147229177564244 = s837522568912988.Invalid)
    {
      if (s147229177564244 == s837522568912988.Invalid)
        s147229177564244 = this.s693385753351873;
      // ISSUE: object of a compiler-generated type is created
      return this.s409160999272807.Intern((s645758109343855.s167065620095923) new s092555338895803.s687494092429592(s332553731891874, s147229177564244)) + this.s168213494293929;
    }

    public s275977756270514 s329371596279496(
      s275977756270514 s879718286484434,
      string s565698176353671)
    {
      return this.s409160999272807.Intern(new s645758109343855.s167065620095923(s565698176353671, s879718286484434)) + this.s168213494293929;
    }

    public s457867646003930 s649303816154062(
      s275977756270514 s249187515290763,
      s457867646003930 s506535691979223)
    {
      return this.s585607851533027.Intern((s645758109343855.s655967451091644) new s645758109343855.s167065620095923(s249187515290763, s506535691979223)) + this.s449200796587353;
    }

    public int s522124855833794 => this.s409160999272807.s305107438545332;

    public int s388701355735021 => this.s585607851533027.s305107438545332;

    private struct s167065620095923 : IEquatable<s645758109343855.s167065620095923>
    {
      public readonly s837522568912988 s414372656946989;
      public readonly string s377788784981894;
      public readonly s275977756270514 s573421213927618;

      public s167065620095923(string frameSuffix, s275977756270514 baseFrame)
      {
        this.s414372656946989 = s837522568912988.Invalid;
        // ISSUE: cast to a reference type
        // ISSUE: explicit reference operation
        // ISSUE: reference to a compiler-generated field
        (^(s092555338895803.s687494092429592&) ref this).s090375060409642 = baseFrame;
        this.s377788784981894 = frameSuffix;
      }

      public virtual int s063278569459098() => (int) (this.s414372656946989 + (int) (^(s092555338895803.s687494092429592&) ref this).s090375060409642 + this.s377788784981894.GetHashCode());

      public virtual bool s001496751964833(object s256785913837724) => throw new NotImplementedException();

      public bool s618190111750412(s645758109343855.s167065620095923 s839347980943659) => this.s414372656946989 == s839347980943659.s414372656946989 && (^(s092555338895803.s687494092429592&) ref this).s090375060409642 == s839347980943659.s090375060409642 && this.s377788784981894 == s839347980943659.s377788784981894;

      public s167065620095923(s275977756270514 frameIndex, s457867646003930 callerIndex)
      {
        this.s573421213927618 = frameIndex;
        // ISSUE: cast to a reference type
        // ISSUE: explicit reference operation
        (^(s645758109343855.s655967451091644&) ref this).s678009443410445 = callerIndex;
      }
    }

    private struct s655967451091644 : IEquatable<s645758109343855.s655967451091644>
    {
      public readonly s457867646003930 s678009443410445;
      private s645758109343855.s650893925187870<T0>.s127851203630739[] s653510417952313;

      public virtual int s652409334955103() => (int) (this.s678009443410445 + (int) (^(s645758109343855.s167065620095923&) ref this).s573421213927618 * 65536);

      public virtual bool s979529059670554(object s644252711156523) => throw new NotImplementedException();

      public bool s507737767414799(s645758109343855.s655967451091644 s707030114314483) => (^(s645758109343855.s167065620095923&) ref this).s573421213927618 == s707030114314483.s573421213927618 && this.s678009443410445 == s707030114314483.s678009443410445;

      public s655967451091644(int initialCapacity = 0)
      {
        // ISSUE: explicit constructor call
        ((object) ref this).\u002Ector();
        ((s645758109343855.s650893925187870<T0>) ref this).Resize(initialCapacity);
      }
    }

    [DefaultMember("Item")]
    private class s650893925187870<T> where T : IEquatable<T>
    {
      private T[] s487214696100873;
      private int s289634304093626;
      public s045113750567070 s034655998058606;

      public int s305107438545332 => this._count;

      public T get_Item(int index) => this._entries[index];

      public int s916637604863829(T s691562475971000)
      {
        int index1 = this.BucketNumberFromValue(s691562475971000);
        for (int index2 = this._buckets[index1]._head; index2 >= 0; index2 = this._buckets[index2]._next)
        {
          if (this._entries[index2].Equals(s691562475971000))
            return index2;
        }
        if (this._count == this._entries.Length)
        {
          int num = this._count * 2 + 1;
          if (num <= this._count)
            num = int.MaxValue;
          if (num <= this._count)
            throw new OutOfMemoryException();
          this.Resize(num);
          index1 = this.BucketNumberFromValue(s691562475971000);
        }
        int index3 = this._count++;
        this._entries[index3] = s691562475971000;
        this._buckets[index3]._next = this._buckets[index1]._head;
        this._buckets[index1]._head = index3;
        return index3;
      }

      public void s164275047487820()
      {
        this._buckets = (s645758109343855.s650893925187870<T>.s127851203630739[]) null;
        if (this._count >= this._entries.Length / 4 * 3)
          return;
        Array.Resize<T>(ref this._entries, this._count);
      }

      private int s247026137237567(T s367034215385227) => s645758109343855.s650893925187870<T>.BucketNumberFromValue(s367034215385227, this._buckets.Length);

      private static int s311819278689905(T s239586943547971, int s523193965894589) => (int) ((uint) s239586943547971.GetHashCode() % (uint) s523193965894589);

      private void s203135144978480(int s388545242409199)
      {
        s645758109343855.s650893925187870<T>.s127851203630739[] s127851203630739Array = new s645758109343855.s650893925187870<T>.s127851203630739[s388545242409199];
        for (int index = 0; index < s127851203630739Array.Length; ++index)
          s127851203630739Array[index]._head = -1;
        T[] destinationArray = new T[s388545242409199];
        if (this._entries != null)
        {
          Array.Copy((Array) this._entries, 0, (Array) destinationArray, 0, this._count);
          for (int index1 = 0; index1 < this._count; ++index1)
          {
            int index2 = s645758109343855.s650893925187870<T>.BucketNumberFromValue(destinationArray[index1], s388545242409199);
            s127851203630739Array[index1]._next = s127851203630739Array[index2]._head;
            s127851203630739Array[index2]._head = index1;
          }
        }
        this._buckets = s127851203630739Array;
        this._entries = destinationArray;
      }

      public static s220468656497021.s735365250405810 s706989176055072(
        s045113750567070 s190393171716610,
        s220468656497021.s735365250405810 s242896541718277)
      {
        return !s220468656497021.s735365250405810.s820059826356585(s190393171716610, s242896541718277) ? new s220468656497021.s735365250405810(s190393171716610, s242896541718277) : s242896541718277;
      }

      private struct s127851203630739
      {
        public int s350149075929656;
        public s136528962726033 s628325718500880;
      }
    }
  }
}
