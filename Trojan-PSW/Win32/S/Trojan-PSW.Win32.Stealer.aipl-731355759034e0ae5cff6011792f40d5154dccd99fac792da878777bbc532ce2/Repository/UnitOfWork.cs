// Decompiled with JetBrains decompiler
// Type: Repository.UnitOfWork
// Assembly: AnsiCharMarsha, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 45449883-CB33-464D-BFFF-85C1D8F95247
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\Trojan-PSW.Win32.Stealer.aipl-731355759034e0ae5cff6011792f40d5154dccd99fac792da878777bbc532ce2.exe

using Core;
using Core.Helpers;
using Core.Infrastructure;
using System;

namespace Repository
{
  public class UnitOfWork : DisposableResource, IUnitOfWork, IDisposable
  {
    private readonly IDatabase _database;
    private bool _isDisposed;

    public UnitOfWork(IDatabase database)
    {
      Checks.Argument.IsNotNull((object) database, nameof (database));
      this._database = database;
    }

    public UnitOfWork(IDatabaseFactory factory)
      : this(factory.Get())
    {
    }

    public virtual void Commit()
    {
      if (this._isDisposed)
        throw new ObjectDisposedException(this.GetType().Name);
      this._database.SubmitChanges();
    }

    protected override void Dispose(bool disposing)
    {
      if (!this._isDisposed)
        this._isDisposed = true;
      base.Dispose(disposing);
    }
  }
}
