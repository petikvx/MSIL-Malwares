// Decompiled with JetBrains decompiler
// Type: tQzmr1hgjn6ER.zdxmMQPSP3o89
// Assembly: Udby4Jt48oXkJ, Version=3.17.2.31, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 37899E89-D673-4F5B-A193-2E4DF6A54096
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-bf535869266eca7a958714acade2ede1bff0e73f0aaa2702f389ededee6a8d6a.exe

using \u0036mHL90hQ651VX;
using dyHCVWuthaSsK;
using hzKfaT7pDOlpa;
using mhZ8amQVr4JAO;
using pS5NmjNcWKtJP;
using rremZdV0lo9Ty;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Net;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;
using System.Text;
using wRO897uUcpmYd;
using ycNEQ41bQU0eP;

namespace tQzmr1hgjn6ER
{
  [DataContract]
  internal class zdxmMQPSP3o89
  {
    private const string p82SxBXbWArs6 = "correlation_id";

    [DataMember(IsRequired = false, Name = "token_type")]
    public string aBWB7aY2nDLEK { get; set; }

    [DataMember(IsRequired = false, Name = "access_token")]
    public string Lz4vVPwuLW48K { get; set; }

    [DataMember(IsRequired = false, Name = "refresh_token")]
    public string mX5L16XtxWVro { get; set; }

    [DataMember(IsRequired = false, Name = "resource")]
    public string SLOCXXouwvPRt { get; set; }

    [DataMember(IsRequired = false, Name = "id_token")]
    public string \u0035mws9nsNnRNfR { get; set; }

    [DataMember(IsRequired = false, Name = "created_on")]
    public long pARHkgGCaSlV0 { get; set; }

    [DataMember(IsRequired = false, Name = "expires_on")]
    public long HavpstGouWMrg { get; set; }

    [DataMember(IsRequired = false, Name = "expires_in")]
    public long UyTfKPo71kggQ { get; set; }

    [DataMember(IsRequired = false, Name = "ext_expires_in")]
    public long LelxiE3qlw0iV { get; set; }

    [DataMember(IsRequired = false, Name = "error")]
    public string \u0033QwYdi6HVyJsZ { get; set; }

    [DataMember(IsRequired = false, Name = "error_description")]
    public string \u00301LcsP5ItuhkO { get; set; }

    [DataMember(IsRequired = false, Name = "error_codes")]
    public string[] QG7jrOJyAwS3r { get; set; }

    [DataMember(IsRequired = false, Name = "correlation_id")]
    public string DXGOierdKLIxN { get; set; }

    [DataMember(IsRequired = false, Name = "claims")]
    public string D803OK3JFgZ24 { get; set; }

    public string E8asExutYHHmw { get; set; }

    internal static zdxmMQPSP3o89 Ik75alml1Stpq(
      IDictionary<string, string> Z0JVYZVJWqJ8N)
    {
      if (Z0JVYZVJWqJ8N.ContainsKey("error_description"))
        return new zdxmMQPSP3o89()
        {
          \u0033QwYdi6HVyJsZ = Z0JVYZVJWqJ8N["error"],
          \u00301LcsP5ItuhkO = Z0JVYZVJWqJ8N["error_description"]
        };
      return new zdxmMQPSP3o89()
      {
        Lz4vVPwuLW48K = Z0JVYZVJWqJ8N["access_token"],
        mX5L16XtxWVro = Z0JVYZVJWqJ8N["refresh_token"],
        \u0035mws9nsNnRNfR = Z0JVYZVJWqJ8N["id_token"],
        aBWB7aY2nDLEK = "Bearer",
        DXGOierdKLIxN = Z0JVYZVJWqJ8N["correlation_id"],
        SLOCXXouwvPRt = Z0JVYZVJWqJ8N["resource"],
        HavpstGouWMrg = long.Parse(Z0JVYZVJWqJ8N["expires_on"].Split('.')[0], (IFormatProvider) CultureInfo.CurrentCulture)
      };
    }

    public static zdxmMQPSP3o89 iHJWWyMLScTVM(IHttpWebResponse a3ZR9TjkVt9Oe)
    {
      if (a3ZR9TjkVt9Oe == null)
        return new zdxmMQPSP3o89()
        {
          \u0033QwYdi6HVyJsZ = "service_returned_error",
          \u00301LcsP5ItuhkO = "Service returned error. Check InnerException for more details"
        };
      StringBuilder I4j9qboXCHfUl = new StringBuilder();
      using (Stream N0csczPXBzasX = \u0037BKomckZ2VHww.ZRXsq5wZUGk0j(a3ZR9TjkVt9Oe.ResponseString))
      {
        if (N0csczPXBzasX == null)
          return new zdxmMQPSP3o89()
          {
            \u0033QwYdi6HVyJsZ = "unknown_error",
            \u00301LcsP5ItuhkO = "Unknown error"
          };
        try
        {
          I4j9qboXCHfUl.Append(zdxmMQPSP3o89.KXa2BaJqpeRQ0(N0csczPXBzasX));
          using (MemoryStream memoryStream = new MemoryStream(I4j9qboXCHfUl.Hwt1kvzmal9Tb()))
            return (zdxmMQPSP3o89) new DataContractJsonSerializer(typeof (zdxmMQPSP3o89)).ReadObject((Stream) memoryStream);
        }
        catch (SerializationException ex)
        {
          return new zdxmMQPSP3o89()
          {
            \u0033QwYdi6HVyJsZ = a3ZR9TjkVt9Oe.StatusCode == HttpStatusCode.ServiceUnavailable ? "service_unavailable" : "unknown_error",
            \u00301LcsP5ItuhkO = I4j9qboXCHfUl.ToString()
          };
        }
      }
    }

    public OHG1qpDK4Ko7V o8u67hfbDxCmR()
    {
      if (this.LelxiE3qlw0iV < this.UyTfKPo71kggQ)
      {
        Up2ciG6wVdM5T.xgsfAAH34Fgnl.\u0031CII3TGnWWaPA.wRuYhG7t3Jqcm((Up2ciG6wVdM5T) null, string.Format((IFormatProvider) CultureInfo.InvariantCulture, "ExtendedExpiresIn({0}) is less than ExpiresIn({1}). Set ExpiresIn as ExtendedExpiresIn", new object[2]
        {
          (object) this.LelxiE3qlw0iV,
          (object) this.UyTfKPo71kggQ
        }), "E:\\A\\_work\\115\\s\\src\\Microsoft.IdentityModel.Clients.ActiveDirectory\\Internal\\Instance\\zdxmMQPSP3o89.cs");
        this.LelxiE3qlw0iV = this.UyTfKPo71kggQ;
      }
      return this.\u0036Vh9o75HR4f4d((DateTimeOffset) (DateTime.UtcNow + TimeSpan.FromSeconds((double) this.UyTfKPo71kggQ)), (DateTimeOffset) (DateTime.UtcNow + TimeSpan.FromSeconds((double) this.LelxiE3qlw0iV)));
    }

    public OHG1qpDK4Ko7V \u0036Vh9o75HR4f4d(
      DateTimeOffset NruFWZ5R70c55,
      DateTimeOffset J3J97hoJtkRrs)
    {
      if (this.Lz4vVPwuLW48K != null)
      {
        MbllA5kmgxVTq mbllA5kmgxVtq = new MbllA5kmgxVTq(this.aBWB7aY2nDLEK, this.Lz4vVPwuLW48K, NruFWZ5R70c55, J3J97hoJtkRrs);
        \u0030Gs1JGnIIm4Gp obj = \u0030Gs1JGnIIm4Gp.FCezx15uNhaVg(this.\u0035mws9nsNnRNfR);
        if (obj != null)
        {
          string k9yd90vBzDrgH = obj.\u0039QT9kX1VGZXOW;
          string str1 = (string) null;
          string str2 = (string) null;
          if (!string.IsNullOrWhiteSpace(obj.zNWT7zQDozxBi))
            str1 = obj.zNWT7zQDozxBi;
          else if (!string.IsNullOrWhiteSpace(obj.P1I1WlKAvqgo9))
            str1 = obj.P1I1WlKAvqgo9;
          if (!string.IsNullOrWhiteSpace(obj.CWN7a1TlJdT3X))
            str2 = obj.CWN7a1TlJdT3X;
          else if (!string.IsNullOrWhiteSpace(obj.T2vVhxJB3D1hK))
            str2 = obj.T2vVhxJB3D1hK;
          string str3 = obj.\u0033xsXGyRM1VB8y;
          string oleSjicObsbpe = obj.OleSJicObsbpe;
          string str4 = obj.\u00344T3o7DR2YTHn ?? obj.vhmhqYLOwamTw;
          DateTimeOffset? nullable = new DateTimeOffset?();
          if (obj.O3s7DaWj8UhCL > 0L)
            nullable = new DateTimeOffset?((DateTimeOffset) (DateTime.UtcNow + TimeSpan.FromSeconds((double) obj.O3s7DaWj8UhCL)));
          Uri uri = (Uri) null;
          if (!string.IsNullOrEmpty(obj.xLiHblYI663rT))
            uri = new Uri(obj.xLiHblYI663rT);
          mbllA5kmgxVtq.uDXu7YRSxwOev(k9yd90vBzDrgH, this.\u0035mws9nsNnRNfR, new Bl0Kw5APHoIOb()
          {
            H8otkn8RcSLDl = str1,
            QYTftBzxTSfhq = str2,
            YAYIA7dvsmtcS = str3,
            kGTgRAxIK0uEc = oleSjicObsbpe,
            RNQGSUhhocJVu = str4,
            mh7VeYw69oOrQ = nullable,
            gBnMSyVepUW8U = uri
          });
          mbllA5kmgxVtq.\u0031GY74rHc4jnFT = this.E8asExutYHHmw;
        }
        return new OHG1qpDK4Ko7V()
        {
          CMVqaYR8spkSL = mbllA5kmgxVtq,
          F4XWqRWZFtALS = this.mX5L16XtxWVro,
          Pjxq2WLxuk42F = this.SLOCXXouwvPRt
        };
      }
      if (this.\u0033QwYdi6HVyJsZ != null)
        throw new zTDz1kuLRWPxI(this.\u0033QwYdi6HVyJsZ, this.\u00301LcsP5ItuhkO);
      throw new zTDz1kuLRWPxI("unknown_error", "Unknown error");
    }

    private static string KXa2BaJqpeRQ0(Stream N0csczPXBzasX)
    {
      using (StreamReader streamReader = new StreamReader(N0csczPXBzasX))
        return streamReader.ReadToEnd();
    }
  }
}
