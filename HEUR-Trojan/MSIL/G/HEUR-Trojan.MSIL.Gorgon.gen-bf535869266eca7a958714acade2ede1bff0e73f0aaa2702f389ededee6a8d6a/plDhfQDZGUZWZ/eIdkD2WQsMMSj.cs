// Decompiled with JetBrains decompiler
// Type: plDhfQDZGUZWZ.eIdkD2WQsMMSj
// Assembly: Udby4Jt48oXkJ, Version=3.17.2.31, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 37899E89-D673-4F5B-A193-2E4DF6A54096
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-bf535869266eca7a958714acade2ede1bff0e73f0aaa2702f389ededee6a8d6a.exe

using \u0036mHL90hQ651VX;
using \u0037TlZ3hqqu7c01;
using fl1AlRxD2wuQJ;
using HqLTLdqt37SZu;
using LBTuQ7rcpWJuX;
using qU6okXWnajUcG;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Threading.Tasks;
using System.Xml;
using System.Xml.Linq;
using TlfuIkkM6v6pC;
using zR0sAUCfwb9S8;

namespace plDhfQDZGUZWZ
{
  internal static class eIdkD2WQsMMSj
  {
    private const string CCHR8RBtMRShJ = "http://schemas.xmlsoap.org/soap/http";

    public static Task<ASnJckF0HsK8S> x6XrdpqiMLxur(
      string QNrce0IRV22Ah,
      qAJfDhShCBvqg EV5mnPj4SOgtG,
      Up2ciG6wVdM5T QcZBW73qdBucc)
    {
      // ISSUE: variable of a compiler-generated type
      eIdkD2WQsMMSj.Kd8UFOj3lngbu stateMachine;
      // ISSUE: reference to a compiler-generated field
      stateMachine.jxrzlYOJyDLwE = QNrce0IRV22Ah;
      // ISSUE: reference to a compiler-generated field
      stateMachine.w6dSyYi1xnKmN = EV5mnPj4SOgtG;
      // ISSUE: reference to a compiler-generated field
      stateMachine.AvS0e7utncwZ9 = QcZBW73qdBucc;
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u0036acpRvDCxh2kR = AsyncTaskMethodBuilder<ASnJckF0HsK8S>.Create();
      // ISSUE: cast to a reference type
      // ISSUE: explicit reference operation
      // ISSUE: reference to a compiler-generated field
      (^(XmE22LvSyy6Ax.UOibUSZTyrgb1&) ref stateMachine).X9gTK1KXkSmTr = -1;
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u0036acpRvDCxh2kR.Start<eIdkD2WQsMMSj.Kd8UFOj3lngbu>(ref stateMachine);
      // ISSUE: reference to a compiler-generated field
      return stateMachine.\u0036acpRvDCxh2kR.Task;
    }

    internal static Task<XDocument> \u0038clcjZX3jHABz(
      string _param0,
      Up2ciG6wVdM5T _param1)
    {
      // ISSUE: variable of a compiler-generated type
      eIdkD2WQsMMSj.lganP9yii1c1i stateMachine;
      // ISSUE: reference to a compiler-generated field
      stateMachine.bdFVgLSjO2Dsi = _param0;
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u0036PPHOJl7TnWKg = _param1;
      // ISSUE: reference to a compiler-generated field
      stateMachine.rWh2Cj3VyfSvk = AsyncTaskMethodBuilder<XDocument>.Create();
      // ISSUE: cast to a reference type
      // ISSUE: explicit reference operation
      // ISSUE: reference to a compiler-generated field
      (^(eIdkD2WQsMMSj.Kd8UFOj3lngbu&) ref stateMachine).\u0039DSaeCFGtthAj = -1;
      // ISSUE: reference to a compiler-generated field
      stateMachine.rWh2Cj3VyfSvk.Start<eIdkD2WQsMMSj.lganP9yii1c1i>(ref stateMachine);
      // ISSUE: reference to a compiler-generated field
      return stateMachine.rWh2Cj3VyfSvk.Task;
    }

    internal static ASnJckF0HsK8S \u0032I8Z2REkLgy8B(
      XDocument fAnDuFybKsgn7,
      qAJfDhShCBvqg _param1,
      Up2ciG6wVdM5T Rjx97mFbWpCNK)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      eIdkD2WQsMMSj.w2DzIjhqxlw3D w2DzIjhqxlw3D = (eIdkD2WQsMMSj.w2DzIjhqxlw3D) new eIdkD2WQsMMSj.lganP9yii1c1i();
      // ISSUE: reference to a compiler-generated field
      ((eIdkD2WQsMMSj.lganP9yii1c1i) w2DzIjhqxlw3D).f4xOH9PcPsyIX = _param1;
      ASnJckF0HsK8S asnJckF0HsK8S;
      try
      {
        // ISSUE: object of a compiler-generated type is created
        // ISSUE: variable of a compiler-generated type
        eIdkD2WQsMMSj.VLBkZkrUaNLQZ vlBkZkrUaNlqz = (eIdkD2WQsMMSj.VLBkZkrUaNLQZ) new eIdkD2WQsMMSj.w2DzIjhqxlw3D();
        Dictionary<string, zpwt7cfulv9S1> WGZe5y5LCYdsu = eIdkD2WQsMMSj.gdvHOOhl2jLtO((XContainer) fAnDuFybKsgn7);
        Dictionary<string, zpwt7cfulv9S1> k8J21PcyGHQpQ = eIdkD2WQsMMSj.tS2UhDuxIxf3V((XContainer) fAnDuFybKsgn7, (IReadOnlyDictionary<string, zpwt7cfulv9S1>) WGZe5y5LCYdsu);
        eIdkD2WQsMMSj.\u0030DXy3xCdjFIpT((XContainer) fAnDuFybKsgn7, (IReadOnlyDictionary<string, zpwt7cfulv9S1>) k8J21PcyGHQpQ);
        // ISSUE: reference to a compiler-generated field
        ((eIdkD2WQsMMSj.w2DzIjhqxlw3D) vlBkZkrUaNlqz).tG4KXLrlUaOSU = new Random();
        // ISSUE: reference to a compiler-generated method
        // ISSUE: reference to a compiler-generated method
        // ISSUE: reference to a compiler-generated method
        // ISSUE: reference to a compiler-generated method
        zpwt7cfulv9S1 zpwt7cfulv9S1 = WGZe5y5LCYdsu.Values.Where<zpwt7cfulv9S1>(new Func<zpwt7cfulv9S1, bool>(w2DzIjhqxlw3D.\u0030ugVVREosrm4l)).OrderBy<zpwt7cfulv9S1, int>(new Func<zpwt7cfulv9S1, int>(vlBkZkrUaNlqz.nKs2VLiyeXmMZ)).FirstOrDefault<zpwt7cfulv9S1>() ?? WGZe5y5LCYdsu.Values.Where<zpwt7cfulv9S1>(new Func<zpwt7cfulv9S1, bool>(w2DzIjhqxlw3D.Mf5hzISRJhxaj)).OrderBy<zpwt7cfulv9S1, int>(new Func<zpwt7cfulv9S1, int>(vlBkZkrUaNlqz.h1gxMknp5ACqK)).FirstOrDefault<zpwt7cfulv9S1>();
        if (zpwt7cfulv9S1 != null)
        {
          asnJckF0HsK8S = new ASnJckF0HsK8S();
          asnJckF0HsK8S.\u0036ioCCPFiQWZmV = zpwt7cfulv9S1.\u0037boRLjKbp6rlR;
          asnJckF0HsK8S.\u00323uKu3mcukpJn = zpwt7cfulv9S1.IM7n4zbfhR4CY;
        }
        else
        {
          // ISSUE: reference to a compiler-generated field
          if (((eIdkD2WQsMMSj.lganP9yii1c1i) w2DzIjhqxlw3D).f4xOH9PcPsyIX == qAJfDhShCBvqg.IntegratedAuth)
            throw new LlM9VbgWu20VY("integrated_authentication_failed", (Exception) new LlM9VbgWu20VY("wstrust_endpoint_not_found"));
          throw new LlM9VbgWu20VY("wstrust_endpoint_not_found");
        }
      }
      catch (XmlException ex)
      {
        throw new LlM9VbgWu20VY("parsing_ws_metadata_exchange_failed", (Exception) ex);
      }
      return asnJckF0HsK8S;
    }

    internal static Dictionary<string, zpwt7cfulv9S1> gdvHOOhl2jLtO(
      XContainer Ni0v9kPPMECWv)
    {
      Dictionary<string, zpwt7cfulv9S1> GS9WGctN4MJMw = new Dictionary<string, zpwt7cfulv9S1>();
      foreach (XElement element in Ni0v9kPPMECWv.Elements().First<XElement>().Elements(bjImv8syFHPRL.fDlsaTgfhcDQJ + "Policy"))
      {
        XElement xelement1 = element.Elements(bjImv8syFHPRL.fDlsaTgfhcDQJ + "ExactlyOne").FirstOrDefault<XElement>();
        if (xelement1 != null)
        {
          foreach (XElement descendant in xelement1.Descendants(bjImv8syFHPRL.fDlsaTgfhcDQJ + "All"))
          {
            XNamespace ybyyEzf7Thxth = bjImv8syFHPRL.ybyyEzf7Thxth;
            if (descendant.Elements(bjImv8syFHPRL.KupZtqH3g0lzO + "NegotiateAuthentication").FirstOrDefault<XElement>() != null)
              eIdkD2WQsMMSj.sLFdD0Adjlzi5((IDictionary<string, zpwt7cfulv9S1>) GS9WGctN4MJMw, element, qAJfDhShCBvqg.IntegratedAuth);
            XElement xelement2 = descendant.Elements(ybyyEzf7Thxth + "SignedEncryptedSupportingTokens").FirstOrDefault<XElement>();
            if (xelement2 != null || (xelement2 = descendant.Elements(bjImv8syFHPRL.A3L0pydJAE561 + "SignedSupportingTokens").FirstOrDefault<XElement>()) != null)
            {
              XNamespace a3L0pydJaE561 = bjImv8syFHPRL.A3L0pydJAE561;
              XElement xelement3 = xelement2.Elements(bjImv8syFHPRL.fDlsaTgfhcDQJ + "Policy").FirstOrDefault<XElement>();
              if (xelement3 != null)
              {
                XElement xelement4 = xelement3.Elements(a3L0pydJaE561 + "UsernameToken").FirstOrDefault<XElement>();
                if (xelement4 != null)
                {
                  XElement xelement5 = xelement4.Elements(bjImv8syFHPRL.fDlsaTgfhcDQJ + "Policy").FirstOrDefault<XElement>();
                  if (xelement5 != null && xelement5.Elements(a3L0pydJaE561 + "WssUsernameToken10").FirstOrDefault<XElement>() != null)
                    eIdkD2WQsMMSj.sLFdD0Adjlzi5((IDictionary<string, zpwt7cfulv9S1>) GS9WGctN4MJMw, element, qAJfDhShCBvqg.UsernamePassword);
                }
              }
            }
          }
        }
      }
      return GS9WGctN4MJMw;
    }

    private static Dictionary<string, zpwt7cfulv9S1> tS2UhDuxIxf3V(
      XContainer rJWIUNFMMG9qd,
      IReadOnlyDictionary<string, zpwt7cfulv9S1> WGZe5y5LCYdsu)
    {
      Dictionary<string, zpwt7cfulv9S1> dictionary = new Dictionary<string, zpwt7cfulv9S1>();
      foreach (XElement element1 in rJWIUNFMMG9qd.Elements().First<XElement>().Elements(bjImv8syFHPRL.ygsKblJBjpYQt + "binding"))
      {
        foreach (XElement element2 in element1.Elements(bjImv8syFHPRL.fDlsaTgfhcDQJ + "PolicyReference"))
        {
          XAttribute xattribute1 = element2.Attribute((XName) "URI");
          if (xattribute1 != null && WGZe5y5LCYdsu.ContainsKey(xattribute1.Value))
          {
            XAttribute xattribute2 = element1.Attribute((XName) "name");
            if (xattribute2 != null)
            {
              XElement xelement1 = element1.Elements(bjImv8syFHPRL.ygsKblJBjpYQt + "operation").FirstOrDefault<XElement>();
              if (xelement1 != null)
              {
                XElement xelement2 = xelement1.Elements(bjImv8syFHPRL.NhtliTGQbFAsj + "operation").FirstOrDefault<XElement>();
                if (xelement2 != null)
                {
                  XAttribute xattribute3 = xelement2.Attribute((XName) "soapAction");
                  if (xattribute3 != null && (string.Compare(bjImv8syFHPRL.W2qr6LO5sCTdV.ToString(), xattribute3.Value, StringComparison.OrdinalIgnoreCase) == 0 || string.Compare(bjImv8syFHPRL.ZhOFeaQ47dUt4.ToString(), xattribute3.Value, StringComparison.OrdinalIgnoreCase) == 0))
                  {
                    bool flag = string.Compare(bjImv8syFHPRL.ZhOFeaQ47dUt4.ToString(), xattribute3.Value, StringComparison.OrdinalIgnoreCase) == 0;
                    WGZe5y5LCYdsu[xattribute1.Value].IM7n4zbfhR4CY = flag ? n6TGt2r3FxEvZ.WsTrust2005 : n6TGt2r3FxEvZ.WsTrust13;
                    XElement xelement3 = element1.Elements(bjImv8syFHPRL.NhtliTGQbFAsj + "binding").FirstOrDefault<XElement>();
                    if (xelement3 != null)
                    {
                      XAttribute xattribute4 = xelement3.Attribute((XName) "transport");
                      if (xattribute4 != null && string.Compare("http://schemas.xmlsoap.org/soap/http", xattribute4.Value, StringComparison.OrdinalIgnoreCase) == 0)
                        dictionary.Add(xattribute2.Value, WGZe5y5LCYdsu[xattribute1.Value]);
                    }
                  }
                }
              }
            }
          }
        }
      }
      return dictionary;
    }

    private static void \u0030DXy3xCdjFIpT(
      XContainer OLuJdBgJOyWbO,
      IReadOnlyDictionary<string, zpwt7cfulv9S1> k8J21PcyGHQpQ)
    {
      foreach (XElement element in OLuJdBgJOyWbO.Elements().First<XElement>().Elements(bjImv8syFHPRL.ygsKblJBjpYQt + "service").First<XElement>().Elements(bjImv8syFHPRL.ygsKblJBjpYQt + "port"))
      {
        XAttribute xattribute = element.Attribute((XName) "binding");
        if (xattribute != null)
        {
          string[] strArray = xattribute.Value.Split(new char[1]
          {
            ':'
          }, 2);
          if (strArray.Length >= 2 && k8J21PcyGHQpQ.ContainsKey(strArray[1]))
          {
            XElement xelement1 = element.Elements(bjImv8syFHPRL.\u0038plird1yFFOZT + "EndpointReference").FirstOrDefault<XElement>();
            if (xelement1 != null)
            {
              XElement xelement2 = xelement1.Elements(bjImv8syFHPRL.\u0038plird1yFFOZT + "Address").FirstOrDefault<XElement>();
              if (xelement2 != null && Uri.IsWellFormedUriString(xelement2.Value, UriKind.Absolute))
                k8J21PcyGHQpQ[strArray[1]].\u0037boRLjKbp6rlR = new Uri(xelement2.Value);
            }
          }
        }
      }
    }

    private static void sLFdD0Adjlzi5(
      IDictionary<string, zpwt7cfulv9S1> GS9WGctN4MJMw,
      XElement yhKhPUuXuUcnY,
      qAJfDhShCBvqg cgHtMtjHk0jRu)
    {
      if ((yhKhPUuXuUcnY.Descendants(bjImv8syFHPRL.ybyyEzf7Thxth + "TransportBinding").FirstOrDefault<XElement>() ?? yhKhPUuXuUcnY.Descendants(bjImv8syFHPRL.A3L0pydJAE561 + "TransportBinding").FirstOrDefault<XElement>()) == null)
        return;
      XAttribute xattribute = yhKhPUuXuUcnY.Attribute(bjImv8syFHPRL.Ct2X0UbJFsxEm + "Id");
      if (xattribute == null)
        return;
      GS9WGctN4MJMw.Add("#" + xattribute.Value, new zpwt7cfulv9S1()
      {
        IvTU3I3TxQ1KR = xattribute.Value,
        HDMZNfBUPkhk4 = cgHtMtjHk0jRu
      });
    }
  }
}
