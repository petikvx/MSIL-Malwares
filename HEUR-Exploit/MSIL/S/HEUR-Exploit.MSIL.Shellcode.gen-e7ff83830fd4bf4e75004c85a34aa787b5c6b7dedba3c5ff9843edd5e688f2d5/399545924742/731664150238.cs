// Decompiled with JetBrains decompiler
// Type: 399545924742.731664150238
// Assembly: 069511259246, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 6D0FD131-484D-4146-B8A3-FCA5C0E4E111
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-e7ff83830fd4bf4e75004c85a34aa787b5c6b7dedba3c5ff9843edd5e688f2d5.exe

using \u003345600180144;
using Microsoft.VisualStudio.Debugger.Interop;
using Microsoft.VisualStudio.OLE.Interop;
using System;
using System.Runtime.InteropServices;
using System.Threading;

namespace \u003399545924742
{
  internal class \u003731664150238 : IDebugEventCallback2
  {
    private readonly uint \u003598763026697;
    private readonly IntPtr \u003987902488079;
    private Guid \u003602496521310 = typeof (IDebugEventCallback2).GUID;
    private readonly object \u003880274471840 = new object();
    private int \u003905852299621;
    private IDebugEventCallback2 \u003378168324046;

    internal \u003731664150238(IDebugEventCallback2 ad7Callback)
    {
      Guid guid1 = new Guid("00000323-0000-0000-C000-000000000046");
      Guid guid2 = typeof (IGlobalInterfaceTable).GUID;
      this.\u003987902488079 = \u003003614214328.\u003407704345574.\u003330961014761(ref guid1, IntPtr.Zero, 1, ref guid2);
      IGlobalInterfaceTable o = this.\u003020681578663();
      o.RegisterInterfaceInGlobal((object) ad7Callback, ref this.\u003602496521310, ref this.\u003598763026697);
      Marshal.ReleaseComObject((object) o);
    }

    ~\u003731664150238()
    {
      if (this.\u003598763026697 != 0U)
      {
        IGlobalInterfaceTable o = this.\u003020681578663();
        o.RevokeInterfaceFromGlobal(this.\u003598763026697);
        Marshal.ReleaseComObject((object) o);
      }
      if (!(this.\u003987902488079 != IntPtr.Zero))
        return;
      Marshal.Release(this.\u003987902488079);
    }

    int IDebugEventCallback2.\u003967794297433(
      IDebugEngine2 _param1,
      IDebugProcess2 _param2,
      IDebugProgram2 _param3,
      IDebugThread2 _param4,
      IDebugEvent2 _param5,
      ref Guid _param6,
      uint _param7)
    {
      return this.\u003827538165349().Event(_param1, _param2, _param3, _param4, _param5, ref _param6, _param7);
    }

    private IGlobalInterfaceTable \u003020681578663() => (IGlobalInterfaceTable) Marshal.GetUniqueObjectForIUnknown(this.\u003987902488079);

    private IDebugEventCallback2 \u003827538165349()
    {
      int managedThreadId = Thread.CurrentThread.ManagedThreadId;
      if (this.\u003378168324046 != null && this.\u003905852299621 == managedThreadId)
      {
        lock (this.\u003880274471840)
        {
          if (this.\u003378168324046 != null)
          {
            if (this.\u003905852299621 == managedThreadId)
              return this.\u003378168324046;
          }
        }
      }
      IGlobalInterfaceTable o = this.\u003020681578663();
      IntPtr pUnk;
      o.GetInterfaceFromGlobal(this.\u003598763026697, ref this.\u003602496521310, ref pUnk);
      Marshal.ReleaseComObject((object) o);
      IDebugEventCallback2 objectForIunknown = (IDebugEventCallback2) Marshal.GetObjectForIUnknown(pUnk);
      Marshal.Release(pUnk);
      lock (this.\u003880274471840)
      {
        this.\u003905852299621 = managedThreadId;
        this.\u003378168324046 = objectForIunknown;
      }
      return objectForIunknown;
    }

    private static class \u003638504808921
    {
    }
  }
}
