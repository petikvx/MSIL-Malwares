// Decompiled with JetBrains decompiler
// Type: XmjPv9h.D9rQoCq
// Assembly: 2sxSNTs, Version=14.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: FB0137A9-867E-4DD3-B132-A99F8D9572B1
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-8052bb53bcca6092f4ec856cbc169992c551f11ded48c8627780e67cd0bcd8fd.exe

using BnDBhQy;
using Microsoft.VisualStudio;
using Microsoft.VisualStudio.OLE.Interop;
using Microsoft.VisualStudio.Shell;
using Microsoft.VisualStudio.Shell.Interop;
using r944Smz;
using System;
using System.Globalization;
using System.IO;
using System.Runtime.InteropServices;
using wy43hUq;
using Z2yQAgv;

namespace XmjPv9h
{
  [PackageRegistration(UseManagedResourcesOnly = true)]
  [InstalledProductRegistration("#110", "#112", "1.0", IconResourceID = 400)]
  [Guid("507f4375-d65c-4dca-a0e5-8b501453ffda")]
  [ProvideMenuResource("Menus.ctmenu", 1)]
  public sealed class D9rQoCq : Package, IOleCommandTarget
  {
    private IOleCommandTarget WGDBiez;
    private const string PPcQ0Gs = "E,Executable:!(d) O,OptionsFile:!(d)";

    protected virtual void Initialize()
    {
      base.Initialize();
      this.WGDBiez = this.GetService(typeof (IOleCommandTarget)) as IOleCommandTarget;
    }

    int IOleCommandTarget.yxqZhge(
      ref Guid FLyQJNq,
      uint hxdx6LU,
      uint bmvC28V,
      IntPtr _param4,
      IntPtr CAblocM)
    {
      if (FLyQJNq == mbtoPvj.PliB8UX)
        return hxdx6LU == 256U ? this.LYmM8us(bmvC28V, _param4, CAblocM) : -2147467263;
      IOleCommandTarget wgdBiez = this.WGDBiez;
      Guid guid = FLyQJNq;
      ref Guid local = ref guid;
      int num1 = (int) hxdx6LU;
      int num2 = (int) bmvC28V;
      IntPtr num3 = _param4;
      IntPtr num4 = CAblocM;
      return wgdBiez.Exec(ref local, (uint) num1, (uint) num2, num3, num4);
    }

    int IOleCommandTarget.\u0030UsF8rz(
      ref Guid oapUXim,
      uint HAxhBw1,
      OLECMD[] qdr2X8O,
      IntPtr DRIQ9Gh)
    {
      if (oapUXim == mbtoPvj.PliB8UX)
      {
        if (qdr2X8O[0].cmdID != 256U)
          return -2147467263;
        qdr2X8O[0].cmdf |= 19U;
        return 0;
      }
      IOleCommandTarget wgdBiez = this.WGDBiez;
      Guid guid = oapUXim;
      ref Guid local = ref guid;
      int num1 = (int) HAxhBw1;
      OLECMD[] olecmdArray = qdr2X8O;
      IntPtr num2 = DRIQ9Gh;
      return wgdBiez.QueryStatus(ref local, (uint) num1, olecmdArray, num2);
    }

    private int LYmM8us(uint YQxN4xd, IntPtr iZFgJl2, IntPtr J2lX4Ei)
    {
      if (D9rQoCq.drFCTOu(iZFgJl2, J2lX4Ei, YQxN4xd))
      {
        Marshal.GetNativeVariantForObject<string>("$ /switchdefs:\"E,Executable:!(d) O,OptionsFile:!(d)\"", J2lX4Ei);
        return 0;
      }
      string str1;
      int num1 = D9rQoCq.HkL7vqd(iZFgJl2, out str1);
      if (num1 != 0)
        return num1;
      IVsParseCommandLine service = (IVsParseCommandLine) this.GetService(typeof (SVsParseCommandLine));
      int commandTail = service.ParseCommandTail(str1, -1);
      if (ErrorHandler.Failed(commandTail))
        return commandTail;
      int num2 = service.HasParams();
      if (ErrorHandler.Failed(num2))
        return num2;
      int num3 = num2 != 0 && service.HasSwitches() == 0 ? service.EvaluateSwitches("E,Executable:!(d) O,OptionsFile:!(d)") : throw new ApplicationException("Unexpected syntax for KofeLaunch command. Expected:\n" + "Debug.KofeLaunch /Executable:<path_or_logical_name /OptionsFile:<path>");
      if (ErrorHandler.Failed(num3))
        return num3;
      string str2;
      if (service.GetSwitchValue(0, ref str2) != 0 || string.IsNullOrWhiteSpace(str2))
        throw new ArgumentException("Executable must be specified");
      string cvH7hAS = string.Empty;
      string path;
      if (service.GetSwitchValue(1, ref path) == 0)
      {
        if (string.IsNullOrWhiteSpace(path))
          throw new ArgumentException("Value exepcted for /OptionsFile option");
        cvH7hAS = File.Exists(path) ? File.ReadAllText(path) : throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, "Options file '{0}' does not exist", (object) path));
      }
      this.cmTNJ3M(str2, cvH7hAS);
      return 0;
    }

    private void cmTNJ3M(string _param1, string cvH7hAS)
    {
      // ISSUE: variable of a compiler-generated type
      IVsDebugger4 service = (IVsDebugger4) this.GetService(typeof (IVsDebugger));
      f8YTflX[] f8YtflXArray = new f8YTflX[1];
      // ISSUE: reference to a compiler-generated field
      f8YtflXArray[0].V4UwAlc = 1U;
      // ISSUE: reference to a compiler-generated field
      f8YtflXArray[0].\u0033qcC91P = _param1;
      // ISSUE: reference to a compiler-generated field
      f8YtflXArray[0].yNFMP3D = cvH7hAS;
      // ISSUE: reference to a compiler-generated field
      f8YtflXArray[0].hHjRJ9o = new Guid("{029D0BD7-2382-44D7-BBE9-E45D5514E439}");
      qfxt4ac[] qfxt4acArray = new qfxt4ac[f8YtflXArray.Length];
      f8YTflX[] pDebugTargets = f8YtflXArray;
      qfxt4ac[] pLaunchResults = qfxt4acArray;
      // ISSUE: reference to a compiler-generated method
      service.LaunchDebugTargets4(1U, pDebugTargets, pLaunchResults);
    }

    private static int HkL7vqd(IntPtr vDeFBEk, out string _param1)
    {
      _param1 = (string) null;
      if (vDeFBEk == IntPtr.Zero)
        return -2147024809;
      object forNativeVariant = Marshal.GetObjectForNativeVariant(vDeFBEk);
      if (forNativeVariant == null || forNativeVariant.GetType() != typeof (string))
        return -2147024809;
      _param1 = forNativeVariant as string;
      return 0;
    }

    private static bool drFCTOu(IntPtr Rbhe8sn, IntPtr eNIuC6K, uint Fh1fg6r)
    {
      int num1 = (int) (ushort) (Fh1fg6r & (uint) ushort.MaxValue);
      ushort num2 = (ushort) (Fh1fg6r >> 16);
      return num1 == 3 && num2 == (ushort) 1 && eNIuC6K != IntPtr.Zero;
    }

    private enum No3pOfP
    {
      Executable,
      OptionsFile,
    }
  }
}
