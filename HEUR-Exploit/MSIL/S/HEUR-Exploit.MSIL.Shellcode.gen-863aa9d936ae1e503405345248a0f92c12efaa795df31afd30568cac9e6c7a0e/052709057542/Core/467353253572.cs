// Decompiled with JetBrains decompiler
// Type: 052709057542.Core.467353253572
// Assembly: 052709057542, Version=16.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 359C9CB9-9F6B-407E-806A-B212EE061A4B
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-863aa9d936ae1e503405345248a0f92c12efaa795df31afd30568cac9e6c7a0e.exe

using \u003052709057542.Core;
using \u003052709057542.Models;
using \u003052709057542.Utils;
using \u003161204516273;
using \u003493497765194;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003052709057542.Core
{
  public static class \u003467353253572
  {
    private static void \u003965403740504(
      string _param0,
      string _param1,
      Func<string, \u003510362770208> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003977352532210 obj1 = new \u003977352532210();
      obj1.\u003707186072676 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003977352532210 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003510362770208 obj3 = _param2(contents);
      string str1 = \u003467353253572.\u003672253210716(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003269086800015.\u003490455855855(obj3.\u003415519171146, path1);
        }
        catch (Exception ex)
        {
          ex.\u003333741699966();
          File.Delete(path1);
        }
      }
    }

    private static string \u003672253210716(\u003510362770208 _param0)
    {
      string str = Path.GetFileName(_param0.\u003415519171146).\u003435521510040();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003415519171146);
      return string.Empty;
    }

    public static void \u003143338853264()
    {
      string path1 = \u003312631255777.\u003022247902127();
      \u003712686252732 obj1 = \u003733950327037.\u003807281605599(path1);
      string str = obj1?.\u003779759444593;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003052304155682 obj2 = new \u003052304155682(str);
        ((\u003737786233277) obj2).\u003757480185047 = \u003733950327037.\u003316306886567();
        ((\u003737786233277) obj2).\u003512430615343 = obj1.\u003915952755420;
        ((\u003737786233277) obj2).\u003412135105982 = Color.DarkRed;
        ((\u003737786233277) obj2).\u003728788919604 = \u003547065664920.\u003519637767304;
        ((\u003737786233277) obj2).\u003830374552383 = \u003547065664920.\u003616591824029;
        ((\u003737786233277) obj2).\u003807334541750 = \u003547065664920.\u003139968979081;
        ((\u003737786233277) obj2).\u003781968348941 = \u003547065664920.\u003838633368004;
        ((\u003737786233277) obj2).\u003265021595375 = \u003547065664920.\u003791502688466;
        ((\u003737786233277) obj2).\u003300784146034 = \u003547065664920.\u003629812352382;
        ((\u003737786233277) obj2).\u003324341580434 = \u003547065664920.\u003950966808331;
        using (\u003737786233277 obj3 = (\u003737786233277) obj2)
        {
          using (Image image = obj3.\u003550358104718())
          {
            string filename;
            if (\u003456004010858.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003522790051441.\u003137424777748(filename);
            \u003522790051441.\u003287079386707(filename);
          }
        }
      }
    }
  }
}
