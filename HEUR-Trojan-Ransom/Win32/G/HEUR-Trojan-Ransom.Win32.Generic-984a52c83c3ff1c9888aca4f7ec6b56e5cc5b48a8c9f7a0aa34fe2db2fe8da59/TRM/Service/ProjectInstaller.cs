// Decompiled with JetBrains decompiler
// Type: TRM.Service.ProjectInstaller
// Assembly: TRM, Version=1.0.4536.20171, Culture=neutral, PublicKeyToken=null
// MVID: 8CAF3016-DE02-4666-A2B5-982FA29E174F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Trojan-Ransom.Win32.Generic-984a52c83c3ff1c9888aca4f7ec6b56e5cc5b48a8c9f7a0aa34fe2db2fe8da59.exe

using System.ComponentModel;
using System.Configuration.Install;
using System.ServiceProcess;

namespace TRM.Service
{
  [RunInstaller(true)]
  public sealed class ProjectInstaller : Installer
  {
    private IContainer components;
    public ServiceProcessInstaller svcProcessInstaller;
    public ServiceInstaller svcInstaller;

    public ProjectInstaller() => this.InitializeComponent();

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (ProjectInstaller));
      this.svcProcessInstaller = new ServiceProcessInstaller();
      this.svcInstaller = new ServiceInstaller();
      this.svcProcessInstaller.Account = ServiceAccount.LocalSystem;
      this.svcProcessInstaller.Password = (string) null;
      this.svcProcessInstaller.Username = (string) null;
      this.svcInstaller.Description = componentResourceManager.GetString("svcInstaller.Description");
      this.svcInstaller.DisplayName = "Windows Virtual Service Provider";
      this.svcInstaller.ServiceName = "winvsp";
      this.svcInstaller.StartType = ServiceStartMode.Automatic;
      this.Installers.AddRange(new Installer[2]
      {
        (Installer) this.svcProcessInstaller,
        (Installer) this.svcInstaller
      });
    }
  }
}
