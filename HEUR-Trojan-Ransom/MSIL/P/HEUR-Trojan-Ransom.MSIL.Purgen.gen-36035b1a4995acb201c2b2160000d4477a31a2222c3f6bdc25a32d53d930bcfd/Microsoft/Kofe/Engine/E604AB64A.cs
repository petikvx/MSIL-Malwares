// Decompiled with JetBrains decompiler
// Type: Microsoft.Kofe.Engine.E604AB64A
// Assembly: C5C480410, Version=14.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: BF642EC0-3F36-4177-B782-3E478BED34CB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.12-msil\HEUR-Trojan-Ransom.MSIL.Purgen.gen-36035b1a4995acb201c2b2160000d4477a31a2222c3f6bdc25a32d53d930bcfd.exe

using Microsoft.Kofe.IJDWP;
using Microsoft.VisualStudio.Debugger.Interop;
using System;

namespace Microsoft.Kofe.Engine
{
  internal class E604AB64A : IDebugCodeContext2, IDebugMemoryContext2, IDebugCodeContext100
  {
    private readonly B92FAA9B7 E8AB5DB32;
    private readonly IJdwpCodeLocation C8A45663B;
    private IDebugDocumentContext2 CBDEC15D8;

    public E604AB64A(B92FAA9B7 engine, IJdwpCodeLocation location)
    {
      this.E8AB5DB32 = engine;
      this.C8A45663B = location;
    }

    public void AFC7258C0(IDebugDocumentContext2 BA930E5FB) => this.CBDEC15D8 = BA930E5FB;

    public int E6C55B141(ulong AA1235BDF, out IDebugMemoryContext2 FD789DE2E)
    {
      FD789DE2E = (IDebugMemoryContext2) new E604AB64A(this.E8AB5DB32, this.C8A45663B.Add(AA1235BDF));
      return 0;
    }

    public int F65D9DB9A(
      enum_CONTEXT_COMPARE BE2E4D5B3,
      IDebugMemoryContext2[] E42D1C81C,
      uint CA163C66B,
      out uint F3329C9B9)
    {
      F3329C9B9 = uint.MaxValue;
      try
      {
        enum_CONTEXT_COMPARE enumContextCompare = BE2E4D5B3;
        for (uint index = 0; index < CA163C66B; ++index)
        {
          if (E42D1C81C[(int) index] is E604AB64A e604Ab64A && this.E8AB5DB32 == e604Ab64A.E8AB5DB32)
          {
            bool flag;
            switch (enumContextCompare - 1)
            {
              case 0:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID && (long) this.C8A45663B.Index == (long) e604Ab64A.C8A45663B.Index;
                break;
              case 1:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID && this.C8A45663B.Index < e604Ab64A.C8A45663B.Index;
                break;
              case 2:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID && this.C8A45663B.Index > e604Ab64A.C8A45663B.Index;
                break;
              case 3:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID && this.C8A45663B.Index <= e604Ab64A.C8A45663B.Index;
                break;
              case 4:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID && this.C8A45663B.Index >= e604Ab64A.C8A45663B.Index;
                break;
              case 5:
              case 6:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID && this.C8A45663B.MethodID == e604Ab64A.C8A45663B.MethodID;
                break;
              case 7:
                flag = this.C8A45663B.ClassID == e604Ab64A.C8A45663B.ClassID;
                break;
              case 8:
                flag = true;
                break;
              default:
                return 1;
            }
            if (flag)
            {
              F3329C9B9 = index;
              return 0;
            }
          }
        }
        return 1;
      }
      catch (ComponentException ex)
      {
        return ((Exception) ex).HResult;
      }
      catch (Exception ex)
      {
        return A09717160.ABD5D2EFF(ex);
      }
    }

    public int AA4FCF2C5(enum_CONTEXT_INFO_FIELDS BA1C97D38, CONTEXT_INFO[] ADB30D24D)
    {
      try
      {
        ADB30D24D[0].dwFields = (enum_CONTEXT_INFO_FIELDS) 0;
        if ((BA1C97D38 & 8) != null)
        {
          ADB30D24D[0].bstrAddress = ((object) this.C8A45663B).ToString();
          ref enum_CONTEXT_INFO_FIELDS local = ref ADB30D24D[0].dwFields;
          // ISSUE: cast to a reference type
          // ISSUE: explicit reference operation
          // ISSUE: cast to a reference type
          // ISSUE: explicit reference operation
          ^(int&) ref local = ^(int&) ref local | 8;
        }
        if ((BA1C97D38 & 2) != null)
        {
          IJdwpClass ijdwpClass = this.E8AB5DB32.B3E3893F5.GetClass(this.C8A45663B.ClassID);
          if (ijdwpClass != null)
          {
            IJdwpMethod method = ijdwpClass.GetMethod(this.C8A45663B.MethodID);
            ADB30D24D[0].bstrFunction = method.GetDisplayName();
            ref enum_CONTEXT_INFO_FIELDS local = ref ADB30D24D[0].dwFields;
            // ISSUE: cast to a reference type
            // ISSUE: explicit reference operation
            // ISSUE: cast to a reference type
            // ISSUE: explicit reference operation
            ^(int&) ref local = ^(int&) ref local | 2;
          }
        }
        int num1 = BA1C97D38 & 16;
        int num2 = BA1C97D38 & 32;
        int num3 = BA1C97D38 & 1;
        int num4 = BA1C97D38 & 2;
        int num5 = BA1C97D38 & 4;
        return 0;
      }
      catch (ComponentException ex)
      {
        return ((Exception) ex).HResult;
      }
      catch (Exception ex)
      {
        return A09717160.ABD5D2EFF(ex);
      }
    }

    public int CDC2E9A7E(out string BBC9132F5) => throw new NotImplementedException();

    public int B4EB0B585(ulong B246D3053, out IDebugMemoryContext2 EA9BDB215)
    {
      EA9BDB215 = (IDebugMemoryContext2) new E604AB64A(this.E8AB5DB32, this.C8A45663B.Subtract(B246D3053));
      return 0;
    }

    public int A63FE2300(out IDebugDocumentContext2 E37B067FB)
    {
      E37B067FB = this.CBDEC15D8;
      return 0;
    }

    public int A941DA318(ref string BA64F9E7E, ref Guid BDF5060C0)
    {
      if (this.CBDEC15D8 == null)
        return 1;
      this.CBDEC15D8.GetLanguageInfo(ref BA64F9E7E, ref BDF5060C0);
      return 0;
    }

    int IDebugCodeContext100.ABCBE8782(out IDebugProgram2 DBC6059F1)
    {
      DBC6059F1 = (IDebugProgram2) this.E8AB5DB32;
      return 0;
    }
  }
}
