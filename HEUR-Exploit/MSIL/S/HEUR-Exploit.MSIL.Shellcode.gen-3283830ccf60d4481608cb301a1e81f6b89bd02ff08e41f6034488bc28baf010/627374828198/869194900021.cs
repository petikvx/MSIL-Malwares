// Decompiled with JetBrains decompiler
// Type: 627374828198.869194900021
// Assembly: 087135227926, Version=10.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed
// MVID: 0DB320EA-9C28-4716-BA63-69641BABDE67
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-3283830ccf60d4481608cb301a1e81f6b89bd02ff08e41f6034488bc28baf010.exe

using \u003011774768495;
using \u003048229710669;
using \u003149520165229;
using \u003204421662347;
using \u003208825527781;
using \u003293721351544;
using \u003308056880834;
using \u003365955794882;
using \u003379975009000;
using \u003413837621179;
using \u003543303005921;
using \u003587801749628;
using \u003627374828198;
using \u003860102105793;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Text;

namespace \u003627374828198
{
  internal class \u003869194900021
  {
    private static readonly Encoding \u003737041315894 = (Encoding) new UTF8Encoding(false);
    private readonly BinaryWriter \u003519289603218;
    private byte[] \u003830048120502;

    public DateTimeKind \u003172846978417 { get; set; }

    public \u003869194900021(BinaryWriter writer)
    {
      this.\u003172846978417 = DateTimeKind.Utc;
      this.\u003519289603218 = writer;
    }

    public void \u003497371358307() => this.\u003519289603218.Flush();

    public void \u003423988564067() => this.\u003519289603218.Close();

    public void \u003679233344375(\u003475498445366 _param1)
    {
      this.\u003587022954945(_param1);
      this.\u003775788279062(_param1);
    }

    private void \u003775788279062(\u003475498445366 _param1)
    {
      switch (_param1.\u003900690472005)
      {
        case \u003912974945849.Number:
          this.\u003519289603218.Write(Convert.ToDouble(((\u003187355208708) _param1).\u003617834078463, (IFormatProvider) CultureInfo.InvariantCulture));
          break;
        case \u003912974945849.String:
          \u003650945770894 obj1 = (\u003650945770894) _param1;
          this.\u003069309274343((string) obj1.\u003617834078463, obj1.\u003426416179562, new int?(obj1.\u003580409426488 - 4));
          break;
        case \u003912974945849.Object:
          \u003719440416830 obj2 = (\u003719440416830) _param1;
          this.\u003519289603218.Write(obj2.\u003580409426488);
          using (IEnumerator<\u003903072175344> enumerator = obj2.\u003714971354622())
          {
            while (enumerator.MoveNext())
            {
              \u003903072175344 current = enumerator.Current;
              this.\u003519289603218.Write((sbyte) current.\u003321034437798.\u003900690472005);
              this.\u003069309274343((string) current.\u003847542158114.\u003617834078463, current.\u003847542158114.\u003426416179562, new int?());
              this.\u003775788279062(current.\u003321034437798);
            }
          }
          this.\u003519289603218.Write((byte) 0);
          break;
        case \u003912974945849.Array:
          \u003506367008704 obj3 = (\u003506367008704) _param1;
          this.\u003519289603218.Write(obj3.\u003580409426488);
          ulong num1 = 0;
          using (IEnumerator<\u003475498445366> enumerator = obj3.\u003696946068168())
          {
            while (enumerator.MoveNext())
            {
              \u003475498445366 current = enumerator.Current;
              this.\u003519289603218.Write((sbyte) current.\u003900690472005);
              this.\u003069309274343(num1.ToString((IFormatProvider) CultureInfo.InvariantCulture), \u003243965671827.\u003396658521286(num1), new int?());
              this.\u003775788279062(current);
              ++num1;
            }
          }
          this.\u003519289603218.Write((byte) 0);
          break;
        case \u003912974945849.Binary:
          \u003121537261010 obj4 = (\u003121537261010) _param1;
          byte[] buffer = (byte[]) obj4.\u003617834078463;
          this.\u003519289603218.Write(buffer.Length);
          this.\u003519289603218.Write((byte) obj4.\u003048276302074);
          this.\u003519289603218.Write(buffer);
          break;
        case \u003912974945849.Undefined:
          break;
        case \u003912974945849.Oid:
          this.\u003519289603218.Write((byte[]) ((\u003187355208708) _param1).\u003617834078463);
          break;
        case \u003912974945849.Boolean:
          this.\u003519289603218.Write(_param1 == \u003773168217346.\u003319893910231);
          break;
        case \u003912974945849.Date:
          \u003187355208708 obj5 = (\u003187355208708) _param1;
          long num2;
          if (obj5.\u003617834078463 is DateTime)
          {
            DateTime dateTime = (DateTime) obj5.\u003617834078463;
            if (this.\u003172846978417 == DateTimeKind.Utc)
              dateTime = dateTime.ToUniversalTime();
            else if (this.\u003172846978417 == DateTimeKind.Local)
              dateTime = dateTime.ToLocalTime();
            num2 = \u003519131386819.\u003347988087003(dateTime, false);
          }
          else
          {
            DateTimeOffset dateTimeOffset = (DateTimeOffset) obj5.\u003617834078463;
            num2 = \u003519131386819.\u003085341948674(dateTimeOffset.UtcDateTime, dateTimeOffset.Offset);
          }
          this.\u003519289603218.Write(num2);
          break;
        case \u003912974945849.Null:
          break;
        case \u003912974945849.Regex:
          \u003011005920600 obj6 = (\u003011005920600) _param1;
          this.\u003069309274343((string) obj6.\u003623857609815.\u003617834078463, obj6.\u003623857609815.\u003426416179562, new int?());
          this.\u003069309274343((string) obj6.\u003750730661165.\u003617834078463, obj6.\u003750730661165.\u003426416179562, new int?());
          break;
        case \u003912974945849.Integer:
          this.\u003519289603218.Write(Convert.ToInt32(((\u003187355208708) _param1).\u003617834078463, (IFormatProvider) CultureInfo.InvariantCulture));
          break;
        case \u003912974945849.Long:
          this.\u003519289603218.Write(Convert.ToInt64(((\u003187355208708) _param1).\u003617834078463, (IFormatProvider) CultureInfo.InvariantCulture));
          break;
        default:
          throw new ArgumentOutOfRangeException("t", "Unexpected token when writing BSON: {0}".\u003212424921759((IFormatProvider) CultureInfo.InvariantCulture, (object) _param1.\u003900690472005));
      }
    }

    private void \u003069309274343(string _param1, int _param2, int? _param3)
    {
      if (_param3.HasValue)
        this.\u003519289603218.Write(_param3.GetValueOrDefault());
      this.\u003189954831071(_param1, _param2);
      this.\u003519289603218.Write((byte) 0);
    }

    public void \u003189954831071(string _param1, int _param2)
    {
      if (_param1 == null)
        return;
      if (_param2 <= 256)
      {
        if (this.\u003830048120502 == null)
          this.\u003830048120502 = new byte[256];
        \u003869194900021.\u003737041315894.GetBytes(_param1, 0, _param1.Length, this.\u003830048120502, 0);
        this.\u003519289603218.Write(this.\u003830048120502, 0, _param2);
      }
      else
        this.\u003519289603218.Write(\u003869194900021.\u003737041315894.GetBytes(_param1));
    }

    private int \u003154034605153(int _param1) => _param1 + 1;

    private int \u003421234296005(int _param1, bool _param2) => (_param2 ? 5 : 1) + _param1;

    private int \u003587022954945(\u003475498445366 _param1)
    {
      switch (_param1.\u003900690472005)
      {
        case \u003912974945849.Number:
          return 8;
        case \u003912974945849.String:
          \u003650945770894 obj1 = (\u003650945770894) _param1;
          string s = (string) obj1.\u003617834078463;
          obj1.\u003426416179562 = s != null ? \u003869194900021.\u003737041315894.GetByteCount(s) : 0;
          obj1.\u003580409426488 = this.\u003421234296005(obj1.\u003426416179562, obj1.\u003860688870652);
          return obj1.\u003580409426488;
        case \u003912974945849.Object:
          \u003719440416830 obj2 = (\u003719440416830) _param1;
          int num1 = 4;
          using (IEnumerator<\u003903072175344> enumerator = obj2.\u003714971354622())
          {
            while (enumerator.MoveNext())
            {
              \u003903072175344 current = enumerator.Current;
              int num2 = 1 + this.\u003587022954945((\u003475498445366) current.\u003847542158114) + this.\u003587022954945(current.\u003321034437798);
              num1 += num2;
            }
          }
          int num3 = num1 + 1;
          obj2.\u003580409426488 = num3;
          return num3;
        case \u003912974945849.Array:
          \u003506367008704 obj3 = (\u003506367008704) _param1;
          int num4 = 4;
          ulong num5 = 0;
          using (IEnumerator<\u003475498445366> enumerator = obj3.\u003696946068168())
          {
            while (enumerator.MoveNext())
            {
              \u003475498445366 current = enumerator.Current;
              ++num4;
              num4 += this.\u003154034605153(\u003243965671827.\u003396658521286(num5));
              num4 += this.\u003587022954945(current);
              ++num5;
            }
          }
          int num6 = num4 + 1;
          obj3.\u003580409426488 = num6;
          return obj3.\u003580409426488;
        case \u003912974945849.Binary:
          \u003121537261010 obj4 = (\u003121537261010) _param1;
          obj4.\u003580409426488 = 5 + ((byte[]) obj4.\u003617834078463).Length;
          return obj4.\u003580409426488;
        case \u003912974945849.Undefined:
        case \u003912974945849.Null:
          return 0;
        case \u003912974945849.Oid:
          return 12;
        case \u003912974945849.Boolean:
          return 1;
        case \u003912974945849.Date:
          return 8;
        case \u003912974945849.Regex:
          \u003011005920600 obj5 = (\u003011005920600) _param1;
          int num7 = 0 + this.\u003587022954945((\u003475498445366) obj5.\u003623857609815) + this.\u003587022954945((\u003475498445366) obj5.\u003750730661165);
          obj5.\u003580409426488 = num7;
          return obj5.\u003580409426488;
        case \u003912974945849.Integer:
          return 4;
        case \u003912974945849.Long:
          return 8;
        default:
          throw new ArgumentOutOfRangeException("t", "Unexpected token when writing BSON: {0}".\u003212424921759((IFormatProvider) CultureInfo.InvariantCulture, (object) _param1.\u003900690472005));
      }
    }
  }
}
