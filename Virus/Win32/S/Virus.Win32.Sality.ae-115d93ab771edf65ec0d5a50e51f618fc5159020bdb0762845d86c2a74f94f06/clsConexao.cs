// Decompiled with JetBrains decompiler
// Type: IngressoVip.clsConexao
// Assembly: IngressoVip, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B67C4084-86FB-4B3F-B072-28F5697F4668
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Virus.Win32.Sality.ae-115d93ab771edf65ec0d5a50e51f618fc5159020bdb0762845d86c2a74f94f06.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Data;
using System.Runtime.CompilerServices;

namespace IngressoVip
{
  public class clsConexao
  {
    private clsFuncoes objFuncoes;

    public clsConexao() => this.objFuncoes = new clsFuncoes();

    public string connLocal()
    {
      string str1 = (string) null;
      string str2;
      try
      {
        DataSet dataSet = new DataSet();
        int num = (int) dataSet.ReadXml("conexao.xml");
        DataRow row = dataSet.Tables[0].Rows[0];
        str2 = string.Format("Server={0}; Database={1}; Uid={2}; Pwd={3}; Connect Timeout=30;", RuntimeHelpers.GetObjectValue(row[0]), RuntimeHelpers.GetObjectValue(row[1]), RuntimeHelpers.GetObjectValue(row[2]), RuntimeHelpers.GetObjectValue(row[3]));
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        str2 = str1;
        ProjectData.ClearProjectError();
      }
      return str2;
    }

    public string connRemoto()
    {
      string str1 = (string) null;
      string str2;
      try
      {
        str2 = string.Format("Server=187.54.196.79; Port=64399; Database=ingressodesenv; Uid=ingressouser; Pwd=ingressouser;");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        Exception exception = ex;
        this.objFuncoes.MsgConsole("Erro na conexao na funcao connRemoto " + exception.ToString());
        int num = (int) Interaction.MsgBox((object) exception.ToString());
        this.objFuncoes.MsgConsole("Valor de strString em connRemoto " + str1);
        str2 = str1;
        ProjectData.ClearProjectError();
      }
      return str2;
    }
  }
}
