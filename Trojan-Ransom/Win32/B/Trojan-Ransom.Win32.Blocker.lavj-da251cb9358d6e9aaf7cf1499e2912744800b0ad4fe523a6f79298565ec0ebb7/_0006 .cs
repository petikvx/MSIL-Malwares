// Decompiled with JetBrains decompiler
// Type:  
// Assembly: AV, Version=2.0.5.0, Culture=neutral, PublicKeyToken=null
// MVID: 56F2F6CB-C947-430A-8E47-6539AD6C5806
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\Trojan-Ransom.Win32.Blocker.lavj-da251cb9358d6e9aaf7cf1499e2912744800b0ad4fe523a6f79298565ec0ebb7.exe

using System;
using System.Collections;
using System.Runtime.InteropServices;
using System.Text;

internal sealed class \u0006\u2001
{
  private static bool \u0002;
  private string \u0003 = string.Empty;
  private int \u0005 = -1;
  private static \u000F\u2000.IShellFolder \u0008;
  private \u000F\u2000.IShellFolder \u0006;
  private IntPtr \u000E = IntPtr.Zero;
  private bool \u000F;
  private bool \u0002\u2000;
  private string \u0003\u2000 = string.Empty;

  public \u0006\u2001()
  {
    if (\u0006\u2001.\u0002)
      throw new Exception(\u0005\u2003.\u0002(1603291958));
    int errorCode1 = \u000F\u2000.\u0002(ref \u0006\u2001.\u0008);
    if (errorCode1 != 0)
      Marshal.ThrowExceptionForHR(errorCode1);
    int errorCode2 = \u000F\u2000.\u0002(IntPtr.Zero, (\u000F\u2000.\u000E) 0, ref this.\u000E);
    if (errorCode2 != 0)
      Marshal.ThrowExceptionForHR(errorCode2);
    \u000F\u2000.\u000F structure = new \u000F\u2000.\u000F();
    \u000F\u2000.\u0002(this.\u000E, 0U, out structure, (uint) Marshal.SizeOf((object) structure), (\u000F\u2000.\u0006) 16905);
    this.\u0002(structure.\u0008);
    this.\u0002(structure.\u0003);
    this.\u0002(true);
    this.\u0003(true);
    this.\u0003(this.\u0002());
    this.\u0006 = this.\u0002();
    \u0006\u2001.\u0002 = true;
  }

  public \u0006\u2001(\u000F\u2000.IShellFolder _param1, IntPtr _param2, \u0006\u2001 _param3)
  {
    if (!\u0006\u2001.\u0002)
      throw new Exception(\u0005\u2003.\u0002(1603292110));
    this.\u000E = \u000F\u2000.\u0002(_param3.\u0002(), _param2);
    \u000F\u2000.\u0005 rgfInOut = \u000F\u2000.\u0005.SFGAO_FOLDER | \u000F\u2000.\u0005.SFGAO_HASSUBFOLDER;
    int attributesOf = (int) _param1.GetAttributesOf(1, out this.\u000E, out rgfInOut);
    this.\u0002(Convert.ToBoolean((object) (rgfInOut & \u000F\u2000.\u0005.SFGAO_FOLDER)));
    this.\u0003(Convert.ToBoolean((object) (rgfInOut & \u000F\u2000.\u0005.SFGAO_HASSUBFOLDER)));
    \u000F\u2000.\u000F structure = new \u000F\u2000.\u000F();
    \u000F\u2000.\u0006 obj = (\u000F\u2000.\u0006) 16905;
    \u000F\u2000.\u0002(this.\u000E, 0U, out structure, (uint) Marshal.SizeOf((object) structure), obj);
    this.\u0002(structure.\u0008);
    this.\u0002(structure.\u0003);
    this.\u0003(this.\u0002());
    if (!this.\u0002())
      return;
    uint errorCode = _param3.\u0006.BindToObject(_param2, IntPtr.Zero, ref \u000F\u2000.\u0002, out this.\u0006);
    if (errorCode == 0U)
      return;
    Marshal.ThrowExceptionForHR((int) errorCode);
  }

  ~\u0006\u2001()
  {
    if (this.\u0006 != null)
      Marshal.ReleaseComObject((object) this.\u0006);
    if (!this.\u000E.Equals((object) IntPtr.Zero))
      Marshal.FreeCoTaskMem(this.\u000E);
    GC.SuppressFinalize((object) this);
  }

  public string \u0002()
  {
    StringBuilder stringBuilder = new StringBuilder(256);
    \u000F\u2000.\u0002(this.\u000E, stringBuilder);
    return stringBuilder.ToString();
  }

  public ArrayList \u0002()
  {
    if (!this.\u0002())
      throw new Exception(\u0005\u2003.\u0002(1603292037));
    ArrayList arrayList = new ArrayList();
    try
    {
      \u000F\u2000.IEnumIDList ppenumIDList = (\u000F\u2000.IEnumIDList) null;
      uint errorCode = this.\u0003().EnumObjects(IntPtr.Zero, (\u000F\u2000.\u0003) 32, out ppenumIDList);
      if (errorCode != 0U)
        Marshal.ThrowExceptionForHR((int) errorCode);
      IntPtr rgelt = IntPtr.Zero;
      int pceltFetched = 0;
      for (int index = (int) ppenumIDList.Next(1U, out rgelt, out pceltFetched); !rgelt.Equals((object) IntPtr.Zero) && pceltFetched == 1; int num = (int) ppenumIDList.Next(1U, out rgelt, out pceltFetched))
      {
        arrayList.Add((object) new \u0006\u2001(\u0006\u2001.\u0008, rgelt, this));
        Marshal.FreeCoTaskMem(rgelt);
        rgelt = IntPtr.Zero;
        pceltFetched = 0;
      }
      if (ppenumIDList != null)
        Marshal.ReleaseComObject((object) ppenumIDList);
    }
    catch
    {
    }
    return arrayList;
  }

  public string \u0003() => this.\u0003;

  public void \u0002(string _param1) => this.\u0003 = _param1;

  public int \u0002() => this.\u0005;

  public void \u0002(int _param1) => this.\u0005 = _param1;

  public \u000F\u2000.IShellFolder \u0002() => \u0006\u2001.\u0008;

  public \u000F\u2000.IShellFolder \u0003() => this.\u0006;

  public IntPtr \u0002() => this.\u000E;

  public bool \u0002() => this.\u000F;

  public void \u0002(bool _param1) => this.\u000F = _param1;

  public bool \u0003() => this.\u0002\u2000;

  public void \u0003(bool _param1) => this.\u0002\u2000 = _param1;

  public string \u0005() => this.\u0003\u2000;

  public void \u0003(string _param1) => this.\u0003\u2000 = _param1;
}
