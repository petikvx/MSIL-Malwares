// Decompiled with JetBrains decompiler
// Type: 196074163299.470330703403
// Assembly: 341658236064, Version=3.1.2.23007, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 307D4BC7-4605-49A1-A696-CC8CC5C1D6BD
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-9d52a7814f157b00620b7405701cf26d9edc2be1ad2620905db66c87fcee811b.exe

using \u003194072293457;
using \u003196074163299;
using \u003253358266500;
using \u003785552231676;
using \u003788780786144;
using Microsoft.Build.Framework;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Xml.Linq;

namespace \u003196074163299
{
  internal class \u003470330703403
  {
    private IBuildEngine4 \u003301608660873;

    public \u003470330703403(IBuildEngine4 buildEngine) => this.\u003301608660873 = buildEngine;

    public IEnumerable<\u003614480395534> \u003999855736155(
      string _param1,
      \u003764798047079 _param2)
    {
      if (_param1 == null)
        throw new ArgumentNullException("frameworkListPath");
      if (!Path.IsPathRooted(_param1))
        throw new \u003606057521981(\u003064471764011.\u003926710525814, new string[1]
        {
          _param1
        });
      string key = typeof (\u003470330703403).GetTypeInfo().Assembly.FullName + ":470330703403:" + _param1;
      object registeredTaskObject = this.\u003301608660873.GetRegisteredTaskObject((object) key, RegisteredTaskObjectLifetime.AppDomain);
      IEnumerable<\u003614480395534> objs;
      if (registeredTaskObject == null)
      {
        objs = \u003470330703403.\u003077658180151(_param1, _param2);
        this.\u003301608660873.RegisterTaskObject((object) key, (object) objs, RegisteredTaskObjectLifetime.AppDomain, true);
      }
      else
        objs = (IEnumerable<\u003614480395534>) registeredTaskObject;
      return objs;
    }

    private static IEnumerable<\u003614480395534> \u003077658180151(
      string _param0,
      \u003764798047079 _param1)
    {
      if (!File.Exists(_param0))
        return Enumerable.Empty<\u003614480395534>();
      XDocument xdocument = XDocument.Load(_param0);
      List<\u003614480395534> objList = new List<\u003614480395534>();
      foreach (XElement element in xdocument.Root.Elements((XName) "File"))
      {
        string str1 = element.Attribute((XName) "AssemblyName")?.Value;
        string input = element.Attribute((XName) "Version")?.Value;
        if (string.IsNullOrEmpty(str1))
        {
          string str2 = string.Format((IFormatProvider) CultureInfo.CurrentCulture, \u003064471764011.\u003536340423697, (object) _param0, (object) "AssemblyName", (object) str1);
          _param1.\u003546249343367(str2);
          return Enumerable.Empty<\u003614480395534>();
        }
        Version result;
        if (string.IsNullOrEmpty(input) || !Version.TryParse(input, out result))
        {
          string str3 = string.Format((IFormatProvider) CultureInfo.CurrentCulture, \u003064471764011.\u003536340423697, (object) _param0, (object) "Version", (object) input);
          _param1.\u003546249343367(str3);
          return Enumerable.Empty<\u003614480395534>();
        }
        objList.Add(new \u003614480395534(str1 + ".dll", "TargetingPack", result, (Version) null));
      }
      return (IEnumerable<\u003614480395534>) objList;
    }
  }
}
