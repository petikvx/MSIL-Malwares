// Decompiled with JetBrains decompiler
// Type: 3CB761C0
// Assembly: JustSvK was here ;D, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 17F13239-28E0-4F33-9D80-95AE56A139B0
// Assembly location: C:\Users\Administrateur\Downloads\toto\HEUR-Trojan-Ransom.MSIL.Blocker.gen-16c7811696471900b3a83f0b8949a6f14fe1aaf67c424d9ceeedce51dc3016fe.exe

using System;
using System.IO;

public class \u0033CB761C0
{
  private uint \u003234C1099 = 1;
  private readonly \u00348845EB6 \u00339296AC2 = new \u00348845EB6();
  private readonly \u0031E43112E \u0031E0B0E26 = new \u0031E43112E();
  private readonly \u003094027B4[] \u003395E38CB = new \u003094027B4[192];
  private readonly \u003094027B4[] \u0031C375E0B = new \u003094027B4[12];
  private readonly \u003094027B4[] \u00360B61AF1 = new \u003094027B4[12];
  private readonly \u003094027B4[] \u003157C1A50 = new \u003094027B4[12];
  private readonly \u003094027B4[] \u0031DE54EA6 = new \u003094027B4[12];
  private readonly \u003094027B4[] \u00374DA580B = new \u003094027B4[192];
  private readonly \u003118D38E3[] \u0036F7C5EC6 = new \u003118D38E3[4];
  private readonly \u003094027B4[] \u00346022F31 = new \u003094027B4[114];
  private \u003118D38E3 \u0031C6C0A15 = new \u003118D38E3(4);
  private readonly \u0033CB761C0.\u00303D60D78 \u003520374AC = new \u0033CB761C0.\u00303D60D78();
  private readonly \u0033CB761C0.\u00303D60D78 \u00355C56DE8 = new \u0033CB761C0.\u00303D60D78();
  private readonly \u0033CB761C0.\u0036B056177 \u0036F255AAE = new \u0033CB761C0.\u0036B056177();
  private uint \u00325C44922;
  private uint \u00308156B44;
  private uint \u003500D6B62;

  public \u0033CB761C0()
  {
    this.\u00325C44922 = uint.MaxValue;
    for (int index = 0; index < 4; ++index)
      this.\u0036F7C5EC6[index] = new \u003118D38E3(6);
  }

  private void \u00341D65F32(uint _param1)
  {
    if ((int) this.\u00325C44922 == (int) _param1)
      return;
    this.\u00325C44922 = _param1;
    this.\u00308156B44 = Math.Max(this.\u00325C44922, 1U);
    this.\u00339296AC2.\u003065E09E0(Math.Max(this.\u00308156B44, 4096U));
  }

  private void \u0030CB8780A(int _param1, int _param2)
  {
    if (_param1 > 8)
      throw new ArgumentException("lp > 8");
    if (_param2 > 8)
      throw new ArgumentException("lc > 8");
    this.\u0036F255AAE.\u0032ACA5407(_param1, _param2);
  }

  private void \u0030C5876D0(int _param1)
  {
    if (_param1 > 4)
      throw new ArgumentException("pb > Base.KNumPosStatesBitsMax");
    uint num = (uint) (1 << _param1);
    this.\u003520374AC.\u0032D567B1B(num);
    this.\u00355C56DE8.\u0032D567B1B(num);
    this.\u003500D6B62 = num - 1U;
  }

  private void \u00302B378D9(Stream _param1, Stream _param2)
  {
    this.\u0031E0B0E26.\u0030735247B(_param1);
    this.\u00339296AC2.\u003245C6894(_param2, false);
    for (uint index1 = 0; index1 < 12U; ++index1)
    {
      for (uint index2 = 0; index2 <= this.\u003500D6B62; ++index2)
      {
        uint index3 = (index1 << 4) + index2;
        this.\u003395E38CB[(int) index3].\u003570C2D19();
        this.\u00374DA580B[(int) index3].\u003570C2D19();
      }
      this.\u0031C375E0B[(int) index1].\u003570C2D19();
      this.\u00360B61AF1[(int) index1].\u003570C2D19();
      this.\u003157C1A50[(int) index1].\u003570C2D19();
      this.\u0031DE54EA6[(int) index1].\u003570C2D19();
    }
    this.\u0036F255AAE.\u0036722660D();
    for (uint index = 0; index < 4U; ++index)
      this.\u0036F7C5EC6[(int) index].\u0034E3D4C51();
    for (uint index = 0; index < 114U; ++index)
      this.\u00346022F31[(int) index].\u003570C2D19();
    this.\u003520374AC.\u0031E9B0EE0();
    this.\u00355C56DE8.\u0031E9B0EE0();
    this.\u0031C6C0A15.\u0034E3D4C51();
  }

  public void \u00315EB1957(Stream _param1, Stream _param2, long _param3)
  {
    this.\u00302B378D9(_param1, _param2);
    \u003186E6F80.\u00347E852E0 obj = new \u003186E6F80.\u00347E852E0();
    obj.\u003573D0204();
    uint num1 = 0;
    uint num2 = 0;
    uint num3 = 0;
    uint num4 = 0;
    ulong num5 = 0;
    ulong num6 = (ulong) _param3;
    if (num5 < num6)
    {
      if (this.\u003395E38CB[(int) obj.\u0034CF74CC0 << 4].\u00332213331(this.\u0031E0B0E26) != 0U)
        throw new InvalidDataException("IsMatchDecoders");
      obj.\u00323084125();
      this.\u00339296AC2.\u003336F1272(this.\u0036F255AAE.\u00376865F42(this.\u0031E0B0E26, 0U, (byte) 0));
      ++num5;
    }
    while (num5 < num6)
    {
      uint num7 = (uint) num5 & this.\u003500D6B62;
      if (this.\u003395E38CB[((int) obj.\u0034CF74CC0 << 4) + (int) num7].\u00332213331(this.\u0031E0B0E26) == 0U)
      {
        byte num8 = this.\u00339296AC2.\u003226D51A1(0U);
        this.\u00339296AC2.\u003336F1272(obj.\u0035F877E48() ? this.\u0036F255AAE.\u00376865F42(this.\u0031E0B0E26, (uint) num5, num8) : this.\u0036F255AAE.\u003250B0CEA(this.\u0031E0B0E26, (uint) num5, num8, this.\u00339296AC2.\u003226D51A1(num1)));
        obj.\u00323084125();
        ++num5;
      }
      else
      {
        uint num9;
        if (this.\u0031C375E0B[(int) obj.\u0034CF74CC0].\u00332213331(this.\u0031E0B0E26) == 1U)
        {
          if (this.\u00360B61AF1[(int) obj.\u0034CF74CC0].\u00332213331(this.\u0031E0B0E26) == 0U)
          {
            if (this.\u00374DA580B[((int) obj.\u0034CF74CC0 << 4) + (int) num7].\u00332213331(this.\u0031E0B0E26) == 0U)
            {
              obj.\u003446674F2();
              this.\u00339296AC2.\u003336F1272(this.\u00339296AC2.\u003226D51A1(num1));
              ++num5;
              continue;
            }
          }
          else
          {
            uint num10;
            if (this.\u003157C1A50[(int) obj.\u0034CF74CC0].\u00332213331(this.\u0031E0B0E26) == 0U)
            {
              num10 = num2;
            }
            else
            {
              if (this.\u0031DE54EA6[(int) obj.\u0034CF74CC0].\u00332213331(this.\u0031E0B0E26) == 0U)
              {
                num10 = num3;
              }
              else
              {
                num10 = num4;
                num4 = num3;
              }
              num3 = num2;
            }
            num2 = num1;
            num1 = num10;
          }
          num9 = this.\u00355C56DE8.\u0036A345E7F(this.\u0031E0B0E26, num7) + 2U;
          obj.\u003303B599D();
        }
        else
        {
          num4 = num3;
          num3 = num2;
          num2 = num1;
          num9 = 2U + this.\u003520374AC.\u0036A345E7F(this.\u0031E0B0E26, num7);
          obj.\u00373C243BF();
          uint num11 = this.\u0036F7C5EC6[(int) \u003186E6F80.\u003750772EF(num9)].\u0033720293E(this.\u0031E0B0E26);
          if (num11 >= 4U)
          {
            int num12 = (int) (num11 >> 1) - 1;
            uint num13 = (uint) ((2 | (int) num11 & 1) << num12);
            num1 = num11 >= 14U ? num13 + (this.\u0031E0B0E26.\u0031B834825(num12 - 4) << 4) + this.\u0031C6C0A15.\u00356373486(this.\u0031E0B0E26) : num13 + \u003118D38E3.\u0035C5B0544(this.\u00346022F31, (uint) ((int) num13 - (int) num11 - 1), this.\u0031E0B0E26, num12);
          }
          else
            num1 = num11;
        }
        if ((ulong) num1 >= (ulong) this.\u00339296AC2.\u0035DB32BA2 + num5 || num1 >= this.\u00308156B44)
        {
          if (num1 != uint.MaxValue)
            throw new InvalidDataException("rep0");
          break;
        }
        this.\u00339296AC2.\u0035F8D0DAC(num1, num9);
        num5 += (ulong) num9;
      }
    }
    this.\u00339296AC2.\u0030A650872();
    this.\u00339296AC2.\u00318D3298F();
    this.\u0031E0B0E26.\u0034B8922EE();
  }

  public void \u003339C19E1(byte[] _param1)
  {
    if (_param1.Length < 5)
      throw new ArgumentException("properties.Length < 5");
    int num1 = (int) _param1[0] % 9;
    int num2 = (int) _param1[0] / 9;
    int num3 = num2 % 5;
    int num4 = num2 / 5;
    if (num4 > 4)
      throw new ArgumentException("pb > Base.kNumPosStatesBitsMax");
    uint num5 = 0;
    for (int index = 0; index < 4; ++index)
      num5 += (uint) _param1[1 + index] << index * 8;
    this.\u00341D65F32(num5);
    this.\u0030CB8780A(num3, num1);
    this.\u0030C5876D0(num4);
  }

  private class \u00303D60D78
  {
    private \u003094027B4 \u00349AC36E1;
    private \u003094027B4 \u0036DB87C00;
    private readonly \u003118D38E3[] \u0036E2E6046 = new \u003118D38E3[16];
    private readonly \u003118D38E3[] \u003110406EB = new \u003118D38E3[16];
    private \u003118D38E3 \u003754740AC = new \u003118D38E3(8);
    private uint \u00346FF36B2;

    public void \u0032D567B1B(uint _param1)
    {
      for (uint index = this.\u00346FF36B2; index < _param1; ++index)
      {
        this.\u0036E2E6046[(int) index] = new \u003118D38E3(3);
        this.\u003110406EB[(int) index] = new \u003118D38E3(3);
      }
      this.\u00346FF36B2 = _param1;
    }

    public void \u0031E9B0EE0()
    {
      this.\u00349AC36E1.\u003570C2D19();
      for (uint index = 0; index < this.\u00346FF36B2; ++index)
      {
        this.\u0036E2E6046[(int) index].\u0034E3D4C51();
        this.\u003110406EB[(int) index].\u0034E3D4C51();
      }
      this.\u0036DB87C00.\u003570C2D19();
      this.\u003754740AC.\u0034E3D4C51();
    }

    public uint \u0036A345E7F(\u0031E43112E _param1, uint _param2)
    {
      if (this.\u00349AC36E1.\u00332213331(_param1) == 0U)
        return this.\u0036E2E6046[(int) _param2].\u0033720293E(_param1);
      uint num = 8;
      return this.\u0036DB87C00.\u00332213331(_param1) != 0U ? num + 8U + this.\u003754740AC.\u0033720293E(_param1) : num + this.\u003110406EB[(int) _param2].\u0033720293E(_param1);
    }
  }

  private class \u0036B056177
  {
    private uint \u00359391382 = 1;
    private \u0033CB761C0.\u0036B056177.\u00326CB4D32[] \u0030A57117B;
    private int \u003631A7B4B;
    private int \u00304F844DE;
    private uint \u00333584E9B;

    public void \u0032ACA5407(int _param1, int _param2)
    {
      if (this.\u0030A57117B != null && this.\u003631A7B4B == _param2 && this.\u00304F844DE == _param1)
        return;
      this.\u00304F844DE = _param1;
      this.\u00333584E9B = (uint) ((1 << _param1) - 1);
      this.\u003631A7B4B = _param2;
      uint length = (uint) (1 << this.\u003631A7B4B + this.\u00304F844DE);
      this.\u0030A57117B = new \u0033CB761C0.\u0036B056177.\u00326CB4D32[(int) length];
      for (uint index = 0; index < length; ++index)
        this.\u0030A57117B[(int) index].\u0036EB54633();
    }

    public void \u0036722660D()
    {
      uint num = (uint) (1 << this.\u003631A7B4B + this.\u00304F844DE);
      for (uint index = 0; index < num; ++index)
        this.\u0030A57117B[(int) index].\u0035D190BF8();
    }

    private uint \u00352895B8D(uint _param1, byte _param2) => (uint) ((((int) _param1 & (int) this.\u00333584E9B) << this.\u003631A7B4B) + ((int) _param2 >> 8 - this.\u003631A7B4B));

    public byte \u00376865F42(\u0031E43112E _param1, uint _param2, byte _param3) => this.\u0030A57117B[(int) this.\u00352895B8D(_param2, _param3)].\u00301934349(_param1);

    public byte \u003250B0CEA(\u0031E43112E _param1, uint _param2, byte _param3, byte _param4) => this.\u0030A57117B[(int) this.\u00352895B8D(_param2, _param3)].\u0035B046FEC(_param1, _param4);

    private struct \u00326CB4D32
    {
      private \u003094027B4[] \u003134B39D2;

      public void \u0036EB54633() => this.\u003134B39D2 = new \u003094027B4[768];

      public void \u0035D190BF8()
      {
        for (int index = 0; index < 768; ++index)
          this.\u003134B39D2[index].\u003570C2D19();
      }

      public byte \u00301934349(\u0031E43112E _param1)
      {
        uint index = 1;
        do
        {
          index = index << 1 | this.\u003134B39D2[(int) index].\u00332213331(_param1);
        }
        while (index < 256U);
        return (byte) index;
      }

      public byte \u0035B046FEC(\u0031E43112E _param1, byte _param2)
      {
        uint index = 1;
        do
        {
          uint num1 = (uint) ((int) _param2 >> 7 & 1);
          _param2 <<= 1;
          uint num2 = this.\u003134B39D2[(1 + (int) num1 << 8) + (int) index].\u00332213331(_param1);
          index = index << 1 | num2;
          if ((int) num1 != (int) num2)
          {
            while (index < 256U)
              index = index << 1 | this.\u003134B39D2[(int) index].\u00332213331(_param1);
            break;
          }
        }
        while (index < 256U);
        return (byte) index;
      }
    }
  }
}
