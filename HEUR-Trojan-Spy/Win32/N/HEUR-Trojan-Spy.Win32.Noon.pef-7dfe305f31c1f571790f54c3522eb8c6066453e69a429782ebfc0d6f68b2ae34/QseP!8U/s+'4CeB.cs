// Decompiled with JetBrains decompiler
// Type: QseP!8U.s+'4CeB
// Assembly: ;8w1LFr, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 2CC07ADF-5A94-44BC-9C37-07435DAD286F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.Win32.Noon.pef-7dfe305f31c1f571790f54c3522eb8c6066453e69a429782ebfc0d6f68b2ae34.exe

using \u0029k5W2gU;
using \u002AM\u0029\u003A\u0023VB;
using \u002F2hTKun;
using \u00328_itxb;
using \u0035\u002D8\u0029\u002FKT;
using \u0038\u002BTx\u002D\u002F\u002F;
using \u003B8w1LFr;
using \u005E4VJCWZ;
using Bs_o7\u002F1;
using jjbSN\u005EY;
using qNu\u003As\u007EV;
using QseP\u00218U;
using R\u002Desm_z;
using Rebex;
using Rebex.Net;
using System;
using System.Collections;
using System.Globalization;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Text;
using System.Threading;
using VZ\u00298PQA;
using YEm\u0021AF\u002D;
using ZYxar\u002FL;

namespace QseP\u00218U
{
  public class s\u002B\u00274CeB : IDisposable
  {
    public const int yuvp\u002AgM = 22;
    internal const string \u007EVqF\u002AX3 = "Sftp";
    private static readonly char[] \u002BAzG\u007EHG = new char[12]
    {
      char.MinValue,
      '\b',
      '\u0010',
      '\u0011',
      '\u0012',
      '\u0014',
      '\u0015',
      '\u0016',
      '\u0017',
      '\u0018',
      '\u0019',
      '\\'
    };
    internal static char[] WtycDZ8;
    private static readonly byte[] _\u002Drn\u0021j7 = Encoding.ASCII.GetBytes(sgxPeiI.LiHKl\u0027x("O_L+", "WAP7kr4oRqHlPkgM3fwOJ"));
    private static readonly byte[] \u005E\u0025WB2dX = Encoding.ASCII.GetBytes(sgxPeiI.LiHKl\u0027x("O^M*", "WAP7kr4oRqHlPkgM3fwOJ"));
    private static int \u0024\u0021D8P\u002Dg;
    private readonly int \u0036s\u0029r0\u002AI;
    private ILogWriter \u0039\u005E\u002DhKMH;
    private Encoding PQ\u0040\u0027J\u002Dg = Encoding.Default;
    private int \u0040N\u002B37Wx = 60000;
    private readonly ArrayList \u003A2O\u002B6\u0040j = new ArrayList();
    private readonly object BhSrZj\u002D = new object();
    private ISocketFactory bp\u002BykS\u0027;
    private F\u002DEF0Rm \u0037\u002BnzF5R;
    private bool DAA\u007EC\u002Bw;
    private bool nj\u0024PFyb;
    private SshSession \u0021\u002B\u0040iT1\u0029;

    public event \u0023\u003F\u0029HSk\u007E \u002F\u002AR\u003B3FT;

    protected virtual void OnTransferProgress(y\u003AAZ\u002B\u002Bo e)
    {
      // ISSUE: reference to a compiler-generated field
      if (this.\u0038qRe\u0024\u0029l == null)
        return;
      // ISSUE: reference to a compiler-generated field
      this.\u0038qRe\u0024\u0029l((object) this, e);
    }

    internal void \u0040V9FuHy(
      LogLevel _param1,
      \u0034\u003Fx\u00250\u0021v _param2,
      string _param3,
      byte[] _param4,
      int _param5,
      int _param6)
    {
      if (this.\u0039\u005E\u002DhKMH == null || this.\u0039\u005E\u002DhKMH.Level > _param1)
        return;
      this.\u0039\u005E\u002DhKMH.Write(_param1, this.GetType(), this.\u0036s\u0029r0\u002AI, _param2.ToString(), _param3, _param4, _param5, _param6);
    }

    internal void l_\u007Edu4e(
      LogLevel _param1,
      \u0034\u003Fx\u00250\u0021v GfaME8L,
      string _param3,
      params object[] _param4)
    {
      if (this.\u0039\u005E\u002DhKMH == null || this.\u0039\u005E\u002DhKMH.Level > _param1)
        return;
      string str = _param4 == null || _param4.Length == 0 ? _param3 : string.Format(_param3, _param4);
      this.\u0039\u005E\u002DhKMH.Write(_param1, this.GetType(), this.\u0036s\u0029r0\u002AI, GfaME8L.ToString(), str);
    }

    public s\u002B\u00274CeB()
    {
      if (Environment.OSVersion.Platform == PlatformID.WinCE)
        throw new NotSupportedException(sgxPeiI.LiHKl\u0027x("+\u0001\u0011lc,y5\t0\u000F*X,)EI+=\u0002\u001A_:>K\u0013zx(\u001F*@*\u00177o\u0016n>/\b\u0010\vIVQ\u0006\u000E<\u0004\u00154\u0010%\u001B7o#i/2\u0002\u0015\u0010\u001B\u00131c\np\"\u001B*\u0005d\r0*Eo&:G!9I\u000Ez1)u(\u0014w", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (s\u002B\u00274CeB.WtycDZ8 == null)
        s\u002B\u00274CeB.WtycDZ8 = Path.GetInvalidPathChars();
      this.\u0036s\u0029r0\u002AI = Interlocked.Increment(ref s\u002B\u00274CeB.\u0024\u0021D8P\u002Dg);
      this.Dt\u0024Xe\u003Ag();
    }

    private void GBA\u002738D(F\u002DEF0Rm _param1)
    {
      if (this.\u0037\u002BnzF5R == _param1)
        return;
      F\u002DEF0Rm fEf0Rm = this.\u0037\u002BnzF5R;
      this.\u0037\u002BnzF5R = _param1;
    }

    private void _xwaZ8s()
    {
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        throw new ObjectDisposedException(sgxPeiI.LiHKl\u0027x(",\n\b", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (this.\u0021\u002B\u0040iT1\u0029 == null)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
    }

    private void \u0036p\u002B\u003BTrG()
    {
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        throw new ObjectDisposedException(sgxPeiI.LiHKl\u0027x(",\n\b", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (!this.nj\u0024PFyb)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?\"/h/\u001F7\u0014-\u001B\";\0\u007Fn+\bB\v\u0001\u001D?0?n1\u001F+N", "WAP7kr4oRqHlPkgM3fwOJ"));
    }

    public void p3o9hVa()
    {
      this.Dispose(true);
      GC.SuppressFinalize((object) this);
    }

    protected virtual void Dispose(bool disposing)
    {
      lock (this.BhSrZj\u002D)
      {
        if (this.\u0037\u002BnzF5R != F\u002DEF0Rm.Disposed)
          this.\u0037\u002BnzF5R = F\u002DEF0Rm.Disposed;
      }
      if (disposing)
        this.g16w\u00260t();
      else
        this.Dt\u0024Xe\u003Ag();
    }

    private void g16w\u00260t()
    {
      try
      {
        this.\u0021\u002B\u0040iT1\u0029?.Close();
      }
      catch (Exception ex)
      {
        this.l_\u007Edu4e((LogLevel) 40, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x(":\u001B\np1zk/\u00135\u0005d\v+:\u0011o'1\0B\u001B\u0006\u000Fqc.t\"Z\n3\fX0*\u0016h'0\tX_\u0012Hb", "WAP7kr4oRqHlPkgM3fwOJ"), (object) ex);
      }
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        return;
      this.GBA\u002738D(F\u002DEF0Rm.Disconnected);
      this.Dt\u0024Xe\u003Ag();
    }

    private Exception nWHbN0N(SshException _param1)
    {
      this.\u0038iRnG\u0026s((Exception) _param1);
      this.g16w\u00260t();
      return (Exception) new Q\u002A6RaYL(_param1);
    }

    private Exception D\u002Bnux\u002BM(SocketException _param1)
    {
      this.\u0038iRnG\u0026s((Exception) _param1);
      this.g16w\u00260t();
      return (Exception) new Q\u002A6RaYL(ProxySocketException.GetSocketExceptionMessage(_param1), (Exception) _param1, MgSu\u002317.SocketError);
    }

    private void \u0038iRnG\u0026s(Exception _param1)
    {
      if (this.\u0039\u005E\u002DhKMH != null)
        this.l_\u007Edu4e((LogLevel) 40, \u0034\u003Fx\u00250\u0021v.Info, _param1.ToString());
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed && !(_param1 is ObjectDisposedException))
        throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x(",\n\b?,8v\"\u0019-@3\u00190o\u0001r=/\b\u0011\u001A\rXh+3p\"Z8\u000Ed\u00173*\u0017z:6\b\f_\u001E\u0019lc3rg\n+\u000F#\n&<\u00165", "WAP7kr4oRqHlPkgM3fwOJ"), _param1, MgSu\u002317.OperationFailure);
    }

    private void Dt\u0024Xe\u003Ag()
    {
      lock (this.BhSrZj\u002D)
      {
        this.\u0021\u002B\u0040iT1\u0029 = (SshSession) null;
        this.DAA\u007EC\u002Bw = false;
        this.nj\u0024PFyb = false;
      }
    }

    ~s\u002B\u00274CeB() => this.Dispose(false);

    private IAsyncResult eKG\u002AEPg(
      AsyncCallback _param1,
      object _param2,
      MethodInfo kaUu3s8,
      params object[] YIIZCd6)
    {
      if (YIIZCd6 == null)
        YIIZCd6 = new object[1];
      TN\u002BL1GZ tnL1Gz = new TN\u002BL1GZ((object) this, kaUu3s8, _param1, _param2, YIIZCd6);
      tnL1Gz.\u002Bx8wLoO();
      return (IAsyncResult) tnL1Gz;
    }

    private object p\u0023MK\u0027\u0024\u005E(IAsyncResult _param1, MethodBase _param2)
    {
      TN\u002BL1GZ tnL1Gz = _param1 as TN\u002BL1GZ;
      MethodInfo methodInfo = _param2 as MethodInfo;
      object obj = tnL1Gz != null && !(methodInfo == (MethodInfo) null) ? tnL1Gz.Y\u003AK\u002D\u002B3\u003F((object) this, methodInfo) : throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.InvariantCulture, sgxPeiI.LiHKl\u0027x("+\u0001\u001D?\n\u001Bo>\u0014:2!\v6#\u0011;!=\r\a\u001C\u001DXl6*l+\u0013<\u0004d\f,o u*$W\u001F_\u001E\u0019lc4s3Z+\u00050\r1!\0\u007Fn9\u0015\r\u0012I\fw&z\u007F(\b+\u00057\b,!\u0001r 8G \u001A\u000E\u0011q8jag\u0017<\u0014,\u0017'o\nun+\u000F\v\fI\u001Bs\")oi", "WAP7kr4oRqHlPkgM3fwOJ"), new object[1]
      {
        (object) _param2.Name
      }), sgxPeiI.LiHKl\u0027x("\u001E\u001A\u0001q \by4\u000F5\u0014", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (!(obj is Exception innerException))
        return obj;
      if (innerException is Q\u002A6RaYL e)
        throw new Q\u002A6RaYL(e);
      throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x(">\u001A\u0001q 2n(\u00146\u00157X .\twn:\u001F\u0001\u001A\u0019\fv,42", "WAP7kr4oRqHlPkgM3fwOJ"), innerException, MgSu\u002317.AsyncError);
    }

    public void \u0027q00\u0027uC(string _param1) => this.DC\u003BK\u0025e\u0040(_param1, 22, (SshParameters) null);

    public void b\u00278\u002ASwi(string _param1, int _param2) => this.DC\u003BK\u0025e\u0040(_param1, _param2, (SshParameters) null);

    public void DC\u003BK\u0025e\u0040(string _param1, int _param2, SshParameters f7HhlBe)
    {
      _param1 = _param1 != null ? _param1.Trim() : throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\f\f\ni&(R&\u0017<", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("7\u0006\vk-;q\"Z:\u0001*\u0016,;Ey+\u007F\t\u0017\u0013\u0005V", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param1.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("7\u0006\vk-;q\"Z:\u0001*\u0016,;Ey+\u007F\u0002\u000F\u000F\u001D\u00011", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\f\f\ni&(R&\u0017<", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (!ProxySocket.IsValidHost(_param1))
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("7\u0006\vk-;q\"Z0\u0013d\u0011-9\u0004w';I", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\f\f\ni&(R&\u0017<", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2 < 1 || _param2 > (int) ushort.MaxValue)
        throw \u0023vYDm\u002B\u002B.F5pP\u002Acf(sgxPeiI.LiHKl\u0027x("\f\f\ni&(L(\b-", "WAP7kr4oRqHlPkgM3fwOJ"), (object) _param2, sgxPeiI.LiHKl\u0027x("/\u0006\nkc3og\u0015,\u0014d\u0017%o\u0017z 8\u0002B\u0010\u000FXi\"6u#Z/\u0001(\r&<K", "WAP7kr4oRqHlPkgM3fwOJ"));
      lock (this.BhSrZj\u002D)
        this.DAA\u007EC\u002Bw = !this.DAA\u007EC\u002Bw ? true : throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(">\u0005\nz\">eg\u00196\u000E*\u001D ;\fu)\u007F\u0013\r_\u001D\u0010zc)y5\f<\u0012j", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (this.\u0021\u002B\u0040iT1\u0029 != null)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(">\u0005\nz\">eg\u00196\u000E*\u001D ;\0\u007Fn+\bB\v\u0001\u001D?0?n1\u001F+N", "WAP7kr4oRqHlPkgM3fwOJ"));
      try
      {
        this.GBA\u002738D(F\u002DEF0Rm.Connecting);
        ISocketFactory isocketFactory = this.bp\u002BykS\u0027;
        Proxy proxy = isocketFactory as Proxy;
        if (isocketFactory == null || proxy != null && proxy.IsBypassed(_param1, _param2))
          isocketFactory = (ISocketFactory) new Proxy();
        this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("<\u0006\u0016q&9h.\u0014>@0\u0017c4Uft$V\u001F_\u001C\vv-=<<H$@?K>a", "WAP7kr4oRqHlPkgM3fwOJ"), (object) _param1, (object) _param2, (object) sgxPeiI.LiHKl\u0027x(",\u000F\fo", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.GetType().Assembly.GetName().Version);
        if (this.bp\u002BykS\u0027 != null)
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("*\u001A\u0011q$zl5\u0015!\u0019d\u0003s2K", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.bp\u002BykS\u0027);
        ISocket socket = isocketFactory.CreateSocket();
        socket.Timeout = this.\u0040N\u002B37Wx;
        socket.Connect(_param1, _param2);
        this.\u0021\u002B\u0040iT1\u0029 = new SshSession(socket);
        if (this.\u0039\u005E\u002DhKMH != null)
          this.\u0021\u002B\u0040iT1\u0029.LogWriter = (ILogWriter) new TcyGQBN(this.\u0039\u005E\u002DhKMH, this.GetType(), this.\u0036s\u0029r0\u002AI, (string) null);
        this.\u0021\u002B\u0040iT1\u0029.Timeout = this.\u0040N\u002B37Wx;
        this.\u0021\u002B\u0040iT1\u0029.Parameters = f7HhlBe;
        this.\u0021\u002B\u0040iT1\u0029.Negotiate();
        this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x(",\f\ni&(&g\u0001i\u001D", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.\u0021\u002B\u0040iT1\u0029.ServerIdentification);
        this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("9\0\u0016x&(l5\u00137\u0014~X8\u007F\u0018", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.\u0021\u002B\u0040iT1\u0029.Fingerprint);
        this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("<\0\bw&(<.\u0014?\u000F~X8\u007F\u0018", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.\u0021\u002B\u0040iT1\u0029.Cipher);
        this.GBA\u002738D(F\u002DEF0Rm.Connected);
      }
      catch (ProxySocketException ex)
      {
        this.g16w\u00260t();
        MgSu\u002317 status;
        switch ((int) ex.Status)
        {
          case 0:
            status = MgSu\u002317.ConnectFailure;
            break;
          case 1:
            status = MgSu\u002317.ConnectionClosed;
            break;
          case 3:
            status = MgSu\u002317.NameResolutionFailure;
            break;
          case 5:
            status = MgSu\u002317.ProxyNameResolutionFailure;
            break;
          default:
            status = MgSu\u002317.SocketError;
            break;
        }
        throw new Q\u002A6RaYL(((Exception) ex).Message, (Exception) ex, status);
      }
      catch (SocketException ex)
      {
        throw this.D\u002Bnux\u002BM(ex);
      }
      catch (SshException ex)
      {
        throw this.nWHbN0N(ex);
      }
      catch (Exception ex)
      {
        this.g16w\u00260t();
        this.\u0038iRnG\u0026s(ex);
        throw;
      }
      finally
      {
        lock (this.BhSrZj\u002D)
          this.DAA\u007EC\u002Bw = false;
      }
    }

    public void j\u003Ayc\u0024Pi()
    {
      lock (this.BhSrZj\u002D)
        this.g16w\u00260t();
    }

    public void A28KI4p(string _param1, string _param2)
    {
      if (_param2 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\u000F\b\vl45n#", "WAP7kr4oRqHlPkgM3fwOJ"));
      this.ySG\u007EnA5(_param1, _param2, (SshPrivateKey) null);
    }

    public void \u00343A0a\u0023i(string _param1, SshPrivateKey _param2)
    {
      if (_param2 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\u000F\u001B\u0011i\".y\f\u001F ", "WAP7kr4oRqHlPkgM3fwOJ"));
      this.ySG\u007EnA5(_param1, (string) null, _param2);
    }

    public void ySG\u007EnA5(string _param1, string _param2, SshPrivateKey _param3)
    {
      switch (_param1)
      {
        case "":
          throw new ArgumentException(sgxPeiI.LiHKl\u0027x(",\u001D\nv-=<$\u001B7\u000E+\fc'\u0004m+\u007F\u001D\a\r\u0006Xs&4{3\u0012w", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\n\u001A\u001Dm\r;q\"", "WAP7kr4oRqHlPkgM3fwOJ"));
        case null:
          throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\n\u001A\u001Dm\r;q\"", "WAP7kr4oRqHlPkgM3fwOJ"));
        default:
          if (_param2 == null && _param3 == null)
            throw new ArgumentException(sgxPeiI.LiHKl\u0027x(":\0\fw&(<7\b0\u0016%\f&o\u000E~7\u007F\b\u0010_\u0019\u0019l0-s5\u001Ey\r1\v7o\a~n,\u0017\a\u001C\0\u001Ev&>2", "WAP7kr4oRqHlPkgM3fwOJ"));
          lock (this.BhSrZj\u002D)
          {
            try
            {
              this._xwaZ8s();
              if (this.DAA\u007EC\u002Bw)
                throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
              if (this.nj\u0024PFyb)
                throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(">\u0005\nz\">eg\u001B,\u0014,\u001D-;\fx/+\u0002\u0006_\u001D\u0017?72yg\t<\u00122\u001D1a", "WAP7kr4oRqHlPkgM3fwOJ"));
              this.\u0021\u002B\u0040iT1\u0029.Authenticate(_param1, _param2, _param3);
              this.nj\u0024PFyb = true;
            }
            catch (SocketException ex)
            {
              throw this.D\u002Bnux\u002BM(ex);
            }
            catch (SshException ex)
            {
              throw this.nWHbN0N(ex);
            }
            catch (Exception ex)
            {
              this.g16w\u00260t();
              this.\u0038iRnG\u0026s(ex);
              throw;
            }
          }
          this.GBA\u002738D(F\u002DEF0Rm.Ready);
          break;
      }
    }

    private SshChannel tyHdYBY(iEG9h\u0040A _param1, string _param2, bool _param3)
    {
      if (_param2 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.IndexOfAny(s\u002B\u00274CeB.\u002BAzG\u007EHG) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        throw new ObjectDisposedException(sgxPeiI.LiHKl\u0027x(",\u000F\fo", "WAP7kr4oRqHlPkgM3fwOJ"));
      string str1 = sgxPeiI.LiHKl\u0027x("\f\n\b", "WAP7kr4oRqHlPkgM3fwOJ");
      string str2;
      if (_param1 != iEG9h\u0040A.Sink)
      {
        if (_param1 != iEG9h\u0040A.Source)
          throw new NotSupportedException();
        str2 = str1 + sgxPeiI.LiHKl\u0027x("_D\u001E", "WAP7kr4oRqHlPkgM3fwOJ");
      }
      else
        str2 = str1 + sgxPeiI.LiHKl\u0027x("_D\f", "WAP7kr4oRqHlPkgM3fwOJ");
      if (_param3)
        str2 += sgxPeiI.LiHKl\u0027x("_D\n", "WAP7kr4oRqHlPkgM3fwOJ");
      string str3 = str2 + sgxPeiI.LiHKl\u0027x("_K", "WAP7kr4oRqHlPkgM3fwOJ") + _param2 + sgxPeiI.LiHKl\u0027x("]", "WAP7kr4oRqHlPkgM3fwOJ");
      SshChannel sshChannel = this.\u0021\u002B\u0040iT1\u0029.OpenSession();
      this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x(":\u0011\u001D|6.u)\u001DyG?H>h", "WAP7kr4oRqHlPkgM3fwOJ"), (object) str3);
      sshChannel.RequestExec(str3);
      return sshChannel;
    }

    private void \u0038ZKe\u0025\u0024e(SshChannel _param1, RzpMJ\u0023q _param2)
    {
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        throw new ObjectDisposedException(sgxPeiI.LiHKl\u0027x(",\u000F\fo", "WAP7kr4oRqHlPkgM3fwOJ"));
      switch (_param2.\u00264BCpGM)
      {
        case wwz\u0024\u003BU4.SetSuccess:
        case wwz\u0024\u003BU4.SetWarning:
        case wwz\u0024\u003BU4.SetFatalError:
          _param1.Send(new byte[1]
          {
            (byte) _param2.\u00264BCpGM
          }, 0, 1);
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Command, RzpMJ\u0023q.\u0035Uw\u002DYtV(_param2.\u00264BCpGM));
          break;
        case wwz\u0024\u003BU4.CreateFile:
        case wwz\u0024\u003BU4.CreateDirectory:
        case wwz\u0024\u003BU4.FinishDirectory:
        case wwz\u0024\u003BU4.SetTime:
          byte[] numArray = _param2.gHv9\u0025nm(this.PQ\u0040\u0027J\u002Dg);
          _param1.Send(numArray, 0, numArray.Length);
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Command, _param2.ToString());
          break;
        default:
          throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("6\a\u000E~/3xg\u00196\r)\u0019-+K", "WAP7kr4oRqHlPkgM3fwOJ"));
      }
    }

    private int \u00406X\u002F6nU(SshChannel _param1, byte[] _param2, int _param3, int _param4)
    {
      if (this.\u0037\u002BnzF5R == F\u002DEF0Rm.Disposed)
        throw new ObjectDisposedException(sgxPeiI.LiHKl\u0027x(",\u000F\fo", "WAP7kr4oRqHlPkgM3fwOJ"));
      int num = _param1.Receive(_param2, _param3, _param4);
      if (num == 0)
      {
        this.l_\u007Edu4e((LogLevel) 20, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("<\u0006\u0016q&9h.\u00157@'\u0014,<\0\u007F`", "WAP7kr4oRqHlPkgM3fwOJ"));
        throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("+\u0001\u001D?0?n1\u001F+@,\u00190o\u0006w!,\u0002\u0006_\u001D\u0010zc9s)\u0014<\u00030\u0011,!K", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ConnectionClosed);
      }
      return num;
    }

    private RzpMJ\u0023q \u002DHC\u005E\u0024Sj(SshChannel _param1)
    {
      byte[] bytes = new byte[1];
      this.\u00406X\u002F6nU(_param1, bytes, 0, 1);
      wwz\u0024\u003BU4 command = (wwz\u0024\u003BU4) bytes[0];
      switch (command)
      {
        case wwz\u0024\u003BU4.SetSuccess:
        case wwz\u0024\u003BU4.FinishDirectory:
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("\u0004Y\u0005", "WAP7kr4oRqHlPkgM3fwOJ"), (object) RzpMJ\u0023q.\u0035Uw\u002DYtV(command));
          return new RzpMJ\u0023q(command);
        case wwz\u0024\u003BU4.SetWarning:
        case wwz\u0024\u003BU4.SetFatalError:
          StringBuilder stringBuilder1 = new StringBuilder();
          while (true)
          {
            this.\u00406X\u002F6nU(_param1, bytes, 0, 1);
            if (bytes[0] != (byte) 10)
              stringBuilder1.Append(this.PQ\u0040\u0027J\u002Dg.GetString(bytes, 0, bytes.Length));
            else
              break;
          }
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("\u0004Y\u0005dr'", "WAP7kr4oRqHlPkgM3fwOJ"), (object) RzpMJ\u0023q.\u0035Uw\u002DYtV(command), (object) stringBuilder1);
          throw new Q\u002A6RaYL(stringBuilder1.ToString(), MgSu\u002317.ProtocolError);
        case wwz\u0024\u003BU4.CreateFile:
        case wwz\u0024\u003BU4.CreateDirectory:
          byte[] mode = new byte[4];
          int num;
          for (int index = 0; index < 4; index += num)
            num = this.\u00406X\u002F6nU(_param1, mode, index, 4 - index);
          this.\u00406X\u002F6nU(_param1, bytes, 0, 1);
          if (bytes[0] != (byte) 32)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"));
          long filelength = 0;
          while (true)
          {
            this.\u00406X\u002F6nU(_param1, bytes, 0, 1);
            if (bytes[0] != (byte) 32)
              filelength = filelength * 10L + (long) ((int) bytes[0] - 48);
            else
              break;
          }
          StringBuilder stringBuilder2 = new StringBuilder();
          while (true)
          {
            this.\u00406X\u002F6nU(_param1, bytes, 0, 1);
            if (bytes[0] != (byte) 10)
              stringBuilder2.Append(this.PQ\u0040\u0027J\u002Dg.GetString(bytes, 0, 1));
            else
              break;
          }
          RzpMJ\u0023q rzpMjQ = new RzpMJ\u0023q(command, mode, filelength, stringBuilder2.ToString());
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("\u0004Y\u0005", "WAP7kr4oRqHlPkgM3fwOJ"), (object) rzpMjQ);
          return rzpMjQ;
        case wwz\u0024\u003BU4.SetTime:
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("\u0004Y\u0005", "WAP7kr4oRqHlPkgM3fwOJ"), (object) RzpMJ\u0023q.\u0035Uw\u002DYtV(command));
          throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(",\f\f?73q\"Z:\u000F)\u0015\"!\u0001; 0\u0013B\f\u001C\bo,(h\"\u001Ey\u0019!\fm", "WAP7kr4oRqHlPkgM3fwOJ"));
        default:
          this.l_\u007Edu4e((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("\u0004Y\u0005", "WAP7kr4oRqHlPkgM3fwOJ"), (object) RzpMJ\u0023q.\u0035Uw\u002DYtV(command));
          throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("6\a\u000E~/3xg\u00196\r)\u0019-+K", "WAP7kr4oRqHlPkgM3fwOJ"));
      }
    }

    internal long vJL\u005E\u002Bw\u0024(
      object _param1,
      string _param2,
      Stream _param3,
      long bOPu4WR)
    {
      if (_param2 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.IndexOfAny(s\u002B\u00274CeB.\u002BAzG\u007EHG) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param3 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\f\u0006\rm ?O3\b<\u0001)", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x(",\u001D\nz\"7<$\u001B7\u000E+\fc-\0; *\v\u000EQ", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (bOPu4WR < 0L)
        throw \u0023vYDm\u002B\u002B.F5pP\u002Acf(sgxPeiI.LiHKl\u0027x("\u0013\f\u0016x72", "WAP7kr4oRqHlPkgM3fwOJ"), (object) bOPu4WR, sgxPeiI.LiHKl\u0027x(">\u001B\u001Fj.?r3Z0\u0013d\u00176;Et(\u007F\u0015\u0003\u0011\u000E\u001D?,<<1\u001B5\t X5.\tn+,I", "WAP7kr4oRqHlPkgM3fwOJ"));
      int length = _param2.LastIndexOf('/');
      string filename;
      if (length >= 0)
      {
        filename = _param2.Substring(length + 1);
        _param2 = _param2.Substring(0, length);
      }
      else
      {
        filename = _param2;
        _param2 = sgxPeiI.LiHKl\u0027x("Q", "WAP7kr4oRqHlPkgM3fwOJ");
      }
      if (filename.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      bool flag = this.\u0021\u002B\u0040iT1\u0029.ServerIdentification.IndexOf(sgxPeiI.LiHKl\u0027x("(\0\u0016L\u0010\u0012X", "WAP7kr4oRqHlPkgM3fwOJ")) >= 0;
      try
      {
        if (flag)
          _param2 = _param2 + sgxPeiI.LiHKl\u0027x("P", "WAP7kr4oRqHlPkgM3fwOJ") + filename;
        SshChannel sshChannel;
        lock (this.BhSrZj\u002D)
          sshChannel = this.tyHdYBY(iEG9h\u0040A.Sink, _param2, false);
        try
        {
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Uploading, false, 0L, 0));
          long bytesTransferred = 0;
          byte[] buffer = new byte[32768];
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.CreateFile, s\u002B\u00274CeB._\u002Drn\u0021j7, bOPu4WR, filename));
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          while (true)
          {
            int num = buffer.Length;
            if (bOPu4WR >= 0L)
              num = (int) Math.Min(bOPu4WR - bytesTransferred, (long) num);
            if (num > 0)
              num = _param3.Read(buffer, 0, num);
            if (num != 0)
            {
              sshChannel.Send(buffer, 0, num);
              this.l_\u007Edu4e((LogLevel) 10, \u0034\u003Fx\u00250\u0021v.Command, sgxPeiI.LiHKl\u0027x("W\u0012Hbc8e3\u001F*I", "WAP7kr4oRqHlPkgM3fwOJ"), (object) num);
              bytesTransferred += (long) num;
              this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Uploading, false, bytesTransferred, num));
            }
            else
              break;
          }
          this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Uploading, true, bytesTransferred, 0));
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.SetSuccess));
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          if (!flag)
          {
            this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.FinishDirectory));
            if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
              throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          }
          return bytesTransferred;
        }
        finally
        {
          sshChannel?.Close();
        }
      }
      catch (SocketException ex)
      {
        throw this.D\u002Bnux\u002BM(ex);
      }
      catch (SshException ex)
      {
        throw this.nWHbN0N(ex);
      }
      catch (Exception ex)
      {
        this.\u0038iRnG\u0026s(ex);
        throw;
      }
    }

    internal long xQEwH\u0021\u002F(object _param1, string _param2, Stream _param3)
    {
      if (_param2 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.IndexOfAny(s\u002B\u00274CeB.\u002BAzG\u007EHG) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param2.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param3 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\u0010\u001C\fo6.O3\b<\u0001)", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x(",\u001D\nz\"7<$\u001B7\u000E+\fc-\0; *\v\u000EQ", "WAP7kr4oRqHlPkgM3fwOJ"));
      try
      {
        SshChannel sshChannel;
        lock (this.BhSrZj\u002D)
          sshChannel = this.tyHdYBY(iEG9h\u0040A.Source, _param2, false);
        this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Downloading, false, 0L, 0));
        try
        {
          long bytesTransferred = 0;
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.SetSuccess));
          RzpMJ\u0023q rzpMjQ;
          do
          {
            rzpMjQ = this.\u002DHC\u005E\u0024Sj(sshChannel);
            this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.SetSuccess));
          }
          while (rzpMjQ.\u00264BCpGM == wwz\u0024\u003BU4.SetTime);
          if (rzpMjQ.\u00264BCpGM != wwz\u0024\u003BU4.CreateFile)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          byte[] buffer = new byte[16384];
          while (bytesTransferred < rzpMjQ.\u0039EsEby\u0023)
          {
            int num = (int) Math.Min(rzpMjQ.\u0039EsEby\u0023 - bytesTransferred, (long) buffer.Length);
            if (num > 0)
              num = sshChannel.Receive(buffer, 0, num);
            if (num != 0)
            {
              this.l_\u007Edu4e((LogLevel) 10, \u0034\u003Fx\u00250\u0021v.Response, sgxPeiI.LiHKl\u0027x("W\u0012Hbc8e3\u001F*I", "WAP7kr4oRqHlPkgM3fwOJ"), (object) num);
              bytesTransferred += (long) num;
              _param3.Write(buffer, 0, num);
              this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Downloading, false, bytesTransferred, num));
            }
            else
              break;
          }
          this.OnTransferProgress(new y\u003AAZ\u002B\u002Bo(_param1, \u0038Kp\u002BFf\u007E.Downloading, true, bytesTransferred, 0));
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.SetSuccess));
          return bytesTransferred;
        }
        finally
        {
          sshChannel?.Close();
        }
      }
      catch (SocketException ex)
      {
        throw this.D\u002Bnux\u002BM(ex);
      }
      catch (SshException ex)
      {
        throw this.nWHbN0N(ex);
      }
      catch (Exception ex)
      {
        this.\u0038iRnG\u0026s(ex);
        throw;
      }
    }

    public void Shxim\u0029b(string _param1)
    {
      if (_param1 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param1.IndexOfAny(s\u002B\u00274CeB.\u002BAzG\u007EHG) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param1.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (!_param1.StartsWith(sgxPeiI.LiHKl\u0027x("P", "WAP7kr4oRqHlPkgM3fwOJ")))
        _param1 = sgxPeiI.LiHKl\u0027x("QF", "WAP7kr4oRqHlPkgM3fwOJ") + _param1;
      int length = _param1.LastIndexOf('/');
      string str = _param1.Substring(0, length);
      _param1 = _param1.Substring(length + 1);
      if (str.Length == 0)
        str = sgxPeiI.LiHKl\u0027x("P", "WAP7kr4oRqHlPkgM3fwOJ");
      if (_param1.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      try
      {
        SshChannel sshChannel;
        lock (this.BhSrZj\u002D)
          sshChannel = this.tyHdYBY(iEG9h\u0040A.Sink, str, true);
        try
        {
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.CreateDirectory, s\u002B\u00274CeB.\u005E\u0025WB2dX, 0L, _param1));
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
          this.\u0038ZKe\u0025\u0024e(sshChannel, new RzpMJ\u0023q(wwz\u0024\u003BU4.FinishDirectory));
          if (this.\u002DHC\u005E\u0024Sj(sshChannel).\u00264BCpGM != wwz\u0024\u003BU4.SetSuccess)
            throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u001Bs\")o.\u001C0\u0001&\u0014&o6X\u001E\u007F\u0002\u0010\r\u0006\n1", "WAP7kr4oRqHlPkgM3fwOJ"), MgSu\u002317.ProtocolError);
        }
        finally
        {
          sshChannel?.Close();
        }
      }
      catch (SocketException ex)
      {
        throw this.D\u002Bnux\u002BM(ex);
      }
      catch (SshException ex)
      {
        throw this.nWHbN0N(ex);
      }
      catch (Exception ex)
      {
        this.\u0038iRnG\u0026s(ex);
        throw;
      }
    }

    public virtual string j3\u003BDP\u003B\u005E() => string.Format(sgxPeiI.LiHKl\u0027x("\u0004Y\u000578kan", "WAP7kr4oRqHlPkgM3fwOJ"), (object) sgxPeiI.LiHKl\u0027x(",\u000F\fo", "WAP7kr4oRqHlPkgM3fwOJ"), (object) this.\u0036s\u0029r0\u002AI);

    internal long w\u005EO\u003BjaV(object AIdrM7v, string _param2, string _param3, long _param4)
    {
      if (_param3 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param3.IndexOfAny(s\u002B\u00274CeB.WtycDZ8) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param3.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param4 < 0L)
        throw \u0023vYDm\u002B\u002B.F5pP\u002Acf(sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\u0015z!\t<\u0014", "WAP7kr4oRqHlPkgM3fwOJ"), (object) _param4, sgxPeiI.LiHKl\u0027x(">\u001B\u001Fj.?r3Z0\u0013d\u00176;Et(\u007F\u0015\u0003\u0011\u000E\u001D?,<<1\u001B5\t X5.\tn+,I", "WAP7kr4oRqHlPkgM3fwOJ"));
      FileStream fileStream = (FileStream) null;
      try
      {
        fileStream = System.IO.File.OpenRead(_param3);
        if (_param4 > 0L)
          fileStream.Seek(_param4, SeekOrigin.Begin);
        return this.vJL\u005E\u002Bw\u0024(AIdrM7v, _param2, (Stream) fileStream, fileStream.Length - fileStream.Position);
      }
      finally
      {
        fileStream?.Close();
      }
    }

    internal long M\u002B\u005E\u002An\u003A4(
      FileMode _param1,
      object _param2,
      string g_ImAii,
      string _param4,
      long AzJGRPz)
    {
      if (g_ImAii == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (g_ImAii.IndexOfAny(s\u002B\u00274CeB.\u002BAzG\u007EHG) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (g_ImAii.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\r\f\u0015p7?L&\u000E1", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param4 == null)
        throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\vn\"3I", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param4.IndexOfAny(s\u002B\u00274CeB.WtycDZ8) >= 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("6\u0005\u0014z$;pg\u00191\u00016\u0019 ;\0i=\u007F\u000E\f_\u0019\u0019k+t", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (_param4.Length == 0)
        throw new ArgumentException(sgxPeiI.LiHKl\u0027x("/\b\fwc9})\u00146\u0014d\u001A&o\0v>+\u001EL", "WAP7kr4oRqHlPkgM3fwOJ"), sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\n}3\u0012", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (AzJGRPz < 0L)
        throw \u0023vYDm\u002B\u002B.F5pP\u002Acf(sgxPeiI.LiHKl\u0027x("\u0013\u0006\u001B~/\u0015z!\t<\u0014", "WAP7kr4oRqHlPkgM3fwOJ"), (object) AzJGRPz, sgxPeiI.LiHKl\u0027x(">\u001B\u001Fj.?r3Z0\u0013d\u00176;Et(\u007F\u0015\u0003\u0011\u000E\u001D?,<<1\u001B5\t X5.\tn+,I", "WAP7kr4oRqHlPkgM3fwOJ"));
      FileStream fileStream = (FileStream) null;
      try
      {
        if (AzJGRPz > 0L)
        {
          fileStream = System.IO.File.Open(_param4, _param1, FileAccess.Write, FileShare.Read);
          fileStream.Seek(AzJGRPz, SeekOrigin.Current);
        }
        else
          fileStream = System.IO.File.Create(_param4);
        return this.xQEwH\u0021\u002F(_param2, g_ImAii, (Stream) fileStream);
      }
      finally
      {
        fileStream?.Close();
      }
    }

    public long \u00215jLIo0(Stream _param1, string _param2)
    {
      long length;
      try
      {
        try
        {
          length = _param1.Length;
        }
        catch (Exception ex)
        {
          throw new Q\u002A6RaYL(sgxPeiI.LiHKl\u0027x("*\a\u0019}/?<3\u0015y\u0004!\f&=\br :G\v\u0011\u0019\rkc)h5\u001F8\rd\u0014&!\u0002o&q", "WAP7kr4oRqHlPkgM3fwOJ"), ex, MgSu\u002317.UnclassifiableError);
        }
      }
      catch (Exception ex)
      {
        this.\u0038iRnG\u0026s(ex);
        throw;
      }
      return this.vJL\u005E\u002Bw\u0024((object) null, _param2, _param1, length);
    }

    public long bjBn\u0024G0(string _param1, string CUJz3NK) => this.w\u005EO\u003BjaV((object) null, CUJz3NK, _param1, 0L);

    public long z\u0024r\u003AnP\u002B(string OWbYXT4, string _param2) => this.M\u002B\u005E\u002An\u003A4(FileMode.Create, (object) null, OWbYXT4, _param2, 0L);

    public long bUkuR5Y(string _param1, Stream _param2) => this.xQEwH\u0021\u002F((object) null, _param1, _param2);

    public ILogWriter \u0034B_yE4k
    {
      get => this.\u0039\u005E\u002DhKMH;
      set => this.\u0039\u005E\u002DhKMH = value;
    }

    [Obsolete("The Logger property is obsolete. Please use the LogWriter property instead.", true)]
    public ILogWriter vxjgR7U
    {
      get => this.\u0039\u005E\u002DhKMH;
      set => this.\u0039\u005E\u002DhKMH = value;
    }

    public Proxy OOHt\u002A\u002AB
    {
      get
      {
        lock (this.BhSrZj\u002D)
        {
          if (this.bp\u002BykS\u0027 == null)
            this.bp\u002BykS\u0027 = (ISocketFactory) new Proxy();
          return this.bp\u002BykS\u0027 as Proxy;
        }
      }
      set
      {
        if (value == null)
          throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\t\b\u0014j&", "WAP7kr4oRqHlPkgM3fwOJ"));
        lock (this.BhSrZj\u002D)
          this.bp\u002BykS\u0027 = (ISocketFactory) value;
      }
    }

    public void \u005EPIm9\u0027B(ISocketFactory _param1)
    {
      lock (this.BhSrZj\u002D)
        this.bp\u002BykS\u0027 = _param1;
    }

    public Encoding Z\u003A9\u003BRS\u002B
    {
      get => this.PQ\u0040\u0027J\u002Dg;
      set => this.PQ\u0040\u0027J\u002Dg = value != null ? value : throw new ArgumentNullException(sgxPeiI.LiHKl\u0027x("\t\b\u0014j&", "WAP7kr4oRqHlPkgM3fwOJ"));
    }

    public int \u002DEQT\u0029Cy
    {
      get => this.\u0040N\u002B37Wx == int.MaxValue ? -1 : this.\u0040N\u002B37Wx;
      set
      {
        if (value < -1)
          throw \u0023vYDm\u002B\u002B.F5pP\u002Acf(sgxPeiI.LiHKl\u0027x("\t\b\u0014j&", "WAP7kr4oRqHlPkgM3fwOJ"), (object) value, sgxPeiI.LiHKl\u0027x("+\0\u0015z,/hg\u0013*@+\r7o\n}n-\u0006\f\u0018\fXp%zj&\u00160\u0004d\u000E\"#\u0010~=q", "WAP7kr4oRqHlPkgM3fwOJ"));
        if (value < 1)
          value = int.MaxValue;
        else if (value < 1000)
          value = 1000;
        lock (this.BhSrZj\u002D)
        {
          this.\u0040N\u002B37Wx = value;
          if (this.\u0021\u002B\u0040iT1\u0029 == null)
            return;
          this.\u0021\u002B\u0040iT1\u0029.Timeout = value;
        }
      }
    }

    public F\u002DEF0Rm YR\u0024Gtn0 => this.\u0037\u002BnzF5R;

    public string \u00380j\u002FrB\u002A
    {
      get
      {
        lock (this.BhSrZj\u002D)
          return this.\u0021\u002B\u0040iT1\u0029 != null ? ((object) this.\u0021\u002B\u0040iT1\u0029.Fingerprint).ToString() : throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
      }
    }

    public SshSession aGJkQIL
    {
      get
      {
        lock (this.BhSrZj\u002D)
          return this.\u0021\u002B\u0040iT1\u0029 != null ? this.\u0021\u002B\u0040iT1\u0029 : throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
      }
    }

    public EndPoint HKO6XYb
    {
      get
      {
        lock (this.BhSrZj\u002D)
        {
          if (this.\u0021\u002B\u0040iT1\u0029 == null)
            throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
          return this.\u0021\u002B\u0040iT1\u0029.Socket.LocalEndPoint;
        }
      }
    }

    public EndPoint \u0035t\u002AAajt
    {
      get
      {
        lock (this.BhSrZj\u002D)
        {
          if (this.\u0021\u002B\u0040iT1\u0029 == null)
            throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f? 5r)\u001F:\u0014!\u001Cc;\n;:7\u0002B\f\f\ni&(2", "WAP7kr4oRqHlPkgM3fwOJ"));
          return this.\u0021\u002B\u0040iT1\u0029.Socket.RemoteEndPoint;
        }
      }
    }

    public static Version CmBEHHo => Assembly.GetExecutingAssembly().GetName().Version;

    public void O_cHpE4(IAsyncResult _param1) => this.p\u0023MK\u0027\u0024\u005E(_param1, (MethodBase) u\u002AH425k.kW\u003B\u002B7\u002AD);

    public IAsyncResult oJSFoqN(
      string _param1,
      int _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.kW\u003B\u002B7\u002AD, (object) _param1, (object) _param2);
    }

    public IAsyncResult \u00246M6Ukw(
      string _param1,
      int _param2,
      SshParameters _param3,
      AsyncCallback _param4,
      object _param5)
    {
      return this.eKG\u002AEPg(_param4, _param5, u\u002AH425k.\u007Eflnh\u002B5, (object) _param1, (object) _param2, (object) _param3);
    }

    public IAsyncResult sm\u002BK\u002F\u002F\u003A(
      AsyncCallback _param1,
      object _param2)
    {
      return this.eKG\u002AEPg(_param1, _param2, u\u002AH425k.\u0038x\u007Ema\u0025_);
    }

    public void TVXVGi\u002A(IAsyncResult _param1) => this.p\u0023MK\u0027\u0024\u005E(_param1, (MethodBase) u\u002AH425k.\u0038x\u007Ema\u0025_);

    public IAsyncResult fab4y\u002Ff(
      string _param1,
      string _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.l3b\u003F\u003F84, (object) _param1, (object) _param2);
    }

    public void Vs\u002DPN\u0024O(IAsyncResult _param1) => this.p\u0023MK\u0027\u0024\u005E(_param1, (MethodBase) u\u002AH425k.l3b\u003F\u003F84);

    public IAsyncResult \u0023Y\u0024z\u005EML(
      string _param1,
      SshPrivateKey _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.uqqCJ\u0029X, (object) _param1, (object) _param2);
    }

    public IAsyncResult t\u003FFicq\u0025(
      string _param1,
      string _param2,
      SshPrivateKey _param3,
      AsyncCallback _param4,
      object _param5)
    {
      return this.eKG\u002AEPg(_param4, _param5, u\u002AH425k.t39X\u002F\u0026l, (object) _param1, (object) _param2, (object) _param3);
    }

    public IAsyncResult a9\u0029Le\u0029V(
      string _param1,
      AsyncCallback _param2,
      object _param3)
    {
      return this.eKG\u002AEPg(_param2, _param3, u\u002AH425k._c9J\u005EVd, (object) _param1);
    }

    public void \u0031\u003BsS\u002BIL(IAsyncResult _param1) => this.p\u0023MK\u0027\u0024\u005E(_param1, (MethodBase) u\u002AH425k._c9J\u005EVd);

    public IAsyncResult \u0040V\u0029DHpZ(
      Stream _param1,
      string _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.s\u0027ZTeun, (object) _param1, (object) _param2);
    }

    public long \u0033EK\u0021_\u0025R(IAsyncResult h7N92Oo) => (long) this.p\u0023MK\u0027\u0024\u005E(h7N92Oo, (MethodBase) u\u002AH425k.s\u0027ZTeun);

    public IAsyncResult igH3wX\u002A(
      string _param1,
      string _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.NsGk_xm, (object) _param1, (object) _param2);
    }

    public IAsyncResult k\u003AeiL\u002F\u0025(
      string _param1,
      string _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.\u0033g\u0027qIPb, (object) _param1, (object) _param2);
    }

    public long Km\u002D7\u002Fve(IAsyncResult _param1) => (long) this.p\u0023MK\u0027\u0024\u005E(_param1, (MethodBase) u\u002AH425k.\u0033g\u0027qIPb);

    public IAsyncResult \u00353pSC\u0025x(
      string _param1,
      Stream _param2,
      AsyncCallback _param3,
      object _param4)
    {
      return this.eKG\u002AEPg(_param3, _param4, u\u002AH425k.qmm\u007EUF_, (object) _param1, (object) _param2);
    }

    [MethodImpl(MethodCodeType = MethodCodeType.Runtime)]
    public extern s\u002B\u00274CeB(object @object, IntPtr method);
  }
}
