// Decompiled with JetBrains decompiler
// Type: NoiseMe.Drags.App.Models.CredentialManagement.SecureStringHelper
// Assembly: Stubv2.0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E945C042-2241-44AF-B826-4AD3FC72B170
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Spy.MSIL.Quasar.gen-a3f98ee0a78f039e0a9ea52dba13c713dc46f749512bd7d108cc9c05f57fc93d.exe

using System;
using System.Runtime.InteropServices;
using System.Security;

namespace NoiseMe.Drags.App.Models.CredentialManagement
{
  [SuppressUnmanagedCodeSecurity]
  public static class SecureStringHelper
  {
    public static unsafe SecureString CreateSecureString(string plainString)
    {
      if (string.IsNullOrEmpty(plainString))
        return new SecureString();
      SecureString secureString;
      fixed (char* chPtr = plainString)
      {
        secureString = new SecureString(chPtr, plainString.Length);
        secureString.MakeReadOnly();
      }
      return secureString;
    }

    public static string CreateString(SecureString secureString)
    {
      IntPtr num = IntPtr.Zero;
      if (secureString != null)
      {
        if (secureString.Length != 0)
        {
          try
          {
            num = Marshal.SecureStringToBSTR(secureString);
            return Marshal.PtrToStringBSTR(num);
          }
          finally
          {
            if (num != IntPtr.Zero)
              Marshal.ZeroFreeBSTR(num);
          }
        }
      }
      return string.Empty;
    }
  }
}
