// Decompiled with JetBrains decompiler
// Type:  
// Assembly: svchost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 422D1FBC-502B-4DB7-AC18-B994031CE62D
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00070-msil\HEUR-Trojan-Ransom.Win32.Generic-7709a3ed96ddad83c1364a32bd84290b3d00212a09fc6619f0588d3725c06799.exe

using System;
using System.Management;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;

internal sealed class \u0003\u2001
{
  [DllImport("kernel32.dll", EntryPoint = "GetLocaleInfo")]
  private static extern int \u0002(uint _param0, uint _param1, [Out] StringBuilder _param2, int _param3);

  public static string \u0002()
  {
    try
    {
      ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(\u0008\u2003.\u0002(415307565));
      string str = string.Empty;
      foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
      {
        object propertyValue = managementBaseObject.GetPropertyValue(\u0008\u2003.\u0002(415307544));
        if (propertyValue != null)
        {
          str = Regex.Replace(propertyValue.ToString(), \u0008\u2003.\u0002(415307542), string.Empty);
          if (str.StartsWith(\u0008\u2003.\u0002(415308026)))
          {
            str = str.Substring(9);
            str = str.Replace(\u0008\u2003.\u0002(415307978), string.Empty);
            str = str.Split(' ')[1];
          }
        }
      }
      return str;
    }
    catch
    {
      return \u0008\u2003.\u0002(415307974);
    }
  }

  public static string \u0003()
  {
    ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(\u0008\u2003.\u0002(415307565));
    string str1 = string.Empty;
    int num = 0;
    try
    {
      foreach (ManagementObject managementObject in managementObjectSearcher.Get())
      {
        object propertyValue1 = managementObject.GetPropertyValue(\u0008\u2003.\u0002(415307544));
        if (propertyValue1 != null)
        {
          string str2 = Regex.Replace(propertyValue1.ToString(), \u0008\u2003.\u0002(415307542), string.Empty);
          if (str2.StartsWith(\u0008\u2003.\u0002(415308026)))
            str2 = str2.Substring(9);
          str1 = str2.Trim();
          if (!string.IsNullOrEmpty(str1))
          {
            try
            {
              object propertyValue2 = managementObject.GetPropertyValue(\u0008\u2003.\u0002(415307984));
              if (propertyValue2 != null && propertyValue2.ToString() != \u0008\u2003.\u0002(415307966))
                str1 = str1 + \u0008\u2003.\u0002(415307958) + propertyValue2.ToString();
            }
            catch (Exception ex)
            {
            }
          }
          try
          {
            object propertyValue3 = managementObject.GetPropertyValue(\u0008\u2003.\u0002(415307931));
            if (propertyValue3 != null)
              num = propertyValue3.ToString().Contains(\u0008\u2003.\u0002(415307872)) ? 64 : 86;
          }
          catch (Exception ex)
          {
          }
        }
      }
    }
    catch (Exception ex)
    {
    }
    if (str1 == string.Empty)
      str1 = \u0008\u2003.\u0002(415306946);
    if (num != 0)
      ;
    return str1 + \u0008\u2003.\u0002(415307897) + num.ToString();
  }

  public static string \u0005()
  {
    StringBuilder stringBuilder = new StringBuilder(256);
    int num = \u0003\u2001.\u0002(1024U, 7U, stringBuilder, stringBuilder.Capacity);
    return num > 0 ? stringBuilder.ToString().Substring(0, num - 1) : string.Empty;
  }

  public static string \u0008()
  {
    ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(\u0008\u2003.\u0002(415307890));
    string empty = string.Empty;
    foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
    {
      foreach (PropertyData property in managementBaseObject.Properties)
      {
        if (property.Name == \u0008\u2003.\u0002(415307809))
          empty = property.Value.ToString();
      }
    }
    return empty;
  }
}
