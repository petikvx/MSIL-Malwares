// Decompiled with JetBrains decompiler
// Type: Coache.Business.ReportManager
// Assembly: IsCopyConstruc, Version=5.6.2.1, Culture=neutral, PublicKeyToken=null
// MVID: 1DA50973-FF9A-4563-8B8F-74E2573677DF
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.02-msil\HEUR-Trojan-Ransom.MSIL.Blocker.gen-136935297fa08738f6957068951067c699c91b2902f3ea14da650289cabfd29d.exe

using Coache.Common;
using Data;
using System;
using System.ComponentModel;
using System.Configuration;
using System.Data;

namespace Coache.Business
{
  public class ReportManager
  {
    public DataTable GetReport(
      ReportType reportType,
      DateTime fechaInicio,
      DateTime fechaFin)
    {
      return SqlDataAccess.ExecuteDataTableQuery(ConfigurationManager.ConnectionStrings["GrouponConnectionString"].ToString(), reportType.StoredProcedure, SqlDataAccessArgs.CreateWith("@fecha_inicio", (object) fechaInicio).And("@fecha_fin", (object) fechaFin).Arguments);
    }

    public BindingList<ReportType> GetReportTypes()
    {
      BindingList<ReportType> reportTypes = new BindingList<ReportType>();
      reportTypes.Add(new ReportType("GRUPO_N.Get_TOPDevoluciones", "Top 5 porcentaje de devolución de los cupones, por proveedor por semestre"));
      reportTypes.Add(new ReportType("GRUPO_N.Get_TOPGiftCard", "Top 5 por usuario a los cuales se le acreditó GiftCards por semestre"));
      return reportTypes;
    }
  }
}
