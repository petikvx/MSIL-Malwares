// Decompiled with JetBrains decompiler
// Type: Dbasic.KeyWords.CkwControlType
// Assembly: B4Pruntime, Version=1.0.3056.20520, Culture=neutral, PublicKeyToken=null
// MVID: BED81B59-7EDE-4B04-983E-56C0010CF881
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Trojan-SMS.WinCE.Redoc.b-18cd0a1680457d7a4ff64f016ab2639c9c89d57bf8a7f51328c2d40bef9526f0.exe

using Dbasic.Other;

namespace Dbasic.KeyWords
{
  public class CkwControlType : CkeyWords
  {
    public CkwControlType(CRunner CRunner)
      : base(CRunner)
    {
    }

    public override MethodReturn Method(Place place, ref Locals locals)
    {
      ++place.WordI;
      RunReturn runReturn = this.CRunner.RunCode(place, true, true, ref locals);
      place = runReturn.place;
      ++place.WordI;
      WrapControl htControl = (WrapControl) this.CRunner.htControls[(object) runReturn.vString.ToLower(CRunner.cul)];
      string vString;
      if (htControl.control is SWrapObject)
      {
        SWrapObject control = (SWrapObject) htControl.control;
        if (control.Object == null)
        {
          vString = "Uninitialized object";
        }
        else
        {
          control = (SWrapObject) htControl.control;
          vString = control.Object.GetType().ToString();
        }
      }
      else
      {
        vString = htControl.control.GetType().ToString();
        int num = vString.IndexOf("Enhanced", 10);
        if (num > -1)
        {
          vString = vString.Substring(num + 8);
          if (vString == "Combo")
            vString = "ComboBox";
          else if (vString == "DateTime")
            vString = "Calendar";
          else if (vString == "Menu")
            vString = "MenuItem";
        }
      }
      return new MethodReturn(place, vString, 0.0);
    }
  }
}
