// Decompiled with JetBrains decompiler
// Type: s197624528607203.s347532807332309
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s007469294275641;
using s015749000614488;
using s021776306633796;
using s161171330760950;
using s232577085078553;
using s255385730527522;
using s269959955200983;
using s403966973041535;
using s490910903555891;
using s493820388662484;
using s640551380607055;
using s755365636060389;
using s795803713624789;
using s850469545382430;
using s866285118972105;
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;

namespace s197624528607203
{
  internal sealed class s347532807332309 : IDisposable
  {
    private Stream s908804642270691;
    private byte[] s765325892262159 = new byte[1024];
    private s347263595591673 s583580970963785;
    private s667517671108423 s275455918901923;
    private s661400486677923 s341759890302631 = new s661400486677923();
    private bool s739668132431129;
    private GCHandle s020396310929111;
    private int s740531440386581;
    private int s336568019410405;
    private bool s294156759649143;

    public int s338962937826720 => this.s336568019410405;

    public byte[] s334375225531852 => this.s765325892262159;

    public IntPtr s921770414353309 => this.s020396310929111.AddrOfPinnedObject();

    public s347532807332309(Stream stream, s347263595591673 metadata, s667517671108423 ctfStream)
    {
      this.s020396310929111 = GCHandle.Alloc((object) this.s765325892262159, GCHandleType.Pinned);
      this.s908804642270691 = stream;
      this.s583580970963785 = metadata;
      this.s275455918901923 = ctfStream;
      this.s373324983195775();
    }

    ~s347532807332309() => this.s689550501596232(false);

    private byte[] s709702453304729(int s645488497923497)
    {
      s645488497923497 = s093727131766808.s412379494450996(s645488497923497, 8);
      byte[] s765325892262159 = this.s765325892262159;
      this.s765325892262159 = new byte[s645488497923497];
      this.s020396310929111.Free();
      this.s020396310929111 = GCHandle.Alloc((object) this.s765325892262159, GCHandleType.Pinned);
      return s765325892262159;
    }

    public IEnumerable<s661400486677923> s670801746727701()
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s827953194295002.s431325870183063 s431325870183063 = new s827953194295002.s431325870183063(-2);
      // ISSUE: reference to a compiler-generated field
      ((s347532807332309.s703523903728729) s431325870183063).s043192992480230 = this;
      return (IEnumerable<s661400486677923>) s431325870183063;
    }

    public void s373324983195775()
    {
      this.s740531440386581 = 0;
      this.s336568019410405 = 0;
    }

    internal void s804679353038742(s508635816545702 s706857339429104)
    {
      if (!this.s294156759649143)
        throw new InvalidOperationException("Must read an event's header before reading an event's data.");
      if (s706857339429104.s084107962882689)
      {
        this.s216639679857355();
      }
      else
      {
        this.s373324983195775();
        this.s627511229376848(s706857339429104.s605420113189943);
      }
      this.s294156759649143 = false;
    }

    private void s216639679857355()
    {
      this.s069835904356923(8);
      int startIndex = this.s480181922045057(32) / 8;
      this.s480181922045057(32);
      int int32 = BitConverter.ToInt32(this.s765325892262159, startIndex);
      this.s373324983195775();
      this.s480181922045057(8 * int32);
    }

    public void s627511229376848(s059513796120190 s926478666413726)
    {
      foreach (s358991154297770 s358991154297770 in s926478666413726.s497935498275757)
        this.s861952731090902(s926478666413726, s358991154297770.s662311487760440);
    }

    public void s861952731090902(
      s059513796120190 s948699770048348,
      s787831628642719 s358727726076276)
    {
      this.s069835904356923(s358727726076276.s166916966121982);
      s358727726076276.s201768227457809 = this.s740531440386581;
      if (s358727726076276.s363634296595849 == s067208193339899.Enum)
      {
        s358727726076276 = ((s501910618784242) s358727726076276).s294104061960354;
        s358727726076276.s201768227457809 = this.s740531440386581;
      }
      else if (s358727726076276.s363634296595849 != s067208193339899.Struct && s358727726076276.s363634296595849 != s067208193339899.Variant)
      {
        int s200955500370553 = s358727726076276.s556533405975727();
        if (s200955500370553 != -1)
        {
          this.s480181922045057(s200955500370553);
          return;
        }
      }
      switch (s358727726076276.s363634296595849)
      {
        case s067208193339899.String:
          int num1 = this.s740531440386581 >> 3;
          int index1 = num1;
          this.s480181922045057(8);
          bool s821081700553522 = ((s969063498234494) s358727726076276).s821081700553522;
          if (s821081700553522)
          {
            while (this.s765325892262159[index1++] != (byte) 0)
              this.s480181922045057(8);
          }
          else
          {
            byte num2 = this.s765325892262159[index1];
            while (true)
            {
              switch (num2)
              {
                case 0:
                  goto label_26;
                case 12:
                case 13:
                  this.s480181922045057(8);
                  break;
                case 14:
                  this.s480181922045057(16);
                  break;
                case 15:
                  this.s480181922045057(24);
                  break;
              }
              num2 = this.s765325892262159[this.s480181922045057(8) >> 3];
            }
          }
label_26:
          int count = (this.s740531440386581 >> 3) - num1;
          byte[] src = Encoding.Convert(s821081700553522 ? Encoding.ASCII : Encoding.UTF8, Encoding.Unicode, this.s765325892262159, num1, count);
          ((s969063498234494) s358727726076276).s154680296733780 = count;
          if (this.s765325892262159.Length < this.s336568019410405 + src.Length)
            Buffer.BlockCopy((Array) this.s709702453304729(this.s336568019410405 + src.Length), 0, (Array) this.s765325892262159, 0, this.s336568019410405);
          Buffer.BlockCopy((Array) src, 0, (Array) this.s765325892262159, num1, src.Length);
          this.s336568019410405 = num1 + src.Length;
          this.s740531440386581 = this.s336568019410405 * 8;
          break;
        case s067208193339899.Integer:
          this.s480181922045057((int) ((s135353098559317) s358727726076276).s104196976160470);
          break;
        case s067208193339899.Struct:
          this.s627511229376848((s059513796120190) s358727726076276);
          break;
        case s067208193339899.Array:
          s816490424380127 s816490424380127 = (s816490424380127) s358727726076276;
          s787831628642719 s662311487760440_1 = s948699770048348.s274217572825981(s816490424380127.s698552104926498).s662311487760440;
          int num3 = s135353098559317.s684786709225741<int>(s662311487760440_1, this.s765325892262159, s662311487760440_1.s201768227457809);
          int s200955500370553_1 = s816490424380127.s077465461943308.s556533405975727();
          if (s200955500370553_1 == -1)
          {
            for (int index2 = 0; index2 < num3; ++index2)
              this.s861952731090902((s059513796120190) null, s816490424380127.s077465461943308);
            break;
          }
          for (int index3 = 0; index3 < num3; ++index3)
          {
            this.s069835904356923(s358727726076276.s166916966121982);
            this.s480181922045057(s200955500370553_1);
          }
          break;
        case s067208193339899.Variant:
          s827953194295002 s827953194295002 = (s827953194295002) s358727726076276;
          s501910618784242 s662311487760440_2 = (s501910618784242) s948699770048348.s274217572825981(s827953194295002.s784023330812836).s662311487760440;
          int s757902840297306 = s135353098559317.s684786709225741<int>((s787831628642719) s662311487760440_2, this.s765325892262159, s662311487760440_2.s201768227457809);
          string s957671602930815 = s662311487760440_2.s276535352724215(s757902840297306);
          this.s861952731090902((s059513796120190) null, s827953194295002.s644239354843480(s957671602930815).s662311487760440);
          break;
        case s067208193339899.Float:
          s972564901697917 s972564901697917 = (s972564901697917) s358727726076276;
          this.s480181922045057(s972564901697917.s297107332098424 + s972564901697917.s009083495021599);
          break;
        default:
          throw new InvalidOperationException();
      }
    }

    public void s216995258796034()
    {
      this.s689550501596232(true);
      GC.SuppressFinalize((object) this);
    }

    private void s689550501596232(bool s111361597163554)
    {
      if (s111361597163554)
        this.s908804642270691.Dispose();
      if (!this.s020396310929111.IsAllocated)
        return;
      this.s020396310929111.Free();
    }

    private void s069835904356923(int s113023734187860)
    {
      if (s113023734187860 == 1)
        return;
      int s200955500370553 = s093727131766808.s412379494450996(this.s740531440386581, s113023734187860) - this.s740531440386581;
      if (s200955500370553 == 0)
        return;
      this.s480181922045057(s200955500370553);
    }

    private int s480181922045057(int s200955500370553)
    {
      int s740531440386581 = this.s740531440386581;
      this.s740531440386581 += s200955500370553;
      int s336568019410405 = this.s336568019410405;
      if (this.s740531440386581 > s336568019410405 * 8)
      {
        int num = s093727131766808.s412379494450996(this.s740531440386581, 8) / 8;
        this.s030521425507723(s336568019410405, num - s336568019410405);
      }
      return s740531440386581;
    }

    private void s030521425507723(int s269051467953035, int s575366309580289)
    {
      if (this.s739668132431129 || s575366309580289 == 0)
        return;
      if (s269051467953035 + s575366309580289 > this.s765325892262159.Length)
        Buffer.BlockCopy((Array) this.s709702453304729((int) ((double) (s269051467953035 + s575366309580289) * 1.5)), 0, (Array) this.s765325892262159, 0, s269051467953035);
      if (s575366309580289 == 1)
      {
        int num = this.s908804642270691.ReadByte();
        if (num != -1)
          this.s765325892262159[this.s336568019410405++] = (byte) num;
        else
          this.s739668132431129 = true;
      }
      else if (this.s908804642270691.Read(this.s765325892262159, s269051467953035, s575366309580289) == s575366309580289)
        this.s336568019410405 = s269051467953035 + s575366309580289;
      else
        this.s739668132431129 = true;
    }
  }
}
