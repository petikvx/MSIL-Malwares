// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WindowsBC, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9909ee17073e3364
// MVID: 658BFC85-36E1-493D-98E6-AE9127D73D60
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00004-msil\Trojan-Downloader.MSIL.BitCoinMiner.c-64f742a0b28b2c3d2a62ef6607fcfd5fa55b793a1aff3a6c11e014e3b119149e.exe

using \u000E;
using \u0019\u0002;
using \u0093;
using System;
using System.Collections;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

namespace \u0019\u0002
{
  internal sealed class \u001A\u0002
  {
    private bool \u0001;
    private byte[] \u0002;
    private \u0087\u0002 \u0003;
    private \u009C \u0004;
    private \u009C \u0005;
    private \u001A\u0002.\u001B\u0002 \u0006;
    private \u001A\u0002.\u001C\u0002 \u0007;
    private bool \u0008;
    private bool \u000E;
    private bool \u000F;
    private \u0018\u0002 \u0010;
    private \u001D\u0002 \u0011 = (\u001D\u0002) new \u0083\u0002();
    private \u009B \u0012;
    private \u001F\u0002 \u0013 = \u001F\u0002.\u0003;
    private string \u0014;

    [SpecialName]
    public bool \u0092\u0004() => this.\u000F;

    [SpecialName]
    public bool \u0093\u0004() => this.\u000E;

    public void \u0094\u0004([In] string obj0, [In] string obj1, [In] string obj2) => this.\u0094\u0004(obj0, obj1, \u001A\u0002.\u001B\u0002.\u0003, (\u001A\u0002.\u001C\u0002) null, obj2, (string) null, this.\u0008);

    public void \u0094\u0004(
      [In] string obj0,
      [In] string obj1,
      [In] \u001A\u0002.\u001B\u0002 obj2,
      [In] \u001A\u0002.\u001C\u0002 obj3,
      [In] string obj4,
      [In] string obj5,
      [In] bool obj6)
    {
      this.\u0094\u0004((Stream) \u009C\u0004.\u001F\u0005(obj0, FileMode.Open, FileAccess.Read, FileShare.Read), obj1, obj2, obj3, obj4, obj5, obj6, true);
    }

    public void \u0094\u0004(
      [In] Stream obj0,
      [In] string obj1,
      [In] \u001A\u0002.\u001B\u0002 obj2,
      [In] \u001A\u0002.\u001C\u0002 obj3,
      [In] string obj4,
      [In] string obj5,
      [In] bool obj6,
      [In] bool obj7)
    {
      if (obj2 == \u001A\u0002.\u001B\u0002.\u0001 && obj3 == null)
        throw new ArgumentNullException(\u0008.\u000E\u0003(3753));
      this.\u0001 = true;
      this.\u0006 = obj2;
      this.\u0007 = obj3;
      this.\u0012 = (\u009B) new \u001E\u0002(obj1);
      this.\u0004 = new \u009C(obj4);
      this.\u0005 = new \u009C(obj5);
      this.\u0008 = obj6;
      \u0087\u0002 obj8 = this.\u0003 = new \u0087\u0002(obj0);
      try
      {
        if (this.\u0014 != null)
          this.\u0003.\u008D\u0005(this.\u0014);
        this.\u0003.\u0090\u0005(obj7);
        IEnumerator enumerator = this.\u0003.GetEnumerator();
        while (this.\u0001 && \u0007\u0003.\u007E\u009C((object) enumerator))
        {
          \u0081\u0002 obj9 = (\u0081\u0002) \u001B\u0005.\u007E\u009D((object) enumerator);
          if (obj9.\u0081\u0005())
          {
            if (this.\u0005.\u0091\u0003(\u0084\u0004.\u0083\u0005(obj9.\u0005\u0004())) && this.\u0004.\u0091\u0003(obj9.\u0005\u0004()))
              this.\u0096\u0004(obj9);
          }
          else if (obj9.\u0080\u0005() && this.\u0005.\u0091\u0003(obj9.\u0005\u0004()) && this.\u0092\u0004())
            this.\u0096\u0004(obj9);
        }
      }
      finally
      {
        if (obj8 != null)
          \u0093\u0003.\u007E\u009E((object) obj8);
      }
    }

    private void \u0095\u0004([In] \u0081\u0002 obj0, [In] string obj1)
    {
      bool flag = true;
      if (this.\u0006 != \u001A\u0002.\u001B\u0002.\u0003 && \u0005\u0005.\u001E\u0005(obj1))
        flag = this.\u0006 == \u001A\u0002.\u001B\u0002.\u0001 && this.\u0007 != null && this.\u0007(obj1);
      if (!flag)
        return;
      if (this.\u0010 != null)
        this.\u0001 = this.\u0010.\u008F\u0004(obj0.\u0005\u0004());
      if (!this.\u0001)
        return;
      try
      {
        FileStream fileStream = \u0016\u0004.\u001C\u0005(obj1);
        try
        {
          if (this.\u0002 == null)
            this.\u0002 = new byte[4096];
          if (this.\u0010 != null && this.\u0010.\u0002 != null)
            \u009D.\u0094\u0003(this.\u0003.\u0093\u0005(obj0), (Stream) fileStream, this.\u0002, this.\u0010.\u0002, this.\u0010.\u0091\u0004(), (object) this, obj0.\u0005\u0004(), obj0.\u0010\u0004());
          else
            \u009D.\u0094\u0003(this.\u0003.\u0093\u0005(obj0), (Stream) fileStream, this.\u0002);
          if (this.\u0010 != null)
            this.\u0001 = this.\u0010.\u0090\u0004(obj0.\u0005\u0004());
        }
        finally
        {
          if (fileStream != null)
            \u0093\u0003.\u007E\u009E((object) fileStream);
        }
        if (this.\u0008)
          \u0097\u0004.\u007F\u0005(obj1, obj0.\u0014\u0005());
        if (!this.\u0093\u0004() || !obj0.\u000E\u0005() || obj0.\u0007\u0005() == -1)
          return;
        FileAttributes fileAttributes = (FileAttributes) (obj0.\u0007\u0005() & 163);
        \u001D\u0005.\u0080\u0005(obj1, fileAttributes);
      }
      catch (Exception ex)
      {
        if (this.\u0010 != null)
        {
          this.\u0001 = this.\u0010.\u008E\u0004(obj1, ex);
        }
        else
        {
          this.\u0001 = false;
          throw;
        }
      }
    }

    private void \u0096\u0004([In] \u0081\u0002 obj0)
    {
      bool flag = obj0.\u0082\u0005();
      string str1 = obj0.\u0005\u0004();
      if (flag)
      {
        if (obj0.\u0081\u0005())
          str1 = this.\u0012.\u008C\u0003(str1);
        else if (obj0.\u0080\u0005())
          str1 = this.\u0012.\u008D\u0003(str1);
        flag = str1 != null && \u0011\u0003.\u007E\u0004\u0002((object) str1) != 0;
      }
      string str2 = (string) null;
      if (flag)
        str2 = !obj0.\u0080\u0005() ? \u0084\u0004.\u0083\u0005(\u0084\u0004.\u0086\u0005(str1)) : str1;
      if (flag && !\u0005\u0005.\u0014\u0005(str2))
      {
        if (obj0.\u0080\u0005())
        {
          if (!this.\u0092\u0004())
            goto label_16;
        }
        try
        {
          DirectoryInfo directoryInfo = \u0081\u0004.\u0013\u0005(str2);
        }
        catch (Exception ex)
        {
          flag = false;
          if (this.\u0010 != null)
          {
            this.\u0001 = !obj0.\u0080\u0005() ? this.\u0010.\u008E\u0004(str1, ex) : this.\u0010.\u008D\u0004(str1, ex);
          }
          else
          {
            this.\u0001 = false;
            throw;
          }
        }
      }
label_16:
      if (!flag || !obj0.\u0081\u0005())
        return;
      this.\u0095\u0004(obj0, str1);
    }

    internal enum \u001B\u0002
    {
      \u0001,
      \u0002,
      \u0003,
    }

    internal delegate bool \u001C\u0002(string fileName);
  }
}
