// Decompiled with JetBrains decompiler
// Type: 394945002633.582007484390
// Assembly: 069511259246, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 6D0FD131-484D-4146-B8A3-FCA5C0E4E111
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-e7ff83830fd4bf4e75004c85a34aa787b5c6b7dedba3c5ff9843edd5e688f2d5.exe

using \u003069511259246.Core;
using \u003069511259246.Models;
using \u003069511259246.Utils;
using \u003181733712633;
using \u003394945002633;
using \u003431349483769;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003394945002633
{
  public static class \u003582007484390
  {
    private static void \u003371403195490(
      string _param0,
      string _param1,
      Func<string, \u003623761106756> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003912642783969 obj1 = new \u003912642783969();
      obj1.\u003833165344384 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003912642783969 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003623761106756 obj3 = _param2(contents);
      string str1 = \u003582007484390.\u003270193837364(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003342943384013.\u003389138492373(obj3.\u003555016797984, path1);
        }
        catch (Exception ex)
        {
          ex.\u003814742381867();
          File.Delete(path1);
        }
      }
    }

    private static string \u003270193837364(\u003623761106756 _param0)
    {
      string str = Path.GetFileName(_param0.\u003555016797984).\u003939235870184();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003555016797984);
      return string.Empty;
    }

    public static void \u003897438076630()
    {
      string path1 = \u003792907266257.\u003275652382369();
      \u003098472891168 obj1 = \u003394559040018.\u003086967892253(path1);
      string str = obj1?.\u003968715477800;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003146080235121 obj2 = new \u003146080235121(str);
        ((\u003644492104953) obj2).\u003042498357403 = \u003394559040018.\u003113905360364();
        ((\u003644492104953) obj2).\u003323966153610 = obj1.\u003128686339732;
        ((\u003644492104953) obj2).\u003193231451252 = Color.DarkRed;
        ((\u003644492104953) obj2).\u003901145765562 = \u003260266606962.\u003380158846789;
        ((\u003644492104953) obj2).\u003963607666152 = \u003260266606962.\u003699511102228;
        ((\u003644492104953) obj2).\u003559818053170 = \u003260266606962.\u003366044251006;
        ((\u003644492104953) obj2).\u003244637697136 = \u003260266606962.\u003790458393077;
        ((\u003644492104953) obj2).\u003509718242244 = \u003260266606962.\u003052924332318;
        ((\u003644492104953) obj2).\u003928798058525 = \u003260266606962.\u003865933088442;
        ((\u003644492104953) obj2).\u003760566901270 = \u003260266606962.\u003745060939603;
        using (\u003644492104953 obj3 = (\u003644492104953) obj2)
        {
          using (Image image = obj3.\u003009310724737())
          {
            string filename;
            if (\u003408299920995.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003284570784129.\u003944630131629(filename);
            \u003284570784129.\u003624692924726(filename);
          }
        }
      }
    }
  }
}
