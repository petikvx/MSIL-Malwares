// Decompiled with JetBrains decompiler
// Type: l3udHffGRv2NRWqvu.YZbRoPemgBPUseaZp
// Assembly: bouNMGxVgGi4SRgWO, Version=3.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60
// MVID: 3F6A2AF1-3CCB-4F01-AA36-FA31C2E4CFE8
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.Agent.gen-bc408b9f362db28b2e931ff336ec5661cc0ce27b0cdc0ce215fec1b7381aca7f.exe

using eEOHgmIPN5bbJJEVW;
using Microsoft.TemplateEngine.Abstractions;
using Microsoft.TemplateEngine.Abstractions.Mount;
using Microsoft.TemplateEngine.Core;
using Microsoft.TemplateEngine.Core.Contracts;
using Microsoft.TemplateEngine.Core.Operations;
using Microsoft.TemplateEngine.Core.Util;
using Microsoft.TemplateEngine.Utils;
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

namespace l3udHffGRv2NRWqvu
{
  internal static class YZbRoPemgBPUseaZp
  {
    public static IReadOnlyDictionary<string, string> hj3zG0bS3wWTJZJsn(
      IEngineEnvironmentSettings coCBhL260DpaP0T3x,
      string XJv3hsUisUc9xTYc2,
      IFileSystemInfo H8jF6TStDK4ZOdO6B,
      string MgNs38PBRLp1woVPM,
      ref string O5pLWp2bVtqdfALcV,
      object _param5,
      IParameterSet YKQ9OZ90UVYWuBcwg,
      Dictionary<string, string> _param7)
    {
      Dictionary<string, string> dictionary = new Dictionary<string, string>((IEqualityComparer<string>) StringComparer.Ordinal);
      IProcessor L6DRjIbS366TtiW6F1 = YZbRoPemgBPUseaZp.ujA0xUSYNqMUSu0lW(coCBhL260DpaP0T3x, (IReadOnlyDictionary<string, string>) _param7);
      IReadOnlyDictionary<string, string> ei6pGuLGZ7toaGHKv = YZbRoPemgBPUseaZp.Tkv3mavQA30cwb6jA(coCBhL260DpaP0T3x, XJv3hsUisUc9xTYc2, ref O5pLWp2bVtqdfALcV, _param5, YKQ9OZ90UVYWuBcwg);
      IProcessor L6DRjIbS366TtiW6F2 = YZbRoPemgBPUseaZp.ujA0xUSYNqMUSu0lW(coCBhL260DpaP0T3x, ei6pGuLGZ7toaGHKv);
      IDirectory idirectory = FileSystemInfoExtensions.DirectoryInfo((IFileSystemInfo) ((IFileSystemInfo) H8jF6TStDK4ZOdO6B.Parent).Parent, MgNs38PBRLp1woVPM.TrimEnd('/'));
      foreach (IFileSystemInfo enumerateFileSystemInfo in idirectory.EnumerateFileSystemInfos("*", SearchOption.AllDirectories))
      {
        string str = FileSystemInfoExtensions.PathRelativeTo(enumerateFileSystemInfo, (IFileSystemInfo) idirectory);
        string YfA39ql1K6x0aKX5e = YZbRoPemgBPUseaZp.\u0038dVlEh4KQkgVMIf1j(L6DRjIbS366TtiW6F1, str);
        string b = YZbRoPemgBPUseaZp.\u0038dVlEh4KQkgVMIf1j(L6DRjIbS366TtiW6F2, YfA39ql1K6x0aKX5e);
        if (!string.Equals(str, b, StringComparison.Ordinal))
          dictionary[str] = b;
      }
      return (IReadOnlyDictionary<string, string>) dictionary;
    }

    private static string \u0038dVlEh4KQkgVMIf1j(
      IProcessor L6DRjIbS366TtiW6F,
      string YfA39ql1K6x0aKX5e)
    {
      using (Stream stream1 = (Stream) new MemoryStream(Encoding.UTF8.GetBytes(YfA39ql1K6x0aKX5e)))
      {
        using (Stream stream2 = (Stream) new MemoryStream())
        {
          L6DRjIbS366TtiW6F.Run(stream1, stream2);
          byte[] numArray = new byte[stream2.Length];
          stream2.Position = 0L;
          stream2.Read(numArray, 0, numArray.Length);
          return Encoding.UTF8.GetString(numArray);
        }
      }
    }

    private static IProcessor ujA0xUSYNqMUSu0lW(
      IEngineEnvironmentSettings _param0,
      IReadOnlyDictionary<string, string> ei6pGuLGZ7toaGHKv)
    {
      List<IOperationProvider> ioperationProviderList = new List<IOperationProvider>();
      foreach (KeyValuePair<string, string> keyValuePair in (IEnumerable<KeyValuePair<string, string>>) ei6pGuLGZ7toaGHKv)
      {
        IOperationProvider ioperationProvider = (IOperationProvider) new Replacement(TokenConfigExtensions.TokenConfig(keyValuePair.Key), keyValuePair.Value, (string) null, true);
        ioperationProviderList.Add(ioperationProvider);
      }
      IVariableCollection ivariableCollection = (IVariableCollection) new VariableCollection();
      return Processor.Create(new EngineConfig(_param0, ivariableCollection, "{0}"), (IReadOnlyList<IOperationProvider>) ioperationProviderList);
    }

    private static IReadOnlyDictionary<string, string> Tkv3mavQA30cwb6jA(
      IEngineEnvironmentSettings xYQRjSieg5rH3HvNz,
      string Q6AzcV7yxBNNlYnKk,
      ref string RhfEdDIu77OJ3dVnH,
      object UeLck1HlvsXE9tybw,
      IParameterSet ZvfDI7SSoDVYzBKFU)
    {
      Dictionary<string, string> q5o2IoKqyY4VNqP81 = new Dictionary<string, string>((IEqualityComparer<string>) StringComparer.Ordinal);
      YZbRoPemgBPUseaZp.JPDzwzAn1ztpLiGY3(Q6AzcV7yxBNNlYnKk, UeLck1HlvsXE9tybw, ref RhfEdDIu77OJ3dVnH, q5o2IoKqyY4VNqP81);
      foreach (IExtendedTemplateParameter templateParameter in ((IEnumerable) ZvfDI7SSoDVYzBKFU.ParameterDefinitions).OfType<IExtendedTemplateParameter>())
      {
        object obj;
        if (!string.IsNullOrEmpty(templateParameter.FileRename) && RuntimeValueUtil.TryGetRuntimeValue(ZvfDI7SSoDVYzBKFU, xYQRjSieg5rH3HvNz, ((ITemplateParameter) templateParameter).Name, ref obj, false) && obj is string str)
          q5o2IoKqyY4VNqP81.Add(templateParameter.FileRename, str);
      }
      return (IReadOnlyDictionary<string, string>) q5o2IoKqyY4VNqP81;
    }

    private static void JPDzwzAn1ztpLiGY3(
      string juJSUnfiuidjayi76,
      object IgvdwcIZibODoTPUv,
      ref string _param2,
      Dictionary<string, string> q5o2IoKqyY4VNqP81)
    {
      if (IgvdwcIZibODoTPUv == null || juJSUnfiuidjayi76 == null)
        return;
      string newValue = ((string) IgvdwcIZibODoTPUv).Trim();
      _param2 = _param2.Replace(juJSUnfiuidjayi76, newValue);
      q5o2IoKqyY4VNqP81.Add(juJSUnfiuidjayi76, newValue);
    }
  }
}
