// Decompiled with JetBrains decompiler
// Type: Microsoft.Kofe.Engine.BE52A5725
// Assembly: C5C480410, Version=14.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: BF642EC0-3F36-4177-B782-3E478BED34CB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.12-msil\HEUR-Trojan-Ransom.MSIL.Purgen.gen-36035b1a4995acb201c2b2160000d4477a31a2222c3f6bdc25a32d53d930bcfd.exe

using Microsoft.Kofe.IJDWP;
using Microsoft.VisualStudio.Debugger.Interop;
using System;

namespace Microsoft.Kofe.Engine
{
  internal class BE52A5725 : IDebugBoundBreakpoint2
  {
    private C1C0BFBF8 FFF5EEFEF;
    private AC89F237D BFAEB4B1E;
    private B92FAA9B7 AF8CB47D2;
    private IJdwpCodeLocation E7661992B;
    private BP_PASSCOUNT D84767B12;
    private BP_CONDITION F0C84D6F4;
    private string A29BB34A8;
    private ADB5C0658 D04BE1715;
    private uint EF0947E4D;
    private bool DEC432540;
    private bool CFC7B61C3;

    public BE52A5725(
      B92FAA9B7 engine,
      IJdwpCodeLocation location,
      C1C0BFBF8 pendingBreakpoint,
      AC89F237D breakpointResolution)
    {
      this.AF8CB47D2 = engine;
      this.E7661992B = location;
      this.FFF5EEFEF = pendingBreakpoint;
      this.BFAEB4B1E = breakpointResolution;
      this.F0C84D6F4.styleCondition = (enum_BP_COND_STYLE) 0;
      this.A29BB34A8 = (string) null;
      this.EF0947E4D = 0U;
      this.DEC432540 = true;
      ((IDebugBoundBreakpoint2) this).Enable(pendingBreakpoint.EEAC0C0DD ? 1 : 0);
      this.CFC7B61C3 = false;
    }

    int IDebugBoundBreakpoint2.B5704DD44()
    {
      if (!this.CFC7B61C3)
      {
        try
        {
          this.AF8CB47D2.B3E3893F5.RemoveBreakpoint(this.E7661992B, (object) this);
        }
        catch
        {
          return -2147467259;
        }
        this.CFC7B61C3 = true;
      }
      return 0;
    }

    int IDebugBoundBreakpoint2.B301ACA24(int D07391322)
    {
      bool flag = D07391322 != 0;
      if (this.DEC432540 != flag)
      {
        try
        {
          if (flag)
            this.AF8CB47D2.B3E3893F5.SetBreakpoint(this.E7661992B, (object) this);
          else
            this.AF8CB47D2.B3E3893F5.RemoveBreakpoint(this.E7661992B, (object) this);
        }
        catch
        {
          return -2147467259;
        }
      }
      this.DEC432540 = flag;
      return 0;
    }

    int IDebugBoundBreakpoint2.AB9E1F36A(
      out IDebugBreakpointResolution2 EB78A5C0F)
    {
      EB78A5C0F = (IDebugBreakpointResolution2) this.BFAEB4B1E;
      return 0;
    }

    int IDebugBoundBreakpoint2.D24E32540(
      out IDebugPendingBreakpoint2 EC296BF02)
    {
      EC296BF02 = (IDebugPendingBreakpoint2) this.FFF5EEFEF;
      return 0;
    }

    int IDebugBoundBreakpoint2.EE9F5E377(enum_BP_STATE[] CB683E404)
    {
      CB683E404[0] = (enum_BP_STATE) 0;
      if (this.CFC7B61C3)
        CB683E404[0] = (enum_BP_STATE) 1;
      else if (this.DEC432540)
        CB683E404[0] = (enum_BP_STATE) 3;
      else if (!this.DEC432540)
        CB683E404[0] = (enum_BP_STATE) 2;
      return 0;
    }

    int IDebugBoundBreakpoint2.F669FFF90(out uint A3EC9DEFC)
    {
      if (this.CFC7B61C3)
      {
        A3EC9DEFC = 0U;
        return -2147221408;
      }
      A3EC9DEFC = this.EF0947E4D;
      return 0;
    }

    int IDebugBoundBreakpoint2.FCECB446C(BP_CONDITION C9A8DFAA8)
    {
      this.F0C84D6F4 = C9A8DFAA8;
      this.A29BB34A8 = (string) null;
      if (this.F0C84D6F4.styleCondition != null)
      {
        this.D04BE1715 = new ADB5C0658(this.F0C84D6F4.bstrCondition, new DD3247535(this.AF8CB47D2.B3E3893F5, this.E7661992B));
        this.D04BE1715.AF927A510();
        if (this.D04BE1715.A0A6085FD)
          this.FFF5EEFEF.AB1E81DA4(this.D04BE1715.FC3E9C6DA.DisplayValue, this.E7661992B, this.BFAEB4B1E.E281836D5, (enum_BP_ERROR_TYPE) 2);
      }
      return 0;
    }

    int IDebugBoundBreakpoint2.BEB90470D(uint A765A7411)
    {
      if (this.CFC7B61C3)
        return -2147221408;
      this.EF0947E4D = A765A7411;
      return 0;
    }

    int IDebugBoundBreakpoint2.FBEEC0DFF(BP_PASSCOUNT FB6BB27F7)
    {
      if (this.CFC7B61C3)
        return -2147221408;
      this.D84767B12 = FB6BB27F7;
      return 0;
    }

    public bool CEC3DFA24(IJdwpThread D1710331A)
    {
      bool flag;
      switch (this.D84767B12.stylePassCount - 1)
      {
        case 0:
          flag = (int) this.EF0947E4D == (int) this.D84767B12.dwPassCount;
          break;
        case 1:
          flag = this.EF0947E4D >= this.D84767B12.dwPassCount;
          break;
        case 2:
          flag = this.EF0947E4D % this.D84767B12.dwPassCount == 0U;
          break;
        default:
          flag = true;
          break;
      }
      if (flag && this.F0C84D6F4.styleCondition != null && !this.D04BE1715.A0A6085FD)
      {
        this.D04BE1715.D6F9ACDFD = new DD3247535(this.AF8CB47D2.B3E3893F5, D1710331A, this.AF8CB47D2.B3E3893F5.GetTopStackFrame(D1710331A));
        this.D04BE1715.B6FE9B085();
        if (!this.D04BE1715.A0A6085FD)
        {
          if (this.F0C84D6F4.styleCondition == 1)
            flag = string.Compare(this.D04BE1715.FC3E9C6DA.DisplayValue, "true", StringComparison.OrdinalIgnoreCase) == 0;
          else if (this.A29BB34A8 == null)
          {
            this.A29BB34A8 = this.D04BE1715.FC3E9C6DA.DisplayValue;
            flag = false;
          }
          else
            flag = string.Compare(this.D04BE1715.FC3E9C6DA.DisplayValue, this.A29BB34A8, StringComparison.Ordinal) == 0;
        }
      }
      return flag;
    }

    public IJdwpCodeLocation FF69D4640() => this.E7661992B;
  }
}
