// Decompiled with JetBrains decompiler
// Type: ModuleNameSpace.MainModule
// Assembly: copierimp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B91267B9-A6E6-4499-A0E0-76087ADE7AE9
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.06-msil\Trojan-Ransom.Win32.Crypren.ahum-97449465d855c318fec48b7f368ff17937be19a01e47666533d37a84c30c629d.exe

using System;
using System.Globalization;
using System.Management.Automation;
using System.Management.Automation.Host;
using System.Threading;

namespace ModuleNameSpace
{
  internal class MainModule : PSHost
  {
    private MainAppInterface parent;
    private MainModuleUI ui;
    private CultureInfo originalCultureInfo = Thread.CurrentThread.CurrentCulture;
    private CultureInfo originalUICultureInfo = Thread.CurrentThread.CurrentUICulture;
    private Guid myId = Guid.NewGuid();
    private PSObject _consoleColorProxy;

    public MainModule(MainAppInterface app, MainModuleUI ui)
    {
      this.parent = app;
      this.ui = ui;
    }

    public override PSObject PrivateData => this.ui == null ? (PSObject) null : this._consoleColorProxy ?? (this._consoleColorProxy = PSObject.AsPSObject((object) new MainModule.ConsoleColorProxy(this.ui)));

    public override CultureInfo CurrentCulture => this.originalCultureInfo;

    public override CultureInfo CurrentUICulture => this.originalUICultureInfo;

    public override Guid InstanceId => this.myId;

    public override string Name => "PSRunspace-Host";

    public override PSHostUserInterface UI => (PSHostUserInterface) this.ui;

    public override Version Version => new Version(0, 5, 0, 26);

    public override void EnterNestedPrompt()
    {
    }

    public override void ExitNestedPrompt()
    {
    }

    public override void NotifyBeginApplication()
    {
    }

    public override void NotifyEndApplication()
    {
    }

    public override void SetShouldExit(int exitCode)
    {
      this.parent.ShouldExit = true;
      this.parent.ExitCode = exitCode;
    }

    public class ConsoleColorProxy
    {
      private MainModuleUI _ui;

      public ConsoleColorProxy(MainModuleUI ui) => this._ui = ui != null ? ui : throw new ArgumentNullException(nameof (ui));

      public ConsoleColor ErrorForegroundColor
      {
        get => this._ui.ErrorForegroundColor;
        set => this._ui.ErrorForegroundColor = value;
      }

      public ConsoleColor ErrorBackgroundColor
      {
        get => this._ui.ErrorBackgroundColor;
        set => this._ui.ErrorBackgroundColor = value;
      }

      public ConsoleColor WarningForegroundColor
      {
        get => this._ui.WarningForegroundColor;
        set => this._ui.WarningForegroundColor = value;
      }

      public ConsoleColor WarningBackgroundColor
      {
        get => this._ui.WarningBackgroundColor;
        set => this._ui.WarningBackgroundColor = value;
      }

      public ConsoleColor DebugForegroundColor
      {
        get => this._ui.DebugForegroundColor;
        set => this._ui.DebugForegroundColor = value;
      }

      public ConsoleColor DebugBackgroundColor
      {
        get => this._ui.DebugBackgroundColor;
        set => this._ui.DebugBackgroundColor = value;
      }

      public ConsoleColor VerboseForegroundColor
      {
        get => this._ui.VerboseForegroundColor;
        set => this._ui.VerboseForegroundColor = value;
      }

      public ConsoleColor VerboseBackgroundColor
      {
        get => this._ui.VerboseBackgroundColor;
        set => this._ui.VerboseBackgroundColor = value;
      }

      public ConsoleColor ProgressForegroundColor
      {
        get => this._ui.ProgressForegroundColor;
        set => this._ui.ProgressForegroundColor = value;
      }

      public ConsoleColor ProgressBackgroundColor
      {
        get => this._ui.ProgressBackgroundColor;
        set => this._ui.ProgressBackgroundColor = value;
      }
    }
  }
}
