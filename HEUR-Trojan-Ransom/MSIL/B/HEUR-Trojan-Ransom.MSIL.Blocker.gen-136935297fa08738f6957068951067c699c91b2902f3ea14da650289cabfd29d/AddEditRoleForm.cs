// Decompiled with JetBrains decompiler
// Type: Coache.AddEditRoleForm
// Assembly: IsCopyConstruc, Version=5.6.2.1, Culture=neutral, PublicKeyToken=null
// MVID: 1DA50973-FF9A-4563-8B8F-74E2573677DF
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.02-msil\HEUR-Trojan-Ransom.MSIL.Blocker.gen-136935297fa08738f6957068951067c699c91b2902f3ea14da650289cabfd29d.exe

using Coache.AbmRol;
using Coache.Business;
using Coache.Common;
using Coache.Core;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

namespace Coache
{
  [NonNavigable]
  public class AddEditRoleForm : Form
  {
    private IContainer components;
    private Label label1;
    private Label label2;
    private TextBox txtNombre;
    private CheckedListBox lstFuncionalidades;
    private Button btnGuardar;
    private Button btnClose;

    public AddEditRoleForm()
      : this(new Rol())
    {
    }

    public AddEditRoleForm(Rol rol)
    {
      this.InitializeComponent();
      this.Rol = rol;
    }

    public event EventHandler<RoleUpdatedEventArgs> OnRoleUpdated;

    private Rol Rol { get; set; }

    private void AddEditRoleForm_Load(object sender, EventArgs e) => this.ProcessForm();

    private void ProcessForm()
    {
      foreach (Functionalities allFunctionality in new FunctionalitiesManager().GetAllFunctionalities())
        this.lstFuncionalidades.Items.Add((object) allFunctionality, this.RoleHasFunctionality(allFunctionality));
      this.txtNombre.Text = this.Rol.Nombre;
    }

    private bool RoleHasFunctionality(Functionalities functionality) => this.Rol != null && this.Rol.Functionalities != null && this.Rol.Functionalities.Contains(functionality);

    private void btnGuardar_Click(object sender, EventArgs e)
    {
      if (string.IsNullOrEmpty(this.txtNombre.Text.Trim()))
      {
        int num = (int) MessageBox.Show("El nombre del Rol no puede ser nulo");
      }
      else
      {
        this.Rol.Functionalities = new List<Functionalities>();
        foreach (Functionalities checkedItem in this.lstFuncionalidades.CheckedItems)
          this.Rol.Functionalities.Add(checkedItem);
        this.Rol.Nombre = this.txtNombre.Text;
        if (this.OnRoleUpdated == null)
          return;
        this.OnRoleUpdated((object) this, new RoleUpdatedEventArgs()
        {
          Rol = this.Rol
        });
      }
    }

    private void btnClose_Click(object sender, EventArgs e) => this.Close();

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.label1 = new Label();
      this.label2 = new Label();
      this.txtNombre = new TextBox();
      this.lstFuncionalidades = new CheckedListBox();
      this.btnGuardar = new Button();
      this.btnClose = new Button();
      this.SuspendLayout();
      this.label1.AutoSize = true;
      this.label1.Location = new Point(12, 33);
      this.label1.Name = "label1";
      this.label1.Size = new Size(44, 13);
      this.label1.TabIndex = 0;
      this.label1.Text = "Nombre";
      this.label2.AutoSize = true;
      this.label2.Location = new Point(12, 61);
      this.label2.Name = "label2";
      this.label2.Size = new Size(84, 13);
      this.label2.TabIndex = 1;
      this.label2.Text = "Funcionalidades";
      this.txtNombre.Location = new Point(116, 30);
      this.txtNombre.MaxLength = 100;
      this.txtNombre.Name = "txtNombre";
      this.txtNombre.Size = new Size(156, 20);
      this.txtNombre.TabIndex = 2;
      this.lstFuncionalidades.FormattingEnabled = true;
      this.lstFuncionalidades.Location = new Point(116, 56);
      this.lstFuncionalidades.Name = "lstFuncionalidades";
      this.lstFuncionalidades.Size = new Size(156, 139);
      this.lstFuncionalidades.TabIndex = 3;
      this.btnGuardar.Location = new Point(197, 201);
      this.btnGuardar.Name = "btnGuardar";
      this.btnGuardar.Size = new Size(75, 23);
      this.btnGuardar.TabIndex = 4;
      this.btnGuardar.Text = "Guardar";
      this.btnGuardar.UseVisualStyleBackColor = true;
      this.btnGuardar.Click += new EventHandler(this.btnGuardar_Click);
      this.btnClose.DialogResult = DialogResult.Cancel;
      this.btnClose.Location = new Point(13, 200);
      this.btnClose.Name = "btnClose";
      this.btnClose.Size = new Size(75, 23);
      this.btnClose.TabIndex = 5;
      this.btnClose.Text = "Cancelar";
      this.btnClose.UseVisualStyleBackColor = true;
      this.btnClose.Click += new EventHandler(this.btnClose_Click);
      this.AcceptButton = (IButtonControl) this.btnGuardar;
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.CancelButton = (IButtonControl) this.btnClose;
      this.ClientSize = new Size(284, 231);
      this.Controls.Add((Control) this.btnClose);
      this.Controls.Add((Control) this.btnGuardar);
      this.Controls.Add((Control) this.lstFuncionalidades);
      this.Controls.Add((Control) this.txtNombre);
      this.Controls.Add((Control) this.label2);
      this.Controls.Add((Control) this.label1);
      this.FormBorderStyle = FormBorderStyle.FixedToolWindow;
      this.MaximizeBox = false;
      this.MinimizeBox = false;
      this.Name = nameof (AddEditRoleForm);
      this.ShowIcon = false;
      this.Load += new EventHandler(this.AddEditRoleForm_Load);
      this.ResumeLayout(false);
      this.PerformLayout();
    }
  }
}
