// Decompiled with JetBrains decompiler
// Type: QfmxIEf.2Li1VfJ
// Assembly: rIHK739, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: DCC06416-0005-44FB-A994-2D27682899C4
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-5d65c8f014ae86140156310feb48e80c8d76bb6b8eb7eaf6f0a843d5bb38d6b4.exe

using \u0035EwSaTp;
using AZsmRn2;
using BwmLLFL;
using Ek7S0Nv;
using mu7vwcH;
using N9CszjH;
using OSzLZPU;
using R94PbgT;
using RnEcdQv;
using RUhBN8x;
using System;
using System.Threading;
using System.Threading.Tasks;
using THRLMhj;
using udvJuoa;
using vQUtA7y;

namespace QfmxIEf
{
  public class \u0032Li1VfJ
  {
    public \u0032Li1VfJ(
      ITransientErrorDetectionStrategy errorDetectionStrategy,
      U3kQ1UH retryStrategy)
    {
      h0TO3hZ.doqrD2M((object) errorDetectionStrategy, nameof (errorDetectionStrategy));
      h0TO3hZ.doqrD2M((object) retryStrategy, "retryPolicy");
      this.UVwV1PY = errorDetectionStrategy;
      if (errorDetectionStrategy == null)
        throw new InvalidOperationException(zgpvHIp.MRHb5nN);
      this.\u0031V01S4U = retryStrategy;
    }

    public \u0032Li1VfJ(
      ITransientErrorDetectionStrategy errorDetectionStrategy,
      int retryCount)
      : this(errorDetectionStrategy, (U3kQ1UH) new aQcE2p2(retryCount))
    {
    }

    public \u0032Li1VfJ(
      ITransientErrorDetectionStrategy errorDetectionStrategy,
      int retryCount,
      TimeSpan retryInterval)
      : this(errorDetectionStrategy, (U3kQ1UH) new aQcE2p2(retryCount, retryInterval))
    {
    }

    public \u0032Li1VfJ(
      ITransientErrorDetectionStrategy errorDetectionStrategy,
      int retryCount,
      TimeSpan minBackoff,
      TimeSpan maxBackoff,
      TimeSpan deltaBackoff)
      : this(errorDetectionStrategy, (U3kQ1UH) new ZTUhTvi(retryCount, minBackoff, maxBackoff, deltaBackoff))
    {
    }

    public \u0032Li1VfJ(
      ITransientErrorDetectionStrategy errorDetectionStrategy,
      int retryCount,
      TimeSpan initialInterval,
      TimeSpan increment)
      : this(errorDetectionStrategy, (U3kQ1UH) new xY8W3RP(retryCount, initialInterval, increment))
    {
    }

    public event EventHandler<gbBe8Po> Nk8KrvO;

    public U3kQ1UH \u0031V01S4U { get; private set; }

    public ITransientErrorDetectionStrategy UVwV1PY { get; private set; }

    public virtual void y8yOcHj(Action FyGJdIO)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      \u0032Li1VfJ.bghv7KM bghv7Km = (\u0032Li1VfJ.bghv7KM) new i7LxtAa.ybL9o9t();
      // ISSUE: reference to a compiler-generated field
      ((i7LxtAa.ybL9o9t) bghv7Km).nSbkAZ0 = FyGJdIO;
      // ISSUE: reference to a compiler-generated field
      h0TO3hZ.doqrD2M((object) ((i7LxtAa.ybL9o9t) bghv7Km).nSbkAZ0, "action");
      // ISSUE: reference to a compiler-generated method
      this.RwmzA4J<object>(new Func<object>(bghv7Km.kAP0Xhf));
    }

    public virtual TResult RwmzA4J<TResult>(Func<TResult> vSOoTqi)
    {
      h0TO3hZ.doqrD2M((object) vSOoTqi, "func");
      int retryCount = 0;
      TimeSpan zero = TimeSpan.Zero;
      Mn6ny2c mn6ny2c = this.\u0031V01S4U.\u0030URezE4();
      while (true)
      {
        TimeSpan delay;
        do
        {
          try
          {
            return vSOoTqi();
          }
          catch (Exception ex)
          {
            if (!this.UVwV1PY.IsTransient(ex))
            {
              throw;
            }
            else
            {
              HB7SI8t hb7Si8t = mn6ny2c(retryCount++, ex);
              if (!hb7Si8t.MbAxpjg)
                throw;
              else
                delay = hb7Si8t.W0B7H8r;
            }
          }
          if (delay.TotalMilliseconds < 0.0)
            delay = TimeSpan.Zero;
          this.OnRetrying(retryCount, ex, delay);
        }
        while (retryCount <= 1 && this.\u0031V01S4U.VyorbzC);
        Task.Delay(delay).Wait();
      }
    }

    public Task \u0034284Vxw(Func<Task> n52HdnG) => this.ujMD87Y(n52HdnG, new CancellationToken());

    public Task ujMD87Y(Func<Task> xXQurTL, CancellationToken fhyJ3LS)
    {
      if (xXQurTL == null)
        throw new ArgumentNullException("taskAction");
      return (Task) new CSah53K(xXQurTL, this.\u0031V01S4U.\u0030URezE4(), new Func<Exception, bool>(this.UVwV1PY.IsTransient), new Action<int, Exception, TimeSpan>(this.OnRetrying), this.\u0031V01S4U.VyorbzC, fhyJ3LS).ExecuteAsync();
    }

    public Task<TResult> XCLtzuB<TResult>(Func<Task<TResult>> _param1) => this.qzP26wJ<TResult>(_param1, new CancellationToken());

    public Task<TResult> qzP26wJ<TResult>(
      Func<Task<TResult>> UWDA6Bk,
      CancellationToken _param2)
    {
      if (UWDA6Bk == null)
        throw new ArgumentNullException("taskFunc");
      return new PexE1Hk<TResult>(UWDA6Bk, this.\u0031V01S4U.\u0030URezE4(), new Func<Exception, bool>(this.UVwV1PY.IsTransient), new Action<int, Exception, TimeSpan>(this.OnRetrying), this.\u0031V01S4U.VyorbzC, _param2).ExecuteAsync();
    }

    protected virtual void OnRetrying(int retryCount, Exception lastError, TimeSpan delay)
    {
      // ISSUE: reference to a compiler-generated field
      if (this.\u0030SVaABb == null)
        return;
      // ISSUE: reference to a compiler-generated field
      this.\u0030SVaABb((object) this, new gbBe8Po(retryCount, delay, lastError));
    }
  }
}
