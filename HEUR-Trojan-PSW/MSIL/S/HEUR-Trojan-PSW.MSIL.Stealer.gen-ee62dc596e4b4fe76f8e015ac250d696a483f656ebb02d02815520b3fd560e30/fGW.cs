// Decompiled with JetBrains decompiler
// Type: wG.fGW
// Assembly: Type, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 716CE3A9-BAD1-470D-912F-B421D403F66E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-PSW.MSIL.Stealer.gen-ee62dc596e4b4fe76f8e015ac250d696a483f656ebb02d02815520b3fd560e30.exe

using System;
using System.Collections;
using System.Collections.Generic;
using System.Runtime.InteropServices;

namespace wG
{
  internal class fGW : pGN
  {
    private mI yRy;
    internal static fGW SNP;

    public void QCS(mI _param1)
    {
      this.yRy = _param1;
      IEnumerator<MW> enumerator1 = _param1.Kek().GetEnumerator();
      try
      {
        while (true)
        {
          if (fGW.uNZ((object) enumerator1))
            goto label_46;
          else
            goto label_81;
label_2:
          int num1;
          int num2 = num1;
label_3:
          MW current1;
          PK pk;
          Dictionary<string, Jo>.ValueCollection.Enumerator enumerator2;
          while (true)
          {
            switch (num2)
            {
              case 1:
                goto label_46;
              case 2:
                goto label_83;
              case 3:
                goto label_68;
              default:
                try
                {
                  while (enumerator2.MoveNext())
                  {
                    Jo current2 = enumerator2.Current;
                    if (current2.wyB() != null)
                    {
                      this.nRA(current2.wyB(), current1);
                      int num3 = 0;
                      if (fGW.nNi())
                        goto label_74;
label_72:
                      switch (num3)
                      {
                        default:
                          continue;
                      }
label_74:
                      num3 = 0;
                      goto label_72;
                    }
                  }
                }
                finally
                {
                  enumerator2.Dispose();
                }
                switch (current1)
                {
                  case PK _:
                    pk = (PK) current1;
                    if (fGW.nNi())
                    {
                      num2 = 3;
                      continue;
                    }
                    goto label_2;
                  case Ph _:
                    goto label_27;
                  case yO _:
                    goto label_67;
                  default:
                    goto label_79;
                }
            }
          }
label_27:
          using (IEnumerator<Hl> enumerator3 = (current1 as Ph).NfN().GetEnumerator())
          {
            while (fGW.uNZ((object) enumerator3))
            {
              Hl current3 = enumerator3.Current;
              if (current3.tyn() != null)
              {
                IEnumerator<zq> enumerator4 = current3.tyn().GetEnumerator();
                try
                {
                  while (enumerator4.MoveNext())
                  {
                    zq current4 = enumerator4.Current;
                    if (current4 is RG4)
                      this.nRA((current4 as RG4).J94(), current1);
                  }
                  int num4 = 0;
                  if (fGW.xNH() != null)
                    goto label_11;
label_7:
                  switch (num4)
                  {
                    default:
                      continue;
                  }
label_11:
                  int num5;
                  num4 = num5;
                  goto label_7;
                }
                finally
                {
                  if (enumerator4 != null)
                    fGW.TNr((object) enumerator4);
                }
              }
            }
            int num6 = 0;
            if (!fGW.nNi())
              goto label_19;
label_5:
            switch (num6)
            {
              default:
                goto label_79;
            }
label_19:
            int num7;
            num6 = num7;
            goto label_5;
          }
label_67:
          IEnumerator<B8> enumerator5 = (current1 as yO).BfJ().GetEnumerator();
          try
          {
            while (enumerator5.MoveNext())
            {
              B8 current5 = enumerator5.Current;
              if (current5.Uyo() != null)
              {
                int num8 = 0;
                if (!fGW.nNi())
                  goto label_51;
label_48:
                switch (num8)
                {
                  default:
                    using (IEnumerator<zq> enumerator6 = current5.Uyo().GetEnumerator())
                    {
                      while (enumerator6.MoveNext())
                      {
                        zq current6 = enumerator6.Current;
                        if (current6 is RG4)
                          this.nRA((current6 as RG4).J94(), current1);
                      }
                      int num9 = 0;
                      if (fGW.nNi())
                        goto label_60;
label_55:
                      switch (num9)
                      {
                        default:
                          continue;
                      }
label_60:
                      num9 = 0;
                      goto label_55;
                    }
                }
label_51:
                int num10;
                num8 = num10;
                goto label_48;
              }
            }
            goto label_79;
          }
          finally
          {
            if (enumerator5 != null)
              fGW.TNr((object) enumerator5);
          }
label_68:
          foreach (G6 g6 in pk.ACA().Values)
          {
            if (g6.xyj() != null)
              this.nRA(g6.xyj(), current1);
            bool flag = fGW.wNN((object) g6.qyA()) != null;
            int num11 = 0;
            if (fGW.xNH() == null)
              goto label_30;
label_29:
            int num12;
            num11 = num12;
label_30:
            while (true)
            {
              switch (num11)
              {
                case 1:
                  goto label_39;
                case 2:
                  if (fGW.wNN((object) g6.qyA()) is hX)
                  {
                    if (fGW.nNi())
                    {
                      num11 = 1;
                      continue;
                    }
                    goto label_29;
                  }
                  else
                    goto label_43;
                default:
                  if (flag)
                  {
                    if (!(g6.qyA().XCX() is Uv))
                      goto case 2;
                    else
                      goto label_40;
                  }
                  else
                    goto label_37;
              }
            }
label_37:
            continue;
label_39:
            int num13 = pk.mC2() != null ? 1 : 0;
            goto label_44;
label_40:
            this.nRA((g6.qyA().XCX() as Uv).wFR(), current1);
            goto label_37;
label_43:
            num13 = 0;
label_44:
            if (num13 != 0)
            {
              RG2.u91(g6.qyA().XCX().f19(), (string) fGW.HN4((object) "Cannot have unknown sized arrays within compressed blocks: '", (object) g6.T1V(), (object) "'"));
              goto label_37;
            }
            else
              goto label_37;
          }
label_79:
          continue;
label_46:
          current1 = enumerator1.Current;
          enumerator2 = current1.R1z().Values.GetEnumerator();
          num2 = 0;
          if (fGW.nNi())
            goto label_3;
          else
            goto label_2;
label_81:
          num2 = 2;
          goto label_3;
        }
label_83:;
      }
      finally
      {
        if (enumerator1 != null)
          fGW.TNr((object) enumerator1);
      }
    }

    private void nRA(gz _param1, MW _param2)
    {
      this.mRe(_param1, _param1.Kmk(), _param2);
      this.IRf(_param1.Kmk(), _param2);
    }

    private void mRe(gz _param1, bGB _param2, MW _param3)
    {
label_26:
      for (int index1 = 0; index1 < _param2.PmR().Count; ++index1)
      {
        tc tc = _param2.PmR()[index1];
        bool flag1 = tc is CGF;
        int num1 = 2;
        QGf qgf;
        VGk vgk;
        UGT ugt;
        string str;
        int index2;
        while (true)
        {
          int num2;
          PJ pj;
          BGe bge;
          bool flag2;
          MW mw;
          OZ oz;
          string key;
          bool flag3;
          int num3;
          switch (num1)
          {
            case 1:
              ugt.WmI().Add(oz);
              mw = (MW) null;
              goto label_24;
            case 2:
              if (!flag1)
                goto case 9;
              else
                goto label_26;
            case 3:
            case 18:
              goto label_26;
            case 4:
              if (flag3)
              {
                vgk = tc as VGk;
                num1 = 11;
                continue;
              }
              goto label_33;
            case 5:
              this.jRF(qgf.f19(), this.yRy.PeH()[qgf.Uj9()] as PK);
              if (fGW.xNH() == null)
              {
                num1 = 19;
                continue;
              }
              break;
            case 6:
            case 15:
              goto label_33;
            case 7:
              if (mw != null)
              {
                if (!mw.R1z().ContainsKey(key))
                {
                  if (mw is PK)
                  {
                    num2 = 22;
                    break;
                  }
                  num3 = 0;
                  goto label_64;
                }
                else
                {
                  ugt.WmI().Add((OZ) mw.R1z()[key]);
                  str = " local variable";
                  mw = (MW) null;
                  goto label_24;
                }
              }
              else
                goto label_56;
            case 8:
              _param2.PmR().Remove(tc);
              num1 = 13;
              continue;
            case 9:
              switch (tc)
              {
                case bGB _:
                  if (fGW.nNi())
                  {
                    num1 = 10;
                    continue;
                  }
                  break;
                case QGf _:
                  qgf = tc as QGf;
                  if (!(qgf.xjy() != "sizeof"))
                  {
                    if (!this.yRy.PeH().ContainsKey(qgf.Uj9()))
                    {
                      RG2.u91(qgf.cjd(), "Could not find the data-block: '" + qgf.Uj9() + "'");
                      num1 = fGW.nNi() ? 15 : 0;
                      continue;
                    }
                    if (this.yRy.PeH()[qgf.Uj9()] is PK)
                    {
                      if (fGW.nNi())
                      {
                        num1 = 5;
                        continue;
                      }
                      break;
                    }
                    goto label_41;
                  }
                  else
                    goto label_3;
                default:
                  goto label_58;
              }
              break;
            case 10:
              this.mRe(_param1, tc as bGB, _param3);
              if (fGW.xNH() == null)
              {
                num1 = 6;
                continue;
              }
              break;
            case 11:
              if (!(vgk.ToString() == "true") && !(vgk.ToString() == "false"))
              {
                if (vgk.ToString() == "value")
                {
                  if (fGW.nNi())
                  {
                    num1 = 0;
                    continue;
                  }
                  break;
                }
                goto case 20;
              }
              else
              {
                PGA pga = new PGA();
                pga.J1F(vgk.f19());
                pga.Vmt(vgk.ToString() == "true");
                _param2.PmR().Insert(index1, (tc) pga);
                _param2.PmR().Remove((tc) vgk);
                num1 = 3;
                continue;
              }
            case 12:
              _param2.PmR().Insert(index1, (tc) bge);
              if (fGW.nNi())
              {
                num1 = 21;
                continue;
              }
              break;
            case 13:
              str = _param3.ToString();
              mw = _param3;
              index2 = 0;
              goto case 23;
            case 14:
              goto label_46;
            case 16:
label_58:
              flag3 = tc is VGk;
              num1 = 4;
              continue;
            case 17:
              if (!flag2)
              {
                switch (pj)
                {
                  case sC _:
                    str = "primitive type";
                    ugt.WmI().Add(oz);
                    mw = (MW) null;
                    goto label_24;
                  case pS _:
                    str = "function type";
                    num1 = fGW.xNH() != null ? 1 : 1;
                    continue;
                  default:
                    fGW.nNG(mw.f19(), (object) "Unexpected error. Unknown type.");
                    goto label_24;
                }
              }
              else
              {
                mw = (pj as HL).pfX();
                if (mw is BP)
                {
                  BP bp = mw as BP;
                  oz.qCs((sC) fGW.WN3((object) bp));
                }
                ugt.WmI().Add(oz);
                goto label_24;
              }
            case 19:
              goto label_41;
            case 20:
              ugt = new UGT();
              ugt.J1F(tc.f19());
              _param2.PmR().Insert(index1, (tc) ugt);
              num1 = fGW.xNH() == null ? 8 : 7;
              continue;
            case 21:
              goto label_17;
            case 22:
              num3 = (mw as PK).ACA().ContainsKey(key) ? 1 : 0;
              goto label_64;
            case 23:
              if (index2 >= fGW.oN8((object) vgk.jmZ()))
              {
                num1 = 14;
                continue;
              }
              key = vgk.jmZ()[index2];
              num1 = 7;
              continue;
            default:
              if (_param3 is BP)
              {
                bge = new BGe();
                bge.J1F(vgk.f19());
                num1 = fGW.xNH() == null ? 12 : 1;
                continue;
              }
              fGW.nNG(vgk.f19(), (object) "The 'value' expression variable may only be used in consumed types.");
              num1 = 18;
              continue;
          }
          num1 = num2;
          continue;
label_24:
          ++index2;
          num1 = 23;
          continue;
label_64:
          if (num3 == 0)
          {
            str = "unknown variable or enum-alias.";
            tGd tGd = new tGd();
            fGW.gNJ((object) tGd, (object) key);
            tGd.J1F(fGW.QN1((object) vgk));
            ugt.WmI().Add((OZ) tGd);
            mw = (MW) null;
            goto label_24;
          }
          else
          {
            pj = (mw as PK).ACA()[key].qyA();
            oz = (OZ) (mw as PK).ACA()[key];
            flag2 = pj is HL;
            num1 = 17;
          }
        }
label_3:
        RG2.u91(qgf.YjT(), "Unknown function: '" + qgf.xjy() + "'");
        break;
label_17:
        _param2.PmR().Remove((tc) vgk);
        continue;
label_33:
        continue;
label_41:
        qgf.Jjf(this.yRy.PeH()[qgf.Uj9()].dCP());
        continue;
label_46:
        _param1.wmH().Add(ugt);
        goto label_33;
label_56:
        RG2.u91(tc.f19(), "Variable '" + vgk.jmZ()[index2 - 1] + "' cannot contain any variables because it of type: " + str);
        goto label_46;
      }
    }

    private void IRf(bGB _param1, MW _param2)
    {
      int num1 = 5;
label_1:
      while (true)
      {
        int num2 = num1;
        while (true)
        {
          bGa bGa;
          Jt jt;
          int index;
          UGT ugt1;
          tGd tGd;
          UGT ugt2;
          tc tc;
          CGF cgf;
          bool flag1;
          bool flag2;
          bool flag3;
          bool flag4;
          int num3;
          switch (num2)
          {
            case 1:
            case 14:
label_9:
              ++index;
              goto case 4;
            case 2:
              if (flag3)
              {
                cgf = _param1.PmR()[index + 1] as CGF;
                ugt1 = _param1.PmR()[index + 2] as UGT;
                num2 = 13;
                continue;
              }
              goto case 13;
            case 3:
              flag4 = false;
              cgf = (CGF) null;
              num2 = !fGW.nNi() ? 9 : 9;
              continue;
            case 4:
              if (index < _param1.PmR().Count)
                goto case 11;
              else
                goto label_35;
            case 5:
              index = 0;
              num2 = 4;
              continue;
            case 7:
              if (!flag2)
              {
                ugt2 = tc as UGT;
                if (ugt2.lmu() is tGd)
                {
                  tGd = ugt2.lmu() as tGd;
                  ugt1 = (UGT) null;
                  num2 = 3;
                  continue;
                }
                goto label_36;
              }
              else
              {
                if (fGW.nNi())
                {
                  num2 = 1;
                  continue;
                }
                goto label_1;
              }
            case 8:
              if (!(cgf.XjY() == "==") && !(cgf.XjY() == "!="))
                RG2.u91(cgf.f19(), "The operator '" + cgf.XjY() + "' cannot be used with the enum alias '" + (string) fGW.jN9((object) jt) + "'. Only == and != are allowed.");
              else
                goto label_40;
label_22:
              ugt2.kmW((OZ) bGa);
              break;
label_40:
              _param1.PmR().Insert(index, (tc) bGa);
              _param1.PmR().Remove(tc);
              goto label_22;
            case 9:
              flag1 = index >= 2 && _param1.PmR()[index - 2] is UGT;
              num2 = 10;
              continue;
            case 10:
              if (flag1)
              {
                cgf = _param1.PmR()[index - 1] as CGF;
                ugt1 = _param1.PmR()[index - 2] as UGT;
                goto case 13;
              }
              else
              {
                flag3 = index + 2 < fGW.GNl((object) _param1.PmR()) && _param1.PmR()[index + 2] is UGT;
                num2 = 2;
                continue;
              }
            case 11:
              tc = _param1.PmR()[index];
              if (tc is bGB)
              {
                if (fGW.xNH() == null)
                {
                  num2 = 12;
                  continue;
                }
                goto label_1;
              }
              else
              {
                flag2 = !(tc is UGT);
                num2 = 7;
                continue;
              }
            case 12:
              this.IRf(tc as bGB, _param2);
              goto case 1;
            case 13:
              if (ugt1 != null)
              {
                if (ugt1.lmu() is G6)
                {
                  num3 = (fGW.tNn((object) ugt1) as G6).qyA() is HL ? 1 : 0;
                  goto label_42;
                }
                else
                {
                  num2 = 6;
                  continue;
                }
              }
              else
              {
                if (fGW.xNH() == null)
                {
                  num2 = 0;
                  continue;
                }
                goto label_1;
              }
            default:
              num3 = 0;
              goto label_42;
          }
label_28:
label_29:
          if (!flag4)
            RG2.u91(tGd.f19(), "Unresolved variable name: '" + (string) fGW.ONC((object) tGd) + "'");
          goto label_9;
label_42:
          if (num3 != 0)
          {
            HL hl = (ugt1.lmu() as G6).qyA() as HL;
            if (hl.pfX() is Ph && (hl.pfX() as Ph).zfR().ContainsKey(tGd.T1V()))
            {
              flag4 = true;
              jt = (fGW.ENs((object) hl) as Ph).zfR()[tGd.T1V()];
              bGa = new bGa();
              bGa.wmi(fGW.ENs((object) hl) as Ph);
              fGW.gNV((object) bGa, (object) jt);
              bGa.J1F(tGd.f19());
              num2 = 8;
            }
            else
              goto label_28;
          }
          else
            goto label_29;
        }
label_36:
        num1 = 14;
      }
label_35:;
    }

    private void jRF(Xp _param1, PK _param2)
    {
      int num1 = 0;
      IEnumerator<G6> enumerator = _param2.eC3().GetEnumerator();
      try
      {
        while (true)
        {
          if (fGW.uNZ((object) enumerator))
            goto label_14;
          else
            goto label_8;
label_3:
          G6 current;
          bGB bGb;
          int num2;
          while (true)
          {
            switch (num2)
            {
              case 1:
                goto label_6;
              case 2:
                bGb = (current.BC0().XCX() as Uv).wFR().Kmk();
                if (bGb.PmR().Count != 1 || !(bGb.PmR()[0] is hGH))
                {
                  fGW.nNG(_param1, (object) ("Could not get size of block '" + _param2.T1V() + "' as it has a field with non-simple array-extension."));
                  num2 = fGW.nNi() ? 1 : 1;
                  continue;
                }
                goto label_5;
              default:
                goto label_1;
            }
          }
label_5:
          num1 += KGI.o9C(current.BC0()) * (int) (bGb.PmR()[0] as hGH).Gm3();
label_6:
          continue;
label_8:
          num2 = 3;
          goto label_3;
label_14:
          current = enumerator.Current;
          if (current.BC0().XCX() == null)
          {
            num1 += KGI.o9C((sC) fGW.VND((object) current));
            goto label_6;
          }
          else if (!(current.BC0().XCX() is Uv))
          {
            num1 = 0;
            RG2.u91(_param1, "Cannot get size of a block with unknown size (because of array extension in: '" + _param2.T1V() + "." + (string) fGW.ENt((object) current) + "')");
            num2 = 0;
            if (fGW.xNH() != null)
            {
              num2 = 0;
              goto label_3;
            }
            else
              goto label_3;
          }
          else
          {
            num2 = 2;
            goto label_3;
          }
        }
      }
      finally
      {
        if (enumerator != null)
          fGW.TNr((object) enumerator);
      }
label_1:
      _param2.iCe(num1);
    }

    public fGW()
    {
      XTG.fvQjdC();
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    internal static object wNN([In] object obj0) => (object) ((PJ) obj0).XCX();

    internal static object HN4([In] object obj0, [In] object obj1, [In] object obj2) => (object) ((string) obj0 + (string) obj1 + (string) obj2);

    internal static void TNr([In] object obj0) => ((IDisposable) obj0).Dispose();

    internal static bool uNZ([In] object obj0) => ((IEnumerator) obj0).MoveNext();

    internal static bool nNi() => fGW.SNP == null;

    internal static fGW xNH() => fGW.SNP;

    internal static void nNG(Xp _param0, [In] object obj1) => RG2.u91(_param0, (string) obj1);

    internal static object WN3([In] object obj0) => (object) ((OZ) obj0).BC0();

    internal static void gNJ([In] object obj0, [In] object obj1) => ((tGd) obj0).A1u((string) obj1);

    internal static Xp QN1([In] object obj0) => ((VGk) obj0).f19();

    internal static int oN8([In] object obj0) => ((ICollection<string>) obj0).Count;

    internal static int GNl([In] object obj0) => ((ICollection<tc>) obj0).Count;

    internal static object tNn([In] object obj0) => (object) ((UGT) obj0).lmu();

    internal static object ENs([In] object obj0) => (object) ((HL) obj0).pfX();

    internal static void gNV([In] object obj0, [In] object obj1) => ((bGa) obj0).zmU((Jt) obj1);

    internal static object jN9([In] object obj0) => (object) ((Jt) obj0).tyi();

    internal static object ONC([In] object obj0) => (object) ((tGd) obj0).T1V();

    internal static object VND([In] object obj0) => (object) ((G6) obj0).BC0();

    internal static object ENt([In] object obj0) => (object) ((G6) obj0).T1V();
  }
}
