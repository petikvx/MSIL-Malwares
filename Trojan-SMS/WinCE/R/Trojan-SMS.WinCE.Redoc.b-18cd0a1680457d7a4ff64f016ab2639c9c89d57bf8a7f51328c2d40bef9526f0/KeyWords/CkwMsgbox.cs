// Decompiled with JetBrains decompiler
// Type: Dbasic.KeyWords.CkwMsgbox
// Assembly: B4Pruntime, Version=1.0.3056.20520, Culture=neutral, PublicKeyToken=null
// MVID: BED81B59-7EDE-4B04-983E-56C0010CF881
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Trojan-SMS.WinCE.Redoc.b-18cd0a1680457d7a4ff64f016ab2639c9c89d57bf8a7f51328c2d40bef9526f0.exe

using System;
using System.Windows.Forms;

namespace Dbasic.KeyWords
{
  public class CkwMsgbox : CkeyWords
  {
    public CkwMsgbox(CRunner CRunner)
      : base(CRunner)
    {
    }

    public override MethodReturn Method(Place place, ref Locals locals)
    {
      ++place.WordI;
      RunReturn runReturn1 = this.CRunner.RunCode(place, true, true, ref locals);
      string vString = runReturn1.vString;
      string caption = "";
      place = runReturn1.place;
      MessageBoxButtons buttons = MessageBoxButtons.OK;
      MessageBoxIcon icon = MessageBoxIcon.Question;
      if (this.CRunner.nextWord(false, ref place).Value == ",")
      {
        ++place.WordI;
        RunReturn runReturn2 = new RunReturn();
        RunReturn runReturn3 = this.CRunner.RunCode(place, true, true, ref locals);
        place = runReturn3.place;
        caption = runReturn3.vString;
        if (this.CRunner.nextWord(false, ref place).Value == ",")
        {
          ++place.WordI;
          runReturn3 = this.CRunner.RunCode(place, false, true, ref locals);
          place = runReturn3.place;
          switch ((int) runReturn3.vDouble)
          {
            case 0:
              buttons = MessageBoxButtons.OK;
              break;
            case 1:
              buttons = MessageBoxButtons.OKCancel;
              break;
            case 2:
              buttons = MessageBoxButtons.AbortRetryIgnore;
              break;
            case 3:
              buttons = MessageBoxButtons.YesNoCancel;
              break;
            case 4:
              buttons = MessageBoxButtons.YesNo;
              break;
            case 5:
              buttons = MessageBoxButtons.RetryCancel;
              break;
          }
        }
        if (this.CRunner.nextWord(false, ref place).Value == ",")
        {
          ++place.WordI;
          runReturn3 = this.CRunner.RunCode(place, false, true, ref locals);
          place = runReturn3.place;
          switch ((int) runReturn3.vDouble)
          {
            case 0:
              icon = MessageBoxIcon.None;
              break;
            case 16:
              icon = MessageBoxIcon.Hand;
              break;
            case 32:
              icon = MessageBoxIcon.Question;
              break;
            case 48:
              icon = MessageBoxIcon.Exclamation;
              break;
            case 64:
              icon = MessageBoxIcon.Asterisk;
              break;
          }
        }
      }
      ++place.WordI;
      int num = (int) MessageBox.Show(vString, caption, buttons, icon, MessageBoxDefaultButton.Button1);
      return new MethodReturn(place, num.ToString((IFormatProvider) CRunner.cul), 0.0);
    }
  }
}
