// Decompiled with JetBrains decompiler
// Type: IngressoVip.clsCinema
// Assembly: IngressoVip, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B67C4084-86FB-4B3F-B072-28F5697F4668
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Virus.Win32.Sality.ae-115d93ab771edf65ec0d5a50e51f618fc5159020bdb0762845d86c2a74f94f06.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Npgsql;
using System;
using System.Data;
using System.Data.Common;

namespace IngressoVip
{
  public class clsCinema
  {
    private clsConexao objConn;
    private NpgsqlConnection CnnRomoto;
    private clsMensagem msg;
    private clsFuncoes objFuncoes;

    public clsCinema()
    {
      this.objConn = new clsConexao();
      this.CnnRomoto = new NpgsqlConnection(this.objConn.connRemoto());
      this.msg = new clsMensagem();
      this.objFuncoes = new clsFuncoes();
    }

    public DataSet PegaFilmes(ref string strCodRede)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct filme from filmes where idrede= " + strCodRede;
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaFilmes " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "filmes");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }

    public DataSet PegaRedes(ref string strCodArea)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct idrede,nome from redecinema where codarea= " + strCodArea;
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaFilmes " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "redecinema");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }

    public DataSet PegaShopping(
      ref string strCodFilme,
      ref string strCodRede,
      ref string strCodArea)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct filmes.idshopping from filmes,shopping where idrede= " + strCodRede + " and filme= " + strCodFilme + " and shopping.idshopping=filmes.idshopping and shopping.codarea= " + strCodArea;
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaShopping " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "filmes");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }

    public DataSet PegaDataFilme(
      ref string strCodFilme,
      ref string strCodRede,
      ref string strCodLocal)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct datasfilme.iddata ,datasfilme.data from filmes,datasfilme where filmes.idshopping=" + strCodLocal + " and filmes.idrede=" + strCodRede + " and filmes.filme=" + strCodFilme;
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaDatas " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "datasfilme");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }

    public DataSet PegaHoraFilme(
      ref string strCodFilme,
      ref string strCodRede,
      ref string strCodLocal,
      ref string strCodData)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct filme.idfilme,horasfilme.hora from datahorafilme,horasfilme,filmes,datasfilme,filme where filmes.filme=" + strCodFilme + "  and filme.idfilme=filmes.filme and filmes.idrede= " + strCodRede + " and filmes.idshopping= " + strCodLocal + " and filmes.iddata=datahorafilme.iddata and datahorafilme.iddata= " + strCodData + " and horasfilme.idhora=datahorafilme.idhora";
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaDatas " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "filmes");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }

    public DataSet PegaCodFilme(
      ref string strCodFilme,
      ref string strCodRede,
      ref string strCodLocal,
      ref string strCodData)
    {
      DataSet dataSet1 = new DataSet();
      DataSet dataSet2;
      try
      {
        if (this.CnnRomoto.State == ConnectionState.Closed)
        {
          this.objFuncoes.MsgConsole("Abrindo conexão com banco remoto...");
          this.CnnRomoto.Open();
          this.objFuncoes.MsgConsole("Conexão aberta...");
        }
        string str = "select distinct filme.idfilme,datasfilme.data from datahorafilme,horasfilme,filmes,datasfilme,filme where filmes.filme=" + strCodFilme + " and filme.idfilme=filmes.filme and filmes.idrede=" + strCodRede + " and filmes.idshopping=" + strCodLocal + " and filmes.iddata=" + strCodData + " and datahorafilme.iddata=filmes.iddata and datasfilme.iddata=datahorafilme.iddata";
        this.objFuncoes.MsgConsole("Valor do sql execultado em PegaDatas " + str);
        ((DbDataAdapter) new NpgsqlDataAdapter(str, this.CnnRomoto)).Fill(dataSet1, "filmes");
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.ToString());
        this.CnnRomoto.Close();
        dataSet2 = dataSet1;
        ProjectData.ClearProjectError();
      }
      return dataSet2;
    }
  }
}
