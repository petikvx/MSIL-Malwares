// Decompiled with JetBrains decompiler
// Type: ns2.Class41
// Assembly: TRM, Version=1.0.4536.20171, Culture=neutral, PublicKeyToken=null
// MVID: 8CAF3016-DE02-4666-A2B5-982FA29E174F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Trojan-Ransom.Win32.Generic-984a52c83c3ff1c9888aca4f7ec6b56e5cc5b48a8c9f7a0aa34fe2db2fe8da59.exe

using ns0;
using ns1;
using ns6;
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;

namespace ns2
{
  internal sealed class Class41
  {
    private Class38.Struct4 struct4_0 = Class38.Struct4.smethod_0();

    [SpecialName]
    public Class38.Struct4 method_0() => this.struct4_0;

    internal void method_1(IntPtr intptr_0) => this.struct4_0 = (Class38.Struct4) Marshal.PtrToStructure(intptr_0, typeof (Class38.Struct4));

    [SpecialName]
    public void method_2(string string_0)
    {
      uint num1 = 0;
      uint num2 = 0;
      uint num3 = 0;
      uint num4 = 0;
      string[] strArray = string_0.Split(".".ToCharArray(), 4);
      if (strArray.Length >= 1)
        num1 = uint.Parse(strArray[0]);
      if (strArray.Length >= 2)
        num2 = uint.Parse(strArray[1]);
      if (strArray.Length >= 3)
        num3 = uint.Parse(strArray[2]);
      if (strArray.Length >= 4)
        num4 = uint.Parse(strArray[3]);
      this.struct4_0.uint_2 = (num1 << 16) + num2;
      this.struct4_0.uint_3 = (num3 << 16) + num4;
    }

    [SpecialName]
    public string method_3() => string.Format("{0}.{1}.{2}.{3}", (object) Class15.smethod_3(this.struct4_0.uint_4), (object) Class15.smethod_4(this.struct4_0.uint_4), (object) Class15.smethod_3(this.struct4_0.uint_5), (object) Class15.smethod_4(this.struct4_0.uint_5));

    [SpecialName]
    public void method_4(string string_0)
    {
      uint num1 = 0;
      uint num2 = 0;
      uint num3 = 0;
      uint num4 = 0;
      string[] strArray = string_0.Split(".".ToCharArray(), 4);
      if (strArray.Length >= 1)
        num1 = uint.Parse(strArray[0]);
      if (strArray.Length >= 2)
        num2 = uint.Parse(strArray[1]);
      if (strArray.Length >= 3)
        num3 = uint.Parse(strArray[2]);
      if (strArray.Length >= 4)
        num4 = uint.Parse(strArray[3]);
      this.struct4_0.uint_4 = (num1 << 16) + num2;
      this.struct4_0.uint_5 = (num3 << 16) + num4;
    }

    public void method_5(BinaryWriter binaryWriter_0)
    {
      binaryWriter_0.Write(Class15.smethod_10<Class38.Struct4>(this.struct4_0));
      Class15.smethod_2(binaryWriter_0);
    }

    [SpecialName]
    public ushort method_6() => (ushort) Marshal.SizeOf((object) this.struct4_0);

    string object.ToString()
    {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.AppendLine(string.Format("FILEVERSION {0},{1},{2},{3}", (object) Class15.smethod_3(this.struct4_0.uint_2), (object) Class15.smethod_4(this.struct4_0.uint_2), (object) Class15.smethod_3(this.struct4_0.uint_3), (object) Class15.smethod_4(this.struct4_0.uint_3)));
      stringBuilder.AppendLine(string.Format("PRODUCTVERSION {0},{1},{2},{3}", (object) Class15.smethod_3(this.struct4_0.uint_4), (object) Class15.smethod_4(this.struct4_0.uint_4), (object) Class15.smethod_3(this.struct4_0.uint_5), (object) Class15.smethod_4(this.struct4_0.uint_5)));
      if (this.struct4_0.uint_6 == 63U)
        stringBuilder.AppendLine("FILEFLAGSMASK VS_FFI_FILEFLAGSMASK");
      else
        stringBuilder.AppendLine(string.Format("FILEFLAGSMASK 0x{0:x}", (object) this.struct4_0.uint_6.ToString()));
      stringBuilder.AppendLine(string.Format("FILEFLAGS {0}", this.struct4_0.uint_7 == 0U ? (object) "0" : (object) Class15.smethod_12<Class31.Enum2>(this.struct4_0.uint_7)));
      stringBuilder.AppendLine(string.Format("FILEOS {0}", (object) Class15.smethod_12<Class31.Enum3>(this.struct4_0.uint_7)));
      stringBuilder.AppendLine(string.Format("FILETYPE {0}", (object) Class15.smethod_12<Class31.Enum4>(this.struct4_0.uint_9)));
      stringBuilder.AppendLine(string.Format("FILESUBTYPE {0}", (object) Class15.smethod_12<Class31.Enum5>(this.struct4_0.uint_10)));
      return stringBuilder.ToString();
    }
  }
}
