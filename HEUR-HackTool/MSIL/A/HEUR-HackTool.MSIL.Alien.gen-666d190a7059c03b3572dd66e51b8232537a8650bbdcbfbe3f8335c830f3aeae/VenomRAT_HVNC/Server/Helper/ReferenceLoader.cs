// Decompiled with JetBrains decompiler
// Type: VenomRAT_HVNC.Server.Helper.ReferenceLoader
// Assembly: VenomRAT_HVNC, Version=5.0.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 364FC72B-4DB8-403E-BB7F-732199A12380
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-666d190a7059c03b3572dd66e51b8232537a8650bbdcbfbe3f8335c830f3aeae.exe

using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Reflection;
using System.Security.Policy;

namespace VenomRAT_HVNC.Server.Helper
{
  public class ReferenceLoader : MarshalByRefObject
  {
    public string[] LoadReferences(string assemblyPath)
    {
      string[] strArray;
      try
      {
        strArray = ((IEnumerable<AssemblyName>) Assembly.ReflectionOnlyLoadFrom(assemblyPath).GetReferencedAssemblies()).Select<AssemblyName, string>((Func<AssemblyName, string>) (x => x.FullName)).ToArray<string>();
      }
      catch
      {
        strArray = (string[]) null;
      }
      return strArray;
    }

    public void AppDomainSetup(string assemblyPath)
    {
      try
      {
        System.AppDomainSetup info = new System.AppDomainSetup()
        {
          ApplicationBase = AppDomain.CurrentDomain.BaseDirectory
        };
        AppDomain domain = AppDomain.CreateDomain(Guid.NewGuid().ToString(), (Evidence) null, info);
        ((ReferenceLoader) Activator.CreateInstance(domain, typeof (ReferenceLoader).Assembly.FullName, typeof (ReferenceLoader).FullName, false, BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic, (Binder) null, (object[]) null, CultureInfo.CurrentCulture, new object[0]).Unwrap()).LoadReferences(assemblyPath);
        AppDomain.Unload(domain);
      }
      catch
      {
      }
    }
  }
}
