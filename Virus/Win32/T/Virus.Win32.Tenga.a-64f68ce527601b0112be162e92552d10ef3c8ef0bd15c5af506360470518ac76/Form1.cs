// Decompiled with JetBrains decompiler
// Type: NETPLUSNETSIS.Form1
// Assembly: NETPLUSNETSIS, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4EFAE2CD-A83F-44D3-895B-57B4896EB0B4
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Virus.Win32.Tenga.a-64f68ce527601b0112be162e92552d10ef3c8ef0bd15c5af506360470518ac76.exe

using DtkNetSDK;
using INI;
using NetOpenX40;
using System;
using System.ComponentModel;
using System.Data.OleDb;
using System.Drawing;
using System.Windows.Forms;

namespace NETPLUSNETSIS
{
  public class Form1 : Form
  {
    private IContainer components = (IContainer) null;
    private GroupBox groupBox2;
    private GroupBox groupBox3;
    private ProgressBar PG;
    private Label label1;
    private RichTextBox edtInfo;
    private Panel panel1;
    private Panel panel2;
    private Panel panel3;
    private Button button2;
    private Button button1;
    private Label label7;
    private TextBox textBox4;
    private Label label6;
    private TextBox textBox3;
    private Label label5;
    private TextBox textBox2;
    private Label label4;
    private TextBox textBox1;
    private Label label8;
    private TextBox textBox5;
    private Label label9;
    private TextBox textBox6;
    private Label label10;
    private TextBox textBox7;
    private Label label11;
    private TextBox textBox8;
    private string constr = "";

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (Form1));
      this.groupBox2 = new GroupBox();
      this.label7 = new Label();
      this.textBox4 = new TextBox();
      this.label6 = new Label();
      this.textBox3 = new TextBox();
      this.label5 = new Label();
      this.textBox2 = new TextBox();
      this.label4 = new Label();
      this.textBox1 = new TextBox();
      this.groupBox3 = new GroupBox();
      this.label8 = new Label();
      this.textBox5 = new TextBox();
      this.label9 = new Label();
      this.textBox6 = new TextBox();
      this.label10 = new Label();
      this.textBox7 = new TextBox();
      this.label11 = new Label();
      this.textBox8 = new TextBox();
      this.PG = new ProgressBar();
      this.label1 = new Label();
      this.edtInfo = new RichTextBox();
      this.panel1 = new Panel();
      this.panel2 = new Panel();
      this.panel3 = new Panel();
      this.button2 = new Button();
      this.button1 = new Button();
      this.groupBox2.SuspendLayout();
      this.groupBox3.SuspendLayout();
      this.panel1.SuspendLayout();
      this.panel2.SuspendLayout();
      this.panel3.SuspendLayout();
      this.SuspendLayout();
      this.groupBox2.Controls.Add((Control) this.label7);
      this.groupBox2.Controls.Add((Control) this.textBox4);
      this.groupBox2.Controls.Add((Control) this.label6);
      this.groupBox2.Controls.Add((Control) this.textBox3);
      this.groupBox2.Controls.Add((Control) this.label5);
      this.groupBox2.Controls.Add((Control) this.textBox2);
      this.groupBox2.Controls.Add((Control) this.label4);
      this.groupBox2.Controls.Add((Control) this.textBox1);
      this.groupBox2.Location = new Point(0, 3);
      this.groupBox2.Name = "groupBox2";
      this.groupBox2.Size = new Size(234, 122);
      this.groupBox2.TabIndex = 1;
      this.groupBox2.TabStop = false;
      this.groupBox2.Text = "Datakod";
      this.label7.AutoSize = true;
      this.label7.Location = new Point(9, 97);
      this.label7.Name = "label7";
      this.label7.Size = new Size(31, 13);
      this.label7.TabIndex = 13;
      this.label7.Text = "Şifre:";
      this.textBox4.Location = new Point(75, 94);
      this.textBox4.Name = "textBox4";
      this.textBox4.PasswordChar = '*';
      this.textBox4.Size = new Size(133, 20);
      this.textBox4.TabIndex = 12;
      this.label6.AutoSize = true;
      this.label6.Location = new Point(9, 71);
      this.label6.Name = "label6";
      this.label6.Size = new Size(49, 13);
      this.label6.TabIndex = 11;
      this.label6.Text = "Kullanıcı:";
      this.textBox3.Location = new Point(75, 68);
      this.textBox3.Name = "textBox3";
      this.textBox3.Size = new Size(133, 20);
      this.textBox3.TabIndex = 10;
      this.label5.AutoSize = true;
      this.label5.Location = new Point(9, 45);
      this.label5.Name = "label5";
      this.label5.Size = new Size(35, 13);
      this.label5.TabIndex = 9;
      this.label5.Text = "Şube:";
      this.textBox2.Location = new Point(75, 42);
      this.textBox2.Name = "textBox2";
      this.textBox2.Size = new Size(38, 20);
      this.textBox2.TabIndex = 8;
      this.label4.AutoSize = true;
      this.label4.Location = new Point(9, 19);
      this.label4.Name = "label4";
      this.label4.Size = new Size(37, 13);
      this.label4.TabIndex = 7;
      this.label4.Text = "Şirket:";
      this.textBox1.Location = new Point(75, 16);
      this.textBox1.Name = "textBox1";
      this.textBox1.Size = new Size(133, 20);
      this.textBox1.TabIndex = 0;
      this.groupBox3.Controls.Add((Control) this.label8);
      this.groupBox3.Controls.Add((Control) this.textBox5);
      this.groupBox3.Controls.Add((Control) this.label9);
      this.groupBox3.Controls.Add((Control) this.textBox6);
      this.groupBox3.Controls.Add((Control) this.label10);
      this.groupBox3.Controls.Add((Control) this.textBox7);
      this.groupBox3.Controls.Add((Control) this.label11);
      this.groupBox3.Controls.Add((Control) this.textBox8);
      this.groupBox3.Location = new Point(240, 3);
      this.groupBox3.Name = "groupBox3";
      this.groupBox3.Size = new Size(234, 122);
      this.groupBox3.TabIndex = 2;
      this.groupBox3.TabStop = false;
      this.groupBox3.Text = "Netsis";
      this.label8.AutoSize = true;
      this.label8.Location = new Point(18, 97);
      this.label8.Name = "label8";
      this.label8.Size = new Size(31, 13);
      this.label8.TabIndex = 21;
      this.label8.Text = "Şifre:";
      this.textBox5.Location = new Point(84, 94);
      this.textBox5.Name = "textBox5";
      this.textBox5.PasswordChar = '*';
      this.textBox5.Size = new Size(133, 20);
      this.textBox5.TabIndex = 20;
      this.label9.AutoSize = true;
      this.label9.Location = new Point(18, 71);
      this.label9.Name = "label9";
      this.label9.Size = new Size(49, 13);
      this.label9.TabIndex = 19;
      this.label9.Text = "Kullanıcı:";
      this.textBox6.Location = new Point(84, 68);
      this.textBox6.Name = "textBox6";
      this.textBox6.Size = new Size(133, 20);
      this.textBox6.TabIndex = 18;
      this.label10.AutoSize = true;
      this.label10.Location = new Point(18, 45);
      this.label10.Name = "label10";
      this.label10.Size = new Size(35, 13);
      this.label10.TabIndex = 17;
      this.label10.Text = "Şube:";
      this.textBox7.Location = new Point(84, 42);
      this.textBox7.Name = "textBox7";
      this.textBox7.Size = new Size(38, 20);
      this.textBox7.TabIndex = 16;
      this.label11.AutoSize = true;
      this.label11.Location = new Point(18, 19);
      this.label11.Name = "label11";
      this.label11.Size = new Size(37, 13);
      this.label11.TabIndex = 15;
      this.label11.Text = "Şirket:";
      this.textBox8.Location = new Point(84, 16);
      this.textBox8.Name = "textBox8";
      this.textBox8.Size = new Size(133, 20);
      this.textBox8.TabIndex = 14;
      this.PG.Location = new Point(13, 32);
      this.PG.Name = "PG";
      this.PG.Size = new Size(458, 23);
      this.PG.TabIndex = 0;
      this.label1.AutoSize = true;
      this.label1.Location = new Point(10, 14);
      this.label1.Name = "label1";
      this.label1.Size = new Size(40, 13);
      this.label1.TabIndex = 5;
      this.label1.Text = "Hazır...";
      this.edtInfo.BackColor = SystemColors.Control;
      this.edtInfo.BorderStyle = BorderStyle.None;
      this.edtInfo.Location = new Point(13, 61);
      this.edtInfo.Name = "edtInfo";
      this.edtInfo.Size = new Size(458, 181);
      this.edtInfo.TabIndex = 7;
      this.edtInfo.Text = "";
      this.panel1.Controls.Add((Control) this.groupBox2);
      this.panel1.Controls.Add((Control) this.groupBox3);
      this.panel1.Dock = DockStyle.Top;
      this.panel1.Location = new Point(0, 0);
      this.panel1.Name = "panel1";
      this.panel1.Size = new Size(486, 133);
      this.panel1.TabIndex = 8;
      this.panel2.Controls.Add((Control) this.PG);
      this.panel2.Controls.Add((Control) this.label1);
      this.panel2.Controls.Add((Control) this.edtInfo);
      this.panel2.Dock = DockStyle.Fill;
      this.panel2.Location = new Point(0, 133);
      this.panel2.Name = "panel2";
      this.panel2.Size = new Size(486, 294);
      this.panel2.TabIndex = 9;
      this.panel3.Controls.Add((Control) this.button2);
      this.panel3.Controls.Add((Control) this.button1);
      this.panel3.Dock = DockStyle.Bottom;
      this.panel3.Location = new Point(0, 381);
      this.panel3.Name = "panel3";
      this.panel3.Size = new Size(486, 46);
      this.panel3.TabIndex = 10;
      this.button2.Location = new Point(15, 11);
      this.button2.Name = "button2";
      this.button2.Size = new Size(75, 23);
      this.button2.TabIndex = 1;
      this.button2.Text = "Aktar";
      this.button2.UseVisualStyleBackColor = true;
      this.button2.Click += new EventHandler(this.button2_Click);
      this.button1.Location = new Point(396, 11);
      this.button1.Name = "button1";
      this.button1.Size = new Size(75, 23);
      this.button1.TabIndex = 0;
      this.button1.Text = "Kapat";
      this.button1.UseVisualStyleBackColor = true;
      this.button1.Click += new EventHandler(this.button1_Click);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(486, 427);
      this.Controls.Add((Control) this.panel3);
      this.Controls.Add((Control) this.panel2);
      this.Controls.Add((Control) this.panel1);
      this.Icon = (Icon) componentResourceManager.GetObject("$this.Icon");
      this.Name = nameof (Form1);
      this.Text = "Datakod.Net Plus -> Netsis Veri Aktarım";
      this.Load += new EventHandler(this.Form1_Load);
      this.FormClosing += new FormClosingEventHandler(this.Form1_FormClosing);
      this.groupBox2.ResumeLayout(false);
      this.groupBox2.PerformLayout();
      this.groupBox3.ResumeLayout(false);
      this.groupBox3.PerformLayout();
      this.panel1.ResumeLayout(false);
      this.panel2.ResumeLayout(false);
      this.panel2.PerformLayout();
      this.panel3.ResumeLayout(false);
      this.ResumeLayout(false);
    }

    public Form1() => this.InitializeComponent();

    private void KaydetParam()
    {
      IniFile iniFile = new IniFile(Application.StartupPath + "\\CONFIG.INI");
      iniFile.IniWriteValue("DATAKOD", "SIRKET", this.textBox1.Text);
      iniFile.IniWriteValue("DATAKOD", "SUBE", this.textBox2.Text);
      iniFile.IniWriteValue("DATAKOD", "KULL", this.textBox3.Text);
      iniFile.IniWriteValue("DATAKOD", "SIFRE", this.textBox4.Text);
      iniFile.IniWriteValue("NETSIS", "SIRKET", this.textBox8.Text);
      iniFile.IniWriteValue("NETSIS", "SUBE", this.textBox7.Text);
      iniFile.IniWriteValue("NETSIS", "KULL", this.textBox6.Text);
      iniFile.IniWriteValue("NETSIS", "SIFRE", this.textBox5.Text);
    }

    private void AlParam()
    {
      IniFile iniFile = new IniFile(Application.StartupPath + "\\CONFIG.INI");
      this.textBox1.Text = iniFile.IniReadValue("DATAKOD", "SIRKET");
      this.textBox2.Text = iniFile.IniReadValue("DATAKOD", "SUBE");
      this.textBox3.Text = iniFile.IniReadValue("DATAKOD", "KULL");
      this.textBox4.Text = iniFile.IniReadValue("DATAKOD", "SIFRE");
      this.textBox8.Text = iniFile.IniReadValue("NETSIS", "SIRKET");
      this.textBox7.Text = iniFile.IniReadValue("NETSIS", "SUBE");
      this.textBox6.Text = iniFile.IniReadValue("NETSIS", "KULL");
      this.textBox5.Text = iniFile.IniReadValue("NETSIS", "SIFRE");
      this.constr = iniFile.IniReadValue("NETSIS", "SQLCON");
    }

    public static string NullString(object val) => (val != null ? val.ToString() : "").Replace("'", "`");

    private void yazBilgi(string pBilgi, Color pColor)
    {
      this.edtInfo.SelectionColor = pColor;
      this.edtInfo.AppendText(pBilgi + (object) Convert.ToChar(13) + (object) Convert.ToChar(10));
      Application.DoEvents();
    }

    private void Aktar()
    {
      try
      {
        this.yazBilgi("İşlem başlatıldı!", Color.Blue);
        TNetKernel tnetKernel = new TNetKernel(true, true);
        TNetSirket tnetSirket = tnetKernel.yeniSirket(this.textBox1.Text, Convert.ToInt32(this.textBox2.Text), this.textBox3.Text, this.textBox4.Text);
        this.yazBilgi("Datakod.Net Plus'a bağlanıldı...", Color.Blue);
        Kernel kernel = (Kernel) new KernelClass();
        Sirket sirket1 = (Sirket) new SirketClass();
        Sirket sirket2 = ((IKernel) kernel).yeniSirket((TVTTipi) 0, this.textBox8.Text, "TEMELSET", "", this.textBox6.Text, this.textBox5.Text, Convert.ToInt32(this.textBox7.Text));
        if (sirket2 == null)
          throw new Exception("Netsis bağlantısı kurulamadı!");
        this.yazBilgi("Netsis'e bağlanıldı...", Color.Blue);
        OleDbConnection connection = new OleDbConnection(this.constr);
        connection.Open();
        this.yazBilgi("Netsis SQL bağlanıldı...", Color.Blue);
        OleDbCommand oleDbCommand1 = new OleDbCommand("EXEC DATAKOD_NETPLUSFATURA_COUNT", connection);
        oleDbCommand1.CommandTimeout = 999999;
        OleDbDataReader oleDbDataReader1 = oleDbCommand1.ExecuteReader();
        this.yazBilgi("Counting...", Color.Blue);
        if (oleDbDataReader1.Read())
        {
          this.PG.Value = 0;
          this.PG.Maximum = Convert.ToInt32(oleDbDataReader1["LN"]) + 5;
        }
        oleDbDataReader1.Close();
        oleDbDataReader1.Dispose();
        OleDbDataReader oleDbDataReader2 = (OleDbDataReader) null;
        oleDbCommand1.Dispose();
        OleDbCommand oleDbCommand2 = (OleDbCommand) null;
        OleDbCommand oleDbCommand3 = new OleDbCommand("EXEC DATAKOD_NETPLUSFATURA", connection);
        oleDbCommand3.CommandTimeout = 999999;
        OleDbDataReader oleDbDataReader3 = oleDbCommand3.ExecuteReader();
        while (oleDbDataReader3.Read())
        {
          if (Form1.NullString(oleDbDataReader3["CARI_KODU"]) != "")
          {
            TCari tcari = new TCari(tnetSirket);
            if (!tcari.Kayit_Ac(tnetSirket.BayiKod, oleDbDataReader3["CARI_KODU"].ToString()))
            {
              NetRS netRs = ((IKernel) kernel).yeniNetRS(sirket2);
              ((INetRS) netRs).Ac("SELECT * FROM TBLCASABIT   WHERE CARI_KOD = '" + oleDbDataReader3["CARI_KODU"].ToString() + "'");
              if (!((INetRS) netRs).EOF)
              {
                tcari.Kayit_Varsayilan();
                tcari.CariKod = ((INetField) ((INetRS) netRs).FieldByName("CARI_KOD")).AsString;
                tcari.Unvan = Form1.NullString((object) ((INetField) ((INetRS) netRs).FieldByName("CARI_ISIM")).AsString);
                tcari.Adres1 = Form1.NullString((object) ((INetField) ((INetRS) netRs).FieldByName("CARI_ADRES")).AsString);
                tcari.Ilce = Form1.NullString((object) ((INetField) ((INetRS) netRs).FieldByName("CARI_ILCE")).AsString);
                tcari.Vd = Form1.NullString((object) ((INetField) ((INetRS) netRs).FieldByName("VERGI_DAIRESI")).AsString);
                tcari.Vn = Form1.NullString((object) ((INetField) ((INetRS) netRs).FieldByName("VERGI_NUMARASI")).AsString);
                tcari.Grup1Kod = "001";
                tcari.IlKod = Form1.NullString((object) ((INetRS) netRs).FieldByName("RAPOR_KODU1")).Substring(0, 2);
                tcari.IsAktif = true;
                tcari.Kayit_Ekle(false);
              }
            }
          }
          TBelge tbelge = tnetSirket.yeniBelge();
          if (oleDbDataReader3["FTIRSIP"].ToString() == "1")
          {
            tbelge.FisBelgeTip = (TFisBelgeTip) 2;
            tbelge.FisBelgeTur = (TFisBelgeTur) 2;
            tbelge.FisBelgeCins = !(oleDbDataReader3["TIPI"].ToString() == "4") ? (TFisBelgeCins) 0 : (TFisBelgeCins) 3;
            tbelge.FisOdemeTip = (TFisOdemeTip) 0;
          }
          else if (oleDbDataReader3["FTIRSIP"].ToString() == "2")
          {
            tbelge.FisBelgeTip = (TFisBelgeTip) 2;
            tbelge.FisBelgeTur = (TFisBelgeTur) 1;
            tbelge.FisBelgeCins = !(oleDbDataReader3["TIPI"].ToString() == "2") ? (TFisBelgeCins) 3 : (TFisBelgeCins) 0;
            tbelge.FisOdemeTip = (TFisOdemeTip) 0;
          }
          else if (oleDbDataReader3["FTIRSIP"].ToString() == "9")
          {
            tbelge.FisBelgeTip = (TFisBelgeTip) 3;
            tbelge.FisBelgeTur = (TFisBelgeTur) 3;
            tbelge.FisBelgeCins = (TFisBelgeCins) 0;
            tbelge.FisOdemeTip = (TFisOdemeTip) 0;
          }
          else if (oleDbDataReader3["FTIRSIP"].ToString() == "8")
          {
            tbelge.FisBelgeTip = (TFisBelgeTip) 3;
            tbelge.FisBelgeTur = (TFisBelgeTur) 4;
            tbelge.FisBelgeCins = (TFisBelgeCins) 0;
            tbelge.FisOdemeTip = (TFisOdemeTip) 0;
          }
          else if (oleDbDataReader3["FTIRSIP"].ToString() == "4")
          {
            tbelge.FisBelgeTip = (TFisBelgeTip) 1;
            tbelge.FisBelgeTur = (TFisBelgeTur) 1;
            tbelge.FisBelgeCins = (TFisBelgeCins) 0;
            tbelge.FisOdemeTip = (TFisOdemeTip) 0;
          }
          tbelge.FisNo = tbelge.FisBelgeTur != 1 ? oleDbDataReader3["FATIRS_NO"].ToString() : tbelge.Al_YeniFisNo(tbelge.FisBelgeTip, tbelge.FisBelgeTur, "", true);
          tbelge.PerKod = oleDbDataReader3["PLA_KODU"].ToString();
          tbelge.BTarih = Convert.ToDateTime(oleDbDataReader3["TARIH"]);
          tbelge.VTarih = Convert.ToDateTime(oleDbDataReader3["ODEMETARIHI"]);
          tbelge.STarih = Convert.ToDateTime(oleDbDataReader3["SIPARIS_TEST"]);
          tbelge.OKod1S = oleDbDataReader3["FATIRS_NO"].ToString();
          tbelge.OKod2S = Form1.NullString(oleDbDataReader3["KOD1"]);
          tbelge.OKod3S = Form1.NullString(oleDbDataReader3["KOD2"]);
          tbelge.CariKod = Form1.NullString((object) oleDbDataReader3["CARI_KODU"].ToString());
          if (Form1.NullString((object) oleDbDataReader3["CARI_KOD2"].ToString()) != "")
            tbelge.TesCariKod = Form1.NullString((object) oleDbDataReader3["CARI_KOD2"].ToString());
          if (oleDbDataReader3["TIPI"].ToString() == "1")
          {
            tbelge.FisOdemeTip = (TFisOdemeTip) 1;
            tbelge.KasaKod = "1";
          }
          if (oleDbDataReader3["TIPI"].ToString() == "4" || oleDbDataReader3["TIPI"].ToString() == "5")
            tbelge.FisBelgeCins = (TFisBelgeCins) 3;
          tbelge.AIsk1 = Convert.ToDouble(oleDbDataReader3["GEN_ISK1O"]);
          tbelge.AIsk2 = Convert.ToDouble(oleDbDataReader3["GEN_ISK2O"]);
          tbelge.AIsk3 = Convert.ToDouble(oleDbDataReader3["GEN_ISK3O"]);
          NetRS netRs1 = ((IKernel) kernel).yeniNetRS(sirket2);
          ((INetRS) netRs1).Ac("SELECT *,TBLSTSABIT.OLCU_BR1,TBLSTSABIT.OLCU_BR2,TBLSTSABIT.OLCU_BR3,   TBLSTSABIT.URETICI_KODU,   CASE TBLSTHAR.OLCUBR   WHEN 0 THEN TBLSTSABIT.OLCU_BR1   WHEN 1 THEN TBLSTSABIT.OLCU_BR1   WHEN 2 THEN TBLSTSABIT.OLCU_BR2   WHEN 3 THEN TBLSTSABIT.OLCU_BR3   WHEN 4 THEN ISNULL((SELECT B.OLCUBIRIMI FROM TBLSTBIRIM B WHERE B.KOD = TBLSTSABIT.STOK_KODU AND B.INCKEYNO=EK.I_YEDEK1),'')   WHEN 5 THEN ISNULL((SELECT B.OLCUBIRIMI FROM TBLSTBIRIM B WHERE B.KOD = TBLSTSABIT.STOK_KODU AND B.INCKEYNO=EK.L_YEDEK1),'')   END BIRIMFF,  CASE TBLSTHAR.OLCUBR   WHEN 0 THEN 1   WHEN 1 THEN 1   WHEN 2 THEN PAY_1   WHEN 3 THEN PAY2   END PAYFF, CASE TBLSTHAR.OLCUBR   WHEN 0 THEN 1   WHEN 1 THEN 1   WHEN 2 THEN PAYDA_1   WHEN 3 THEN PAYDA2   END PAYDAFF, TBLSTHAR.CEVRIM,  CASE TBLSTHAR.OLCUBR   WHEN 0 THEN 1   WHEN 1 THEN 1   WHEN 2 THEN TBLSTSABIT.PAYDA_1   WHEN 3 THEN TBLSTSABIT.PAYDA2   WHEN 4 THEN ISNULL((SELECT B.PAYDA FROM TBLSTBIRIM B WHERE B.KOD = TBLSTSABIT.STOK_KODU AND B.INCKEYNO=EK.I_YEDEK1),'')   WHEN 5 THEN ISNULL((SELECT B.PAYDA FROM TBLSTBIRIM B WHERE B.KOD = TBLSTSABIT.STOK_KODU AND B.INCKEYNO=EK.L_YEDEK1),'')   END BIRIMPAYDA   FROM TBLSTHAR WITH(NOLOCK),TBLSTSABIT WITH(NOLOCK),TBLSTSABITEK EK WITH(NOLOCK)         WHERE TBLSTHAR.FISNO = '" + oleDbDataReader3["FATIRS_NO"].ToString() + "'          AND TBLSTHAR.STHAR_FTIRSIP = '" + oleDbDataReader3["FTIRSIP"].ToString() + "'          AND TBLSTHAR.STHAR_ACIKLAMA = '" + oleDbDataReader3["CARI_KODU"].ToString() + "'          AND TBLSTSABIT.STOK_KODU = TBLSTHAR.STOK_KODU           AND EK.STOK_KODU = TBLSTHAR.STOK_KODU            ");
          while (!((INetRS) netRs1).EOF)
          {
            bool flag = false;
            int index1 = tbelge.Ekle_BelgeKalem(((INetField) ((INetRS) netRs1).FieldByName("STOK_KODU")).AsString, true);
            tbelge.BelgeKalem[index1].StokKod = ((INetField) ((INetRS) netRs1).FieldByName("STOK_KODU")).AsString;
            double num1 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_GCMIK")).AsFloat;
            if (((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat != 0.0)
              num1 = Math.Round(((INetField) ((INetRS) netRs1).FieldByName("STHAR_GCMIK")).AsFloat * ((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat);
            string str1 = "";
            string str2 = "";
            string str3 = Form1.NullString((object) ((INetField) ((INetRS) netRs1).FieldByName("BIRIMFF")).AsString);
            if (str3 == "")
              this.yazBilgi(Form1.NullString((object) ((INetField) ((INetRS) netRs1).FieldByName("STOK_KODU")).AsString) + " birim bulunamadı!", Color.Red);
            TStokBirim tstokBirim1 = new TStokBirim(tnetSirket);
            tstokBirim1.Kayit_Ac(tnetSirket.BayiKod, tbelge.BelgeKalem[index1].StokKod, str3);
            tbelge.BelgeKalem[index1].Miktar = num1;
            tstokBirim1.Dispose();
            TStokBirim tstokBirim2 = (TStokBirim) null;
            if (((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat == 0.0)
            {
              tbelge.BelgeKalem[index1].CikisTip = "N";
              tbelge.BelgeKalem[index1].Isk1 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_SATISK")).AsFloat * 100000.0;
              tbelge.BelgeKalem[index1].Isk2 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_SATISK2")).AsFloat;
              tbelge.BelgeKalem[index1].Isk3 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK3")).AsFloat;
              tbelge.BelgeKalem[index1].Isk4 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK4")).AsFloat;
              tbelge.BelgeKalem[index1].Isk5 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK5")).AsFloat;
              tbelge.BelgeKalem[index1].Isk6 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK6")).AsFloat;
            }
            else if (((INetField) ((INetRS) netRs1).FieldByName("STHAR_GCMIK")).AsFloat - ((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat != 0.0)
            {
              flag = true;
              tbelge.BelgeKalem[index1].Isk1 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_SATISK")).AsFloat * 100000.0;
              tbelge.BelgeKalem[index1].Isk2 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_SATISK2")).AsFloat;
              tbelge.BelgeKalem[index1].Isk3 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK3")).AsFloat;
              tbelge.BelgeKalem[index1].Isk4 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK4")).AsFloat;
              tbelge.BelgeKalem[index1].Isk5 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK5")).AsFloat;
              tbelge.BelgeKalem[index1].Isk6 = ((INetField) ((INetRS) netRs1).FieldByName("STRA_SATISK6")).AsFloat;
              double num2 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_GCMIK")).AsFloat - ((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat;
              if (((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat != 0.0)
                num2 = Math.Round((((INetField) ((INetRS) netRs1).FieldByName("STHAR_GCMIK")).AsFloat - ((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat) * ((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat);
              tbelge.BelgeKalem[index1].Miktar = num2;
            }
            else
            {
              tbelge.BelgeKalem[index1].CikisTip = "B";
              tbelge.BelgeKalem[index1].BdlIsk = 100.0;
              tbelge.BelgeKalem[index1].Isk1 = 0.0;
              tbelge.BelgeKalem[index1].Isk2 = 0.0;
              tbelge.BelgeKalem[index1].Isk3 = 0.0;
              tbelge.BelgeKalem[index1].Isk4 = 0.0;
              tbelge.BelgeKalem[index1].Isk5 = 0.0;
              tbelge.BelgeKalem[index1].Isk6 = 0.0;
              tbelge.BelgeKalem[index1].Isk7 = 0.0;
              tbelge.BelgeKalem[index1].Isk8 = 0.0;
              tbelge.BelgeKalem[index1].Isk9 = 0.0;
              tbelge.BelgeKalem[index1].Isk10 = 0.0;
              tbelge.BelgeKalem[index1].Isk11 = 0.0;
              tbelge.BelgeKalem[index1].Isk12 = 0.0;
            }
            tbelge.BelgeKalem[index1].Birim = str3;
            tbelge.BelgeKalem[index1].Fiyat = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_BF")).AsFloat * ((INetField) ((INetRS) netRs1).FieldByName("BIRIMPAYDA")).AsFloat;
            tbelge.BelgeKalem[index1].DovizFiyat = tbelge.BelgeKalem[index1].Fiyat;
            tbelge.BelgeKalem[index1].DovizKur = 1.0;
            tbelge.BelgeKalem[index1].Doviz = tnetKernel.VarsayilanDoviz;
            tbelge.BelgeKalem[index1].VadeGun = (short) ((INetField) ((INetRS) netRs1).FieldByName("STHAR_ODEGUN")).AsInteger;
            tbelge.BelgeKalem[index1].Kdv = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_KDV")).AsFloat;
            tbelge.BelgeKalem[index1].DepoKod = "1";
            if (flag)
            {
              int index2 = tbelge.Ekle_BelgeKalem(((INetField) ((INetRS) netRs1).FieldByName("URETICI_KODU")).AsString, true);
              tbelge.BelgeKalem[index2].StokKod = ((INetField) ((INetRS) netRs1).FieldByName("URETICI_KODU")).AsString;
              double num3 = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat;
              if (((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat != 0.0)
                num3 = Math.Round(((INetField) ((INetRS) netRs1).FieldByName("STHAR_MALFISK")).AsFloat * ((INetField) ((INetRS) netRs1).FieldByName("CEVRIM")).AsFloat);
              str1 = "";
              str2 = "";
              string str4 = Form1.NullString((object) ((INetField) ((INetRS) netRs1).FieldByName("BIRIMFF")).AsString);
              if (str4 == "")
                this.yazBilgi(Form1.NullString((object) ((INetField) ((INetRS) netRs1).FieldByName("STOK_KODU")).AsString) + " birim bulunamadı!", Color.Red);
              TStokBirim tstokBirim3 = new TStokBirim(tnetSirket);
              tstokBirim3.Kayit_Ac(tnetSirket.BayiKod, tbelge.BelgeKalem[index2].StokKod, str4);
              tbelge.BelgeKalem[index2].Miktar = num3;
              tstokBirim3.Dispose();
              tstokBirim2 = (TStokBirim) null;
              tbelge.BelgeKalem[index2].CikisTip = "B";
              tbelge.BelgeKalem[index2].BdlIsk = 100.0;
              tbelge.BelgeKalem[index2].Isk1 = 0.0;
              tbelge.BelgeKalem[index2].Isk2 = 0.0;
              tbelge.BelgeKalem[index2].Isk3 = 0.0;
              tbelge.BelgeKalem[index2].Isk4 = 0.0;
              tbelge.BelgeKalem[index2].Isk5 = 0.0;
              tbelge.BelgeKalem[index2].Isk6 = 0.0;
              tbelge.BelgeKalem[index2].Isk7 = 0.0;
              tbelge.BelgeKalem[index2].Isk8 = 0.0;
              tbelge.BelgeKalem[index2].Isk9 = 0.0;
              tbelge.BelgeKalem[index2].Isk10 = 0.0;
              tbelge.BelgeKalem[index2].Isk11 = 0.0;
              tbelge.BelgeKalem[index2].Isk12 = 0.0;
              tbelge.BelgeKalem[index2].Birim = str4;
              tbelge.BelgeKalem[index2].Fiyat = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_BF")).AsFloat * ((INetField) ((INetRS) netRs1).FieldByName("BIRIMPAYDA")).AsFloat;
              tbelge.BelgeKalem[index2].DovizFiyat = tbelge.BelgeKalem[index2].Fiyat;
              tbelge.BelgeKalem[index2].DovizKur = 1.0;
              tbelge.BelgeKalem[index2].Doviz = tnetKernel.VarsayilanDoviz;
              tbelge.BelgeKalem[index2].VadeGun = (short) ((INetField) ((INetRS) netRs1).FieldByName("STHAR_ODEGUN")).AsInteger;
              tbelge.BelgeKalem[index2].Kdv = ((INetField) ((INetRS) netRs1).FieldByName("STHAR_KDV")).AsFloat;
              tbelge.BelgeKalem[index2].DepoKod = "1";
            }
            ((INetRS) netRs1).SonrakiK();
          }
          ((INetRS) netRs1).Kapat();
          try
          {
            tnetSirket.TransactionBaslat();
            tbelge.Kayit_Ekle(false);
            tnetSirket.TransactionOnayla();
          }
          catch (Exception ex)
          {
            try
            {
              tnetSirket.TransactionBitir();
            }
            catch
            {
            }
            this.yazBilgi("Belge Aktarılamadı!: " + oleDbDataReader3["FATIRS_NO"].ToString() + (object) Convert.ToChar(13) + (object) Convert.ToChar(10) + ex.Message, Color.Red);
          }
          tbelge.Dispose();
          ++this.PG.Value;
          this.label1.Text = oleDbDataReader3["FATIRS_NO"].ToString() + " " + this.PG.Value.ToString() + "/" + this.PG.Maximum.ToString();
          Application.DoEvents();
        }
        oleDbDataReader3.Close();
        oleDbDataReader3.Dispose();
        oleDbDataReader2 = (OleDbDataReader) null;
        oleDbCommand3?.Dispose();
        oleDbCommand2 = (OleDbCommand) null;
        sirket1 = (Sirket) null;
        ((IKernel) kernel).FreeNetsisLibrary();
        tnetSirket.Dispose();
        tnetKernel.Bosalt_Kernel();
        tnetKernel.Dispose();
        int num = (int) MessageBox.Show("İşlem tamamlandı!");
      }
      catch (Exception ex)
      {
        this.yazBilgi(ex.Message, Color.Red);
      }
    }

    private void Form1_Load(object sender, EventArgs e)
    {
      try
      {
        this.AlParam();
      }
      catch
      {
      }
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
      try
      {
        this.KaydetParam();
      }
      catch
      {
      }
    }

    private void button2_Click(object sender, EventArgs e)
    {
      this.button2.Enabled = false;
      this.Aktar();
      this.button2.Enabled = true;
    }

    private void button1_Click(object sender, EventArgs e) => this.Close();
  }
}
