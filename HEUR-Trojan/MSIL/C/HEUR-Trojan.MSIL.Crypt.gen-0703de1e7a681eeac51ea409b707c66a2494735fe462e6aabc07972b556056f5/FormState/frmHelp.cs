// Decompiled with JetBrains decompiler
// Type: FormState.frmHelp
// Assembly: Interna, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 443E8749-461D-4E08-9210-1C57029CD0B8
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.02-msil\HEUR-Trojan.MSIL.Crypt.gen-0703de1e7a681eeac51ea409b707c66a2494735fe462e6aabc07972b556056f5.exe

using System;
using System.ComponentModel;
using System.Drawing;
using System.IO;
using System.Reflection;
using System.Text;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace FormState
{
  public class frmHelp : Form
  {
    private string _help;
    private bool _meLoad;
    private string css = "<head>\n  <style type='text/css'>\n    p{font-family:Verdania,Helvetica,Tahoma;font-size:10pt}\n    p.error{font-size:15px;font-color:Red}\n    p.small{font-size:8pt}\n  </style>\n</head>";
    private IContainer components = (IContainer) null;
    private WebBrowser webBrowser1;
    private Panel panel1;
    private CheckBox cbAuto;
    private Button btnRefresh;

    public frmHelp()
    {
      this.InitializeComponent();
      this._meLoad = true;
      this.webBrowser1.Navigate("about:blank");
      this._meLoad = false;
    }

    public void Navigate(string help)
    {
      this.webBrowser1.Document.Write(string.Empty);
      this._help = help;
      this.LoadHelp(false);
    }

    private void _LoadHelp()
    {
      Assembly executingAssembly = Assembly.GetExecutingAssembly();
      string name = executingAssembly.GetName().Name + ".Resources." + this._help + ".txt";
      Stream manifestResourceStream = executingAssembly.GetManifestResourceStream(name);
      string input;
      if (manifestResourceStream != null)
      {
        byte[] numArray = new byte[Convert.ToInt32(manifestResourceStream.Length)];
        manifestResourceStream.Read(numArray, 0, Convert.ToInt32(manifestResourceStream.Length));
        input = Encoding.ASCII.GetString(numArray);
      }
      else
        input = "<p style='color:red'>Cannot find help for page " + this._help + "<br><br>Try EmbeddedResource</p>";
      string str = new Regex("<head.*?</head>", RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Singleline).Replace(input, this.css);
      this._meLoad = true;
      this.webBrowser1.DocumentText = str + "<p class='small'>" + name + "</p>";
      this._meLoad = false;
    }

    private void LoadHelp(bool force)
    {
      if (force)
        this._LoadHelp();
      else if (this.cbAuto.Checked)
        this._LoadHelp();
    }

    private void btnRefresh_Click(object sender, EventArgs e) => this.LoadHelp(true);

    private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
    {
      if (this._meLoad || e.Url.ToString().Equals("about:blank"))
        return;
      this._help = e.Url.ToString().Replace("about:", "");
      this._LoadHelp();
      e.Cancel = true;
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.webBrowser1 = new WebBrowser();
      this.panel1 = new Panel();
      this.btnRefresh = new Button();
      this.cbAuto = new CheckBox();
      this.panel1.SuspendLayout();
      this.SuspendLayout();
      this.webBrowser1.Dock = DockStyle.Fill;
      this.webBrowser1.IsWebBrowserContextMenuEnabled = false;
      this.webBrowser1.Location = new Point(0, 35);
      this.webBrowser1.MinimumSize = new Size(20, 20);
      this.webBrowser1.Name = "webBrowser1";
      this.webBrowser1.Size = new Size(292, 231);
      this.webBrowser1.TabIndex = 0;
      this.webBrowser1.Navigating += new WebBrowserNavigatingEventHandler(this.webBrowser1_Navigating);
      this.panel1.Controls.Add((Control) this.btnRefresh);
      this.panel1.Controls.Add((Control) this.cbAuto);
      this.panel1.Dock = DockStyle.Top;
      this.panel1.Location = new Point(0, 0);
      this.panel1.Name = "panel1";
      this.panel1.Size = new Size(292, 35);
      this.panel1.TabIndex = 1;
      this.btnRefresh.Location = new Point(113, 4);
      this.btnRefresh.Name = "btnRefresh";
      this.btnRefresh.Size = new Size(56, 23);
      this.btnRefresh.TabIndex = 1;
      this.btnRefresh.Text = "Refresh";
      this.btnRefresh.UseVisualStyleBackColor = true;
      this.btnRefresh.Click += new EventHandler(this.btnRefresh_Click);
      this.cbAuto.AutoSize = true;
      this.cbAuto.Checked = true;
      this.cbAuto.CheckState = CheckState.Checked;
      this.cbAuto.Location = new Point(12, 12);
      this.cbAuto.Name = "cbAuto";
      this.cbAuto.Size = new Size(94, 17);
      this.cbAuto.TabIndex = 0;
      this.cbAuto.Text = "Auto Navigate";
      this.cbAuto.UseVisualStyleBackColor = true;
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(292, 266);
      this.Controls.Add((Control) this.webBrowser1);
      this.Controls.Add((Control) this.panel1);
      this.Name = nameof (frmHelp);
      this.Text = nameof (frmHelp);
      this.panel1.ResumeLayout(false);
      this.panel1.PerformLayout();
      this.ResumeLayout(false);
    }
  }
}
