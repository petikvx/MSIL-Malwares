// Decompiled with JetBrains decompiler
// Type: CC.Common.Utils.InputCombo
// Assembly: Interna, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 443E8749-461D-4E08-9210-1C57029CD0B8
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.02-msil\HEUR-Trojan.MSIL.Crypt.gen-0703de1e7a681eeac51ea409b707c66a2494735fe462e6aabc07972b556056f5.exe

using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

namespace CC.Common.Utils
{
  public class InputCombo : Form
  {
    protected Button buttonOK;
    protected Button buttonCancel;
    protected Label labelPrompt;
    protected ComboBox comboBox;
    protected ErrorProvider errorProviderText;
    private Container components = (Container) null;
    private InputComboValidatingHandler _validator;

    private InputCombo() => this.InitializeComponent();

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.buttonOK = new Button();
      this.buttonCancel = new Button();
      this.comboBox = new ComboBox();
      this.labelPrompt = new Label();
      this.errorProviderText = new ErrorProvider();
      this.SuspendLayout();
      this.buttonOK.Anchor = AnchorStyles.Top | AnchorStyles.Right;
      this.buttonOK.DialogResult = DialogResult.OK;
      this.buttonOK.Location = new Point(288, 72);
      this.buttonOK.Name = "buttonOK";
      this.buttonOK.TabIndex = 2;
      this.buttonOK.Text = "OK";
      this.buttonOK.Click += new EventHandler(this.buttonOK_Click);
      this.buttonCancel.Anchor = AnchorStyles.Top | AnchorStyles.Right;
      this.buttonCancel.CausesValidation = false;
      this.buttonCancel.DialogResult = DialogResult.Cancel;
      this.buttonCancel.Location = new Point(376, 72);
      this.buttonCancel.Name = "buttonCancel";
      this.buttonCancel.TabIndex = 3;
      this.buttonCancel.Text = "Cancel";
      this.buttonCancel.Click += new EventHandler(this.buttonCancel_Click);
      this.comboBox.Location = new Point(16, 32);
      this.comboBox.Name = "textBoxText";
      this.comboBox.Size = new Size(416, 20);
      this.comboBox.TabIndex = 1;
      this.comboBox.Text = "";
      this.comboBox.DropDownStyle = ComboBoxStyle.DropDownList;
      this.comboBox.Validating += new CancelEventHandler(this.comboBox_Validating);
      this.comboBox.TextChanged += new EventHandler(this.textBoxText_TextChanged);
      this.labelPrompt.AutoSize = true;
      this.labelPrompt.Location = new Point(15, 15);
      this.labelPrompt.Name = "labelPrompt";
      this.labelPrompt.Size = new Size(39, 13);
      this.labelPrompt.TabIndex = 0;
      this.labelPrompt.Text = "prompt";
      this.errorProviderText.DataMember = (string) null;
      this.AcceptButton = (IButtonControl) this.buttonOK;
      this.AutoScaleBaseSize = new Size(5, 13);
      this.CancelButton = (IButtonControl) this.buttonCancel;
      this.ClientSize = new Size(464, 104);
      this.Controls.AddRange(new Control[4]
      {
        (Control) this.labelPrompt,
        (Control) this.comboBox,
        (Control) this.buttonCancel,
        (Control) this.buttonOK
      });
      this.FormBorderStyle = FormBorderStyle.FixedDialog;
      this.MaximizeBox = false;
      this.MinimizeBox = false;
      this.Name = nameof (InputCombo);
      this.Text = "Title";
      this.ResumeLayout(false);
    }

    private void buttonCancel_Click(object sender, EventArgs e)
    {
      this.Validator = (InputComboValidatingHandler) null;
      this.Close();
    }

    private void buttonOK_Click(object sender, EventArgs e) => this.Close();

    public static InputComboResult Show(
      string prompt,
      string title,
      string selectedItem,
      object[] items,
      InputComboValidatingHandler validator,
      int xpos,
      int ypos)
    {
      using (InputCombo inputCombo = new InputCombo())
      {
        inputCombo.labelPrompt.Text = prompt;
        inputCombo.Text = title;
        inputCombo.comboBox.Items.AddRange(items);
        if (selectedItem != null)
        {
          for (int index = 0; index < inputCombo.comboBox.Items.Count; ++index)
          {
            if (inputCombo.comboBox.Items[index].ToString().Equals(selectedItem))
            {
              inputCombo.comboBox.SelectedIndex = index;
              break;
            }
          }
        }
        if (xpos >= 0 && ypos >= 0)
        {
          inputCombo.StartPosition = FormStartPosition.Manual;
          inputCombo.Left = xpos;
          inputCombo.Top = ypos;
        }
        else
          inputCombo.StartPosition = FormStartPosition.CenterParent;
        inputCombo.Validator = validator;
        DialogResult dialogResult = inputCombo.ShowDialog();
        InputComboResult inputComboResult = new InputComboResult();
        if (dialogResult == DialogResult.OK)
        {
          inputComboResult.Text = inputCombo.comboBox.Text;
          inputComboResult.SelectedIndex = inputCombo.comboBox.SelectedIndex;
          inputComboResult.Object = inputCombo.comboBox.SelectedItem;
          inputComboResult.OK = true;
        }
        return inputComboResult;
      }
    }

    public static InputComboResult Show(
      string prompt,
      string title,
      string selectedItem,
      object[] items,
      InputComboValidatingHandler validator)
    {
      return InputCombo.Show(prompt, title, selectedItem, items, validator, -1, -1);
    }

    public static InputComboResult Show(
      string prompt,
      string title,
      string selectedItem,
      object[] items)
    {
      return InputCombo.Show(prompt, title, selectedItem, items, (InputComboValidatingHandler) null);
    }

    private void textBoxText_TextChanged(object sender, EventArgs e) => this.errorProviderText.SetError((Control) this.comboBox, "");

    private void comboBox_Validating(object sender, CancelEventArgs e)
    {
      if (this.Validator == null)
        return;
      InputComboValidatingArgs e1 = new InputComboValidatingArgs();
      e1.Text = this.comboBox.Text;
      e1.SelectedIndex = this.comboBox.SelectedIndex;
      e1.Object = this.comboBox.SelectedItem;
      this.Validator((object) this, e1);
      if (e1.Cancel)
      {
        e.Cancel = true;
        this.errorProviderText.SetError((Control) this.comboBox, e1.Message);
      }
    }

    protected InputComboValidatingHandler Validator
    {
      get => this._validator;
      set => this._validator = value;
    }
  }
}
