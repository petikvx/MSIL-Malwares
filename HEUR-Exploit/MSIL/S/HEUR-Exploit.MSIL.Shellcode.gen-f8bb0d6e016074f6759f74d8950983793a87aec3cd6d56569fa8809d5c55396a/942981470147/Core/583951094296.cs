// Decompiled with JetBrains decompiler
// Type: 942981470147.Core.583951094296
// Assembly: 942981470147, Version=16.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 92EB186D-EC33-4501-B5FF-A65C9233BC32
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Exploit.MSIL.Shellcode.gen-f8bb0d6e016074f6759f74d8950983793a87aec3cd6d56569fa8809d5c55396a.exe

using \u003202955077067;
using \u003206885437057;
using \u003942981470147.Core;
using \u003942981470147.Models;
using \u003942981470147.Utils;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003942981470147.Core
{
  public static class \u003583951094296
  {
    private static void \u003153130209838(
      string _param0,
      string _param1,
      Func<string, \u003556159290710> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003186298523234 obj1 = new \u003186298523234();
      obj1.\u003066256814846 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003186298523234 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003556159290710 obj3 = _param2(contents);
      string str1 = \u003583951094296.\u003765479416766(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003772732101998.\u003403907057619(obj3.\u003289865105513, path1);
        }
        catch (Exception ex)
        {
          ex.\u003783976718808();
          File.Delete(path1);
        }
      }
    }

    private static string \u003765479416766(\u003556159290710 _param0)
    {
      string str = Path.GetFileName(_param0.\u003289865105513).\u003030736208373();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003289865105513);
      return string.Empty;
    }

    public static void \u003319995193104()
    {
      string path1 = \u003313364816402.\u003033000553842();
      \u003631137062167 obj1 = \u003188579923867.\u003874030726690(path1);
      string str = obj1?.\u003570813443853;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003412752527284 obj2 = new \u003412752527284(str);
        ((\u003682580147494) obj2).\u003739704159771 = \u003188579923867.\u003723660701286();
        ((\u003682580147494) obj2).\u003583896585900 = obj1.\u003348639026506;
        ((\u003682580147494) obj2).\u003299035849765 = Color.DarkRed;
        ((\u003682580147494) obj2).\u003969998406876 = \u003695700743403.\u003176929450206;
        ((\u003682580147494) obj2).\u003757758748557 = \u003695700743403.\u003199480268523;
        ((\u003682580147494) obj2).\u003690160013628 = \u003695700743403.\u003411657117812;
        ((\u003682580147494) obj2).\u003112357187019 = \u003695700743403.\u003177482537994;
        ((\u003682580147494) obj2).\u003333149300123 = \u003695700743403.\u003020557764747;
        ((\u003682580147494) obj2).\u003515559557430 = \u003695700743403.\u003195331096111;
        ((\u003682580147494) obj2).\u003873819477958 = \u003695700743403.\u003441773336263;
        using (\u003682580147494 obj3 = (\u003682580147494) obj2)
        {
          using (Image image = obj3.\u003086184671888())
          {
            string filename;
            if (\u003421112384870.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003249910976191.\u003443405589393(filename);
            \u003249910976191.\u003004580931408(filename);
          }
        }
      }
    }
  }
}
