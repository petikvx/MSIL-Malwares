// Decompiled with JetBrains decompiler
// Type: AlphaCentavr.Identification
// Assembly: Xobntom2, Version=1.0.0.422, Culture=neutral, PublicKeyToken=null
// MVID: 7E933326-C6DC-4B1B-B81C-CFA3C6FCABF5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.MSIL.Agent.gen-bbc8ac47d3051fbab328d4a8a4c1c8819707ac045ab6ac94b1997dac59be2ece.exe

using Microsoft.VisualBasic;
using System;
using System.Runtime.InteropServices;

namespace AlphaCentavr
{
  internal static class Identification
  {
    [DllImport("kernel32", EntryPoint = "GetVolumeInformationA")]
    private static extern int GetVolumeInformation(
      string lpRootPathName,
      string lpVolumeNameBuffer,
      int nVolumeNameSize,
      ref int lpVolumeSerialNumber,
      ref int lpMaximumComponentLength,
      ref int lpFileSystemFlags,
      string lpFileSystemNameBuffer,
      int nFileSystemNameSize);

    public static string YHLWD()
    {
      try
      {
        int Number = 0;
        string lpRootPathName = Interaction.Environ("SystemDrive") + "\\";
        string str1 = (string) null;
        int num1 = 0;
        int num2 = 0;
        string str2 = (string) null;
        string lpVolumeNameBuffer = str1;
        ref int local1 = ref Number;
        ref int local2 = ref num1;
        ref int local3 = ref num2;
        string lpFileSystemNameBuffer = str2;
        Identification.GetVolumeInformation(lpRootPathName, lpVolumeNameBuffer, 0, ref local1, ref local2, ref local3, lpFileSystemNameBuffer, 0);
        return Conversion.Hex(Number);
      }
      catch (Exception ex)
      {
        return "ERR";
      }
    }
  }
}
