// Decompiled with JetBrains decompiler
// Type: JfsUqX2laJ6sV.sIpSo5IUmPrf9
// Assembly: Udby4Jt48oXkJ, Version=3.17.2.31, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 37899E89-D673-4F5B-A193-2E4DF6A54096
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-bf535869266eca7a958714acade2ede1bff0e73f0aaa2702f389ededee6a8d6a.exe

using Microsoft.Win32.SafeHandles;
using QSS3PlDQAyMp9;
using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security;
using System.Security.Cryptography;
using yFt7pB2372H4i;
using znVoO82LrsYAA;

namespace JfsUqX2laJ6sV
{
  internal static class sIpSo5IUmPrf9
  {
    [SecurityCritical]
    internal static fkQr9MD3HnJLb qVxM2Vct3k4WQ(IntPtr QFv0MpFcM3Oyj) => pNLYNJuIGYGNT.EvsTjy2GacNRi.PxNc1H1ZOLK1N(QFv0MpFcM3Oyj);

    [SecurityCritical]
    internal static SafeNCryptKeyHandle DPztQkxumg1D3(fkQr9MD3HnJLb laGhW5K0EyyKG)
    {
      bool Bpzzw36Mr5X6V = true;
      SafeNCryptKeyHandle k4llEgn8cpD6F = (SafeNCryptKeyHandle) null;
      RuntimeHelpers.PrepareConstrainedRegions();
      try
      {
        int pFscMXkcsszZF = 0;
        if (!sIpSo5IUmPrf9.wPQgrg5zUPKT8.fp4y5yGNwx5Rn(laGhW5K0EyyKG, (sIpSo5IUmPrf9.zWru8X7c92VSX) 262144, IntPtr.Zero, out k4llEgn8cpD6F, out pFscMXkcsszZF, out Bpzzw36Mr5X6V))
          throw new CryptographicException(Marshal.GetLastWin32Error());
        return k4llEgn8cpD6F;
      }
      finally
      {
        if (k4llEgn8cpD6F != null && !Bpzzw36Mr5X6V)
        {
          bool success = false;
          k4llEgn8cpD6F.DangerousAddRef(ref success);
        }
      }
    }

    internal enum zWru8X7c92VSX
    {
      None = 0,
      jn66DmXHBtHfl = 9,
      AcquireOnlyNCryptKeys = 262144, // 0x00040000
    }

    [SuppressUnmanagedCodeSecurity]
    internal static class wPQgrg5zUPKT8
    {
      [DllImport("crypt32.dll", EntryPoint = "CryptAcquireCertificatePrivateKey", SetLastError = true)]
      [return: MarshalAs(UnmanagedType.Bool)]
      internal static extern bool fp4y5yGNwx5Rn(
        fkQr9MD3HnJLb gQXfsZLZ2GwDo,
        sIpSo5IUmPrf9.zWru8X7c92VSX unCXK6vRMOph4,
        IntPtr _param2,
        out SafeNCryptKeyHandle k4llEgn8cpD6F,
        out int pFscMXkcsszZF,
        [MarshalAs(UnmanagedType.Bool)] out bool Bpzzw36Mr5X6V);

      [DllImport("kernel32.dll", EntryPoint = "GetNativeSystemInfo")]
      private static extern void IcaYfdqgimN9R(
        ref HgU9ZQtKaZBWN.JIvjOVvTvT80d.\u0033RtIzTwU5yvwh mTiN4IFH84JIJ);
    }
  }
}
