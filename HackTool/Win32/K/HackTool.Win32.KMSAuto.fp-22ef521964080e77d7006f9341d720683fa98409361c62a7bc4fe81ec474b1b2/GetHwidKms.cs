// Decompiled with JetBrains decompiler
// Type: KMSAuto_Net.GetHwidKms
// Assembly: KMSAuto Net, Version=1.5.1.0, Culture=neutral, PublicKeyToken=bec47372430fea8e
// MVID: 01D269A5-0EB6-4D4C-9AA7-E1A8A817CC4D
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HackTool.Win32.KMSAuto.fp-22ef521964080e77d7006f9341d720683fa98409361c62a7bc4fe81ec474b1b2.exe

using KMSAuto_Net.My;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Runtime.CompilerServices;
using System.Text;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace KMSAuto_Net
{
  [DesignerGenerated]
  public class GetHwidKms : Form
  {
    private IContainer components;
    public string Tempdir;
    public string SysPath;
    private string _systemroot;
    private string _product;
    private string _protocol;
    private string _memo;
    private string _memoprot;

    public GetHwidKms()
    {
      this.FormClosed += new FormClosedEventHandler(this.GetHwidKMS_FormClosed);
      this.Load += new EventHandler(this.GetHwidKMS_Load);
      this.Tempdir = Interaction.Environ("TEMP");
      this.SysPath = "";
      this._systemroot = Interaction.Environ("SYSTEMROOT");
      this._product = "/A=3c40b358-5948-45af-923b-53d21fcc7e79";
      this._protocol = "/6";
      this._memo = "";
      this._memoprot = "";
      this.InitializeComponent();
    }

    [DebuggerNonUserCode]
    protected override void Dispose(bool disposing)
    {
      try
      {
        if (!disposing || this.components == null)
          return;
        this.components.Dispose();
      }
      finally
      {
        base.Dispose(disposing);
      }
    }

    [DebuggerStepThrough]
    private void InitializeComponent()
    {
      ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (GetHwidKms));
      this.TextBoxIP = new TextBox();
      this.Label1 = new Label();
      this.TextBoxePID = new TextBox();
      this.Label2 = new Label();
      this.Button1 = new Button();
      this.TextBoxPort = new TextBox();
      this.Label3 = new Label();
      this.TextBoxHwid = new TextBox();
      this.Label4 = new Label();
      this.CheckBox1 = new CheckBox();
      this.GroupBox1 = new GroupBox();
      this.CheckBox2 = new CheckBox();
      this.RadioButton7 = new RadioButton();
      this.RadioButton3 = new RadioButton();
      this.RadioButton2 = new RadioButton();
      this.RadioButton1 = new RadioButton();
      this.GroupBox2 = new GroupBox();
      this.RadioButton6 = new RadioButton();
      this.RadioButton5 = new RadioButton();
      this.RadioButton4 = new RadioButton();
      this.GroupBox1.SuspendLayout();
      this.GroupBox2.SuspendLayout();
      this.SuspendLayout();
      this.TextBoxIP.Location = new Point(54, 22);
      this.TextBoxIP.Margin = new Padding(4);
      this.TextBoxIP.Name = "TextBoxIP";
      this.TextBoxIP.Size = new Size(248, 22);
      this.TextBoxIP.TabIndex = 0;
      this.Label1.AutoSize = true;
      this.Label1.Location = new Point(25, 26);
      this.Label1.Margin = new Padding(4, 0, 4, 0);
      this.Label1.Name = "Label1";
      this.Label1.Size = new Size(24, 17);
      this.Label1.TabIndex = 1;
      this.Label1.Text = "IP:";
      this.TextBoxePID.Location = new Point(54, 62);
      this.TextBoxePID.Margin = new Padding(4);
      this.TextBoxePID.Name = "TextBoxePID";
      this.TextBoxePID.Size = new Size(384, 22);
      this.TextBoxePID.TabIndex = 2;
      this.TextBoxePID.TextAlign = HorizontalAlignment.Center;
      this.Label2.AutoSize = true;
      this.Label2.Location = new Point(7, 65);
      this.Label2.Margin = new Padding(4, 0, 4, 0);
      this.Label2.Name = "Label2";
      this.Label2.Size = new Size(42, 17);
      this.Label2.TabIndex = 3;
      this.Label2.Text = "ePID:";
      this.Button1.Location = new Point(54, 140);
      this.Button1.Margin = new Padding(4);
      this.Button1.Name = "Button1";
      this.Button1.Size = new Size(190, 28);
      this.Button1.TabIndex = 4;
      this.Button1.Text = "Start";
      this.Button1.UseVisualStyleBackColor = true;
      this.TextBoxPort.Location = new Point(355, 22);
      this.TextBoxPort.Margin = new Padding(4);
      this.TextBoxPort.Name = "TextBoxPort";
      this.TextBoxPort.Size = new Size(83, 22);
      this.TextBoxPort.TabIndex = 5;
      this.Label3.AutoSize = true;
      this.Label3.Location = new Point(310, 27);
      this.Label3.Margin = new Padding(4, 0, 4, 0);
      this.Label3.Name = "Label3";
      this.Label3.Size = new Size(38, 17);
      this.Label3.TabIndex = 6;
      this.Label3.Text = "Port:";
      this.TextBoxHwid.Location = new Point(54, 102);
      this.TextBoxHwid.Margin = new Padding(4);
      this.TextBoxHwid.Name = "TextBoxHwid";
      this.TextBoxHwid.Size = new Size(190, 22);
      this.TextBoxHwid.TabIndex = 7;
      this.TextBoxHwid.TextAlign = HorizontalAlignment.Center;
      this.Label4.AutoSize = true;
      this.Label4.Location = new Point(7, 106);
      this.Label4.Margin = new Padding(4, 0, 4, 0);
      this.Label4.Name = "Label4";
      this.Label4.Size = new Size(42, 17);
      this.Label4.TabIndex = 8;
      this.Label4.Text = "Hwid:";
      this.CheckBox1.AutoSize = true;
      this.CheckBox1.Location = new Point(293, 145);
      this.CheckBox1.Margin = new Padding(4);
      this.CheckBox1.Name = "CheckBox1";
      this.CheckBox1.Size = new Size(100, 21);
      this.CheckBox1.TabIndex = 9;
      this.CheckBox1.Text = "CheckBox1";
      this.CheckBox1.UseVisualStyleBackColor = true;
      this.GroupBox1.Controls.Add((Control) this.CheckBox2);
      this.GroupBox1.Controls.Add((Control) this.RadioButton7);
      this.GroupBox1.Controls.Add((Control) this.RadioButton3);
      this.GroupBox1.Controls.Add((Control) this.RadioButton2);
      this.GroupBox1.Controls.Add((Control) this.RadioButton1);
      this.GroupBox1.Location = new Point(21, 184);
      this.GroupBox1.Margin = new Padding(4);
      this.GroupBox1.Name = "GroupBox1";
      this.GroupBox1.Padding = new Padding(4);
      this.GroupBox1.Size = new Size(243, 142);
      this.GroupBox1.TabIndex = 31;
      this.GroupBox1.TabStop = false;
      this.GroupBox1.Text = "GroupBox1";
      this.CheckBox2.AutoSize = true;
      this.CheckBox2.Location = new Point(135, 25);
      this.CheckBox2.Margin = new Padding(4);
      this.CheckBox2.Name = "CheckBox2";
      this.CheckBox2.Size = new Size(101, 21);
      this.CheckBox2.TabIndex = 10;
      this.CheckBox2.Text = "LTSB 2016";
      this.CheckBox2.UseVisualStyleBackColor = true;
      this.RadioButton7.AutoSize = true;
      this.RadioButton7.Location = new Point(9, 105);
      this.RadioButton7.Margin = new Padding(4);
      this.RadioButton7.Name = "RadioButton7";
      this.RadioButton7.Size = new Size(115, 21);
      this.RadioButton7.TabIndex = 3;
      this.RadioButton7.TabStop = true;
      this.RadioButton7.Text = "RadioButton7";
      this.RadioButton7.UseVisualStyleBackColor = true;
      this.RadioButton3.AutoSize = true;
      this.RadioButton3.Location = new Point(9, 79);
      this.RadioButton3.Margin = new Padding(4);
      this.RadioButton3.Name = "RadioButton3";
      this.RadioButton3.Size = new Size(115, 21);
      this.RadioButton3.TabIndex = 2;
      this.RadioButton3.TabStop = true;
      this.RadioButton3.Text = "RadioButton3";
      this.RadioButton3.UseVisualStyleBackColor = true;
      this.RadioButton2.AutoSize = true;
      this.RadioButton2.Location = new Point(9, 52);
      this.RadioButton2.Margin = new Padding(4);
      this.RadioButton2.Name = "RadioButton2";
      this.RadioButton2.Size = new Size(115, 21);
      this.RadioButton2.TabIndex = 1;
      this.RadioButton2.TabStop = true;
      this.RadioButton2.Text = "RadioButton2";
      this.RadioButton2.UseVisualStyleBackColor = true;
      this.RadioButton1.AutoSize = true;
      this.RadioButton1.Location = new Point(9, 25);
      this.RadioButton1.Margin = new Padding(4);
      this.RadioButton1.Name = "RadioButton1";
      this.RadioButton1.Size = new Size(115, 21);
      this.RadioButton1.TabIndex = 0;
      this.RadioButton1.TabStop = true;
      this.RadioButton1.Text = "RadioButton1";
      this.RadioButton1.UseVisualStyleBackColor = true;
      this.GroupBox2.Controls.Add((Control) this.RadioButton6);
      this.GroupBox2.Controls.Add((Control) this.RadioButton5);
      this.GroupBox2.Controls.Add((Control) this.RadioButton4);
      this.GroupBox2.Location = new Point(284, 184);
      this.GroupBox2.Margin = new Padding(4);
      this.GroupBox2.Name = "GroupBox2";
      this.GroupBox2.Padding = new Padding(4);
      this.GroupBox2.Size = new Size(187, 123);
      this.GroupBox2.TabIndex = 32;
      this.GroupBox2.TabStop = false;
      this.GroupBox2.Text = "GroupBox2";
      this.RadioButton6.AutoSize = true;
      this.RadioButton6.Location = new Point(9, 79);
      this.RadioButton6.Margin = new Padding(4);
      this.RadioButton6.Name = "RadioButton6";
      this.RadioButton6.Size = new Size(115, 21);
      this.RadioButton6.TabIndex = 2;
      this.RadioButton6.TabStop = true;
      this.RadioButton6.Text = "RadioButton6";
      this.RadioButton6.UseVisualStyleBackColor = true;
      this.RadioButton5.AutoSize = true;
      this.RadioButton5.Location = new Point(9, 52);
      this.RadioButton5.Margin = new Padding(4);
      this.RadioButton5.Name = "RadioButton5";
      this.RadioButton5.Size = new Size(115, 21);
      this.RadioButton5.TabIndex = 1;
      this.RadioButton5.TabStop = true;
      this.RadioButton5.Text = "RadioButton5";
      this.RadioButton5.UseVisualStyleBackColor = true;
      this.RadioButton4.AutoSize = true;
      this.RadioButton4.Location = new Point(9, 25);
      this.RadioButton4.Margin = new Padding(4);
      this.RadioButton4.Name = "RadioButton4";
      this.RadioButton4.Size = new Size(115, 21);
      this.RadioButton4.TabIndex = 0;
      this.RadioButton4.TabStop = true;
      this.RadioButton4.Text = "RadioButton4";
      this.RadioButton4.UseVisualStyleBackColor = true;
      this.AutoScaleDimensions = new SizeF(8f, 16f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(493, 353);
      this.Controls.Add((Control) this.GroupBox2);
      this.Controls.Add((Control) this.GroupBox1);
      this.Controls.Add((Control) this.CheckBox1);
      this.Controls.Add((Control) this.Label4);
      this.Controls.Add((Control) this.TextBoxHwid);
      this.Controls.Add((Control) this.Label3);
      this.Controls.Add((Control) this.TextBoxPort);
      this.Controls.Add((Control) this.Button1);
      this.Controls.Add((Control) this.Label2);
      this.Controls.Add((Control) this.TextBoxePID);
      this.Controls.Add((Control) this.Label1);
      this.Controls.Add((Control) this.TextBoxIP);
      this.FormBorderStyle = FormBorderStyle.FixedDialog;
      this.Icon = (Icon) componentResourceManager.GetObject("$this.Icon");
      this.Margin = new Padding(4);
      this.MaximizeBox = false;
      this.Name = nameof (GetHwidKms);
      this.StartPosition = FormStartPosition.Manual;
      this.Text = "KMS-Service Info";
      this.GroupBox1.ResumeLayout(false);
      this.GroupBox1.PerformLayout();
      this.GroupBox2.ResumeLayout(false);
      this.GroupBox2.PerformLayout();
      this.ResumeLayout(false);
      this.PerformLayout();
    }

    [field: AccessedThroughProperty("TextBoxIP")]
    internal virtual TextBox TextBoxIP { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("Label1")]
    internal virtual Label Label1 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("TextBoxePID")]
    internal virtual TextBox TextBoxePID { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("Label2")]
    internal virtual Label Label2 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    internal virtual Button Button1
    {
      get => this._Button1;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.Button1_Click);
        Button button1_1 = this._Button1;
        if (button1_1 != null)
          button1_1.Click -= eventHandler;
        this._Button1 = value;
        Button button1_2 = this._Button1;
        if (button1_2 == null)
          return;
        button1_2.Click += eventHandler;
      }
    }

    [field: AccessedThroughProperty("TextBoxPort")]
    internal virtual TextBox TextBoxPort { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("Label3")]
    internal virtual Label Label3 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("TextBoxHwid")]
    internal virtual TextBox TextBoxHwid { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("Label4")]
    internal virtual Label Label4 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("CheckBox1")]
    internal virtual CheckBox CheckBox1 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    [field: AccessedThroughProperty("GroupBox1")]
    internal virtual GroupBox GroupBox1 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    internal virtual RadioButton RadioButton3
    {
      get => this._RadioButton3;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton3_CheckedChanged);
        RadioButton radioButton3_1 = this._RadioButton3;
        if (radioButton3_1 != null)
          radioButton3_1.CheckedChanged -= eventHandler;
        this._RadioButton3 = value;
        RadioButton radioButton3_2 = this._RadioButton3;
        if (radioButton3_2 == null)
          return;
        radioButton3_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual RadioButton RadioButton2
    {
      get => this._RadioButton2;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton2_CheckedChanged);
        RadioButton radioButton2_1 = this._RadioButton2;
        if (radioButton2_1 != null)
          radioButton2_1.CheckedChanged -= eventHandler;
        this._RadioButton2 = value;
        RadioButton radioButton2_2 = this._RadioButton2;
        if (radioButton2_2 == null)
          return;
        radioButton2_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual RadioButton RadioButton1
    {
      get => this._RadioButton1;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton1_CheckedChanged);
        RadioButton radioButton1_1 = this._RadioButton1;
        if (radioButton1_1 != null)
          radioButton1_1.CheckedChanged -= eventHandler;
        this._RadioButton1 = value;
        RadioButton radioButton1_2 = this._RadioButton1;
        if (radioButton1_2 == null)
          return;
        radioButton1_2.CheckedChanged += eventHandler;
      }
    }

    [field: AccessedThroughProperty("GroupBox2")]
    internal virtual GroupBox GroupBox2 { get; [MethodImpl(MethodImplOptions.Synchronized)] set; }

    internal virtual RadioButton RadioButton6
    {
      get => this._RadioButton6;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton6_CheckedChanged);
        RadioButton radioButton6_1 = this._RadioButton6;
        if (radioButton6_1 != null)
          radioButton6_1.CheckedChanged -= eventHandler;
        this._RadioButton6 = value;
        RadioButton radioButton6_2 = this._RadioButton6;
        if (radioButton6_2 == null)
          return;
        radioButton6_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual RadioButton RadioButton5
    {
      get => this._RadioButton5;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton5_CheckedChanged);
        RadioButton radioButton5_1 = this._RadioButton5;
        if (radioButton5_1 != null)
          radioButton5_1.CheckedChanged -= eventHandler;
        this._RadioButton5 = value;
        RadioButton radioButton5_2 = this._RadioButton5;
        if (radioButton5_2 == null)
          return;
        radioButton5_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual RadioButton RadioButton4
    {
      get => this._RadioButton4;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton4_CheckedChanged);
        RadioButton radioButton4_1 = this._RadioButton4;
        if (radioButton4_1 != null)
          radioButton4_1.CheckedChanged -= eventHandler;
        this._RadioButton4 = value;
        RadioButton radioButton4_2 = this._RadioButton4;
        if (radioButton4_2 == null)
          return;
        radioButton4_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual RadioButton RadioButton7
    {
      get => this._RadioButton7;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.RadioButton7_CheckedChanged);
        RadioButton radioButton7_1 = this._RadioButton7;
        if (radioButton7_1 != null)
          radioButton7_1.CheckedChanged -= eventHandler;
        this._RadioButton7 = value;
        RadioButton radioButton7_2 = this._RadioButton7;
        if (radioButton7_2 == null)
          return;
        radioButton7_2.CheckedChanged += eventHandler;
      }
    }

    internal virtual CheckBox CheckBox2
    {
      get => this._CheckBox2;
      [MethodImpl(MethodImplOptions.Synchronized)] set
      {
        EventHandler eventHandler = new EventHandler(this.CheckBox2_CheckedChanged);
        CheckBox checkBox2_1 = this._CheckBox2;
        if (checkBox2_1 != null)
          checkBox2_1.CheckedChanged -= eventHandler;
        this._CheckBox2 = value;
        CheckBox checkBox2_2 = this._CheckBox2;
        if (checkBox2_2 == null)
          return;
        checkBox2_2.CheckedChanged += eventHandler;
      }
    }

    private void GetHwidKMS_FormClosed(object sender, FormClosedEventArgs e)
    {
      FileSystem.ChDir(MyProject.Forms.Form1.Tempdir);
      MyProject.Forms.Form1.DelDir(MyProject.Forms.Form1.Tempdir + "\\kmsclient");
    }

    private void GetHwidKMS_Load(object sender, EventArgs e)
    {
      this.Button1.Text = Lang.ButtonText31;
      this.TextBoxIP.Text = "127.0.0.2";
      this.TextBoxePID.Text = "";
      this.TextBoxHwid.Text = "";
      this.TextBoxPort.Text = "1688";
      this.CheckBox1.Text = Lang.ButtonText26;
      this.RadioButton1.Text = "Windows";
      this.RadioButton2.Text = "Office 2010";
      this.RadioButton3.Text = "Office 2013";
      this.RadioButton7.Text = "Office 2016";
      this.RadioButton4.Text = "V4 protocol";
      this.RadioButton5.Text = "V5 protocol";
      this.RadioButton6.Text = "V6 protocol";
      this.GroupBox1.Text = Lang.ProductTxt;
      this.GroupBox2.Text = Lang.ProtocolTxt;
      this.RadioButton1.Checked = true;
      this.RadioButton6.Checked = true;
    }

    private void Button1_Click(object sender, EventArgs e)
    {
      string text = this.Button1.Text;
      this.Button1.Text = Lang.ButtonRuns;
      this.Button1.Enabled = false;
      this.TextBoxePID.Text = "";
      this.TextBoxHwid.Text = "";
      this.TextBoxePID.Refresh();
      this.TextBoxHwid.Refresh();
      if (Operators.CompareString(this.TextBoxIP.Text, "", false) == 0)
        return;
      this.TextBoxIP.Focus();
      FileSystem.ChDir(this.Tempdir);
      if (!File.Exists(this.Tempdir + "\\kmsclient\\KMSClient.exe"))
      {
        while (!File.Exists(this.Tempdir + "\\kmsclient.dat"))
        {
          MyProject.Computer.FileSystem.WriteAllBytes("kmsclient.dat", KMSAuto_Net.My.Resources.Resources.kmsclient, false);
          Application.DoEvents();
        }
        Interaction.Shell(this.SysPath + "cmd.exe /c kmsclient.dat -y -pkmsauto", AppWinStyle.Hide, true);
        MyProject.Forms.Form1.DelFile("kmsclient.dat");
      }
      FileSystem.ChDir(this.Tempdir + "\\kmsclient");
      Interaction.Shell(this.SysPath + "cmd.exe /c KMSClient.exe " + Strings.Trim(this.TextBoxIP.Text) + ":" + Strings.Trim(this.TextBoxPort.Text) + " " + this._product + " " + this._protocol + " > output.txt", AppWinStyle.Hide, true);
      string String1 = Strings.Replace(MyProject.Computer.FileSystem.ReadAllText("output.txt", Encoding.Default), "\r\n", "");
      int num1 = Strings.InStr(1, String1, "->");
      if (num1 > 0)
      {
        string str1 = String1.Remove(0, checked (num1 + 2));
        int num2 = Strings.InStr(1, str1, " ");
        if (num2 == 0)
        {
          string pid = str1;
          if (Operators.ConditionalCompareObjectEqual(this.CheckPidFormat(pid), (object) 0, false))
            this.TextBoxePID.Text = pid;
        }
        else
        {
          string pid = Strings.Mid(str1, 1, checked (num2 - 1));
          if (Operators.ConditionalCompareObjectEqual(this.CheckPidFormat(pid), (object) 0, false))
            this.TextBoxePID.Text = pid;
          string str2 = str1.Remove(0, checked (num2 + 1));
          int num3 = Strings.InStr(1, str2, ")");
          string input = Strings.Mid(str2, 1, checked (num3 - 1));
          if (new Regex("^[0-9a-fA-F]{16}$").IsMatch(input))
            this.TextBoxHwid.Text = input;
        }
      }
      if (this.CheckBox1.Checked)
      {
        string str = "IP: " + this.TextBoxIP.Text + " Port: " + this.TextBoxPort.Text + " Product: " + this._memo + " Protocol: " + this._memoprot + "\r\n" + "ePID: " + this.TextBoxePID.Text + " Hwid: " + this.TextBoxHwid.Text + "\r\n\r\n";
        StreamWriter streamWriter = new StreamWriter(Application.StartupPath + "\\KMSServers.txt", true, Encoding.GetEncoding("utf-8"));
        streamWriter.Write(str);
        streamWriter.Close();
      }
      this.TextBoxIP.Focus();
      this.Button1.Enabled = true;
      this.Button1.Text = text;
      this.Button1.Refresh();
    }

    private object CheckPidFormat(string pid) => new Regex("^[0-9]{5}-[0-9]{5}-[0-9]{3}-[0-9]{6}-[0-9]{2,3}-[0-9]{3,5}-[0-9]{4,5}.[0-9]{4}-[0-9]{7}$").IsMatch(Strings.UCase(Strings.Trim(pid))) ? (object) 0 : (object) (int) byte.MaxValue;

    private void RadioButton1_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton1.Checked)
        return;
      if (this.CheckBox2.Checked)
      {
        this._product = "-l 17";
        this._memo = "Windows Enterprise 2016 LTSB";
      }
      else
      {
        this._product = "-l Windows";
        this._memo = "Windows";
      }
      this.CheckBox2.Enabled = true;
    }

    private void RadioButton2_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton2.Checked)
        return;
      this._product = "-l O14";
      this._memo = "Office 2010";
      this.CheckBox2.Enabled = false;
    }

    private void RadioButton3_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton3.Checked)
        return;
      this._product = "-l O15";
      this._memo = "Office 2013";
      this.CheckBox2.Enabled = false;
    }

    private void RadioButton7_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton7.Checked)
        return;
      this._product = "-l O16";
      this._memo = "Office 2016";
      this.CheckBox2.Enabled = false;
    }

    private void RadioButton4_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton4.Checked)
        return;
      this._protocol = "-4";
      this._memoprot = "V4";
    }

    private void RadioButton5_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton5.Checked)
        return;
      this._protocol = "-5";
      this._memoprot = "V5";
    }

    private void RadioButton6_CheckedChanged(object sender, EventArgs e)
    {
      if (!this.RadioButton6.Checked)
        return;
      this._protocol = "-6";
      this._memoprot = "V6";
    }

    private void CheckBox2_CheckedChanged(object sender, EventArgs e) => this.RadioButton1_CheckedChanged(RuntimeHelpers.GetObjectValue(sender), e);
  }
}
