// Decompiled with JetBrains decompiler
// Type: BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO
// Assembly: Ajowans, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B9451E92-9872-44E9-A53B-32BF899B0E6F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-PSW.Win32.Stealer.gen-ca27c07cc9fddcd8bc07b2b9aa3406ab019fb54797bf2163b190217e9c17ce6a.exe

using Ajowans;
using System;

public struct BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO : IDisposable
{
  public static readonly int BCRYPT_INIT_AUTH_MODE_INFO_VERSION = TemplateService.RegisterFile(2020);
  public int cbSize;
  public int dwInfoVersion;
  public IntPtr pbNonce;
  public int cbNonce;
  public IntPtr pbAuthData;
  public int cbAuthData;
  public IntPtr pbTag;
  public int cbTag;
  public IntPtr pbMacContext;
  public int cbMacContext;
  public int cbAAD;
  public long cbData;
  public int dwFlags;

  public BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO(byte[] iv, byte[] aad, byte[] tag)
    : this()
  {
    this.dwInfoVersion = BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO.BCRYPT_INIT_AUTH_MODE_INFO_VERSION;
    // ISSUE: type reference
    this.cbSize = ToolbarEventArgs.RegisterFile(GroupType.RegisterFile(__typeref (BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO)));
    if (iv != null)
    {
label_1:
      switch (3)
      {
        case 0:
          goto label_1;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO.\u002Ector);
          }
          this.cbNonce = iv.Length;
          this.pbNonce = ResourceInvoker.RegisterFile(this.cbNonce);
          ActivatorInfo.RegisterFile(iv, TemplateService.RegisterFile(2008), this.pbNonce, this.cbNonce);
          break;
      }
    }
    if (aad != null)
    {
label_6:
      switch (6)
      {
        case 0:
          goto label_6;
        default:
          this.cbAuthData = aad.Length;
          this.pbAuthData = ResourceInvoker.RegisterFile(this.cbAuthData);
          ActivatorInfo.RegisterFile(aad, TemplateService.RegisterFile(2012), this.pbAuthData, this.cbAuthData);
          break;
      }
    }
    if (tag == null)
      return;
label_9:
    switch (5)
    {
      case 0:
        goto label_9;
      default:
        this.cbTag = tag.Length;
        this.pbTag = ResourceInvoker.RegisterFile(this.cbTag);
        ActivatorInfo.RegisterFile(tag, TemplateService.RegisterFile(2016), this.pbTag, this.cbTag);
        this.cbMacContext = tag.Length;
        this.pbMacContext = ResourceInvoker.RegisterFile(this.cbMacContext);
        break;
    }
  }

  public void Dispose()
  {
    if (PageEditor.RegisterFile(this.pbNonce, IntPtr.Zero))
    {
label_1:
      switch (4)
      {
        case 0:
          goto label_1;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO.Dispose);
          }
          ControlQueue.RegisterFile(this.pbNonce);
          break;
      }
    }
    if (PageEditor.RegisterFile(this.pbTag, IntPtr.Zero))
    {
label_6:
      switch (1)
      {
        case 0:
          goto label_6;
        default:
          ControlQueue.RegisterFile(this.pbTag);
          break;
      }
    }
    if (PageEditor.RegisterFile(this.pbAuthData, IntPtr.Zero))
    {
label_9:
      switch (2)
      {
        case 0:
          goto label_9;
        default:
          ControlQueue.RegisterFile(this.pbAuthData);
          break;
      }
    }
    if (!PageEditor.RegisterFile(this.pbMacContext, IntPtr.Zero))
      return;
label_12:
    switch (6)
    {
      case 0:
        goto label_12;
      default:
        ControlQueue.RegisterFile(this.pbMacContext);
        break;
    }
  }
}
