// Decompiled with JetBrains decompiler
// Type: 首干歹文豸人屮冂黃巛足缶.禾立襾皿囗衣鬥衣示夊宀厶頁
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Runtime.InteropServices;

namespace 首干歹文豸人屮冂黃巛足缶
{
  public static class 禾立襾皿囗衣鬥衣示夊宀厶頁
  {
    public const uint 里曰殳月心疒豆支攴干鹵彡食廾玄力 = 0;
    public const uint 鳥幺一土毋八巛己犬凵白匸鼠 = 8;
    public const uint 二火人几高士虍二干匚馬止亠 = 4;
    public static readonly byte[] 丨匕尢生辵几石甘弓冂彡匸雨 = BitConverter.GetBytes(1296188491);
    public static readonly string 自冖甘皮方幺木小攴水方木 = "ObjectLength";
    public static readonly string 爻手隶辵止黃儿支火貝夊 = "ChainingModeGCM";
    public static readonly string 巛疋豸日羽宀宀黽雨鬼戶里方 = "AuthTagLength";
    public static readonly string 黹白身爿爻虫心長革屮己方 = "ChainingMode";
    public static readonly string 网干門木亠方皿尸辰舟月爪大 = "KeyDataBlob";
    public static readonly string 十龠乙言戈土寸土門手大 = "AES";
    public static readonly string 比凵釆鼎彳曰辵支言足凵穴片斤匚足 = "Microsoft Primitive Provider";
    public static readonly int 弋皮隶齊牙羊豕十爻甘凵骨車 = 1;
    public static readonly int 八巛亠香广比鳥巾乙无攴龜韋聿 = 1;
    public static readonly uint 高比耳彐鼓爿牛弓行聿 = 3221266434;

    [DllImport("bcrypt.dll", EntryPoint = "BCryptOpenAlgorithmProvider")]
    public static extern uint 米鬲馬父見丿而豸女臣巛(
      out IntPtr 黃厂曰冂亅弋儿幺欠厂骨邑,
      [MarshalAs(UnmanagedType.LPWStr)] string 殳力几甘韭鬼爪子禾人見走身女凵几,
      [MarshalAs(UnmanagedType.LPWStr)] string 毋耳十疋土豕匚田曰辛斗彡丶大欠,
      uint 鼻幺巾鹵日身寸厂力宀小网屮爿毋);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptCloseAlgorithmProvider")]
    public static extern uint 文歹瓦見匚麻首气尢水十殳工弓(IntPtr 穴巛豕虫力而夂黹水尸, uint 欠爻女舛身鬲鬲鼎臣耒火豸弓);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptGetProperty")]
    public static extern uint 釆彐尢豆火几己水木片支(
      IntPtr 鼻韭刀辛谷爿毛囗斗斗釆音羊,
      [MarshalAs(UnmanagedType.LPWStr)] string 羽身邑耳瓦皮攴文屮比,
      byte[] 曰幺牙卩十一立人卩气釆艸身,
      int 血鹿舟鬲里戶斤革八水,
      ref int 弋厶鬲寸缶里鼎老戶骨老角匸斤,
      uint 氏竹木月曰舟巛丨网黽小爪囗父);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptSetProperty")]
    internal static extern uint 鼓又月耒犬殳鳥艮己酉貝工鬥女(
      IntPtr 髟大屮水方鼎丨邑寸气无艮,
      [MarshalAs(UnmanagedType.LPWStr)] string 木臣隹女鬥鼠食麥至火老,
      byte[] 止黑工弋目玄斗用疒矛囗,
      int 夂犬而玄瓜彐日戈巛足尸廴戶鬯,
      int 卩鬯廾豕士鳥豸豕身臣木竹玉);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptImportKey")]
    public static extern uint 玄干彡廴老靑立乙几文彐黍(
      IntPtr 亠工十歹禾牙八殳隹穴,
      IntPtr 卜宀鬼攴冂冖艮門鬲皮山,
      [MarshalAs(UnmanagedType.LPWStr)] string 色頁氏耳木毛方乙广十寸豆老髟,
      out IntPtr 子心至工自冂寸辰屮牙,
      IntPtr 己戈斤女麻彳缶瓜幺干心弓,
      int 口水車矢隹高香香夂丨,
      byte[] 戶卩爪方辵目寸冫耒勹米,
      int 麥尢寸示文瓜龜山非音弓刀鼠火隹,
      uint 几玉走鹵爿雨几鼓水羽鬼);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptDestroyKey")]
    public static extern uint 癶襾幺口巛鼓又至亅己二尢(IntPtr 口囗支虍見己屮斗彳豕甘止食);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptEncrypt")]
    public static extern uint 鼓屮彐二辛匕隶水士血曰阜(
      IntPtr 豸八方疒疋斗十角彳爿夂,
      byte[] 目鼓二巛自黃入邑干龍老,
      int 刀力八木勹虍刀冫皿虍癶冫,
      ref 禾立襾皿囗衣鬥衣示夊宀厶頁.爻子自厶夕長士勹尸雨 爻斤玄羽立欠丶癶人广夂廴匸夂文鼻,
      byte[] 歹舟禾亠尸首巾凵攴白方冖爪,
      int 鼓戈卜工弓彡耒皿音寸馬,
      byte[] 囗歹髟土隶小皮長皿几,
      int 彡二己入木文色牙广酉瓦冖廾,
      ref int 爪一里八飛屮癶山土冂,
      uint 日舛糸靑广犬聿卜戈月爻氏鬲戶);

    [DllImport("bcrypt.dll", EntryPoint = "BCryptDecrypt")]
    internal static extern uint 八鹵冖气爿匚勹勹勹門歹(
      IntPtr 手鬲火玄殳鬥冂冖行山龍,
      byte[] 冖二凵高邑无黹彐甘竹手匚戈,
      int 儿心女弓足手彐鬼毋彳艮虍女匚鹿艸,
      ref 禾立襾皿囗衣鬥衣示夊宀厶頁.爻子自厶夕長士勹尸雨 土丿弓瓜足冂廴入囗儿几辵幺比赤,
      byte[] 豕骨木屮音女口心匸彐廾卩子,
      int 子止巛飛辛八玄日无厂襾,
      byte[] 弋面戈己山弋谷夂支方土勹厂,
      int 魚目幺疒曰田尸黑犬非老糸,
      ref int 心月干巾竹牙疋屮齊色父匕皮,
      int 瓜八匕尸力父屮骨玄鬲口而);

    public struct 疋日大文士攴車宀广禾齊車黍里
    {
      [MarshalAs(UnmanagedType.LPWStr)]
      public string 幺至厂豕火豕廴釆厂弋弋瓦目氏;
      public int 广口鬲老皿音尸比寸高大色弓亠用;

      public 疋日大文士攴車宀广禾齊車黍里(string pszAlgId, int cbSalt)
      {
        this.幺至厂豕火豕廴釆厂弋弋瓦目氏 = pszAlgId;
        this.广口鬲老皿音尸比寸高大色弓亠用 = cbSalt;
      }
    }

    public struct 爻子自厶夕長士勹尸雨 : IDisposable
    {
      public int 辵匕走巛文亠齊疋里香犬羊匸;
      public int 匚弋欠攴厂殳黹邑犬飛厶牛廾;
      public IntPtr 水亠女宀毛至工穴刀穴;
      public int 禾女几卜疋邑工戈卜水比冖;
      public IntPtr 田禸勹色黃馬瓜血囗冖;
      public int 口牙爪斤立攴厂八网舌韋馬鬥女;
      public IntPtr 毋口韭士匚广麻魚矢穴面士力厂幺尢十;
      public int 彡隶臣片木尸乙火鬲广;
      public IntPtr 女夕比彳釆口牙小舟爿鬼;
      public int 彐爪彳山廴凵麥囗豕十刀飛卩至飛;
      public int 彐二聿非豸厶黃幺斤攴犬皮;
      public long 弋弓皿己寸八足黑又匚囗;
      public int 身戈鼎靑艮衣白斤酉爪厂片甘;

      public 爻子自厶夕長士勹尸雨(byte[] iv, byte[] aad, byte[] tag)
        : this()
      {
        this.匚弋欠攴厂殳黹邑犬飛厶牛廾 = 禾立襾皿囗衣鬥衣示夊宀厶頁.八巛亠香广比鳥巾乙无攴龜韋聿;
        this.辵匕走巛文亠齊疋里香犬羊匸 = Marshal.SizeOf(typeof (禾立襾皿囗衣鬥衣示夊宀厶頁.爻子自厶夕長士勹尸雨));
        if (iv != null)
        {
          this.禾女几卜疋邑工戈卜水比冖 = iv.Length;
          this.水亠女宀毛至工穴刀穴 = Marshal.AllocHGlobal(this.禾女几卜疋邑工戈卜水比冖);
          Marshal.Copy(iv, 0, this.水亠女宀毛至工穴刀穴, this.禾女几卜疋邑工戈卜水比冖);
        }
        if (aad != null)
        {
          this.口牙爪斤立攴厂八网舌韋馬鬥女 = aad.Length;
          this.田禸勹色黃馬瓜血囗冖 = Marshal.AllocHGlobal(this.口牙爪斤立攴厂八网舌韋馬鬥女);
          Marshal.Copy(aad, 0, this.田禸勹色黃馬瓜血囗冖, this.口牙爪斤立攴厂八网舌韋馬鬥女);
        }
        if (tag == null)
          return;
        this.彡隶臣片木尸乙火鬲广 = tag.Length;
        this.毋口韭士匚广麻魚矢穴面士力厂幺尢十 = Marshal.AllocHGlobal(this.彡隶臣片木尸乙火鬲广);
        Marshal.Copy(tag, 0, this.毋口韭士匚广麻魚矢穴面士力厂幺尢十, this.彡隶臣片木尸乙火鬲广);
        this.彐爪彳山廴凵麥囗豕十刀飛卩至飛 = tag.Length;
        this.女夕比彳釆口牙小舟爿鬼 = Marshal.AllocHGlobal(this.彐爪彳山廴凵麥囗豕十刀飛卩至飛);
      }

      public void Dispose()
      {
        if (this.水亠女宀毛至工穴刀穴 != IntPtr.Zero)
          Marshal.FreeHGlobal(this.水亠女宀毛至工穴刀穴);
        if (this.毋口韭士匚广麻魚矢穴面士力厂幺尢十 != IntPtr.Zero)
          Marshal.FreeHGlobal(this.毋口韭士匚广麻魚矢穴面士力厂幺尢十);
        if (this.田禸勹色黃馬瓜血囗冖 != IntPtr.Zero)
          Marshal.FreeHGlobal(this.田禸勹色黃馬瓜血囗冖);
        if (!(this.女夕比彳釆口牙小舟爿鬼 != IntPtr.Zero))
          return;
        Marshal.FreeHGlobal(this.女夕比彳釆口牙小舟爿鬼);
      }
    }

    public struct 邑二而疋力田韭匚冖厶土里
    {
      public int 弓白牙小足厂廾用爿月彳无月;
      public int 瓦牙尢疒大欠虫毋匸又自气;
      public int 幺冂襾赤手耳力谷疒二;
    }

    public struct 龠用舌干月冖香鼻羽夂夕月屮行
    {
      [MarshalAs(UnmanagedType.LPWStr)]
      public string 幺至厂豕火豕廴釆厂弋弋瓦目氏;
      public IntPtr 几勹至尸入鹿酉亠十火小干;
      public int 士二方匚爿牛斗夊彳金匸匚;

      public 龠用舌干月冖香鼻羽夂夕月屮行(string alg)
      {
        this.幺至厂豕火豕廴釆厂弋弋瓦目氏 = alg;
        this.几勹至尸入鹿酉亠十火小干 = IntPtr.Zero;
        this.士二方匚爿牛斗夊彳金匸匚 = 0;
      }
    }
  }
}
