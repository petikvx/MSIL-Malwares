// Decompiled with JetBrains decompiler
// Type: Dbasic.KeyWords.CFiles.CkwFilePut
// Assembly: B4Pruntime, Version=1.0.3056.20520, Culture=neutral, PublicKeyToken=null
// MVID: BED81B59-7EDE-4B04-983E-56C0010CF881
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Trojan-SMS.WinCE.Redoc.b-18cd0a1680457d7a4ff64f016ab2639c9c89d57bf8a7f51328c2d40bef9526f0.exe

using System;
using System.IO;

namespace Dbasic.KeyWords.CFiles
{
  public class CkwFilePut : CkeyWords
  {
    public CkwFilePut(CRunner CRunner)
      : base(CRunner)
    {
    }

    public override MethodReturn Method(Place place, ref Locals locals)
    {
      ++place.WordI;
      string key = this.CRunner.nextWord(true, ref place).Value;
      ++place.WordI;
      RunReturn runReturn1 = this.CRunner.RunCode(place, false, true, ref locals);
      place = runReturn1.place;
      long vDouble = (long) runReturn1.vDouble;
      ++place.WordI;
      string str = this.CRunner.nextWord(true, ref place).Value;
      ++place.WordI;
      FileStream htStream = (FileStream) this.CRunner.htStreams[(object) key];
      switch (str)
      {
        case "true":
          RunReturn runReturn2 = this.CRunner.RunCode(place, true, true, ref locals);
          place = runReturn2.place;
          ++place.WordI;
          byte[] bytes1 = this.CRunner.ae.GetBytes(runReturn2.vString);
          htStream.Seek(vDouble, SeekOrigin.Begin);
          htStream.Write(bytes1, 0, bytes1.Length);
          break;
        case "false":
          RunReturn runReturn3 = this.CRunner.RunCode(place, false, true, ref locals);
          place = runReturn3.place;
          ++place.WordI;
          byte[] bytes2 = BitConverter.GetBytes(runReturn3.vDouble);
          htStream.Seek(vDouble, SeekOrigin.Begin);
          htStream.Write(bytes2, 0, bytes2.Length);
          break;
      }
      return new MethodReturn(place);
    }
  }
}
