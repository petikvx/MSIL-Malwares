// Decompiled with JetBrains decompiler
// Type: System.ServiceModel.Dispatcher.NameValueCache`1
// Assembly: Microsoft.Transactions.Bridge, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 51116F84-6FE2-4BD6-A908-2C88E06F45BB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Trojan.MSIL.Picsys.gen-d64123468b2dcb11e9205288e0a6cb144a448944457a708807b7345a8a766675.exe

using System.Collections;

namespace System.ServiceModel.Dispatcher
{
  internal class NameValueCache<T>
  {
    private Hashtable cache;
    private string[] currentKeys;
    private int nextAvailableCacheIndex;
    private object cachelock;
    internal const int maxNumberofEntriesInCache = 16;

    public NameValueCache()
      : this(16)
    {
    }

    public NameValueCache(int maxCacheEntries)
    {
      this.cache = new Hashtable();
      this.currentKeys = new string[maxCacheEntries];
      this.cachelock = new object();
    }

    public T Lookup(string key) => (T) this.cache[(object) key];

    public void AddOrUpdate(string key, T value)
    {
      lock (this.cache)
      {
        if (!this.cache.ContainsKey((object) key))
        {
          if (!string.IsNullOrEmpty(this.currentKeys[this.nextAvailableCacheIndex]))
            this.cache.Remove((object) this.currentKeys[this.nextAvailableCacheIndex]);
          this.currentKeys[this.nextAvailableCacheIndex] = key;
          this.nextAvailableCacheIndex = ++this.nextAvailableCacheIndex % this.currentKeys.Length;
        }
        this.cache[(object) key] = (object) value;
      }
    }
  }
}
