// Decompiled with JetBrains decompiler
// Type: System.ServiceModel.Channels.WebScriptMetadataMessage
// Assembly: Microsoft.Transactions.Bridge, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 51116F84-6FE2-4BD6-A908-2C88E06F45BB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Trojan.MSIL.Picsys.gen-d64123468b2dcb11e9205288e0a6cb144a448944457a708807b7345a8a766675.exe

using System.Xml;

namespace System.ServiceModel.Channels
{
  internal class WebScriptMetadataMessage : BodyWriterMessage
  {
    private const string proxyContentTag = "JavaScriptProxy";
    private string proxyContent;

    public WebScriptMetadataMessage(string action, string proxyContent)
      : base(MessageVersion.None, action, (BodyWriter) new WebScriptMetadataMessage.WebScriptMetadataBodyWriter(proxyContent))
    {
      this.proxyContent = proxyContent;
    }

    protected override void OnBodyToString(XmlDictionaryWriter writer)
    {
      writer.WriteStartElement("JavaScriptProxy");
      writer.WriteCData(this.proxyContent);
      writer.WriteEndElement();
    }

    private class WebScriptMetadataBodyWriter : BodyWriter
    {
      private string proxyContent;

      public WebScriptMetadataBodyWriter(string proxyContent)
        : base(true)
      {
        this.proxyContent = proxyContent;
      }

      protected override void OnWriteBodyContents(XmlDictionaryWriter writer) => writer.WriteRaw(this.proxyContent);
    }
  }
}
