// Decompiled with JetBrains decompiler
// Type: NuGet.Common.5MzM9dUBCn
// Assembly: Ty6CWyxFEL, Version=5.0.0.2, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 271E2DAF-741A-443A-8BCF-B62C509DDC38
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan-Ransom.MSIL.Purgen.gen-185fafbeb00cd8238fdabee088763e27012dd3a0076e04dddca6266f129f0430.exe

using System;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;

namespace NuGet.Common
{
  public static class \u0035MzM9dUBCn
  {
    private const string acghlGx9GU = "2.16.840.1.101.3.4.2.1";
    private const string Jf0YiZUmpy = "2.16.840.1.101.3.4.2.2";
    private const string \u0039dnsUbTtA0 = "2.16.840.1.101.3.4.2.3";
    private const string OUTnHcPsdA = "1.2.840.113549.1.1.11";
    private const string VNLYn2BtMT = "1.2.840.113549.1.1.12";
    private const string Qqbo8Vw2ky = "1.2.840.113549.1.1.13";
    private static Lazy<bool> Hoy8rAliQR = new Lazy<bool>((Func<bool>) (() => \u0035MzM9dUBCn.\u0036KLHalAzeH()));

    public static string uKVpKozwSx(this HashAlgorithm RuveMq3eYI, Stream a0dn0W9rjL) => RuveMq3eYI.LUghAEboPo(a0dn0W9rjL, false);

    public static string LUghAEboPo(
      this HashAlgorithm ovHxZ6d51E,
      Stream aP7wHM2B7p,
      bool XjLgzDe9yS)
    {
      if (ovHxZ6d51E == null)
        throw new ArgumentNullException("hashAlgorithm");
      if (aP7wHM2B7p == null)
        throw new ArgumentNullException("data");
      try
      {
        return Convert.ToBase64String(ovHxZ6d51E.ComputeHash(aP7wHM2B7p));
      }
      finally
      {
        if (!XjLgzDe9yS)
          aP7wHM2B7p.Dispose();
      }
    }

    public static byte[] CcBRtKXAn4(this hDHGbEDW2G py7hftshbU, byte[] WtdemQq796)
    {
      using (HashAlgorithm hashAlgorithm = py7hftshbU.Guj75rEJ27())
        return hashAlgorithm.ComputeHash(WtdemQq796);
    }

    public static byte[] Cix3P4iLy9(this HashAlgorithm _param0, Stream gf7UtXX93j) => _param0.qDfTOp5i0i(gf7UtXX93j, false);

    public static byte[] qDfTOp5i0i(
      this HashAlgorithm x44SLenEco,
      Stream Y1tqzPDFtb,
      bool jhuZA0F0sV)
    {
      if (x44SLenEco == null)
        throw new ArgumentNullException("hashAlgorithm");
      if (Y1tqzPDFtb == null)
        throw new ArgumentNullException("data");
      try
      {
        return x44SLenEco.ComputeHash(Y1tqzPDFtb);
      }
      finally
      {
        if (!jhuZA0F0sV)
          Y1tqzPDFtb.Dispose();
      }
    }

    public static HashAlgorithm BwtImIeHTz(string mM4K6Wh4e6)
    {
      if (mM4K6Wh4e6 == null)
        throw new ArgumentNullException("hashAlgorithmName");
      hDHGbEDW2G result;
      Enum.TryParse<hDHGbEDW2G>(mM4K6Wh4e6, true, out result);
      return \u0035MzM9dUBCn.DyVKIBmZbz(result);
    }

    public static hDHGbEDW2G fr1BQDh8Sa(string NGEQySnKeS)
    {
      if (NGEQySnKeS == null)
        throw new ArgumentNullException("hashAlgorithm");
      hDHGbEDW2G result;
      return Enum.TryParse<hDHGbEDW2G>(NGEQySnKeS, true, out result) ? result : hDHGbEDW2G.Unknown;
    }

    public static HashAlgorithm DyVKIBmZbz(hDHGbEDW2G xLlxWhf0Kj) => xLlxWhf0Kj.Guj75rEJ27();

    public static HashAlgorithm Guj75rEJ27(this hDHGbEDW2G YS3EpfLV18)
    {
      if (\u0035MzM9dUBCn.Hoy8rAliQR.Value)
      {
        switch (YS3EpfLV18)
        {
          case hDHGbEDW2G.SHA256:
            return (HashAlgorithm) new SHA256CryptoServiceProvider();
          case hDHGbEDW2G.SHA384:
            return (HashAlgorithm) new SHA384CryptoServiceProvider();
          case hDHGbEDW2G.SHA512:
            return (HashAlgorithm) new SHA512CryptoServiceProvider();
        }
      }
      else
      {
        switch (YS3EpfLV18)
        {
          case hDHGbEDW2G.SHA256:
            return (HashAlgorithm) new SHA256Managed();
          case hDHGbEDW2G.SHA384:
            return (HashAlgorithm) new SHA384Managed();
          case hDHGbEDW2G.SHA512:
            return (HashAlgorithm) new SHA512Managed();
        }
      }
      throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.umkh2aU13H, (object) YS3EpfLV18), "hashAlgorithmName");
    }

    public static HashAlgorithm YKCSepGe7b() => \u0035MzM9dUBCn.Hoy8rAliQR.Value ? (HashAlgorithm) new SHA1CryptoServiceProvider() : (HashAlgorithm) new SHA1Managed();

    private static bool \u0036KLHalAzeH()
    {
      Type type = typeof (CryptoConfig);
      if (type != (Type) null)
      {
        PropertyInfo property = type.GetProperty("AllowOnlyFipsAlgorithms", BindingFlags.Static | BindingFlags.Public);
        if (property != (PropertyInfo) null)
          return (bool) property.GetValue((object) null, (object[]) null);
      }
      return false;
    }

    public static HashAlgorithmName hhv9gZpaZu(this hDHGbEDW2G EuKVhMeDRL)
    {
      switch (EuKVhMeDRL)
      {
        case hDHGbEDW2G.SHA256:
          return HashAlgorithmName.SHA256;
        case hDHGbEDW2G.SHA384:
          return HashAlgorithmName.SHA384;
        case hDHGbEDW2G.SHA512:
          return HashAlgorithmName.SHA512;
        default:
          throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.umkh2aU13H, (object) EuKVhMeDRL), "hashAlgorithmName");
      }
    }

    public static string Rjj8L4fVpa(this hDHGbEDW2G djaOYY0tIZ)
    {
      switch (djaOYY0tIZ)
      {
        case hDHGbEDW2G.SHA256:
          return "2.16.840.1.101.3.4.2.1";
        case hDHGbEDW2G.SHA384:
          return "2.16.840.1.101.3.4.2.2";
        case hDHGbEDW2G.SHA512:
          return "2.16.840.1.101.3.4.2.3";
        default:
          throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.umkh2aU13H, (object) djaOYY0tIZ), "hashAlgorithmName");
      }
    }

    public static Oid JYfis3uqNm(this hDHGbEDW2G oI93gu8MWO) => new Oid(oI93gu8MWO.Rjj8L4fVpa());

    public static hDHGbEDW2G yLlmEXu8se(string v9zFu4uqfB)
    {
      if (v9zFu4uqfB == "2.16.840.1.101.3.4.2.1")
        return hDHGbEDW2G.SHA256;
      if (v9zFu4uqfB == "2.16.840.1.101.3.4.2.2")
        return hDHGbEDW2G.SHA384;
      if (v9zFu4uqfB == "2.16.840.1.101.3.4.2.3")
        return hDHGbEDW2G.SHA512;
      throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.umkh2aU13H, (object) v9zFu4uqfB), "oid");
    }

    public static string P1bP66eUwj(this \u0032ED6sMWHGI _param0)
    {
      switch (_param0)
      {
        case \u0032ED6sMWHGI.SHA256RSA:
          return "1.2.840.113549.1.1.11";
        case \u0032ED6sMWHGI.SHA384RSA:
          return "1.2.840.113549.1.1.12";
        case \u0032ED6sMWHGI.SHA512RSA:
          return "1.2.840.113549.1.1.13";
        default:
          throw new ArgumentException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.\u00351CSeDD3or, (object) _param0), "signatureAlgorithmName");
      }
    }

    public static string K9FVDUNGe1(string Og83DrdbHk) => !string.IsNullOrEmpty(Og83DrdbHk) ? Convert.ToBase64String(new pCqIn8xXFE("SHA256").\u0032ju2HM0dh1(Encoding.UTF8.GetBytes(Og83DrdbHk.ToUpperInvariant()))).ToUpperInvariant() : throw new ArgumentNullException("caseInsensitiveKey");
  }
}
