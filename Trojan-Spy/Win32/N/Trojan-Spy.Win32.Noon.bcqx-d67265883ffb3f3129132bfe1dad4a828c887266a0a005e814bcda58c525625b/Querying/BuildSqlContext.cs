// Decompiled with JetBrains decompiler
// Type: Alero.Querying.BuildSqlContext
// Assembly: AssemblyCopyrightAttrib, Version=2005.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6DE54395-8B54-4A88-80DE-363C4128FB08
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\Trojan-Spy.Win32.Noon.bcqx-d67265883ffb3f3129132bfe1dad4a828c887266a0a005e814bcda58c525625b.exe

using System;
using System.Collections.Generic;
using System.Data;
using System.Text;

namespace Alero.Querying
{
  internal class BuildSqlContext
  {
    private readonly StringBuilder _builder;
    private readonly DataTool _dataTool;
    private readonly IList<IDataParameter> _parameters;
    private readonly Func<QueryTable, string> _resolveAlias;

    public BuildSqlContext(
      StringBuilder builder,
      DataTool dataTool,
      IList<IDataParameter> parameters,
      Func<QueryTable, string> resolveAlias)
    {
      this._builder = builder;
      this._dataTool = dataTool;
      this._parameters = parameters;
      this._resolveAlias = resolveAlias;
    }

    public Func<QueryTable, string> ResolveAlias => this._resolveAlias;

    public IList<IDataParameter> Parameters => this._parameters;

    public DataTool DataTool => this._dataTool;

    public StringBuilder Builder => this._builder;

    public string CreateNextParameterName() => "p" + (this.Parameters.Count + 1).ToString();
  }
}
