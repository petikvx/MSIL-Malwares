// Decompiled with JetBrains decompiler
// Type: 308586033544.Core.713980849319
// Assembly: 308586033544, Version=1.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: CD78F8E3-E5F9-41CF-8142-5EDBF93F1FF3
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-18bddfc40d40212cb2c9881929e98eb6ea1c5b6c4bd93f9aaeb774311da4a6c9.exe

using \u003076467872204;
using \u003308586033544.Core;
using \u003308586033544.Models;
using \u003308586033544.Utils;
using \u003991059796994;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003308586033544.Core
{
  public static class \u003713980849319
  {
    private static void \u003920874006559(
      string _param0,
      string _param1,
      Func<string, \u003774085998324> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003202077061547 obj1 = new \u003202077061547();
      obj1.\u003416862945060 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003202077061547 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003774085998324 obj3 = _param2(contents);
      string str1 = \u003713980849319.\u003806176146425(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003580277262990.\u003071983215550(obj3.\u003672778194609, path1);
        }
        catch (Exception ex)
        {
          ex.\u003728422119809();
          File.Delete(path1);
        }
      }
    }

    private static string \u003806176146425(\u003774085998324 _param0)
    {
      string str = Path.GetFileName(_param0.\u003672778194609).\u003785864946537();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003672778194609);
      return string.Empty;
    }

    public static void \u003065780882857()
    {
      string path1 = \u003945417024083.\u003813537083687();
      \u003108620570429 obj1 = \u003690492234521.\u003209948117012(path1);
      string str = obj1?.\u003002679366666;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003414029426080 obj2 = new \u003414029426080(str);
        ((\u003758645839473) obj2).\u003506081015529 = \u003690492234521.\u003871929630831();
        ((\u003758645839473) obj2).\u003738043047482 = obj1.\u003012493689917;
        ((\u003758645839473) obj2).\u003075121935727 = Color.DarkRed;
        ((\u003758645839473) obj2).\u003956730064580 = \u003362254670253.\u003708084326768;
        ((\u003758645839473) obj2).\u003031266325021 = \u003362254670253.\u003732365332745;
        ((\u003758645839473) obj2).\u003734456958382 = \u003362254670253.\u003897105038042;
        ((\u003758645839473) obj2).\u003556179428779 = \u003362254670253.\u003078040686781;
        ((\u003758645839473) obj2).\u003209099646904 = \u003362254670253.\u003199641886583;
        ((\u003758645839473) obj2).\u003092296119512 = \u003362254670253.\u003909310827806;
        ((\u003758645839473) obj2).\u003422621454116 = \u003362254670253.\u003453864585841;
        using (\u003758645839473 obj3 = (\u003758645839473) obj2)
        {
          using (Image image = obj3.\u003618645229423())
          {
            string filename;
            if (\u003467558368966.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003357253020150.\u003205215003380(filename);
            \u003357253020150.\u003787571960182(filename);
          }
        }
      }
    }
  }
}
