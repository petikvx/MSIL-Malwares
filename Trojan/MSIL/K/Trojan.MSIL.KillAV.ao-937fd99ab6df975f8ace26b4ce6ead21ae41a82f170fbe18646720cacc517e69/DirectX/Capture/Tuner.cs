// Decompiled with JetBrains decompiler
// Type: DirectX.Capture.Tuner
// Assembly: yes, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 83EB8C5F-168C-47FA-93FE-E25AA6C64B02
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00004-msil\Trojan.MSIL.KillAV.ao-937fd99ab6df975f8ace26b4ce6ead21ae41a82f170fbe18646720cacc517e69.exe

using DShowNET;
using System;
using System.Runtime.InteropServices;

namespace DirectX.Capture
{
  public class Tuner : IDisposable
  {
    protected IAMTVTuner tvTuner = (IAMTVTuner) null;

    public Tuner(IAMTVTuner tuner) => this.tvTuner = tuner;

    public int Channel
    {
      get
      {
        int plChannel;
        this.tvTuner.get_Channel(out plChannel, out int _, out int _);
        return plChannel;
      }
      set => this.tvTuner.put_Channel(value, AMTunerSubChannel.Default, AMTunerSubChannel.Default);
    }

    public TunerInputType InputType
    {
      get
      {
        DShowNET.TunerInputType inputType;
        this.tvTuner.get_InputType(0, out inputType);
        return (TunerInputType) inputType;
      }
      set => this.tvTuner.put_InputType(0, (DShowNET.TunerInputType) value);
    }

    public bool SignalPresent
    {
      get
      {
        AMTunerSignalStrength plSignalStrength;
        int errorCode = this.tvTuner.SignalPresent(out plSignalStrength);
        if (errorCode != 0)
          Marshal.ThrowExceptionForHR(errorCode);
        return plSignalStrength == AMTunerSignalStrength.SignalPresent;
      }
    }

    public void Dispose()
    {
      if (this.tvTuner != null)
        Marshal.ReleaseComObject((object) this.tvTuner);
      this.tvTuner = (IAMTVTuner) null;
    }
  }
}
