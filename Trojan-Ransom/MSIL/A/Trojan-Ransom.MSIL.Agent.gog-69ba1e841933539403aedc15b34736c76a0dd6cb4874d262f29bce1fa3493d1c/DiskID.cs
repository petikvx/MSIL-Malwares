// Decompiled with JetBrains decompiler
// Type: CryptoNar.DiskID
// Assembly: kasperskytrialreset, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 35F54376-B284-4294-89A4-F0FFEE9E54ED
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\Trojan-Ransom.MSIL.Agent.gog-69ba1e841933539403aedc15b34736c76a0dd6cb4874d262f29bce1fa3493d1c.exe

using System.IO;
using System.Management;

namespace CryptoNar
{
  internal class DiskID
  {
    public static string getDiskID() => DiskID.DiskId();

    public static string getDiskID(string diskLetter) => DiskID.DiskId(diskLetter);

    private static string DiskId() => DiskID.DiskId("");

    private static string DiskId(string diskLetter)
    {
      if (diskLetter == "")
      {
        foreach (DriveInfo drive in DriveInfo.GetDrives())
        {
          if (drive.IsReady)
          {
            diskLetter = drive.RootDirectory.ToString();
            break;
          }
        }
      }
      if (diskLetter.EndsWith(":\\"))
        diskLetter = diskLetter.Substring(0, diskLetter.Length - 2);
      ManagementObject managementObject = new ManagementObject("win32_logicaldisk.deviceid=\"" + diskLetter + ":\"");
      managementObject.Get();
      string str = managementObject["VolumeSerialNumber"].ToString();
      managementObject.Dispose();
      return str;
    }
  }
}
