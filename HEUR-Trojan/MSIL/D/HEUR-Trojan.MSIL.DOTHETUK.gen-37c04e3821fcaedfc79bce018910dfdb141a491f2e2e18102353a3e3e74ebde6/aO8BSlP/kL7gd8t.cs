// Decompiled with JetBrains decompiler
// Type: aO8BSlP.kL7gd8t
// Assembly: aO8BSlP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0a613f4dd989e8ae
// MVID: 26D80EA7-FF8D-466E-8999-D26AD81041E3
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.DOTHETUK.gen-37c04e3821fcaedfc79bce018910dfdb141a491f2e2e18102353a3e3e74ebde6.exe

using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Threading;

namespace aO8BSlP
{
  public class kL7gd8t
  {
    private const uint oYIXmWm = 1024;
    private const uint BpNrQea = 1024;
    private const byte jiJy291 = 1;
    private const byte yZUSyhB = 2;
    private const byte xHQVXsC = 3;
    private const byte DISP0oN = 4;
    private const byte YmzgV12 = 6;
    private const byte ibJnvsM = 7;
    private const byte \u0038s5PrFK = 9;
    private const byte GNfcz3V = 11;
    private const byte QH4IQ7w = 12;
    private const byte D60p3KH = 16;
    private const byte Fd6bUD4 = 47;
    private const byte gSxvLI1 = 48;
    private const byte lVfq0GU = 56;
    private const byte \u0036wcnTJQ = 64;
    private const byte tj4bCz5 = 65;
    private const byte TZVOpiZ = 66;
    private const byte MTvW4TJ = 67;
    private const byte GHnhG3v = 68;
    private const byte FRkj6YJ = 80;
    private const byte TLg3DDG = 96;
    private const byte \u0037gZI6EM = 112;
    private const byte u5TxmNA = 137;
    private const byte lfZMS7h = 153;
    private const byte o75xs5m = 154;
    private const byte ikXTBQq = 17;
    private const byte \u0031g0yMp1 = 170;
    private const byte AOnkpa5 = 187;
    private const byte QDIOler = 204;
    private const byte CWO1uhG = 255;
    private const byte N8JGYdL = 176;
    private const byte mxtqq8p = 189;
    private const byte gUR2t5y = 128;
    private const byte XuZkTVM = 129;
    private const byte hXM2CUJ = 130;
    private static readonly byte[] i3FQKkv = new byte[1]
    {
      (byte) 130
    };
    private const byte \u0035y8opU6 = 3;
    private const byte vgbKttz = 5;
    private const byte dZAEUUn = 6;
    private const byte R7Kdgbx = 7;
    private bool pwrTw85;
    private bool \u00372FjmjN;
    [SpecialName]
    public int value__;

    private event KdyVUyw fIi5LFN;

    public event KdyVUyw bT0ft1V
    {
      add => ((MkuYxgd) this).add_PChunkUpdate(value);
      remove => this.fIi5LFN -= value;
    }

    public bool xrOVnex => this.pwrTw85;

    public bool ITzzgYe
    {
      get => this.\u00372FjmjN;
      set => this.\u00372FjmjN = value;
    }

    public string dvtUEgU
    {
      get => ((\u0036s75b5n) ((MkuYxgd) this).lLZQJmL).get_Host();
      set
      {
        if (this.pwrTw85)
          return;
        ((MkuYxgd) this).lLZQJmL = new PEVgeMN(value, ((MkuYxgd) this).lLZQJmL.YdioLuX);
      }
    }

    public kL7gd8t(string host, int port)
    {
      ((MkuYxgd) this).lLZQJmL = new PEVgeMN(host, port);
      this.pwrTw85 = false;
      // ISSUE: reference to a compiler-generated field
      this.tIdduwR = (KdyVUyw) null;
    }

    ~kL7gd8t()
    {
      if (!this.pwrTw85)
        return;
      this.IvfbI3G();
    }

    protected bool InitGecko() => true;

    public bool gZpBSO7()
    {
      if (this.pwrTw85)
        this.IvfbI3G();
      this.pwrTw85 = false;
      try
      {
        ((MkuYxgd) this).lLZQJmL.\u0037LC4bD0();
      }
      catch (IOException ex)
      {
        this.IvfbI3G();
        throw new MkuYxgd(n9VibSs.noTCPGeckoFound);
      }
      if (!this.InitGecko())
        return false;
      Thread.Sleep(150);
      this.pwrTw85 = true;
      return true;
    }

    public void IvfbI3G()
    {
      this.pwrTw85 = false;
      ((MkuYxgd) this).lLZQJmL.MYW7CN9();
    }

    protected RRaHOsy GeckoRead(byte[] recbyte, uint nobytes)
    {
      uint num = 0;
      try
      {
        ((MkuYxgd) this).lLZQJmL.aO7wQuD(recbyte, nobytes, ref num);
      }
      catch (IOException ex)
      {
        this.IvfbI3G();
        return RRaHOsy.CMD_FatalError;
      }
      return (int) num != (int) nobytes ? RRaHOsy.CMD_ResultError : RRaHOsy.CMD_OK;
    }

    protected RRaHOsy GeckoWrite(byte[] sendbyte, int nobytes)
    {
      uint Eu0xSpZ = 0;
      try
      {
        ((MkuYxgd) this).lLZQJmL.\u0031flHLkD(sendbyte, nobytes, ref Eu0xSpZ);
      }
      catch (IOException ex)
      {
        this.IvfbI3G();
        return RRaHOsy.CMD_FatalError;
      }
      return (long) Eu0xSpZ != (long) nobytes ? RRaHOsy.CMD_ResultError : RRaHOsy.CMD_OK;
    }

    protected void SendUpdate(
      uint address,
      uint currentchunk,
      uint allchunks,
      uint transferred,
      uint length,
      bool okay,
      bool dump)
    {
      // ISSUE: reference to a compiler-generated field
      if (this.tIdduwR == null)
        return;
      // ISSUE: reference to a compiler-generated field
      this.tIdduwR(address, currentchunk, allchunks, transferred, length, okay, dump);
    }

    public void BLy8srX(El7FP86 wugZeem) => this.IXHQAxL(wugZeem.q6fxack, wugZeem.nQv7JRM, wugZeem);

    public void V7q8faG(uint tOA8G1D, uint WbH4KrL, Stream xtsIpRH)
    {
      Stream[] FEsLrrP = new Stream[1]{ xtsIpRH };
      this.DaLHZY8(tOA8G1D, WbH4KrL, FEsLrrP);
    }

    public void DaLHZY8(uint dxUcmJ4, uint arpCMZO, Stream[] FEsLrrP)
    {
      this.InitGecko();
      if (qHGycoT.yNzjSJB(dxUcmJ4) != qHGycoT.yNzjSJB(arpCMZO))
        arpCMZO = qHGycoT.x0PINd1[qHGycoT.yNzjSJB(dxUcmJ4)].cGwLOYd;
      if (!qHGycoT.TrDOr18(dxUcmJ4))
        return;
      uint num1 = arpCMZO - dxUcmJ4;
      uint num2 = num1 / 1024U;
      uint num3 = num1 % 1024U;
      uint num4 = num2;
      if (num3 > 0U)
        ++num4;
      ulong num5 = h2jtVt2.\u00386UfUKU(((ulong) dxUcmJ4 << 32) + (ulong) arpCMZO);
      if (this.GeckoWrite(BitConverter.GetBytes((short) 4), 1) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num5), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      uint currentchunk = 0;
      byte num6 = 0;
      bool flag = false;
      this.ITzzgYe = false;
      byte[] numArray = new byte[1024];
      while (currentchunk < num2 && !flag)
      {
        this.SendUpdate(dxUcmJ4 + currentchunk * 1024U, currentchunk, num4, currentchunk * 1024U, num1, num6 == (byte) 0, true);
        byte[] recbyte = new byte[1];
        if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        {
          int num7 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          throw new MkuYxgd(n9VibSs.FTDIReadDataError);
        }
        if (recbyte[0] == (byte) 176)
        {
          for (int index = 0; index < 1024; ++index)
            numArray[index] = (byte) 0;
        }
        else
        {
          switch (this.GeckoRead(numArray, 1024U))
          {
            case RRaHOsy.CMD_ResultError:
              ++num6;
              if (num6 >= (byte) 3)
              {
                int num8 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
                throw new MkuYxgd(n9VibSs.TooManyRetries);
              }
              continue;
            case RRaHOsy.CMD_FatalError:
              int num9 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          }
        }
        foreach (Stream stream in FEsLrrP)
          stream.Write(numArray, 0, 1024);
        num6 = (byte) 0;
        ++currentchunk;
        if (this.ITzzgYe)
        {
          int num10 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          flag = true;
        }
      }
      while (!flag && num3 > 0U)
      {
        this.SendUpdate(dxUcmJ4 + currentchunk * 1024U, currentchunk, num4, currentchunk * 1024U, num1, num6 == (byte) 0, true);
        byte[] recbyte = new byte[1];
        if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        {
          int num11 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          throw new MkuYxgd(n9VibSs.FTDIReadDataError);
        }
        if (recbyte[0] == (byte) 176)
        {
          for (int index = 0; (long) index < (long) num3; ++index)
            numArray[index] = (byte) 0;
        }
        else
        {
          switch (this.GeckoRead(numArray, num3))
          {
            case RRaHOsy.CMD_ResultError:
              ++num6;
              if (num6 >= (byte) 3)
              {
                int num12 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
                throw new MkuYxgd(n9VibSs.TooManyRetries);
              }
              continue;
            case RRaHOsy.CMD_FatalError:
              int num13 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          }
        }
        foreach (Stream stream in FEsLrrP)
          stream.Write(numArray, 0, (int) num3);
        num6 = (byte) 0;
        flag = true;
      }
      this.SendUpdate(arpCMZO, num4, num4, num1, num1, true, true);
    }

    public void IXHQAxL(uint _param1, uint FSS8MiT, El7FP86 GIJvtjN)
    {
      this.InitGecko();
      uint num1 = FSS8MiT - _param1;
      uint num2 = num1 / 1024U;
      uint num3 = num1 % 1024U;
      uint num4 = num2;
      if (num3 > 0U)
        ++num4;
      ulong num5 = h2jtVt2.\u00386UfUKU(((ulong) _param1 << 32) + (ulong) FSS8MiT);
      if (this.GeckoWrite(BitConverter.GetBytes((short) 4), 1) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num5), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      uint currentchunk = 0;
      byte num6 = 0;
      bool flag = false;
      this.ITzzgYe = false;
      byte[] numArray = new byte[1024];
      while (currentchunk < num2 && !flag)
      {
        this.SendUpdate(_param1 + currentchunk * 1024U, currentchunk, num4, currentchunk * 1024U, num1, num6 == (byte) 0, true);
        byte[] recbyte = new byte[1];
        if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        {
          int num7 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          throw new MkuYxgd(n9VibSs.FTDIReadDataError);
        }
        if (recbyte[0] == (byte) 176)
        {
          for (int index = 0; index < 1024; ++index)
            numArray[index] = (byte) 0;
        }
        else
        {
          switch (this.GeckoRead(numArray, 1024U))
          {
            case RRaHOsy.CMD_ResultError:
              ++num6;
              if (num6 >= (byte) 3)
              {
                int num8 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
                throw new MkuYxgd(n9VibSs.TooManyRetries);
              }
              continue;
            case RRaHOsy.CMD_FatalError:
              int num9 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          }
        }
        Buffer.BlockCopy((Array) numArray, 0, (Array) ((PEVgeMN) GIJvtjN).Ei3M8cS, (int) currentchunk * 1024 + ((int) _param1 - (int) GIJvtjN.q6fxack), 1024);
        GIJvtjN.UMWwls3 = (uint) (((int) currentchunk + 1) * 1024) + _param1;
        num6 = (byte) 0;
        ++currentchunk;
        if (this.ITzzgYe)
        {
          int num10 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          flag = true;
        }
      }
      while (!flag && num3 > 0U)
      {
        this.SendUpdate(_param1 + currentchunk * 1024U, currentchunk, num4, currentchunk * 1024U, num1, num6 == (byte) 0, true);
        byte[] recbyte = new byte[1];
        if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        {
          int num11 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
          throw new MkuYxgd(n9VibSs.FTDIReadDataError);
        }
        if (recbyte[0] == (byte) 176)
        {
          for (int index = 0; (long) index < (long) num3; ++index)
            numArray[index] = (byte) 0;
        }
        else
        {
          switch (this.GeckoRead(numArray, num3))
          {
            case RRaHOsy.CMD_ResultError:
              ++num6;
              if (num6 >= (byte) 3)
              {
                int num12 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
                throw new MkuYxgd(n9VibSs.TooManyRetries);
              }
              continue;
            case RRaHOsy.CMD_FatalError:
              int num13 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          }
        }
        Buffer.BlockCopy((Array) numArray, 0, (Array) ((PEVgeMN) GIJvtjN).Ei3M8cS, (int) currentchunk * 1024 + ((int) _param1 - (int) GIJvtjN.q6fxack), (int) num3);
        num6 = (byte) 0;
        flag = true;
      }
      this.SendUpdate(FSS8MiT, num4, num4, num1, num1, true, true);
    }

    public void OL90QCv(uint NT0z52G, uint BnHdK81, Stream iAzNQUJ)
    {
      this.InitGecko();
      uint num1 = BnHdK81 - NT0z52G;
      uint num2 = num1 / 1024U;
      uint length = num1 % 1024U;
      uint num3 = num2;
      if (length > 0U)
        ++num3;
      ulong num4 = h2jtVt2.\u00386UfUKU(((ulong) NT0z52G << 32) + (ulong) BnHdK81);
      if (this.GeckoWrite(BitConverter.GetBytes((short) 65), 1) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num4), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      uint currentchunk = 0;
      byte num5 = 0;
      while (currentchunk < num2)
      {
        this.SendUpdate(NT0z52G + currentchunk * 1024U, currentchunk, num3, currentchunk * 1024U, num1, num5 == (byte) 0, false);
        byte[] numArray = new byte[1024];
        iAzNQUJ.Read(numArray, 0, 1024);
        switch (this.GeckoWrite(numArray, 1024))
        {
          case RRaHOsy.CMD_ResultError:
            ++num5;
            if (num5 >= (byte) 3)
            {
              this.IvfbI3G();
              throw new MkuYxgd(n9VibSs.TooManyRetries);
            }
            iAzNQUJ.Seek(-1024L, SeekOrigin.Current);
            continue;
          case RRaHOsy.CMD_FatalError:
            this.IvfbI3G();
            throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          default:
            num5 = (byte) 0;
            ++currentchunk;
            continue;
        }
      }
      while (length > 0U)
      {
        this.SendUpdate(NT0z52G + currentchunk * 1024U, currentchunk, num3, currentchunk * 1024U, num1, num5 == (byte) 0, false);
        byte[] numArray = new byte[(int) length];
        iAzNQUJ.Read(numArray, 0, (int) length);
        switch (this.GeckoWrite(numArray, (int) length))
        {
          case RRaHOsy.CMD_ResultError:
            ++num5;
            if (num5 >= (byte) 3)
            {
              this.IvfbI3G();
              throw new MkuYxgd(n9VibSs.TooManyRetries);
            }
            iAzNQUJ.Seek((long) (-1 * (int) length), SeekOrigin.Current);
            continue;
          case RRaHOsy.CMD_FatalError:
            this.IvfbI3G();
            throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          default:
            num5 = (byte) 0;
            length = 0U;
            continue;
        }
      }
      byte[] recbyte = new byte[1];
      if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDIReadDataError);
      if (recbyte[0] != (byte) 170)
        throw new MkuYxgd(n9VibSs.FTDIInvalidReply);
      this.SendUpdate(BnHdK81, num3, num3, num1, num1, true, false);
    }

    public bool l2hOjSl()
    {
      this.IvfbI3G();
      try
      {
        return this.gZpBSO7();
      }
      catch
      {
        return false;
      }
    }

    public RRaHOsy KgnsZFA(byte yunrH5s) => this.GeckoWrite(BitConverter.GetBytes((short) yunrH5s), 1);

    public void \u0039E6BYfB()
    {
      if (this.KgnsZFA((byte) 6) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void snI2b0c()
    {
      for (bool flag = this.Aw15C7s() == ncwXY7k.Running; flag; flag = this.Aw15C7s() == ncwXY7k.Running)
      {
        this.\u0039E6BYfB();
        Thread.Sleep(100);
      }
    }

    public void jkHI3ei()
    {
      if (this.KgnsZFA((byte) 7) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void v6HX2ur()
    {
      int num = (int) this.KgnsZFA((byte) 204);
    }

    public void Fh8dJwO(uint fK6n16O, uint _param2)
    {
      fK6n16O &= 4294967292U;
      ulong num = h2jtVt2.\u00386UfUKU((ulong) fK6n16O << 32 | (ulong) _param2);
      if (this.KgnsZFA((byte) 3) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void R78x93s(uint UGksQko, uint QT8SdCC) => this.Fh8dJwO(UGksQko, QT8SdCC);

    public void xIH1CqQ(uint v5rnk6L, ushort SoIC1jm)
    {
      v5rnk6L &= 4294967294U;
      ulong num = h2jtVt2.\u00386UfUKU((ulong) v5rnk6L << 32 | (ulong) SoIC1jm);
      if (this.KgnsZFA((byte) 2) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void wBlvmpF(uint oTcRjY2, byte _param2)
    {
      ulong num = h2jtVt2.\u00386UfUKU((ulong) oTcRjY2 << 32 | (ulong) _param2);
      if (this.KgnsZFA((byte) 1) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void \u0035cepfWl(uint _param1, uint _param2)
    {
      ulong num = h2jtVt2.\u00386UfUKU((ulong) _param1 << 32 | (ulong) _param2);
      if (this.KgnsZFA((byte) 11) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num), 8) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public uint KbuHJfx(uint _param1)
    {
      _param1 = h2jtVt2.YLbxkec(_param1);
      if (this.KgnsZFA((byte) 12) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(_param1), 4) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      byte[] recbyte = new byte[4];
      return this.GeckoRead(recbyte, 4U) == RRaHOsy.CMD_OK ? h2jtVt2.YLbxkec(BitConverter.ToUInt32(recbyte, 0)) : throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public ncwXY7k Aw15C7s()
    {
      Thread.Sleep(100);
      if (!this.InitGecko())
        throw new MkuYxgd(n9VibSs.FTDIResetError);
      if (this.KgnsZFA((byte) 80) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      byte[] recbyte = new byte[1];
      if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDIReadDataError);
      switch (recbyte[0])
      {
        case 0:
          return ncwXY7k.Running;
        case 1:
          return ncwXY7k.Paused;
        case 2:
          return ncwXY7k.Breakpoint;
        case 3:
          return ncwXY7k.Loader;
        default:
          return ncwXY7k.Unknown;
      }
    }

    public void fre6GyB()
    {
      if (!this.InitGecko())
        throw new MkuYxgd(n9VibSs.FTDIResetError);
      if (this.KgnsZFA((byte) 68) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    protected void Breakpoint(uint address, byte bptype, bool exact)
    {
      this.InitGecko();
      uint mCU4ryn = address & 4294967288U | (uint) bptype;
      bool flag = false;
      if (exact)
        flag = this.\u0032SgKbGc() != (byte) 129;
      if (!flag)
      {
        if (this.KgnsZFA((byte) 9) != RRaHOsy.CMD_OK)
          throw new MkuYxgd(n9VibSs.FTDICommandSendError);
        if (this.GeckoWrite(BitConverter.GetBytes(h2jtVt2.YLbxkec(mCU4ryn)), 4) != RRaHOsy.CMD_OK)
          throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      }
      else
      {
        if (this.KgnsZFA((byte) 137) != RRaHOsy.CMD_OK)
          throw new MkuYxgd(n9VibSs.FTDICommandSendError);
        if (this.GeckoWrite(BitConverter.GetBytes(h2jtVt2.\u00386UfUKU((ulong) mCU4ryn << 32 | (ulong) address)), 8) != RRaHOsy.CMD_OK)
          throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      }
    }

    public void FeoGyaH(uint Wvmc8pe, bool SzNEzbH) => this.Breakpoint(Wvmc8pe, (byte) 5, SzNEzbH);

    public void inuXLim(uint _param1) => this.Breakpoint(_param1, (byte) 5, true);

    public void siq4AiO(uint xY765P7, bool Ffiiil8) => this.Breakpoint(xY765P7, (byte) 6, Ffiiil8);

    public void pb0IVWC(uint XXC0LB6) => this.Breakpoint(XXC0LB6, (byte) 6, true);

    public void j0xfeEy(uint zbGTNKR, bool _param2) => this.Breakpoint(zbGTNKR, (byte) 7, _param2);

    public void XPmTTl6(uint _param1) => this.Breakpoint(_param1, (byte) 7, true);

    public void q1U8KU6(uint _param1)
    {
      this.InitGecko();
      uint num = h2jtVt2.YLbxkec((uint) ((int) _param1 & -4 | 3));
      if (this.KgnsZFA((byte) 16) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(BitConverter.GetBytes(num), 4) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public bool EKWzzg7()
    {
      byte[] recbyte = new byte[1];
      return this.GeckoRead(recbyte, 1U) == RRaHOsy.CMD_OK && recbyte[0] == (byte) 17;
    }

    public void MjxqCYt()
    {
      if (this.KgnsZFA((byte) 56) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    protected bool AllowedVersion(byte version)
    {
      for (int index = 0; index < kL7gd8t.i3FQKkv.Length; ++index)
      {
        if ((int) kL7gd8t.i3FQKkv[index] == (int) version)
          return true;
      }
      return false;
    }

    public byte \u0032SgKbGc()
    {
      this.InitGecko();
      if (this.KgnsZFA((byte) 153) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      byte num1 = 0;
      byte num2 = 0;
      byte[] recbyte = new byte[1];
      while (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK || !this.AllowedVersion(recbyte[0]))
      {
        ++num1;
        if (num1 >= (byte) 3)
          goto label_6;
      }
      num2 = recbyte[0];
label_6:
      return num2;
    }

    public uint \u0032JRGe0Z()
    {
      if (this.KgnsZFA((byte) 154) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      byte[] recbyte = new byte[4];
      return this.GeckoRead(recbyte, 4U) == RRaHOsy.CMD_OK ? h2jtVt2.YLbxkec(BitConverter.ToUInt32(recbyte, 0)) : throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public uint LSePyHn(uint TPeGPSB)
    {
      if (!qHGycoT.TrDOr18(TPeGPSB))
        return 0;
      uint tOA8G1D = TPeGPSB & 4294967292U;
      MemoryStream xtsIpRH = new MemoryStream();
      // ISSUE: reference to a compiler-generated field
      KdyVUyw tIdduwR = this.tIdduwR;
      // ISSUE: reference to a compiler-generated field
      this.tIdduwR = (KdyVUyw) null;
      try
      {
        this.V7q8faG(tOA8G1D, tOA8G1D + 4U, (Stream) xtsIpRH);
        xtsIpRH.Seek(0L, SeekOrigin.Begin);
        byte[] buffer = new byte[4];
        xtsIpRH.Read(buffer, 0, 4);
        return h2jtVt2.YLbxkec(BitConverter.ToUInt32(buffer, 0));
      }
      finally
      {
        // ISSUE: reference to a compiler-generated field
        this.tIdduwR = tIdduwR;
        xtsIpRH.Close();
      }
    }

    public void YZnLiHa(Stream V41tL9G, uint LH1isVs)
    {
      uint num = 432;
      MemoryStream xtsIpRH = new MemoryStream();
      this.V7q8faG(LH1isVs + 8U, LH1isVs + 8U + num, (Stream) xtsIpRH);
      byte[] array = xtsIpRH.ToArray();
      V41tL9G.Write(array, 128, 4);
      V41tL9G.Write(array, 140, 4);
      V41tL9G.Write(array, 136, 4);
      V41tL9G.Write(new byte[8], 0, 8);
      V41tL9G.Write(array, 144, 8);
      V41tL9G.Write(array, 0, 128);
      V41tL9G.Write(array, 132, 4);
      V41tL9G.Write(array, 176, 256);
    }

    public void wyMhDre(Stream Sxl5VKw, uint dnwHDKe)
    {
      MemoryStream iAzNQUJ = new MemoryStream();
      byte[] buffer = new byte[160];
      Sxl5VKw.Seek(0L, SeekOrigin.Begin);
      Sxl5VKw.Read(buffer, 0, buffer.Length);
      iAzNQUJ.Write(buffer, 28, 128);
      iAzNQUJ.Write(buffer, 0, 4);
      iAzNQUJ.Write(buffer, 156, 4);
      iAzNQUJ.Write(buffer, 8, 4);
      iAzNQUJ.Write(buffer, 4, 4);
      iAzNQUJ.Write(buffer, 20, 8);
      iAzNQUJ.Seek(0L, SeekOrigin.Begin);
      this.OL90QCv(dnwHDKe + 8U, (uint) ((int) dnwHDKe + 8 + 152), (Stream) iAzNQUJ);
    }

    private ulong Nt6cgd2(Stream KUDZXQ6)
    {
      byte[] buffer = new byte[8];
      KUDZXQ6.Read(buffer, 0, 8);
      return h2jtVt2.\u00386UfUKU(BitConverter.ToUInt64(buffer, 0));
    }

    private void \u00347kgClz(Stream rUhkUNC, ulong ZhC9zHM)
    {
      byte[] bytes = BitConverter.GetBytes(h2jtVt2.\u00386UfUKU(ZhC9zHM));
      rUhkUNC.Write(bytes, 0, 8);
    }

    private void \u0033oFtp5U(Stream E5PgIya, ulong TJ90vbq)
    {
      MemoryStream rUhkUNC = new MemoryStream();
      this.\u00347kgClz((Stream) rUhkUNC, TJ90vbq);
      E5PgIya.Seek(0L, SeekOrigin.Begin);
      byte[] buffer1 = new byte[E5PgIya.Length];
      E5PgIya.Read(buffer1, 0, (int) E5PgIya.Length);
      rUhkUNC.Write(buffer1, 0, (int) E5PgIya.Length);
      E5PgIya.Seek(0L, SeekOrigin.Begin);
      rUhkUNC.Seek(0L, SeekOrigin.Begin);
      byte[] buffer2 = new byte[rUhkUNC.Length];
      rUhkUNC.Read(buffer2, 0, (int) rUhkUNC.Length);
      E5PgIya.Write(buffer2, 0, (int) rUhkUNC.Length);
      rUhkUNC.Close();
    }

    public void \u0038uXNgVn(Stream VkvlPdv)
    {
      MemoryStream memoryStream = new MemoryStream();
      byte[] buffer = new byte[VkvlPdv.Length];
      VkvlPdv.Seek(0L, SeekOrigin.Begin);
      VkvlPdv.Read(buffer, 0, (int) VkvlPdv.Length);
      memoryStream.Write(buffer, 0, (int) VkvlPdv.Length);
      if ((uint) memoryStream.Length % 8U > 0U)
      {
        memoryStream.Close();
        throw new MkuYxgd(n9VibSs.CheatStreamSizeInvalid);
      }
      this.InitGecko();
      memoryStream.Seek(-8L, SeekOrigin.End);
      ulong num1 = this.Nt6cgd2((Stream) memoryStream) & 18302628885633695744UL;
      if (num1 != 17293822569102704640UL && num1 != 18302628885633695744UL)
      {
        memoryStream.Seek(0L, SeekOrigin.End);
        this.\u00347kgClz((Stream) memoryStream, 17293822569102704640UL);
      }
      memoryStream.Seek(0L, SeekOrigin.Begin);
      if (this.Nt6cgd2((Stream) memoryStream) != 58758854884770014UL)
        this.\u0033oFtp5U((Stream) memoryStream, 58758854884770014UL);
      memoryStream.Seek(0L, SeekOrigin.Begin);
      uint length1 = (uint) memoryStream.Length;
      if (this.GeckoWrite(BitConverter.GetBytes((short) 64), 1) != RRaHOsy.CMD_OK)
      {
        memoryStream.Close();
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      }
      uint num2 = length1 / 1024U;
      uint length2 = length1 % 1024U;
      uint num3 = num2;
      if (length2 > 0U)
        ++num3;
      byte num4 = 0;
      while (num4 < (byte) 10)
      {
        byte[] recbyte = new byte[1];
        if (this.GeckoRead(recbyte, 1U) != RRaHOsy.CMD_OK)
        {
          memoryStream.Close();
          throw new MkuYxgd(n9VibSs.FTDIReadDataError);
        }
        if (recbyte[0] != (byte) 170)
        {
          if (num4 == (byte) 9)
          {
            memoryStream.Close();
            throw new MkuYxgd(n9VibSs.FTDIInvalidReply);
          }
        }
        else
          break;
      }
      if (this.GeckoWrite(BitConverter.GetBytes(h2jtVt2.YLbxkec(length1)), 4) != RRaHOsy.CMD_OK)
      {
        memoryStream.Close();
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      }
      uint currentchunk = 0;
      byte num5 = 0;
      while (currentchunk < num2)
      {
        this.SendUpdate(13680862U, currentchunk, num3, currentchunk * 1024U, length1, num5 == (byte) 0, false);
        byte[] numArray = new byte[1024];
        memoryStream.Read(numArray, 0, 1024);
        switch (this.GeckoWrite(numArray, 1024))
        {
          case RRaHOsy.CMD_ResultError:
            ++num5;
            if (num5 >= (byte) 3)
            {
              int num6 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              memoryStream.Close();
              throw new MkuYxgd(n9VibSs.TooManyRetries);
            }
            memoryStream.Seek(-1024L, SeekOrigin.Current);
            int num7 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 187), 1);
            continue;
          case RRaHOsy.CMD_FatalError:
            int num8 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
            memoryStream.Close();
            throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          default:
            byte[] recbyte = new byte[1];
            RRaHOsy rraHosy = this.GeckoRead(recbyte, 1U);
            if (rraHosy == RRaHOsy.CMD_ResultError || recbyte[0] != (byte) 170)
            {
              ++num5;
              if (num5 >= (byte) 3)
              {
                int num9 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
                memoryStream.Close();
                throw new MkuYxgd(n9VibSs.TooManyRetries);
              }
              memoryStream.Seek(-1024L, SeekOrigin.Current);
              int num10 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 187), 1);
              continue;
            }
            if (rraHosy == RRaHOsy.CMD_FatalError)
            {
              int num11 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              memoryStream.Close();
              throw new MkuYxgd(n9VibSs.FTDIReadDataError);
            }
            num5 = (byte) 0;
            ++currentchunk;
            continue;
        }
      }
      while (length2 > 0U)
      {
        this.SendUpdate(13680862U, currentchunk, num3, currentchunk * 1024U, length1, num5 == (byte) 0, false);
        byte[] numArray = new byte[(int) length2];
        memoryStream.Read(numArray, 0, (int) length2);
        switch (this.GeckoWrite(numArray, (int) length2))
        {
          case RRaHOsy.CMD_ResultError:
            ++num5;
            if (num5 >= (byte) 3)
            {
              int num12 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
              memoryStream.Close();
              throw new MkuYxgd(n9VibSs.TooManyRetries);
            }
            memoryStream.Seek((long) (-1 * (int) length2), SeekOrigin.Current);
            int num13 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 187), 1);
            continue;
          case RRaHOsy.CMD_FatalError:
            int num14 = (int) this.GeckoWrite(BitConverter.GetBytes((short) 204), 1);
            memoryStream.Close();
            throw new MkuYxgd(n9VibSs.FTDIReadDataError);
          default:
            num5 = (byte) 0;
            length2 = 0U;
            continue;
        }
      }
      this.SendUpdate(13680862U, num3, num3, length1, length1, true, false);
      memoryStream.Close();
    }

    public void \u0035pB94k7()
    {
      if (this.KgnsZFA((byte) 96) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public void xnJrm89(bool UWTljWu, \u0039V728pz ucsty2t, twQ3Lvl ML0qM1c, SFGdAQM A7ih6m7)
    {
      // ISSUE: unable to decompile the method.
    }

    public void EizM7a0() => this.xnJrm89(false, \u0039V728pz.NoOverride, twQ3Lvl.NoPatches, (SFGdAQM) 0);

    private static byte BnnlMYJ(double L3RhOPW) => (byte) Math.Round(Math.Max(0.0, Math.Min(L3RhOPW, (double) byte.MaxValue)));

    private static Bitmap AjuzW5D(uint DrqGwsY, uint _param1, Stream hKvWr9m)
    {
      Bitmap bitmap = new Bitmap((int) DrqGwsY, (int) _param1, PixelFormat.Format24bppRgb);
      BitmapData bitmapdata = bitmap.LockBits(new Rectangle(0, 0, (int) DrqGwsY, (int) _param1), ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
      int length = bitmapdata.Stride * bitmapdata.Height;
      byte[] numArray = new byte[length];
      Marshal.Copy(bitmapdata.Scan0, numArray, 0, length);
      byte[] buffer = new byte[(int) DrqGwsY * (int) _param1 * 2];
      int num1 = 0;
      int num2 = 0;
      hKvWr9m.Read(buffer, 0, (int) DrqGwsY * (int) _param1 * 2);
      for (int index1 = 0; (long) index1 < (long) (DrqGwsY * _param1); ++index1)
      {
        int index2 = index1 * 2;
        int num3;
        if (index1 % 2 == 0)
        {
          num3 = (int) buffer[index2];
          num1 = (int) buffer[index2 + 1];
          num2 = (int) buffer[index2 + 3];
        }
        else
          num3 = (int) buffer[index2];
        int index3 = index1 * 3;
        numArray[index3] = kL7gd8t.BnnlMYJ(1.164 * (double) (num3 - 16) + 2.017 * (double) (num1 - 128));
        numArray[index3 + 1] = kL7gd8t.BnnlMYJ(1.164 * (double) (num3 - 16) - 0.392 * (double) (num1 - 128) - 0.813 * (double) (num2 - 128));
        numArray[index3 + 2] = kL7gd8t.BnnlMYJ(1.164 * (double) (num3 - 16) + 1.596 * (double) (num2 - 128));
      }
      Marshal.Copy(numArray, 0, bitmapdata.Scan0, numArray.Length);
      bitmap.UnlockBits(bitmapdata);
      return bitmap;
    }

    public Image \u0034nzlg8A()
    {
      MemoryStream xtsIpRH = new MemoryStream();
      this.V7q8faG(3422560256U, 3422560384U, (Stream) xtsIpRH);
      xtsIpRH.Seek(0L, SeekOrigin.Begin);
      byte[] buffer = new byte[128];
      xtsIpRH.Read(buffer, 0, 128);
      xtsIpRH.Close();
      uint DrqGwsY = (uint) buffer[73] << 3;
      uint num1 = (uint) (((int) buffer[0] << 5 | (int) buffer[1] >> 3) & 2046);
      uint num2 = (uint) ((int) buffer[29] << 16 | (int) buffer[30] << 8) | (uint) buffer[31];
      if (((int) buffer[28] & 16) == 16)
        num2 <<= 5;
      uint tOA8G1D = num2 + 2147483648U - (uint) (((int) buffer[28] & 15) << 3);
      MemoryStream memoryStream = new MemoryStream();
      this.V7q8faG(tOA8G1D, tOA8G1D + (uint) ((int) num1 * (int) DrqGwsY * 2), (Stream) memoryStream);
      memoryStream.Seek(0L, SeekOrigin.Begin);
      if (num1 > 600U)
      {
        num1 /= 2U;
        DrqGwsY *= 2U;
      }
      Bitmap bitmap = kL7gd8t.AjuzW5D(DrqGwsY, num1, (Stream) memoryStream);
      memoryStream.Close();
      return (Image) bitmap;
    }

    public uint yryunr0(uint _param1, params uint[] MSGUYEw) => (uint) (this.Dp7OVFM(_param1, MSGUYEw) >> 32);

    public ulong Dp7OVFM(uint uR9jkpB, params uint[] ltLCxHj)
    {
      byte[] numArray = new byte[36];
      uR9jkpB = h2jtVt2.YLbxkec(uR9jkpB);
      BitConverter.GetBytes(uR9jkpB).CopyTo((Array) numArray, 0);
      for (int index = 0; index < 8; ++index)
      {
        if (index < ltLCxHj.Length)
          BitConverter.GetBytes(h2jtVt2.YLbxkec(ltLCxHj[index])).CopyTo((Array) numArray, 4 + index * 4);
        else
          BitConverter.GetBytes(4274704570U).CopyTo((Array) numArray, 4 + index * 4);
      }
      if (this.KgnsZFA((byte) 112) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      if (this.GeckoWrite(numArray, numArray.Length) != RRaHOsy.CMD_OK)
        throw new MkuYxgd(n9VibSs.FTDICommandSendError);
      return this.GeckoRead(numArray, 8U) == RRaHOsy.CMD_OK ? h2jtVt2.\u00386UfUKU(BitConverter.ToUInt64(numArray, 0)) : throw new MkuYxgd(n9VibSs.FTDICommandSendError);
    }

    public static string LEJ3Rfe(this kpByqel ZonWRtd)
    {
      // ISSUE: unable to decompile the method.
    }
  }
}
