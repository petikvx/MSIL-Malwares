// Decompiled with JetBrains decompiler
// Type: System.ServiceModel.Dispatcher.XmlFormatMapping
// Assembly: Microsoft.Transactions.Bridge, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 51116F84-6FE2-4BD6-A908-2C88E06F45BB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Trojan.MSIL.Picsys.gen-d64123468b2dcb11e9205288e0a6cb144a448944457a708807b7345a8a766675.exe

using System.Collections.Generic;
using System.ServiceModel.Channels;
using System.ServiceModel.Web;
using System.Text;
using System.Xml;

namespace System.ServiceModel.Dispatcher
{
  internal class XmlFormatMapping : MultiplexingFormatMapping
  {
    public static readonly WebContentFormat WebContentFormat = WebContentFormat.Xml;
    internal static readonly string defaultMediaType = "application/xml";
    private static Dictionary<Encoding, MessageEncoder> encoders = new Dictionary<Encoding, MessageEncoder>();
    private static object thisLock = new object();

    public XmlFormatMapping(Encoding writeEncoding, WebContentTypeMapper contentTypeMapper)
      : base(writeEncoding, contentTypeMapper)
    {
    }

    public override WebContentFormat ContentFormat => XmlFormatMapping.WebContentFormat;

    public override WebMessageFormat MessageFormat => WebMessageFormat.Xml;

    public override string DefaultMediaType => XmlFormatMapping.defaultMediaType;

    protected override MessageEncoder Encoder
    {
      get
      {
        lock (XmlFormatMapping.thisLock)
        {
          if (!XmlFormatMapping.encoders.ContainsKey(this.writeEncoding))
            XmlFormatMapping.encoders[this.writeEncoding] = new TextMessageEncoderFactory(MessageVersion.None, this.writeEncoding, 0, 0, new XmlDictionaryReaderQuotas()).Encoder;
        }
        return XmlFormatMapping.encoders[this.writeEncoding];
      }
    }
  }
}
