// Decompiled with JetBrains decompiler
// Type: s466143199922215.s101203479051678
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s414525256739179;
using s466558934198787;
using s610860560643463;
using s906544051652269;
using s919558378989182;
using System;
using System.Collections.Generic;
using System.Linq;

namespace s466143199922215
{
  internal class s101203479051678
  {
    private Dictionary<long, s829309465128072> s559383409710728 = new Dictionary<long, s829309465128072>();

    public event s793364290519797 s218323746345124;

    public event Action<int> s041611038962265;

    public unsafe void s305444101909534(byte[] s380451770675370)
    {
      if (s380451770675370.Length < 20)
        return;
      ushort uint16 = BitConverter.ToUInt16(s380451770675370, 0);
      if (uint16 < (ushort) 20 || (int) uint16 > s380451770675370.Length)
        return;
      bool s191853348030531 = ((uint) BitConverter.ToUInt16(s380451770675370, 2) & 1U) > 0U;
      s005935631257636 buffer = new s005935631257636(s380451770675370);
      byte* numPtr1 = (byte*) (void*) buffer.s365574410438182.AddrOfPinnedObject();
      byte* numPtr2 = numPtr1 + s380451770675370.Length;
      byte* s135984641315428 = numPtr1 + (int) uint16;
      s288580493007869 s288580493007869_1 = new s288580493007869(buffer);
      long s525011883431003 = 0;
      s958455347864096.s731246557716044(s135984641315428, s191853348030531, ref s288580493007869_1.s767008718830934);
      s829309465128072 s250023208074355;
      if (!this.s559383409710728.TryGetValue(s288580493007869_1.s767008718830934.s863109335858573, out s250023208074355))
      {
        s250023208074355 = new s829309465128072();
        s250023208074355.s443267668138585 = s288580493007869_1.s767008718830934.s625661375402922 - 1;
        this.s900025158965174(s288580493007869_1.s767008718830934.s863109335858573, s250023208074355);
      }
      s288580493007869 s288580493007869_2 = new s288580493007869(buffer);
      while (s135984641315428 < numPtr2)
      {
        s958455347864096.s731246557716044(s135984641315428, s191853348030531, ref s288580493007869_2.s767008718830934);
        bool s574210321631356 = s288580493007869_2.s767008718830934.s574210321631356;
        s525011883431003 = s288580493007869_2.s767008718830934.s364664394996257;
        int s625661375402922 = s288580493007869_2.s767008718830934.s625661375402922;
        if (s574210321631356)
        {
          s250023208074355.s860424491315702 = s525011883431003;
          long s863109335858573 = s288580493007869_2.s767008718830934.s863109335858573;
          if (!this.s559383409710728.TryGetValue(s863109335858573, out s250023208074355))
          {
            s250023208074355 = new s829309465128072();
            s250023208074355.s443267668138585 = s625661375402922 - 1;
            this.s900025158965174(s863109335858573, s250023208074355);
          }
        }
        int num = Math.Min(int.MaxValue, s625661375402922 - s250023208074355.s443267668138585 - 1);
        if (num > 0)
        {
          // ISSUE: reference to a compiler-generated field
          Action<int> s050569887123608 = this.s050569887123608;
          if (s050569887123608 != null)
            s050569887123608(num);
        }
        s250023208074355.s443267668138585 = s625661375402922;
        if (s574210321631356)
        {
          this.s351091705126534(s525011883431003);
          // ISSUE: reference to a compiler-generated field
          s793364290519797 s267262922964786 = this.s267262922964786;
          if (s267262922964786 != null)
            s267262922964786(ref s288580493007869_2.s767008718830934);
        }
        else
          s250023208074355.s304683734500765.Enqueue(s288580493007869_2);
        s135984641315428 += s288580493007869_2.s767008718830934.s035621129284973 + s288580493007869_2.s767008718830934.s448996038667544;
        s288580493007869 s288580493007869_3 = s288580493007869_2;
        s288580493007869_2 = new s288580493007869(buffer);
        s288580493007869_2.s767008718830934 = s288580493007869_3.s767008718830934;
      }
      s250023208074355.s860424491315702 = s525011883431003;
    }

    public void s224529928985646(byte[] s805775951107364)
    {
      if (s805775951107364.Length < 12)
        return;
      long int64_1 = BitConverter.ToInt64(s805775951107364, 0);
      int int32_1 = BitConverter.ToInt32(s805775951107364, 8);
      if (s805775951107364.Length < 12 + int32_1 * 12)
        return;
      this.s351091705126534(int64_1);
      foreach (s829309465128072 s829309465128072 in this.s559383409710728.Values)
      {
        s829309465128072.s304683734500765.Clear();
        s829309465128072.s304683734500765.TrimExcess();
      }
      int startIndex = 12;
      for (int index = 0; index < int32_1; ++index)
      {
        long int64_2 = BitConverter.ToInt64(s805775951107364, startIndex);
        int int32_2 = BitConverter.ToInt32(s805775951107364, startIndex + 8);
        s829309465128072 s250023208074355;
        if (!this.s559383409710728.TryGetValue(int64_2, out s250023208074355))
        {
          if (int32_2 > 0)
          {
            // ISSUE: reference to a compiler-generated field
            Action<int> s050569887123608 = this.s050569887123608;
            if (s050569887123608 != null)
              s050569887123608(int32_2);
          }
          s250023208074355 = new s829309465128072();
          s250023208074355.s443267668138585 = int32_2;
          this.s900025158965174(int64_2, s250023208074355);
        }
        else
        {
          int num = int32_2 - s250023208074355.s443267668138585;
          if (num > 0)
          {
            // ISSUE: reference to a compiler-generated field
            Action<int> s050569887123608 = this.s050569887123608;
            if (s050569887123608 != null)
              s050569887123608(num);
          }
          s250023208074355.s443267668138585 = int32_2;
        }
        startIndex += 12;
      }
    }

    public void s009822143604953() => this.s351091705126534(long.MaxValue);

    private void s351091705126534(long s525011883431003)
    {
      List<Queue<s288580493007869>> s288580493007869QueueList = new List<Queue<s288580493007869>>(this.s559383409710728.Values.Select<s829309465128072, Queue<s288580493007869>>((Func<s829309465128072, Queue<s288580493007869>>) (s688312391060204 => s688312391060204.s304683734500765)));
      while (true)
      {
        s288580493007869 s288580493007869;
        s793364290519797 s267262922964786;
        do
        {
          long num = s525011883431003;
          Queue<s288580493007869> s288580493007869Queue1 = (Queue<s288580493007869>) null;
          foreach (Queue<s288580493007869> s288580493007869Queue2 in s288580493007869QueueList)
          {
            if (s288580493007869Queue2.Count != 0)
            {
              long s364664394996257 = s288580493007869Queue2.Peek().s767008718830934.s364664394996257;
              if (s364664394996257 < num)
              {
                s288580493007869Queue1 = s288580493007869Queue2;
                num = s364664394996257;
              }
            }
          }
          if (s288580493007869Queue1 != null)
          {
            s288580493007869 = s288580493007869Queue1.Dequeue();
            // ISSUE: reference to a compiler-generated field
            s267262922964786 = this.s267262922964786;
          }
          else
            goto label_11;
        }
        while (s267262922964786 == null);
        s267262922964786(ref s288580493007869.s767008718830934);
      }
label_11:
      foreach (Queue<s288580493007869> s288580493007869Queue in s288580493007869QueueList)
      {
        if (s288580493007869Queue.Count == 0)
          s288580493007869Queue.TrimExcess();
      }
    }

    private void s900025158965174(long s403565078515043, s829309465128072 s250023208074355)
    {
      if (this.s559383409710728.Count >= 5000)
      {
        long key = -1;
        long num = long.MaxValue;
        foreach (KeyValuePair<long, s829309465128072> keyValuePair in this.s559383409710728)
        {
          if (keyValuePair.Value.s860424491315702 < num)
          {
            num = keyValuePair.Value.s860424491315702;
            key = keyValuePair.Key;
          }
        }
        this.s559383409710728.Remove(key);
      }
      this.s559383409710728[s403565078515043] = s250023208074355;
    }
  }
}
