// Decompiled with JetBrains decompiler
// Type: s734618759500808.s678074709954240
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using FastSerialization;
using System;
using System.Collections.Generic;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Text;

namespace s734618759500808
{
  [DefaultMember("Item")]
  public sealed class s678074709954240 : IFastSerializable
  {
    internal List<KeyValuePair<string, string>> s340019491851298;
    internal string s258919244574388;
    internal Func<string, string> s254699368225822;

    public s678074709954240()
    {
      this.s340019491851298 = new List<KeyValuePair<string, string>>();
      this.s254699368225822 = new Func<string, string>(this.s992223842997435);
    }

    public string get_Item(string kernelName) => this.s254699368225822(kernelName);

    internal string s992223842997435(string s193279764183624)
    {
      if (this.s340019491851298.Count == 0)
        this.s210365452239780();
      int num1 = s193279764183624.IndexOf("\\OS\\Windows\\", StringComparison.OrdinalIgnoreCase);
      if (0 <= num1 && num1 + 3 < s193279764183624.Length)
        return this.s258919244574388 + s193279764183624.Substring(num1 + 3);
      int num2 = s193279764183624.IndexOf("\\Files\\Windows\\", StringComparison.OrdinalIgnoreCase);
      if (0 <= num2 && num2 + 6 < s193279764183624.Length)
        return this.s258919244574388 + s193279764183624.Substring(num2 + 6);
      for (int index = 0; index < this.s340019491851298.Count; ++index)
      {
        KeyValuePair<string, string> keyValuePair = this.s340019491851298[index];
        string key = keyValuePair.Key;
        if (string.Compare(s193279764183624, 0, key, 0, key.Length, StringComparison.OrdinalIgnoreCase) == 0)
        {
          keyValuePair = this.s340019491851298[index];
          return keyValuePair.Value + s193279764183624.Substring(key.Length);
        }
      }
      return s193279764183624.Length > 2 && s193279764183624[0] == '\\' && char.IsLetterOrDigit(s193279764183624[1]) ? this.s258919244574388 + s193279764183624 : s193279764183624;
    }

    internal void s210365452239780()
    {
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\??\\", ""));
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\SystemRoot\\", Environment.GetEnvironmentVariable("SystemRoot") + "\\"));
      StringBuilder s065100810085170 = new StringBuilder(2048);
      int num = s678074709954240.s789671725758258();
      char c = 'A';
      while (num != 0)
      {
        if ((num & 1) != 0)
        {
          string s781630555180511 = new string(c, 1) + ":";
          s065100810085170.Length = 0;
          if (s678074709954240.s006096722972954(s781630555180511, s065100810085170, 2048) != 0U)
            this.s340019491851298.Add(new KeyValuePair<string, string>(s065100810085170.ToString() + "\\", s781630555180511 + "\\"));
        }
        num >>= 1;
        ++c;
      }
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\Device\\LanmanRedirector\\", "\\\\"));
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\Device\\Mup\\", "\\\\"));
      string str = Environment.GetEnvironmentVariable("windir") + "\\";
      this.s258919244574388 = str.Substring(0, 2);
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\Windows\\", str));
      this.s340019491851298.Add(new KeyValuePair<string, string>("\\\\", "\\\\"));
    }

    internal void s814726217488455(string s469563443941812, string s598697377051225) => this.s340019491851298.Add(new KeyValuePair<string, string>(s469563443941812, s598697377051225));

    internal void s171215739674602(string s237288800368235)
    {
      this.s814726217488455("\\Windows\\", s237288800368235);
      this.s258919244574388 = s237288800368235.Substring(0, 2);
    }

    [DllImport("kernel32.dll", EntryPoint = "QueryDosDeviceW", CharSet = CharSet.Unicode, SetLastError = true)]
    private static extern uint s006096722972954(
      string s781630555180511,
      StringBuilder s065100810085170,
      int s905531174497176);

    [DllImport("kernel32.dll", EntryPoint = "GetLogicalDrives", SetLastError = true)]
    private static extern int s789671725758258();

    void IFastSerializable.s232866562122215(Serializer s750491552461586)
    {
      s750491552461586.Write(this.s340019491851298.Count);
      foreach (KeyValuePair<string, string> keyValuePair in this.s340019491851298)
      {
        s750491552461586.Write(keyValuePair.Key);
        s750491552461586.Write(keyValuePair.Value);
      }
      s750491552461586.Write(this.s258919244574388);
    }

    void IFastSerializable.s751384913819237(Deserializer s458247780588219)
    {
      int num;
      s458247780588219.Read(ref num);
      for (int index = 0; index < num; ++index)
      {
        string key;
        s458247780588219.Read(ref key);
        string str;
        s458247780588219.Read(ref str);
        this.s340019491851298.Add(new KeyValuePair<string, string>(key, str));
      }
      s458247780588219.Read(ref this.s258919244574388);
    }
  }
}
