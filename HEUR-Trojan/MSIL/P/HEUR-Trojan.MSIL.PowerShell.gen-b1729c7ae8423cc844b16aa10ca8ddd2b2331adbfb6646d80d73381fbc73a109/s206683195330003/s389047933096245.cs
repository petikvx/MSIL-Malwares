// Decompiled with JetBrains decompiler
// Type: s206683195330003.s389047933096245
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s430663705211726;
using s851819648760407;
using System;
using System.Collections.Generic;
using System.IO;
using System.Text.RegularExpressions;

namespace s206683195330003
{
  public abstract class s389047933096245
  {
    private string s663017534793675;
    private s435790585148060 s632367196984283;
    private List<Tuple<string, string>> s075493501261709;
    private bool s938607740932392;

    public string s560808724730221 { get; set; }

    public string s804769078966272 => this.s663017534793675;

    public virtual Guid s956138111746114 => Guid.Empty;

    public virtual int s516659163850869 => 1;

    public s435790585148060 s606395693751712 => this.s632367196984283;

    public abstract s541749027096251 s905849806653393(
      uint s703204887421142,
      int s121841411091721);

    protected virtual string GetSourceLinkJson() => (string) null;

    protected s389047933096245(s435790585148060 reader, string path)
    {
      this.s663017534793675 = path;
      this.s632367196984283 = reader;
    }

    internal TextWriter s067303396426305 => this.s632367196984283.s472927214603781;

    internal string s476717391864204(string s294690768757560)
    {
      if (!this.s938607740932392)
      {
        this.s938607740932392 = true;
        string sourceLinkJson = this.GetSourceLinkJson();
        if (sourceLinkJson != null)
          this.s075493501261709 = this.s807541173771547(sourceLinkJson);
      }
      if (this.s075493501261709 != null)
      {
        foreach (Tuple<string, string> tuple in this.s075493501261709)
        {
          string str1 = tuple.Item1;
          string str2 = tuple.Item2;
          if (s294690768757560.StartsWith(str1, StringComparison.OrdinalIgnoreCase))
          {
            string newValue = s294690768757560.Substring(str1.Length, s294690768757560.Length - str1.Length).Replace('\\', '/');
            return str2.Replace("*", newValue);
          }
        }
      }
      return (string) null;
    }

    private List<Tuple<string, string>> s807541173771547(string s633503270612449)
    {
      List<Tuple<string, string>> tupleList = (List<Tuple<string, string>>) null;
      Match match = Regex.Match(s633503270612449, "documents.?\\s*:\\s*{(.*?)}", RegexOptions.Singleline);
      if (match.Success)
      {
        for (string str1 = match.Groups[1].Value; !string.IsNullOrWhiteSpace(str1); str1 = match.Groups[3].Value)
        {
          match = Regex.Match(match.Groups[1].Value, "^\\s*\"(.*?)\"\\s*:\\s*\"(.*?)\"\\s*,?(.*)", RegexOptions.Singleline);
          if (match.Success)
          {
            if (tupleList == null)
              tupleList = new List<Tuple<string, string>>();
            string str2 = match.Groups[1].Value.Replace("\\\\", "\\");
            if (str2.EndsWith("*"))
            {
              string str3 = str2.Substring(0, str2.Length - 1);
              tupleList.Add(new Tuple<string, string>(str3, match.Groups[2].Value));
            }
            else
              this.s067303396426305.WriteLine("Warning: {0} does not end in *, skipping this mapping.", (object) str2);
          }
          else
          {
            this.s067303396426305.WriteLine("Error: Could not parse SourceLink Mapping: {0}", (object) str1);
            break;
          }
        }
      }
      else
        this.s067303396426305.WriteLine("Error: Could not parse SourceLink Json: {0}", (object) s633503270612449);
      return tupleList;
    }
  }
}
