// Decompiled with JetBrains decompiler
// Type: s051979881574419.s659954218631959
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s020661479339765;
using s528813736053581;
using s736322905406258;
using s850039077282665;
using System;
using System.Net;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;

namespace s051979881574419
{
  public sealed class s659954218631959 : s034852122986107
  {
    private s419623051832273 s754717648931512;

    public int s159518911384643 => this.s451109248857806(0);

    public int s639701840222513 => this.s451109248857806(4);

    public int s277822232092498 => this.s451109248857806(8);

    public unsafe byte* s319752860079768 => (byte*) ((IntPtr) (void*) this.s783707488833777 + 12);

    public unsafe string s797803413664154
    {
      get
      {
        byte* s319752860079768 = this.s319752860079768;
        byte* numPtr1 = s319752860079768 + this.s277822232092498;
        if (this.s754717648931512 == null)
          this.s754717648931512 = new s419623051832273();
        bool s188762283882041 = this.s754717648931512.s188762283882041;
        this.s754717648931512.s188762283882041 = false;
        byte* address = (byte*) null;
        bool flag = false;
        if (this.s754717648931512.s511188989880076 + 1U == this.s980614047227979 && this.s754717648931512.s236687271668205 == this.s216760266145602)
        {
          flag = true;
          if (s188762283882041)
          {
            address = this.s754717648931512.s890711621558961;
            numPtr1 = this.s754717648931512.s477494468870877;
          }
        }
        this.s754717648931512.s236687271668205 = this.s216760266145602;
        this.s754717648931512.s511188989880076 = this.s980614047227979;
        if ((IntPtr) address == IntPtr.Zero)
          address = s659954218631959.s654788060247895(s319752860079768, numPtr1);
        if ((IntPtr) address != IntPtr.Zero)
        {
          StringBuilder s301488252527490 = new StringBuilder();
          if (flag)
            s301488252527490.Append("CONT ").Append(this.s216760266145602.ToString().Substring(6, 2)).Append(" ");
          s659954218631959.s658391153273951 s658391153273951;
          ((s394911298493117.s618601936082422) ref s658391153273951).\u002Ector(address);
          s301488252527490.Append("IP");
          s301488252527490.Append(" Source=").Append((object) s658391153273951.s503549231861548);
          s301488252527490.Append(" Dest=").Append((object) s658391153273951.s995712589223169);
          if (s658391153273951.s501942451500014 == (byte) 6)
          {
            s659954218631959.s193764961945079 s193764961945079 = (s659954218631959.s193764961945079) new s659954218631959.s778773463540128(address + s658391153273951.s562483267014916);
            s301488252527490.Append(" TCP");
            int num1 = s658391153273951.s503549231861548.GetHashCode() + s658391153273951.s995712589223169.GetHashCode() + s193764961945079.s261369652957318 + s193764961945079.s737936669475954;
            int num2 = (int) (ushort) ((ulong) ((uint) num1 >> 16) + (ulong) num1);
            char ch = s193764961945079.s261369652957318 >= s193764961945079.s737936669475954 ? '>' : '<';
            s301488252527490.Append(" ConnID=").Append(num2.ToString("x")).Append(ch);
            s301488252527490.Append(" SPort=").Append(s193764961945079.s261369652957318);
            s301488252527490.Append(" DPort=").Append(s193764961945079.s737936669475954);
            if (s193764961945079.s979297564439622)
              s301488252527490.Append(" CWR");
            if (s193764961945079.s923073983078777)
              s301488252527490.Append(" ECE");
            if (s193764961945079.s442221116498216)
              s301488252527490.Append(" URG");
            if (s193764961945079.s630974760337562)
              s301488252527490.Append(" ACK");
            if (s193764961945079.s538207072727474)
              s301488252527490.Append(" PSH");
            if (s193764961945079.s255844864236197)
              s301488252527490.Append(" RST");
            if (s193764961945079.s902994788977409)
              s301488252527490.Append(" SYN");
            if (s193764961945079.s671287113152433)
              s301488252527490.Append(" FIN");
            if (s193764961945079.s026958019019982)
            {
              int s638906270635602 = s193764961945079.s638906270635602;
              if (0 <= s638906270635602)
                s301488252527490.Append(" WindowScale=").Append(s638906270635602);
              int s233805090687739 = s193764961945079.s233805090687739;
              if (0 <= s233805090687739)
                s301488252527490.Append(" MaxSeg=").Append(s233805090687739);
              if (s193764961945079.s766784609126894)
                s301488252527490.Append(" SelectiveAck");
              s301488252527490.Append(" TcpHdrLen=").Append(s193764961945079.s504662055219980);
            }
            s301488252527490.Append(" Ack=0x").Append(s193764961945079.s318363274662070.ToString("x"));
            s301488252527490.Append(" Seq=0x").Append(s193764961945079.s036804368594655.ToString("x"));
            s301488252527490.Append(" Window=").Append(s193764961945079.s726511404490528);
            s301488252527490.Append(" Len=").Append(s658391153273951.s127390830788166 - s658391153273951.s562483267014916 - s193764961945079.s504662055219980);
            if (s193764961945079.s737936669475954 == 80 || s193764961945079.s261369652957318 == 80)
            {
              byte* s561710870813972 = address + s658391153273951.s562483267014916 + s193764961945079.s504662055219980;
              if (s188762283882041)
              {
                s561710870813972 = this.s319752860079768;
                numPtr1 = s561710870813972 + this.s277822232092498;
              }
              else if (s561710870813972 == numPtr1)
              {
                this.s754717648931512.s188762283882041 = true;
                int num3 = s658391153273951.s562483267014916 + s193764961945079.s504662055219980;
                if (this.s754717648931512.s185208793187262 < num3)
                {
                  if ((IntPtr) this.s754717648931512.s890711621558961 != IntPtr.Zero)
                    Marshal.FreeHGlobal((IntPtr) (void*) this.s754717648931512.s890711621558961);
                  this.s754717648931512.s185208793187262 = num3 + 16;
                  this.s754717648931512.s890711621558961 = (byte*) (void*) Marshal.AllocHGlobal(this.s754717648931512.s185208793187262);
                }
                this.s754717648931512.s477494468870877 = this.s754717648931512.s890711621558961 + num3;
                byte* numPtr2 = address;
                for (int index = 0; index < num3; ++index)
                  this.s754717648931512.s890711621558961[index] = *numPtr2++;
              }
              s301488252527490.Append(" HTTP");
              if (s561710870813972 < numPtr1)
                s659954218631959.s626805426796264(s561710870813972, numPtr1, s301488252527490, " Stream=", 16);
            }
          }
          else
          {
            s301488252527490.Append(" Len=").Append(s658391153273951.s127390830788166 - s658391153273951.s562483267014916);
            if (s658391153273951.s501942451500014 == (byte) 17)
            {
              s301488252527490.Append(" UDP");
              s659954218631959.s778773463540128 s778773463540128 = (s659954218631959.s778773463540128) new s659954218631959.s658391153273951(address + s658391153273951.s562483267014916);
              s301488252527490.Append(" SPort=").Append(s778773463540128.s178708360250279);
              s301488252527490.Append(" DPort=").Append(s778773463540128.s631134676064185);
              s301488252527490.Append(" Length=").Append(s778773463540128.s542043906755195);
              s301488252527490.Append(" Checksum=").Append(s778773463540128.s310219859908414);
            }
            else
              s301488252527490.Append("IP(").Append(s658391153273951.s501942451500014.ToString()).Append(")");
          }
          return s301488252527490.ToString();
        }
        return flag ? "CONTINUATION FRAGMENT " + this.s216760266145602.ToString().Substring(6, 2) + " SIZE=" + (object) this.s277822232092498 : "NON-IP FRAGMENT " + this.s216760266145602.ToString().Substring(6, 2) + " SIZE=" + (object) this.s277822232092498;
      }
    }

    public unsafe string s623684067446318
    {
      get
      {
        string str = this.s038790295023239(this.s319752860079768, this.s277822232092498, 128, true);
        return str == null ? "" : str.Replace("\r\n", " ");
      }
    }

    private static unsafe void s626805426796264(
      byte* s561710870813972,
      byte* s855720690961373,
      StringBuilder s301488252527490,
      string s219696054715600,
      int s027793422331268)
    {
      byte* numPtr1 = s561710870813972 + s027793422331268;
      if (numPtr1 < s855720690961373)
        s855720690961373 = numPtr1;
      if (!s659954218631959.s343261300120833(s561710870813972, s855720690961373))
        return;
      s301488252527490.Append(s219696054715600);
      for (byte* numPtr2 = s561710870813972; numPtr2 < s855720690961373; ++numPtr2)
      {
        if ((byte) 32 <= *numPtr2)
          s301488252527490.Append((char) *numPtr2);
        else
          s301488252527490.Append(' ');
      }
      s301488252527490.Append("...");
    }

    private static unsafe bool s343261300120833(byte* s789734744627606, byte* s370392282589391)
    {
      for (byte* numPtr = s789734744627606; numPtr < s370392282589391; ++numPtr)
      {
        if ((byte) 10 > *numPtr || *numPtr >= (byte) 128)
          return false;
      }
      return true;
    }

    private static unsafe byte* s654788060247895(byte* s489394797964711, byte* s730821571583798)
    {
      s730821571583798 -= 30;
      if (s489394797964711 + 50 < s730821571583798)
        s730821571583798 = s489394797964711 + 50;
      byte* numPtr1 = (byte*) null;
      for (; s489394797964711 < s730821571583798; ++s489394797964711)
      {
        if (*s489394797964711 == (byte) 69)
        {
          uint num = 0;
          ushort* numPtr2 = (ushort*) s489394797964711;
          for (int index = 0; index < 10; ++index)
            num += (uint) *numPtr2++;
          if ((uint) (ushort) num + (num >> 16) == (uint) ushort.MaxValue)
            return s489394797964711;
          s659954218631959.s658391153273951 s658391153273951;
          // ISSUE: explicit constructor call
          ((s394911298493117.s618601936082422) ref s658391153273951).\u002Ector(s489394797964711);
          if (s658391153273951.s952728589172674 == 0 && (IntPtr) numPtr1 == IntPtr.Zero)
            numPtr1 = s489394797964711;
        }
      }
      return numPtr1;
    }

    internal s659954218631959(
      Action<s659954218631959> target,
      int eventID,
      int task,
      string taskName,
      Guid taskGuid,
      int opcode,
      string opcodeName,
      Guid providerGuid,
      string providerName,
      s419623051832273 state)
      : base(eventID, task, taskName, taskGuid, opcode, opcodeName, providerGuid, providerName)
    {
      // ISSUE: reference to a compiler-generated field
      this.s574491440606329 = target;
      this.s754717648931512 = state;
    }

    protected internal virtual void s490280195622753() => this.s574491440606329(this);

    protected internal virtual void s068565601212394()
    {
    }

    protected internal virtual Delegate s223303474050450
    {
      get => (Delegate) this.s574491440606329;
      set => this.s574491440606329 = (Action<s659954218631959>) value;
    }

    public virtual unsafe StringBuilder s875954278256094(StringBuilder s659921307230127)
    {
      this.s502194153627863(s659921307230127);
      s034852122986107.s470252411845886(s659921307230127, "MiniportIfIndex", this.s159518911384643);
      s034852122986107.s470252411845886(s659921307230127, "LowerIfIndex", this.s639701840222513);
      s034852122986107.s470252411845886(s659921307230127, "FragmentSize", this.s277822232092498).AppendLine();
      s034852122986107.s581185594378393(s659921307230127, "ParsedPacket", this.s797803413664154);
      string str = this.s038790295023239(this.s319752860079768, this.s277822232092498, int.MaxValue);
      if (str != null)
      {
        s659921307230127.AppendLine(">");
        s659921307230127.AppendLine(" <Printable>");
        string s420415393641353 = "  " + str.Replace("\n", "\n  ");
        s659921307230127.AppendLine(s471684335504367.s194952918595166((object) s420415393641353));
        s659921307230127.AppendLine(" </Printable>");
        s659921307230127.Append("</Event>");
      }
      else
        s659921307230127.Append("/>");
      return s659921307230127;
    }

    private unsafe string s038790295023239(
      byte* s195555670393708,
      int s775997258442170,
      int s717391597655783,
      bool s991240522939141 = false)
    {
      if (s775997258442170 < 16)
        return (string) null;
      byte* s730821571583798 = s195555670393708 + s775997258442170;
      if (!s659954218631959.s343261300120833(s195555670393708, s195555670393708 + 16))
      {
        byte* address = s659954218631959.s654788060247895(s195555670393708, s730821571583798);
        if ((IntPtr) address == IntPtr.Zero)
          return (string) null;
        s659954218631959.s658391153273951 s658391153273951;
        // ISSUE: explicit constructor call
        ((s394911298493117.s618601936082422) ref s658391153273951).\u002Ector(address);
        if (s658391153273951.s501942451500014 != (byte) 6)
          return (string) null;
        byte* s789734744627606 = (byte*) (((s659954218631959.s193764961945079) new s659954218631959.s778773463540128(address + s658391153273951.s562483267014916)).s504662055219980 + s658391153273951.s562483267014916 + (IntPtr) address);
        if (s730821571583798 - s789734744627606 < 16L)
          return (string) null;
        if (!s659954218631959.s343261300120833(s789734744627606, s789734744627606 + 16))
          return (string) null;
        s195555670393708 = s789734744627606;
      }
      StringBuilder stringBuilder = new StringBuilder();
      if ((long) s717391597655783 < s730821571583798 - s195555670393708)
        s730821571583798 = s195555670393708 + s717391597655783;
      for (; s195555670393708 < s730821571583798; ++s195555670393708)
      {
        byte num = *s195555670393708;
        if ((byte) 10 <= num && num < (byte) 128 && (!s991240522939141 || num != (byte) 13 && num != (byte) 10))
          stringBuilder.Append((char) num);
        else
          break;
      }
      return stringBuilder.ToString();
    }

    public virtual string[] s240425090154085
    {
      get
      {
        if (this.payloadNames == null)
          this.payloadNames = new string[5]
          {
            "MiniportIfIndex",
            "LowerIfIndex",
            "FragmentSize",
            "ParsedPacket",
            "TcpStreamSample"
          };
        return this.payloadNames;
      }
    }

    public virtual object s020629160129879(int s269265208374808)
    {
      switch (s269265208374808)
      {
        case 0:
          return (object) this.s159518911384643;
        case 1:
          return (object) this.s639701840222513;
        case 2:
          return (object) this.s277822232092498;
        case 3:
          return (object) this.s797803413664154;
        case 4:
          return (object) this.s623684067446318;
        default:
          return (object) null;
      }
    }

    private event Action<s659954218631959> s547372091208824;

    protected internal virtual void s456098093634955(object s668500475700325) => this.s754717648931512 = (s419623051832273) s668500475700325;

    private struct s658391153273951
    {
      private unsafe byte* s784020176759540;

      public unsafe int s562483267014916 => ((int) *(^(s394911298493117.s618601936082422&) ref this).s442423354688229 & 15) * 4;

      public unsafe int s127390830788166 => ((int) (^(s394911298493117.s618601936082422&) ref this).s442423354688229[2] << 8) + (int) (^(s394911298493117.s618601936082422&) ref this).s442423354688229[3];

      public unsafe IPAddress s503549231861548 => new IPAddress((long) *(uint*) ((^(s394911298493117.s618601936082422&) ref this).s442423354688229 + 12));

      public unsafe IPAddress s995712589223169 => new IPAddress((long) *(uint*) ((^(s394911298493117.s618601936082422&) ref this).s442423354688229 + 16));

      public unsafe byte s501942451500014 => (^(s394911298493117.s618601936082422&) ref this).s442423354688229[9];

      public unsafe int s952728589172674 => ((int) (^(s394911298493117.s618601936082422&) ref this).s442423354688229[10] << 8) + (int) (^(s394911298493117.s618601936082422&) ref this).s442423354688229[11];

      public unsafe s658391153273951(byte* address) => this.s784020176759540 = address;
    }

    private struct s778773463540128
    {
      private unsafe byte* s342590546348733;

      public unsafe int s178708360250279 => ((int) *(^(s659954218631959.s658391153273951&) ref this).s784020176759540 << 8) + (int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[1];

      public unsafe int s631134676064185 => ((int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[2] << 8) + (int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[3];

      public unsafe int s542043906755195 => ((int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[4] << 8) + (int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[5];

      public unsafe int s310219859908414 => ((int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[6] << 8) + (int) (^(s659954218631959.s658391153273951&) ref this).s784020176759540[7];

      public int s651565508206153 => 8;

      public unsafe s778773463540128(byte* address) => this.s342590546348733 = address;
    }

    private struct s193764961945079
    {
      [SpecialName]
      public int value__;

      public unsafe int s261369652957318 => ((int) *(^(s659954218631959.s778773463540128&) ref this).s342590546348733 << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[1];

      public unsafe int s737936669475954 => ((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[2] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[3];

      public unsafe int s036804368594655 => ((((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[4] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[5] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[6] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[7];

      public unsafe int s318363274662070 => ((((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[8] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[9] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[10] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[11];

      public unsafe int s504662055219980 => ((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[12] >> 4) * 4;

      public unsafe bool s557568413922840 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[12] & 1U) > 0U;

      public unsafe bool s979297564439622 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 128U) > 0U;

      public unsafe bool s923073983078777 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 64U) > 0U;

      public unsafe bool s442221116498216 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 32U) > 0U;

      public unsafe bool s630974760337562 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 16U) > 0U;

      public unsafe bool s538207072727474 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 8U) > 0U;

      public unsafe bool s255844864236197 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 4U) > 0U;

      public unsafe bool s902994788977409 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 2U) > 0U;

      public unsafe bool s671287113152433 => ((uint) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[13] & 1U) > 0U;

      public unsafe int s726511404490528 => ((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[14] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[15];

      public unsafe int s882322433909413 => ((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[16] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[17];

      public unsafe int s910092400193849 => ((int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[18] << 8) + (int) (^(s659954218631959.s778773463540128&) ref this).s342590546348733[19];

      public int s638906270635602 => this.s282855094517949(3);

      public bool s766784609126894 => this.s282855094517949(4) == 0;

      public int s233805090687739 => this.s282855094517949(2);

      public bool s026958019019982 => 20 < this.s504662055219980;

      private unsafe int s282855094517949(int s858275403663699)
      {
        // ISSUE: cast to a reference type
        // ISSUE: explicit reference operation
        byte* numPtr1 = (^(s659954218631959.s778773463540128&) ref this).s342590546348733 + this.s504662055219980;
        // ISSUE: cast to a reference type
        // ISSUE: explicit reference operation
        byte* numPtr2 = (^(s659954218631959.s778773463540128&) ref this).s342590546348733 + 20;
        while (numPtr2 < numPtr1 && *numPtr2 != (byte) 0)
        {
          if (*numPtr2 == (byte) 1)
          {
            ++numPtr2;
          }
          else
          {
            byte num = numPtr2[1];
            if (num >= (byte) 2 && (byte) 10 >= num)
            {
              if ((int) *numPtr2 == s858275403663699)
              {
                switch (num)
                {
                  case 2:
                    return 0;
                  case 3:
                    return (int) numPtr2[2];
                  case 4:
                    return ((int) numPtr2[2] << 8) + (int) numPtr2[3];
                  default:
                    goto label_11;
                }
              }
              else
                numPtr2 += (int) num;
            }
            else
              break;
          }
        }
label_11:
        return -1;
      }

      [SpecialName]
      public int get_ClrInstanceID() => ((s034852122986107) ref this).s512155324285653 >= 1 ? ((s034852122986107) ref this).s109840614309755(0) : 0;
    }
  }
}
