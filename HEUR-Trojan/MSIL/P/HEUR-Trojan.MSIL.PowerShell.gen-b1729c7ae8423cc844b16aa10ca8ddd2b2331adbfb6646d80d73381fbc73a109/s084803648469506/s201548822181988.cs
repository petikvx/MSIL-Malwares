// Decompiled with JetBrains decompiler
// Type: s084803648469506.s201548822181988
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s182142645794958;
using s443979735060072;
using s519911046862624;
using s522703163630918;
using s596259820889768;
using s734997833128071;
using s895988393875566;
using s907430482254132;
using s983888993415693;
using System;
using System.IO;

namespace s084803648469506
{
  public sealed class s201548822181988 : IDisposable
  {
    private bool s642202704877254;
    private bool s532266026032317;
    private bool s196129133018743;
    private short s874635714919955;
    private short s185628524476500;
    private const int s332475900135059 = 5395538;
    private s823238258772928 s425777972740237;
    private s823238258772928 s377134598740598;
    private FileStream s911663822660416;

    public unsafe s201548822181988(string filePath)
    {
      this.s911663822660416 = File.OpenRead(filePath);
      this.s425777972740237 = new s823238258772928((Stream) this.s911663822660416);
      byte* startOfPEFile1 = this.s425777972740237.s271180648206790(0, 1024);
      if (this.s425777972740237.s150407265099538 >= 512)
      {
        this.s908829323971250 = new s191880862623037((void*) startOfPEFile1);
        if (this.s908829323971250.s756504026528743 <= 65536)
        {
          if (this.s908829323971250.s756504026528743 <= this.s425777972740237.s150407265099538)
            return;
          byte* startOfPEFile2 = this.s425777972740237.s271180648206790(0, this.s908829323971250.s756504026528743);
          if (this.s425777972740237.s150407265099538 >= this.s908829323971250.s756504026528743)
          {
            this.s908829323971250 = new s191880862623037((void*) startOfPEFile2);
            return;
          }
        }
      }
      throw new InvalidOperationException("Bad PE Header in " + filePath);
    }

    public s191880862623037 s908829323971250 { get; private set; }

    public unsafe bool s782853471849472(
      out string s829541715749206,
      out Guid s575593211458573,
      out int s302084413933267,
      bool s958005895843298 = false)
    {
      s829541715749206 = (string) null;
      s575593211458573 = Guid.Empty;
      s302084413933267 = 0;
      bool flag = false;
      if (this.s908829323971250.s571894338722783.s795391110559103 != 0)
      {
        s823238258772928 s823238258772928 = this.s504732181092553();
        s766026154731024* s766026154731024Ptr = (s766026154731024*) this.s696273196792119(this.s908829323971250.s571894338722783.s795391110559103, this.s908829323971250.s571894338722783.s947968551816391, s823238258772928);
        int num = this.s908829323971250.s571894338722783.s947968551816391 / sizeof (s766026154731024);
        for (int index = 0; index < num; ++index)
        {
          if (s766026154731024Ptr[index].s649689907546907 == s918823648539801.CODEVIEW)
          {
            s823238258772928 s303940845850061 = this.s504732181092553();
            s863252697739585* s863252697739585Ptr = (s863252697739585*) s303940845850061.s271180648206790(s766026154731024Ptr[index].s598020397654112, s766026154731024Ptr[index].s929796669740193);
            if (s863252697739585Ptr->s262683550654691 == 1396986706)
            {
              s575593211458573 = s863252697739585Ptr->s626065691039397;
              s302084413933267 = s863252697739585Ptr->s991975960301177;
              s829541715749206 = s863252697739585Ptr->s264551023674326;
              flag = true;
              if (s958005895843298)
                break;
            }
            this.s123017279554931(s303940845850061);
          }
        }
        this.s123017279554931(s823238258772928);
      }
      return flag;
    }

    public unsafe s265107053941038 s035114760393254()
    {
      s270652000755903 s270652000755903 = s270652000755903.s021309228542041(s270652000755903.s021309228542041(this.s051198584164546(), "Version"), "1");
      if (s270652000755903 == null)
        return (s265107053941038) null;
      if (!s270652000755903.s198931606216682 && s270652000755903.s707877667994472.Count == 1)
        s270652000755903 = s270652000755903.s707877667994472[0];
      s823238258772928 s823238258772928 = this.s504732181092553();
      s265107053941038 s265107053941038 = new s265107053941038(s270652000755903.s492791010206429(0, s270652000755903.s621012562021575, s823238258772928), s270652000755903.s621012562021575);
      this.s123017279554931(s823238258772928);
      return s265107053941038;
    }

    public unsafe string s101401400783349()
    {
      s270652000755903 s270652000755903 = s270652000755903.s021309228542041(s270652000755903.s021309228542041(this.s051198584164546(), "RT_MANIFEST"), "1");
      if (s270652000755903 == null)
        return (string) null;
      if (!s270652000755903.s198931606216682 && s270652000755903.s707877667994472.Count == 1)
        s270652000755903 = s270652000755903.s707877667994472[0];
      s823238258772928 s823238258772928 = this.s504732181092553();
      byte* pointer = s270652000755903.s492791010206429(0, s270652000755903.s621012562021575, s823238258772928);
      string str = (string) null;
      using (StreamReader streamReader = new StreamReader((Stream) new UnmanagedMemoryStream(pointer, (long) s270652000755903.s621012562021575)))
        str = streamReader.ReadToEnd();
      this.s123017279554931(s823238258772928);
      return str;
    }

    public bool s210162227274438
    {
      get
      {
        if (!this.s642202704877254)
          this.s746921746805628();
        return this.s532266026032317;
      }
    }

    public bool s618415157162403
    {
      get
      {
        if (!this.s642202704877254)
          this.s746921746805628();
        return this.s196129133018743;
      }
    }

    public bool s395758628660727(out short s769810388335919, out short s547449685801403)
    {
      if (!this.s642202704877254)
        this.s746921746805628();
      s769810388335919 = this.s874635714919955;
      s547449685801403 = this.s185628524476500;
      return this.s196129133018743;
    }

    public void s629606087932997()
    {
      this.s911663822660416.Dispose();
      this.s425777972740237.s695544131832071();
      if (this.s377134598740598 == null)
        return;
      this.s377134598740598.s695544131832071();
    }

    internal s270652000755903 s051198584164546() => this.s908829323971250.s524142003628275.s795391110559103 == 0 || this.s908829323971250.s524142003628275.s947968551816391 < sizeof (s747364175899493) ? (s270652000755903) null : new s270652000755903("", this.s908829323971250.s887856775602684, this, false, true);

    public unsafe void s746921746805628()
    {
      if (this.s642202704877254 || this.s908829323971250.s720659992374949.s795391110559103 == 0 || sizeof (s201548822181988.s427711189648520) > this.s908829323971250.s720659992374949.s947968551816391)
        return;
      s823238258772928 s823238258772928 = this.s504732181092553();
      s201548822181988.s427711189648520* s427711189648520Ptr = (s201548822181988.s427711189648520*) this.s696273196792119(this.s908829323971250.s720659992374949.s795391110559103, sizeof (s201548822181988.s427711189648520), s823238258772928);
      if (s427711189648520Ptr->s611374119134798.s795391110559103 != 0)
      {
        this.s532266026032317 = true;
        if (sizeof (s201548822181988.s907857603773958) <= s427711189648520Ptr->s611374119134798.s947968551816391)
        {
          s201548822181988.s907857603773958* s907857603773958Ptr = (s201548822181988.s907857603773958*) this.s696273196792119(s427711189648520Ptr->s611374119134798.s795391110559103, sizeof (s201548822181988.s907857603773958), s823238258772928);
          if (((s201548822181988.s427711189648520*) s907857603773958Ptr)->s931618492385965 == 5395538)
          {
            this.s196129133018743 = true;
            this.s874635714919955 = s907857603773958Ptr->s150589085455589;
            this.s185628524476500 = s907857603773958Ptr->s818071863843675;
          }
        }
      }
      this.s123017279554931(s823238258772928);
    }

    internal unsafe byte* s696273196792119(
      int s437151860187691,
      int s674991614761022,
      s823238258772928 s153464274069184)
    {
      return s153464274069184.s271180648206790(this.s908829323971250.s419966790139058(s437151860187691), s674991614761022);
    }

    internal s823238258772928 s504732181092553()
    {
      s823238258772928 s377134598740598 = this.s377134598740598;
      if (s377134598740598 == null)
        return new s823238258772928((Stream) this.s911663822660416);
      this.s377134598740598 = (s823238258772928) null;
      return s377134598740598;
    }

    internal void s123017279554931(s823238258772928 s303940845850061)
    {
      if (this.s377134598740598 != null)
        s303940845850061.s695544131832071();
      else
        this.s377134598740598 = s303940845850061;
    }

    private struct s427711189648520
    {
      public short s885178363786926;
      public short s424536262455471;
      public s258076534656413 s985572294540781;
      public int s474658739784265;
      public int s470408624253140;
      public s258076534656413 s754097496691191;
      public s258076534656413 s722388517006146;
      public s258076534656413 s892212746347475;
      public s258076534656413 s340106904743008;
      public s258076534656413 s704597877343940;
      public s258076534656413 s611374119134798;
      public int s931618492385965;
    }

    private struct s907857603773958
    {
      public short s150589085455589;
      public short s818071863843675;
      public int s828108740199006;
      public int s117232931123874;
      public byte s297013007405104;
    }
  }
}
