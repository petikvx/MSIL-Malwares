// Decompiled with JetBrains decompiler
// Type: CHQlfIkSBpnGKlzJo.of3it1eHtxHAjg0dg
// Assembly: Q7jU8zFqbfRJyQUdT, Version=5.6.0.5, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 36427E73-5524-420A-9724-276045DDB54E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Crypt.gen-bda7803bc6a630ed5997870eb0b102e590d6f584b11699fb76781564debe9921.exe

using \u0039W9hlkamLrN1PNjqI;
using dK6zmGWh7g91GOgfp;
using fmIg4S2kz3L72tPIb;
using i670DqLyHvoidX7cL;
using Jh79DrBnBpC96nyFx;
using NuGet.Common;
using NuGet.DependencyResolver;
using NuGet.Frameworks;
using NuGet.LibraryModel;
using NuGet.Versioning;
using qQ1iKWPWNeg6wYZSD;
using S4V1zJZ85zQxSB9y0;
using SX8pIjSHncBmX9q7c;
using System;
using System.Collections.Generic;
using System.Linq;
using UoAmkNNueCnA0m6bI;

namespace CHQlfIkSBpnGKlzJo
{
  public class of3it1eHtxHAjg0dg : IDependencyProvider
  {
    private readonly Dictionary<string, xgwjkEc2LOe4C37KE> e2KdQRvOovD1LoGT6 = new Dictionary<string, xgwjkEc2LOe4C37KE>((IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase);
    private readonly Dictionary<string, xgwjkEc2LOe4C37KE> EjMCHhBJZGZ7zab7T = new Dictionary<string, xgwjkEc2LOe4C37KE>((IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase);
    private readonly ILogger I7nzydjC9TyLM5biS;

    public of3it1eHtxHAjg0dg(IEnumerable<xgwjkEc2LOe4C37KE> externalProjects, ILogger logger)
    {
      if (externalProjects == null)
        throw new ArgumentNullException(nameof (externalProjects));
      this.I7nzydjC9TyLM5biS = logger != null ? logger : throw new ArgumentNullException(nameof (logger));
      foreach (xgwjkEc2LOe4C37KE externalProject in externalProjects)
      {
        if (!this.e2KdQRvOovD1LoGT6.ContainsKey(externalProject.zQHfejM7uPZ6ITZrj))
          this.e2KdQRvOovD1LoGT6.Add(externalProject.zQHfejM7uPZ6ITZrj, externalProject);
        if (!this.EjMCHhBJZGZ7zab7T.ContainsKey(externalProject.Vq7ffPq9yuR4jWvQA))
          this.EjMCHhBJZGZ7zab7T.Add(externalProject.Vq7ffPq9yuR4jWvQA, externalProject);
        if (!this.EjMCHhBJZGZ7zab7T.ContainsKey(externalProject.zQHfejM7uPZ6ITZrj))
          this.EjMCHhBJZGZ7zab7T.Add(externalProject.zQHfejM7uPZ6ITZrj, externalProject);
      }
    }

    public bool R3atCwvOJFrn6jxvQ(LibraryDependencyTarget zLPk2go3gxz3fQMSF) => (zLPk2go3gxz3fQMSF & 6) > 0;

    public Library \u0036lfb6mJJ23BcEnZ6b(
      LibraryRange DhOV5YJassLGf8xWm,
      NuGetFramework VLVdlyhsKlBblztCa)
    {
      string name = DhOV5YJassLGf8xWm.Name;
      xgwjkEc2LOe4C37KE LrUiX5JgObiGUTdsE = (xgwjkEc2LOe4C37KE) null;
      sADkOtSpqiDlZWiPV adkOtSpqiDlZwiPv = (sADkOtSpqiDlZWiPV) null;
      if (this.EjMCHhBJZGZ7zab7T.TryGetValue(name, out LrUiX5JgObiGUTdsE))
        adkOtSpqiDlZwiPv = LrUiX5JgObiGUTdsE.NaGWnCWYfaUHXGrnM;
      if (LrUiX5JgObiGUTdsE == null && adkOtSpqiDlZwiPv == null)
        return (Library) null;
      List<LibraryDependency> libraryDependencyList1 = new List<LibraryDependency>();
      if (adkOtSpqiDlZwiPv?.Pi94kX4VEQven7QZD?.APN0x0gBZiayoMRmn.GetValueOrDefault() == TVST7Xu3NyQU5gG9m.PackageReference)
        libraryDependencyList1.AddRange((IEnumerable<LibraryDependency>) this.OWfK27OfoEeSlvBFT(adkOtSpqiDlZwiPv, VLVdlyhsKlBblztCa));
      else
        libraryDependencyList1.AddRange((IEnumerable<LibraryDependency>) this.mlxHMEfgklKxdA5cA(LrUiX5JgObiGUTdsE, adkOtSpqiDlZwiPv, VLVdlyhsKlBblztCa));
      List<LibraryDependency> libraryDependencyList2 = new List<LibraryDependency>(libraryDependencyList1.Count);
      HashSet<string> stringSet = new HashSet<string>((IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase);
      foreach (LibraryDependency libraryDependency in libraryDependencyList1)
      {
        if (stringSet.Add(libraryDependency.Name))
          libraryDependencyList2.Add(libraryDependency);
      }
      Library FH4TxXQ6bCDZ7DQ1c = new Library()
      {
        LibraryRange = DhOV5YJassLGf8xWm,
        Identity = new LibraryIdentity()
        {
          Name = LrUiX5JgObiGUTdsE?.Vq7ffPq9yuR4jWvQA ?? adkOtSpqiDlZwiPv.xnwotMIJLmt96xcFY,
          Version = adkOtSpqiDlZwiPv?.N4HscvijsFBV1ThP0 ?? new NuGetVersion(1, 0, 0),
          Type = LibraryType.Project
        },
        Path = adkOtSpqiDlZwiPv?.crvFq8RTFLsUeQq75,
        Dependencies = (IEnumerable<LibraryDependency>) libraryDependencyList2,
        Resolved = true
      };
      string heImFilVkv7Nn4Uhm = LrUiX5JgObiGUTdsE?.heImFIlVkv7NN4UHm;
      if (heImFilVkv7Nn4Uhm != null)
        FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.MSBuildProjectPath] = (object) heImFilVkv7Nn4Uhm;
      if (adkOtSpqiDlZwiPv != null)
        of3it1eHtxHAjg0dg.gqhA2grUTSkxNadmp(FH4TxXQ6bCDZ7DQ1c, adkOtSpqiDlZwiPv, VLVdlyhsKlBblztCa, heImFilVkv7Nn4Uhm);
      return FH4TxXQ6bCDZ7DQ1c;
    }

    private static void gqhA2grUTSkxNadmp(
      Library FH4TxXQ6bCDZ7DQ1c,
      sADkOtSpqiDlZWiPV Z870QSK6V1EIipyju,
      NuGetFramework bqP2H6ENIvZ9dVimt,
      string stUZTP89vyYh7hqPI)
    {
      sOZzPXAFrUrzjWJZ0 pi94kX4VeQven7Qzd = Z870QSK6V1EIipyju.Pi94kX4VEQven7QZD;
      TVST7Xu3NyQU5gG9m tvsT7Xu3NyQu5gG9m = pi94kX4VeQven7Qzd != null ? pi94kX4VeQven7Qzd.APN0x0gBZiayoMRmn : TVST7Xu3NyQU5gG9m.Unknown;
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.PackageSpec] = (object) Z870QSK6V1EIipyju;
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.ProjectStyle] = (object) tvsT7Xu3NyQu5gG9m;
      if (Z870QSK6V1EIipyju.Pi94kX4VEQven7QZD?.xYEAdMhW0aNi2r515 != null)
        FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.ProjectRestoreMetadataFiles] = (object) Z870QSK6V1EIipyju.Pi94kX4VEQven7QZD.xYEAdMhW0aNi2r515.ToList<WwRoUBIDZc6O5o1w7>();
      if (Z870QSK6V1EIipyju.Pi94kX4VEQven7QZD != null && (tvsT7Xu3NyQu5gG9m == TVST7Xu3NyQU5gG9m.Unknown || tvsT7Xu3NyQu5gG9m == TVST7Xu3NyQU5gG9m.PackagesConfig))
        return;
      List<NuGetFramework> nuGetFrameworkList = new List<NuGetFramework>(Z870QSK6V1EIipyju.ZfLqCjZwpgF3zR3to.Select<pvrEzbZHFd2PPIQqF, NuGetFramework>((Func<pvrEzbZHFd2PPIQqF, NuGetFramework>) (_param1 => _param1.chzX8vKQt0e6esU37)).Where<NuGetFramework>((Func<NuGetFramework, bool>) (GJvogQjYAMlxmFQwj => !GJvogQjYAMlxmFQwj.IsUnsupported)));
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.ProjectFrameworks] = (object) nuGetFrameworkList;
      pvrEzbZHFd2PPIQqF pvrEzbZhFd2PpiQqF = Z870QSK6V1EIipyju.\u0035civfQuRa4AlaIgFc(bqP2H6ENIvZ9dVimt);
      if (NuGetFramework.op_Equality(pvrEzbZhFd2PpiQqF.chzX8vKQt0e6esU37, (NuGetFramework) null) && bqP2H6ENIvZ9dVimt is AssetTargetFallbackFramework)
      {
        AssetTargetFallbackFramework fallbackFramework = bqP2H6ENIvZ9dVimt as AssetTargetFallbackFramework;
        pvrEzbZhFd2PpiQqF = Z870QSK6V1EIipyju.\u0035civfQuRa4AlaIgFc((NuGetFramework) fallbackFramework.AsFallbackFramework());
      }
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.TargetFrameworkInformation] = (object) pvrEzbZhFd2PpiQqF;
      List<string> list = ((IEnumerable<LibraryDependency>) pvrEzbZhFd2PpiQqF.aKxwewXU1hUtckVuW).Where<LibraryDependency>((Func<LibraryDependency, bool>) (yDGqdaoJG3sxL8zaF => yDGqdaoJG3sxL8zaF.LibraryRange.TypeConstraint == 16)).Select<LibraryDependency, string>((Func<LibraryDependency, string>) (nX4IKwnuaroh1i8kU => nX4IKwnuaroh1i8kU.Name)).Distinct<string>((IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase).ToList<string>();
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.FrameworkAssemblies] = (object) list;
      FH4TxXQ6bCDZ7DQ1c[KnownLibraryProperties.FrameworkReferences] = (object) pvrEzbZhFd2PpiQqF.ucWGrfzUODG4C9F8o;
    }

    private List<LibraryDependency> OWfK27OfoEeSlvBFT(
      sADkOtSpqiDlZWiPV jlAVDsytDABY5wnMq,
      NuGetFramework vVGcfsNAavRaxrdSl)
    {
      List<LibraryDependency> libraryDependencyList = of3it1eHtxHAjg0dg.ckuu7S2JGJLlFRzny(jlAVDsytDABY5wnMq, vVGcfsNAavRaxrdSl);
      \u0038NyKufKw3DxSVmP2c nyKufKw3DxSvmP2c = jlAVDsytDABY5wnMq.O09vTUKf0kFoocZnG(vVGcfsNAavRaxrdSl);
      NuGetFramework mlByYnlgGlPg5Lcis = nyKufKw3DxSvmP2c.mlBYYnlgGlPg5LCis;
      if ((mlByYnlgGlPg5Lcis != null ? (mlByYnlgGlPg5Lcis.IsSpecificFramework ? 1 : 0) : 0) != 0)
      {
        foreach (kgXs4z1KizoZD3JwL kgXs4z1KizoZd3JwL in (IEnumerable<kgXs4z1KizoZD3JwL>) nyKufKw3DxSvmP2c.\u0030CtxMmfSM6agggHGe)
        {
          // ISSUE: object of a compiler-generated type is created
          // ISSUE: variable of a compiler-generated type
          of3it1eHtxHAjg0dg.SgktLpCDlQA3v70tz sgktLpCdlQa3v70tz = (of3it1eHtxHAjg0dg.SgktLpCDlQA3v70tz) new of3it1eHtxHAjg0dg.QWQoWNFbIjCP5f9gk();
          string str = kgXs4z1KizoZd3JwL.ZYRUULcYyxcWK5Wgy;
          VersionRange versionRange = VersionRange.All;
          xgwjkEc2LOe4C37KE xgwjkEc2Loe4C37Ke;
          if (this.EjMCHhBJZGZ7zab7T.TryGetValue(kgXs4z1KizoZd3JwL.PpkKCcgXxaR9JV4zK, out xgwjkEc2Loe4C37Ke))
          {
            str = xgwjkEc2Loe4C37Ke.Vq7ffPq9yuR4jWvQA;
            NuGetVersion n4HscvijsFbV1ThP0 = xgwjkEc2Loe4C37Ke.NaGWnCWYfaUHXGrnM?.N4HscvijsFBV1ThP0;
            if (SemanticVersion.op_Inequality((SemanticVersion) n4HscvijsFbV1ThP0, (SemanticVersion) null))
              versionRange = new VersionRange(n4HscvijsFbV1ThP0);
          }
          // ISSUE: reference to a compiler-generated field
          ((of3it1eHtxHAjg0dg.QWQoWNFbIjCP5f9gk) sgktLpCdlQa3v70tz).YOfdWyuIcg804NagV = new LibraryDependency()
          {
            IncludeType = (LibraryIncludeFlags) (kgXs4z1KizoZd3JwL.UUZpXSiuBgy3IQXFG & (int) (ushort) ~kgXs4z1KizoZd3JwL.\u0032Gqb9NuT7NNAeRZKP),
            SuppressParent = kgXs4z1KizoZd3JwL.ofGg22mKFW8vzj9B8,
            LibraryRange = new LibraryRange(str, versionRange, (LibraryDependencyTarget) 4)
          };
          // ISSUE: reference to a compiler-generated method
          libraryDependencyList.RemoveAll(new Predicate<LibraryDependency>(sgktLpCdlQa3v70tz.HtagCVfW3WcKQzjtn));
          // ISSUE: reference to a compiler-generated field
          libraryDependencyList.Add(((of3it1eHtxHAjg0dg.QWQoWNFbIjCP5f9gk) sgktLpCdlQa3v70tz).YOfdWyuIcg804NagV);
        }
      }
      return libraryDependencyList;
    }

    private List<LibraryDependency> mlxHMEfgklKxdA5cA(
      xgwjkEc2LOe4C37KE LrUiX5JgObiGUTdsE,
      sADkOtSpqiDlZWiPV FogqTvjn5c7xkZCef,
      NuGetFramework elULSugz7jif9usSe)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      of3it1eHtxHAjg0dg.wJVN2aVawIsW1tSev jvN2aVawIsW1tSev = (of3it1eHtxHAjg0dg.wJVN2aVawIsW1tSev) new of3it1eHtxHAjg0dg.SgktLpCDlQA3v70tz();
      // ISSUE: reference to a compiler-generated field
      ((of3it1eHtxHAjg0dg.SgktLpCDlQA3v70tz) jvN2aVawIsW1tSev).sFckEBwfjin7505jB = this;
      List<LibraryDependency> source1 = of3it1eHtxHAjg0dg.ckuu7S2JGJLlFRzny(FogqTvjn5c7xkZCef, elULSugz7jif9usSe);
      if (LrUiX5JgObiGUTdsE != null)
      {
        List<xgwjkEc2LOe4C37KE> source2 = this.hgee0IbuB7HCDsIeE(LrUiX5JgObiGUTdsE);
        List<string> list = source2.Select<xgwjkEc2LOe4C37KE, string>((Func<xgwjkEc2LOe4C37KE, string>) (wOu8cnDgR1YTfs0CT => wOu8cnDgR1YTfs0CT.Vq7ffPq9yuR4jWvQA)).ToList<string>();
        // ISSUE: reference to a compiler-generated field
        jvN2aVawIsW1tSev.TXzTTRUa620kh6kGu = new HashSet<string>((IEnumerable<string>) list, (IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase);
        // ISSUE: reference to a compiler-generated field
        // ISSUE: reference to a compiler-generated field
        // ISSUE: reference to a compiler-generated method
        foreach (LibraryDependency libraryDependency in ((IEnumerable<LibraryDependency>) source1).Where<LibraryDependency>(jvN2aVawIsW1tSev.FVTnz7JPlcEnemljj ?? (jvN2aVawIsW1tSev.FVTnz7JPlcEnemljj = new Func<LibraryDependency, bool>(jvN2aVawIsW1tSev.QlSAFtC11lyWKY9Bu))))
          libraryDependency.LibraryRange.TypeConstraint = (LibraryDependencyTarget) 4;
        // ISSUE: reference to a compiler-generated method
        source1.AddRange(source2.Where<xgwjkEc2LOe4C37KE>(new Func<xgwjkEc2LOe4C37KE, bool>(jvN2aVawIsW1tSev.uKqn47Mmrc2dLtuVN)).Select<xgwjkEc2LOe4C37KE, LibraryDependency>((Func<xgwjkEc2LOe4C37KE, LibraryDependency>) (qZ7qw7EDyGIhrUGDm => new LibraryDependency()
        {
          LibraryRange = new LibraryRange()
          {
            Name = qZ7qw7EDyGIhrUGDm.Vq7ffPq9yuR4jWvQA,
            VersionRange = VersionRange.Parse("1.0.0"),
            TypeConstraint = (LibraryDependencyTarget) 4
          }
        })));
      }
      return source1;
    }

    internal static List<LibraryDependency> ckuu7S2JGJLlFRzny(
      sADkOtSpqiDlZWiPV _param0,
      NuGetFramework SJmv73HOy2Cy19QXA)
    {
      List<LibraryDependency> libraryDependencyList = new List<LibraryDependency>();
      if (_param0 != null)
      {
        libraryDependencyList.AddRange((IEnumerable<LibraryDependency>) _param0.rJn1NBzbMCL2whTON);
        pvrEzbZHFd2PPIQqF pvrEzbZhFd2PpiQqF = _param0.\u0035civfQuRa4AlaIgFc(SJmv73HOy2Cy19QXA);
        libraryDependencyList.AddRange((IEnumerable<LibraryDependency>) pvrEzbZhFd2PpiQqF.aKxwewXU1hUtckVuW);
        sOZzPXAFrUrzjWJZ0 pi94kX4VeQven7Qzd = _param0.Pi94kX4VEQven7QZD;
        if ((pi94kX4VeQven7Qzd != null ? (pi94kX4VeQven7Qzd.zWoC7Uq2YU0PX6OQV ? 1 : 0) : 0) != 0)
        {
          // ISSUE: object of a compiler-generated type is created
          // ISSUE: variable of a compiler-generated type
          of3it1eHtxHAjg0dg.PoIl3Cpq8fMbK7knQ poIl3Cpq8fMbK7knQ = (of3it1eHtxHAjg0dg.PoIl3Cpq8fMbK7knQ) new of3it1eHtxHAjg0dg.wJVN2aVawIsW1tSev();
          // ISSUE: reference to a compiler-generated field
          ((of3it1eHtxHAjg0dg.wJVN2aVawIsW1tSev) poIl3Cpq8fMbK7knQ).WRZyRHw3elUTK4rf5 = new HashSet<string>(((IEnumerable<LibraryDependency>) pvrEzbZhFd2PpiQqF.aKxwewXU1hUtckVuW).Select<LibraryDependency, string>((Func<LibraryDependency, string>) (p9m24sTrN3fqgIhF9 => p9m24sTrN3fqgIhF9.Name)), (IEqualityComparer<string>) StringComparer.OrdinalIgnoreCase);
          // ISSUE: reference to a compiler-generated method
          libraryDependencyList.AddRange(((IEnumerable<KeyValuePair<string, CentralPackageVersion>>) pvrEzbZhFd2PpiQqF.IhsBmdd6z9vUsugsz).Where<KeyValuePair<string, CentralPackageVersion>>(new Func<KeyValuePair<string, CentralPackageVersion>, bool>(poIl3Cpq8fMbK7knQ.JZTz6J0L6pJdoAfD0)).Select<KeyValuePair<string, CentralPackageVersion>, LibraryDependency>((Func<KeyValuePair<string, CentralPackageVersion>, LibraryDependency>) (FMehvoUxuA8Z6qJce => new LibraryDependency()
          {
            LibraryRange = new LibraryRange(FMehvoUxuA8Z6qJce.Value.Name, FMehvoUxuA8Z6qJce.Value.VersionRange, (LibraryDependencyTarget) 1),
            VersionCentrallyManaged = true,
            ReferenceType = (LibraryDependencyReferenceType) 0
          })));
        }
        libraryDependencyList.RemoveAll((Predicate<LibraryDependency>) (_param1 => _param1.LibraryRange.TypeConstraint == 16));
        for (int index = 0; index < libraryDependencyList.Count; ++index)
        {
          libraryDependencyList[index] = libraryDependencyList[index].Clone();
          LibraryRange libraryRange = libraryDependencyList[index].LibraryRange;
          libraryRange.TypeConstraint = (LibraryDependencyTarget) (libraryRange.TypeConstraint & 65533);
        }
      }
      return libraryDependencyList;
    }

    private IEnumerable<string> CJ0Zw23wD1VrydiqA(IEnumerable<LibraryDependency> _param1)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      of3it1eHtxHAjg0dg.PoIl3Cpq8fMbK7knQ poIl3Cpq8fMbK7knQ = new of3it1eHtxHAjg0dg.PoIl3Cpq8fMbK7knQ(-2);
      // ISSUE: reference to a compiler-generated field
      ((of3it1eHtxHAjg0dg.Vji8vFnyHT4PvuoWS) poIl3Cpq8fMbK7knQ).lskmlXtzcfvclD7vf = this;
      // ISSUE: reference to a compiler-generated field
      ((of3it1eHtxHAjg0dg.Vji8vFnyHT4PvuoWS) poIl3Cpq8fMbK7knQ).twbT4S7cWxxrPfwSG = _param1;
      return (IEnumerable<string>) poIl3Cpq8fMbK7knQ;
    }

    private bool irC9jv06eIl3BcK6u(LibraryDependency yDFYxNV9vC89JEspP) => this.R3atCwvOJFrn6jxvQ(yDFYxNV9vC89JEspP.LibraryRange.TypeConstraint);

    private List<xgwjkEc2LOe4C37KE> hgee0IbuB7HCDsIeE(
      xgwjkEc2LOe4C37KE OJYBBxoyRTlRbmUCd)
    {
      List<xgwjkEc2LOe4C37KE> xgwjkEc2Loe4C37KeList = new List<xgwjkEc2LOe4C37KE>(OJYBBxoyRTlRbmUCd.\u003960SM1bVJwdV8kApm.Count);
      foreach (string str in (IEnumerable<string>) OJYBBxoyRTlRbmUCd.\u003960SM1bVJwdV8kApm)
      {
        xgwjkEc2LOe4C37KE xgwjkEc2Loe4C37Ke;
        if (!this.EjMCHhBJZGZ7zab7T.TryGetValue(str, out xgwjkEc2Loe4C37Ke))
          xgwjkEc2Loe4C37Ke = new xgwjkEc2LOe4C37KE(str, (sADkOtSpqiDlZWiPV) null, (string) null, Enumerable.Empty<string>());
        xgwjkEc2Loe4C37KeList.Add(xgwjkEc2Loe4C37Ke);
      }
      return xgwjkEc2Loe4C37KeList;
    }
  }
}
