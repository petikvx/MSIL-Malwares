// Decompiled with JetBrains decompiler
// Type: s971362645928148.s716381183111669
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s023899791179097;
using s077414222832753;
using s134854913015584;
using s197510435680660;
using s651029396580935;
using s668890993111249;
using s719272214711671;
using s928707304529159;
using s941238214429226;
using s995882755561673;
using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace s971362645928148
{
  public class s716381183111669 : s293547439506271
  {
    private static s716381183111669.s016312675395415 s993234079054880 = (s716381183111669.s016312675395415) new s716381183111669.s816279880472416();
    private static s716381183111669.s016312675395415 s989855287002117 = (s716381183111669.s016312675395415) new s716381183111669.s816279880472416()
    {
      s696922472112451 = true
    };
    private static s716381183111669.s016312675395415 s045685447443817;
    private double s007533233240020;
    private double s690188834524280;
    private s716381183111669.s816279880472416[] s392053981051237;
    private Regex[] s685850363974274;
    private Regex[] s390813079784805;
    private Regex[] s975547725708464;
    private bool[] s993751179640318;
    private s293547439506271 s754269167025853;
    private s125354240788400 s900188820168346;
    private s716381183111669.s016312675395415[] s983055518863121;
    private Dictionary<string, s275977756270514> s868323531426711;
    private Dictionary<string, s716381183111669.s016312675395415> s409515960667961;
    private const int s823943868750491 = 32768;
    private s716381183111669.s267972733059088[] s643528405834909;

    public s716381183111669(
      s283032326168775 filterParams,
      s293547439506271 stackSource,
      s125354240788400 scalingPolicy)
    {
      this.s754269167025853 = stackSource;
      this.s900188820168346 = scalingPolicy;
      if (!double.TryParse(filterParams.s541940436972090, out this.s007533233240020))
        this.s007533233240020 = double.NegativeInfinity;
      if (!double.TryParse(filterParams.s599780331722104, out this.s690188834524280))
        this.s690188834524280 = double.PositiveInfinity;
      this.s007533233240020 -= 0.0006;
      this.s690188834524280 += 0.0006;
      this.s685850363974274 = s716381183111669.s284677370974771(filterParams.s523842455414568);
      this.s390813079784805 = s716381183111669.s284677370974771(filterParams.s017494779502056);
      this.s975547725708464 = s716381183111669.s284677370974771(filterParams.s900401213371434);
      this.s392053981051237 = s716381183111669.s351522835459240(filterParams.s565448980629702);
      if (stackSource.s331617956897716 > 0)
      {
        this.s993751179640318 = new bool[stackSource.s331617956897716];
        int[] s398638810250111 = filterParams.s398638810250111;
        if (s398638810250111 != null)
        {
          foreach (int index in s398638810250111)
            this.s993751179640318[index] = true;
        }
      }
      else
        this.s993751179640318 = (bool[]) null;
      this.s983055518863121 = new s716381183111669.s016312675395415[this.s754269167025853.s868310773649162];
      this.s868323531426711 = new Dictionary<string, s275977756270514>();
      this.s643528405834909 = new s716381183111669.s267972733059088[32768];
      for (int index = 0; index < this.s643528405834909.Length; ++index)
        this.s643528405834909[index] = (s716381183111669.s267972733059088) new s716381183111669.s016312675395415(this.s685850363974274.Length);
    }

    public virtual void s373693204741505(Action<s124232551204041> s368565408040762)
    {
      // ISSUE: variable of a compiler-generated type
      s716381183111669.s251670031539355 s251670031539355 = (s716381183111669.s251670031539355) new s716381183111669.s267972733059088();
      ((s716381183111669.s267972733059088) s251670031539355).s391946408917737 = this;
      // ISSUE: reference to a compiler-generated field
      s251670031539355.s719966254720293 = s368565408040762;
      // ISSUE: reference to a compiler-generated method
      Action<s124232551204041> action = new Action<s124232551204041>(s251670031539355.s516097883678505);
      if (this.s754269167025853 is s745425401863632 s754269167025853)
        s754269167025853.s186711448686366(action, this.s993751179640318);
      else
        this.s754269167025853.s827465297263042(action);
    }

    public virtual s457867646003930 s658674364808060(
      s457867646003930 s713273247925110)
    {
      return this.s566780691473894(s713273247925110).s206114191012097;
    }

    public virtual int s608831526904079(s457867646003930 s563844014986519) => this.s566780691473894(s563844014986519).s257338086544066;

    public virtual s275977756270514 s763366793429254(
      s457867646003930 s912372459171395)
    {
      return this.s566780691473894(s912372459171395).s316061743959032;
    }

    public virtual string s512870145142117(s275977756270514 s862500540172113, bool s997373310506794)
    {
      s716381183111669.s016312675395415 s016312675395415 = this.s161836851209957(s862500540172113);
      if (s016312675395415.s988077253596905 == null)
        return this.s754269167025853.s421928177288618(s862500540172113, s997373310506794);
      return s016312675395415.s033915303560097 ? s016312675395415.s988077253596905 + " <<" + this.s754269167025853.s421928177288618(s862500540172113, false) + ">>" : s016312675395415.s988077253596905;
    }

    public virtual double s506320422030687 => Math.Min(this.s690188834524280, this.s754269167025853.s276972581928406);

    public virtual int s229175712289614 => this.s754269167025853.s331617956897716;

    public virtual int s336486152452349 => this.s754269167025853.s746014364480903;

    public virtual int s469265664797560 => this.s754269167025853.s868310773649162;

    public virtual s124232551204041 s314133039628741(
      s745426657201161 s237307174279904)
    {
      return this.s754269167025853.s088475888872450(s237307174279904);
    }

    public virtual s293547439506271 s262397127289481 => this.s754269167025853;

    public virtual bool s672155892655778 => this.s754269167025853.s517254629407712;

    public virtual void s304877539366435(
      s745426657201161 s167794919217801,
      s432179660757635 s393760097136652,
      Action<s745426657201161> s561093256747829)
    {
      this.s754269167025853.s967399563833280(s167794919217801, s393760097136652, s561093256747829);
    }

    public virtual int s610375447461019 => this.s754269167025853.s297715170777068;

    private s716381183111669.s267972733059088 s566780691473894(
      s457867646003930 s033832857590430,
      s455848080656944 s808864425834735 = default (s455848080656944))
    {
      if (s808864425834735.s635804596355064)
      {
        // ISSUE: object of a compiler-generated type is created
        // ISSUE: variable of a compiler-generated type
        s716381183111669.s180162062356596 s180162062356596 = (s716381183111669.s180162062356596) new s716381183111669.s251670031539355();
        // ISSUE: reference to a compiler-generated field
        ((s716381183111669.s251670031539355) s180162062356596).s243457634717110 = this;
        // ISSUE: reference to a compiler-generated field
        s180162062356596.s414735676617427 = s033832857590430;
        // ISSUE: reference to a compiler-generated field
        s180162062356596.s672728330577188 = s808864425834735;
        // ISSUE: reference to a compiler-generated method
        return Task.Factory.StartNew<s716381183111669.s267972733059088>(new Func<s716381183111669.s267972733059088>(s180162062356596.s776627563297647), TaskCreationOptions.LongRunning).GetAwaiter().GetResult();
      }
      s716381183111669.s267972733059088 s123856158625389 = this.s643528405834909[(int) (s033832857590430 & (s457867646003930) 32767)];
      if (((s716381183111669.s016312675395415) s123856158625389).s939721727889639 != s033832857590430)
      {
        if (s123856158625389.s520482267599987)
          s123856158625389 = (s716381183111669.s267972733059088) new s716381183111669.s016312675395415(this.s685850363974274.Length);
        s123856158625389.s520482267599987 = true;
        this.s039147101838711(s033832857590430, s123856158625389, s808864425834735);
        s123856158625389.s520482267599987 = false;
      }
      return s123856158625389;
    }

    private void s039147101838711(
      s457867646003930 s911052738865992,
      s716381183111669.s267972733059088 s123856158625389,
      s455848080656944 s728328673303754)
    {
      ((s716381183111669.s016312675395415) s123856158625389).s939721727889639 = s911052738865992;
      s123856158625389.s206114191012097 = this.s754269167025853.s578756348595744(s911052738865992);
      s123856158625389.s006128330853459 = (bool[]) null;
      s123856158625389.s257338086544066 = 0;
      s716381183111669.s267972733059088 s267972733059088 = (s716381183111669.s267972733059088) null;
      if (s123856158625389.s206114191012097 != s457867646003930.Invalid)
      {
        s267972733059088 = this.s566780691473894(s123856158625389.s206114191012097, s728328673303754.s914208791137207);
        if (s267972733059088.s316061743959032 == s275977756270514.Discard)
        {
          s123856158625389.s316061743959032 = s275977756270514.Discard;
          return;
        }
      }
      s275977756270514 s107622560983965 = this.s754269167025853.s275938953343520(s911052738865992);
      s123856158625389.s215809406121210 = this.s161836851209957(s107622560983965);
      if (((s716381183111669.s816279880472416) s123856158625389.s215809406121210).s696922472112451)
      {
        s123856158625389.s316061743959032 = s275977756270514.Discard;
      }
      else
      {
        s123856158625389.s316061743959032 = s107622560983965;
        if (s123856158625389.s215809406121210.s988077253596905 != null)
        {
          if (s123856158625389.s215809406121210.s033915303560097)
          {
            if (s267972733059088 != null && s267972733059088.s215809406121210 != null && s123856158625389.s215809406121210.s306273661999144 == s267972733059088.s215809406121210.s306273661999144)
              s123856158625389.s316061743959032 = s267972733059088.s316061743959032;
          }
          else
            s123856158625389.s316061743959032 = s123856158625389.s215809406121210.s306273661999144;
        }
        if (s267972733059088 != null)
        {
          bool flag = false;
          if (s123856158625389.s215809406121210.s329924209723057 || s123856158625389.s316061743959032 == s267972733059088.s316061743959032)
            flag = true;
          else if (s123856158625389.s215809406121210.s765678098244583 && s267972733059088.s215809406121210.s765678098244583)
            flag = this.s754269167025853.s421928177288618(s267972733059088.s316061743959032, true) == this.s754269167025853.s421928177288618(s123856158625389.s316061743959032, true);
          if (flag)
          {
            bool s329924209723057 = s123856158625389.s215809406121210.s329924209723057;
            s123856158625389.s487180610660431(s267972733059088);
            if (!s329924209723057)
              return;
            ++s123856158625389.s257338086544066;
            return;
          }
        }
        s123856158625389.s918509424983070(s267972733059088);
        s123856158625389.s088337003190072(s123856158625389.s215809406121210.s051129971911697);
      }
    }

    private s716381183111669.s016312675395415 s161836851209957(
      s275977756270514 s107622560983965)
    {
      s716381183111669.s016312675395415 s016312675395415_1 = this.s983055518863121[(int) s107622560983965];
      if (s016312675395415_1 != null)
        return s016312675395415_1;
      string str = this.s754269167025853.s421928177288618(s107622560983965, true);
      string key1 = str;
      if (this.s409515960667961 == null)
        this.s409515960667961 = new Dictionary<string, s716381183111669.s016312675395415>();
      if (this.s409515960667961.TryGetValue(str, out s016312675395415_1))
      {
        this.s983055518863121[(int) s107622560983965] = s016312675395415_1;
        return s016312675395415_1;
      }
      bool s639766973122910;
      string key2 = this.s644491773363416(str, out s639766973122910);
      if (key2 == null && str.EndsWith("!?"))
      {
        key2 = this.s754269167025853.s421928177288618(s107622560983965, false);
        s639766973122910 = false;
      }
      s716381183111669.s016312675395415 s016312675395415_2;
      if (key2 != null)
      {
        s275977756270514 index = s275977756270514.Invalid;
        if (!this.s868323531426711.TryGetValue(key2, out index))
        {
          this.s868323531426711.Add(key2, s107622560983965);
          index = s107622560983965;
        }
        str = key2;
        if (s639766973122910)
          str = key2 + " <<" + this.s754269167025853.s421928177288618(s107622560983965, false) + ">>";
        int[] s667130339744748 = (int[]) null;
        s016312675395415_2 = this.s983055518863121[(int) index];
        if (s016312675395415_2 != null & s639766973122910)
        {
          if (s016312675395415_2 == s716381183111669.s989855287002117 || s016312675395415_2 == s716381183111669.s045685447443817)
          {
            s016312675395415_2 = (s716381183111669.s016312675395415) null;
          }
          else
          {
            s667130339744748 = s716381183111669.s731797783693111(this.s685850363974274, str);
            if (!this.s007953728132626(s667130339744748, s016312675395415_2.s051129971911697))
              s016312675395415_2 = (s716381183111669.s016312675395415) null;
          }
        }
        if (s016312675395415_2 == null)
        {
          s016312675395415_2 = (s716381183111669.s016312675395415) new s716381183111669.s816279880472416();
          s016312675395415_2.s033915303560097 = s639766973122910;
          s016312675395415_2.s306273661999144 = index;
          s016312675395415_2.s988077253596905 = key2;
          if (s667130339744748 == null)
            s667130339744748 = s716381183111669.s731797783693111(this.s685850363974274, str);
          s016312675395415_2.s051129971911697 = s667130339744748;
        }
      }
      else
      {
        bool flag = str.Contains(".MoveNext()");
        int[] numArray = s716381183111669.s731797783693111(this.s685850363974274, str);
        if (numArray != null | flag)
        {
          s016312675395415_2 = (s716381183111669.s016312675395415) new s716381183111669.s816279880472416();
          s016312675395415_2.s051129971911697 = numArray;
          s016312675395415_2.s765678098244583 = flag;
        }
        else
          s016312675395415_2 = s716381183111669.s993234079054880;
      }
      if (s716381183111669.s728376327378326(this.s390813079784805, str) >= 0)
        s016312675395415_2 = s716381183111669.s989855287002117;
      else if (s716381183111669.s728376327378326(this.s975547725708464, str) >= 0)
        s016312675395415_2 = s716381183111669.s045685447443817;
      if (this.s409515960667961.Count < 4096 && key1.Contains("!?"))
        this.s409515960667961[key1] = s016312675395415_2;
      this.s983055518863121[(int) s107622560983965] = s016312675395415_2;
      return s016312675395415_2;
    }

    private static s716381183111669.s816279880472416[] s351522835459240(
      string s536269930957017)
    {
      string str1 = Regex.Replace(s536269930957017, "^\\s*(\\[.*?\\])?\\s*(.*?)\\s*$", "$2");
      if (str1.Length == 0)
        return new s716381183111669.s816279880472416[0];
      string[] strArray = str1.Split(';');
      s716381183111669.s816279880472416[] s816279880472416Array = new s716381183111669.s816279880472416[strArray.Length];
      for (int index = 0; index < s816279880472416Array.Length; ++index)
      {
        string str2 = strArray[index].Trim();
        if (str2.Length != 0)
        {
          string op = "=>";
          int length = str2.IndexOf("=>");
          if (length < 0)
          {
            op = "->";
            length = str2.IndexOf("->");
          }
          string groupNameTemplate = "$&";
          string s845462448012348;
          if (length >= 0)
          {
            s845462448012348 = str2.Substring(0, length);
            int startIndex = length + 2;
            groupNameTemplate = str2.Substring(startIndex, str2.Length - startIndex).Trim();
          }
          else
            s845462448012348 = str2;
          Regex pattern = new Regex(s716381183111669.s514811400905258(s845462448012348), RegexOptions.IgnoreCase);
          // ISSUE: object of a compiler-generated type is created
          s816279880472416Array[index] = (s716381183111669.s816279880472416) new s745425401863632.s426725258447573(pattern, groupNameTemplate, op);
          if (str2 == "{%}!=>module $1")
          {
            // ISSUE: reference to a compiler-generated field
            ((s745425401863632.s426725258447573) s816279880472416Array[index]).s208213821029928 = true;
          }
        }
      }
      return s816279880472416Array;
    }

    private string s644491773363416(string s173030350728032, out bool s639766973122910)
    {
      s639766973122910 = false;
      string str1 = (string) null;
      for (int index1 = 0; index1 < this.s392053981051237.Length; ++index1)
      {
        // ISSUE: object of a compiler-generated type is created
        // ISSUE: variable of a compiler-generated type
        s716381183111669.s960755268024677 s960755268024677 = (s716381183111669.s960755268024677) new s716381183111669.s180162062356596();
        s716381183111669.s816279880472416 s816279880472416 = this.s392053981051237[index1];
        if (s816279880472416 != null)
        {
          // ISSUE: reference to a compiler-generated field
          if (((s745425401863632.s426725258447573) s816279880472416).s208213821029928)
          {
            int num = s173030350728032.IndexOf('!');
            if (0 < num)
            {
              int index2;
              for (index2 = num - 1; 0 <= index2; --index2)
              {
                char c = s173030350728032[index2];
                if (!char.IsLetterOrDigit(c) && c != '.' && c != '_')
                  break;
              }
              int startIndex = index2 + 1;
              string str2 = "module " + s173030350728032.Substring(startIndex, num - startIndex);
              s639766973122910 = true;
              return str2;
            }
          }
          else
          {
            // ISSUE: reference to a compiler-generated field
            ((s716381183111669.s180162062356596) s960755268024677).s205473861446895 = s816279880472416.s599040850341568.Match(s173030350728032);
            // ISSUE: reference to a compiler-generated field
            if (((s716381183111669.s180162062356596) s960755268024677).s205473861446895.Success)
            {
              str1 = s816279880472416.s040323477542243;
              if (s816279880472416.s625464420622034)
              {
                // ISSUE: reference to a compiler-generated method
                // ISSUE: reference to a compiler-generated field
                // ISSUE: reference to a compiler-generated field
                str1 = !(str1 == "$&") ? Regex.Replace(Regex.Replace(s816279880472416.s040323477542243, "\\$(\\d)", new MatchEvaluator(s960755268024677.s692052975076256)), "\\$&", ((s716381183111669.s180162062356596) s960755268024677).s205473861446895.Groups[0].Value) : ((s716381183111669.s180162062356596) s960755268024677).s205473861446895.Groups[0].Value;
              }
              s639766973122910 = s816279880472416.s129976898262213;
              if (str1.Length == 0)
                return (string) null;
              if (s639766973122910)
                return str1;
              s173030350728032 = str1;
            }
          }
        }
      }
      return str1;
    }

    private static Regex[] s284677370974771(string s413940986869114)
    {
      s413940986869114 = s413940986869114.Trim();
      if (s413940986869114.Length == 0)
        return new Regex[0];
      string[] strArray = s413940986869114.Split(';');
      Regex[] regexArray = new Regex[strArray.Length];
      for (int index = 0; index < regexArray.Length; ++index)
      {
        string s845462448012348 = strArray[index].Trim();
        if (s845462448012348.Length > 0)
          regexArray[index] = new Regex(s716381183111669.s514811400905258(s845462448012348), RegexOptions.IgnoreCase);
      }
      return regexArray;
    }

    private static int s728376327378326(Regex[] s305458731635134, string s355226116417524)
    {
      for (int index = 0; index < s305458731635134.Length; ++index)
      {
        Regex regex = s305458731635134[index];
        if (regex != null && regex.IsMatch(s355226116417524))
          return index;
      }
      return -1;
    }

    private static int[] s731797783693111(Regex[] s537467209927390, string s163933043960861)
    {
      int[] sourceArray = (int[]) null;
      int length = 0;
      for (int index = 0; index < s537467209927390.Length; ++index)
      {
        Regex regex = s537467209927390[index];
        if (regex != null && regex.IsMatch(s163933043960861))
        {
          int[] destinationArray = new int[length + 1];
          if (length > 0)
            Array.Copy((Array) sourceArray, (Array) destinationArray, length);
          destinationArray[length] = index;
          sourceArray = destinationArray;
          ++length;
        }
      }
      return sourceArray;
    }

    private bool s007953728132626(int[] s667130339744748, int[] s998740867121866)
    {
      if (s667130339744748 == null)
        return s998740867121866 == null;
      if (s998740867121866 == null || s667130339744748.Length != s998740867121866.Length)
        return false;
      for (int index = 0; index < s667130339744748.Length; ++index)
      {
        if (s667130339744748[index] != s998740867121866[index])
          return false;
      }
      return true;
    }

    public static string s514811400905258(string s845462448012348)
    {
      if (s845462448012348.StartsWith("@"))
        return s845462448012348.Substring(1);
      s845462448012348 = Regex.Escape(s845462448012348);
      s845462448012348 = s845462448012348.Replace("%", "[.\\w\\d?]*");
      s845462448012348 = s845462448012348.Replace("\\*", ".*");
      s845462448012348 = s845462448012348.Replace("\\^", "^");
      s845462448012348 = s845462448012348.Replace("\\|", "|");
      s845462448012348 = s845462448012348.Replace("\\{", "(");
      s845462448012348 = s845462448012348.Replace("}", ")");
      return s845462448012348;
    }

    static s716381183111669()
    {
      s716381183111669.s816279880472416 s816279880472416 = new s716381183111669.s816279880472416();
      ((s716381183111669.s016312675395415) s816279880472416).s329924209723057 = true;
      s716381183111669.s045685447443817 = (s716381183111669.s016312675395415) s816279880472416;
    }

    private class s816279880472416
    {
      public Regex s599040850341568;
      public string s040323477542243;
      public bool s129976898262213;
      public bool s696922472112451;

      public bool s625464420622034 => this.s040323477542243.IndexOf('$') >= 0;

      public virtual string s375586434076038() => string.Format("{0}->{1}", (object) this.s599040850341568, (object) this.s040323477542243);

      private s816279880472416()
      {
      }

      public s816279880472416() => ((s716381183111669.s016312675395415) this).s306273661999144 = s275977756270514.Invalid;
    }

    private class s016312675395415
    {
      public bool s329924209723057;
      public bool s765678098244583;
      public bool s033915303560097;
      public s275977756270514 s306273661999144;
      public string s988077253596905;
      public int[] s051129971911697;
      public s457867646003930 s939721727889639;

      public s016312675395415(int numIncPats)
      {
        this.s939721727889639 = s457867646003930.Invalid;
        if (numIncPats <= 0)
          return;
        ((s716381183111669.s267972733059088) this).s371308374009969 = new bool[numIncPats];
      }
    }

    private class s267972733059088
    {
      public s457867646003930 s206114191012097;
      public s275977756270514 s316061743959032;
      internal s716381183111669.s016312675395415 s215809406121210;
      internal int s257338086544066;
      internal bool s520482267599987;
      internal bool[] s006128330853459;
      internal bool[] s371308374009969;
      public s716381183111669 s391946408917737;

      internal void s487180610660431(s716381183111669.s267972733059088 s061044631439750)
      {
        this.s316061743959032 = s061044631439750.s316061743959032;
        this.s257338086544066 = s061044631439750.s257338086544066;
        this.s206114191012097 = s061044631439750.s206114191012097;
        this.s215809406121210 = s061044631439750.s215809406121210;
        this.s918509424983070(s061044631439750);
      }

      internal void s918509424983070(s716381183111669.s267972733059088 s370044086547852)
      {
        if (s370044086547852 == null || s370044086547852.s006128330853459 == null)
        {
          this.s006128330853459 = (bool[]) null;
        }
        else
        {
          this.s006128330853459 = this.s371308374009969;
          for (int index = 0; index < this.s006128330853459.Length; ++index)
            this.s006128330853459[index] = s370044086547852.s006128330853459[index];
        }
      }

      internal void s088337003190072(int[] s414518414914272)
      {
        if (s414518414914272 == null)
          return;
        if (this.s006128330853459 == null)
        {
          this.s006128330853459 = this.s371308374009969;
          for (int index = 0; index < this.s006128330853459.Length; ++index)
            this.s006128330853459[index] = false;
        }
        for (int index = 0; index < s414518414914272.Length; ++index)
          this.s006128330853459[s414518414914272[index]] = true;
      }

      internal bool s378166220115025
      {
        get
        {
          if (this.s006128330853459 == null)
            return this.s371308374009969 == null;
          for (int index = 0; index < this.s006128330853459.Length; ++index)
          {
            if (!this.s006128330853459[index])
              return false;
          }
          return true;
        }
      }
    }
  }
}
