// Decompiled with JetBrains decompiler
// Type: CiscoAnyconnectControl.UI.ViewModel.DebugViewModel
// Assembly: CompilerMarshalOverr, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 887C44A2-E14E-47D6-B77E-29DEF9E8CB8C
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.06\HEUR-Email-Worm.MSIL.LovGate.gen-cd6f56158196fbf736ea4b7487025de6e7a628d7f1f508a39879631018dcc9e0.exe

using CiscoAnyconnectControl.UI.Command;
using CiscoAnyconnectControl.Utility;
using System;
using System.Diagnostics;
using System.Security.Principal;
using System.Windows;

namespace CiscoAnyconnectControl.UI.ViewModel
{
  internal class DebugViewModel
  {
    public RelayCommand OpenExplorerInProcDir => new RelayCommand((Func<bool>) (() => true), (Action) (() => Process.Start(Util.AssemblyDirectory)));

    public RelayCommand RestartServiceCommand => new RelayCommand((Func<bool>) (() => true), (Action) (() => DebugViewModel.IsAdministrator()));

    public RelayCommand StopServiceCommand => new RelayCommand((Func<bool>) (() => true), (Action) (() => DebugViewModel.IsAdministrator()));

    public RelayCommand StartServiceCommand => new RelayCommand((Func<bool>) (() => true), (Action) (() => DebugViewModel.IsAdministrator()));

    private static bool IsAdministrator()
    {
      bool flag = new WindowsPrincipal(WindowsIdentity.GetCurrent()).IsInRole(WindowsBuiltInRole.Administrator);
      if (!flag)
      {
        int num = (int) MessageBox.Show("This process isnt started as admin, but is required for this command.");
      }
      return flag;
    }
  }
}
