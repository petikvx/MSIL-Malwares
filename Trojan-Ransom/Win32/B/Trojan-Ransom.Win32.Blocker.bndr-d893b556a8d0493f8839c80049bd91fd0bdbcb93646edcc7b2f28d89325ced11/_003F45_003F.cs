// Decompiled with JetBrains decompiler
// Type: ?45?
// Assembly: wLoader, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 89823795-D5B3-4CC9-949D-6649607AF138
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00080-msil\Trojan-Ransom.Win32.Blocker.bndr-d893b556a8d0493f8839c80049bd91fd0bdbcb93646edcc7b2f28d89325ced11.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Security.Cryptography;
using System.Security.Principal;
using System.Text;
using System.Xml;

public class \u003F45\u003F : \u003F27\u003F
{
  private \u003F42\u003F \u003F0\u003F;
  private byte[] \u003F0\u003F;

  public \u003F45\u003F(\u003F42\u003F _param1) => this.\u003F0\u003F = _param1;

  private void \u003F0\u003F()
  {
    \u003F42\u003F obj = this.\u003F0\u003F;
    int num1 = 0;
    ulong[] staticFeatureCounts;
    Dictionary<string, ulong> dynamicFeatureCounts;
    MemoryStream w;
    XmlWriter xmlWriter;
    while (true)
    {
      switch (num1)
      {
        case 0:
          this.\u003F0\u003F = (\u003F42\u003F) null;
          num1 = 1;
          continue;
        case 1:
          if (this.\u003F0\u003F == null && obj != null && !obj.IsEmpty)
          {
            staticFeatureCounts = obj.StaticFeatureCounts;
            num1 = 2;
            continue;
          }
          goto label_63;
        case 2:
          dynamicFeatureCounts = obj.DynamicFeatureCounts;
          num1 = 3;
          continue;
        case 3:
          w = new MemoryStream();
          num1 = 4;
          continue;
        case 4:
          xmlWriter = (XmlWriter) new XmlTextWriter((Stream) w, (Encoding) new UTF8Encoding(false));
          num1 = 5;
          continue;
        case 5:
          xmlWriter.WriteStartDocument();
          num1 = 6;
          continue;
        case 6:
          using (new \u003F35\u003F(xmlWriter, \u003F20\u003F.\u003F53\u003F(2034)))
          {
            xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2051), \u003F20\u003F.\u003F53\u003F(965).ToUpper());
            int num2 = 0;
            WindowsIdentity current1;
            SecurityIdentifier user;
            while (true)
            {
              switch (num2)
              {
                case 0:
                  xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2068), DateTime.Now.ToString(\u003F20\u003F.\u003F53\u003F(2081)));
                  num2 = 1;
                  continue;
                case 1:
                  xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2086), Guid.NewGuid().ToString(\u003F20\u003F.\u003F53\u003F(2099)));
                  num2 = 2;
                  continue;
                case 2:
                  current1 = WindowsIdentity.GetCurrent();
                  num2 = 3;
                  continue;
                case 3:
                  user = current1.User;
                  num2 = 4;
                  continue;
                case 4:
                  string str;
                  using (MD5CryptoServiceProvider cryptoServiceProvider = new MD5CryptoServiceProvider())
                    str = new Guid(cryptoServiceProvider.ComputeHash(Encoding.Unicode.GetBytes(user.ToString()))).ToString();
                  xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2104), str);
                  num2 = 5;
                  continue;
                default:
                  goto label_23;
              }
            }
label_23:
            using (new \u003F35\u003F(xmlWriter, \u003F20\u003F.\u003F53\u003F(2113)))
              xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2130), \u003F20\u003F.\u003F53\u003F(2139));
            using (new \u003F35\u003F(xmlWriter, \u003F20\u003F.\u003F53\u003F(2144)))
            {
              int index = 0;
              int num3 = 0;
              while (true)
              {
                switch (num3)
                {
                  case 0:
label_37:
                    if (index < staticFeatureCounts.Length)
                    {
                      if (staticFeatureCounts[index] > 0UL)
                      {
                        xmlWriter.WriteStartElement(\u003F20\u003F.\u003F53\u003F(2157));
                        num3 = 1;
                        continue;
                      }
                      break;
                    }
                    goto label_41;
                  case 1:
                    xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2170), index.ToString());
                    num3 = 2;
                    continue;
                  case 2:
                    xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2130), staticFeatureCounts[index].ToString());
                    num3 = 3;
                    continue;
                  default:
                    xmlWriter.WriteEndElement();
                    break;
                }
                ++index;
                goto label_37;
              }
            }
label_41:
            using (new \u003F35\u003F(xmlWriter, \u003F20\u003F.\u003F53\u003F(2175)))
            {
              using (Dictionary<string, ulong>.Enumerator enumerator = dynamicFeatureCounts.GetEnumerator())
              {
label_51:
                while (enumerator.MoveNext())
                {
                  KeyValuePair<string, ulong> current2 = enumerator.Current;
                  int num4 = 0;
                  while (true)
                  {
                    switch (num4)
                    {
                      case 0:
                        if (current2.Value > 0UL)
                        {
                          xmlWriter.WriteStartElement(\u003F20\u003F.\u003F53\u003F(2157));
                          num4 = 1;
                          continue;
                        }
                        goto label_51;
                      case 1:
                        xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2196), current2.Key);
                        num4 = 2;
                        continue;
                      case 2:
                        xmlWriter.WriteAttributeString(\u003F20\u003F.\u003F53\u003F(2130), current2.Value.ToString());
                        num4 = 3;
                        continue;
                      default:
                        goto label_50;
                    }
                  }
label_50:
                  xmlWriter.WriteEndElement();
                }
              }
            }
          }
          xmlWriter.WriteEndDocument();
          num1 = 7;
          continue;
        case 7:
          xmlWriter.Flush();
          num1 = 8;
          continue;
        case 8:
          w.Flush();
          num1 = 9;
          continue;
        case 9:
          this.\u003F0\u003F = w.ToArray();
          num1 = 10;
          continue;
        default:
          goto label_4;
      }
    }
label_4:
    return;
label_63:;
  }

  public void \u003F65\u003F()
  {
    if (this.\u003F0\u003F == null)
      goto label_2;
label_1:
    this.\u003F0\u003F();
    this.\u003F0\u003F(this.\u003F0\u003F, \u003F27\u003F.\u003F9\u003F.\u003F0\u003F);
    return;
label_2:
    this.\u003F0\u003F = \u003F43\u003F.\u003F61\u003F();
    goto label_1;
  }
}
