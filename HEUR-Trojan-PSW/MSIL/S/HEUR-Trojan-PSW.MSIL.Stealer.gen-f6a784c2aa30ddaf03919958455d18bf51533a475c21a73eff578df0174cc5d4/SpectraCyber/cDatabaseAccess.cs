// Decompiled with JetBrains decompiler
// Type: SpectraCyber.cDatabaseAccess
// Assembly: STAThreadAttrib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6EE3DE1A-E148-4FBA-A193-65BEA1824C00
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-PSW.MSIL.Stealer.gen-f6a784c2aa30ddaf03919958455d18bf51533a475c21a73eff578df0174cc5d4.exe

using System.Data;
using System.Data.OleDb;
using System.Windows.Forms;

namespace SpectraCyber
{
  internal class cDatabaseAccess
  {
    protected OleDbDataAdapter mdaDataAdaptor;
    protected OleDbConnection mdbconnDBConnection;
    protected OleDbCommand mdbCommand;
    protected int miAffectedRows;
    protected string mstrDataSource;

    public cDatabaseAccess(string strDataSource)
    {
      this.mstrDataSource = strDataSource;
      this.mdbconnDBConnection = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strDataSource);
      this.miAffectedRows = 0;
    }

    public void Insert(string strSQL)
    {
      this.miAffectedRows = 0;
      this.mdbCommand = new OleDbCommand(strSQL, this.mdbconnDBConnection);
      this.miAffectedRows = this.mdbCommand.ExecuteNonQuery();
      this.mdbCommand.Dispose();
    }

    public void Update(string strSQL) => this.Insert(strSQL);

    public void FillDataTable(DataTable dtDataTable, string strSQL)
    {
      dtDataTable.Clear();
      this.mdaDataAdaptor = new OleDbDataAdapter(strSQL, this.mdbconnDBConnection);
      this.mdaDataAdaptor.Fill(dtDataTable);
      this.mdaDataAdaptor.Dispose();
    }

    public void FillDataGrid(DataGrid dgDataGrid, DataTable dtDataTable, string strSQL)
    {
      this.FillDataTable(dtDataTable, strSQL);
      dgDataGrid.DataSource = (object) dtDataTable;
    }

    public void Open() => this.mdbconnDBConnection.Open();

    public void Close() => this.mdbconnDBConnection.Close();

    public int AffectedRows => this.miAffectedRows;
  }
}
