// Decompiled with JetBrains decompiler
// Type: 190180155270.Core.671679572260
// Assembly: 190180155270, Version=7.6.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 20B0A582-54C5-4C64-BCB9-2AC73608F590
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-211b9bdeb7639f8b1f0606b7671a4d1fdbf246968b078ff103eac9aa4c2cd108.exe

using \u003190180155270.Core;
using \u003190180155270.Models;
using \u003190180155270.Utils;
using \u003243925834289;
using \u003503062988578;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003190180155270.Core
{
  public static class \u003671679572260
  {
    private static void \u003713536044235(
      string _param0,
      string _param1,
      Func<string, \u003269277736649> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003949962398284 obj1 = new \u003949962398284();
      obj1.\u003478358192263 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003949962398284 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003269277736649 obj3 = _param2(contents);
      string str1 = \u003671679572260.\u003305081083976(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003723284698795.\u003189367051361(obj3.\u003205033517783, path1);
        }
        catch (Exception ex)
        {
          ex.\u003037070552366();
          File.Delete(path1);
        }
      }
    }

    private static string \u003305081083976(\u003269277736649 _param0)
    {
      string str = Path.GetFileName(_param0.\u003205033517783).\u003871994040840();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003205033517783);
      return string.Empty;
    }

    public static void \u003524991002691()
    {
      string path1 = \u003396480275353.\u003686804831574();
      \u003936851208001 obj1 = \u003461646985882.\u003279811443080(path1);
      string str = obj1?.\u003504842281134;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003285306893484 obj2 = new \u003285306893484(str);
        ((\u003314300596915) obj2).\u003364092888245 = \u003461646985882.\u003443246014709();
        ((\u003314300596915) obj2).\u003573788658739 = obj1.\u003042181573209;
        ((\u003314300596915) obj2).\u003943514525293 = Color.DarkRed;
        ((\u003314300596915) obj2).\u003803027810611 = \u003007662646855.\u003520199398768;
        ((\u003314300596915) obj2).\u003234222390610 = \u003007662646855.\u003122627549029;
        ((\u003314300596915) obj2).\u003394401174734 = \u003007662646855.\u003520759558817;
        ((\u003314300596915) obj2).\u003655682386332 = \u003007662646855.\u003908565360296;
        ((\u003314300596915) obj2).\u003965124560310 = \u003007662646855.\u003913423968122;
        ((\u003314300596915) obj2).\u003284626520873 = \u003007662646855.\u003662957384841;
        ((\u003314300596915) obj2).\u003676593613067 = \u003007662646855.\u003280081834903;
        using (\u003314300596915 obj3 = (\u003314300596915) obj2)
        {
          using (Image image = obj3.\u003046492558502())
          {
            string filename;
            if (\u003095315323785.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003030721744602.\u003424271432526(filename);
            \u003030721744602.\u003056677561683(filename);
          }
        }
      }
    }
  }
}
