// Decompiled with JetBrains decompiler
// Type: s356530178478151.s302029464250094
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s077414222832753;
using s134096877844438;
using s134854913015584;
using s221898826379252;
using s502762629278250;
using s528813736053581;
using s651029396580935;
using s686708834606903;
using s709919977867792;
using s743898255106522;
using s786292081343583;
using s790378171014915;
using s874166642857481;
using s928707304529159;
using s953876051832419;
using System;
using System.Collections.Generic;

namespace s356530178478151
{
  public class s302029464250094 : s220468656497021
  {
    protected s645758109343855 m_Interner;
    protected s837522568912988 m_emptyModuleIdx;
    internal GrowableArray<s124232551204041> s188314013267977;
    private double s455626581341003;

    public s302029464250094(s953925013719849 log)
      : base(log)
    {
      this.m_Interner = new s645758109343855(frameStartIndex: ((s275977756270514) base.s773077944535749), callStackStartIndex: ((s457867646003930) base.s074221326370611));
      this.m_emptyModuleIdx = this.m_Interner.s419281735299726("");
      this.m_Interner.s696400992757193 = new Func<s275977756270514, bool, string>(((s936696832966474) this).s421928177288618);
    }

    public s124232551204041 s229179402187166(s124232551204041 s038351975629557)
    {
      s124232551204041 s124232551204041 = new s124232551204041(s038351975629557);
      s124232551204041.s506976182609173 = (s745426657201161) this.s188314013267977.Count;
      this.s188314013267977.Add(s124232551204041);
      if (s124232551204041.s413641156979027 > this.s455626581341003)
        this.s455626581341003 = s124232551204041.s413641156979027;
      return s124232551204041;
    }

    public void s388497926082394()
    {
      this.m_Interner.s784335591463612();
      this.s188314013267977.Sort((Comparison<s124232551204041>) ((s553258917843473, s455712009109382) =>
      {
        int num = s553258917843473.s413641156979027.CompareTo(s455712009109382.s413641156979027);
        return num != 0 ? num : ((int) s553258917843473.s953068594617511).CompareTo((int) s455712009109382.s953068594617511);
      }));
      for (int index = 0; index < this.s188314013267977.Count; ++index)
        this.s188314013267977[index].s506976182609173 = (s745426657201161) index;
    }

    public s645758109343855 s669246881012685 => this.m_Interner;

    public s457867646003930 s561098823525488(s572171018010254 s235158441393082) => (s457867646003930) (this.s811601286656942.s331550318228488.s205966286230606 + this.s811601286656942.s132713297009023.s141151785930897 + s235158441393082.s140946683671142);

    public s457867646003930 s261674902348917(s399735979708807 s023596590396244) => (s457867646003930) (this.s811601286656942.s331550318228488.s205966286230606 + s023596590396244.s519833341027850);

    public s457867646003930 s558725986227482(
      s147978847785798 s622999065633738,
      s399735979708807 s854799447814062)
    {
      if (s622999065633738 != s147978847785798.Invalid)
        return (s457867646003930) s622999065633738;
      return s854799447814062 == null ? s457867646003930.Invalid : this.s261674902348917(s854799447814062);
    }

    public s457867646003930 s494539732638569(
      s147978847785798 s217453562571924,
      s034852122986107 s624049610482389)
    {
      if (s217453562571924 != s147978847785798.Invalid)
        return (s457867646003930) s217453562571924;
      if (s624049610482389 == null)
        return s457867646003930.Invalid;
      s399735979708807 s023596590396244 = s624049610482389.s294168149113671();
      return s023596590396244 == null ? s457867646003930.Invalid : this.s261674902348917(s023596590396244);
    }

    public s457867646003930 s901088699129838(
      s147978847785798 s447843145259582,
      s457867646003930 s569049081354129,
      s302029464250094.CallStackMap s018794827454778 = null)
    {
      if (s447843145259582 == s147978847785798.Invalid)
        return s569049081354129;
      if (s018794827454778 != null)
      {
        // ISSUE: reference to a compiler-generated method
        s457867646003930 s457867646003930 = ((s220468656497021.s908318746148813) s018794827454778).Get(s447843145259582);
        if (s457867646003930 != s457867646003930.Invalid)
          return s457867646003930;
      }
      s275977756270514 s275977756270514 = this.s108856170662013(this.s811601286656942.s331550318228488.s772228772378070(s447843145259582));
      s147978847785798 s447843145259582_1 = this.s811601286656942.s331550318228488.s140621582222871(s447843145259582);
      s457867646003930 s506535691979223;
      if (s447843145259582_1 == s147978847785798.Invalid)
      {
        s506535691979223 = s569049081354129;
        if (!this.s932149717672746)
        {
          string strA = this.s421928177288618(s275977756270514, false);
          int num = strA.IndexOf('!');
          if (0 < num && (5 > num || string.Compare(strA, num - 5, "ntdll", 0, 5, StringComparison.OrdinalIgnoreCase) != 0))
            s506535691979223 = this.m_Interner.s649303816154062(this.m_Interner.s092839873163377("BROKEN", this.m_emptyModuleIdx), s506535691979223);
        }
      }
      else
        s506535691979223 = this.s901088699129838(s447843145259582_1, s569049081354129, s018794827454778);
      s457867646003930 s457867646003930_1 = this.m_Interner.s649303816154062(s275977756270514, s506535691979223);
      s018794827454778?.Put(s447843145259582, s457867646003930_1);
      return s457867646003930_1;
    }

    public s275977756270514 s108856170662013(s320811790897239 s510034554581839) => (s275977756270514) (4 + s510034554581839);

    public virtual s457867646003930 s242804379745646(
      s457867646003930 s414330070503467)
    {
      return this.m_Interner.s605232597024656 <= s414330070503467 ? this.m_Interner.s430028063152814(s414330070503467) : this.s377661580454549(s414330070503467);
    }

    public virtual s275977756270514 s101095468415519(
      s457867646003930 s043776881672668)
    {
      return this.m_Interner.s605232597024656 <= s043776881672668 ? this.m_Interner.s323927537074275(s043776881672668) : this.s300089447596357(s043776881672668);
    }

    public s837522568912988 s355101742953926(s275977756270514 s799388800643617) => this.m_Interner.s518224413015985 <= s799388800643617 ? this.m_Interner.s486240339109251(s799388800643617) : s837522568912988.Invalid;

    public virtual string s452825636452379(s275977756270514 s083207863336994, bool s515815542243638) => s083207863336994 >= (s275977756270514) base.s773077944535749 ? this.m_Interner.s225064114498404(s083207863336994, s515815542243638) : this.s368871343264692(s083207863336994, s515815542243638);

    public virtual s124232551204041 s219671564865954(
      s745426657201161 s165554507817574)
    {
      return this.s188314013267977[(int) s165554507817574];
    }

    public virtual int s360031660253740 => this.s188314013267977.Count;

    public virtual void s080439610504669(Action<s124232551204041> s291574762563237)
    {
      for (int index = 0; index < this.s188314013267977.Count; ++index)
        s291574762563237(this.s188314013267977[index]);
    }

    public virtual bool s888050595657809 => true;

    public virtual int s154598018865730 => base.s773077944535749 + this.m_Interner.s522124855833794;

    public virtual int s388175406895531 => base.s074221326370611 + this.m_Interner.s388701355735021;

    public virtual double s928472502630769 => this.s455626581341003;

    public interface CallStackMap
    {
      void Put(s147978847785798 key, s457867646003930 value);

      static CallStackMap() => s220468656497021.s908318746148813.s006005427682420 = new s302029464250094.s370166350307966();
    }
  }
}
