// Decompiled with JetBrains decompiler
// Type: explorer.Locator
// Assembly: explorer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 56E5CD67-A795-400A-AA93-F7890471D495
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00008-msil\Worm.MSIL.Autorun.ig-2c86700b4d3a736629e63a7f91f6e488e611145530107c5a2b53ad8867079764.exe

using System.IO;
using System.Net;
using System.Xml.Linq;

namespace explorer
{
  public class Locator
  {
    private const string ApiUrl = "http://ipinfodb.com/ip_query.php";

    public static string getIP()
    {
      HttpWebRequest httpWebRequest = WebRequest.Create("http://ipinfodb.com/ip_query.php") as HttpWebRequest;
      string s = string.Empty;
      try
      {
        using (StreamReader streamReader = new StreamReader((httpWebRequest.GetResponse() as HttpWebResponse).GetResponseStream()))
          s = streamReader.ReadToEnd();
        XElement xelement = XElement.Load((TextReader) new StringReader(s));
        return string.Compare((string) xelement.Element((XName) "Status"), "OK", true) != 0 ? (string) null : (string) xelement.Element((XName) "Ip");
      }
      catch
      {
        return "UNKW";
      }
    }

    public static string getLoc()
    {
      HttpWebRequest httpWebRequest = WebRequest.Create("http://ipinfodb.com/ip_query.php") as HttpWebRequest;
      string s = string.Empty;
      try
      {
        using (StreamReader streamReader = new StreamReader((httpWebRequest.GetResponse() as HttpWebResponse).GetResponseStream()))
          s = streamReader.ReadToEnd();
        XElement xelement = XElement.Load((TextReader) new StringReader(s));
        return string.Compare((string) xelement.Element((XName) "Status"), "OK", true) != 0 ? (string) null : (string) xelement.Element((XName) "CountryCode");
      }
      catch
      {
        return "UNKW";
      }
    }
  }
}
