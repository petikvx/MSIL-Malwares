// Decompiled with JetBrains decompiler
// Type: 9bLAsx6l855I1cqbt.FaEMjp17NWfxHKRk4
// Assembly: bouNMGxVgGi4SRgWO, Version=3.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60
// MVID: 3F6A2AF1-3CCB-4F01-AA36-FA31C2E4CFE8
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.Agent.gen-bc408b9f362db28b2e931ff336ec5661cc0ce27b0cdc0ce215fec1b7381aca7f.exe

using \u0035ulZ8bvUmtJDe5zB2;
using \u0035yG6AQnqh4vfLQDiK;
using \u0039bLAsx6l855I1cqbt;
using cxAS6kq65B7LEGBO6;
using jgXgR7N4oMF35Cxps;
using kwIfXHQbg6AIE1xa0;
using LnzgqduGr5G7V9Evt;
using Microsoft.TemplateEngine.Abstractions;
using Microsoft.TemplateEngine.Abstractions.Mount;
using Microsoft.TemplateEngine.Core;
using Microsoft.TemplateEngine.Core.Contracts;
using Microsoft.TemplateEngine.Core.Expressions.Cpp2;
using Microsoft.TemplateEngine.Core.Expressions.Shared;
using Microsoft.TemplateEngine.Core.Operations;
using S5rLCBT4dvZbpILSB;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using TOHuSQgMXTgIdQ9W7;
using yh0ebcH9Dvo58RtWO;

namespace \u0039bLAsx6l855I1cqbt
{
  public class FaEMjp17NWfxHKRk4 : IGlobalRunSpec
  {
    private static IReadOnlyDictionary<string, IOperationConfig> BjZA5Pl32N2y3l7vw;

    private static void btUFx5IsLKPt6zk8W(IComponentManager _param0)
    {
      if (FaEMjp17NWfxHKRk4.BjZA5Pl32N2y3l7vw != null)
        return;
      List<IOperationConfig> operationConfigList = new List<IOperationConfig>(_param0.OfType<IOperationConfig>());
      Dictionary<string, IOperationConfig> dictionary = new Dictionary<string, IOperationConfig>();
      foreach (IOperationConfig operationConfig in operationConfigList)
        dictionary[operationConfig.Key] = operationConfig;
      FaEMjp17NWfxHKRk4.BjZA5Pl32N2y3l7vw = (IReadOnlyDictionary<string, IOperationConfig>) dictionary;
    }

    public IReadOnlyList<IPathMatcher> m49eilZMPN7od0Xxu { get; private set; }

    public IReadOnlyList<IPathMatcher> B8ULvOoY5O0qYEz5Z { get; private set; }

    public IReadOnlyList<IPathMatcher> wEkhDs9YQ6pgVRxob { get; private set; }

    public IReadOnlyDictionary<string, string> c1s1VRF13OFXVQufZ { get; private set; }

    public IReadOnlyList<IOperationProvider> \u0034KYNfTyP1C62ITQpr { get; }

    public IVariableCollection \u0036md7lGNUVDdrElmld { get; }

    public IReadOnlyList<KeyValuePair<IPathMatcher, IRunSpec>> LZOcyKDhRwi7mRg2M { get; }

    public IReadOnlyDictionary<string, IReadOnlyList<IOperationProvider>> Pq4k1OFLiFRJ3owxS { get; }

    public IReadOnlyList<string> DMQiUcUUGZldkaEiE { get; }

    public bool SGqkZFNEwFp93RFsS(string SrSN0wv0GkHgrjKUY, out string _param2) => this.c1s1VRF13OFXVQufZ.TryGetValue(SrSN0wv0GkHgrjKUY, out _param2);

    public FaEMjp17NWfxHKRk4(
      IDirectory templateRoot,
      IComponentManager componentManager,
      IParameterSet parameters,
      IVariableCollection variables,
      IGlobalRunConfig globalConfig,
      IReadOnlyList<KeyValuePair<string, IGlobalRunConfig>> fileGlobConfigs,
      IReadOnlyDictionary<string, IReadOnlyList<IOperationProvider>> localizationOperations,
      IReadOnlyList<string> ignoreFileNames)
    {
      FaEMjp17NWfxHKRk4.btUFx5IsLKPt6zk8W(componentManager);
      this.\u0036md7lGNUVDdrElmld = variables;
      this.Pq4k1OFLiFRJ3owxS = localizationOperations;
      this.DMQiUcUUGZldkaEiE = ignoreFileNames;
      this.\u0034KYNfTyP1C62ITQpr = FaEMjp17NWfxHKRk4.KsHRZ9ooFQXcAkUcq(globalConfig, templateRoot, variables, parameters);
      List<KeyValuePair<IPathMatcher, IRunSpec>> keyValuePairList = new List<KeyValuePair<IPathMatcher, IRunSpec>>();
      if (fileGlobConfigs != null)
      {
        foreach (KeyValuePair<string, IGlobalRunConfig> fileGlobConfig in (IEnumerable<KeyValuePair<string, IGlobalRunConfig>>) fileGlobConfigs)
        {
          IReadOnlyList<IOperationProvider> operationOverrides = (IReadOnlyList<IOperationProvider>) null;
          IVariableCollection ivariableCollection = variables;
          if (fileGlobConfig.Value != null)
          {
            operationOverrides = FaEMjp17NWfxHKRk4.KsHRZ9ooFQXcAkUcq(fileGlobConfig.Value, templateRoot, variables, parameters);
            ivariableCollection = VariableCollection.SetupVariables(((IFileSystemInfo) templateRoot).MountPoint.EnvironmentSettings, parameters, fileGlobConfig.Value.VariableSetup);
          }
          Jvyexv284ECbh0LG9 jvyexv284Ecbh0Lg9 = new Jvyexv284ECbh0LG9(operationOverrides, ivariableCollection ?? variables, fileGlobConfig.Value.VariableSetup.FallbackFormat);
          keyValuePairList.Add(new KeyValuePair<IPathMatcher, IRunSpec>((IPathMatcher) new Ekh5OnsgkVOYn59p6(fileGlobConfig.Key), (IRunSpec) jvyexv284Ecbh0Lg9));
        }
      }
      this.LZOcyKDhRwi7mRg2M = (IReadOnlyList<KeyValuePair<IPathMatcher, IRunSpec>>) keyValuePairList;
    }

    public void Mh2GMHzNnpvp0MNZ8(N19aXVav6htZ8iWZQ _param1)
    {
      wQpyfWUt1SnGnpMyV stateMatcher = new wQpyfWUt1SnGnpMyV(_param1);
      List<IPathMatcher> ipathMatcherList1 = new List<IPathMatcher>();
      ipathMatcherList1.Add((IPathMatcher) new CAFe2WtqcT1XX5cgd(CoMrDJPbjGRQH3p2e.Include, stateMatcher));
      this.m49eilZMPN7od0Xxu = (IReadOnlyList<IPathMatcher>) ipathMatcherList1;
      List<IPathMatcher> ipathMatcherList2 = new List<IPathMatcher>();
      ipathMatcherList2.Add((IPathMatcher) new CAFe2WtqcT1XX5cgd(CoMrDJPbjGRQH3p2e.Exclude, stateMatcher));
      this.B8ULvOoY5O0qYEz5Z = (IReadOnlyList<IPathMatcher>) ipathMatcherList2;
      List<IPathMatcher> ipathMatcherList3 = new List<IPathMatcher>();
      ipathMatcherList3.Add((IPathMatcher) new CAFe2WtqcT1XX5cgd(CoMrDJPbjGRQH3p2e.CopyOnly, stateMatcher));
      this.wEkhDs9YQ6pgVRxob = (IReadOnlyList<IPathMatcher>) ipathMatcherList3;
      this.c1s1VRF13OFXVQufZ = _param1.MJnxTlN7ZsgZzmAvn ?? (IReadOnlyDictionary<string, string>) new Dictionary<string, string>((IEqualityComparer<string>) StringComparer.Ordinal);
    }

    private static IReadOnlyList<IOperationProvider> KsHRZ9ooFQXcAkUcq(
      IGlobalRunConfig x2NR5zY5OcyGDpKy4,
      IDirectory sUu2yO1DmKwqcueWj,
      IVariableCollection bemhNclbzN0bDruS3,
      IParameterSet XiGZBbH2KvNH8r5KG)
    {
      IReadOnlyList<IOperationProvider> ioperationProviderList1 = FaEMjp17NWfxHKRk4.bPdQH9ICLVTbiKijq(x2NR5zY5OcyGDpKy4.CustomOperations, sUu2yO1DmKwqcueWj, bemhNclbzN0bDruS3);
      IReadOnlyList<IOperationProvider> ioperationProviderList2 = FaEMjp17NWfxHKRk4.o9H9Lw1MiwM4vwE2V(((IFileSystemInfo) sUu2yO1DmKwqcueWj).MountPoint.EnvironmentSettings, XiGZBbH2KvNH8r5KG, x2NR5zY5OcyGDpKy4);
      List<IOperationProvider> ioperationProviderList3 = new List<IOperationProvider>((IEnumerable<IOperationProvider>) ioperationProviderList1);
      if (((IEnumerable<IOperationProvider>) ioperationProviderList1).Any<IOperationProvider>((Func<IOperationProvider, bool>) (xIZSQ6dLWnoLVd7s9 => xIZSQ6dLWnoLVd7s9 is Conditional)))
        ioperationProviderList3.AddRange(((IEnumerable<IOperationProvider>) ioperationProviderList2).Where<IOperationProvider>((Func<IOperationProvider, bool>) (_param1 => !(_param1 is Conditional))));
      else
        ioperationProviderList3.AddRange((IEnumerable<IOperationProvider>) ioperationProviderList2);
      return (IReadOnlyList<IOperationProvider>) ioperationProviderList3;
    }

    private static IReadOnlyList<IOperationProvider> o9H9Lw1MiwM4vwE2V(
      IEngineEnvironmentSettings xBdDGl4cZRfk7eLgd,
      IParameterSet dddn6wptqSUI4MNdW,
      IGlobalRunConfig Ux9AvvKk8JmBCrNmN)
    {
      List<IOperationProvider> ioperationProviderList = new List<IOperationProvider>();
      ioperationProviderList.AddRange((IEnumerable<IOperationProvider>) Ux9AvvKk8JmBCrNmN.Operations);
      if (Ux9AvvKk8JmBCrNmN.Replacements != null)
      {
        foreach (IReplacementTokens replacement in (IEnumerable<IReplacementTokens>) Ux9AvvKk8JmBCrNmN.Replacements)
        {
          IOperationProvider ioperationProvider = JXUN4SADrNj13hjAN.bLboKdsfWwYDrleKJ(xBdDGl4cZRfk7eLgd, replacement, dddn6wptqSUI4MNdW);
          if (ioperationProvider != null)
            ioperationProviderList.Add(ioperationProvider);
        }
      }
      if (Ux9AvvKk8JmBCrNmN.VariableSetup.Expand && ioperationProviderList != null)
      {
        // ISSUE: explicit non-virtual call
        __nonvirtual (ioperationProviderList.Add((IOperationProvider) new ExpandVariables((string) null, true)));
      }
      return (IReadOnlyList<IOperationProvider>) ioperationProviderList;
    }

    private static IReadOnlyList<IOperationProvider> bPdQH9ICLVTbiKijq(
      IReadOnlyList<ICustomOperationModel> _param0,
      IDirectory ywi6iD1a3fLeGkWsy,
      IVariableCollection VBwZPrJnpZExzrq5k)
    {
      ITemplateEngineHost host = ((IFileSystemInfo) ywi6iD1a3fLeGkWsy).MountPoint.EnvironmentSettings.Host;
      List<IOperationProvider> ioperationProviderList = new List<IOperationProvider>();
      foreach (ICustomOperationModel icustomOperationModel in (IEnumerable<ICustomOperationModel>) _param0)
      {
        if (!(icustomOperationModel is RTbzT9QDgB15hhQvu rtbzT9QdgB15hhQvu))
        {
          host.LogMessage("Operation type = [" + icustomOperationModel.Type + "] could not be cast as a CustomOperationModel");
        }
        else
        {
          string vxR9iwnRj77y7muNg = rtbzT9QdgB15hhQvu.VxR9iwnRJ77y7muNG;
          string i9bdNln9TpEsyXicM = rtbzT9QdgB15hhQvu.i9bdNln9TPEsyXicM;
          if (string.IsNullOrEmpty(i9bdNln9TpEsyXicM) || SharedEvaluatorDefinition<Cpp2StyleEvaluatorDefinition, Cpp2StyleEvaluatorDefinition.Tokens>.EvaluateFromString(((IFileSystemInfo) ywi6iD1a3fLeGkWsy).MountPoint.EnvironmentSettings, i9bdNln9TpEsyXicM, VBwZPrJnpZExzrq5k))
          {
            IOperationConfig operationConfig;
            if (FaEMjp17NWfxHKRk4.BjZA5Pl32N2y3l7vw.TryGetValue(vxR9iwnRj77y7muNg, out operationConfig))
              ioperationProviderList.AddRange(operationConfig.ConfigureFromJObject(rtbzT9QdgB15hhQvu.b3qmwO9LfwH44E5it, ywi6iD1a3fLeGkWsy));
            else
              host.LogMessage("Operation type = [" + vxR9iwnRj77y7muNg + "] from configuration is unknown.");
          }
        }
      }
      return (IReadOnlyList<IOperationProvider>) ioperationProviderList;
    }

    internal class fWz6xNo0hjXOKvOkQ : IProcessorState
    {
      public static readonly FaEMjp17NWfxHKRk4.KY94jp1YfJgUJpM8l hIQPaPcjOhJiHTr5K = new FaEMjp17NWfxHKRk4.KY94jp1YfJgUJpM8l();

      public IEngineConfig M55oF7jdIlX4nqkos => ((wQpyfWUt1SnGnpMyV.tdgSBkWakqxHXZJfX) this).KzWqd6dJXc9mb6wlp;

      public byte[] QRSJw9uMXCjKwprh9 { get; private set; }

      public int MEtQZS8Kz6JOPyhJW => this.QRSJw9uMXCjKwprh9.Length;

      public int tDL2lD2zoDSJCruDr { get; }

      public Encoding YcmKHYUog9nPiPCKG { get; set; }

      public IEncodingConfig WpEv0oeyFgUjAfBM0 { get; }

      public int WFtTiTp79olzhMO8s => throw new NotImplementedException();

      public bool HYXswhK9IqgVSIanP(int P1FythW97Z1o45x2E)
      {
        byte[] dst = new byte[this.MEtQZS8Kz6JOPyhJW - P1FythW97Z1o45x2E];
        Buffer.BlockCopy((Array) this.QRSJw9uMXCjKwprh9, P1FythW97Z1o45x2E, (Array) dst, 0, this.MEtQZS8Kz6JOPyhJW - P1FythW97Z1o45x2E);
        this.QRSJw9uMXCjKwprh9 = dst;
        return true;
      }

      public void VSfVvsXsiVFgJRjpW(ITokenTrie _param1) => throw new NotImplementedException();

      public void KCLvUHrv4v1l9eUvY(ITokenTrie xxjHUPuJ0tnzWoUHg, bool N6WmgSU1napwmYILa) => throw new NotImplementedException();

      public void ZmRKJcX6umCWSd0mz(ITokenTrie hw0U5jaLQJU2eopN1) => throw new NotImplementedException();

      public void HO3N2HLGvBCu8jC9Y(
        ITokenTrie PlubfeGj5JH825kz2,
        ref int _param2,
        ref int lJbNIg9qjii9sOQJ8)
      {
        throw new NotImplementedException();
      }

      public void \u00368QSEfn04Uw7uimUy(
        ITokenTrie ek1yUSroHf0fZRjjF,
        ref int u6uJIkGy4R5hLgCq5,
        ref int k7qe8ZeF6zuHjIueu)
      {
        throw new NotImplementedException();
      }

      public void OVYJysatxYokbFXnr(
        ITokenTrie _param1,
        ref int Hrk0GxnBLYRPcrILV,
        ref int oLullFX7lb0z5pr3Y)
      {
        throw new NotImplementedException();
      }

      public void njnjlZS3CjxE5w0yS(Stream RX8HUyOdCVow9DvEu) => throw new NotImplementedException();
    }
  }
}
