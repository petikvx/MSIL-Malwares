// Decompiled with JetBrains decompiler
// Type: HospitalMgmtSys.Data_Layer.DataAccess
// Assembly: HospitalMgmtSys, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C7566877-C1AA-4E10-A05D-DB3E9254F927
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Bingoml.gen-5f16f372102594d9fb5704f09a4d8d7ce34a2547b5e090d80f2b64faa1b05a45.exe

using System.Data;
using System.Data.SqlClient;

namespace HospitalMgmtSys.Data_Layer
{
  public class DataAccess
  {
    private static SqlConnection sqlcon;

    public static SqlConnection Sqlcon
    {
      get
      {
        if (DataAccess.sqlcon == null)
          DataAccess.sqlcon = new SqlConnection("Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=D:\\C#\\C# Final Project\\HMSFinal\\HospitalMgmtSys\\HospitalMgmtSys\\hms.mdf;Integrated Security=True");
        else if (DataAccess.sqlcon.State != ConnectionState.Open)
          DataAccess.sqlcon.Open();
        return DataAccess.sqlcon;
      }
    }

    public static DataSet GetDataSet(string query)
    {
      SqlDataAdapter sqlDataAdapter = new SqlDataAdapter(new SqlCommand(query, DataAccess.Sqlcon));
      DataSet dataSet = new DataSet();
      sqlDataAdapter.Fill(dataSet);
      return dataSet;
    }

    public static DataTable GetDataTable(string query)
    {
      DataSet dataSet = DataAccess.GetDataSet(query);
      return dataSet.Tables.Count > 0 ? dataSet.Tables[0] : (DataTable) null;
    }

    public static int ExecuteQuery(string query) => new SqlCommand(query, DataAccess.Sqlcon).ExecuteNonQuery();

    public static bool RowExists(string query)
    {
      SqlDataReader sqlDataReader = new SqlCommand(query, DataAccess.Sqlcon).ExecuteReader();
      if (sqlDataReader.HasRows)
      {
        sqlDataReader.Close();
        return true;
      }
      sqlDataReader.Close();
      return false;
    }

    public static void CloseConnection()
    {
      if (DataAccess.sqlcon == null)
        return;
      if (DataAccess.sqlcon.State == ConnectionState.Open)
        DataAccess.sqlcon.Close();
      DataAccess.sqlcon = (SqlConnection) null;
    }
  }
}
