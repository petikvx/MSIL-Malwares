// Decompiled with JetBrains decompiler
// Type: Microsoft.Tools.ServiceModel.ComSvcConfig.IClrRuntimeInfo
// Assembly: ComSvcConfig, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 502D58B8-8905-498F-84D2-67D5F99987D4
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00009-msil\Virus.Win32.Velost.1241-4627c8dc33e64b26fbb4c4fa0d7dc5ef025b4c1be980ea8bed77b54d7aa903ed.exe

using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;

namespace Microsoft.Tools.ServiceModel.ComSvcConfig
{
  [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
  [Guid("BD39D1D2-BA2F-486A-89B0-B4B0CB466891")]
  [ComImport]
  internal interface IClrRuntimeInfo
  {
    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    void GetVersionString([MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder buffer, [MarshalAs(UnmanagedType.U4), In, Out] ref int bufferLength);

    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    void GetRuntimeDirectory([MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder buffer, [MarshalAs(UnmanagedType.U4), In, Out] ref int bufferLength);

    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    [return: MarshalAs(UnmanagedType.Bool)]
    bool IsLoaded([In] IntPtr processHandle);

    [LCIDConversion(3)]
    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    void LoadErrorString([MarshalAs(UnmanagedType.U4), In] int resourceId, [MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder buffer, [MarshalAs(UnmanagedType.U4), In, Out] ref int bufferLength);

    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    IntPtr LoadLibrary([MarshalAs(UnmanagedType.LPWStr), In] string dllName);

    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    IntPtr GetProcAddress([MarshalAs(UnmanagedType.LPStr), In] string procName);

    [MethodImpl(MethodImplOptions.InternalCall, MethodCodeType = MethodCodeType.Runtime)]
    [return: MarshalAs(UnmanagedType.Interface)]
    object GetInterface([MarshalAs(UnmanagedType.LPStruct), In] Guid coClassId, [MarshalAs(UnmanagedType.LPStruct), In] Guid interfaceId);
  }
}
