// Decompiled with JetBrains decompiler
// Type: Quasar.Client.User.UserAccount
// Assembly: Client, Version=1.4.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 73C3C7FC-0EA2-48C4-8CEF-33A8CFDA287C
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\Trojan-PSW.MSIL.Agent.anew-0b84e664c8b592aa0220d52841629b2accb41f1f624720331000ab5f2f0ed628.exe

using Quasar.Common.Enums;
using System;
using System.Security.Principal;

namespace Quasar.Client.User
{
  public class UserAccount
  {
    public string UserName { get; }

    public AccountType Type { get; }

    public UserAccount()
    {
      this.UserName = Environment.UserName;
      using (WindowsIdentity current = WindowsIdentity.GetCurrent())
      {
        WindowsPrincipal windowsPrincipal = new WindowsPrincipal(current);
        if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Administrator))
          this.Type = AccountType.Admin;
        else if (windowsPrincipal.IsInRole(WindowsBuiltInRole.User))
          this.Type = AccountType.User;
        else if (windowsPrincipal.IsInRole(WindowsBuiltInRole.Guest))
          this.Type = AccountType.Guest;
        else
          this.Type = AccountType.Unknown;
      }
    }
  }
}
