// Decompiled with JetBrains decompiler
// Type: Bmc.Broker.TicketState
// Assembly: ticketservice, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 3DFB8186-7053-43AF-8B45-70866071B1F2
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan.Win32.Patched.mf-fd200e64412b6be5c177c3cfa7b94e83e807ff04211ce324f12e2ffa5537eb36.exe

using Net.LShift.SPKI;
using System;
using System.Collections;

namespace Bmc.Broker
{
  public class TicketState
  {
    private IDictionary PackageStates;

    public TicketState(IDictionary states) => this.PackageStates = states;

    public PackageState GetPackageState(string package) => (PackageState) this.PackageStates[(object) package];

    public bool HasPermission(string product, string perm)
    {
      foreach (PackageState packageState in (IEnumerable) this.PackageStates.Values)
      {
        if (packageState.HasPermission(product, perm))
          return true;
      }
      return false;
    }

    public string GetProperty(string productName, string propName)
    {
      foreach (PackageState packageState in (IEnumerable) this.PackageStates.Values)
      {
        string property = packageState.GetProperty(productName, propName);
        if (property != null)
          return property;
      }
      return (string) null;
    }

    public DateTime GetDateProperty(string productName, string propName) => DateTimeFormatter.ToDateTime(this.GetProperty(productName, propName));
  }
}
