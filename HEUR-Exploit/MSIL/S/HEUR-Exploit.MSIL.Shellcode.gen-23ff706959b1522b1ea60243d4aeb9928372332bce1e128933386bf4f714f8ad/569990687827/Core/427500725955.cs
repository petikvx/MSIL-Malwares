// Decompiled with JetBrains decompiler
// Type: 569990687827.Core.427500725955
// Assembly: 569990687827, Version=14.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 58118FF0-4F0E-4F7B-A626-B24D4B565FEB
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-23ff706959b1522b1ea60243d4aeb9928372332bce1e128933386bf4f714f8ad.exe

using \u003093761465127;
using \u003210067131537;
using \u003569990687827.Core;
using \u003569990687827.Models;
using \u003569990687827.Utils;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;

namespace \u003569990687827.Core
{
  public static class \u003427500725955
  {
    private static void \u003122917151695(
      string _param0,
      string _param1,
      Func<string, \u003216083080302> _param2)
    {
      TimeSpan timeSpan = TimeSpan.FromMinutes(5.0);
      \u003955608551832 obj1 = new \u003955608551832();
      obj1.\u003043841499057 = timeSpan;
      obj1.Encoding = Encoding.UTF8;
      string contents;
      using (\u003955608551832 obj2 = obj1)
      {
        Console.WriteLine("Downloading " + _param0);
        contents = obj2.DownloadString(_param0);
      }
      \u003216083080302 obj3 = _param2(contents);
      string str1 = \u003427500725955.\u003492158098446(obj3);
      string path1 = Path.Combine(_param1, str1 ?? "");
      string str2 = ((IEnumerable<string>) str1.Split('_')).First<string>();
      string path2 = Path.Combine(_param1, str2 + ".xml");
      if (File.Exists(path2) && File.Exists(path1))
      {
        Console.WriteLine("Already have it: " + str2);
      }
      else
      {
        File.WriteAllText(path2, contents);
        try
        {
          \u003043183538068.\u003738075642985(obj3.\u003084544690338, path1);
        }
        catch (Exception ex)
        {
          ex.\u003057932749963();
          File.Delete(path1);
        }
      }
    }

    private static string \u003492158098446(\u003216083080302 _param0)
    {
      string str = Path.GetFileName(_param0.\u003084544690338).\u003287165071842();
      if (str.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase))
        return str;
      Uri uri = new Uri(_param0.\u003084544690338);
      return string.Empty;
    }

    public static void \u003806509390851()
    {
      string path1 = \u003665425881749.\u003882294737960();
      \u003088996991491 obj1 = \u003692596712570.\u003613810508076(path1);
      string str = obj1?.\u003304125537315;
      if (string.IsNullOrWhiteSpace(str) || !File.Exists(str))
      {
        Console.WriteLine(str + " not found.");
      }
      else
      {
        \u003413371637644 obj2 = new \u003413371637644(str);
        ((\u003202781780826) obj2).\u003832625971491 = \u003692596712570.\u003909182148337();
        ((\u003202781780826) obj2).\u003609155850015 = obj1.\u003855702853306;
        ((\u003202781780826) obj2).\u003723177786719 = Color.DarkRed;
        ((\u003202781780826) obj2).\u003229605283276 = \u003725159542770.\u003440698927485;
        ((\u003202781780826) obj2).\u003391257951053 = \u003725159542770.\u003006933701792;
        ((\u003202781780826) obj2).\u003904879329458 = \u003725159542770.\u003530517707084;
        ((\u003202781780826) obj2).\u003207328602239 = \u003725159542770.\u003733287956506;
        ((\u003202781780826) obj2).\u003870792792007 = \u003725159542770.\u003170417130785;
        ((\u003202781780826) obj2).\u003034728944599 = \u003725159542770.\u003191121399717;
        ((\u003202781780826) obj2).\u003620513916408 = \u003725159542770.\u003445251185497;
        using (\u003202781780826 obj3 = (\u003202781780826) obj2)
        {
          using (Image image = obj3.\u003705161059513())
          {
            string filename;
            if (\u003367024433651.get_IsWindows8Plus())
            {
              filename = Path.Combine(path1, "_wallpaper.png");
              image.Save(filename, ImageFormat.Png);
            }
            else
            {
              filename = Path.Combine(path1, "_wallpaper.bmp");
              image.Save(filename, ImageFormat.Bmp);
            }
            \u003832382594754.\u003283383527310(filename);
            \u003832382594754.\u003847106470447(filename);
          }
        }
      }
    }
  }
}
