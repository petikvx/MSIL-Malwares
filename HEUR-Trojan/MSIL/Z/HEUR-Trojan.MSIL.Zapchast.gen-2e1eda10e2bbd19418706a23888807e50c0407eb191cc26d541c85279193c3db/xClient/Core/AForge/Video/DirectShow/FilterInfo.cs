// Decompiled with JetBrains decompiler
// Type: xClient.Core.AForge.Video.DirectShow.FilterInfo
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;

namespace xClient.Core.AForge.Video.DirectShow
{
  public class FilterInfo : IComparable
  {
    public string Name { get; private set; }

    public string MonikerString { get; private set; }

    public FilterInfo(string monikerString)
    {
      this.MonikerString = monikerString;
      this.Name = this.GetName(monikerString);
    }

    internal FilterInfo(IMoniker moniker)
    {
      this.MonikerString = this.GetMonikerString(moniker);
      this.Name = this.GetName(moniker);
    }

    public int CompareTo(object value)
    {
      FilterInfo filterInfo = (FilterInfo) value;
      return filterInfo == null ? 1 : this.Name.CompareTo(filterInfo.Name);
    }

    public static object CreateFilter(string filterMoniker)
    {
      object ppvResult = (object) null;
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      int pchEaten = 0;
      if (叐ᗜᵠ\u0AC6䜕ᤘᗥǞ뗽獮펽롹髁譾꣯㜙圵\uEF25쩂돷.䇬憩᪕뙼陊峸ꯨ菊툥ᙶ潪胊斘벞꣦ꙷ埝흍ꘘ㢁(0, out ppbc) == 0)
      {
        if (叐ᗜᵠ\u0AC6䜕ᤘᗥǞ뗽獮펽롹髁譾꣯㜙圵\uEF25쩂돷.皏槞癉얐ꐱ門ᐐꌞ觯퉳돇ࠁ杬뱵헩λⳚ恫\u0B5Aᥫ(ppbc, filterMoniker, ref pchEaten, out ppmk) == 0)
        {
          Guid guid = typeof (鼦硗ꉪﭛ湏瘊䦽\uF630\uE04D㓾ﭺ㯷\u2F74램缨婾\u1C88ꇦ渙\uE355).GUID;
          ppmk.BindToObject((IBindCtx) null, (IMoniker) null, ref guid, out ppvResult);
          Marshal.ReleaseComObject((object) ppmk);
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return ppvResult;
    }

    private string GetMonikerString(IMoniker moniker)
    {
      string ppszDisplayName;
      moniker.GetDisplayName((IBindCtx) null, (IMoniker) null, out ppszDisplayName);
      return ppszDisplayName;
    }

    private string GetName(IMoniker moniker)
    {
      object ppvObj = (object) null;
      try
      {
        Guid guid = typeof (黱\u28CB믟ৱष쥥呙斑巃中ᘓ햣\u137E\uE229祵\uE046\uF2E7镚\uE39Aꃾ).GUID;
        moniker.BindToStorage((IBindCtx) null, (IMoniker) null, ref guid, out ppvObj);
        黱\u28CB믟ৱष쥥呙斑巃中ᘓ햣\u137E\uE229祵\uE046\uF2E7镚\uE39Aꃾ 黱믟ৱष쥥呙斑巃中ᘓ햣祵镚ꃾ = (黱\u28CB믟ৱष쥥呙斑巃中ᘓ햣\u137E\uE229祵\uE046\uF2E7镚\uE39Aꃾ) ppvObj;
        object obj = (object) "";
        ref object local = ref obj;
        IntPtr zero = IntPtr.Zero;
        int errorCode = 黱믟ৱष쥥呙斑巃中ᘓ햣祵镚ꃾ.Read("FriendlyName", ref local, zero);
        if (errorCode != 0)
          Marshal.ThrowExceptionForHR(errorCode);
        string str = (string) obj;
        return str != null && str.Length >= 1 ? str : throw new ApplicationException();
      }
      catch (Exception ex)
      {
        return "";
      }
      finally
      {
        if (ppvObj != null)
          Marshal.ReleaseComObject(ppvObj);
      }
    }

    private string GetName(string monikerString)
    {
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      string name = "";
      int pchEaten = 0;
      if (叐ᗜᵠ\u0AC6䜕ᤘᗥǞ뗽獮펽롹髁譾꣯㜙圵\uEF25쩂돷.䇬憩᪕뙼陊峸ꯨ菊툥ᙶ潪胊斘벞꣦ꙷ埝흍ꘘ㢁(0, out ppbc) == 0)
      {
        if (叐ᗜᵠ\u0AC6䜕ᤘᗥǞ뗽獮펽롹髁譾꣯㜙圵\uEF25쩂돷.皏槞癉얐ꐱ門ᐐꌞ觯퉳돇ࠁ杬뱵헩λⳚ恫\u0B5Aᥫ(ppbc, monikerString, ref pchEaten, out ppmk) == 0)
        {
          name = this.GetName(ppmk);
          Marshal.ReleaseComObject((object) ppmk);
          ppmk = (IMoniker) null;
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return name;
    }
  }
}
