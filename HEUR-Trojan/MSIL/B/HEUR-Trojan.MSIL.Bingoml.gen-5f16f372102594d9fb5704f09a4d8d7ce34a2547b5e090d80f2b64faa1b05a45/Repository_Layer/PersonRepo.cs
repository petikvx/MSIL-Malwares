// Decompiled with JetBrains decompiler
// Type: HospitalMgmtSys.Repository_Layer.PersonRepo
// Assembly: HospitalMgmtSys, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C7566877-C1AA-4E10-A05D-DB3E9254F927
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Bingoml.gen-5f16f372102594d9fb5704f09a4d8d7ce34a2547b5e090d80f2b64faa1b05a45.exe

using HospitalMgmtSys.Data_Layer;
using System.Data;
using System.Data.SqlClient;

namespace HospitalMgmtSys.Repository_Layer
{
  public class PersonRepo
  {
    private SqlConnection sqlConnection = DataAccess.Sqlcon;

    public int PersonID { get; set; }

    public string Name { get; set; }

    public int Age { get; set; }

    public string Gender { get; set; }

    public string BloodGroup { get; set; }

    public string Phone { get; set; }

    public DataTable GetAllPersons(string sql = "select * from person") => DataAccess.GetDataSet(sql).Tables[0];

    public DataTable GetIndividualPerson(int id) => DataAccess.GetDataSet("select * from person where personid = '" + (object) id + "' ").Tables[0];

    public int CreatePerson(string name, int age, string gender, string bloodgroup, string phone) => DataAccess.ExecuteQuery("insert into person values('" + name + "', '" + (object) age + "', '" + gender + "', '" + bloodgroup + "', '" + phone + "') ");

    public int UpdatePerson(
      int id,
      string name,
      int age,
      string gender,
      string bloodgroup,
      string phone)
    {
      return DataAccess.ExecuteQuery("update person\n                            set name = '" + name + "',\n                            age = '" + (object) age + "',\n                            gender = '" + gender + "',\n                            bloodgroup = '" + bloodgroup + "',\n                            phone = '" + phone + "'\n                            where personid = '" + (object) id + "';");
    }

    public int DeletePerson(int id) => DataAccess.ExecuteQuery(string.Format("DELETE FROM person WHERE personid = '" + (object) id + "'; "));

    public DataTable GetLastPerson() => DataAccess.GetDataSet("SELECT TOP 1 * FROM PERSON ORDER BY personid DESC").Tables[0];
  }
}
