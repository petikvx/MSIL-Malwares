// Decompiled with JetBrains decompiler
// Type: NuGet.Common.Zx9YvjHhO9
// Assembly: Ty6CWyxFEL, Version=5.0.0.2, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 271E2DAF-741A-443A-8BCF-B62C509DDC38
// Assembly location: C:\Users\Administrateur\Downloads\toto\HEUR-Trojan-Ransom.MSIL.Purgen.gen-185fafbeb00cd8238fdabee088763e27012dd3a0076e04dddca6266f129f0430.exe

using System;
using System.Globalization;
using System.IO;
using System.Runtime.CompilerServices;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace NuGet.Common
{
  public static class Zx9YvjHhO9
  {
    private const int V7c5WTxEWM = 3000;
    private static readonly TimeSpan rudXTTxX9z = TimeSpan.FromMilliseconds(10.0);
    private static string PxaHaT0lZy;

    public static Task<T> ycbKN2LAc5<T>(
      string rsstKyZVWk,
      Func<CancellationToken, Task<T>> AEQhP7qY92,
      CancellationToken sninzMaHKY)
    {
      // ISSUE: variable of a compiler-generated type
      Zx9YvjHhO9.v0dHNzCXlo<T> stateMachine;
      // ISSUE: reference to a compiler-generated field
      stateMachine.filePath = rsstKyZVWk;
      // ISSUE: reference to a compiler-generated field
      stateMachine.action = AEQhP7qY92;
      // ISSUE: reference to a compiler-generated field
      stateMachine.token = sninzMaHKY;
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u003C\u003Et__builder = AsyncTaskMethodBuilder<T>.Create();
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u003C\u003E1__state = -1;
      // ISSUE: reference to a compiler-generated field
      stateMachine.\u003C\u003Et__builder.Start<Zx9YvjHhO9.v0dHNzCXlo<T>>(ref stateMachine);
      // ISSUE: reference to a compiler-generated field
      return stateMachine.\u003C\u003Et__builder.Task;
    }

    public static void vczsbTySdP(string GCtuRhYLWU, Action _param1)
    {
      if (string.IsNullOrEmpty(GCtuRhYLWU))
        throw new ArgumentNullException("filePath");
      int num = 3000;
      while (true)
      {
        FileStream fileStream = (FileStream) null;
        string Er0gt1beZJ = string.Empty;
        try
        {
          try
          {
            Er0gt1beZJ = Zx9YvjHhO9.Jw59aJXrug(GCtuRhYLWU);
            fileStream = Zx9YvjHhO9.aRukTKQtQ1(Er0gt1beZJ);
          }
          catch (DirectoryNotFoundException ex)
          {
            throw;
          }
          catch (PathTooLongException ex)
          {
            throw;
          }
          catch (UnauthorizedAccessException ex)
          {
            if (num < 1)
            {
              Er0gt1beZJ = string.IsNullOrEmpty(Er0gt1beZJ) ? Zx9YvjHhO9.sh0qO8Dr4e : throw new InvalidOperationException(string.Format((IFormatProvider) CultureInfo.CurrentCulture, vK4KTOtZYy.\u0038izEXGEPhm, (object) Er0gt1beZJ, (object) GCtuRhYLWU));
            }
            else
            {
              --num;
              Thread.Sleep(Zx9YvjHhO9.rudXTTxX9z);
              continue;
            }
          }
          catch (IOException ex)
          {
            Thread.Sleep(Zx9YvjHhO9.rudXTTxX9z);
            continue;
          }
          _param1();
          break;
        }
        finally
        {
          fileStream?.Dispose();
        }
      }
    }

    private static FileStream aRukTKQtQ1(string Er0gt1beZJ)
    {
      FileOptions options = !l6BkPTcFbv.ooEPhgvzVK ? FileOptions.None : FileOptions.DeleteOnClose;
      return new FileStream(Er0gt1beZJ, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.None, 32, options);
    }

    private static string sh0qO8Dr4e
    {
      get
      {
        if (Zx9YvjHhO9.PxaHaT0lZy != null)
          return Zx9YvjHhO9.PxaHaT0lZy;
        Zx9YvjHhO9.PxaHaT0lZy = Path.Combine(hE1biszR17.SX1Br5Fk1Y(YeXhnQPbgq.Temp), "lock");
        \u0039Cinr8QmyZ.\u00384vHHOeo02(Zx9YvjHhO9.PxaHaT0lZy);
        return Zx9YvjHhO9.PxaHaT0lZy;
      }
    }

    private static string Jw59aJXrug(string nPUih2Dvz4)
    {
      \u0039Cinr8QmyZ.\u00384vHHOeo02(Zx9YvjHhO9.sh0qO8Dr4e);
      return Path.Combine(Zx9YvjHhO9.sh0qO8Dr4e, Zx9YvjHhO9.X5bmHvVxqa(nPUih2Dvz4));
    }

    private static string X5bmHvVxqa(string Aw8bIdexH2)
    {
      using (SHA1 shA1 = SHA1.Create())
      {
        string upperInvariant = (Path.IsPathRooted(Aw8bIdexH2) ? Path.GetFullPath(Aw8bIdexH2) : Aw8bIdexH2).ToUpperInvariant();
        return Zx9YvjHhO9.rZXfaQFYbD(shA1.ComputeHash(Encoding.UTF32.GetBytes(upperInvariant)));
      }
    }

    private static string rZXfaQFYbD(byte[] VONk1KSeTu)
    {
      char[] chArray1 = new char[VONk1KSeTu.Length * 2];
      int index1 = 0;
      int num1 = 0;
      for (; index1 < VONk1KSeTu.Length; ++index1)
      {
        char[] chArray2 = chArray1;
        int index2 = num1;
        int num2 = index2 + 1;
        int num3 = (int) Zx9YvjHhO9.IlPJju8Wby((int) VONk1KSeTu[index1] >> 4);
        chArray2[index2] = (char) num3;
        char[] chArray3 = chArray1;
        int index3 = num2;
        num1 = index3 + 1;
        int num4 = (int) Zx9YvjHhO9.IlPJju8Wby((int) VONk1KSeTu[index1] & 15);
        chArray3[index3] = (char) num4;
      }
      return new string(chArray1);
    }

    [MethodImpl(MethodImplOptions.AggressiveInlining)]
    private static char IlPJju8Wby(int ZsuVl2fmdD) => ZsuVl2fmdD > 9 ? (char) (ZsuVl2fmdD + 87) : (char) (ZsuVl2fmdD + 48);
  }
}
