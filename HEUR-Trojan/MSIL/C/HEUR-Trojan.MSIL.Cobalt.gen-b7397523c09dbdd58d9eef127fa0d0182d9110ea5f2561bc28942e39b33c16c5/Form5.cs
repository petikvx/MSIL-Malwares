// Decompiled with JetBrains decompiler
// Type: WindowsFormsApplication2.Form5
// Assembly: WindowsFormsApplication2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FE9A6395-9CA7-468B-A6A3-13D09A57D63A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Cobalt.gen-b7397523c09dbdd58d9eef127fa0d0182d9110ea5f2561bc28942e39b33c16c5.exe

using System;
using System.ComponentModel;
using System.Data.OleDb;
using System.Drawing;
using System.Windows.Forms;

namespace WindowsFormsApplication2
{
  public class Form5 : Form
  {
    public string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + Application.StartupPath + "/POS.accdb";
    private string cid = "";
    private string prid = "";
    private IContainer components = (IContainer) null;
    private Label Address;
    private Label label4;
    private DateTimePicker ReturnDate;
    private TextBox Paid;
    private Label label6;
    private Label label7;
    private Button button1;
    private Button button3;
    private ColumnHeader Addresss;
    private ColumnHeader Ren;
    private ColumnHeader Rentss;
    private ColumnHeader Rd;
    private ColumnHeader PA;
    private ColumnHeader pid;
    private ColumnHeader CustomerId;
    private ListView listView1;
    private Label CustomerName;
    private Label label1;
    private Label label2;
    private TextBox Rent;
    private Label label3;
    private Label cnic;
    private Label label5;
    private ColumnHeader cnicc;
    private TextBox Unpaid;
    private Button button2;
    private Label NetPayable;
    private Label label9;

    public Form5() => this.InitializeComponent();

    private double GetDecimal(string txt)
    {
      try
      {
        double result;
        double.TryParse(txt, out result);
        return result;
      }
      catch
      {
        return 0.0;
      }
    }

    private void listView1_SelectedIndexChanged(object sender, EventArgs e)
    {
      try
      {
        this.Address.Text = this.listView1.SelectedItems[0].SubItems[0].Text;
        this.CustomerName.Text = this.listView1.SelectedItems[0].SubItems[1].Text;
        this.Rent.Text = this.listView1.SelectedItems[0].SubItems[2].Text;
        this.Unpaid.Text = this.listView1.SelectedItems[0].SubItems[4].Text;
        this.NetPayable.Text = (this.GetDecimal(this.Rent.Text) + this.GetDecimal(this.Unpaid.Text)).ToString();
        this.prid = this.listView1.SelectedItems[0].SubItems[5].Text;
        this.cid = this.listView1.SelectedItems[0].SubItems[6].Text;
        this.cnic.Text = this.listView1.SelectedItems[0].SubItems[7].Text;
      }
      catch
      {
      }
    }

    private void button1_Click(object sender, EventArgs e)
    {
      this.CustomerName.Text = "";
      this.cid = "";
      this.prid = "";
      this.Address.Text = "";
      this.Unpaid.Text = "";
      this.Rent.Clear();
      this.Paid.Clear();
    }

    private void button3_Click(object sender, EventArgs e)
    {
    }

    private void button3_Click_1(object sender, EventArgs e)
    {
      if (this.listView1.SelectedItems.Count > 0 && this.prid != "")
      {
        if (MessageBox.Show("Collect Rent?", "Warning", MessageBoxButtons.YesNo) != DialogResult.Yes)
          return;
        double num1 = this.GetDecimal(this.Unpaid.Text);
        double num2 = this.GetDecimal(this.Paid.Text);
        double num3 = this.GetDecimal(this.Rent.Text);
        int num4 = 0;
        if (num2 < num3)
        {
          num4 = (int) num3 - (int) num2;
          num1 += (double) num4;
        }
        else if (num2 > num3)
        {
          num4 = (int) num2 - (int) num3;
          num1 -= (double) num4;
        }
        string[] strArray = new string[21]
        {
          "INSERT INTO Invoice(CustomerId,PlaceId,CustomerName,Address,RemainingAmount,InvDate,AmountPaid,BillMonth,BillYear,Arrears) VALUES(",
          this.cid,
          ",",
          this.prid,
          ",'",
          this.CustomerName.Text,
          "','",
          this.Address.Text,
          "',",
          num4.ToString(),
          ",'",
          this.ReturnDate.Value.ToShortDateString(),
          "',",
          this.Paid.Text,
          ",",
          null,
          null,
          null,
          null,
          null,
          null
        };
        DateTime dateTime = this.ReturnDate.Value;
        int num5 = dateTime.Month;
        strArray[15] = num5.ToString();
        strArray[16] = ",";
        dateTime = this.ReturnDate.Value;
        num5 = dateTime.Year;
        strArray[17] = num5.ToString();
        strArray[18] = ",";
        strArray[19] = num1.ToString();
        strArray[20] = ")";
        string cmdText = string.Concat(strArray);
        using (OleDbConnection connection = new OleDbConnection(this.connectionString))
        {
          try
          {
            connection.Open();
            new OleDbCommand(cmdText, connection).ExecuteReader();
            if (num4 != 0)
              new OleDbCommand("Update Cust_Place SET PreviousAmount='" + num1.ToString() + "' where customerid=" + this.cid + " and PlaceId=" + this.prid + " and status=1", connection).ExecuteReader();
            int num6 = (int) MessageBox.Show("Rent COLLECTED for Property", "Done!");
            this.Refresh();
          }
          catch (Exception ex)
          {
            int num7 = (int) MessageBox.Show(ex.Message);
            return;
          }
          connection.Close();
          this.listView1.Items.Clear();
          this.GetListInfo();
        }
      }
      else
      {
        int num = (int) MessageBox.Show("No Property selected to get Rent");
      }
    }

    private void button1_Click_1(object sender, EventArgs e) => this.Refresh();

    private void FillList()
    {
      string str1 = this.ReturnDate.Value.Month.ToString();
      string str2 = this.ReturnDate.Value.Year.ToString();
      using (OleDbConnection connection = new OleDbConnection(this.connectionString))
      {
        connection.Open();
        for (int index = 0; index < this.listView1.Items.Count; ++index)
        {
          OleDbCommand oleDbCommand = new OleDbCommand("Select id from Invoice where PlaceId=" + this.listView1.Items[index].SubItems[5].Text + " and CustomerId=" + this.listView1.Items[index].SubItems[6].Text + " and billMonth=" + str1 + " and billyear=" + str2, connection);
          try
          {
            using (OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader())
            {
              oleDbDataReader.Read();
              this.listView1.Items[index].BackColor = oleDbDataReader.HasRows ? Color.White : Color.OrangeRed;
            }
          }
          catch (Exception ex)
          {
            int num = (int) MessageBox.Show(ex.Message);
          }
        }
        connection.Close();
      }
    }

    private new void Refresh()
    {
      this.CustomerName.Text = "Name";
      this.cnic.Text = "000";
      this.Address.Text = "Address";
      this.Unpaid.Text = "0";
      this.Rent.Text = "0";
      this.Paid.Text = "0";
      this.NetPayable.Text = "0";
    }

    private void GetListInfo()
    {
      using (OleDbConnection connection = new OleDbConnection(this.connectionString))
      {
        OleDbCommand oleDbCommand = new OleDbCommand("Select Address,CustomerName,Cust_Place.Rent,RentDate,PreviousAmount,PlaceId,CustomerId,CNIC from Cust_Place_Rent where Status = 1", connection);
        try
        {
          connection.Open();
          using (OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader())
          {
            while (oleDbDataReader.Read())
              this.listView1.Items.Add(new ListViewItem(new string[8]
              {
                oleDbDataReader[0].ToString(),
                oleDbDataReader[1].ToString(),
                oleDbDataReader[2].ToString(),
                oleDbDataReader[3].ToString(),
                oleDbDataReader[4].ToString(),
                oleDbDataReader[5].ToString(),
                oleDbDataReader[6].ToString(),
                oleDbDataReader[7].ToString()
              }));
            this.FillList();
          }
        }
        catch (Exception ex)
        {
          int num = (int) MessageBox.Show(ex.Message);
        }
      }
    }

    private void Form5_Load(object sender, EventArgs e) => this.GetListInfo();

    private void button2_Click(object sender, EventArgs e)
    {
      if (MessageBox.Show("Update Renter Arrears?", "Warning", MessageBoxButtons.YesNo) != DialogResult.Yes)
        return;
      using (OleDbConnection connection = new OleDbConnection(this.connectionString))
      {
        try
        {
          connection.Open();
          if (this.Unpaid.Text != "")
            new OleDbCommand("Update Cust_Place SET PreviousAmount='" + this.Unpaid.Text + "' where customerid=" + this.cid + " and PlaceId=" + this.prid + " and status=1", connection).ExecuteReader();
          int num = (int) MessageBox.Show("Arrears Updated", "Done!");
          this.Refresh();
          this.listView1.Items.Clear();
          this.GetListInfo();
        }
        catch (Exception ex)
        {
          int num = (int) MessageBox.Show(ex.Message);
          return;
        }
        connection.Close();
      }
    }

    private void ReturnDate_ValueChanged(object sender, EventArgs e)
    {
      this.listView1.Items.Clear();
      this.GetListInfo();
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.Address = new Label();
      this.label4 = new Label();
      this.ReturnDate = new DateTimePicker();
      this.Paid = new TextBox();
      this.label6 = new Label();
      this.label7 = new Label();
      this.button1 = new Button();
      this.button3 = new Button();
      this.Addresss = new ColumnHeader();
      this.Ren = new ColumnHeader();
      this.Rentss = new ColumnHeader();
      this.Rd = new ColumnHeader();
      this.PA = new ColumnHeader();
      this.pid = new ColumnHeader();
      this.CustomerId = new ColumnHeader();
      this.listView1 = new ListView();
      this.CustomerName = new Label();
      this.label1 = new Label();
      this.label2 = new Label();
      this.Rent = new TextBox();
      this.label3 = new Label();
      this.cnic = new Label();
      this.label5 = new Label();
      this.cnicc = new ColumnHeader();
      this.Unpaid = new TextBox();
      this.button2 = new Button();
      this.NetPayable = new Label();
      this.label9 = new Label();
      this.SuspendLayout();
      this.Address.AutoSize = true;
      this.Address.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.Address.Location = new Point(147, 380);
      this.Address.Name = "Address";
      this.Address.Size = new Size(138, 18);
      this.Address.TabIndex = 59;
      this.Address.Text = "Property Address";
      this.label4.AutoSize = true;
      this.label4.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label4.Location = new Point(959, 17);
      this.label4.Name = "label4";
      this.label4.Size = new Size(82, 16);
      this.label4.TabIndex = 61;
      this.label4.Text = "Current Date";
      this.ReturnDate.CustomFormat = "dd-MM-yyyy";
      this.ReturnDate.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.ReturnDate.Format = DateTimePickerFormat.Custom;
      this.ReturnDate.Location = new Point(1047, 12);
      this.ReturnDate.Name = "ReturnDate";
      this.ReturnDate.Size = new Size(121, 22);
      this.ReturnDate.TabIndex = 60;
      this.ReturnDate.ValueChanged += new EventHandler(this.ReturnDate_ValueChanged);
      this.Paid.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.Paid.Location = new Point(975, 452);
      this.Paid.MaxLength = 7;
      this.Paid.Name = "Paid";
      this.Paid.Size = new Size(98, 26);
      this.Paid.TabIndex = 4;
      this.Paid.Text = "0";
      this.label6.AutoSize = true;
      this.label6.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label6.Location = new Point(903, 458);
      this.label6.Name = "label6";
      this.label6.Size = new Size(36, 16);
      this.label6.TabIndex = 65;
      this.label6.Text = "Paid";
      this.label7.AutoSize = true;
      this.label7.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label7.Location = new Point(902, 393);
      this.label7.Name = "label7";
      this.label7.Size = new Size(39, 16);
      this.label7.TabIndex = 64;
      this.label7.Text = "Rent:";
      this.button1.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.button1.Location = new Point(975, 483);
      this.button1.Name = "button1";
      this.button1.Size = new Size(98, 36);
      this.button1.TabIndex = 67;
      this.button1.Text = "Reset";
      this.button1.UseVisualStyleBackColor = true;
      this.button1.Click += new EventHandler(this.button1_Click_1);
      this.button3.Font = new Font("Lucida Handwriting", 11.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.button3.Location = new Point(1079, 391);
      this.button3.Name = "button3";
      this.button3.Size = new Size(100, 87);
      this.button3.TabIndex = 69;
      this.button3.Text = "Collect Rent";
      this.button3.UseVisualStyleBackColor = true;
      this.button3.Click += new EventHandler(this.button3_Click_1);
      this.Addresss.Text = "Address";
      this.Addresss.Width = 350;
      this.Ren.Text = "Renter";
      this.Ren.Width = 350;
      this.Rentss.Text = "Rent";
      this.Rentss.Width = 100;
      this.Rd.Text = "Due Date";
      this.Rd.Width = 150;
      this.PA.Text = "Arrears";
      this.PA.Width = 200;
      this.pid.Width = 0;
      this.CustomerId.Width = 0;
      this.listView1.Columns.AddRange(new ColumnHeader[8]
      {
        this.Addresss,
        this.Ren,
        this.Rentss,
        this.Rd,
        this.PA,
        this.pid,
        this.CustomerId,
        this.cnicc
      });
      this.listView1.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.listView1.FullRowSelect = true;
      this.listView1.GridLines = true;
      this.listView1.Location = new Point(24, 40);
      this.listView1.MultiSelect = false;
      this.listView1.Name = "listView1";
      this.listView1.Size = new Size(1155, 320);
      this.listView1.TabIndex = 56;
      this.listView1.UseCompatibleStateImageBehavior = false;
      this.listView1.View = View.Details;
      this.listView1.SelectedIndexChanged += new EventHandler(this.listView1_SelectedIndexChanged);
      this.CustomerName.AutoSize = true;
      this.CustomerName.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.CustomerName.Location = new Point(147, 414);
      this.CustomerName.Name = "CustomerName";
      this.CustomerName.Size = new Size(99, 16);
      this.CustomerName.TabIndex = 54;
      this.CustomerName.Text = "Renter Name";
      this.label1.AutoSize = true;
      this.label1.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label1.Location = new Point(24, 414);
      this.label1.Name = "label1";
      this.label1.Size = new Size(48, 16);
      this.label1.TabIndex = 70;
      this.label1.Text = "Name:";
      this.label2.AutoSize = true;
      this.label2.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label2.Location = new Point(25, 472);
      this.label2.Name = "label2";
      this.label2.Size = new Size(108, 16);
      this.label2.TabIndex = 71;
      this.label2.Text = "Previous Arrears";
      this.Rent.Enabled = false;
      this.Rent.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.Rent.Location = new Point(975, 391);
      this.Rent.MaxLength = 7;
      this.Rent.Name = "Rent";
      this.Rent.Size = new Size(98, 26);
      this.Rent.TabIndex = 73;
      this.Rent.Text = "0";
      this.label3.AutoSize = true;
      this.label3.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label3.Location = new Point(25, 447);
      this.label3.Name = "label3";
      this.label3.Size = new Size(46, 16);
      this.label3.TabIndex = 74;
      this.label3.Text = "CNIC#";
      this.cnic.AutoSize = true;
      this.cnic.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.cnic.Location = new Point(147, 447);
      this.cnic.Name = "cnic";
      this.cnic.Size = new Size(16, 16);
      this.cnic.TabIndex = 75;
      this.cnic.Text = "0";
      this.label5.AutoSize = true;
      this.label5.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Italic, GraphicsUnit.Point, (byte) 0);
      this.label5.Location = new Point(30, 17);
      this.label5.Name = "label5";
      this.label5.Size = new Size(233, 16);
      this.label5.TabIndex = 76;
      this.label5.Text = "Click Over the Property to Collect Rent";
      this.cnicc.Width = 0;
      this.Unpaid.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.Unpaid.Location = new Point(146, 471);
      this.Unpaid.Name = "Unpaid";
      this.Unpaid.Size = new Size(100, 22);
      this.Unpaid.TabIndex = 77;
      this.Unpaid.Text = "0";
      this.button2.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.button2.Location = new Point(27, 499);
      this.button2.Name = "button2";
      this.button2.Size = new Size(219, 31);
      this.button2.TabIndex = 78;
      this.button2.Text = "Update Arrears";
      this.button2.UseVisualStyleBackColor = true;
      this.button2.Click += new EventHandler(this.button2_Click);
      this.NetPayable.AutoSize = true;
      this.NetPayable.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.NetPayable.Location = new Point(975, 427);
      this.NetPayable.Name = "NetPayable";
      this.NetPayable.Size = new Size(16, 16);
      this.NetPayable.TabIndex = 80;
      this.NetPayable.Text = "0";
      this.label9.AutoSize = true;
      this.label9.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label9.Location = new Point(902, 428);
      this.label9.Name = "label9";
      this.label9.Size = new Size(66, 16);
      this.label9.TabIndex = 79;
      this.label9.Text = "Net Total:";
      this.AutoScaleDimensions = new SizeF(96f, 96f);
      this.AutoScaleMode = AutoScaleMode.Dpi;
      this.ClientSize = new Size(1191, 542);
      this.Controls.Add((Control) this.NetPayable);
      this.Controls.Add((Control) this.label9);
      this.Controls.Add((Control) this.button2);
      this.Controls.Add((Control) this.Unpaid);
      this.Controls.Add((Control) this.label5);
      this.Controls.Add((Control) this.cnic);
      this.Controls.Add((Control) this.label3);
      this.Controls.Add((Control) this.Rent);
      this.Controls.Add((Control) this.label2);
      this.Controls.Add((Control) this.label1);
      this.Controls.Add((Control) this.button3);
      this.Controls.Add((Control) this.button1);
      this.Controls.Add((Control) this.Paid);
      this.Controls.Add((Control) this.label6);
      this.Controls.Add((Control) this.label7);
      this.Controls.Add((Control) this.label4);
      this.Controls.Add((Control) this.ReturnDate);
      this.Controls.Add((Control) this.Address);
      this.Controls.Add((Control) this.listView1);
      this.Controls.Add((Control) this.CustomerName);
      this.Name = nameof (Form5);
      this.Text = "Collect Rent";
      this.Load += new EventHandler(this.Form5_Load);
      this.ResumeLayout(false);
      this.PerformLayout();
    }
  }
}
