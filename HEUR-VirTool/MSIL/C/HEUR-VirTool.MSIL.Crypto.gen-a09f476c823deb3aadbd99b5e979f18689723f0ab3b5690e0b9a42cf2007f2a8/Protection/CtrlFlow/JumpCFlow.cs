// Decompiled with JetBrains decompiler
// Type: Aura.Protection.CtrlFlow.JumpCFlow
// Assembly: Kudeta Crypter, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 16F9F4AC-EE0C-4DE1-A1E6-B297F2D4338B
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-VirTool.MSIL.Crypto.gen-a09f476c823deb3aadbd99b5e979f18689723f0ab3b5690e0b9a42cf2007f2a8.exe

using dnlib.DotNet;
using dnlib.DotNet.Emit;
using System.Collections.Generic;
using System.Linq;

namespace Aura.Protection.CtrlFlow
{
  public static class JumpCFlow
  {
    public static void Execute(ModuleDefMD module)
    {
      foreach (TypeDef type in (IEnumerable<TypeDef>) ((ModuleDef) module).Types)
      {
        foreach (MethodDef methodDef in ((IEnumerable<MethodDef>) type.Methods).ToArray<MethodDef>())
        {
          if (methodDef.HasBody && methodDef.Body.HasInstructions && !methodDef.Body.HasExceptionHandlers)
          {
            for (int index = 0; index < ((ICollection<Instruction>) methodDef.Body.Instructions).Count - 2; index = index + 2 + 1)
            {
              Instruction instruction = methodDef.Body.Instructions[index + 1];
              methodDef.Body.Instructions.Insert(index + 1, Instruction.Create(OpCodes.Ldstr, "Aura.jpg"));
              methodDef.Body.Instructions.Insert(index + 1, Instruction.Create(OpCodes.Br_S, instruction));
            }
          }
        }
      }
    }
  }
}
