// Decompiled with JetBrains decompiler
// Type: Windows.capture
// Assembly: Windows, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 79C82968-ACCA-434D-B77A-E6AFF79DFC80
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.Win32.Scar.oajo-73c2744f575cfc2a701f2e9e007e619bd64c245aa21fa5e718d5bcd65237d589.exe

using Microsoft.VisualBasic.CompilerServices;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace Windows
{
  [StandardModule]
  public sealed class capture
  {
    public const short WM_CAP = 1024;
    public const long WM_USER = 1024;
    public const int WM_CAP_DRIVER_CONNECT = 1034;
    public const int WM_CAP_DRIVER_DISCONNECT = 1035;
    public const int WM_CAP_EDIT_COPY = 1054;
    public const long WM_CAP_FILE_SAVEDIB = 1049;
    public const long WM_CAP_FILE_SAVEAS = 1047;
    public const int WM_CAP_SET_PREVIEW = 1074;
    public const int WM_CAP_SET_PREVIEWRATE = 1076;
    public const int WM_CAP_SET_SCALE = 1077;
    public const int WS_CHILD = 1073741824;
    public const int WS_VISIBLE = 268435456;
    public const short SWP_NOMOVE = 2;
    public const short SWP_NOSIZE = 1;
    public const short SWP_NOZORDER = 4;
    public const short HWND_BOTTOM = 1;

    [DebuggerNonUserCode]
    static capture()
    {
    }

    [DllImport("user32", EntryPoint = "SendMessageA", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern int SendMessage(int hwnd, int wMsg, int wParam, [MarshalAs(UnmanagedType.AsAny)] object lParam);

    [DllImport("user32", EntryPoint = "SendMessageA", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern long SendMessageAsString(
      long hWnd,
      long wMsg,
      long wParam,
      [MarshalAs(UnmanagedType.VBByRefStr)] ref string lParam);

    [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern int SetWindowPos(
      int hwnd,
      int hWndInsertAfter,
      int x,
      int y,
      int cx,
      int cy,
      int wFlags);

    [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern bool DestroyWindow(int hndw);

    [DllImport("avicap32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern int capCreateCaptureWindowA(
      [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszWindowName,
      int dwStyle,
      int x,
      int y,
      int nWidth,
      short nHeight,
      int hWndParent,
      int nID);

    [DllImport("avicap32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern bool capGetDriverDescriptionA(
      short wDriver,
      [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszName,
      int cbName,
      [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszVer,
      int cbVer);
  }
}
