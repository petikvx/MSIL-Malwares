// Decompiled with JetBrains decompiler
// Type: Helper.cSystemInfo
// Assembly: Helper, Version=1.1.0.11, Culture=neutral, PublicKeyToken=null
// MVID: 8C3C9487-A4B3-453F-9BCD-7455B1571841
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\Trojan-Ransom.Win32.Blocker.hedt-199b7ef219c6f0a99a826e3ee0a47da63213996c7b6ed2244ca302d914e0a744.exe

using Microsoft.Win32;
using System;
using System.Management;

namespace Helper
{
  internal class cSystemInfo
  {
    public string getSystemVersion() => this.getWindowsVersionName() + " " + this.getBitVersion();

    public string getUniqueID()
    {
      string sString = (this.getCPUID() + this.getGraphicDevice() + this.getMoboSerial()).ToString();
      return cMain.FunctionClass.getMD5Hash(sString);
    }

    private string getWindowsVersionName()
    {
      ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("root\\CIMV2", " SELECT * FROM win32_operatingsystem");
      string empty = string.Empty;
      foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
        empty = Convert.ToString(managementBaseObject["Name"]);
      try
      {
        string str = empty.Split('|')[0];
        int length = str.Split(' ')[0].Length;
        return str.Substring(length).TrimStart().TrimEnd();
      }
      catch
      {
        return "Unknown System";
      }
    }

    private string getBitVersion() => Registry.LocalMachine.OpenSubKey("Hardware\\Description\\System\\CentralProcessor\\0").GetValue("Identifier").ToString().Contains("x86") ? "(32 Bit)" : "(64 Bit)";

    private string getCPUID()
    {
      ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_Processor WHERE DeviceID = 'CPU0'");
      string empty = string.Empty;
      foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
        empty = Convert.ToString(managementBaseObject["ProcessorId"]);
      return empty;
    }

    private string getMoboSerial()
    {
      ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_BaseBoard");
      string empty = string.Empty;
      foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
        empty = Convert.ToString(managementBaseObject["SerialNumber"]);
      return empty;
    }

    public string getGraphicDevice()
    {
      ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_VideoController");
      string empty = string.Empty;
      foreach (ManagementBaseObject managementBaseObject in managementObjectSearcher.Get())
        empty = Convert.ToString(managementBaseObject["Description"]);
      return empty;
    }
  }
}
