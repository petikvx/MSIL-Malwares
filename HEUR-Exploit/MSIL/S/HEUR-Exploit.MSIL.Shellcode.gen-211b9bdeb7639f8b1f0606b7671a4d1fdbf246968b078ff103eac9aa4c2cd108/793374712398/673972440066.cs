// Decompiled with JetBrains decompiler
// Type: 793374712398.673972440066
// Assembly: 190180155270, Version=7.6.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 20B0A582-54C5-4C64-BCB9-2AC73608F590
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Exploit.MSIL.Shellcode.gen-211b9bdeb7639f8b1f0606b7671a4d1fdbf246968b078ff103eac9aa4c2cd108.exe

using \u003041130631579;
using \u003193754076629;
using \u003522274766650;
using Microsoft.ProgramSynthesis.Utils;
using System.Collections.Generic;
using System.Text.RegularExpressions;

namespace \u003793374712398
{
  internal class \u003673972440066 : \u003134945228346
  {
    private const int \u003058681560197 = 32768;
    private const float \u003257692386731 = 0.5f;
    private readonly Regex \u003802988185068 = new Regex("\\s*\\{", RegexOptions.Compiled);
    private readonly Regex \u003502416006617 = new Regex("\\s*\\[", RegexOptions.Compiled);
    private readonly Regex \u003241857698391 = new Regex("\\s*\\}", RegexOptions.Compiled);
    private readonly Regex \u003140055593992 = new Regex("\\s*\\]", RegexOptions.Compiled);
    private readonly Regex \u003106198852260 = new Regex("\\s*\"([^\\\\\n\"]|(\\\\.))+\"", RegexOptions.ExplicitCapture | RegexOptions.Compiled);
    private readonly Regex \u003410310018214 = new Regex("\\s*:", RegexOptions.Compiled);
    private readonly Regex \u003973129396561 = new Regex("\\s*((\"([^\\\\\n\"]|(\\\\.))*\")|(-?\\d+(\\.\\d+((e|E)(\\+|-)?\\d+)?)?)|true|false|null)", RegexOptions.ExplicitCapture | RegexOptions.Compiled);
    private readonly Regex \u003336831027053 = new Regex("\\s*,", RegexOptions.Compiled);

    internal virtual IEnumerable<\u003197692273545> \u003066614465618 => Seq.Of<\u003197692273545>(new \u003197692273545[1]
    {
      \u003197692273545.Json
    });

    internal virtual IEnumerable<string> \u003939655757967 => Seq.Of<string>(new string[1]
    {
      "json"
    });

    internal virtual int \u003688352892982 => 1;

    private bool \u003815306996231(string _param1, int _param2, out int _param3)
    {
      _param3 = _param2;
      if (_param2 >= _param1.Length)
      {
        _param3 = _param1.Length;
        return true;
      }
      Match match1 = this.\u003802988185068.Match(_param1, _param2);
      if (match1.Success && match1.Index == _param2)
        return this.\u003421473802428(_param1, _param2 + match1.Length, out _param3);
      Match match2 = this.\u003502416006617.Match(_param1, _param2);
      if (match2.Success && match2.Index == _param2)
        return this.\u003690615451699(_param1, _param2 + match2.Length, out _param3);
      Match match3 = this.\u003973129396561.Match(_param1, _param2);
      if (!match3.Success || match3.Index != _param2)
        return false;
      _param3 = _param2 + match3.Length;
      return true;
    }

    private bool \u003690615451699(string _param1, int _param2, out int _param3)
    {
      _param3 = _param2;
      Match match1 = this.\u003140055593992.Match(_param1, _param2);
      if (match1.Success && match1.Index == _param2)
      {
        _param3 = _param2 + match1.Length;
        return true;
      }
      bool flag = false;
      while (_param2 < _param1.Length)
      {
        int num;
        if (!this.\u003815306996231(_param1, _param2, out num))
        {
          _param3 = num;
          return false;
        }
        _param2 = num;
        if (_param2 >= _param1.Length)
        {
          _param3 = _param1.Length;
          return true;
        }
        Match match2 = this.\u003336831027053.Match(_param1, _param2);
        if (!match2.Success || match2.Index != _param2)
        {
          Match match3 = this.\u003140055593992.Match(_param1, _param2);
          if (!match3.Success || match3.Index != _param2)
          {
            _param3 = _param2;
            return false;
          }
          _param3 = _param2 + match3.Length;
          flag = true;
        }
        else
          _param2 += match2.Length;
        if (flag)
          return true;
      }
      _param3 = _param1.Length;
      return true;
    }

    private bool \u003421473802428(string _param1, int _param2, out int _param3)
    {
      _param3 = _param2;
      Match match1 = this.\u003241857698391.Match(_param1, _param2);
      if (match1.Success && match1.Index == _param2)
      {
        _param3 = _param2 + match1.Length;
        return true;
      }
      bool flag = false;
      while (_param2 < _param1.Length)
      {
        Match match2 = this.\u003106198852260.Match(_param1, _param2);
        if (!match2.Success || match2.Index != _param2)
        {
          _param3 = _param2;
          return false;
        }
        _param2 += match2.Length;
        if (_param2 >= _param1.Length)
        {
          _param3 = _param1.Length;
          return true;
        }
        Match match3 = this.\u003410310018214.Match(_param1, _param2);
        if (!match3.Success || match3.Index != _param2)
        {
          _param3 = _param2;
          return false;
        }
        _param2 += match3.Length;
        if (_param2 >= _param1.Length)
        {
          _param3 = _param1.Length;
          return true;
        }
        int num;
        if (!this.\u003815306996231(_param1, _param2, out num))
        {
          _param3 = num;
          return false;
        }
        _param2 = num;
        if (_param2 >= _param1.Length)
        {
          _param3 = _param1.Length;
          return true;
        }
        Match match4 = this.\u003336831027053.Match(_param1, _param2);
        if (!match4.Success || match4.Index != _param2)
        {
          Match match5 = this.\u003241857698391.Match(_param1, _param2);
          if (!match5.Success || match5.Index != _param2)
          {
            _param3 = _param2;
            return false;
          }
          _param3 = _param2 + match5.Length;
          flag = true;
        }
        else
          _param2 += match4.Length;
        if (flag)
          return true;
      }
      _param3 = _param1.Length;
      return true;
    }

    private bool \u003552142704953(string _param1)
    {
      Match match = this.\u003802988185068.Match(_param1, 0);
      if (!match.Success || match.Index > 1)
      {
        match = this.\u003502416006617.Match(_param1, 0);
        if (!match.Success || match.Index > 0)
          return false;
      }
      int num;
      return this.\u003815306996231(_param1, match.Index, out num) || (double) num / (double) _param1.Length > 0.5;
    }

    internal virtual \u003197692273545 \u003696273705968(
      \u003388950121399 _param1,
      string _param2,
      string _param3)
    {
      if (_param2.Length > 32768)
        _param2 = _param2.Substring(0, 32768);
      int length = -1;
      for (int index = _param2.Length - 1; index >= 0; --index)
      {
        if (_param2[index] == ']' || _param2[index] == '}' || _param2[index] == ',' || _param2[index] == ':')
        {
          length = index + 1;
          break;
        }
      }
      return length < 0 || !this.\u003552142704953(_param2.Substring(0, length)) ? \u003197692273545.Unknown : \u003197692273545.Json;
    }
  }
}
