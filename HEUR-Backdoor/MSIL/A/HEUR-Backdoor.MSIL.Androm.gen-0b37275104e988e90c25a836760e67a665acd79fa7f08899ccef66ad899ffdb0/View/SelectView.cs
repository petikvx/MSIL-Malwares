// Decompiled with JetBrains decompiler
// Type: AutoJack.View.SelectView
// Assembly: ComAliasNameAttrib, Version=537.36.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B820B6E9-23AF-4643-975D-980B086C72E1
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.Androm.gen-0b37275104e988e90c25a836760e67a665acd79fa7f08899ccef66ad899ffdb0.exe

using AutoJack.Controller;
using AutoJack.Model;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace AutoJack.View
{
  public class SelectView : Form
  {
    private Engine Engine = new Engine();
    private List<User> Users;
    private IContainer components = (IContainer) null;
    private ListView UsersList;
    private Label ListLabel;
    private Button OkButton;
    private Button NewPButton;
    private Button BackButton;
    private ColumnHeader Id;
    private ColumnHeader PName;
    private ColumnHeader Balance;
    private ColumnHeader WinStreak;
    private ColumnHeader WinCount;
    private ColumnHeader LoseCount;
    private ColumnHeader Owing;
    private ColumnHeader LastPlay;
    private Button UserDetails;
    private Button DeleteUser;

    public SelectView()
    {
      this.InitializeComponent();
      this.UsersList.SmallImageList = new ImageList()
      {
        ImageSize = new Size(1, 30)
      };
      this.Users = this.Engine.GetSavedUsers();
      foreach (User user in this.Users)
        this.UsersList.Items.Add(new ListViewItem(new string[8]
        {
          user.Id,
          user.Name,
          user.Balance.ToString(),
          user.Winstreak.ToString(),
          user.WinCount.ToString(),
          user.LoseCount.ToString(),
          user.Owing.ToString(),
          user.LastPlay
        }));
      this.OkButton.Click += new EventHandler(this.UserSelected);
      this.NewPButton.Click += new EventHandler(this.NewUser);
      this.BackButton.Click += new EventHandler(this.CancelSelect);
      this.UserDetails.Click += new EventHandler(this.ShowUserDetails);
      this.DeleteUser.Click += new EventHandler(this.DoDeleteUser);
    }

    private void UserSelected(object sender, EventArgs e)
    {
      int selectedUser = this.GetSelectedUser();
      this.Visible = false;
      if (selectedUser > 0)
      {
        User User = this.Users.ElementAt<User>(selectedUser - 100 - 1);
        this.Close();
        new GameController(User).StartGame();
      }
      else
        this.Visible = true;
    }

    private void NewUser(object sender, EventArgs e)
    {
      this.Close();
      new UserController().AllowCreateUser();
    }

    private void CancelSelect(object sender, EventArgs e) => this.Close();

    private void ShowUserDetails(object sender, EventArgs e)
    {
      int selectedUser = this.GetSelectedUser();
      this.Visible = false;
      if (selectedUser > 0)
      {
        this.Close();
        new UserController().DisplayUserDetails(selectedUser);
      }
      else
        this.Visible = true;
    }

    private void DoDeleteUser(object sender, EventArgs e)
    {
      int selectedUser = this.GetSelectedUser();
      if (selectedUser <= 0 || !MessageBox.Show("This player will be deleted permanently. Continue?", "Delete", MessageBoxButtons.OKCancel, MessageBoxIcon.Asterisk).Equals((object) DialogResult.OK))
        return;
      this.Close();
      Engine engine = new Engine();
      User userById = engine.GetUserById(selectedUser);
      engine.Delete(userById);
      new SelectController().AllowSelectUser();
    }

    private int GetSelectedUser()
    {
      string s = string.Empty;
      bool flag = true;
      try
      {
        s = this.UsersList.SelectedItems[0].SubItems[0].Text;
      }
      catch (ArgumentOutOfRangeException ex)
      {
        flag = false;
      }
      if (flag)
      {
        int result;
        int.TryParse(s, out result);
        return result;
      }
      int num = (int) MessageBox.Show("No User was selected.");
      return -1;
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (SelectView));
      this.UsersList = new ListView();
      this.Id = new ColumnHeader();
      this.PName = new ColumnHeader();
      this.Balance = new ColumnHeader();
      this.WinStreak = new ColumnHeader();
      this.WinCount = new ColumnHeader();
      this.LoseCount = new ColumnHeader();
      this.Owing = new ColumnHeader();
      this.LastPlay = new ColumnHeader();
      this.ListLabel = new Label();
      this.OkButton = new Button();
      this.NewPButton = new Button();
      this.BackButton = new Button();
      this.UserDetails = new Button();
      this.DeleteUser = new Button();
      this.SuspendLayout();
      this.UsersList.Columns.AddRange(new ColumnHeader[8]
      {
        this.Id,
        this.PName,
        this.Balance,
        this.WinStreak,
        this.WinCount,
        this.LoseCount,
        this.Owing,
        this.LastPlay
      });
      this.UsersList.Cursor = Cursors.Hand;
      this.UsersList.FullRowSelect = true;
      this.UsersList.GridLines = true;
      this.UsersList.HideSelection = false;
      this.UsersList.Location = new Point(32, 83);
      this.UsersList.Margin = new Padding(8, 7, 8, 7);
      this.UsersList.MultiSelect = false;
      this.UsersList.Name = "UsersList";
      this.UsersList.Size = new Size(1487, 526);
      this.UsersList.TabIndex = 0;
      this.UsersList.UseCompatibleStateImageBehavior = false;
      this.UsersList.View = System.Windows.Forms.View.Details;
      this.Id.Text = "ID";
      this.Id.Width = 35;
      this.PName.Text = "Name";
      this.PName.Width = 100;
      this.Balance.Text = "Balance";
      this.WinStreak.Text = "Max Streak";
      this.WinStreak.Width = 66;
      this.WinCount.Text = "Wins";
      this.WinCount.Width = 50;
      this.LoseCount.Text = "Loses";
      this.LoseCount.Width = 50;
      this.Owing.Text = "Owing";
      this.LastPlay.Text = "Last Play";
      this.LastPlay.Width = 118;
      this.ListLabel.Dock = DockStyle.Top;
      this.ListLabel.Font = new Font("Microsoft Sans Serif", 13f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.ListLabel.Location = new Point(0, 0);
      this.ListLabel.Margin = new Padding(8, 0, 8, 0);
      this.ListLabel.Name = "ListLabel";
      this.ListLabel.Size = new Size(1557, 55);
      this.ListLabel.TabIndex = 1;
      this.ListLabel.Text = "Select Player";
      this.ListLabel.TextAlign = ContentAlignment.MiddleCenter;
      this.OkButton.Location = new Point(32, 630);
      this.OkButton.Margin = new Padding(8, 7, 8, 7);
      this.OkButton.Name = "OkButton";
      this.OkButton.Size = new Size(200, 55);
      this.OkButton.TabIndex = 2;
      this.OkButton.Text = "OK";
      this.OkButton.UseVisualStyleBackColor = true;
      this.NewPButton.Location = new Point(464, 630);
      this.NewPButton.Margin = new Padding(8, 7, 8, 7);
      this.NewPButton.Name = "NewPButton";
      this.NewPButton.Size = new Size(200, 55);
      this.NewPButton.TabIndex = 3;
      this.NewPButton.Text = "New User";
      this.NewPButton.UseVisualStyleBackColor = true;
      this.BackButton.BackColor = SystemColors.GradientActiveCaption;
      this.BackButton.Location = new Point(1325, 630);
      this.BackButton.Margin = new Padding(8, 7, 8, 7);
      this.BackButton.Name = "BackButton";
      this.BackButton.Size = new Size(200, 55);
      this.BackButton.TabIndex = 4;
      this.BackButton.Text = "Close";
      this.BackButton.UseVisualStyleBackColor = false;
      this.UserDetails.Location = new Point(248, 630);
      this.UserDetails.Margin = new Padding(8, 7, 8, 7);
      this.UserDetails.Name = "UserDetails";
      this.UserDetails.Size = new Size(200, 55);
      this.UserDetails.TabIndex = 5;
      this.UserDetails.Text = "Details";
      this.UserDetails.UseVisualStyleBackColor = true;
      this.DeleteUser.BackColor = Color.OrangeRed;
      this.DeleteUser.Location = new Point(1109, 630);
      this.DeleteUser.Margin = new Padding(8, 7, 8, 7);
      this.DeleteUser.Name = "DeleteUser";
      this.DeleteUser.Size = new Size(200, 55);
      this.DeleteUser.TabIndex = 6;
      this.DeleteUser.Text = "Delete";
      this.DeleteUser.UseVisualStyleBackColor = false;
      this.AutoScaleDimensions = new SizeF(16f, 31f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.BackColor = SystemColors.GradientActiveCaption;
      this.ClientSize = new Size(1557, 713);
      this.ControlBox = false;
      this.Controls.Add((Control) this.DeleteUser);
      this.Controls.Add((Control) this.UserDetails);
      this.Controls.Add((Control) this.BackButton);
      this.Controls.Add((Control) this.NewPButton);
      this.Controls.Add((Control) this.OkButton);
      this.Controls.Add((Control) this.ListLabel);
      this.Controls.Add((Control) this.UsersList);
      this.Icon = (Icon) componentResourceManager.GetObject("$this.Icon");
      this.Margin = new Padding(8, 7, 8, 7);
      this.Name = nameof (SelectView);
      this.StartPosition = FormStartPosition.CenterParent;
      this.Text = "AutoJack: Select Player";
      this.ResumeLayout(false);
    }
  }
}
