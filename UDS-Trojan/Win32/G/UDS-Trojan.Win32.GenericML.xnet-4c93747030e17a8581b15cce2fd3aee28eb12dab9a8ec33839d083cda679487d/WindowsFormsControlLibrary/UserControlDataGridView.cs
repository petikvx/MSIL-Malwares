// Decompiled with JetBrains decompiler
// Type: WindowsFormsControlLibrary.UserControlDataGridView
// Assembly: IClosableToIDisposableAdap, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2A617983-3D9C-4057-8AD9-58124F2A75C3
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\UDS-Trojan.Win32.GenericML.xnet-4c93747030e17a8581b15cce2fd3aee28eb12dab9a8ec33839d083cda679487d.exe

using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Reflection;
using System.Windows.Forms;
using WindowsFormsControlLibrary.HelperModel;

namespace WindowsFormsControlLibrary
{
  public class UserControlDataGridView : UserControl
  {
    private IContainer components = (IContainer) null;
    private DataGridView dataGridView;

    public UserControlDataGridView() => this.InitializeComponent();

    public void AddElement<T>(T element)
    {
      if ((object) element == null)
        return;
      List<object> objectList = new List<object>(this.dataGridView.Columns.Count);
      foreach (DataGridViewTextBoxColumn column in (BaseCollection) this.dataGridView.Columns)
      {
        PropertyInfo property = element.GetType().GetProperty(column.Tag.ToString());
        object obj = !(property != (PropertyInfo) null) ? (object) null : property.GetValue((object) element, (object[]) null);
        objectList.Add(obj);
      }
      this.dataGridView.Rows.Add(objectList.ToArray());
    }

    public int SelectedRowIndex
    {
      get => this.dataGridView.SelectedRows.Count > 0 ? this.dataGridView.SelectedRows[0].Index : -1;
      set
      {
        if (value <= -1 || value >= this.dataGridView.Rows.Count)
          return;
        this.dataGridView.Rows[value].Selected = true;
      }
    }

    public void LoadColumns(List<TableConfig> columns)
    {
      this.dataGridView.Columns.Clear();
      foreach (TableConfig column in columns)
      {
        int index = this.dataGridView.Columns.Add(column.PropertyName, column.Header);
        this.dataGridView.Columns[index].Visible = column.Visible;
        this.dataGridView.Columns[index].Width = column.Width.Value;
      }
    }

    public void Clear() => this.dataGridView.Rows.Clear();

    public T GetSelectedObject<T>() where T : class, new()
    {
      T selectedObject;
      if (this.dataGridView.SelectedRows.Count != 0)
      {
        T obj = new T();
        foreach (DataGridViewCell cell in (BaseCollection) this.dataGridView.SelectedRows[0].Cells)
        {
          if (!(obj.GetType().GetProperty(this.dataGridView.Columns[cell.ColumnIndex].Tag?.ToString()) != (PropertyInfo) null))
            ;
        }
        selectedObject = obj;
      }
      else
        selectedObject = default (T);
      return selectedObject;
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.dataGridView = new DataGridView();
      ((ISupportInitialize) this.dataGridView).BeginInit();
      this.SuspendLayout();
      this.dataGridView.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.AutoSize;
      this.dataGridView.Location = new Point(4, 4);
      this.dataGridView.Name = "dataGridView";
      this.dataGridView.RowHeadersWidth = 51;
      this.dataGridView.RowTemplate.Height = 24;
      this.dataGridView.Size = new Size(484, (int) byte.MaxValue);
      this.dataGridView.TabIndex = 0;
      this.AutoScaleDimensions = new SizeF(8f, 16f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.Controls.Add((Control) this.dataGridView);
      this.Name = nameof (UserControlDataGridView);
      this.Size = new Size(494, 266);
      ((ISupportInitialize) this.dataGridView).EndInit();
      this.ResumeLayout(false);
    }
  }
}
