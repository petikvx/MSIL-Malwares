// Decompiled with JetBrains decompiler
// Type: flac.Utils.CRC16
// Assembly: STAThreadAttrib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 6EE3DE1A-E148-4FBA-A193-65BEA1824C00
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-PSW.MSIL.Stealer.gen-f6a784c2aa30ddaf03919958455d18bf51533a475c21a73eff578df0174cc5d4.exe

namespace flac.Utils
{
  public class CRC16
  {
    private static ushort[] CRC16_TABLE = new ushort[256]
    {
      (ushort) 0,
      (ushort) 32773,
      (ushort) 32783,
      (ushort) 10,
      (ushort) 32795,
      (ushort) 30,
      (ushort) 20,
      (ushort) 32785,
      (ushort) 32819,
      (ushort) 54,
      (ushort) 60,
      (ushort) 32825,
      (ushort) 40,
      (ushort) 32813,
      (ushort) 32807,
      (ushort) 34,
      (ushort) 32867,
      (ushort) 102,
      (ushort) 108,
      (ushort) 32873,
      (ushort) 120,
      (ushort) 32893,
      (ushort) 32887,
      (ushort) 114,
      (ushort) 80,
      (ushort) 32853,
      (ushort) 32863,
      (ushort) 90,
      (ushort) 32843,
      (ushort) 78,
      (ushort) 68,
      (ushort) 32833,
      (ushort) 32963,
      (ushort) 198,
      (ushort) 204,
      (ushort) 32969,
      (ushort) 216,
      (ushort) 32989,
      (ushort) 32983,
      (ushort) 210,
      (ushort) 240,
      (ushort) 33013,
      (ushort) 33023,
      (ushort) 250,
      (ushort) 33003,
      (ushort) 238,
      (ushort) 228,
      (ushort) 32993,
      (ushort) 160,
      (ushort) 32933,
      (ushort) 32943,
      (ushort) 170,
      (ushort) 32955,
      (ushort) 190,
      (ushort) 180,
      (ushort) 32945,
      (ushort) 32915,
      (ushort) 150,
      (ushort) 156,
      (ushort) 32921,
      (ushort) 136,
      (ushort) 32909,
      (ushort) 32903,
      (ushort) 130,
      (ushort) 33155,
      (ushort) 390,
      (ushort) 396,
      (ushort) 33161,
      (ushort) 408,
      (ushort) 33181,
      (ushort) 33175,
      (ushort) 402,
      (ushort) 432,
      (ushort) 33205,
      (ushort) 33215,
      (ushort) 442,
      (ushort) 33195,
      (ushort) 430,
      (ushort) 420,
      (ushort) 33185,
      (ushort) 480,
      (ushort) 33253,
      (ushort) 33263,
      (ushort) 490,
      (ushort) 33275,
      (ushort) 510,
      (ushort) 500,
      (ushort) 33265,
      (ushort) 33235,
      (ushort) 470,
      (ushort) 476,
      (ushort) 33241,
      (ushort) 456,
      (ushort) 33229,
      (ushort) 33223,
      (ushort) 450,
      (ushort) 320,
      (ushort) 33093,
      (ushort) 33103,
      (ushort) 330,
      (ushort) 33115,
      (ushort) 350,
      (ushort) 340,
      (ushort) 33105,
      (ushort) 33139,
      (ushort) 374,
      (ushort) 380,
      (ushort) 33145,
      (ushort) 360,
      (ushort) 33133,
      (ushort) 33127,
      (ushort) 354,
      (ushort) 33059,
      (ushort) 294,
      (ushort) 300,
      (ushort) 33065,
      (ushort) 312,
      (ushort) 33085,
      (ushort) 33079,
      (ushort) 306,
      (ushort) 272,
      (ushort) 33045,
      (ushort) 33055,
      (ushort) 282,
      (ushort) 33035,
      (ushort) 270,
      (ushort) 260,
      (ushort) 33025,
      (ushort) 33539,
      (ushort) 774,
      (ushort) 780,
      (ushort) 33545,
      (ushort) 792,
      (ushort) 33565,
      (ushort) 33559,
      (ushort) 786,
      (ushort) 816,
      (ushort) 33589,
      (ushort) 33599,
      (ushort) 826,
      (ushort) 33579,
      (ushort) 814,
      (ushort) 804,
      (ushort) 33569,
      (ushort) 864,
      (ushort) 33637,
      (ushort) 33647,
      (ushort) 874,
      (ushort) 33659,
      (ushort) 894,
      (ushort) 884,
      (ushort) 33649,
      (ushort) 33619,
      (ushort) 854,
      (ushort) 860,
      (ushort) 33625,
      (ushort) 840,
      (ushort) 33613,
      (ushort) 33607,
      (ushort) 834,
      (ushort) 960,
      (ushort) 33733,
      (ushort) 33743,
      (ushort) 970,
      (ushort) 33755,
      (ushort) 990,
      (ushort) 980,
      (ushort) 33745,
      (ushort) 33779,
      (ushort) 1014,
      (ushort) 1020,
      (ushort) 33785,
      (ushort) 1000,
      (ushort) 33773,
      (ushort) 33767,
      (ushort) 994,
      (ushort) 33699,
      (ushort) 934,
      (ushort) 940,
      (ushort) 33705,
      (ushort) 952,
      (ushort) 33725,
      (ushort) 33719,
      (ushort) 946,
      (ushort) 912,
      (ushort) 33685,
      (ushort) 33695,
      (ushort) 922,
      (ushort) 33675,
      (ushort) 910,
      (ushort) 900,
      (ushort) 33665,
      (ushort) 640,
      (ushort) 33413,
      (ushort) 33423,
      (ushort) 650,
      (ushort) 33435,
      (ushort) 670,
      (ushort) 660,
      (ushort) 33425,
      (ushort) 33459,
      (ushort) 694,
      (ushort) 700,
      (ushort) 33465,
      (ushort) 680,
      (ushort) 33453,
      (ushort) 33447,
      (ushort) 674,
      (ushort) 33507,
      (ushort) 742,
      (ushort) 748,
      (ushort) 33513,
      (ushort) 760,
      (ushort) 33533,
      (ushort) 33527,
      (ushort) 754,
      (ushort) 720,
      (ushort) 33493,
      (ushort) 33503,
      (ushort) 730,
      (ushort) 33483,
      (ushort) 718,
      (ushort) 708,
      (ushort) 33473,
      (ushort) 33347,
      (ushort) 582,
      (ushort) 588,
      (ushort) 33353,
      (ushort) 600,
      (ushort) 33373,
      (ushort) 33367,
      (ushort) 594,
      (ushort) 624,
      (ushort) 33397,
      (ushort) 33407,
      (ushort) 634,
      (ushort) 33387,
      (ushort) 622,
      (ushort) 612,
      (ushort) 33377,
      (ushort) 544,
      (ushort) 33317,
      (ushort) 33327,
      (ushort) 554,
      (ushort) 33339,
      (ushort) 574,
      (ushort) 564,
      (ushort) 33329,
      (ushort) 33299,
      (ushort) 534,
      (ushort) 540,
      (ushort) 33305,
      (ushort) 520,
      (ushort) 33293,
      (ushort) 33287,
      (ushort) 514
    };

    public static short update(byte data, short crc)
    {
      crc = (short) ((int) crc << 8 ^ (int) (short) CRC16.CRC16_TABLE[((int) crc >> 8 ^ (int) data) & (int) byte.MaxValue]);
      return crc;
    }

    public static short updateBlock(byte[] data, int len, short crc)
    {
      for (int index = 0; index < len; ++index)
        crc = (short) ((int) crc << 8 ^ (int) CRC16.CRC16_TABLE[(int) crc >> 8 ^ (int) data[index]]);
      return crc;
    }

    public static short calc(byte[] data, int len)
    {
      short num = 0;
      for (int index = 0; index < len; ++index)
        num = (short) ((int) num << 8 ^ (int) CRC16.CRC16_TABLE[(int) num >> 8 ^ (int) data[index]]);
      return num;
    }
  }
}
