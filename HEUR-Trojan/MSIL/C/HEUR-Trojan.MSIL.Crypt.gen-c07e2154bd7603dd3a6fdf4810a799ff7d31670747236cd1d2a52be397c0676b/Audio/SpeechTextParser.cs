// Decompiled with JetBrains decompiler
// Type: Cradiator.Audio.SpeechTextParser
// Assembly: FileOptio, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 0135208B-21B4-457A-BFCD-FFD93FD8BA14
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.02-msil\HEUR-Trojan.MSIL.Crypt.gen-c07e2154bd7603dd3a6fdf4810a799ff7d31670747236cd1d2a52be397c0676b.exe

using Cradiator.Model;
using System;
using System.Collections.Generic;
using System.Linq;

namespace Cradiator.Audio
{
  public class SpeechTextParser : ISpeechTextParser
  {
    private readonly IBuildBuster _buildBuster;

    public SpeechTextParser([InjectBuildBusterFullNameDecorator] IBuildBuster buildBuster) => this._buildBuster = buildBuster;

    public string Parse(string sentence, ProjectStatus projectStatus)
    {
      IEnumerable<string> source = ((IEnumerable<string>) sentence.Split(' ', ',', '.')).Where<string>((Func<string, bool>) (word => word.StartsWith("$"))).Where<string>((Func<string, bool>) (word => word.EndsWith("$")));
      if (source.Any<string>())
      {
        foreach (string oldValue in source)
        {
          if (oldValue == "$ProjectName$")
            sentence = sentence.Replace(oldValue, projectStatus.Name);
          if (oldValue == "$Breaker$")
            sentence = sentence.Replace(oldValue, this._buildBuster.FindBreaker(projectStatus.CurrentMessage));
        }
      }
      else
        sentence = string.Format("{0}, {1}", (object) projectStatus.Name, (object) sentence);
      return sentence;
    }
  }
}
