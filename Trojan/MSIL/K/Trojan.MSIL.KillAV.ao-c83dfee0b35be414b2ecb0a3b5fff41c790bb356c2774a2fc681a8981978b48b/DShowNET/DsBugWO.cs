// Decompiled with JetBrains decompiler
// Type: DShowNET.DsBugWO
// Assembly: yes, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 83EB8C5F-168C-47FA-93FE-E25AA6C64B02
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.MSIL.KillAV.ao-c83dfee0b35be414b2ecb0a3b5fff41c790bb356c2774a2fc681a8981978b48b.exe

using System;
using System.Runtime.InteropServices;
using System.Runtime.Remoting.Services;

namespace DShowNET
{
  public class DsBugWO
  {
    public static object CreateDsInstance(ref Guid clsid, ref Guid riid)
    {
      IntPtr ptrIf;
      int instance = DsBugWO.CoCreateInstance(ref clsid, IntPtr.Zero, CLSCTX.Inproc, ref riid, out ptrIf);
      if (instance != 0 || ptrIf == IntPtr.Zero)
        Marshal.ThrowExceptionForHR(instance);
      Guid iid = new Guid("00000000-0000-0000-C000-000000000046");
      Marshal.QueryInterface(ptrIf, ref iid, out IntPtr _);
      object dsInstance = EnterpriseServicesHelper.WrapIUnknownWithComObject(ptrIf);
      Marshal.Release(ptrIf);
      return dsInstance;
    }

    [DllImport("ole32.dll")]
    private static extern int CoCreateInstance(
      ref Guid clsid,
      IntPtr pUnkOuter,
      CLSCTX dwClsContext,
      ref Guid iid,
      out IntPtr ptrIf);
  }
}
