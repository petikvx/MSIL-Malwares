// Decompiled with JetBrains decompiler
// Type: Egebimtes.EtiketBasimi.Program
// Assembly: EgebimtesEtiketBasim, Version=1.0.0.8, Culture=neutral, PublicKeyToken=null
// MVID: D0653F93-40B2-470A-A14A-758CB97E05C0
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Virus.Win32.Alman.b-030a4381fa3d09b164161894fccddf864dfa0fa12dc2a8cbb8779f4750301cd1.exe

using System;
using System.Windows.Forms;
using System.Xml;

namespace Egebimtes.EtiketBasimi
{
  internal static class Program
  {
    public static Guid ProgramID = new Guid("2C1E23EC-675A-413a-815B-5310BA50F1C9");
    public static int intSubeKodu;
    public static string strVTAdi;
    public static string strConnString;
    public static string strPort;
    public static string strSablonDosya;
    public static string strPrinter;
    public static int intMiktarOndalik;
    public static int intAciklamaOndalik;

    [STAThread]
    private static void Main()
    {
      Application.EnableVisualStyles();
      Application.SetCompatibleTextRenderingDefault(false);
      try
      {
        if (!new Egebimtes.LisansKontrol.LisansKontrol(Program.ProgramID).KontrolEt())
        {
          int num = (int) MessageBox.Show("Gecersiz lisans dosyası", "Hata", MessageBoxButtons.OK, MessageBoxIcon.Hand);
          return;
        }
        XmlDocument xmlDocument = new XmlDocument();
        string filename = Application.StartupPath + "//Config.xml";
        xmlDocument.Load(filename);
        Program.strConnString = xmlDocument.SelectSingleNode("//configuration/connectionstringOLE").FirstChild.Value;
        Program.strConnString = Program.strConnString.Replace("master", Program.strVTAdi);
        Program.strPort = xmlDocument.SelectSingleNode("//configuration/port").FirstChild.Value;
        Program.strPrinter = xmlDocument.SelectSingleNode("//configuration/printer").FirstChild.Value;
        Program.intMiktarOndalik = Convert.ToInt32(xmlDocument.SelectSingleNode("//configuration/miktarondalik").FirstChild.Value);
        Program.intAciklamaOndalik = Convert.ToInt32(xmlDocument.SelectSingleNode("//configuration/aciklamaondalik").FirstChild.Value);
        Program.strVTAdi = xmlDocument.SelectSingleNode("//configuration/VTAdi").FirstChild.Value;
        Program.intSubeKodu = Convert.ToInt32(xmlDocument.SelectSingleNode("//configuration/VTSube").FirstChild.Value);
      }
      catch (Exception ex)
      {
        int num = (int) MessageBox.Show("Hata: " + ex.Message, "Egebimtes - Barkod Etiket Basım", MessageBoxButtons.OK, MessageBoxIcon.Hand);
      }
      Application.Run((Form) new MainForm());
    }
  }
}
