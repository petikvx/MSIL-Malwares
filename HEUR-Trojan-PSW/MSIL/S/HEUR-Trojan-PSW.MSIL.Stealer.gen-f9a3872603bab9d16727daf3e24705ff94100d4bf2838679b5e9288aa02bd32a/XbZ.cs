// Decompiled with JetBrains decompiler
// Type: ib.XbZ
// Assembly: ContingentPropert, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 10450B75-DDB2-42D8-896D-5D92C0FA5DAE
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-PSW.MSIL.Stealer.gen-f9a3872603bab9d16727daf3e24705ff94100d4bf2838679b5e9288aa02bd32a.exe

using System.Collections.Generic;
using System.Runtime.InteropServices;

namespace ib
{
  internal class XbZ : Fbp
  {
    private WH cAd;
    private static XbZ hGd;

    public void Vvo(WH _param1)
    {
      this.cAd = _param1;
      using (IEnumerator<lZ> enumerator1 = _param1.gfa().GetEnumerator())
      {
        while (true)
        {
          if (enumerator1.MoveNext())
            goto label_47;
          else
            goto label_74;
label_2:
          int num1;
          int num2 = num1;
label_3:
          lZ current1;
          bool flag1;
          IEnumerator<DR> enumerator2;
          Dictionary<string, Qd>.ValueCollection.Enumerator enumerator3;
          while (true)
          {
            switch (num2)
            {
              case 1:
                goto label_87;
              case 2:
                if (!flag1)
                {
                  if (current1 is rr)
                  {
                    enumerator2 = (current1 as rr).IhE().GetEnumerator();
                    num2 = 3;
                    continue;
                  }
                  goto label_72;
                }
                else
                  goto label_5;
              case 3:
                goto label_6;
              default:
                try
                {
                  while (enumerator3.MoveNext())
                  {
                    Qd current2 = enumerator3.Current;
                    if (current2.ndT() != null)
                    {
                      this.lAU(current2.ndT(), current1);
                      int num3 = 0;
                      if (XbZ.nGl() == null)
                        goto label_82;
label_77:
                      switch (num3)
                      {
                        default:
                          continue;
                      }
label_82:
                      num3 = 0;
                      goto label_77;
                    }
                  }
                }
                finally
                {
                  enumerator3.Dispose();
                }
                if (!(current1 is gN))
                {
                  flag1 = current1 is lk;
                  num2 = 2;
                  continue;
                }
                goto label_70;
            }
          }
label_5:
          using (IEnumerator<cw> enumerator4 = (current1 as lk).Ih1().GetEnumerator())
          {
            while (enumerator4.MoveNext())
            {
              cw current3 = enumerator4.Current;
              if (current3.sdu() != null)
              {
                int num4 = 0;
                if (!XbZ.GGa())
                  goto label_29;
label_27:
                switch (num4)
                {
                  default:
                    using (IEnumerator<sa> enumerator5 = current3.sdu().GetEnumerator())
                    {
                      while (enumerator5.MoveNext())
                      {
                        sa current4 = enumerator5.Current;
                        bool flag2 = current4 is rbB;
                        int num5 = 0;
                        if (!XbZ.GGa())
                          goto label_36;
label_33:
                        switch (num5)
                        {
                          default:
                            if (flag2)
                            {
                              this.lAU((current4 as rbB).eQL(), current1);
                              continue;
                            }
                            continue;
                        }
label_36:
                        int num6;
                        num5 = num6;
                        goto label_33;
                      }
                      continue;
                    }
                }
label_29:
                int num7;
                num4 = num7;
                goto label_27;
              }
            }
            goto label_72;
          }
label_6:
          try
          {
            while (enumerator2.MoveNext())
            {
              DR current5 = enumerator2.Current;
              if (current5.Vde() != null)
              {
                using (IEnumerator<sa> enumerator6 = current5.Vde().GetEnumerator())
                {
                  while (enumerator6.MoveNext())
                  {
                    sa current6 = enumerator6.Current;
                    if (current6 is rbB)
                      this.lAU((uz) XbZ.GG1((object) (current6 as rbB)), current1);
                  }
                  int num8 = 0;
                  if (XbZ.nGl() != null)
                    goto label_13;
label_10:
                  switch (num8)
                  {
                    default:
                      continue;
                  }
label_13:
                  num8 = 0;
                  goto label_10;
                }
              }
            }
            int num9 = 0;
            if (XbZ.GGa())
              goto label_21;
label_7:
            switch (num9)
            {
              default:
                goto label_71;
            }
label_21:
            num9 = 0;
            goto label_7;
          }
          finally
          {
            enumerator2?.Dispose();
          }
label_71:
          goto label_72;
label_70:
          gN gN = (gN) current1;
          foreach (uy uy in gN.Jv9().Values)
          {
            bool flag3 = uy.Ldi() != null;
            int num10 = 1;
            if (XbZ.nGl() == null)
              goto label_51;
label_50:
            int num11;
            num10 = num11;
label_51:
            while (true)
            {
              int num12;
              switch (num10)
              {
                case 1:
                  if (!flag3)
                  {
                    if (XbZ.nGl() == null)
                    {
                      num10 = 0;
                      continue;
                    }
                    goto label_50;
                  }
                  else
                  {
                    this.lAU(uy.Ldi(), current1);
                    goto default;
                  }
                case 2:
                  num12 = gN.gvw() != null ? 1 : 0;
                  break;
                case 3:
                  goto label_58;
                default:
                  if (uy.jdU().Yvl() != null)
                  {
                    if (!(uy.jdU().Yvl() is el))
                    {
                      if (uy.jdU().Yvl() is jq)
                      {
                        num10 = XbZ.GGa() ? 2 : 0;
                        continue;
                      }
                      num12 = 0;
                      break;
                    }
                    goto label_64;
                  }
                  else
                    goto label_58;
              }
              if (num12 != 0)
              {
                Xbm.vQp(XbZ.gGk((object) uy.jdU().Yvl()), "Cannot have unknown sized arrays within compressed blocks: '" + uy.vSF() + "'");
                if (XbZ.GGa())
                  num10 = 3;
                else
                  goto label_50;
              }
              else
                break;
            }
label_58:
            continue;
label_64:
            this.lAU((uy.jdU().Yvl() as el).xsA(), current1);
            goto label_58;
          }
label_72:
          continue;
label_47:
          current1 = enumerator1.Current;
          enumerator3 = current1.pSz().Values.GetEnumerator();
          num2 = 0;
          if (XbZ.GGa())
            goto label_3;
          else
            goto label_2;
label_74:
          if (XbZ.nGl() == null)
          {
            num2 = 1;
            goto label_3;
          }
          else
            goto label_2;
        }
label_87:;
      }
    }

    private void lAU(uz _param1, lZ _param2)
    {
      this.gAf(_param1, (Yb4) XbZ.tGS((object) _param1), _param2);
      this.IAh(_param1.pwa(), _param2);
    }

    private void gAf(uz _param1, Yb4 _param2, lZ _param3)
    {
label_36:
      for (int index1 = 0; index1 < XbZ.wGz((object) _param2.MwA()); ++index1)
      {
        j7 j7 = _param2.MwA()[index1];
        bool flag1;
        int num1;
        switch (j7)
        {
          case QbG _:
            if (XbZ.GGa())
            {
              num1 = 0;
              goto label_2;
            }
            else
              break;
          case Yb4 _:
            this.gAf(_param1, j7 as Yb4, _param3);
            goto label_15;
          case pb8 _:
            pb8 pb8 = j7 as pb8;
            if (pb8.Gid() != "sizeof")
            {
              Xbm.vQp(XbZ.TG0((object) pb8), "Unknown function: '" + pb8.Gid() + "'");
              return;
            }
            if (this.cAd.Cfv().ContainsKey(pb8.XiQ()))
            {
              if (this.cAd.Cfv()[pb8.XiQ()] is gN)
                this.WAs(pb8.aSZ(), this.cAd.Cfv()[(string) XbZ.lG5((object) pb8)] as gN);
              pb8.vih(XbZ.aGR((object) this.cAd.Cfv()[pb8.XiQ()]));
              continue;
            }
            Xbm.vQp(XbZ.HGN((object) pb8), "Could not find the data-block: '" + pb8.XiQ() + "'");
            num1 = 17;
            goto label_2;
          default:
label_46:
            flag1 = j7 is GbP;
            num1 = 22;
            goto label_2;
        }
label_1:
        int num2;
        num1 = num2;
label_2:
        GbP gbP;
        ybn ybn;
        while (true)
        {
          int index2;
          iL iL;
          string str;
          bool flag2;
          bool flag3;
          zbI zbI;
          lZ lZ;
          wu wu;
          string key;
          bool flag4;
          switch (num1)
          {
            case 1:
              goto label_6;
            case 2:
              RD rd = lZ as RD;
              wu.AvO((Y1) XbZ.yGV((object) rd));
              goto label_26;
            case 3:
              goto label_46;
            case 4:
            case 11:
label_7:
              ++index2;
              break;
            case 5:
              ybn.AwD().Add((wu) zbI);
              lZ = (lZ) null;
              goto case 4;
            case 6:
              if (flag4)
              {
                iL = (lZ as gN).Jv9()[key].jdU();
                wu = (wu) (lZ as gN).Jv9()[key];
                if (!(iL is RQ))
                {
                  flag3 = iL is Y1;
                  num1 = 24;
                  continue;
                }
                num1 = 12;
                continue;
              }
              goto case 14;
            case 7:
              zbI.cSE(gbP.aSZ());
              if (XbZ.GGa())
              {
                num1 = 5;
                continue;
              }
              goto label_1;
            case 8:
              str = "function type";
              if (XbZ.nGl() == null)
              {
                num1 = 10;
                continue;
              }
              goto label_1;
            case 9:
              ybn.AwD().Add((wu) lZ.pSz()[key]);
              str = " local variable";
              lZ = (lZ) null;
              goto case 4;
            case 10:
              ybn.AwD().Add(wu);
              lZ = (lZ) null;
              num1 = 4;
              continue;
            case 12:
              lZ = (iL as RQ).ShH();
              if (lZ is RD)
              {
                num1 = !XbZ.GGa() ? 1 : 2;
                continue;
              }
              goto label_26;
            case 13:
              _param2.MwA().Insert(index1, (j7) ybn);
              _param2.MwA().Remove(j7);
              num1 = 23;
              continue;
            case 14:
              str = "unknown variable or enum-alias.";
              zbI = new zbI();
              zbI.YSJ(key);
              num1 = 7;
              continue;
            case 15:
              goto label_22;
            case 16:
              if (flag2)
              {
                num1 = 8;
                continue;
              }
              Xbm.vQp(XbZ.gGk((object) lZ), "Unexpected error. Unknown type.");
              goto case 4;
            case 17:
              goto label_15;
            case 19:
              goto label_45;
            case 20:
              ybn.AwD().Add(wu);
              lZ = (lZ) null;
              num1 = 11;
              continue;
            case 21:
              goto label_34;
            case 22:
              if (flag1)
              {
                gbP = j7 as GbP;
                if (gbP.ToString() == "true" || XbZ.EGB((object) gbP.ToString(), (object) "false"))
                {
                  Ob6 ob6 = new Ob6();
                  ob6.cSE(gbP.aSZ());
                  ob6.Nwc(XbZ.EGB((object) gbP.ToString(), (object) "true"));
                  _param2.MwA().Insert(index1, (j7) ob6);
                  num1 = 15;
                  continue;
                }
                if (gbP.ToString() == "value")
                {
                  if (_param3 is RD)
                  {
                    ybO ybO = new ybO();
                    ybO.cSE(XbZ.IGW((object) gbP));
                    _param2.MwA().Insert(index1, (j7) ybO);
                    if (XbZ.GGa())
                    {
                      num1 = 21;
                      continue;
                    }
                    goto label_1;
                  }
                  else
                    goto label_17;
                }
                else
                  goto label_45;
              }
              else
                goto label_15;
            case 23:
              str = _param3.ToString();
              lZ = _param3;
              index2 = 0;
              break;
            case 24:
              if (!flag3)
              {
                flag2 = iL is kY;
                num1 = 16;
                continue;
              }
              str = "primitive type";
              num1 = 20;
              continue;
            default:
              goto label_36;
          }
          if (index2 < gbP.Mwk().Count)
          {
            key = gbP.Mwk()[index2];
            if (lZ == null)
            {
              Xbm.vQp(j7.aSZ(), "Variable '" + gbP.Mwk()[index2 - 1] + "' cannot contain any variables because it of type: " + str);
              num1 = XbZ.GGa() ? 1 : 0;
              continue;
            }
            if (!lZ.pSz().ContainsKey(key))
            {
              flag4 = lZ is gN && (lZ as gN).Jv9().ContainsKey(key);
              if (XbZ.GGa())
              {
                num1 = 6;
                continue;
              }
              goto label_1;
            }
            else
            {
              num1 = 9;
              continue;
            }
          }
          else
            break;
label_26:
          ybn.AwD().Add(wu);
          goto label_7;
        }
label_6:
        _param1.uwv().Add(ybn);
        goto label_15;
label_17:
        Xbm.vQp(gbP.aSZ(), "The 'value' expression variable may only be used in consumed types.");
        num2 = 18;
        goto label_1;
label_22:
        _param2.MwA().Remove((j7) gbP);
        continue;
label_34:
        _param2.MwA().Remove((j7) gbP);
        continue;
label_45:
        ybn = new ybn();
        ybn.cSE(j7.aSZ());
        num2 = 13;
        goto label_1;
label_15:;
      }
    }

    private void IAh(Yb4 _param1, lZ _param2)
    {
      int index = 0;
      while (true)
      {
        bool flag1 = index < _param1.MwA().Count;
        int num1 = 11;
        zbI zbI;
        j7 j7;
        while (true)
        {
          bool flag2;
          ybn ybn1;
          QbG qbG;
          ybn ybn2;
          uy uy;
          Ab5 ab5;
          bool flag3;
          hc hc;
          bool flag4;
          int num2;
          switch (num1)
          {
            case 1:
              XbZ.vXx((object) ybn1, (object) ab5);
              goto label_5;
            case 2:
              ab5.cSE(zbI.aSZ());
              if (qbG.niZ() == "==" || XbZ.EGB((object) qbG.niZ(), (object) "!="))
              {
                _param1.MwA().Insert(index, (j7) ab5);
                _param1.MwA().Remove(j7);
                num1 = XbZ.nGl() == null ? 1 : 0;
                continue;
              }
              Xbm.vQp(qbG.aSZ(), "The operator '" + qbG.niZ() + "' cannot be used with the enum alias '" + hc.JdX() + "'. Only == and != are allowed.");
              goto case 1;
            case 3:
            case 13:
              if (ybn2 != null)
              {
                if (XbZ.GGa())
                {
                  num1 = 10;
                  continue;
                }
                break;
              }
              goto label_38;
            case 4:
              RQ rq = uy.jdU() as RQ;
              if (rq.ShH() is lk && (rq.ShH() as lk).hhA().ContainsKey(zbI.vSF()))
              {
                flag2 = true;
                hc = (rq.ShH() as lk).hhA()[zbI.vSF()];
                ab5 = new Ab5();
                ab5.ewX(XbZ.UXc((object) rq) as lk);
                ab5.WwP(hc);
                num1 = XbZ.GGa() ? 2 : 1;
                continue;
              }
              goto label_5;
            case 5:
              goto label_20;
            case 6:
              goto label_37;
            case 7:
              goto label_23;
            case 8:
              j7 = _param1.MwA()[index];
              flag3 = j7 is Yb4;
              if (XbZ.nGl() == null)
              {
                num1 = 0;
                continue;
              }
              break;
            case 9:
              if (!flag4)
              {
                zbI = ybn1.Cw2() as zbI;
                ybn2 = (ybn) null;
                flag2 = false;
                qbG = (QbG) null;
                if (index >= 2 && _param1.MwA()[index - 2] is ybn)
                {
                  qbG = _param1.MwA()[index - 1] as QbG;
                  ybn2 = _param1.MwA()[index - 2] as ybn;
                  num1 = 13;
                  continue;
                }
                if (index + 2 >= XbZ.wGz((object) _param1.MwA()) || !(_param1.MwA()[index + 2] is ybn))
                {
                  num1 = XbZ.GGa() ? 3 : 0;
                  continue;
                }
                goto case 12;
              }
              else
                goto label_37;
            case 10:
              if (ybn2.Cw2() is uy)
              {
                num2 = XbZ.uXi((object) (ybn2.Cw2() as uy)) is RQ ? 1 : 0;
                goto label_39;
              }
              else
                goto label_38;
            case 11:
              if (flag1)
                goto case 8;
              else
                goto label_34;
            case 12:
              qbG = _param1.MwA()[index + 1] as QbG;
              ybn2 = _param1.MwA()[index + 2] as ybn;
              goto case 3;
            default:
              if (flag3)
              {
                num1 = 7;
                continue;
              }
              if (j7 is ybn)
              {
                ybn1 = j7 as ybn;
                flag4 = !(ybn1.Cw2() is zbI);
                num1 = 9;
                continue;
              }
              num1 = 6;
              continue;
          }
          int num3;
          num1 = num3;
          continue;
label_5:
label_6:
          if (!flag2)
          {
            num1 = 5;
            continue;
          }
          goto label_36;
label_38:
          num2 = 0;
label_39:
          if (num2 != 0)
          {
            uy = ybn2.Cw2() as uy;
            num1 = 4;
          }
          else
            goto label_6;
        }
label_20:
        Xbm.vQp(zbI.aSZ(), "Unresolved variable name: '" + zbI.vSF() + "'");
        goto label_36;
label_23:
        this.IAh(j7 as Yb4, _param2);
        goto label_37;
label_36:
label_37:
        ++index;
      }
label_34:;
    }

    private void WAs(Hi _param1, gN _param2)
    {
      int num1 = 0;
      foreach (uy uy in (IEnumerable<uy>) _param2.Fv8())
      {
        if (XbZ.LXr(XbZ.GX2((object) uy)) != null)
          goto label_5;
        else
          goto label_6;
label_2:
        Yb4 yb4;
        int num2;
        int num3;
        switch (num3)
        {
          case 1:
          case 2:
            goto label_9;
          case 3:
            goto label_12;
          default:
            num2 = yb4.MwA()[0] is pbC ? 1 : 0;
            goto label_16;
        }
label_5:
        if (uy.Pvb().Yvl() is el)
        {
          yb4 = (uy.Pvb().Yvl() as el).xsA().pwa();
          if (yb4.MwA().Count == 1)
          {
            num3 = 0;
            if (XbZ.nGl() == null)
            {
              num3 = 0;
              goto label_2;
            }
            else
              goto label_2;
          }
          else
          {
            num2 = 0;
            goto label_16;
          }
        }
        else
          goto label_12;
label_6:
        num1 += bbH.UQ9(uy.Pvb());
        int num4;
        num3 = XbZ.nGl() == null ? 2 : num4;
        goto label_2;
label_9:
        continue;
label_12:
        num1 = 0;
        XbZ.UXj(_param1, (object) ("Cannot get size of a block with unknown size (because of array extension in: '" + _param2.vSF() + "." + (string) XbZ.tXX((object) uy) + "')"));
        break;
label_16:
        if (num2 == 0)
        {
          Xbm.vQp(_param1, "Could not get size of block '" + (string) XbZ.xXG((object) _param2) + "' as it has a field with non-simple array-extension.");
          goto label_9;
        }
        else
        {
          num1 += bbH.UQ9(uy.Pvb()) * (int) (yb4.MwA()[0] as pbC).Owl();
          goto label_9;
        }
      }
      _param2.rvm(num1);
    }

    public XbZ()
    {
      Jnb.vbPcO4();
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    internal static Hi gGk([In] object obj0) => ((Ho) obj0).aSZ();

    internal static object GG1([In] object obj0) => (object) ((rbB) obj0).eQL();

    internal static bool GGa() => XbZ.hGd == null;

    internal static XbZ nGl() => XbZ.hGd;

    internal static object tGS([In] object obj0) => (object) ((uz) obj0).pwa();

    internal static Hi TG0([In] object obj0) => ((pb8) obj0).EiG();

    internal static object lG5([In] object obj0) => (object) ((pb8) obj0).XiQ();

    internal static int aGR([In] object obj0) => ((lZ) obj0).Pvh();

    internal static Hi HGN([In] object obj0) => ((pb8) obj0).Fix();

    internal static bool EGB([In] object obj0, [In] object obj1) => (string) obj0 == (string) obj1;

    internal static Hi IGW([In] object obj0) => ((GbP) obj0).aSZ();

    internal static object yGV([In] object obj0) => (object) ((wu) obj0).Pvb();

    internal static int wGz([In] object obj0) => ((ICollection<j7>) obj0).Count;

    internal static object uXi([In] object obj0) => (object) ((uy) obj0).jdU();

    internal static object UXc([In] object obj0) => (object) ((RQ) obj0).ShH();

    internal static void vXx([In] object obj0, [In] object obj1) => ((ybn) obj0).NwW((wu) obj1);

    internal static object GX2([In] object obj0) => (object) ((uy) obj0).Pvb();

    internal static object LXr([In] object obj0) => (object) ((Y1) obj0).Yvl();

    internal static object xXG([In] object obj0) => (object) ((lZ) obj0).vSF();

    internal static object tXX([In] object obj0) => (object) ((uy) obj0).vSF();

    internal static void UXj(Hi _param0, [In] object obj1) => Xbm.vQp(_param0, (string) obj1);
  }
}
