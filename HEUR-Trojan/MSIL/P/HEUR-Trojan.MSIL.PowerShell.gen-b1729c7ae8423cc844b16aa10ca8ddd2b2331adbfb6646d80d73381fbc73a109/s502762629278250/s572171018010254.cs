// Decompiled with JetBrains decompiler
// Type: s502762629278250.s572171018010254
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using FastSerialization;
using s068979146915301;
using s214170901478238;
using s345301068684082;
using s502719414289374;
using s524124129995258;
using s528813736053581;
using s535820167059183;
using s564412675469531;
using s686708834606903;
using s736322905406258;
using s790378171014915;
using s800090574810683;
using s814626784262558;
using s874166642857481;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;

namespace s502762629278250
{
  public sealed class s572171018010254 : IFastSerializable
  {
    private int s693129164183527;
    internal s878863610233214 s403162195070723;
    private s953925013719849 s028255131649276;
    private string s429374774088917;
    internal string s503519833641966;
    private string s208938274442609;
    internal long s558806197829595;
    internal long s333916362686060;
    internal long s475005698990932;
    private int? s363380053355338;
    private int s598920009183546;
    private s572171018010254 s654717382863913;
    internal int s080325781320568;
    internal bool s822930018651373;
    internal bool s921486656584021;
    internal bool s942138922473892;
    internal bool s888674958624301;
    internal bool s542331327669562;
    internal Dictionary<int, int> s036455382225980 = new Dictionary<int, int>();
    private s941863378021032 s899941048623205;
    internal Dictionary<ulong, s320811790897239> s846391804077321;
    internal GrowableArray<s320811790897239> s792397891772220;
    internal bool s598874510392508;
    internal bool s434947882065434;
    internal GrowableArray<GrowableArray<s572171018010254.s655353023623633>> s167182750092555;
    internal Dictionary<ulong, s528638463248059> s685256247007234;

    public int s308323137639863 => this.s693129164183527;

    public s878863610233214 s140946683671142 => this.s403162195070723;

    public string s657075392570271
    {
      get
      {
        if (this.s208938274442609 == null)
        {
          this.s208938274442609 = s953925013719849.s804847436886997(this.s268427667973650);
          if (this.s208938274442609.Length == 0 && this.s308323137639863 != -1 && this.s693129164183527 != 0)
            this.s208938274442609 = "Process(" + (object) this.s308323137639863 + ")";
        }
        return this.s208938274442609;
      }
    }

    public string s381739167324001 => this.s429374774088917;

    public string s268427667973650 => this.s503519833641966;

    public DateTime s949337600280682 => this.s028255131649276.s276830151701033(this.s333916362686060).ToLocalTime();

    public double s617375497136334 => this.s028255131649276.s119039697778322(this.s333916362686060);

    public DateTime s484639003214557 => this.s028255131649276.s276830151701033(this.s475005698990932).ToLocalTime();

    public double s614285379773939 => this.s028255131649276.s119039697778322(this.s475005698990932);

    public int s589831800412482 => this.s598920009183546;

    public s572171018010254 s544604432273513 => this.s654717382863913;

    public int? s803200613645857 => this.s363380053355338;

    public float s577446022787315 => (float) this.s080325781320568 * (float) this.s349566078049337.s407580712989469.TotalMilliseconds;

    public bool s412096044998296
    {
      get
      {
        if (this.s822930018651373)
          return true;
        return !this.s921486656584021 && this.s028255131649276.s689287821023553 == 8;
      }
    }

    public s953925013719849 s349566078049337 => this.s028255131649276;

    public IEnumerable<s399735979708807> s664681729362631
    {
      get
      {
        s572171018010254.s298108563897460 threads = (s572171018010254.s298108563897460) new s572171018010254.s655353023623633(-2);
        threads.s279800064843756 = this;
        return (IEnumerable<s399735979708807>) threads;
      }
    }

    public s941863378021032 s698122617354455 => this.s899941048623205;

    public s473104975773947 s772058344672229 => this.s028255131649276.s427461272038725.s655469803769761(this.s333916362686060, this.s475005698990932, (Predicate<s034852122986107>) (s098848069210025 => s098848069210025.s102913512010943 == this.s693129164183527 || s098848069210025.s102913512010943 == -1));

    public s473104975773947 s544384145100420 => this.s028255131649276.s427461272038725.s655469803769761(this.s333916362686060, this.s475005698990932, (Predicate<s034852122986107>) null);

    public virtual string s037578857138220()
    {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.Append("<s572171018010254 ");
      stringBuilder.Append("PID=").Append(s471684335504367.s639751879214616(this.s308323137639863)).Append(" ");
      stringBuilder.Append("ProcessIndex=").Append(s471684335504367.s732483410121786((object) this.s140946683671142)).Append(" ");
      stringBuilder.Append("ParentID=").Append(s471684335504367.s639751879214616(this.s589831800412482)).Append(" ");
      stringBuilder.Append("Exe=").Append(s471684335504367.s732483410121786((object) this.s657075392570271)).Append(" ");
      stringBuilder.Append("Start=").Append(s471684335504367.s732483410121786((object) this.s617375497136334)).Append(" ");
      stringBuilder.Append("End=").Append(s471684335504367.s732483410121786((object) this.s614285379773939)).Append(" ");
      if (this.s803200613645857.HasValue)
        stringBuilder.Append("ExitStatus=").Append(s471684335504367.s639751879214616(this.s803200613645857.Value)).Append(" ");
      stringBuilder.Append("CPUMSec=").Append(s471684335504367.s732483410121786((object) this.s577446022787315)).Append(" ");
      stringBuilder.Append("Is64Bit=").Append(s471684335504367.s732483410121786((object) this.s412096044998296)).Append(" ");
      stringBuilder.Append("CommandLine=").Append(s471684335504367.s732483410121786((object) this.s381739167324001)).Append(" ");
      stringBuilder.Append("/>");
      return stringBuilder.ToString();
    }

    internal void s667997134385463(s499525253300813 s565769003809648)
    {
      this.s349566078049337.s639100242681190(this.s598920009183546 == 0, "Events for process happen before process start.  PrevEventTime: " + this.s617375497136334.ToString("f4"), (s034852122986107) s565769003809648);
      this.s333916362686060 = s565769003809648.s770722554724548 != s531105564102108.DataCollectionStart ? s565769003809648.s218856315967206 : this.s028255131649276.s432147997440474;
      this.s429374774088917 = s565769003809648.s880913052396840;
      this.s503519833641966 = s565769003809648.s142223467532307;
      this.s598920009183546 = s565769003809648.s186174449735029;
    }

    internal void s829624720208043(s499525253300813 s293513310699253)
    {
      if (this.s429374774088917.Length == 0)
        this.s429374774088917 = s293513310699253.s880913052396840;
      this.s503519833641966 = s293513310699253.s142223467532307;
      if (this.s598920009183546 == 0 && s293513310699253.s186174449735029 != 0)
        this.s598920009183546 = s293513310699253.s186174449735029;
      if (s293513310699253.s770722554724548 != s531105564102108.DataCollectionStop)
      {
        if (s293513310699253.s770722554724548 == s531105564102108.Stop)
          this.s363380053355338 = new int?(s293513310699253.s527238642544801);
        this.s475005698990932 = s293513310699253.s218856315967206;
      }
      this.s349566078049337.s639100242681190(this.s333916362686060 <= this.s475005698990932, "Process Ends before it starts! StartTime: " + this.s617375497136334.ToString("f4"), (s034852122986107) s293513310699253);
    }

    internal void s211593240361184(s572171018010254 s018469037993790 = null)
    {
      if (this.s654717382863913 != null || this.s598920009183546 == -1)
        return;
      if (this.s598920009183546 == 0)
      {
        this.s598920009183546 = -1;
      }
      else
      {
        s572171018010254 s572171018010254 = this.s349566078049337.s386698456584430.s706568529901378(this.s598920009183546, this.s333916362686060, out int _);
        if (s572171018010254 == null)
          return;
        if (s018469037993790 == null)
          s018469037993790 = new s572171018010254(-1, this.s349566078049337, s878863610233214.Invalid);
        this.s654717382863913 = s018469037993790;
        if (s572171018010254.s654717382863913 == s018469037993790)
        {
          this.s654717382863913 = (s572171018010254) null;
          this.s598920009183546 = -1;
        }
        else
        {
          s572171018010254.s211593240361184(s018469037993790);
          this.s654717382863913 = s572171018010254;
        }
      }
    }

    internal s572171018010254(int processID, s953925013719849 log, s878863610233214 processIndex)
    {
      this.s028255131649276 = log;
      this.s693129164183527 = processID;
      this.s403162195070723 = processIndex;
      this.s475005698990932 = long.MaxValue;
      this.s429374774088917 = "";
      this.s503519833641966 = "";
      this.s899941048623205 = new s941863378021032(this);
      this.s685256247007234 = new Dictionary<ulong, s528638463248059>();
    }

    void IFastSerializable.s314811842219999(Serializer s972861854742638)
    {
      s972861854742638.Write(this.s693129164183527);
      s972861854742638.Write((int) this.s403162195070723);
      s972861854742638.Write((IFastSerializable) this.s028255131649276);
      s972861854742638.Write(this.s429374774088917);
      s972861854742638.Write(this.s503519833641966);
      s972861854742638.Write(this.s558806197829595);
      s972861854742638.Write(this.s333916362686060);
      s972861854742638.Write(this.s475005698990932);
      s972861854742638.Write(this.s363380053355338.HasValue);
      if (this.s363380053355338.HasValue)
        s972861854742638.Write(this.s363380053355338.Value);
      s972861854742638.Write(this.s598920009183546);
      s972861854742638.Write((IFastSerializable) this.s654717382863913);
      s972861854742638.Write((IFastSerializable) this.s899941048623205);
      s972861854742638.Write(this.s080325781320568);
      s972861854742638.Write(this.s822930018651373);
      s972861854742638.Write(this.s921486656584021);
    }

    void IFastSerializable.s462814427567906(Deserializer s781796866287840)
    {
      s781796866287840.Read(ref this.s693129164183527);
      int num;
      s781796866287840.Read(ref num);
      this.s403162195070723 = (s878863610233214) num;
      s781796866287840.Read<s953925013719849>(ref this.s028255131649276);
      s781796866287840.Read(ref this.s429374774088917);
      s781796866287840.Read(ref this.s503519833641966);
      s781796866287840.Read(ref this.s558806197829595);
      s781796866287840.Read(ref this.s333916362686060);
      s781796866287840.Read(ref this.s475005698990932);
      this.s363380053355338 = !s781796866287840.ReadBool() ? new int?() : new int?(s781796866287840.ReadInt());
      s781796866287840.Read(ref this.s598920009183546);
      s781796866287840.Read<s572171018010254>(ref this.s654717382863913);
      s781796866287840.Read<s941863378021032>(ref this.s899941048623205);
      s781796866287840.Read(ref this.s080325781320568);
      s781796866287840.Read(ref this.s822930018651373);
      s781796866287840.Read(ref this.s921486656584021);
    }

    internal s708248100786105 s793534852350482(ulong s749680321116752)
    {
      int num;
      // ISSUE: reference to a compiler-generated field
      this.s167182750092555.BinarySearch<ulong>(s749680321116752, ref num, (Func<ulong, GrowableArray<s572171018010254.s655353023623633>, int>) ((s055191416890518, s708341437478068) => s055191416890518.CompareTo(((s695099563455931.s405206113263143) s708341437478068[0]).s675480664540741)));
      if (num < 0)
        return s708248100786105.Invalid;
      GrowableArray<s572171018010254.s655353023623633> growableArray = this.s167182750092555[num];
      // ISSUE: reference to a compiler-generated field
      growableArray.BinarySearch<ulong>(s749680321116752, ref num, (Func<ulong, s572171018010254.s655353023623633, int>) ((s615494013405246, s933445985230827) => s615494013405246.CompareTo(((s695099563455931.s405206113263143) s933445985230827).s675480664540741)));
      if (num < 0)
        return s708248100786105.Invalid;
      s572171018010254.s655353023623633 s655353023623633 = growableArray[num];
      // ISSUE: reference to a compiler-generated field
      return ((s695099563455931.s405206113263143) s655353023623633).s675480664540741 + (ulong) (uint) s655353023623633.s909405718372162 <= s749680321116752 ? s708248100786105.Invalid : s655353023623633.s942780405862091;
    }

    internal void s326369955232080(
      ulong s630023531108868,
      int s498244301764119,
      Func<s572171018010254.s655353023623633> s660362706571930)
    {
      int index1;
      // ISSUE: reference to a compiler-generated field
      if (this.s167182750092555.BinarySearch<ulong>(s630023531108868, ref index1, (Func<ulong, GrowableArray<s572171018010254.s655353023623633>, int>) ((s850151319905729, s030570907368283) => s850151319905729.CompareTo(((s695099563455931.s405206113263143) s030570907368283[0]).s675480664540741))))
        return;
      if (index1 < 0)
      {
        index1 = 0;
        GrowableArray<s572171018010254.s655353023623633> growableArray = new GrowableArray<s572171018010254.s655353023623633>();
        growableArray.Add(s660362706571930());
        this.s167182750092555.Insert(0, growableArray);
      }
      else
      {
        GrowableArray<s572171018010254.s655353023623633> growableArray1 = this.s167182750092555[index1];
        int num = growableArray1.Count - 1;
        // ISSUE: reference to a compiler-generated field
        if (s630023531108868 < ((s695099563455931.s405206113263143) growableArray1[num]).s675480664540741)
        {
          // ISSUE: reference to a compiler-generated field
          if (growableArray1.BinarySearch<ulong>(s630023531108868, ref num, (Func<ulong, s572171018010254.s655353023623633, int>) ((s328599848252866, s718931342290124) => s328599848252866.CompareTo(((s695099563455931.s405206113263143) s718931342290124).s675480664540741))))
            return;
          ++num;
          if (growableArray1.Count - num <= 8)
          {
            this.s167182750092555.UnderlyingArray[index1].Insert(num, s660362706571930());
            return;
          }
          GrowableArray<s572171018010254.s655353023623633> growableArray2 = new GrowableArray<s572171018010254.s655353023623633>();
          for (int index2 = num; index2 < growableArray1.Count; ++index2)
            growableArray2.Add(growableArray1[index2]);
          this.s167182750092555.UnderlyingArray[index1].Count = num;
          this.s167182750092555.Insert(index1 + 1, growableArray2);
        }
        this.s167182750092555.UnderlyingArray[index1].Add(s660362706571930());
      }
    }

    [Conditional("DEBUG")]
    private void s502283058254691()
    {
      ulong num = 0;
      for (int index1 = 0; index1 < this.s167182750092555.Count; ++index1)
      {
        GrowableArray<s572171018010254.s655353023623633> growableArray = this.s167182750092555[index1];
        for (int index2 = 0; index2 < growableArray.Count; ++index2)
        {
          // ISSUE: reference to a compiler-generated field
          num = ((s695099563455931.s405206113263143) growableArray[index2]).s675480664540741;
        }
      }
    }

    internal class s655353023623633
    {
      public int s909405718372162;
      public s708248100786105 s942780405862091;
      public s689802712977948 s380588647642276;
      private int s633309605245489;

      [DebuggerHidden]
      public s655353023623633(int _param1)
      {
        this.s633309605245489 = _param1;
        // ISSUE: reference to a compiler-generated field
        ((s572171018010254.s298108563897460) this).s014497331515354 = Environment.CurrentManagedThreadId;
      }
    }
  }
}
