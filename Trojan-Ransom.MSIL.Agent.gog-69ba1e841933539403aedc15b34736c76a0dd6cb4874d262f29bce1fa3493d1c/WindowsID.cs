// Decompiled with JetBrains decompiler
// Type: CryptoNar.WindowsID
// Assembly: kasperskytrialreset, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 35F54376-B284-4294-89A4-F0FFEE9E54ED
// Assembly location: C:\Users\Administrateur\Downloads\toto\Trojan-Ransom.MSIL.Agent.gog-69ba1e841933539403aedc15b34736c76a0dd6cb4874d262f29bce1fa3493d1c.exe

using System;
using System.Management;
using System.Security.Cryptography;
using System.Text;

namespace CryptoNar
{
  internal class WindowsID
  {
    public static string getWindowsID() => WindowsID.WindowsId();

    private static string WindowsId()
    {
      string str = "";
      ManagementObjectCollection objectCollection = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_OperatingSystem").Get();
      bool flag = !string.IsNullOrEmpty(Environment.GetEnvironmentVariable("PROCESSOR_ARCHITEW6432"));
      using (ManagementObjectCollection.ManagementObjectEnumerator enumerator = objectCollection.GetEnumerator())
      {
        if (enumerator.MoveNext())
        {
          ManagementObject current = (ManagementObject) enumerator.Current;
          str = current.Properties["Caption"].Value.ToString() + Environment.GetEnvironmentVariable("PROCESSOR_ARCHITEW6432") + current.Properties["Version"].Value.ToString();
        }
      }
      str.Replace(" ", "");
      str.Replace("Windows", "");
      str.Replace("windows", "");
      string s = str + (flag ? ":64" : "=32");
      return BitConverter.ToString(MD5.Create().ComputeHash(Encoding.Default.GetBytes(s))).Replace("-", "");
    }
  }
}
