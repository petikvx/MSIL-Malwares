// Decompiled with JetBrains decompiler
// Type: s985393833263885.s726691949965431
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s032321671181028;
using s111377166353221;
using s179458635260178;
using s297449729949532;
using s335568315505947;
using s418410312208900;
using s528813736053581;
using s551269714710412;
using s814626784262558;
using s852002970843533;
using s885500789572734;
using s954304824645883;
using s962360155664524;
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;
using System.Threading;

namespace s985393833263885
{
  public abstract class s726691949965431 : s470725726477034
  {
    private unsafe s726691949965431.s494209931687311* s491213108549030;
    private s034852122986107[] s681409368106643;
    private Dictionary<Guid, s726691949965431.s307629243291830> s606973178084116;
    private int s799561111067423;
    private int s442283128869524;
    internal s721618822471206 s049539798171424;
    internal bool s301783657697048;
    internal s130497541240854 s667860393794299;
    private Func<s034852122986107, bool>[] s325720338437496;
    private Action<s034852122986107> s423657939817789;

    public static s726691949965431 s622202295483407(
      string s160445842755355,
      s748366080249292 s181320438430471 = null)
    {
      if (s160445842755355.EndsWith(".trace.zip", StringComparison.OrdinalIgnoreCase))
        return (s726691949965431) new s384585984974928(s160445842755355);
      if (s160445842755355.EndsWith(".netperf", StringComparison.OrdinalIgnoreCase))
        return (s726691949965431) new s091584904371036(s160445842755355);
      if (s160445842755355.EndsWith(".nettrace", StringComparison.OrdinalIgnoreCase))
        return (s726691949965431) new s091584904371036(s160445842755355);
      if (s160445842755355.EndsWith(".etl", StringComparison.OrdinalIgnoreCase) || s160445842755355.EndsWith(".etlx", StringComparison.OrdinalIgnoreCase) || s160445842755355.EndsWith(".etl.zip", StringComparison.OrdinalIgnoreCase))
        return (s726691949965431) new s302986156607931(s160445842755355);
      return s160445842755355.EndsWith(".btl", StringComparison.OrdinalIgnoreCase) ? (s726691949965431) new s957499255786291(s160445842755355, s181320438430471) : (s726691949965431) null;
    }

    public event Action<s034852122986107> s189884453531623
    {
      add => this.s049539798171424.s646793624126292 += value;
      remove => this.s049539798171424.s646793624126292 -= value;
    }

    public event Action<s034852122986107> s433112295278096;

    [Obsolete("Use UnhandledEvents")]
    public event Action<s034852122986107> s137435713240383
    {
      add => this.s049539798171424.s646793624126292 += value;
      remove => this.s049539798171424.s646793624126292 -= value;
    }

    [Obsolete("Use AllEvents")]
    public event Action<s034852122986107> s663841782519038
    {
      add => this.s433112295278096 += value;
      remove => this.s433112295278096 -= value;
    }

    public abstract bool s227650494626187();

    public virtual void s536266016348602() => this.s301783657697048 = true;

    public event Action s416163492352881;

    public void s464173899751447(
      Action<s034852122986107, Action<s034852122986107>> s398178110703204)
    {
      // ISSUE: variable of a compiler-generated type
      s726691949965431.s543446947395565 s543446947395565 = (s726691949965431.s543446947395565) new s726691949965431.s307629243291830();
      ((s726691949965431.s307629243291830) s543446947395565).s834921858152769 = s398178110703204;
      if (((s726691949965431.s307629243291830) s543446947395565).s834921858152769 == null)
        throw new ArgumentException("Must provide a non-null callback", "hook", (Exception) null);
      // ISSUE: reference to a compiler-generated field
      s543446947395565.s259400016920699 = this.s423657939817789 ?? new Action<s034852122986107>(this.s151308823553073);
      // ISSUE: reference to a compiler-generated method
      this.s423657939817789 = new Action<s034852122986107>(s543446947395565.s885523300020674);
    }

    protected void OnCompleted()
    {
      // ISSUE: reference to a compiler-generated field
      Action s116215985900451 = this.s116215985900451;
      // ISSUE: reference to a compiler-generated field
      this.s116215985900451 = (Action) null;
      if (s116215985900451 == null)
        return;
      s116215985900451();
    }

    internal bool s971939266970509 => this.s278141955598740 != null;

    internal int s870427096639703()
    {
      int num = 0;
      for (int index = 0; index < this.s681409368106643.Length; ++index)
      {
        if (this.s681409368106643[index] != null)
          ++num;
      }
      return num;
    }

    internal int s982751136665975()
    {
      int num = 0;
      for (int index = 0; index < this.s681409368106643.Length; ++index)
      {
        for (s034852122986107 s389534926872031 = this.s681409368106643[index]; s389534926872031 != null; s389534926872031 = s389534926872031.s389534926872031)
          ++num;
      }
      return num;
    }

    internal string s587131651649908()
    {
      StringWriter stringWriter = new StringWriter();
      stringWriter.WriteLine("TableDump");
      for (int index = 0; index < this.s681409368106643.Length; ++index)
      {
        s034852122986107 s389534926872031 = this.s681409368106643[index];
        if (s389534926872031 != null)
        {
          stringWriter.WriteLine("Hash Bucket {0}", (object) index);
          for (; s389534926872031 != null; s389534926872031 = s389534926872031.s389534926872031)
            stringWriter.WriteLine("  Item {0} HashCode {1} Provider {2} EventNum {3}", (object) s389534926872031.GetType().Name, (object) s389534926872031.GetHashCode(), (object) s389534926872031.s066186047870744, (object) s389534926872031.s591345645465164);
        }
      }
      stringWriter.WriteLine("End TableDump");
      return stringWriter.ToString();
    }

    internal int s074230096053512() => this.s681409368106643.Length;

    internal s726691949965431()
    {
      this.s049539798171424 = new s721618822471206();
      this.s049539798171424.s388204795291822 = (s470725726477034) this;
      this.s007025116966936();
    }

    internal virtual void s121655522145316(Func<s034852122986107, bool> s121695816837022)
    {
      if (this.s325720338437496 == null)
      {
        this.s325720338437496 = new Func<s034852122986107, bool>[1]
        {
          s121695816837022
        };
      }
      else
      {
        Func<s034852122986107, bool>[] destinationArray = new Func<s034852122986107, bool>[this.s325720338437496.Length + 1];
        Array.Copy((Array) this.s325720338437496, (Array) destinationArray, this.s325720338437496.Length);
        destinationArray[this.s325720338437496.Length] = s121695816837022;
        this.s325720338437496 = destinationArray;
      }
    }

    protected internal unsafe void s551418563715328(s034852122986107 s180318052354735)
    {
      if (this.s423657939817789 == null)
      {
        this.s151308823553073(s180318052354735);
      }
      else
      {
        this.s423657939817789(s180318052354735);
        s180318052354735.s598076025198321 = (s134995860702422.s648877553938236*) null;
      }
    }

    private unsafe void s151308823553073(s034852122986107 s915369565586600)
    {
      if ((object) s915369565586600.s282757928832612 != null)
        s915369565586600.s528695732605110();
      if (s915369565586600.s389534926872031 != null)
      {
        s034852122986107 s034852122986107 = s915369565586600;
        while (true)
        {
          do
          {
            s034852122986107 = s034852122986107.s389534926872031;
            if (s034852122986107 == null)
              goto label_7;
          }
          while ((object) s034852122986107.s282757928832612 == null);
          s034852122986107.s598076025198321 = s915369565586600.s598076025198321;
          s034852122986107.s969799445044717 = s915369565586600.s969799445044717;
          s034852122986107.s973336997529299 = s915369565586600.s973336997529299;
          s034852122986107.s528695732605110();
          s034852122986107.s598076025198321 = (s134995860702422.s648877553938236*) null;
        }
      }
label_7:
      // ISSUE: reference to a compiler-generated field
      if (this.s278141955598740 != null)
      {
        if (this.s049539798171424 == s915369565586600)
          this.s049539798171424.s798794271436155();
        // ISSUE: reference to a compiler-generated field
        this.s278141955598740(s915369565586600);
      }
      s915369565586600.s598076025198321 = (s134995860702422.s648877553938236*) null;
    }

    internal unsafe s034852122986107 s128380686175907(
      s134995860702422.s648877553938236* s838751068858121)
    {
      int index1 = 0;
label_1:
      ushort s301818044239639 = ((s134995860702422.s728170393225391*) s838751068858121)->s870227314561507.s301818044239639;
      if (((int) ((s134995860702422.s728170393225391*) s838751068858121)->s870227314561507.s957198854550732 & 256) != 0)
        s301818044239639 += (ushort) ((s134995860702422.s728170393225391*) s838751068858121)->s870227314561507.s611740701286585;
      int* numPtr1 = (int*) &((s134995860702422.s728170393225391*) s838751068858121)->s870227314561507.s865414040669856;
      int index2 = *numPtr1 + (int) s301818044239639 * 9 & this.s799561111067423;
      while (true)
      {
        s726691949965431.s494209931687311* s494209931687311Ptr = this.s491213108549030 + index2;
        // ISSUE: reference to a compiler-generated field
        int* numPtr2 = (int*) &((s126519166327702.s719728307875047*) s494209931687311Ptr)->s063180124712490;
        if (*numPtr2 != *numPtr1 || numPtr2[1] != numPtr1[1] || numPtr2[2] != numPtr1[2] || numPtr2[3] != numPtr1[3] || (int) s494209931687311Ptr->s358004993095096 != (int) s301818044239639)
        {
          if (s494209931687311Ptr->s843146753814099)
            index2 = index2 + (int) s301818044239639 * 2 + 1 & this.s799561111067423;
          else
            goto label_11;
        }
        else
          break;
      }
      s034852122986107 s034852122986107 = this.s681409368106643[index2];
      if (s034852122986107 != null)
      {
        s034852122986107.s598076025198321 = s838751068858121;
        s034852122986107.s969799445044717 = s838751068858121->s066345635431405;
        s034852122986107.s973336997529299 = this.s667860393794299;
        ++this.s667860393794299;
        if ((this.s667860393794299 & (s130497541240854) 65535) == ~s130497541240854.Invalid)
          Thread.Sleep(0);
        return s034852122986107;
      }
label_11:
      this.s049539798171424.s598076025198321 = s838751068858121;
      this.s049539798171424.s969799445044717 = s838751068858121->s066345635431405;
      this.s049539798171424.s973336997529299 = this.s667860393794299;
      this.s049539798171424.s208437401079489 = this.s049539798171424.s852414036535478;
      ++this.s667860393794299;
      if ((this.s667860393794299 & (s130497541240854) 65535) == ~s130497541240854.Invalid)
        Thread.Sleep(0);
      this.s049539798171424.s379087247421555 = ~s531105564102108.Info;
      if (this.s325720338437496 != null && index1 < this.s325720338437496.Length)
      {
        this.s049539798171424.s798794271436155();
        do
        {
          bool flag = this.s325720338437496[index1]((s034852122986107) this.s049539798171424);
          ++index1;
          if (flag)
            goto label_1;
        }
        while (index1 < this.s325720338437496.Length);
      }
      return (s034852122986107) this.s049539798171424;
    }

    internal unsafe s034852122986107 s596070444842800(
      Guid s655698680343059,
      s076337548137908 s541550885179281)
    {
      ushort num = (ushort) s541550885179281;
      int* numPtr1 = (int*) &s655698680343059;
      int index = *numPtr1 + (int) num * 9 & this.s799561111067423;
      while (true)
      {
        s726691949965431.s494209931687311* s494209931687311Ptr = this.s491213108549030 + index;
        // ISSUE: reference to a compiler-generated field
        int* numPtr2 = (int*) &((s126519166327702.s719728307875047*) s494209931687311Ptr)->s063180124712490;
        if (*numPtr2 != *numPtr1 || numPtr2[1] != numPtr1[1] || numPtr2[2] != numPtr1[2] || numPtr2[3] != numPtr1[3] || (int) s494209931687311Ptr->s358004993095096 != (int) num)
        {
          if (s494209931687311Ptr->s843146753814099)
            index = index + (int) num * 2 + 1 & this.s799561111067423;
          else
            goto label_5;
        }
        else
          break;
      }
      return this.s681409368106643[index];
label_5:
      return (s034852122986107) null;
    }

    protected override unsafe void Dispose(bool disposing)
    {
      if (disposing)
        this.OnCompleted();
      else if ((IntPtr) this.s491213108549030 != IntPtr.Zero)
      {
        Marshal.FreeHGlobal((IntPtr) (void*) this.s491213108549030);
        this.s491213108549030 = (s726691949965431.s494209931687311*) null;
      }
      base.Dispose(disposing);
    }

    ~s726691949965431() => this.Dispose(false);

    private unsafe void s007025116966936()
    {
      int length = 256;
      if (this.s681409368106643 != null)
      {
        int num = this.s870427096639703() * 2;
        while (length < num)
          length *= 2;
      }
      this.s799561111067423 = length - 1;
      s726691949965431.s494209931687311* s491213108549030 = this.s491213108549030;
      s034852122986107[] s681409368106643 = this.s681409368106643;
      this.s681409368106643 = new s034852122986107[length];
      if (s681409368106643 != null && length != s681409368106643.Length)
      {
        Marshal.FreeHGlobal((IntPtr) (void*) this.s491213108549030);
        this.s491213108549030 = (s726691949965431.s494209931687311*) null;
      }
      if ((IntPtr) this.s491213108549030 == IntPtr.Zero)
        this.s491213108549030 = (s726691949965431.s494209931687311*) (void*) Marshal.AllocHGlobal(sizeof (s726691949965431.s494209931687311) * length);
      for (int index = 0; index < length; ++index)
        this.s491213108549030[index] = new s726691949965431.s494209931687311();
      this.s442283128869524 = 0;
      if (s681409368106643 == null)
        return;
      for (int index = 0; index < s681409368106643.Length; ++index)
      {
        if (s681409368106643[index] != null)
          this.s016467834900061(s681409368106643[index]);
      }
    }

    private unsafe void s016467834900061(s034852122986107 s222325883328375)
    {
      if (this.s442283128869524 * 4 > this.s681409368106643.Length * 3)
        this.s007025116966936();
      ushort num = (ushort) s222325883328375.s591345645465164;
      Guid guid = s222325883328375.s347486913357445;
      if (s222325883328375.s208437401079489)
      {
        guid = !(s222325883328375.s966949059091664 == Guid.Empty) ? s222325883328375.s966949059091664 : s726691949965431.s548348651940580(s222325883328375.s066186047870744, (ushort) s222325883328375.s837672983919971);
        if (!s222325883328375.s558741114055760)
          num = (ushort) s222325883328375.s770722554724548;
      }
      int* numPtr1 = (int*) &guid;
      int index = *numPtr1 + (int) num * 9 & this.s799561111067423;
      s726691949965431.s494209931687311* s494209931687311Ptr;
      while (true)
      {
        s494209931687311Ptr = this.s491213108549030 + index;
        // ISSUE: reference to a compiler-generated field
        int* numPtr2 = (int*) &((s126519166327702.s719728307875047*) s494209931687311Ptr)->s063180124712490;
        if (*numPtr2 != *numPtr1 || numPtr2[1] != numPtr1[1] || numPtr2[2] != numPtr1[2] || numPtr2[3] != numPtr1[3] || (int) s494209931687311Ptr->s358004993095096 != (int) num)
        {
          if (s494209931687311Ptr->s843146753814099)
            index = index + (int) num * 2 + 1 & this.s799561111067423;
          else
            goto label_18;
        }
        else
          break;
      }
      s034852122986107 s389534926872031 = this.s681409368106643[index];
      if (s389534926872031 != null)
      {
        if ((object) s222325883328375.s282757928832612 != null)
        {
          while (s389534926872031.s389534926872031 != null)
            s389534926872031 = s389534926872031.s389534926872031;
          s389534926872031.s389534926872031 = s222325883328375;
          return;
        }
        if ((object) s389534926872031.s282757928832612 == null)
          return;
        s222325883328375.s389534926872031 = s389534926872031;
        this.s681409368106643[index] = s222325883328375;
        return;
      }
      this.s681409368106643[index] = s222325883328375;
      return;
label_18:
      this.s681409368106643[index] = s222325883328375;
      s494209931687311Ptr->s358004993095096 = num;
      // ISSUE: reference to a compiler-generated field
      ((s126519166327702.s719728307875047*) s494209931687311Ptr)->s063180124712490 = guid;
      s494209931687311Ptr->s843146753814099 = true;
      ++this.s442283128869524;
    }

    private static Guid s548348651940580(Guid s180511860878309, ushort s617770572170538)
    {
      byte[] byteArray = s180511860878309.ToByteArray();
      byteArray[15] += (byte) s617770572170538;
      byteArray[14] += (byte) ((uint) s617770572170538 >> 8);
      return new Guid(byteArray);
    }

    internal IEnumerable<s034852122986107> s142668192617411
    {
      get
      {
        s726691949965431.s165223633190883 templates = (s726691949965431.s165223633190883) new s726691949965431.s543446947395565(-2);
        templates.s244586227976882 = this;
        return (IEnumerable<s034852122986107>) templates;
      }
    }

    internal virtual void s051223359345690(s034852122986107 s899397825609231)
    {
      if (this.s006184527445362 || s899397825609231.s591345645465164 == s076337548137908.Illegal)
      {
        s899397825609231.s208437401079489 = true;
        this.s016467834900061(s899397825609231);
      }
      else if (s899397825609231.s312333162110197)
      {
        s899397825609231.s208437401079489 = false;
        this.s016467834900061(s899397825609231);
      }
      else if (s899397825609231.s558741114055760)
      {
        s899397825609231.s208437401079489 = true;
        this.s016467834900061(s899397825609231);
      }
      else
      {
        s899397825609231.s208437401079489 = false;
        this.s016467834900061(s899397825609231);
        if (!(s899397825609231.s966949059091664 != Guid.Empty))
          return;
        s899397825609231 = s899397825609231.s994455335614443();
        s899397825609231.s208437401079489 = true;
        this.s016467834900061(s899397825609231);
      }
    }

    internal virtual unsafe void s272576140490229(
      Delegate s265449007367791,
      Guid s288952178406441,
      int s699547823588612)
    {
      if ((IntPtr) this.s491213108549030 == IntPtr.Zero)
        return;
      int* numPtr1 = (int*) &s288952178406441;
      int index = *numPtr1 + s699547823588612 * 9 & this.s799561111067423;
      while (true)
      {
        s726691949965431.s494209931687311* s494209931687311Ptr = this.s491213108549030 + index;
        // ISSUE: reference to a compiler-generated field
        int* numPtr2 = (int*) &((s126519166327702.s719728307875047*) s494209931687311Ptr)->s063180124712490;
        if (*numPtr2 != *numPtr1 || numPtr2[1] != numPtr1[1] || numPtr2[2] != numPtr1[2] || numPtr2[3] != numPtr1[3] || (int) s494209931687311Ptr->s358004993095096 != s699547823588612)
        {
          if (s494209931687311Ptr->s843146753814099)
            index = index + s699547823588612 * 2 + 1 & this.s799561111067423;
          else
            goto label_11;
        }
        else
          break;
      }
      s034852122986107 s389534926872031 = this.s681409368106643[index];
      s034852122986107 s034852122986107 = (s034852122986107) null;
      for (; s389534926872031 != null; s389534926872031 = s389534926872031.s389534926872031)
      {
        if (s389534926872031.s282757928832612 == s265449007367791)
        {
          if (s034852122986107 == null)
          {
            this.s681409368106643[index] = s389534926872031.s389534926872031;
            break;
          }
          s034852122986107.s389534926872031 = s389534926872031.s389534926872031;
          break;
        }
        s034852122986107 = s389534926872031;
      }
      return;
label_11:;
    }

    internal virtual void s368934302553781(s126519166327702 s668821071419934)
    {
    }

    internal virtual string s018120302785419(Guid s244697695444216)
    {
      s726691949965431.s307629243291830 s923405147430397;
      this.s578189129274655(s244697695444216, out s923405147430397);
      return s923405147430397.s782355104861374;
    }

    internal virtual string s054678988344402(Guid s687839732371081)
    {
      s726691949965431.s307629243291830 s923405147430397;
      this.s578189129274655(s687839732371081, out s923405147430397);
      return s923405147430397.s134089218542160;
    }

    private void s578189129274655(
      Guid s890089659343187,
      out s726691949965431.s307629243291830 s923405147430397)
    {
      s923405147430397.s134089218542160 = (string) null;
      // ISSUE: cast to a reference type
      // ISSUE: explicit reference operation
      (^(s726691949965431.s494209931687311&) ref s923405147430397).s782355104861374 = (string) null;
      if (this.s606973178084116 == null)
      {
        if (this.s681409368106643 == null)
          return;
        this.s606973178084116 = new Dictionary<Guid, s726691949965431.s307629243291830>();
        foreach (s034852122986107 s034852122986107 in this.s681409368106643)
        {
          if (s034852122986107 != null)
          {
            if (s034852122986107.s787104356789152 != null && s034852122986107.s347486913357445 != Guid.Empty && !this.s606973178084116.ContainsKey(s034852122986107.s347486913357445))
            {
              // ISSUE: object of a compiler-generated type is created
              this.s606973178084116[s034852122986107.s347486913357445] = (s726691949965431.s307629243291830) new s126519166327702.s719728307875047((string) null, s034852122986107.s787104356789152);
            }
            if (s034852122986107.s809245015719425 != null && s034852122986107.s966949059091664 != Guid.Empty)
            {
              // ISSUE: object of a compiler-generated type is created
              this.s606973178084116[s034852122986107.s966949059091664] = (s726691949965431.s307629243291830) new s126519166327702.s719728307875047(s034852122986107.s809245015719425, s034852122986107.s787104356789152);
            }
          }
        }
      }
      this.s606973178084116.TryGetValue(s890089659343187, out s923405147430397);
    }

    private struct s494209931687311
    {
      public ushort s358004993095096;
      public bool s843146753814099;
      public string s782355104861374;
    }

    private struct s307629243291830
    {
      public string s134089218542160;
      public Action<s034852122986107, Action<s034852122986107>> s834921858152769;

      public s307629243291830() => ((object) ref this).\u002Ector();
    }
  }
}
