// Decompiled with JetBrains decompiler
// Type: RemnantSaveManager.WindowsSave
// Assembly: RemnantSaveManager, Version=1.99.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 99FD4FCE-DABC-49CD-8C69-1190642E25EA
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-PSW.MSIL.Stealer.gen-f547f2ae856eb63739f9aa6faffc2eb509ff612c0bcc65decad782827b60ef46.exe

using System;
using System.Collections.Generic;
using System.IO;

namespace RemnantSaveManager
{
  internal class WindowsSave
  {
    private bool isValid;

    public string Container { get; set; }

    public string Profile { get; set; }

    public List<string> Worlds { get; set; }

    public bool Valid => this.isValid;

    public WindowsSave(string containerPath)
    {
      this.Worlds = new List<string>();
      this.Container = containerPath;
      string fullName = new FileInfo(containerPath).Directory.FullName;
      int sourceIndex1 = 136;
      byte[] sourceArray = File.ReadAllBytes(this.Container);
      byte[] numArray1 = new byte[16];
      Array.Copy((Array) sourceArray, sourceIndex1, (Array) numArray1, 0, 16);
      this.Profile = new Guid(numArray1).ToString().ToUpper().Replace("-", "");
      this.isValid = File.Exists(string.Format("{0}\\{1}", (object) fullName, (object) this.Profile));
      for (int sourceIndex2 = sourceIndex1 + 160; sourceIndex2 + 16 < sourceArray.Length; sourceIndex2 += 160)
      {
        byte[] numArray2 = new byte[16];
        Array.Copy((Array) sourceArray, sourceIndex2, (Array) numArray2, 0, 16);
        Guid guid = new Guid(numArray2);
        this.Worlds.Add(fullName + "\\" + guid.ToString().ToUpper().Replace("-", ""));
      }
    }
  }
}
