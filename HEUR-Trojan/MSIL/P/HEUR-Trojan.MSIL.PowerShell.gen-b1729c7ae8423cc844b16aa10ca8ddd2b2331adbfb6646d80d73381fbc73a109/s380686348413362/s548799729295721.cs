// Decompiled with JetBrains decompiler
// Type: s380686348413362.s548799729295721
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using s007469294275641;
using s015749000614488;
using s066940036373534;
using s135475674916972;
using s255385730527522;
using s269959955200983;
using s312730673522274;
using s403966973041535;
using s470426416304760;
using s484873489373082;
using s490910903555891;
using s502850562200070;
using s632451275922059;
using s755365636060389;
using s795803713624789;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;

namespace s380686348413362
{
  internal class s548799729295721 : s385953622281459, IDisposable
  {
    private static readonly Regex s404406980690258 = new Regex("align\\( *(\\d+) *\\)");
    private static readonly Regex s068329499055176 = new Regex("integer (\\{[^}]*\\}) (\\w+)");
    private static readonly Regex s331977362096510 = new Regex("((\\w+ +)+) *(\\w+)");
    private static readonly Regex s483452244124441 = new Regex("variant +< *(\\w+) *>");
    private static readonly Regex s919842542377200 = new Regex("enum +: +((\\w+ +)+) *");
    private static readonly Regex s337381787887880 = new Regex("(\\w+) += *(\\d+)( *... (\\d+))?");
    private static readonly Regex s156505995991640 = new Regex("^\\s*struct\\s(\\{|\\w+)");
    private static readonly Regex s958197545252616 = new Regex("floating_point +\\{");
    private Stream s856068909069363;

    public s548799729295721(string filename) => this.s856068909069363 = (Stream) File.OpenRead(filename);

    public s548799729295721(Stream stream) => this.s856068909069363 = stream;

    public virtual IEnumerable<s068141997465768> s023550326729045()
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s988814106847661.s568273305404794 s568273305404794 = new s988814106847661.s568273305404794(-2);
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s058044439926221) s568273305404794).s120246713710140 = this;
      return (IEnumerable<s068141997465768>) s568273305404794;
    }

    private s068141997465768 s566376641114961(
      string s032474252388741,
      int s531631946507461,
      out int s053010467190629)
    {
      s053010467190629 = -1;
      int num1 = s032474252388741.IndexOf('{', s531631946507461);
      if (num1 == -1)
        return (s068141997465768) null;
      int startIndex1 = s032474252388741.Substring(0, num1).LastIndexOf('\n') + 1;
      if (startIndex1 == 0)
        return (s068141997465768) null;
      s445657449161957 declaration = s445657449161957.Unknown;
      string[] strArray = s032474252388741.Substring(startIndex1, num1 - startIndex1).Trim().Split(' ');
      string s916436445344634 = strArray[0];
      string name1 = (string) null;
      // ISSUE: reference to a compiler-generated method
      switch (s436242968473850.s836626314656159(s916436445344634))
      {
        case 363073373:
          if (s916436445344634 == "clock")
          {
            declaration = s445657449161957.Clock;
            break;
          }
          break;
        case 1601138021:
          if (s916436445344634 == "stream")
          {
            declaration = s445657449161957.Stream;
            break;
          }
          break;
        case 2022607796:
          if (s916436445344634 == "env")
          {
            declaration = s445657449161957.Environment;
            break;
          }
          break;
        case 2168288686:
          if (s916436445344634 == "trace")
          {
            declaration = s445657449161957.Trace;
            break;
          }
          break;
        case 2462236192:
          if (s916436445344634 == "struct")
          {
            declaration = s445657449161957.Struct;
            name1 = strArray[1];
            break;
          }
          break;
        case 3054093999:
          if (s916436445344634 == "typealias")
          {
            int num2 = s548799729295721.s151789954442716(s032474252388741, num1) + 1;
            s409132033626256 bag = this.s372700379696023(s032474252388741, num1, num2);
            if (!(strArray[1] == "integer"))
              throw new IOException();
            s787831628642719 type = (s787831628642719) new s135353098559317(bag);
            int startIndex2 = s032474252388741.IndexOf(":=", num2) + 2;
            int num3 = startIndex2;
            do
              ;
            while (s032474252388741[++num3] != ';');
            string name2 = s032474252388741.Substring(startIndex2, num3 - startIndex2).Trim();
            s053010467190629 = num3 + 1;
            return new s068141997465768(s445657449161957.TypeAlias, type, name2, strArray[1]);
          }
          break;
        case 4264611999:
          if (s916436445344634 == "event")
          {
            declaration = s445657449161957.Event;
            break;
          }
          break;
      }
      int num4 = s548799729295721.s151789954442716(s032474252388741, num1);
      int num5 = num4;
      do
        ;
      while (s032474252388741[num5++] != ';');
      int num6 = s032474252388741.IndexOf(":=", num4);
      if (name1 == null && num6 != -1 && num6 < num5)
      {
        int startIndex3 = num6 + 2;
        name1 = s032474252388741.Substring(startIndex3, num5 - startIndex3 - 1).Trim();
      }
      s053010467190629 = num5;
      if (declaration == s445657449161957.Struct)
      {
        s409132033626256 bag = (s409132033626256) null;
        Match match = s548799729295721.s404406980690258.Match(s032474252388741, num4, s053010467190629 - num4);
        if (match.Success)
        {
          bag = new s409132033626256();
          bag.s922971940454923("align", match.Groups[1].ToString());
        }
        s358991154297770[] array = this.s175275848610469(s032474252388741, num1, num4).ToArray<s358991154297770>();
        return new s068141997465768(declaration, bag, array, name1, s032474252388741.Substring(s531631946507461, num5 - s531631946507461));
      }
      s409132033626256 bag1 = this.s372700379696023(s032474252388741, num1, num4);
      return new s068141997465768(declaration, bag1, name1, s032474252388741.Substring(s531631946507461, num5 - s531631946507461));
    }

    private IEnumerable<s358991154297770> s175275848610469(
      string s803204641643643,
      int s069562919938876,
      int s444251438580697)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s548799729295721.s058044439926221 s058044439926221 = new s548799729295721.s058044439926221(-2);
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s936578653000596) s058044439926221).s493744784976160 = this;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s936578653000596) s058044439926221).s836421489280775 = s803204641643643;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s936578653000596) s058044439926221).s357659862554028 = s069562919938876;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s936578653000596) s058044439926221).s040706583926972 = s444251438580697;
      return (IEnumerable<s358991154297770>) s058044439926221;
    }

    private s787831628642719 s263106310535810(
      string s580743370288483,
      int s871379767536601,
      out int s751393529318664)
    {
      return this.s182523384464538(s580743370288483.Substring(s871379767536601), out s751393529318664);
    }

    private s787831628642719 s182523384464538(
      string s827803578222166,
      out int s926881985847608)
    {
      Match match1;
      s787831628642719 s787831628642719;
      if ((match1 = s548799729295721.s068329499055176.Match(s827803578222166)).Success)
      {
        Group group = match1.Groups[1];
        s787831628642719 = (s787831628642719) new s135353098559317(this.s861649477121665(group.ToString()));
        s926881985847608 = group.Index + group.Length;
      }
      else
      {
        Match match2;
        if ((match2 = s548799729295721.s156505995991640.Match(s827803578222166)).Success)
        {
          Group group = match2.Groups[1];
          int num = !(group.ToString() != "{") ? group.Index : throw new InvalidOperationException();
          int s444251438580697 = s548799729295721.s151789954442716(s827803578222166, num);
          s787831628642719 = (s787831628642719) new s059513796120190((s409132033626256) null, this.s175275848610469(s827803578222166, num, s444251438580697).ToArray<s358991154297770>());
          s926881985847608 = s444251438580697 + 1;
        }
        else
        {
          Match match3;
          if ((match3 = s548799729295721.s958197545252616.Match(s827803578222166)).Success)
          {
            int num = match3.Index + match3.Length - 1;
            int s668394503059027 = s548799729295721.s151789954442716(s827803578222166, num);
            s787831628642719 = (s787831628642719) new s972564901697917(this.s372700379696023(s827803578222166, num, s668394503059027));
            s926881985847608 = s668394503059027 + 1;
          }
          else
          {
            Match match4;
            if ((match4 = s548799729295721.s483452244124441.Match(s827803578222166)).Success)
            {
              string switchName = match4.Groups[1].ToString();
              int num = s827803578222166.IndexOf('{');
              int s444251438580697 = s548799729295721.s151789954442716(s827803578222166, num);
              if (s444251438580697 == -1)
                throw new InvalidOperationException();
              s358991154297770[] array = this.s175275848610469(s827803578222166, num, s444251438580697).ToArray<s358991154297770>();
              s787831628642719 = (s787831628642719) new s827953194295002(switchName, array);
              s926881985847608 = s444251438580697 + 1;
            }
            else
            {
              Match match5;
              if ((match5 = s548799729295721.s331977362096510.Match(s827803578222166)).Success)
              {
                Group group = match5.Groups[1];
                string name = group.ToString().Trim();
                s787831628642719 = !(name == "string") ? (s787831628642719) new s672869936535593(name) : (s787831628642719) new s969063498234494();
                s926881985847608 = group.Index + group.Length;
              }
              else
              {
                Match match6;
                if ((match6 = s548799729295721.s919842542377200.Match(s827803578222166)).Success)
                {
                  string name = match6.Groups[1].ToString().Trim();
                  int s168804804077617 = s827803578222166.IndexOf('{');
                  int s615569797662152 = s548799729295721.s151789954442716(s827803578222166, s168804804077617);
                  if (s615569797662152 == -1)
                    throw new InvalidOperationException();
                  s365136082241365[] array = this.s923496439524723(s827803578222166, s168804804077617 + 1, s615569797662152).ToArray<s365136082241365>();
                  s787831628642719 = (s787831628642719) new s501910618784242((s787831628642719) new s672869936535593(name), array);
                  s926881985847608 = s615569797662152 + 1;
                }
                else
                {
                  s926881985847608 = 0;
                  return (s787831628642719) null;
                }
              }
            }
          }
        }
      }
      return s787831628642719;
    }

    private IEnumerable<s365136082241365> s923496439524723(
      string s501348185613625,
      int s199567529428033,
      int s615569797662152)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s548799729295721.s936578653000596 s936578653000596 = new s548799729295721.s936578653000596(-2);
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s777688386067386) s936578653000596).s876625284550289 = s501348185613625;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s777688386067386) s936578653000596).s340476087426178 = s199567529428033;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s777688386067386) s936578653000596).s348422842321665 = s615569797662152;
      return (IEnumerable<s365136082241365>) s936578653000596;
    }

    private s409132033626256 s861649477121665(string s673604124704349) => this.s372700379696023(s673604124704349, 0, s673604124704349.Length);

    private s409132033626256 s372700379696023(
      string s516905662219090,
      int s199192033620979,
      int s668394503059027)
    {
      s409132033626256 s409132033626256 = new s409132033626256();
      foreach (string s712726927388892 in s548799729295721.s265044723859121(s516905662219090, s199192033620979 + 1, s668394503059027))
      {
        string str = s548799729295721.s996864122193194(s712726927388892);
        int length = str.IndexOf('=');
        if (length > 0)
        {
          if (str[length - 1] == ':')
          {
            string s824952610657292 = str.Substring(0, length - 1).Trim();
            int num = str.IndexOf('{', length + 1);
            int s444251438580697 = s548799729295721.s151789954442716(str, num);
            if (s444251438580697 > s668394503059027 || s444251438580697 == -1)
            {
              string[] strArray = str.Substring(length + 1).Trim().Split(' ');
              s672869936535593 s488000575076052 = strArray.Length == 2 && !(strArray[0] != "struct") ? new s672869936535593(strArray[1]) : throw new InvalidOperationException();
              s409132033626256.s644268592061468(s824952610657292, (s787831628642719) s488000575076052);
            }
            else
            {
              s358991154297770[] array = this.s175275848610469(str, num, s444251438580697).ToArray<s358991154297770>();
              s409132033626256.s644268592061468(s824952610657292, (s787831628642719) new s059513796120190((s409132033626256) null, array));
            }
          }
          else
          {
            string s417294882978277 = str.Substring(0, length).Trim();
            string s762553839892865 = str.Substring(length + 1).Trim();
            if (s762553839892865.Length > 2 && s762553839892865[0] == '"' && s762553839892865[s762553839892865.Length - 1] == '"')
              s762553839892865 = s762553839892865.Substring(1, s762553839892865.Length - 2);
            s409132033626256.s922971940454923(s417294882978277, s762553839892865);
          }
        }
      }
      return s409132033626256;
    }

    private static string s996864122193194(string s712726927388892)
    {
      StringBuilder stringBuilder = (StringBuilder) null;
      int num1 = s712726927388892.IndexOf("/*");
      int startIndex = 0;
      while (num1 != -1)
      {
        int num2 = s712726927388892.IndexOf("*/", num1 + 2) + 2;
        if (num2 == -1)
          throw new BadImageFormatException();
        if (stringBuilder == null)
          stringBuilder = new StringBuilder(s712726927388892.Length);
        stringBuilder.Append(s712726927388892.Substring(startIndex, num1 - startIndex));
        startIndex = num2;
        num1 = s712726927388892.IndexOf("/*", startIndex);
        if (num1 == -1)
          stringBuilder.Append(s712726927388892.Substring(startIndex));
      }
      return stringBuilder != null ? stringBuilder.ToString() : s712726927388892;
    }

    public unsafe string s636254241517028()
    {
      byte[] buffer = new byte[Marshal.SizeOf(typeof (s548799729295721.s658511212229707))];
      byte[] numArray = (byte[]) null;
      StringBuilder stringBuilder = new StringBuilder();
      while (this.s856068909069363.Read(buffer, 0, buffer.Length) == buffer.Length)
      {
        s548799729295721.s658511212229707 s658511212229707;
        fixed (byte* numPtr = buffer)
          s658511212229707 = *(s548799729295721.s658511212229707*) numPtr;
        if (s658511212229707.s303047598750012 != 1976638807U)
          throw new IOException();
        int count1 = (int) s658511212229707.s472183969389247 / 8 - buffer.Length;
        if (numArray == null || numArray.Length < count1)
          numArray = new byte[count1];
        int count2 = this.s856068909069363.Read(numArray, 0, count1);
        if (count2 != 0)
        {
          int num = (int) s658511212229707.s773277208661959 / 8 - buffer.Length;
          if (num < count2)
            count2 = num;
          string str = Encoding.ASCII.GetString(numArray, 0, count2);
          stringBuilder.Append(str);
        }
        else
          break;
      }
      return stringBuilder.ToString();
    }

    private static int s151789954442716(string s803899153838102, int s168804804077617)
    {
      if (s168804804077617 == -1)
        return -1;
      int num = 1;
      int index = s168804804077617 + 1;
      while (num != 0)
      {
        char ch1 = s803899153838102[index++];
        if (ch1 == '"')
        {
          while (s803899153838102[index++] != '"')
            ch1 = s803899153838102[index + 1];
        }
        if (ch1 == '{')
          ++num;
        else if (ch1 == '}')
          --num;
        if (ch1 == '/' && s803899153838102[index] == '*')
        {
          char ch2 = s803899153838102[index++];
          do
            ;
          while (s803899153838102[index++] != '*' && s803899153838102[index] != '/');
        }
      }
      return index - 1;
    }

    private static IEnumerable<string> s265044723859121(
      string s652715507346455,
      int s015886834975775,
      int s549525242077629,
      char s176369962899632 = ';')
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s548799729295721.s777688386067386 s777688386067386 = new s548799729295721.s777688386067386(-2);
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s375526765548864) s777688386067386).s584548400470310 = s652715507346455;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s375526765548864) s777688386067386).s176338624515798 = s015886834975775;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s375526765548864) s777688386067386).s311297776571181 = s549525242077629;
      // ISSUE: reference to a compiler-generated field
      ((s548799729295721.s375526765548864) s777688386067386).s479071457243113 = s176369962899632;
      return (IEnumerable<string>) s777688386067386;
    }

    void IDisposable.s766221384191887() => this.s396437406501839(true);

    private void s396437406501839(bool s051620540435677)
    {
      if (!s051620540435677)
        return;
      this.s856068909069363.Dispose();
    }

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    private struct s658511212229707
    {
      public Guid s444598245791153;
      public uint s820980165476967;
      public uint s773277208661959;
      public uint s472183969389247;
      public byte s882747279562253;
      public byte s082824604591497;
      public byte s485850912034655;
      public byte s943429038245176;
      public byte s379059653174453;
      private int s386203092174930;
    }
  }
}
