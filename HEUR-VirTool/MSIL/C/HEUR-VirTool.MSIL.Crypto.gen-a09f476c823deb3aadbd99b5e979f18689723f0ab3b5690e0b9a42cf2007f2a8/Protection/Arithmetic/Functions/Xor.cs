// Decompiled with JetBrains decompiler
// Type: Aura.Protection.Arithmetic.Functions.Xor
// Assembly: Kudeta Crypter, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 16F9F4AC-EE0C-4DE1-A1E6-B297F2D4338B
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-VirTool.MSIL.Crypto.gen-a09f476c823deb3aadbd99b5e979f18689723f0ab3b5690e0b9a42cf2007f2a8.exe

using Aura.Protection.Arithmetic.Utils;
using dnlib.DotNet;
using dnlib.DotNet.Emit;

namespace Aura.Protection.Arithmetic.Functions
{
  public class Xor : iFunction
  {
    public override ArithmeticTypes ArithmeticTypes => ArithmeticTypes.Xor;

    public override ArithmeticVT Arithmetic(Instruction instruction, ModuleDef module)
    {
      Aura.Protection.Arithmetic.Generator.Generator generator = new Aura.Protection.Arithmetic.Generator.Generator();
      if (!ArithmeticUtils.CheckArithmetic(instruction))
        return (ArithmeticVT) null;
      ArithmeticEmulator arithmeticEmulator = new ArithmeticEmulator((double) instruction.GetLdcI4Value(), (double) generator.Next(), this.ArithmeticTypes);
      return new ArithmeticVT(new Value(arithmeticEmulator.GetValue(), arithmeticEmulator.GetY()), new Token(OpCodes.Xor), this.ArithmeticTypes);
    }
  }
}
