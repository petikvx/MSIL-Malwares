// Decompiled with JetBrains decompiler
// Type: xClient.Core.AForge.Video.DirectShow.FilterInfo
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;

namespace xClient.Core.AForge.Video.DirectShow
{
  public class FilterInfo : IComparable
  {
    public string Name { get; private set; }

    public string MonikerString { get; private set; }

    public FilterInfo(string monikerString)
    {
      this.MonikerString = monikerString;
      this.Name = this.GetName(monikerString);
    }

    internal FilterInfo(IMoniker moniker)
    {
      this.MonikerString = this.GetMonikerString(moniker);
      this.Name = this.GetName(moniker);
    }

    public int CompareTo(object value)
    {
      FilterInfo filterInfo = (FilterInfo) value;
      return filterInfo == null ? 1 : this.Name.CompareTo(filterInfo.Name);
    }

    public static object CreateFilter(string filterMoniker)
    {
      object ppvResult = (object) null;
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      int pchEaten = 0;
      if (瓛茳畴伕\uF4CC\u23A9驆拤像믡堅ኇ\u2151ꙋ\u2FE9魆\uEC5Fɜ位暟.\uFFFD\uFFFD俧쑀쥿얔뿯闕郍᥌䨿檅䓪扛娘눞킻왈\uE730嶶(0, out ppbc) == 0)
      {
        if (瓛茳畴伕\uF4CC\u23A9驆拤像믡堅ኇ\u2151ꙋ\u2FE9魆\uEC5Fɜ位暟.쎹ﷻ\uA7BC쨻\uF304푣늝\uF8F0뜦\u3008鬖虁\u297D첟ଯ鴙\uE695齞竭ժ(ppbc, filterMoniker, ref pchEaten, out ppmk) == 0)
        {
          Guid guid = typeof (퍁暱\uFFFD灂ˌ狨ݦ娪怺읕隬鬿謁ᧀ蕂䒿鴚㩤蝫錅).GUID;
          ppmk.BindToObject((IBindCtx) null, (IMoniker) null, ref guid, out ppvResult);
          Marshal.ReleaseComObject((object) ppmk);
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return ppvResult;
    }

    private string GetMonikerString(IMoniker moniker)
    {
      string ppszDisplayName;
      moniker.GetDisplayName((IBindCtx) null, (IMoniker) null, out ppszDisplayName);
      return ppszDisplayName;
    }

    private string GetName(IMoniker moniker)
    {
      object ppvObj = (object) null;
      try
      {
        Guid guid = typeof (窕\uFFFD\uE6F5ו儢ዎ\u32B3\uF269句巨\u2729\uF1EE鏯\uE5B0攋ₛ愐䌈鋼痁).GUID;
        moniker.BindToStorage((IBindCtx) null, (IMoniker) null, ref guid, out ppvObj);
        窕\uFFFD\uE6F5ו儢ዎ\u32B3\uF269句巨\u2729\uF1EE鏯\uE5B0攋ₛ愐䌈鋼痁 窕ו儢ዎ句巨鏯攋ₛ愐䌈鋼痁 = (窕\uFFFD\uE6F5ו儢ዎ\u32B3\uF269句巨\u2729\uF1EE鏯\uE5B0攋ₛ愐䌈鋼痁) ppvObj;
        object obj = (object) "";
        ref object local = ref obj;
        IntPtr zero = IntPtr.Zero;
        int errorCode = 窕ו儢ዎ句巨鏯攋ₛ愐䌈鋼痁.Read("FriendlyName", ref local, zero);
        if (errorCode != 0)
          Marshal.ThrowExceptionForHR(errorCode);
        string str = (string) obj;
        return str != null && str.Length >= 1 ? str : throw new ApplicationException();
      }
      catch (Exception ex)
      {
        return "";
      }
      finally
      {
        if (ppvObj != null)
          Marshal.ReleaseComObject(ppvObj);
      }
    }

    private string GetName(string monikerString)
    {
      IBindCtx ppbc = (IBindCtx) null;
      IMoniker ppmk = (IMoniker) null;
      string name = "";
      int pchEaten = 0;
      if (瓛茳畴伕\uF4CC\u23A9驆拤像믡堅ኇ\u2151ꙋ\u2FE9魆\uEC5Fɜ位暟.\uFFFD\uFFFD俧쑀쥿얔뿯闕郍᥌䨿檅䓪扛娘눞킻왈\uE730嶶(0, out ppbc) == 0)
      {
        if (瓛茳畴伕\uF4CC\u23A9驆拤像믡堅ኇ\u2151ꙋ\u2FE9魆\uEC5Fɜ位暟.쎹ﷻ\uA7BC쨻\uF304푣늝\uF8F0뜦\u3008鬖虁\u297D첟ଯ鴙\uE695齞竭ժ(ppbc, monikerString, ref pchEaten, out ppmk) == 0)
        {
          name = this.GetName(ppmk);
          Marshal.ReleaseComObject((object) ppmk);
          ppmk = (IMoniker) null;
        }
        Marshal.ReleaseComObject((object) ppbc);
      }
      return name;
    }
  }
}
