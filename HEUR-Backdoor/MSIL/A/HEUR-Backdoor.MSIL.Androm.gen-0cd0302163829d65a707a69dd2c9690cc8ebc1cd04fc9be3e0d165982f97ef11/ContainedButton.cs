// Decompiled with JetBrains decompiler
// Type: MaterialSurface.ContainedButton
// Assembly: WeakRefere, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 041EFFF7-CD1D-4ADB-B4E6-C9A894F6978D
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Backdoor.MSIL.Androm.gen-0cd0302163829d65a707a69dd2c9690cc8ebc1cd04fc9be3e0d165982f97ef11.exe

using System;
using System.ComponentModel;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Windows.Forms;

namespace MaterialSurface
{
  public class ContainedButton : MaterialButton
  {
    private int shadowDepth = 3;
    private int shadowOpacity = 50;
    private Color effectColor = Color.White;

    [Category("Appearance Material")]
    [Description("Ripple animation color.")]
    public new Color PrimaryColor
    {
      get => this.primaryColor;
      set
      {
        if (this.DesignMode && this.effectType != ET.Custom)
          return;
        this.primaryColor = value;
      }
    }

    [Category("Appearance Material")]
    [Description("Effect type on click.")]
    public ET EffectType
    {
      get => this.effectType;
      set
      {
        if (value == ET.Custom)
          return;
        this.effectType = value;
        this.defaultAniOpacity = 120;
        this.aniDec = 5;
        if (this.effectType == ET.Light)
          this.effectColor = Color.White;
        else if (this.effectType == ET.Dark)
        {
          this.effectColor = Color.DimGray;
          this.defaultAniOpacity = 180;
          this.aniDec = 6;
        }
        this.aniOpacity = this.defaultAniOpacity;
      }
    }

    [Category("Appearance Material")]
    [Description("The depth of shadow.")]
    public int ShawdowDepth
    {
      get => this.shadowDepth;
      set
      {
        if (value < 0 || value > 5)
          return;
        this.shadowDepth = value;
        this.Invalidate();
      }
    }

    [Category("Appearance Material")]
    [Description("Shadow opacity, yeah.")]
    public int ShawdowOpacity
    {
      get => this.shadowOpacity;
      set
      {
        if (value < 40 || value > 60)
          return;
        this.shadowOpacity = value;
        this.Invalidate();
      }
    }

    [Category("Appearance Material")]
    [Description("Heading icon (before text).")]
    public Image Icon
    {
      get => this.icon;
      set
      {
        this.icon = value;
        if (this.icon != null)
        {
          this.iconArea = new Rectangle((this.Width - 6) / 15 + 6, (this.Height - 8) / 6 + 6, this.Height / 2 + this.Height / 5 - 12, this.Height / 2 + this.Height / 5 - 12);
          this.drawArea.X = this.iconArea.X + this.iconArea.Height + 4;
          this.drawArea.Width = this.Width - (this.iconArea.X + this.iconArea.Height + 4);
        }
        else
        {
          this.drawArea.X = 0;
          this.drawArea.Width = this.Width;
        }
        this.Invalidate();
      }
    }

    public ContainedButton()
    {
      this.SetStyle(ControlStyles.UserPaint | ControlStyles.ResizeRedraw | ControlStyles.SupportsTransparentBackColor | ControlStyles.AllPaintingInWmPaint | ControlStyles.OptimizedDoubleBuffer, true);
      this.DoubleBuffered = true;
      this.Size = new Size(180, 50);
      this.ForeColor = Color.WhiteSmoke;
      this.Font = new Font("Segoe UI", 11f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.MouseState = MouseState.OUT;
      this.drawArea = new Rectangle(6, 6, this.Width - 12, this.Height - 12);
      this.maxSize = (float) (this.Width + 2);
      this.incSize = this.maxSize / 12f;
      this.animationDirector.Tick += new EventHandler(((MaterialButton) this).OnAnimate);
    }

    protected override void OnAnimate(object sender, EventArgs e)
    {
      if ((double) this.animationSize < (double) this.maxSize * 2.2)
      {
        this.aniOpacity -= this.aniDec;
        this.aniOpacity = this.aniOpacity < 0 ? 0 : this.aniOpacity;
        this.animationSize += this.incSize;
        this.Invalidate();
      }
      else
      {
        this.aniOpacity = this.defaultAniOpacity;
        this.animationSize = 0.0f;
        this.Invalidate();
        this.animationDirector.Stop();
        base.OnClick(this._eventArgs);
        base.OnMouseClick(this._mouseClickArgs);
      }
    }

    protected override void OnPaint(PaintEventArgs pevent)
    {
      base.OnPaint(pevent);
      Graphics graphics = pevent.Graphics;
      graphics.SmoothingMode = SmoothingMode.HighQuality;
      Region region = new Region();
      if (this.Parent is MaterialCard)
        graphics.Clear(((MaterialCard) this.Parent).CardColor);
      else
        graphics.Clear(this.Parent.BackColor);
      GraphicsPath roundedRectangle1;
      if (this.Enabled)
      {
        roundedRectangle1 = GraphicHelper.GetRoundedRectangle(6f, 6f, (float) (this.Width - 12), (float) (this.Height - 12), this.radius);
        region = new Region(roundedRectangle1);
        if (this.MouseState == MouseState.HOVER || this.Focused)
        {
          if (this.MouseState == MouseState.HOVER || this.MouseState == MouseState.OUT)
          {
            for (int index = 0; index < this.shadowDepth; ++index)
            {
              GraphicsPath roundedRectangle2 = GraphicHelper.GetRoundedRectangle((float) (6 - index), (float) (6 - index + 2), (float) (this.Width - 12 + index * 2), (float) (this.Height - 12 + index * 2), this.radius + 2);
              graphics.FillPath((Brush) new SolidBrush(Color.FromArgb(this.shadowOpacity + 10 - 5 * index, Color.Black)), roundedRectangle2);
            }
          }
          else
          {
            for (int index = 0; index < this.shadowDepth + 1; ++index)
            {
              GraphicsPath roundedRectangle3 = GraphicHelper.GetRoundedRectangle((float) (6 - index), (float) (6 - index + 2), (float) (this.Width - 12 + index * 2), (float) (this.Height - 12 + index * 2), this.radius + 2);
              graphics.FillPath((Brush) new SolidBrush(Color.FromArgb(this.shadowOpacity + 10 - 5 * index, Color.Black)), roundedRectangle3);
            }
          }
        }
        else
        {
          for (int index = 0; index < this.shadowDepth; ++index)
          {
            GraphicsPath roundedRectangle4 = GraphicHelper.GetRoundedRectangle((float) (6 - index), (float) (6 - index + 1), (float) (this.Width - 12 + index * 2), (float) (this.Height - 12 + index * 2), this.radius + 1);
            graphics.FillPath((Brush) new SolidBrush(Color.FromArgb(this.shadowOpacity - 5 * index, Color.Black)), roundedRectangle4);
          }
        }
        graphics.FillPath((Brush) new SolidBrush(this.primaryColor), roundedRectangle1);
        graphics.SetClip(region, CombineMode.Replace);
        graphics.SmoothingMode = SmoothingMode.HighSpeed;
        graphics.FillEllipse((Brush) new SolidBrush(Color.FromArgb(this.aniOpacity, this.effectColor)), (float) this.mouseX - this.animationSize / 2f, (float) this.mouseY - this.animationSize / 2f, this.animationSize, this.animationSize);
        graphics.SmoothingMode = SmoothingMode.AntiAlias;
        if (this.MouseState == MouseState.HOVER || this.Focused && this.Enabled)
          graphics.FillPath((Brush) new SolidBrush(Color.FromArgb(Convert.ToInt32(Math.Round((double) this.defaultAniOpacity * 0.3, 0)), this.effectColor)), roundedRectangle1);
      }
      else
      {
        roundedRectangle1 = GraphicHelper.GetRoundedRectangle(6f, 6f, (float) (this.Width - 12), (float) (this.Height - 12), this.radius);
        graphics.FillPath((Brush) new SolidBrush(Color.FromArgb(95, Color.Gray)), roundedRectangle1);
      }
      graphics.SmoothingMode = SmoothingMode.HighQuality;
      if (this.icon != null)
        graphics.DrawImage(this.icon, this.iconArea);
      if (this.Enabled)
        graphics.DrawString(this.Text, this.Font, (Brush) new SolidBrush(this.ForeColor), (RectangleF) this.drawArea, this.textAlignment);
      else
        graphics.DrawString(this.Text, this.Font, (Brush) new SolidBrush(Color.FromArgb(125, Color.Gray)), (RectangleF) this.drawArea, this.textAlignment);
      roundedRectangle1.Dispose();
      region.Dispose();
    }

    protected override void OnClick(EventArgs e)
    {
      if (this.isPerformClick)
      {
        this.isPerformClick = false;
        base.OnClick(e);
      }
      else
      {
        this._eventArgs = e;
        if (e == EventArgs.Empty)
        {
          this.aniOpacity = this.defaultAniOpacity - 20;
          this.mouseX = this.Width / 2;
          this.mouseY = this.Height / 2;
          this.animationSize = this.incSize * 2f;
          this.animationDirector.Start();
        }
      }
      this.Focus();
    }

    protected override void OnMouseClick(MouseEventArgs e)
    {
      this.aniOpacity = this.defaultAniOpacity - 20;
      this.mouseX = e.X;
      this.mouseY = e.Y;
      this.animationSize = this.incSize * 2f;
      this.animationDirector.Start();
      this._mouseClickArgs = e;
    }

    protected override void OnMouseEnter(EventArgs e)
    {
      base.OnMouseEnter(e);
      this.MouseState = MouseState.HOVER;
      this.Invalidate();
    }

    protected override void OnSizeChanged(EventArgs e)
    {
      base.OnSizeChanged(e);
      if (this.Width > this.Height)
        this.maxSize = (float) (this.Width + 2);
      else
        this.maxSize = (float) (this.Height + 2);
      this.incSize = this.maxSize / 12f;
      this.drawArea = new Rectangle(6, 6, this.Width - 12, this.Height - 12);
      if (this.icon != null)
      {
        this.iconArea = new Rectangle((this.Width - 6) / 15 + 6, (this.Height - 6) / 6 + 6, this.Height / 2 + this.Height / 5 - 12, this.Height / 2 + this.Height / 5 - 12);
        this.drawArea.X += this.iconArea.X + this.iconArea.Height + 4;
        this.drawArea.Width -= this.iconArea.X + this.iconArea.Height + 4;
      }
      this.Invalidate();
    }
  }
}
