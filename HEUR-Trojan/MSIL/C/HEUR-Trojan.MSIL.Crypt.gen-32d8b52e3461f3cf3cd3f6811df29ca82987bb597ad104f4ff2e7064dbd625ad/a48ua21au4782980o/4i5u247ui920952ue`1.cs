// Decompiled with JetBrains decompiler
// Type: a48ua21au4782980o.4i5u247ui920952ue
// Assembly: e52a71747iaa0aa11, Version=2.1.0.0, Culture=neutral, PublicKeyToken=cac503e1823ce71c
// MVID: 0D894068-CF68-44D1-88F9-023D8A694267
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.06\HEUR-Trojan.MSIL.Crypt.gen-32d8b52e3461f3cf3cd3f6811df29ca82987bb597ad104f4ff2e7064dbd625ad.exe

using \u00351e0114u604i7879o;
using \u00396u54o009o2511uie;
using System;
using System.Buffers;

namespace a48ua21au4782980o
{
  public class \u0034i5u247ui920952ue<T> : IBufferWriter<T>
  {
    private const int \u00329181u3415a568ia0 = 4092;
    private readonly IBufferWriter<T> \u0035014i073e86o77513;
    private readonly int \u0037aee2eea994ue4968;
    private readonly int e6i4o509au3a191aa;
    private readonly MemoryPool<T> u65763u8iu0359a80;
    private \u00383o1ao6a3o902a986<T> \u0037i821ou206ai6647o;
    private Memory<T> o1ai2ai7929u81uua;
    private Memory<T> e1a50712a5597e2o3;
    private int \u003466aa8i6636o967i7;
    private bool \u00378829698i76a1u9eo;

    public long \u003965608uai15u50o2e
    {
      get
      {
        \u00383o1ao6a3o902a986<T> excessSequence = this.excessSequence;
        return (excessSequence != null ? excessSequence.\u0031u999u6u35ea6i757 : 0L) + (long) this.advanced;
      }
    }

    public Memory<T> \u003914273e8350a58i84
    {
      get
      {
        this.EnsureInitialized(0);
        return this.prefixMemory;
      }
    }

    public void \u00349i6855a8848583ue(int _param1)
    {
      if (this.usingExcessMemory)
      {
        this.excessSequence.Advance(_param1);
        this.realMemory = new Memory<T>();
      }
      else
      {
        this.realMemory = this.realMemory.Slice(_param1);
        this.advanced += _param1;
      }
    }

    public Memory<T> \u0035450u6262a066oi51(int _param1 = 0)
    {
      this.EnsureInitialized(_param1);
      return this.realMemory;
    }

    public Span<T> \u0038219i608oaiiu1404(int _param1 = 0)
    {
      this.EnsureInitialized(_param1);
      return this.realMemory.Span;
    }

    public void \u0037ii5e3o7ii8675u0o()
    {
      if (this.prefixMemory.Length == 0)
      {
        BuffersExtensions.Write<T>(this.innerWriter, Span<T>.op_Implicit(this.\u003914273e8350a58i84.Span));
      }
      else
      {
        this.innerWriter.Advance(this.prefixMemory.Length + this.advanced);
        if (this.usingExcessMemory)
        {
          Span<T> span = this.innerWriter.GetSpan((int) this.excessSequence.\u0031u999u6u35ea6i757);
          foreach (ReadOnlyMemory<T> readOnlyMemory in this.excessSequence.\u00375ioi381887e70e48)
          {
            readOnlyMemory.Span.CopyTo(span);
            span = span.Slice(readOnlyMemory.Length);
          }
          this.innerWriter.Advance((int) this.excessSequence.\u0031u999u6u35ea6i757);
          this.excessSequence.Reset();
        }
      }
      this.usingExcessMemory = false;
      this.prefixMemory = new Memory<T>();
      this.realMemory = new Memory<T>();
      this.advanced = 0;
    }

    private void \u003228i3e00e81i54327(int _param1)
    {
      if (this.prefixMemory.Length == 0)
      {
        Memory<T> memory = this.innerWriter.GetMemory(this.expectedPrefixSize + Math.Max(_param1, this.payloadSizeHint == 0 ? 4092 : this.payloadSizeHint));
        this.prefixMemory = memory.Slice(0, this.expectedPrefixSize);
        this.realMemory = memory.Slice(this.expectedPrefixSize);
      }
      else
      {
        if (this.realMemory.Length != 0 && this.realMemory.Length - this.advanced >= _param1)
          return;
        if (this.excessSequence == null)
          this.excessSequence = new \u00383o1ao6a3o902a986<T>(this.memoryPool);
        this.usingExcessMemory = true;
        this.realMemory = this.excessSequence.GetMemory(_param1);
      }
    }

    public \u0034i5u247ui920952ue(ReadOnlySequence<byte> readOnlySequence)
      : this()
    {
      ((\u0037772054i8a074i766) this).\u0038oooe9a6ii6280403 = readOnlySequence;
      ((\u0037772054i8a074i766) this).oi4ooooaa90168385 = readOnlySequence.Start;
    }
  }
}
