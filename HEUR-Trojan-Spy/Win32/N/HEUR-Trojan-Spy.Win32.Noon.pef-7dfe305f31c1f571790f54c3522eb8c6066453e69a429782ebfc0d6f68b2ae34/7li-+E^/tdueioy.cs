// Decompiled with JetBrains decompiler
// Type: 7li-+E^.tdueioy
// Assembly: ;8w1LFr, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 2CC07ADF-5A94-44BC-9C37-07435DAD286F
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan-Spy.Win32.Noon.pef-7dfe305f31c1f571790f54c3522eb8c6066453e69a429782ebfc0d6f68b2ae34.exe

using \u002A\u005ET\u003AdQS;
using \u003B8w1LFr;
using System;
using System.Text;

namespace \u0037li\u002D\u002BE\u005E
{
  internal class tdueioy
  {
    private readonly Encoding DIZ9ohL;
    private readonly byte[] Y\u002Fh\u002Bbjr;
    private int m\u002B\u002F\u002Bhx\u0024;
    private int zv\u0023voR\u002A;
    public const string y\u005EFb\u0023\u003F5 = "Not enough data.";
    public const string O\u005Ez6hG_ = "Data too long.";
    public const string \u002Arl\u0024c\u002Ac = "Invalid data.";

    public int Sk\u002AUmMX => this.m\u002B\u002F\u002Bhx\u0024;

    public int \u004031FDFe => this.zv\u0023voR\u002A;

    public tdueioy(byte[] buffer, int offset, int count, Encoding encoding)
    {
      this.Y\u002Fh\u002Bbjr = buffer;
      this.m\u002B\u002F\u002Bhx\u0024 = offset;
      this.zv\u0023voR\u002A = count;
      this.DIZ9ohL = encoding;
    }

    public byte leU\u002D\u0040L\u007E()
    {
      if (this.zv\u0023voR\u002A == 0)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?&4s2\u001D1@ \u00197.K", "WAP7kr4oRqHlPkgM3fwOJ"));
      byte num = this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024];
      ++this.m\u002B\u002F\u002Bhx\u0024;
      --this.zv\u0023voR\u002A;
      return num;
    }

    public bool N\u0029eo\u002Fwp() => this.leU\u002D\u0040L\u007E() > (byte) 0;

    public uint aAOyB\u003A\u0026()
    {
      if (this.zv\u0023voR\u002A < 4)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?&4s2\u001D1@ \u00197.K", "WAP7kr4oRqHlPkgM3fwOJ"));
      uint num = (uint) ((int) this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024] * 16777216 + (int) this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024 + 1] * 65536 + (int) this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024 + 2] * 256) + (uint) this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024 + 3];
      this.m\u002B\u002F\u002Bhx\u0024 += 4;
      this.zv\u0023voR\u002A -= 4;
      return num;
    }

    public long CHqUC\u003AO() => (long) (((ulong) this.aAOyB\u003A\u0026() << 32) + (ulong) this.aAOyB\u003A\u0026());

    public byte[] i\u002F8S\u002DNw(int _param1)
    {
      byte[] destinationArray = this.zv\u0023voR\u002A >= _param1 ? new byte[_param1] : throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?&4s2\u001D1@ \u00197.K", "WAP7kr4oRqHlPkgM3fwOJ"));
      Array.Copy((Array) this.Y\u002Fh\u002Bbjr, this.m\u002B\u002F\u002Bhx\u0024, (Array) destinationArray, 0, _param1);
      this.m\u002B\u002F\u002Bhx\u0024 += _param1;
      this.zv\u0023voR\u002A -= _param1;
      return destinationArray;
    }

    public byte[] Ei\u002B5\u0021wC(bool _param1)
    {
      uint num = this.aAOyB\u003A\u0026();
      if (num > (uint) ushort.MaxValue)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(";\b\f~c.s(Z5\u000F*\u001Fm", "WAP7kr4oRqHlPkgM3fwOJ"));
      if ((long) this.zv\u0023voR\u002A < (long) num)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?&4s2\u001D1@ \u00197.K", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (num == 0U)
        return new byte[0];
      if (!_param1)
        return this.i\u002F8S\u002DNw((int) num);
      if (this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024] >= (byte) 128)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("6\a\u000E~/3xg\u001E8\u0014%V", "WAP7kr4oRqHlPkgM3fwOJ"));
      if (this.Y\u002Fh\u002Bbjr[this.m\u002B\u002F\u002Bhx\u0024] == (byte) 0)
      {
        --num;
        ++this.m\u002B\u002F\u002Bhx\u0024;
        --this.zv\u0023voR\u002A;
      }
      return this.i\u002F8S\u002DNw((int) num);
    }

    public byte[] jIF\u002B9k9()
    {
      uint num = this.aAOyB\u003A\u0026();
      if (num > 65536U)
        throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x(";\b\f~c.s(Z5\u000F*\u001Fm", "WAP7kr4oRqHlPkgM3fwOJ"));
      return (long) this.zv\u0023voR\u002A >= (long) num ? this.i\u002F8S\u002DNw((int) num) : throw new InvalidOperationException(sgxPeiI.LiHKl\u0027x("1\u0006\f?&4s2\u001D1@ \u00197.K", "WAP7kr4oRqHlPkgM3fwOJ"));
    }

    public string \u002A\u005Esp\u0024OS()
    {
      byte[] bytes = this.jIF\u002B9k9();
      string str = this.DIZ9ohL.GetString(bytes, 0, bytes.Length);
      StringBuilder stringBuilder = new StringBuilder();
      for (int index = 0; index < str.Length; ++index)
      {
        char ch = str[index];
        if (ch < ' ')
        {
          switch (ch)
          {
            case '\t':
            case '\n':
            case '\r':
              break;
            default:
              continue;
          }
        }
        stringBuilder.Append(ch);
      }
      return stringBuilder.ToString();
    }

    public string[] m\u0021Wkk6J() => this.\u002A\u005Esp\u0024OS().Split(',');

    public byte[] \u007Ehe\u002AbN\u007E() => this.i\u002F8S\u002DNw(this.zv\u0023voR\u002A);

    public tdueioy(Encoding encoding)
      : this()
    {
      ((L\u002AV\u002Blbk) this).E_\u003AJt7\u0025 = encoding;
    }
  }
}
