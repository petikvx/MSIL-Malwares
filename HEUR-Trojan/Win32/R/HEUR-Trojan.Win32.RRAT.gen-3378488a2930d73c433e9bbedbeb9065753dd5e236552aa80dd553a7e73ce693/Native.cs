// Decompiled with JetBrains decompiler
// Type: Native
// Assembly: NoahClient, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A55B7EB4-612C-4348-ADA6-5D647EA578AF
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan.Win32.RRAT.gen-3378488a2930d73c433e9bbedbeb9065753dd5e236552aa80dd553a7e73ce693.exe

using System;
using System.Runtime.InteropServices;
using System.Text;

public static class Native
{
  [DllImport("kernel32", EntryPoint = "GetVolumeInformationA", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern int GVI(
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string IP,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string V,
    int T,
    ref int H,
    ref int Q,
    ref int G,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string J,
    int X);

  [DllImport("user32", EntryPoint = "GetForegroundWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr GFW();

  [DllImport("user32", CharSet = CharSet.Auto, SetLastError = true)]
  public static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int cch);

  [DllImport("avicap32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern bool capGetDriverDescriptionA(
    short wDriver,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszName,
    int cbName,
    [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszVer,
    int cbVer);

  [DllImport("kernel32.dll", SetLastError = true)]
  public static extern PreventSleep.EXECUTION_STATE SetThreadExecutionState(
    PreventSleep.EXECUTION_STATE esFlags);
}
