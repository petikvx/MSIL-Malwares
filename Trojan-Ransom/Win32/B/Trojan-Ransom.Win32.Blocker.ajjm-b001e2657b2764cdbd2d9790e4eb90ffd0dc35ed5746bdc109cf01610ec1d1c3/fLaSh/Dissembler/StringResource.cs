// Decompiled with JetBrains decompiler
// Type: fLaSh.Dissembler.StringResource
// Assembly: Pass, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: B2D05123-D1EE-4E11-B4EC-79932D637F25
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Blocker.ajjm-b001e2657b2764cdbd2d9790e4eb90ffd0dc35ed5746bdc109cf01610ec1d1c3.exe

using In2aXkPRwyNprNdGJT;
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;

namespace fLaSh.Dissembler
{
  public class StringResource
  {
    private Kernel32.RESOURCE_HEADER vsydKU6dC;
    private string i4FWdX54E;
    private string vY0FaP79p;

    public Kernel32.RESOURCE_HEADER Header
    {
      [MethodImpl(MethodImplOptions.NoInlining)] get => this.vsydKU6dC;
    }

    public string Key
    {
      [MethodImpl(MethodImplOptions.NoInlining)] get => this.i4FWdX54E;
    }

    public string StringValue
    {
      [MethodImpl(MethodImplOptions.NoInlining)] get => this.vY0FaP79p == null ? (string) null : this.vY0FaP79p.Trim("\0".ToCharArray());
    }

    public string Value
    {
      [MethodImpl(MethodImplOptions.NoInlining)] get => this.vY0FaP79p;
      [MethodImpl(MethodImplOptions.NoInlining)] set => this.vY0FaP79p = value;
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public StringResource(string key)
    {
      rbdjPoeaA1BgLlupgC.XYjXOJ9ztPdU4();
      // ISSUE: explicit constructor call
      base.\u002Ector();
      this.i4FWdX54E = key;
      this.vsydKU6dC.wType = (ushort) 1;
      this.vsydKU6dC.wLength = (ushort) 0;
      this.vsydKU6dC.wValueLength = (ushort) 0;
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public StringResource(IntPtr lpRes)
    {
      rbdjPoeaA1BgLlupgC.XYjXOJ9ztPdU4();
      // ISSUE: explicit constructor call
      base.\u002Ector();
      this.Read(lpRes);
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public void Read(IntPtr lpRes)
    {
      this.vsydKU6dC = (Kernel32.RESOURCE_HEADER) Marshal.PtrToStructure(lpRes, typeof (Kernel32.RESOURCE_HEADER));
      IntPtr ptr1 = new IntPtr(lpRes.ToInt32() + Marshal.SizeOf((object) this.vsydKU6dC));
      this.i4FWdX54E = Marshal.PtrToStringUni(ptr1);
      IntPtr ptr2 = ResourceUtil.Align(ptr1.ToInt32() + (this.i4FWdX54E.Length + 1) * 2);
      this.vY0FaP79p = this.vsydKU6dC.wValueLength > (ushort) 0 ? Marshal.PtrToStringUni(ptr2, (int) this.vsydKU6dC.wValueLength) : (string) null;
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public void Write(BinaryWriter w)
    {
      long position1 = w.BaseStream.Position;
      w.Write(this.vsydKU6dC.wLength);
      w.Write(this.vsydKU6dC.wValueLength);
      w.Write(this.vsydKU6dC.wType);
      w.Write(Encoding.Unicode.GetBytes(this.i4FWdX54E));
      w.Write((ushort) 0);
      ResourceUtil.PadToDWORD(w);
      long position2 = w.BaseStream.Position;
      if (this.vY0FaP79p != null)
        w.Write(Encoding.Unicode.GetBytes(this.vY0FaP79p));
      ResourceUtil.WriteAt(w, (w.BaseStream.Position - position2) / 2L, position1 + 2L);
      ResourceUtil.PadToDWORD(w);
      ResourceUtil.WriteAt(w, w.BaseStream.Position - position1, position1);
    }
  }
}
