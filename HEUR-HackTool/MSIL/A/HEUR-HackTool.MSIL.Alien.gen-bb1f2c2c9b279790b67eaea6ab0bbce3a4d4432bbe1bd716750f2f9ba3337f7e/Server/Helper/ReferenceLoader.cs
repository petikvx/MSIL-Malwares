// Decompiled with JetBrains decompiler
// Type: Server.Helper.ReferenceLoader
// Assembly: AsyncRAT, Version=0.5.7.0, Culture=neutral, PublicKeyToken=null
// MVID: 51786A10-CF9D-455B-B8A4-B82CB9EDE322
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-bb1f2c2c9b279790b67eaea6ab0bbce3a4d4432bbe1bd716750f2f9ba3337f7e.exe

using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Reflection;
using System.Security.Policy;

namespace Server.Helper
{
  public class ReferenceLoader : MarshalByRefObject
  {
    public string[] LoadReferences(string assemblyPath)
    {
      try
      {
        return ((IEnumerable<AssemblyName>) Assembly.ReflectionOnlyLoadFrom(assemblyPath).GetReferencedAssemblies()).Select<AssemblyName, string>((Func<AssemblyName, string>) (x => x.FullName)).ToArray<string>();
      }
      catch
      {
        return (string[]) null;
      }
    }

    public void AppDomainSetup(string assemblyPath)
    {
      try
      {
        System.AppDomainSetup info = new System.AppDomainSetup()
        {
          ApplicationBase = AppDomain.CurrentDomain.BaseDirectory
        };
        AppDomain domain = AppDomain.CreateDomain(Guid.NewGuid().ToString(), (Evidence) null, info);
        ((ReferenceLoader) Activator.CreateInstance(domain, typeof (ReferenceLoader).Assembly.FullName, typeof (ReferenceLoader).FullName, false, BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic, (Binder) null, (object[]) null, CultureInfo.CurrentCulture, new object[0]).Unwrap()).LoadReferences(assemblyPath);
        AppDomain.Unload(domain);
      }
      catch
      {
      }
    }
  }
}
