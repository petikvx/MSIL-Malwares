// Decompiled with JetBrains decompiler
// Type: TagMp3Saito_WindowsFormsApplication.FrmSetColumns
// Assembly: ManualResetEv, Version=0.7.2.0, Culture=neutral, PublicKeyToken=null
// MVID: 555BB952-8DEA-4CDE-87A4-0E642B4B65E6
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Backdoor.MSIL.Androm.gen-1e9b14262f935e7f822b39afe45842ceac9c584e70a3b520d8f391d975d600ee.exe

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Windows.Forms;
using TagMp3Saito;

namespace TagMp3Saito_WindowsFormsApplication
{
  public class FrmSetColumns : Form
  {
    private IContainer components = (IContainer) null;
    private CheckedListBox checkedListBoxColumns;
    private Button btnHelp;

    public FrmSetColumns() => this.InitializeComponent();

    private void FrmSetColumns_Load(object sender, EventArgs e)
    {
      this.CheckCreateConfigFile();
      this.LoadList();
    }

    private void CheckCreateConfigFile(string path = null)
    {
      if (path == null)
        path = Mp3FieldsHelper.GetDefaultPath();
      if (File.Exists(path))
        return;
      Mp3FieldsHelper.SaveJSON(MusicCsv.GetDefaultMp3Fields());
    }

    private void checkedListBoxColumns_KeyDown(object sender, KeyEventArgs e)
    {
      if (!e.Control && !e.Alt && !e.Shift)
        return;
      object selectedItem = this.checkedListBoxColumns.SelectedItem;
      if (selectedItem == null)
        return;
      bool flag = this.checkedListBoxColumns.CheckedItems.Contains(selectedItem);
      int num = this.checkedListBoxColumns.Items.IndexOf(selectedItem);
      int count = this.checkedListBoxColumns.Items.Count;
      int? nullable = new int?();
      if (e.KeyCode == Keys.Down)
      {
        nullable = num != count - 1 ? new int?(num + 1) : new int?(0);
        e.Handled = true;
      }
      if (e.KeyCode == Keys.Up)
      {
        nullable = num != 0 ? new int?(num - 1) : new int?(count - 1);
        e.Handled = true;
      }
      if (nullable.HasValue)
      {
        this.checkedListBoxColumns.Items.Remove(selectedItem);
        this.checkedListBoxColumns.Items.Insert(nullable.Value, selectedItem);
        this.checkedListBoxColumns.SetSelected(nullable.Value, true);
        this.checkedListBoxColumns.SetItemChecked(nullable.Value, flag);
      }
    }

    private void btnHelp_Click(object sender, EventArgs e)
    {
      int num = (int) MessageBox.Show("Ctrl + Up: move item up\r\nCtrl + Down: move item down", "Help", MessageBoxButtons.OK, MessageBoxIcon.Question);
    }

    private void FrmSetColumns_FormClosing(object sender, FormClosingEventArgs e) => Mp3FieldsHelper.SaveJSON(this.GetMp3FieldsFromcheckedListaBox(this.checkedListBoxColumns));

    private List<Mp3Field> GetMp3FieldsFromcheckedListaBox(CheckedListBox checkedListBox) => checkedListBox.Items.Cast<object>().Select<object, Mp3Field>((Func<object, Mp3Field>) (item => item as Mp3Field)).ToList<Mp3Field>();

    private void LoadList(string path = null)
    {
      this.checkedListBoxColumns.Items.Clear();
      foreach (Mp3Field mp3Field in Mp3FieldsHelper.GetMp3FieldsFromJSON(path))
        this.checkedListBoxColumns.Items.Add((object) mp3Field, mp3Field.Active);
    }

    private void checkedListBoxColumns_ItemCheck(object sender, ItemCheckEventArgs e) => (this.checkedListBoxColumns.Items[e.Index] as Mp3Field).Active = e.NewValue == CheckState.Checked;

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.checkedListBoxColumns = new CheckedListBox();
      this.btnHelp = new Button();
      this.SuspendLayout();
      this.checkedListBoxColumns.Anchor = AnchorStyles.Top | AnchorStyles.Bottom | AnchorStyles.Left | AnchorStyles.Right;
      this.checkedListBoxColumns.FormattingEnabled = true;
      this.checkedListBoxColumns.Location = new Point(12, 17);
      this.checkedListBoxColumns.Name = "checkedListBoxColumns";
      this.checkedListBoxColumns.Size = new Size(390, 424);
      this.checkedListBoxColumns.TabIndex = 2;
      this.checkedListBoxColumns.ItemCheck += new ItemCheckEventHandler(this.checkedListBoxColumns_ItemCheck);
      this.checkedListBoxColumns.KeyDown += new KeyEventHandler(this.checkedListBoxColumns_KeyDown);
      this.btnHelp.Anchor = AnchorStyles.Bottom | AnchorStyles.Right;
      this.btnHelp.Font = new Font("Arial", 8.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 177);
      this.btnHelp.Location = new Point(344, 442);
      this.btnHelp.Name = "btnHelp";
      this.btnHelp.Size = new Size(58, 21);
      this.btnHelp.TabIndex = 3;
      this.btnHelp.Text = "help - ?";
      this.btnHelp.UseVisualStyleBackColor = true;
      this.btnHelp.Click += new EventHandler(this.btnHelp_Click);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(416, 464);
      this.Controls.Add((Control) this.btnHelp);
      this.Controls.Add((Control) this.checkedListBoxColumns);
      this.MinimumSize = new Size(432, 502);
      this.Name = nameof (FrmSetColumns);
      this.StartPosition = FormStartPosition.CenterParent;
      this.Text = "Columns";
      this.FormClosing += new FormClosingEventHandler(this.FrmSetColumns_FormClosing);
      this.Load += new EventHandler(this.FrmSetColumns_Load);
      this.ResumeLayout(false);
    }
  }
}
