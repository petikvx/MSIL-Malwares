// Decompiled with JetBrains decompiler
// Type: VenomRAT_HVNC.Server.Helper.Methods
// Assembly: VenomRAT_HVNC, Version=5.0.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 364FC72B-4DB8-403E-BB7F-732199A12380
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-HackTool.MSIL.Alien.gen-666d190a7059c03b3572dd66e51b8232537a8650bbdcbfbe3f8335c830f3aeae.exe

using System;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace VenomRAT_HVNC.Server.Helper
{
  public static class Methods
  {
    private const string Alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    public static Random Random = new Random();
    private const int LVM_FIRST = 4096;
    private const int LVM_SETITEMSTATE = 4139;
    private const int WM_VSCROLL = 277;
    private static readonly IntPtr SB_PAGEBOTTOM = new IntPtr(7);

    public static string BytesToString(long byteCount)
    {
      string[] strArray = new string[7]
      {
        "B",
        "KB",
        "MB",
        "GB",
        "TB",
        "PB",
        "EB"
      };
      if (byteCount == 0L)
        return "0" + strArray[0];
      long a = Math.Abs(byteCount);
      int int32 = Convert.ToInt32(Math.Floor(Math.Log((double) a, 1024.0)));
      double num = Math.Round((double) a / Math.Pow(1024.0, (double) int32), 1);
      return ((double) Math.Sign(byteCount) * num).ToString() + strArray[int32];
    }

    public static async Task FadeIn(Form o, int interval = 80)
    {
      for (; o.Opacity < 1.0; o.Opacity += 0.05)
        await Task.Delay(interval);
    }

    public static double DiffSeconds(DateTime startTime, DateTime endTime) => Math.Abs(new TimeSpan(endTime.Ticks - startTime.Ticks).TotalSeconds);

    public static string GetRandomString(int length)
    {
      StringBuilder stringBuilder = new StringBuilder(length);
      for (int index = 0; index < length; ++index)
        stringBuilder.Append("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Methods.Random.Next("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".Length)]);
      return stringBuilder.ToString();
    }

    public static int MakeWin32Long(short wLow, short wHigh) => (int) wLow << 16 | (int) wHigh;

    public static void SetItemState(IntPtr handle, int itemIndex, int mask, int value)
    {
      NativeMethods.LVITEM lParam = new NativeMethods.LVITEM()
      {
        stateMask = mask,
        state = value
      };
      NativeMethods.SendMessageListViewItem(handle, 4139U, new IntPtr(itemIndex), ref lParam);
    }

    public static void ScrollToBottom(IntPtr handle) => NativeMethods.SendMessage(handle, 277U, Methods.SB_PAGEBOTTOM, IntPtr.Zero);
  }
}
