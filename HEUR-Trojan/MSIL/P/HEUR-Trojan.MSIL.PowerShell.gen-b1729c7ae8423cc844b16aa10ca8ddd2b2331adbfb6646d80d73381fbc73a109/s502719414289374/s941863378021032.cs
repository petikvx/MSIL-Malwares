// Decompiled with JetBrains decompiler
// Type: s502719414289374.s941863378021032
// Assembly: s968508024776124, Version=2.0.47.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: E3596912-35E7-405B-A05A-F5F12AB5E292
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.04\HEUR-Trojan.MSIL.PowerShell.gen-b1729c7ae8423cc844b16aa10ca8ddd2b2331adbfb6646d80d73381fbc73a109.exe

using FastSerialization;
using s094083356292532;
using s354939329968896;
using s502762629278250;
using s528813736053581;
using s555751328692804;
using s587197687005387;
using s627321409542780;
using s679889277206639;
using s713328882406766;
using s736322905406258;
using s814626784262558;
using s866758743033523;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;

namespace s502719414289374
{
  public sealed class s941863378021032 : 
    IEnumerable<s431378815911435>,
    IEnumerable,
    IFastSerializable
  {
    internal static readonly Func<ulong, s431378815911435, int> s515589130469011 = new Func<ulong, s431378815911435, int>(s941863378021032.s627592622011291.s783056214033868.s794736663814614);
    private s572171018010254 s882646607968592;
    private GrowableArray<s431378815911435> s544621668356862;

    public s572171018010254 s524772309831973 => this.s882646607968592;

    public s431378815911435 s535927197514056(
      ulong s910021498237643,
      double s084998949154304)
    {
      return this.s594175817526730(s910021498237643, this.s882646607968592.s349566078049337.s339143429282736(s084998949154304), out int _);
    }

    public s431378815911435 s469621282960074(
      string s414815964154069,
      double s135785939708510)
    {
      long num = this.s882646607968592.s349566078049337.s339143429282736(s135785939708510);
      for (int index = 0; index < this.s544621668356862.Count; ++index)
      {
        s431378815911435 s431378815911435 = this.s544621668356862[index];
        if (string.Compare(s431378815911435.s746302328367815, s414815964154069, StringComparison.OrdinalIgnoreCase) == 0 && s431378815911435.s561833547862090 <= num && num < s431378815911435.s415612365267078)
          return s431378815911435;
      }
      return (s431378815911435) null;
    }

    public virtual string s658945362486585()
    {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.Append("<s941863378021032 Count=").Append(s471684335504367.s639751879214616(this.s544621668356862.Count)).AppendLine(">");
      using (IEnumerator<s431378815911435> enumerator = this.s042553584346059())
      {
        while (enumerator.MoveNext())
        {
          s431378815911435 current = enumerator.Current;
          stringBuilder.Append("  ").Append(current.ToString()).AppendLine();
        }
      }
      stringBuilder.AppendLine("</s941863378021032>");
      return stringBuilder.ToString();
    }

    public IEnumerator<s431378815911435> s042553584346059()
    {
      // ISSUE: object of a compiler-generated type is created
      // ISSUE: variable of a compiler-generated type
      s353225494468418.s040190462268062 s040190462268062 = new s353225494468418.s040190462268062(0);
      // ISSUE: reference to a compiler-generated field
      ((s941863378021032.s523748569560216) s040190462268062).s114882510131451 = this;
      return (IEnumerator<s431378815911435>) s040190462268062;
    }

    internal s431378815911435 s199830254534833(
      string s778744390579794,
      long s568758381397885)
    {
      for (int index = 0; index < this.s544621668356862.Count; ++index)
      {
        s431378815911435 s431378815911435 = this.s544621668356862[index];
        if (string.Compare(s431378815911435.s746302328367815, s778744390579794, StringComparison.OrdinalIgnoreCase) == 0 && s431378815911435.s561833547862090 <= s568758381397885 && s568758381397885 < s431378815911435.s415612365267078)
          return s431378815911435;
      }
      return (s431378815911435) null;
    }

    internal s045113750567070 s614570081951275(
      s498194338000187 s073120034325027,
      bool s032388335546959,
      string s247294850819549 = null)
    {
      if (s247294850819549 == null)
        s247294850819549 = s073120034325027.s625755965888663;
      int s052847274482321;
      s431378815911435 s123422196894519 = this.s594175817526730(s073120034325027.s074803911345324, s073120034325027.s218856315967206, out s052847274482321);
      if (s123422196894519 == null)
      {
        s045113750567070 moduleFile = this.s882646607968592.s349566078049337.s427569464106482.s782226978208181(s247294850819549, s073120034325027.s074803911345324);
        moduleFile.s970512300528315 = s073120034325027.s668593236485430;
        s123422196894519 = new s431378815911435(this.s882646607968592, moduleFile, s073120034325027.s074803911345324);
        this.s119826529895191(s052847274482321 + 1, s123422196894519);
      }
      if (!this.s882646607968592.s822930018651373 && s073120034325027.s074803911345324 >= 4294967296UL && !s247294850819549.EndsWith("ntdll.dll", StringComparison.OrdinalIgnoreCase))
        this.s882646607968592.s822930018651373 = true;
      this.s882646607968592.s921486656584021 = true;
      s045113750567070 s500842533606289 = s123422196894519.s500842533606289;
      if (!s032388335546959 && s123422196894519.s500842533606289.s369986943707552.Length < s247294850819549.Length)
      {
        this.s882646607968592.s349566078049337.s639100242681190(false, "Needed to fix up a truncated load file path at unload time.", (s034852122986107) s073120034325027);
        s123422196894519.s500842533606289.s650966121452686 = s247294850819549;
      }
      int length = Math.Max(Math.Min(s123422196894519.s500842533606289.s369986943707552.Length - 4, s247294850819549.Length - 4), 0);
      int indexA = s123422196894519.s500842533606289.s369986943707552.Length - length;
      int indexB = s247294850819549.Length - length;
      this.s882646607968592.s349566078049337.s639100242681190(string.Compare(s123422196894519.s500842533606289.s369986943707552, indexA, s247294850819549, indexB, length, StringComparison.OrdinalIgnoreCase) == 0, "Filename Load/Unload mismatch.\r\n    FILE1: " + s123422196894519.s500842533606289.s369986943707552, (s034852122986107) s073120034325027);
      this.s882646607968592.s349566078049337.s639100242681190(s123422196894519.s500842533606289.s606517787478562 == 0 || s123422196894519.s500842533606289.s606517787478562 == s073120034325027.s668593236485430, "ImageSize not consistent over all Loads Size 0x" + s123422196894519.s500842533606289.s606517787478562.ToString("x"), (s034852122986107) s073120034325027);
      s500842533606289.s970512300528315 = s073120034325027.s668593236485430;
      if (s032388335546959)
      {
        this.s882646607968592.s349566078049337.s639100242681190(s123422196894519.s561833547862090 == 0L || s073120034325027.s770722554724548 == s531105564102108.DataCollectionStart, "Events for module happened before load.  PrevEventTime: " + s123422196894519.s188204605499777.ToString("f4"), (s034852122986107) s073120034325027);
        this.s882646607968592.s349566078049337.s639100242681190(s073120034325027.s218856315967206 < s123422196894519.s415612365267078, "Unload time < load time!", (s034852122986107) s073120034325027);
        s123422196894519.s561833547862090 = s073120034325027.s218856315967206;
        if (s073120034325027.s770722554724548 == s531105564102108.DataCollectionStart)
          s123422196894519.s561833547862090 = this.s882646607968592.s349566078049337.s432147997440474;
      }
      else
      {
        // ISSUE: object of a compiler-generated type is created
        // ISSUE: variable of a compiler-generated type
        s941863378021032.s627592622011291 s627592622011291 = (s941863378021032.s627592622011291) new s941863378021032.s523748569560216();
        this.s882646607968592.s349566078049337.s639100242681190(s123422196894519.s561833547862090 < s073120034325027.s218856315967206, "Unload time < load time!", (s034852122986107) s073120034325027);
        this.s882646607968592.s349566078049337.s639100242681190(s123422196894519.s415612365267078 == long.MaxValue, "Unloading a image twice PrevUnloadTime: " + s123422196894519.s464859536707546.ToString("f4"), (s034852122986107) s073120034325027);
        if (s073120034325027.s770722554724548 == s531105564102108.DataCollectionStop)
        {
          if (this.s524772309831973.s503519833641966.Length == 0 && s247294850819549.EndsWith(".exe", StringComparison.OrdinalIgnoreCase))
            this.s524772309831973.s503519833641966 = s247294850819549;
        }
        else
          s123422196894519.s415612365267078 = s073120034325027.s218856315967206;
        // ISSUE: reference to a compiler-generated field
        ((s941863378021032.s523748569560216) s627592622011291).s668827397911197 = s123422196894519.s500842533606289.s286262124234738;
        // ISSUE: method pointer
        // ISSUE: object of a compiler-generated type is created
        this.s524772309831973.s349566078049337.s517247949554964.s212380666293052(this.s882646607968592, s073120034325027.s074803911345324, s073120034325027.s668593236485430, false, (s875958956371404.s763329264221943) new s604695337689154.s208706968736051((object) s627592622011291, __methodptr(s112680809875915)));
      }
      return s500842533606289;
    }

    internal void s046853527908648(
      s729342687901186 s065804819415335,
      bool s307227211426881,
      bool s018985159792653)
    {
      string str = s065804819415335.s367743152460067;
      string s778744390579794 = s065804819415335.s763198779974216;
      Guid s007719446291015 = s065804819415335.s007719446291015;
      if (str == s778744390579794)
      {
        int length = str.LastIndexOf(".ni.", str.Length, 8, StringComparison.OrdinalIgnoreCase);
        if (0 <= length)
          str = str.Substring(0, length) + str.Substring(length + 3);
      }
      else if (s778744390579794.Length == 0 && s007719446291015 != Guid.Empty && s065804819415335.s624273238965745 != Guid.Empty)
      {
        int num = str.LastIndexOf(".", StringComparison.OrdinalIgnoreCase);
        if (0 < num)
        {
          s778744390579794 = str;
          str = str.Substring(0, num) + ".il" + str.Substring(num);
        }
      }
      int s003085291376290;
      s999988868482030 s999988868482030 = this.s584753998250131(s065804819415335.s985365826672308, s065804819415335.s218856315967206, out s003085291376290);
      if (s999988868482030 == null)
      {
        s999988868482030 = new s999988868482030(this.s882646607968592, this.s882646607968592.s349566078049337.s427569464106482.s782226978208181(str, 0UL), s065804819415335.s985365826672308);
        this.s544621668356862.Insert(s003085291376290 + 1, (s431378815911435) s999988868482030);
      }
      this.s882646607968592.s349566078049337.s639100242681190(s999988868482030.s263338982355829 == 0L || s999988868482030.s263338982355829 == s065804819415335.s157869774087882, "Inconsistent Assembly ID previous ID = 0x" + s999988868482030.s263338982355829.ToString("x"), (s034852122986107) s065804819415335);
      s999988868482030.s263338982355829 = s065804819415335.s157869774087882;
      s999988868482030.s805414962704675 = s065804819415335.s601009275589135;
      if (s778744390579794.Length > 0)
        s999988868482030.s567777898087265 = this.s199830254534833(s778744390579794, s065804819415335.s218856315967206);
      if (s999988868482030.s500842533606289.s650966121452686 == null)
        this.s882646607968592.s349566078049337.s427569464106482.s864688506828227(s999988868482030.s500842533606289, str);
      if (s999988868482030.s500842533606289.s944708081697500 == Guid.Empty && s065804819415335.s624273238965745 != Guid.Empty)
      {
        s999988868482030.s500842533606289.s944708081697500 = s065804819415335.s624273238965745;
        s999988868482030.s500842533606289.s948220395762391 = s065804819415335.s801600718411879;
        s999988868482030.s500842533606289.s111303706149690 = s065804819415335.s023817186038744;
      }
      if (s999988868482030.s507716176570280 != null)
      {
        s999988868482030.s507716176570280.s500842533606289.s592220283837699 = s999988868482030.s500842533606289;
        if (s007719446291015 != Guid.Empty && s999988868482030.s507716176570280.s500842533606289.s944708081697500 == Guid.Empty)
        {
          s999988868482030.s507716176570280.s500842533606289.s944708081697500 = s007719446291015;
          s999988868482030.s507716176570280.s500842533606289.s948220395762391 = s065804819415335.s885068100414027;
          s999988868482030.s507716176570280.s500842533606289.s111303706149690 = s065804819415335.s170163593540771;
        }
      }
      if (s307227211426881)
      {
        this.s882646607968592.s349566078049337.s639100242681190(s999988868482030.s561833547862090 == 0L || s065804819415335.s770722554724548 == s531105564102108.DataCollectionStart, "Events for module happened before load.  PrevEventTime: " + s999988868482030.s188204605499777.ToString("f4"), (s034852122986107) s065804819415335);
        this.s882646607968592.s349566078049337.s639100242681190(s065804819415335.s218856315967206 < s999988868482030.s415612365267078, "Managed Unload time < load time!", (s034852122986107) s065804819415335);
        s999988868482030.s561833547862090 = s065804819415335.s218856315967206;
        if (s018985159792653)
          return;
        s999988868482030.s561833547862090 = this.s882646607968592.s349566078049337.s432147997440474;
      }
      else
      {
        this.s882646607968592.s349566078049337.s639100242681190(s999988868482030.s561833547862090 < s065804819415335.s218856315967206, "Managed Unload time < load time!", (s034852122986107) s065804819415335);
        this.s882646607968592.s349566078049337.s639100242681190(s999988868482030.s415612365267078 == long.MaxValue, "Unloading a managed image twice PrevUnloadTime: " + s999988868482030.s464859536707546.ToString("f4"), (s034852122986107) s065804819415335);
        if (s018985159792653)
          return;
        s999988868482030.s415612365267078 = s065804819415335.s218856315967206;
      }
    }

    internal s999988868482030 s580333133374708(
      long s525682477228029,
      long s994056736507557)
    {
      int s003085291376290;
      s999988868482030 s999988868482030 = this.s584753998250131(s525682477228029, s994056736507557, out s003085291376290);
      if (s999988868482030 == null)
      {
        s999988868482030 = new s999988868482030(this.s882646607968592, this.s882646607968592.s349566078049337.s427569464106482.s782226978208181((string) null, 0UL), s525682477228029);
        this.s544621668356862.Insert(s003085291376290 + 1, (s431378815911435) s999988868482030);
      }
      return s999988868482030;
    }

    private s999988868482030 s584753998250131(
      long s959030543323568,
      long s157731562584482,
      out int s003085291376290)
    {
      this.s544621668356862.BinarySearch<ulong>((ulong) s959030543323568, ref s003085291376290, s941863378021032.s515589130469011);
      while (s003085291376290 >= 0)
      {
        s431378815911435 s431378815911435 = this.s544621668356862[s003085291376290];
        if (s431378815911435.s595829976852340 >= (ulong) s959030543323568 && s431378815911435 is s999988868482030 s999988868482030 && s157731562584482 < s431378815911435.s415612365267078)
        {
          if (s431378815911435.s561833547862090 <= s157731562584482)
            return s999988868482030;
          --s003085291376290;
        }
        else
          break;
      }
      return (s999988868482030) null;
    }

    internal s431378815911435 s594175817526730(
      ulong s528778957769922,
      long s117777391433940,
      out int s052847274482321)
    {
      this.s544621668356862.BinarySearch<ulong>(s528778957769922, ref s052847274482321, s941863378021032.s515589130469011);
      for (int index = s052847274482321; index >= 0; --index)
      {
        s431378815911435 s431378815911435 = this.s544621668356862[index];
        if ((long) s431378815911435.s595829976852340 == (long) s431378815911435.s047007760161899)
        {
          ulong num = s431378815911435.s047007760161899 + (ulong) (uint) s431378815911435.s500842533606289.s606517787478562;
          if (s528778957769922 < num)
          {
            if (s431378815911435.s047007760161899 <= s528778957769922 && s431378815911435.s561833547862090 <= s117777391433940 && s117777391433940 <= s431378815911435.s415612365267078)
            {
              s052847274482321 = index;
              return s431378815911435;
            }
          }
          else if (!s431378815911435.s600902980624977)
            break;
        }
      }
      return (s431378815911435) null;
    }

    private void s119826529895191(int s789340126192088, s431378815911435 s123422196894519)
    {
      this.s544621668356862.Insert(s789340126192088, s123422196894519);
      if (s789340126192088 > 0)
      {
        s431378815911435 s431378815911435 = this.s544621668356862[s789340126192088 - 1];
        if (s431378815911435.s047007760161899 + (ulong) (uint) s431378815911435.s500842533606289.s606517787478562 > s123422196894519.s047007760161899)
        {
          s431378815911435.s600902980624977 = true;
          s123422196894519.s600902980624977 = true;
        }
      }
      if (s789340126192088 + 1 >= this.s544621668356862.Count)
        return;
      s431378815911435 s431378815911435_1 = this.s544621668356862[s789340126192088 + 1];
      if (s123422196894519.s047007760161899 + (ulong) (uint) s123422196894519.s500842533606289.s606517787478562 <= s431378815911435_1.s047007760161899)
        return;
      s431378815911435_1.s600902980624977 = true;
      s123422196894519.s600902980624977 = true;
    }

    [Conditional("DEBUG")]
    private void s362955266301305()
    {
      ulong num = 0;
      s431378815911435 s431378815911435_1 = (s431378815911435) null;
      for (int index = 0; index < this.s544621668356862.Count; ++index)
      {
        s431378815911435 s431378815911435_2 = this.s544621668356862[index];
        s999988868482030 s999988868482030 = s431378815911435_2 as s999988868482030;
        num = s431378815911435_2.s595829976852340;
        s431378815911435_1 = s431378815911435_2;
      }
    }

    internal s941863378021032(s572171018010254 process) => this.s882646607968592 = process;

    void IFastSerializable.s564934900845268(Serializer s113285762565006)
    {
      s113285762565006.Write((IFastSerializable) this.s882646607968592);
      s113285762565006.Write(this.s544621668356862.Count);
      for (int index = 0; index < this.s544621668356862.Count; ++index)
        s113285762565006.Write((IFastSerializable) this.s544621668356862[index]);
    }

    void IFastSerializable.s416143886538716(Deserializer s036346609544407)
    {
      s036346609544407.Read<s572171018010254>(ref this.s882646607968592);
      int num;
      s036346609544407.Read(ref num);
      for (int index = 0; index < num; ++index)
      {
        s431378815911435 s431378815911435;
        s036346609544407.Read<s431378815911435>(ref s431378815911435);
        this.s544621668356862.Add(s431378815911435);
      }
    }

    IEnumerator IEnumerable.s526545539424621() => throw new NotImplementedException();
  }
}
