// Decompiled with JetBrains decompiler
// Type: Microsoft.Tools.RegAsm.ExporterCallback
// Assembly: RegAsm, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 097EDB82-DB75-4D42-81B4-3BEFAFAFEBC0
// Assembly location: C:\Users\Administrateur\Desktop\Virusshare-00005-msil\Virus.Win32.Sality.q-052b60d6a15faafc5f2db590d83230c23f3f890cbf1c8075e3c07e9f1a58e29c.exe

using System.IO;
using System.Reflection;
using System.Runtime.InteropServices;

namespace Microsoft.Tools.RegAsm
{
  internal class ExporterCallback : ITypeLibExporterNotifySink
  {
    public void ReportEvent(ExporterEventKind EventKind, int EventCode, string EventMsg)
    {
      if (EventKind == ExporterEventKind.NOTIF_TYPECONVERTED)
      {
        if (!RegCode.s_Options.m_bVerboseMode)
          return;
        Output.WriteInfo(EventMsg);
      }
      else
        Output.WriteInfo(EventMsg);
    }

    public object ResolveRef(Assembly asm)
    {
      string directoryName = Path.GetDirectoryName(asm.Location);
      string name = asm.GetName().Name;
      string str = Path.Combine(directoryName, name) + ".tlb";
      if (RegCode.s_Options.m_bVerboseMode)
        Output.WriteInfo(Resource.FormatString("Msg_AutoExpAndRegAssembly", (object) name, (object) str));
      return (object) RegCode.DoExportAndRegister(asm, str);
    }
  }
}
