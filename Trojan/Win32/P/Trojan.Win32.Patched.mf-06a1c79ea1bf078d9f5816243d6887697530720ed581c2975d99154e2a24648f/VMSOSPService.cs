// Decompiled with JetBrains decompiler
// Type: VMS.OSService.VMSOSPService
// Assembly: VMS.OSP.Service, Version=1.4.2.0, Culture=neutral, PublicKeyToken=null
// MVID: 7B29B897-26BF-407B-B0D0-14253383A174
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.Win32.Patched.mf-06a1c79ea1bf078d9f5816243d6887697530720ed581c2975d99154e2a24648f.exe

using System;
using System.ComponentModel;
using System.ServiceProcess;
using VMS.OSService.Concrete;

namespace VMS.OSService
{
  public class VMSOSPService : ServiceBase
  {
    private Container components;
    private ConcreteServicesSetup _services;

    public VMSOSPService()
    {
      this.InitializeComponent();
      this.ServiceName = "Varian OSP Service";
      this.CanPauseAndContinue = false;
      this.CanShutdown = false;
      this.CanStop = true;
      this.CanHandlePowerEvent = false;
      this.AutoLog = false;
      this._services = new ConcreteServicesSetup(this.EventLog);
    }

    private void InitializeComponent()
    {
      this.components = new Container();
      this.ServiceName = "Varian OSP Service";
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    protected override void OnStart(string[] args)
    {
      this._services.StartAll(args);
      try
      {
        this.EventLog.WriteEntry(string.Format("{0} started.", (object) "Varian OSP Service"));
      }
      catch (Exception ex)
      {
      }
    }

    protected override void OnStop()
    {
      this._services.StopAll();
      try
      {
        this.EventLog.WriteEntry(string.Format("{0} stopped.", (object) "Varian OSP Service"));
      }
      catch (Exception ex)
      {
      }
    }

    protected override void OnCustomCommand(int command) => this._services.CustomCommandToAll(command);
  }
}
