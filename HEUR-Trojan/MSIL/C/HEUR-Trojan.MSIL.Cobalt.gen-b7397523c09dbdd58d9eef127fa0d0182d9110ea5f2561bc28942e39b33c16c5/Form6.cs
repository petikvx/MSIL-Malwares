// Decompiled with JetBrains decompiler
// Type: WindowsFormsApplication2.Form6
// Assembly: WindowsFormsApplication2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FE9A6395-9CA7-468B-A6A3-13D09A57D63A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Cobalt.gen-b7397523c09dbdd58d9eef127fa0d0182d9110ea5f2561bc28942e39b33c16c5.exe

using System;
using System.ComponentModel;
using System.Data;
using System.Data.OleDb;
using System.Drawing;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace WindowsFormsApplication2
{
  public class Form6 : Form
  {
    public string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + Application.StartupPath + "/POS.accdb";
    public string OldTax = "";
    private OleDbDataAdapter da;
    private BindingSource bindingSource = (BindingSource) null;
    private OleDbCommandBuilder oleCommandBuilder = (OleDbCommandBuilder) null;
    private DataTable dataTable = new DataTable();
    private IContainer components = (IContainer) null;
    private DataGridView dataGridView1;
    private Button button1;
    private PrintDocument printDocument1;
    private TextBox CName;
    private ComboBox prname;
    private Label label1;
    private Label label8;
    private CheckBox active;

    public Form6() => this.InitializeComponent();

    private void DataRecordBind(string strSQL)
    {
      this.dataGridView1.DataSource = (object) null;
      this.dataTable.Clear();
      OleDbConnection selectConnection = new OleDbConnection(this.connectionString);
      selectConnection.Open();
      selectConnection.CreateCommand().CommandText = strSQL;
      try
      {
        this.da = new OleDbDataAdapter(strSQL, selectConnection);
        this.oleCommandBuilder = new OleDbCommandBuilder(this.da);
        this.da.Fill(this.dataTable);
        this.bindingSource = new BindingSource()
        {
          DataSource = (object) this.dataTable
        };
        this.dataGridView1.DataSource = (object) this.bindingSource;
      }
      catch (Exception ex)
      {
        int num = (int) MessageBox.Show(ex.ToString(), "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
      }
      selectConnection.Close();
    }

    private void ComboItemsShow(string tablename, ComboBox cb)
    {
      string cmdText = "Select Address from " + tablename;
      cb.Items.Clear();
      using (OleDbConnection connection = new OleDbConnection(this.connectionString))
      {
        OleDbCommand oleDbCommand = new OleDbCommand(cmdText, connection);
        try
        {
          connection.Open();
          using (OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader())
          {
            while (oleDbDataReader.Read())
              cb.Items.Add((object) oleDbDataReader[0].ToString());
          }
          connection.Close();
        }
        catch (Exception ex)
        {
          int num = (int) MessageBox.Show(ex.Message);
        }
      }
    }

    private void Form6_Load(object sender, EventArgs e)
    {
      this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent");
      this.ComboItemsShow("Place", this.prname);
    }

    private void button1_Click(object sender, EventArgs e) => this.printDocument1.Print();

    private void printDocument1_PrintPage(object sender, PrintPageEventArgs e)
    {
      Bitmap bitmap = new Bitmap(this.dataGridView1.Width, this.dataGridView1.Height);
      this.dataGridView1.DrawToBitmap(bitmap, new Rectangle(0, 0, this.dataGridView1.Width, this.dataGridView1.Height));
      e.Graphics.DrawImage((Image) bitmap, 0, 0);
    }

    private void CName_TextChanged(object sender, EventArgs e) => this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where CustomerName like'" + this.CName.Text + "%'");

    private void prname_SelectedValueChanged(object sender, EventArgs e)
    {
      if (!this.active.Checked)
        this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where Address ='" + this.prname.SelectedItem.ToString() + "'");
      else
        this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where Address ='" + this.prname.SelectedItem.ToString() + "' and Status = 1");
    }

    private void active_CheckedChanged(object sender, EventArgs e)
    {
      if (this.prname.SelectedItem != null)
      {
        if (!this.active.Checked)
          this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where Address ='" + this.prname.SelectedItem.ToString() + "'");
        else
          this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where Address ='" + this.prname.SelectedItem.ToString() + "' and Status = 1");
      }
      else if (!this.active.Checked)
        this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent");
      else
        this.DataRecordBind("select CustomerName,Phone,Address, Type, FromDate, ToDate, RentDate,Cust_Place.Rent,Advance,PreviousAmount, Status from Cust_Place_Rent where Status = 1");
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.dataGridView1 = new DataGridView();
      this.button1 = new Button();
      this.printDocument1 = new PrintDocument();
      this.CName = new TextBox();
      this.prname = new ComboBox();
      this.label1 = new Label();
      this.label8 = new Label();
      this.active = new CheckBox();
      ((ISupportInitialize) this.dataGridView1).BeginInit();
      this.SuspendLayout();
      this.dataGridView1.Anchor = AnchorStyles.Top | AnchorStyles.Bottom | AnchorStyles.Left | AnchorStyles.Right;
      this.dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill;
      this.dataGridView1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells;
      this.dataGridView1.BorderStyle = BorderStyle.Fixed3D;
      this.dataGridView1.Location = new Point(12, 67);
      this.dataGridView1.Name = "dataGridView1";
      this.dataGridView1.Size = new Size(1038, 523);
      this.dataGridView1.TabIndex = 75;
      this.button1.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.button1.Location = new Point(889, 592);
      this.button1.Name = "button1";
      this.button1.Size = new Size(161, 36);
      this.button1.TabIndex = 76;
      this.button1.Text = "Print";
      this.button1.UseVisualStyleBackColor = true;
      this.button1.Click += new EventHandler(this.button1_Click);
      this.printDocument1.PrintPage += new PrintPageEventHandler(this.printDocument1_PrintPage);
      this.CName.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.CName.Location = new Point(102, 12);
      this.CName.MaxLength = 10000;
      this.CName.Name = "CName";
      this.CName.Size = new Size(337, 26);
      this.CName.TabIndex = 80;
      this.CName.TextChanged += new EventHandler(this.CName_TextChanged);
      this.prname.Font = new Font("Microsoft Sans Serif", 11.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.prname.FormattingEnabled = true;
      this.prname.Location = new Point(578, 13);
      this.prname.Name = "prname";
      this.prname.Size = new Size(450, 26);
      this.prname.TabIndex = 77;
      this.prname.SelectedValueChanged += new EventHandler(this.prname_SelectedValueChanged);
      this.label1.AutoSize = true;
      this.label1.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label1.Location = new Point(464, 18);
      this.label1.Name = "label1";
      this.label1.Size = new Size(113, 16);
      this.label1.TabIndex = 78;
      this.label1.Text = "Property Address";
      this.label8.AutoSize = true;
      this.label8.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Regular, GraphicsUnit.Point, (byte) 0);
      this.label8.Location = new Point(11, 18);
      this.label8.Name = "label8";
      this.label8.Size = new Size(88, 16);
      this.label8.TabIndex = 79;
      this.label8.Text = "Renter Name";
      this.active.AutoSize = true;
      this.active.Location = new Point(578, 45);
      this.active.Name = "active";
      this.active.Size = new Size(276, 20);
      this.active.TabIndex = 81;
      this.active.Text = "Show Only Active Rented Properties";
      this.active.UseVisualStyleBackColor = true;
      this.active.CheckedChanged += new EventHandler(this.active_CheckedChanged);
      this.AutoScaleDimensions = new SizeF(96f, 96f);
      this.AutoScaleMode = AutoScaleMode.Dpi;
      this.ClientSize = new Size(1061, 640);
      this.Controls.Add((Control) this.active);
      this.Controls.Add((Control) this.CName);
      this.Controls.Add((Control) this.prname);
      this.Controls.Add((Control) this.label1);
      this.Controls.Add((Control) this.label8);
      this.Controls.Add((Control) this.button1);
      this.Controls.Add((Control) this.dataGridView1);
      this.Font = new Font("Microsoft Sans Serif", 9.75f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
      this.Name = nameof (Form6);
      this.Text = "Property Renter Record";
      this.Load += new EventHandler(this.Form6_Load);
      ((ISupportInitialize) this.dataGridView1).EndInit();
      this.ResumeLayout(false);
      this.PerformLayout();
    }
  }
}
