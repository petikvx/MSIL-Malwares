// Decompiled with JetBrains decompiler
// Type: x4iD7vJVQ2zMn.xasf5HZ9vg2zY
// Assembly: Udby4Jt48oXkJ, Version=3.17.2.31, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
// MVID: 37899E89-D673-4F5B-A193-2E4DF6A54096
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.03\HEUR-Trojan.MSIL.Gorgon.gen-bf535869266eca7a958714acade2ede1bff0e73f0aaa2702f389ededee6a8d6a.exe

using \u0033s1eDqxyulHOR;
using gzCekc42YJiP8;
using System;
using System.Runtime.CompilerServices;
using System.Runtime.ConstrainedExecution;
using System.Runtime.InteropServices;
using System.Security;
using System.Windows.Forms;

namespace x4iD7vJVQ2zMn
{
  internal static class xasf5HZ9vg2zY
  {
    [SecurityCritical]
    internal static string \u0037fDtrwChN2Zfg(int RHL0G0NxnKXuv, string C5c90hHquClsl)
    {
      using (\u0034CScxYoWGnpF3 HaEfoZhwvpLmh = xasf5HZ9vg2zY.\u0032dXiVqgpwU70p.DVJUKKKVyV5J1(C5c90hHquClsl))
      {
        IntPtr zero = IntPtr.Zero;
        RuntimeHelpers.PrepareConstrainedRegions();
        try
        {
          if (xasf5HZ9vg2zY.rhkmKD0YkryzK.xfbvLUTHSIkUS((xasf5HZ9vg2zY.ZxRybYFoRYh9i) 6400, HaEfoZhwvpLmh, RHL0G0NxnKXuv, 0, ref zero, 0, IntPtr.Zero) == 0)
            Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());
          return Marshal.PtrToStringUni(zero);
        }
        finally
        {
          if (zero != IntPtr.Zero)
            xasf5HZ9vg2zY.rhkmKD0YkryzK.TDiJHIliO2mjH(zero);
        }
      }
    }

    internal static string ZtFwR7eiQ4v4N(int r19k8cH6IBNth) => xasf5HZ9vg2zY.\u0037fDtrwChN2Zfg(r19k8cH6IBNth, "ntdll.dll");

    [Flags]
    internal enum ZxRybYFoRYh9i
    {
      None = 0,
      AllocateBuffer = 256, // 0x00000100
      FromModule = 2048, // 0x00000800
      FromSystem = 4096, // 0x00001000
    }

    internal struct \u0032dXiVqgpwU70p
    {
      internal ushort \u0034u2bne6xGCeoE;
      internal ushort \u0033NRiTjoGFWfuV;
      internal ushort AGSVP99ifpIZ1;
      internal ushort vRh95FxuL6ejL;
      internal ushort JU4n6Nwqeb0l7;
      internal ushort GWdrFW7d8E1kr;
      internal ushort ZJUOQFqmYnERj;
      private const int Ai5RHAc5ebj5z = -2147467263;

      [DllImport("kernel32.dll", EntryPoint = "LoadLibrary", CharSet = CharSet.Unicode)]
      internal static extern \u0034CScxYoWGnpF3 DVJUKKKVyV5J1(string xob71tBh4iYZm);
    }

    [SuppressUnmanagedCodeSecurity]
    private static class rhkmKD0YkryzK
    {
      [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
      [DllImport("kernel32.dll", EntryPoint = "LocalFree", SetLastError = true)]
      internal static extern IntPtr TDiJHIliO2mjH(IntPtr hwqnRvLnCY17m);

      [DllImport("kernel32.dll", EntryPoint = "FormatMessage", CharSet = CharSet.Unicode, SetLastError = true)]
      internal static extern int xfbvLUTHSIkUS(
        xasf5HZ9vg2zY.ZxRybYFoRYh9i ZqCbSpLngD4OT,
        \u0034CScxYoWGnpF3 HaEfoZhwvpLmh,
        int uHIS6iFwQon7r,
        int CZNuj0u7mPA8Q,
        [In, Out] ref IntPtr jkeTpoxZBOACk,
        int _param5,
        IntPtr X1eaTIRsPnI18);

      public rhkmKD0YkryzK(WebBrowser host)
        : this(host)
      {
        ((y9WeDGzdnipVD.mq9BEccBis8jt) this).RS0LDmWjRyBdp = host;
      }
    }
  }
}
