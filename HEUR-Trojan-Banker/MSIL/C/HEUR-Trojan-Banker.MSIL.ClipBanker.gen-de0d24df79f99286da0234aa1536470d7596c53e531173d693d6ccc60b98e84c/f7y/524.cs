// Decompiled with JetBrains decompiler
// Type: f7y.524
// Assembly: uc5uTlQKZwvBJeUwoIoxWYL1o3uBI8gaMfnT9AO, Version=9.8.6.0, Culture=neutral, PublicKeyToken=null
// MVID: 66B519F9-803D-46C9-8343-EC24850CA08A
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.01-msil\HEUR-Trojan-Banker.MSIL.ClipBanker.gen-de0d24df79f99286da0234aa1536470d7596c53e531173d693d6ccc60b98e84c.exe

using \u0036t4;
using A5m;
using l1C;
using r6A;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using U2D;

namespace f7y
{
  internal sealed class \u003524
  {
    private \u003524.\u00333i \u0034u5;
    internal \u0033t2 PI5;
    internal int j71;
    internal uint J7v;
    internal uint \u0036dc;
    internal int p68;
    private bool zi4 = true;
    internal int \u003482;
    internal \u00392I \u0032Db;
    private static readonly byte[] \u0035p8 = new byte[4]
    {
      (byte) 0,
      (byte) 0,
      byte.MaxValue,
      byte.MaxValue
    };

    [SpecialName]
    internal bool C53() => this.zi4;

    public \u003524()
    {
    }

    public \u003524([In] bool obj0) => this.zi4 = obj0;

    internal int t8f()
    {
      this.PI5.m21 = this.PI5.\u00314Z = 0L;
      this.PI5.\u00335v = (string) null;
      this.\u0034u5 = this.C53() ? \u003524.\u00333i.\u0023a : \u003524.\u00333i.\u0023h;
      int num = (int) this.\u0032Db.\u00359q();
      return 0;
    }

    internal int Zxe()
    {
      if (this.\u0032Db != null)
        this.\u0032Db.eC9();
      this.\u0032Db = (\u00392I) null;
      return 0;
    }

    internal int \u0033f9([In] \u0033t2 obj0, [In] int obj1)
    {
      this.PI5 = obj0;
      this.PI5.\u00335v = (string) null;
      this.\u0032Db = (\u00392I) null;
      if (obj1 < 8 || obj1 > 15)
      {
        this.Zxe();
        throw new \u0033g4("Bad window size.");
      }
      this.\u003482 = obj1;
      this.\u0032Db = new \u00392I(obj0, this.C53() ? (object) this : (object) (\u003524) null, 1 << obj1);
      this.t8f();
      return 0;
    }

    internal int \u0039uB([In] F9i obj0)
    {
      if (this.PI5.\u0033Dp == null)
        throw new \u0033g4("InputBuffer is null. ");
      int num1 = 0;
      int num2 = -5;
      while (true)
      {
        switch (this.\u0034u5)
        {
          case \u003524.\u00333i.\u0023a:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              if (((this.j71 = (int) this.PI5.\u0033Dp[this.PI5.X7k++]) & 15) != 8)
              {
                this.\u0034u5 = \u003524.\u00333i.\u0023n;
                this.PI5.\u00335v = string.Format("unknown compression method (0x{0:X2})", (object) this.j71);
                this.p68 = 5;
                continue;
              }
              if ((this.j71 >> 4) + 8 > this.\u003482)
              {
                this.\u0034u5 = \u003524.\u00333i.\u0023n;
                this.PI5.\u00335v = string.Format("invalid window size ({0})", (object) ((this.j71 >> 4) + 8));
                this.p68 = 5;
                continue;
              }
              this.\u0034u5 = \u003524.\u00333i.\u0023b;
              continue;
            }
            goto label_5;
          case \u003524.\u00333i.\u0023b:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              int num3 = (int) this.PI5.\u0033Dp[this.PI5.X7k++] & (int) byte.MaxValue;
              if (((this.j71 << 8) + num3) % 31 != 0)
              {
                this.\u0034u5 = \u003524.\u00333i.\u0023n;
                this.PI5.\u00335v = "incorrect header check";
                this.p68 = 5;
                continue;
              }
              this.\u0034u5 = (num3 & 32) == 0 ? \u003524.\u00333i.\u0023h : \u003524.\u00333i.\u0023c;
              continue;
            }
            goto label_12;
          case \u003524.\u00333i.\u0023c:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc = (uint) ((ulong) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 24) & 4278190080UL);
              this.\u0034u5 = \u003524.\u00333i.\u0023d;
              continue;
            }
            goto label_17;
          case \u003524.\u00333i.\u0023d:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc += (uint) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 16 & 16711680);
              this.\u0034u5 = \u003524.\u00333i.\u0023e;
              continue;
            }
            goto label_20;
          case \u003524.\u00333i.\u0023e:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc += (uint) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 8 & 65280);
              this.\u0034u5 = \u003524.\u00333i.\u0023f;
              continue;
            }
            goto label_23;
          case \u003524.\u00333i.\u0023f:
            goto label_25;
          case \u003524.\u00333i.\u0023g:
            goto label_28;
          case \u003524.\u00333i.\u0023h:
            num2 = this.\u0032Db.FGy(num2);
            if (num2 == -3)
            {
              this.\u0034u5 = \u003524.\u00333i.\u0023n;
              this.p68 = 0;
              continue;
            }
            if (num2 == 0)
              num2 = num1;
            if (num2 == 1)
            {
              num2 = num1;
              this.J7v = this.\u0032Db.\u00359q();
              if (this.C53())
              {
                this.\u0034u5 = \u003524.\u00333i.\u0023i;
                continue;
              }
              goto label_36;
            }
            else
              goto label_34;
          case \u003524.\u00333i.\u0023i:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc = (uint) ((ulong) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 24) & 4278190080UL);
              this.\u0034u5 = \u003524.\u00333i.\u0023j;
              continue;
            }
            goto label_39;
          case \u003524.\u00333i.\u0023j:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc += (uint) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 16 & 16711680);
              this.\u0034u5 = \u003524.\u00333i.\u0023k;
              continue;
            }
            goto label_42;
          case \u003524.\u00333i.\u0023k:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc += (uint) ((int) this.PI5.\u0033Dp[this.PI5.X7k++] << 8 & 65280);
              this.\u0034u5 = \u003524.\u00333i.\u0023l;
              continue;
            }
            goto label_45;
          case \u003524.\u00333i.\u0023l:
            if (this.PI5.\u0032Dc != 0)
            {
              num2 = num1;
              --this.PI5.\u0032Dc;
              ++this.PI5.m21;
              this.\u0036dc += (uint) this.PI5.\u0033Dp[this.PI5.X7k++] & (uint) byte.MaxValue;
              if ((int) this.J7v != (int) this.\u0036dc)
              {
                this.\u0034u5 = \u003524.\u00333i.\u0023n;
                this.PI5.\u00335v = "incorrect data check";
                this.p68 = 5;
                continue;
              }
              goto label_51;
            }
            else
              goto label_48;
          case \u003524.\u00333i.\u0023m:
            goto label_52;
          case \u003524.\u00333i.\u0023n:
            goto label_53;
          default:
            goto label_54;
        }
      }
label_5:
      return num2;
label_12:
      return num2;
label_17:
      return num2;
label_20:
      return num2;
label_23:
      return num2;
label_25:
      if (this.PI5.\u0032Dc == 0)
        return num2;
      --this.PI5.\u0032Dc;
      ++this.PI5.m21;
      this.\u0036dc += (uint) this.PI5.\u0033Dp[this.PI5.X7k++] & (uint) byte.MaxValue;
      this.PI5.Bd1 = this.\u0036dc;
      this.\u0034u5 = \u003524.\u00333i.\u0023g;
      return 2;
label_28:
      this.\u0034u5 = \u003524.\u00333i.\u0023n;
      this.PI5.\u00335v = "need dictionary";
      this.p68 = 0;
      return -2;
label_34:
      return num2;
label_36:
      this.\u0034u5 = \u003524.\u00333i.\u0023m;
      return 1;
label_39:
      return num2;
label_42:
      return num2;
label_45:
      return num2;
label_48:
      return num2;
label_51:
      this.\u0034u5 = \u003524.\u00333i.\u0023m;
      return 1;
label_52:
      return 1;
label_53:
      throw new \u0033g4(string.Format("Bad state ({0})", (object) this.PI5.\u00335v));
label_54:
      throw new \u0033g4("Stream error.");
    }

    internal int eHK(byte[] _param1, bool _param2 = false)
    {
      int num1 = 0;
      int num2 = _param1.Length;
      if (!_param2)
      {
        if (this.\u0034u5 != \u003524.\u00333i.\u0023g)
          throw new \u0033g4("Stream error.");
        if ((int) \u003232.\u0033bv(1U, _param1, 0, _param1.Length) != (int) this.PI5.Bd1)
          return -3;
      }
      this.PI5.Bd1 = \u003232.\u0033bv(0U, (byte[]) null, 0, 0);
      if (num2 >= 1 << this.\u003482)
      {
        num2 = (1 << this.\u003482) - 1;
        num1 = _param1.Length - num2;
      }
      this.\u0032Db.\u003834(_param1, num1, num2);
      this.\u0034u5 = \u003524.\u00333i.\u0023h;
      return 0;
    }

    internal int \u003299()
    {
      if (this.\u0034u5 != \u003524.\u00333i.\u0023n)
      {
        this.\u0034u5 = \u003524.\u00333i.\u0023n;
        this.p68 = 0;
      }
      int num1;
      if ((num1 = this.PI5.\u0032Dc) == 0)
        return -5;
      int x7k = this.PI5.X7k;
      int index;
      for (index = this.p68; num1 != 0 && index < 4; --num1)
      {
        if ((int) this.PI5.\u0033Dp[x7k] == (int) \u003524.\u0035p8[index])
          ++index;
        else
          index = this.PI5.\u0033Dp[x7k] == (byte) 0 ? 4 - index : 0;
        ++x7k;
      }
      this.PI5.m21 += (long) (x7k - this.PI5.X7k);
      this.PI5.X7k = x7k;
      this.PI5.\u0032Dc = num1;
      this.p68 = index;
      if (index != 4)
        return -3;
      long m21 = this.PI5.m21;
      long num2 = this.PI5.\u00314Z;
      this.t8f();
      this.PI5.m21 = m21;
      this.PI5.\u00314Z = num2;
      this.\u0034u5 = \u003524.\u00333i.\u0023h;
      return 0;
    }

    private enum \u00333i
    {
      \u0023a,
      \u0023b,
      \u0023c,
      \u0023d,
      \u0023e,
      \u0023f,
      \u0023g,
      \u0023h,
      \u0023i,
      \u0023j,
      \u0023k,
      \u0023l,
      \u0023m,
      \u0023n,
    }
  }
}
